{"doi":"10.1109\/TEC.2003.816606","coreId":"66735","oai":"oai:dro.dur.ac.uk.OAI2:262","identifiers":["oai:dro.dur.ac.uk.OAI2:262","10.1109\/TEC.2003.816606"],"title":"Evaluation of the effects of rotor harmonics in a doubly-fed induction generator with harmonic induced speed ripple.","authors":["Liao,  Y.","Ran,  L.","Putrus,  G. A.","Smith,  K. S."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2003-12","abstract":"This paper is concerned with the low-frequency harmonics which originate from the rotor inverter of a doubly-fed induction generator (DFIG). By including the mechanical speed response, it expands the transformer approach previously taken to analyze the harmonic transfer in the machine. A numerical method is proposed to calculate the stator current sidebands, which can be used to predict the voltage fluctuation at the system busbar. It is shown that the pulsating torque associated with the rotor harmonics can induce speed ripple depending on the inertia, causing a significant change in the stator current spectrum. Experiment and simulation verify the analysis and the proposed calculation method","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/66735.pdf","fullTextIdentifier":"http:\/\/dro.dur.ac.uk\/262\/1\/262.pdf","pdfHashValue":"9dfb08bbf8696afef7f9ae97f5481cd5ac8b586e","publisher":"IEEE","rawRecordXml":"<record><header><identifier>\n  \n    \n      oai:dro.dur.ac.uk.OAI2:262<\/identifier><datestamp>\n      2011-05-24T15:44:35Z<\/datestamp><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        Evaluation of the effects of rotor harmonics in a doubly-fed induction generator with harmonic induced speed ripple.<\/dc:title><dc:creator>\n        Liao,  Y.<\/dc:creator><dc:creator>\n        Ran,  L.<\/dc:creator><dc:creator>\n        Putrus,  G. A.<\/dc:creator><dc:creator>\n        Smith,  K. S.<\/dc:creator><dc:description>\n        This paper is concerned with the low-frequency harmonics which originate from the rotor inverter of a doubly-fed induction generator (DFIG). By including the mechanical speed response, it expands the transformer approach previously taken to analyze the harmonic transfer in the machine. A numerical method is proposed to calculate the stator current sidebands, which can be used to predict the voltage fluctuation at the system busbar. It is shown that the pulsating torque associated with the rotor harmonics can induce speed ripple depending on the inertia, causing a significant change in the stator current spectrum. Experiment and simulation verify the analysis and the proposed calculation method. <\/dc:description><dc:subject>\n        Modulation<\/dc:subject><dc:subject>\n         Pulsating torque<\/dc:subject><dc:subject>\n         Spectrum motor drives<\/dc:subject><dc:subject>\n         Torsional vibrations.<\/dc:subject><dc:publisher>\n        IEEE<\/dc:publisher><dc:source>\n        IEEE transactions on energy conversion, 2003, Vol.18(4), pp.508-515 [Peer Reviewed Journal]<\/dc:source><dc:date>\n        2003-12<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:identifier>\n        dro:262<\/dc:identifier><dc:identifier>\n        issn:0885-8969<\/dc:identifier><dc:identifier>\n        doi:10.1109\/TEC.2003.816606<\/dc:identifier><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/262\/<\/dc:identifier><dc:identifier>\n        http:\/\/dx.doi.org\/10.1109\/TEC.2003.816606<\/dc:identifier><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/262\/1\/262.pdf<\/dc:identifier><dc:rights>\n        \u00a92003 IEEE. Personal use of this material is permitted. However, permission to reprint\/republish this material for advertising or promotional purposes or for creating new collective works for resale or redistribution to servers or lists, or to reuse any copyrighted component of this work in other works must be obtained from the IEEE.\\ud\n<\/dc:rights><dc:accessRights>\n        info:en-repo\/semantics\/openAccess<\/dc:accessRights><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["0885-8969","issn:0885-8969"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2003,"topics":["Modulation","Pulsating torque","Spectrum motor drives","Torsional vibrations."],"subject":["Article","PeerReviewed"],"fullText":"Durham Research Online\nDeposited in DRO:\n27 May 2008\nVersion of attached file:\nPublished Version\nPeer-review status of attached file:\nPeer-reviewed\nCitation for published item:\nLiao, Y. and Ran, L. and Putrus, G. A. and Smith, K. S. (2003) \u2019Evaluation of the effects of rotor harmonics\nin a doubly-fed induction generator with harmonic induced speed ripple.\u2019, IEEE transactions on energy\nconversion., 18 (4). pp. 508-515.\nFurther information on publisher\u2019s website:\nhttp:\/\/dx.doi.org\/10.1109\/TEC.2003.816606\nPublisher\u2019s copyright statement:\n2003 IEEE. Personal use of this material is permitted. However, permission to reprint\/republish this material for\nadvertising or promotional purposes or for creating new collective works for resale or redistribution to servers or lists,\nor to reuse any copyrighted component of this work in other works must be obtained from the IEEE.\nAdditional information:\nUse policy\nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without prior permission or charge, for\npersonal research or study, educational, or not-for-profit purposes provided that:\n\u2022 a full bibliographic reference is made to the original source\n\u2022 a link is made to the metadata record in DRO\n\u2022 the full-text is not changed in any way\nThe full-text must not be sold in any format or medium without the formal permission of the copyright holders.\nPlease consult the full DRO policy for further details.\nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom\nTel : +44 (0)191 334 3042 \u2014 Fax : +44 (0)191 334 2971\nhttp:\/\/dro.dur.ac.uk\n508 IEEE TRANSACTIONS ON ENERGY CONVERSION, VOL. 18, NO. 4, DECEMBER 2003\nEvaluation of the Effects of Rotor Harmonics in a\nDoubly-Fed Induction Generator With Harmonic\nInduced Speed Ripple\nYong Liao, Li Ran, Member, IEEE, Ghanim A. Putrus, and Kenneth S. Smith, Member, IEEE\nAbstract\u2014This paper is concerned with the low-frequency har-\nmonics which originate from the rotor inverter of a doubly-fed in-\nduction generator (DFIG). By including the mechanical speed re-\nsponse, it expands the transformer approach previously taken to\nanalyze the harmonic transfer in the machine. A numerical method\nis proposed to calculate the stator current sidebands, which can\nbe used to predict the voltage fluctuation at the system busbar. It\nis shown that the pulsating torque associated with the rotor har-\nmonics can induce speed ripple depending on the inertia, causing\na significant change in the stator current spectrum. Experiment\nand simulation verify the analysis and the proposed calculation\nmethod.\nIndex Terms\u2014Doubly-fed induction generator, harmonics, mod-\nulation, pulsating torque, spectrum.\nI. INTRODUCTION\nADOUBLY-FED induction generator (DFIG) is based ona wound rotor induction machine. The three-phase rotor\nwindings are supplied with a voltage of controllable amplitude\nand frequency using a static power electronic converter. Conse-\nquently, the speed can be varied while the operating frequency\non the stator side remains constant. Depending on the required\nspeed range, the rotor converter rating is usually small compared\nto the machine rating. Therefore, a DFIG is ideal for applica-\ntions such as wind, pumped storage, and micro-hydro power\nplants which inherently favor variable speed operation [1], [2].\nIt is also attractive to other dispersed generation schemes where\nthe fuel efficiency can be improved if the diesel engine or gas\nturbine is allowed to run at variable speed according to the load\nlevel [3].\nThere is increasing concern about the rotor side harmonics in\ndoubly-fed induction generators. The converter provides a fun-\ndamental voltage at the slip frequency, and for the reasons to\nbe explained later, the associated low-frequency harmonics can\ncause a pulsating air-gap torque and voltage fluctuation on the\nsystem busbar. Since the impedance viewed from the rotor side\nManuscript received October 24, 2002. This work was supported in part by\nNorthumbria University and in part by the Cheung Kong Scholar Program of\nChina.\nY. Liao is with Chongqing University, Chongqing 400044, China (e-mail:\nyongliaocqu@cta.cq.cn).\nL. Ran is with the School of Engineering, University of Durham, Durham\nDH1 3LE, U.K. (e-mail: li.ran@durham.ac.uk).\nG. A. Putrus is with the Northumbria University, Newcastle upon Tyne NE1\n8ST, U.K. (e-mail: ghanim.putrus@unn.ac.uk).\nK. S. Smith is with the Mott MacDonald, Power Systems Division, Glasgow\nG2 8YD, U.K. (e-mail: KSS@sas-glas.mottmac.com).\nDigital Object Identifier 10.1109\/TEC.2003.816606\nFig. 1. System configuration.\nof the machine is small at low slip frequency, such effects can\nbe very detrimental in practice. With a direct ac-ac cyclocon-\nverter, low-frequency harmonics can be produced as a result of\nthe modulation process between the input and output frequen-\ncies [4], [5]. It will be shown in this paper that such low-fre-\nquency harmonics can also exist in a PWM inverter having a\nhigh switching frequency. In wind power systems, pulsating\ntorque and flicker have already occurred caused by a fluctuating\ninput due to wind speed variation [6]. The effects caused by the\nrotor side harmonics as discussed in this study will further add\nto the scenario.\nPrevious researchers have considered the transfer of har-\nmonics from the rotor to the stator side of the machine,\nwhich was assumed to follow the transformer principle [i.e.,\nmagnetomotive force (mmf) balance] on both sides [7]\u2013[9].\nThe standard equivalent circuit of an induction machine was\nmodified to calculate the stator current and voltage harmonics,\nand frequency modulation was handled by considering the slip.\nIt has been shown previously that the mechanical behavior will\nreflect electrically in a cage induction machine [10]. Using\nthese results, this study will further the analysis by including the\nmechanical speed response in the model. Inclusion of the speed\nripple will significantly improve the model accuracy. After\na better understanding of the electromechanical interaction\nin the DFIG is obtained, it would be possible to improve the\noverall performance of the generator system by, for example,\ncontrolling the rotor side inverter.\nII. GENERATOR MODEL\nThe configuration of a DFIG system is shown in Fig. 1. In\norder to analyze the harmonics with electromechanical interac-\n0885-8969\/03$17.00 \u00a9 2003 IEEE\nLIAO et al.: EVALUATION OF THE EFFECTS OF ROTOR HARMONICS IN A DOUBLY-FED INDUCTION GENERATOR 509\ntions in the system, a model of the machine should be estab-\nlished to relate the rotor and stator voltages and currents as well\nas the air-gap torque and the rotor speed. In a steady-state, each\nvariable consists of a series of Fourier components at different\nfrequencies. The flux linkage equation is [11]\n(1)\nSubscripts \u201c \u201d and \u201c \u201d stand for the stator and rotor windings,\nrespectively; each side includes three phases, and amplitudes\nof the rotor side quantities are referred to the stator side. Note\nthat quantities on both sides are expressed in their own frequen-\ncies. The inductance matrices are defined as follows where the\nmutual elements between the stator and rotor windings depend\non the rotor electrical angle . is the mutual inductance co-\nefficient (i.e., 3\/2 of the magnetizing inductance in the normal\nequivalent circuit). and are the leakage inductances of\nthe stator and rotor windings.\n(2)\n(3)\n(4)\nIn a steady-state condition without any speed ripple,\n, where is the slip and is the synchronous elec-\ntrical frequency. The fundamental components of the stator and\nrotor currents are at frequencies and , respectively. It can\nbe shown that the product of and gives terms at the stator\nfrequency while the product of and will produce terms\nat the rotor or slip frequency. Denoting the winding voltages\n, currents , as the total inductance\nmatrix, and as the resistance matrix, the voltage balance equa-\ntion of the machine can be derived as\n(5)\nwhere is the total \u201cimpedance matrix\u201d of\nthe machine, and is the \u201c \u201d derivative operator. In deriving\n(5), it was noticed that the inductance matrix depends on the\nrotor angle and, hence, is time-variant. Therefore,\n. According to (5), harmonics\nin the rotor supply voltage will cause harmonic currents on both\nthe stator and rotor sides of the machine. Due to the interactions\nbetween the mmfs established by the stator and rotor currents,\nharmonics exist in the machine torque which will lead to speed\nripple. With the self-inductances of the windings being constant\nin a round rotor machine, the air-gap torque can be calculated\nas below based on the \u201ccoenergy\u201d principle [11]\n(6)\nwhere is the number of poles of the machine. The speed ripple\nwill then be reflected in the impedance matrix, further affecting\nthe harmonic content of the current and torque.\nIII. EXTRA HARMONIC EXCITATION DUE TO SPEED RIPPLE\nIt is initially assumed that the speed signal contains only one\nripple component. A general case can be considered using su-\nperposition. The electrical speed is given by\n(7)\nwhere is the average speed, the amplitude, and the fre-\nquency of the speed ripple. and are both in rad\/s. The rotor\nelectrical angle is calculated as follows including a linear term\ndue to the average speed and a disturbance term corresponding\nto the speed ripple:\n(8)\nAs the disturbance term is relatively small, the following ap-\nproximations are justifiable:\n(9)\n(10)\nUsing these approximations, it can be shown that the imme-\ndiate effect of the speed ripple is to cause the following incre-\nment to the impedance matrix which depends on the rotor angle:\n(11)\nwhere\n(12)\n(13)\n(14)\n(15)\nwhere the elements in submatrices , , ,\nand , are at frequency or as the subscript\nindicates. These elements are expanded in Appendix A which\nalso outlines the derivation process. Due to the increment of the\nimpedance matrix , both the voltage and current vectors of\nthe machine will have an increment, and , respectively.\nAccording to (5)\n(16)\nAs , the incremental voltage, current, and impedance are\ninterrelated as follows:\n(17)\n510 IEEE TRANSACTIONS ON ENERGY CONVERSION, VOL. 18, NO. 4, DECEMBER 2003\nFig. 2. Balance of mmf associated with stator and rotor currents.\nTABLE I\nHARMONIC FREQUENCIES WITH THE EFFECT OF SPEED RIPPLE\nEquation (17) shows the mechanism which determines the\nharmonics observed on the two sides of the DFIG [12]. To il-\nlustrate the mechanism, a comparison is made between cases\nwith and without speed ripple. Suppose the rotor supply con-\ntains only a fifth harmonic current which is of negative phase\nsequence. Without speed ripple, the corresponding mmf rotates\nbackward at six times of the slip frequency with respect to the\nstator fundamental. In order to balance the mmf, the stator cur-\nrent will contain a component of positive phase sequence and at\nfrequency [13]. This case of interaction is depicted in\nFig. 2.\nIn this case, torque ripple will be caused at the sixth harmonic\nfrequency of the rotor fundamental. As the rotor speed varies,\nthe frequency of the current induced on the stator side must\nchange. A series of new modulation terms at various frequen-\ncies will be produced. Increment of the impedance matrix is in-\nvolved in this interactive process. According to (17), the rotor\ncurrent at frequency will modulate with terms in at fre-\nquencies to give excitation voltages on the stator side at\nfrequencies (i.e., ). Stator current and voltage\ncomponents as sidebands of the fundamental are caused. Thus,\na component at frequency is also present in addition to\nthe one at frequency . Similarly, the fundamental stator\ncurrent will also modulate with to excite harmonics on the\nrotor side. The other two terms in (17) will cause extra compo-\nnents. Table I shows the generation of the sideband frequencies\ndue to the speed ripple. It is assumed that rad\/s\n(50 Hz), rad\/s (1 Hz), and rad\/s (6 Hz).\nA negative frequency indicates negative phase sequence.\nThe above analysis is based on a linearized model of the ma-\nchine. Therefore, the principle of superposition can be used to\ndeal with a general situation with multiple speed ripple compo-\nnents at different frequencies. This is described in the Appendix.\nIV. HARMONIC CALCULATION METHOD\nAlthough time-domain simulation can be performed, an ana-\nlytical method for calculating the harmonics will provide more\ninsight into the mechanism giving rise to the electromechanical\ninteraction. It is also more convenient due to the fact that the har-\nmonic components on the stator and rotor sides will drift on the\nspectrum during variable speed operation. Based on the above\nanalysis, this section describes a frequency domain method that\ninterrelates the stator and rotor side harmonics, air-gap torque,\nand speed ripple.\nGiven current components on the stator and rotor sides,\nand , the corresponding\ncomponent in the torque can be calculated as [11]\n(18)\nIn calculating the torque harmonics, it is first assumed that the\nrotor speed is constant. The above can be modified by substi-\ntuting with a Fourier series and applying a Taylor series ex-\npansion to the resultant expression. However, this is usually un-\nnecessary as the added harmonic torque components are small.\nFurthermore, it is usually the torque component due to the in-\nteraction between a harmonic current on one side with the fun-\ndamental magnetizing current that is of major concern.\nThe speed ripple corresponding to a harmonic torque com-\nponent, say , can be derived according to the\nrotor dynamic equation and the result is\n(19)\nwhere is the rotor moment of inertia and the damping ratio.\nThe torque produced by the prime mover would also change\nwith the speed variation. When the torque-speed relationship of\nthe prime mover is linearized, such an effect can be represented\ncollectively in . Equation (19) can be expanded to include the\nshaft torsional dynamics, should it be necessary [14].\nUsing the above, a procedure to calculate the harmonics in-\ncluding the electromechanical interaction in the system can be\noutlined as follows.\n1) Assuming that there is no speed ripple, calculate the fun-\ndamental and harmonics in the stator and rotor current.\nThe supply conditions on the two sides of the machine are\ngiven. So is the input power\/torque of the prime mover.\nThe calculation can be performed using either the steady-\nstate machine equations or the equivalent circuit [7].\n2) Calculate the pulsating torque and corresponding speed\nripple.\n3) For each ripple component in the speed signal, calcu-\nlate the increment of the impedance matrix according to\nLIAO et al.: EVALUATION OF THE EFFECTS OF ROTOR HARMONICS IN A DOUBLY-FED INDUCTION GENERATOR 511\nFig. 3. Generation of low-frequency harmonics in rotor voltage.\n(11)\u2013(15). The \u201cd\/dt\u201d operator is symbolically retained in\nthe calculation.\n4) With the supply voltage on the stator and rotor sides main-\ntained constant, the increment of the current can be deter-\nmined. It can be derived from (17) with .\nThat is, . This is\nequivalent to a modulation relationship .\nThe effect of the original was accounted earlier in\nstep (1). In practice, the calculation for is performed in\nthe frequency domain. For a given speed ripple, frequen-\ncies of the elements in and the corresponding are\nalso known. Therefore, under the symmetrical condition,\nthe amplitude and phase angle of the incremental current\ncan be directly calculated based on the modulation rela-\ntionship without the need to compute the inverse of the\nimpedance matrix which may include the system network\nimpedance. In the frequency domain, the \u201c \u201d operator\nin is translated as \u201c \u201d when it is applied to the\nfundamental stator current. The derivative operator in the\nimpedance matrix is similarly considered.\n5) Modify the currents; the results are usually close to the\naccurate solution. If they need to be more accurate, the\nprocedure can be iterated. Experience shows that one or\ntwo iterations are often sufficient.\nV. EXPERIMENTAL VALIDATION\nThe configuration of the laboratory test system is similar to\nthat shown in Fig. 1. The prime mover is a cage induction motor\npowered by a voltage source of constant amplitude and fre-\nquency. The rotor windings of the doubly-fed induction gen-\nerator are supplied from a PWM inverter. Both machines are\nof four-pole design and the inverter whose output determines\nthe speed and reactive power operates in the constant volt\/Hertz\nmode. The system is rated at 250 VA and the machine parame-\nters are detailed in the Appendix. Due to the low power rating,\nthe inertia is relatively large; some practical systems would ex-\nperience more speed ripple than what is to be reported in this\npaper.\nFig. 3 shows how the rotor PWM inverter, which has a high\nswitching frequency of 1 kHz, can also produce low-frequency\nharmonics in its output voltage. A train of pulses of different\nwidths synthesizes the desired fundamental voltage. With cur-\nrents being delivered into the wound rotor windings from the in-\nverter, voltage distortion is introduced due to the voltage drop of\nthe switching devices within the inverter. Fig. 3 shows that the\nFig. 4. Measured stator current and rotor speed.\nFig. 5. Spectrum of stator current.\nvoltage drop is associated with the fundamental current rather\nthan the switching frequency. At a high rotor speed or low slip,\nthe fundamental voltage in the rotor circuit is generally low in\namplitude and the rotor windings present a low impedance to the\ninverter [7]. The low-order harmonics associated with the device\nvoltage drop will cause both a large harmonic current and pul-\nsating torque. It is possible to compensate the effect of the de-\nvice voltage drop by modifying the switching strategy, but this\nhas not yet been achieved in most commercial inverters without\ncurrent feedback and complicated calibration tests.\nWith the inverter fundamental frequency set to 1 Hz and the\ndoubly-fed induction generator running with an average power\nof 200 W, the speed and stator current of the generator are shown\nin Fig. 4. Both signals contain ripple at 6 Hz. This is because\nthe rotor supply voltage contains fifth and seventh harmonics of\nthe fundamental. The beating effect of the stator current, par-\nticularly its reactive component, will cause voltage fluctuation.\nA portion of the current spectrum is shown in Fig. 5. In ad-\ndition to the fundamental at 50 Hz, two distinctive sidebands\nare present at 50 6 Hz, respectively. Such sidebands are di-\nrectly linked to the flicker effect as the current flows through\nthe system impedance [15]. Other sideband components are also\nobserved.\nFig. 6 shows the rotor phase-phase voltage and phase current.\nThe voltage waveform consists of many very narrow pulses in\norder to obtain the required low fundamental voltage. This was\n512 IEEE TRANSACTIONS ON ENERGY CONVERSION, VOL. 18, NO. 4, DECEMBER 2003\nFig. 6. Measured rotor supply voltage and current.\nTABLE II\nCOMPARISON BETWEEN MEASUREMENT AND CALCULATION\ndone because the dc link voltage of the commercial drive used\nfor the laboratory tests was set at 325 V, which was relatively\nhigh compared to the required fundamental voltage on the ac\nside. The dc link voltage could not be further lowered without\ncausing converter tripping on undervoltage protection. Analysis\nshows that the rms value of the voltage per-phase at 1 Hz, 5 Hz,\nand 7 Hz are 10.25 V, 1.74 V, and 1.16 V, respectively. Using the\nmeasured rotor voltage harmonics and assuming that the mains\nsupply on the stator side is strong, the calculated stator current\nharmonics (with iteration when considering speed ripple) are\ncompared with the measurement in Table II which shows good\nagreement when the speed ripple is considered. In the calcula-\ntion, the torque-speed characteristic of the prime mover is repre-\nsented using that of the induction motor with a constant supply\nvoltage [13]. Table II also shows that the calculation accuracy\nis indeed very much dependent on the inclusion of the speed\nripple. An error greater than 30% can be caused for the major\nsidebands if the speed ripple is not included. In this case, ig-\nnoring speed ripple gives a pessimistic prediction.\nFig. 7 shows the reconstructed stator current waveform from\nthe calculated harmonic content of the current, with and without\nincluding the speed ripple during calculation. The difference\nis not only the level of the beating effect in the current signal\n(and, hence, the level of the voltage fluctuation depending on\nthe system impedance) but also how quickly the amplitude of\nthe current increases or decreases in each beating cycle. The\nsignature calculated with the speed ripple included is similar to\nwhat was recorded in the experiment (the top trace in Fig. 4).\nVI. CASE STUDIES AND DISCUSSION\nIn order to further illustrate the phenomenon, comparative\ncalculations are performed on a DFIG system rated at 450 kW.\nThe equivalent circuit parameters of the machine are given in\nFig. 7. Stator current reconstructed from calculation.\nFig. 8. Sensitivity to moment of inertia.\nthe Appendix. The four-pole machine has a typical moment of\ninertia of 11 Depending on the type of the prime mover,\nthe total shaft will certainly have a larger inertia. Regarding the\neffects of speed ripple, this section will analyze the effects of the\nmoment of inertia and the operating point of the system. With\na better understanding of the interaction, possible solutions and\ndesign considerations will be discussed.\nA. Case 1: Effect of Moment of Inertia\nThe stator side voltage is 400 V, 50 Hz. The fundamental\nvoltage on the rotor side is at 1 Hz in a rotation direction so\nthat the average rotor speed is 1470 r\/min (i.e., below the syn-\nchronous speed). The referred amplitude of the per-phase funda-\nmental voltage is 6.73 V(rms). The generator delivers 450-kW\nreal power to the mains system. Without harmonics, the gener-\nator would operate at unity power factor. The fifth and seventh\nharmonics in the rotor supply voltage are 0.254 and 0.174 V, re-\nspectively, as referred to the stator side.\nFig. 8 shows the stator current components at 44 and 56 Hz as\naffected by the shaft inertia. The percentage speed ripple with\nrespect to the average speed is also plotted. For a small pumped\nstorage unit at such a power rating, the total moment of inertia\nLIAO et al.: EVALUATION OF THE EFFECTS OF ROTOR HARMONICS IN A DOUBLY-FED INDUCTION GENERATOR 513\nFig. 9. Effect of operating point.\nwould be in the range from 20 to 30 . With wind\npower generation, the typical value would be around 40\nafter the original mass of the wind turbine is referred to the gen-\nerator side according to the square of the gearbox ratio [16]. In\neither situation, the rotor speed is subject to some ripple which\nconsiderably affects the current signature. Speed ripple can also\noccur as a result of torsional vibration particularly when the\nshaft is long, even if the total moment of inertia is large.\nB. Case 2: Effect of Operating Point\nThe moment of inertia is set at 30 . The condition of the\nstator and rotor supply circuits is the same as in Case 1. Fig. 9\nshows the major sidebands of the stator current at 44 and 56\nHz as affected by the real power produced by the generator. A\nstrong dependency is observed. This is because the change of\noperating condition will affect the interaction between a har-\nmonic current and the fundamental magnetizing current which\ngives rise to a pulsating torque. As the operating point changes,\nthe damping effect of the generator to the speed ripple will also\nchange. The variation as shown in Fig. 9 will not appear without\nspeed ripple since the harmonic impedance viewed from either\nside of the machine would otherwise remain constant disre-\ngarding the power level.\nIn the case studies, the assumed harmonics in the rotor supply\nvoltage are justifiable. A practical system can work in different\nconditions. However, it is shown that the speed ripple can be\ninvolved in and will affect the transfer of the low-frequency\nharmonics from the rotor to the stator sides. In addition to the\neffect shown earlier in the experiment, the case studies indi-\ncate that calculations ignoring the speed ripple may also pro-\nduce too optimistic results. The original cause for the concern\nis the low-frequency harmonics on the rotor side. Therefore, to\nsolve this problem, they should be eliminated in the rotor supply\nvoltage. This can be achieved either by modifying the switching\nstrategy of the rotor supply inverter or using an active filter to\nreduce or eliminate the low-frequency rotor harmonics. It is dif-\nficult to deal with the harmonics on the stator side since the cur-\nrent sidebands are close to the fundamental on the spectrum.\nVII. CONCLUSION\nThis paper analyzes the effects of the low-frequency har-\nmonics on the rotor side of a DFIG. With a PWM inverter\nsupplying the rotor, low-frequency harmonics can be caused\nby the device voltage drop. It is shown that these harmonics\nare transferred to the stator side and at the same time will\ncause speed ripple depending on the inertia and the operating\ncondition of the machine. The speed ripple will modify the\namplitudes of the sidebands around the fundamental of the\nstator current and introduce a series of new components. An\nanalytical method is proposed to evaluate the current spectrum,\nwhich can be used to predict the associated voltage fluctuation\nat the system busbar. Experimental tests are performed to\nverify the analysis and the calculation method. The tests and\nnumerical case studies show that, for small and medium size\nsystems, it is often necessary to consider the effect of speed\nripple. Harmonics could be eliminated at the rotor side by\nmodifying the switching strategy of the inverter or using\nexternal compensation.\nAPPENDIX A\nDERIVATION AND EXPANSION OF , ,\n, AND\nWith an incremental rotor electrical angle, the inductance ma-\ntrix can be linearized using a first-order Taylor expansion\n(20)\nwhere is the original inductance matrix without the angle\ndisturbance. The original rotor angle is calculated as .\nIt is noted that consists of the self and mutual inductances\nof the stator windings. Similarly, consists of the self and\nmutual inductances of the rotor windings. All elements in\nand are constant for the round rotor machine. Therefore, their\nincrements are zero. The mutual inductances between stator and\nrotor windings are dependent on the rotor angle as shown in (4).\nTheir increments and are expanded below\n(21)\nThe sine functions in (21) are due to the derivatives of the\nstator-rotor mutual inductances (4) with respect to the rotor elec-\ntrical angle , while is the incre-\nmental rotor angle given by (8). Each element in (21) is derived\nby applying the following first-order Taylor expansion to the\ncorresponding element in (4)\n(22)\nWhen components at different frequencies exist in the speed\nripple, the incremental rotor angle can be expanded to include\n514 IEEE TRANSACTIONS ON ENERGY CONVERSION, VOL. 18, NO. 4, DECEMBER 2003\nmultiple terms and the analysis can be carried out in a similar\nway based on the superposition principle. Each element in the\nfinal resultant 3 3 matrix of (21) is a product of sine and cosine\nfunctions, which can be expanded using a trigonometric identity.\nFor instance, the first element (row 1, column 1) is\n(23)\nDifferentiating the right-hand side with respect to time gives\nthe following:\n(24)\nSince the impedance matrix is defined as\n, the increment due to a speed ripple includes terms which\nare proportional to the incremental inductance or its derivative.\nThese correspond to (12)\u2013(15). Based on the above analysis, the\nsubmatrices in these equations. , , , and\nshould be expanded as shown in the equation at the\nbottom of the page.\nAPPENDIX B\nTEST MACHINE PARAMETERS\nRatings: 250 VA, 230 V, 50 Hz;\nStator resistance: 6.65 ;\nRotor resistance: 5.07 ;\nMagnetizing inductance: 290 mH;\nMoment of inertia: 0.0035 ;\nStator leakage inductance: 20 mH;\nRotor leakage inductance: 20 mH.\nAPPENDIX C\n450-kW MACHINE PARAMETERS\nRatings: 450 kW, 0.9 power factor, 400 V, 50 Hz;\nStator resistance: 1.18 ;\nRotor resistance: 2.8 ;\nMagnetizing inductance: 2.93 mH;\nMoment of inertia: 11.0 .\nREFERENCES\n[1] H. Akagi, \u201cThe state-of-the-art of power electronics in Japan,\u201d IEEE\nTrans. Power Electron., vol. 13, pp. 345\u2013356, Mar. 1998.\n[2] S. Heier, Grid Integration of Wind Energy Conversion Systems. New\nYork: Wiley, 1998, pp. 105\u2013118.\n[3] Y. Hu, M. Cirstea, M. McCormick, P. Urwin, and L. Haydock, \u201cMod-\neling and simulation of a variable speed stand-alone generator system,\u201d\nin Proc. Inst. Elect. Eng. Int. Conf. Power Electron. Variable Speed\nDrives, London, U.K., 2000, pp. 372\u2013377.\n[4] B. R. Pelly, Thyristor Phase-Controlled Converters and Cyclocon-\nverters. New York: Wiley-Interscience, 1971, pp. 278\u2013327.\n[5] K. S. Smith and L. Ran, \u201cInput current harmonic analysis of pseudo\n12-pulse 3-phase to 6-phase cycloconverters,\u201d IEEE Trans. Power Elec-\ntron., vol. 11, pp. 629\u2013640, July 1996.\n[6] A. Larsson, \u201cFlicker emission of wind turbines during continuous opera-\ntion,\u201d IEEE Trans. Energy Conversion, vol. 17, pp. 114\u2013118, Mar. 2002.\n[7] Z. M. Salameh and L. F. Kazda, \u201cAnalysis of the double output induction\ngenerator using direct three-phase model, part II\u2014harmonic analysis,\u201d\nIEEE Trans. Energy Conversion, vol. 2, pp. 182\u2013188, June 1987.\n[8] L. Refoufi and P. Pillay, \u201cHarmonic analysis of slip energy recovery\ninduction motor drives,\u201d IEEE Trans. Energy Conversion, vol. 9, pp.\n665\u2013672, Dec. 1994.\n[9] J. Faiz, H. Barati, and E. Akpinar, \u201cHarmonic analysis and performance\nimprovement of slip energy recovery induction motor drives,\u201d IEEE\nTrans. Power Electron., vol. 16, pp. 410\u2013417, May 2001.\n[10] R. Yacamini, K. S. Smith, and L. Ran, \u201cMonitoring torsional vibra-\ntions of electromechanical systems using stator currents,\u201d J. Vibration\nAcoust., Trans. Amer. Soc. Mech. Eng., vol. 120, pp. 72\u201379, 1998.\n[11] P. C. Krause, O. Wasynczuk, and S. D. Sudhoff, Analysis of Electric\nMachinery. New York: IEEE Press, 1995, pp. 164\u2013206.\n[12] Y. Liao, D. Xiang, L. Ran, and G. A. Putrus, \u201cHarmonic transfer in an\na.c. excited generator including speed ripple,\u201d in Proc. 28th Annu. Conf.\nIEEE Ind. Electron. Soc., Sevilla, Spain, 2002.\n[13] M. G. Say, Alternating Current Machines. White Plains, NY:\nLongman, 1983, pp. 250\u2013259.\n[14] L. Ran, R. Yacamini, and K. S. Smith, \u201cTorsional vibrations in electrical\ninduction motor drives during start-up,\u201d J. Vibr. Acoust., Trans. Amer.\nSoc. Mech. Eng., vol. 118, pp. 242\u2013251, 1996.\n[15] P. Ashmole, \u201cQuality of supply\u2014voltage fluctuations, part 2,\u201d Inst.\nElect. Eng. Power Eng. J., vol. 15, no. 2, pp. 108\u2013114, 2001.\n(25)\n(26)\n(27)\n(28)\nLIAO et al.: EVALUATION OF THE EFFECTS OF ROTOR HARMONICS IN A DOUBLY-FED INDUCTION GENERATOR 515\n[16] A. S. Mercer and E. A. Bossanyi, \u201cThe use of variable speed drives for\nactive stall regulation,\u201d in Proc. 18th British Wind Energy Assoc. Conf.,\nM. Anderson, Ed., Exeter, U.K., 1996, pp. 353\u2013357.\nYong Liao received the M.Eng. degree in electrical machinery and the Ph.D.\ndegree in power system control from Chongqing University, Chongqing, China,\nin 1988 and 1997, respectively.\nCurrently, he is a Professor of Electrical Machinery and Apparatus at\nChongqing University. From December 2001 to May 2002, he was a Visiting\nProfessor at Northumbria University, Newcastle upon Tyne, U.K. His research\ninterests include the control of doubly-fed electrical machines as used in\nrenewable energy systems.\nLi Ran (M\u201998) received the Ph.D. degree in power systems from Chongqing\nUniversity, Chongqing, China, in 1989.\nCurrently, he is with the School of Engineering at the University of Durham,\nDurham, U.K., where he is responsible for research in Power Electronics in the\nNew and Renewable Energy Group. Until July 2003, he was a Senior Lecturer in\nPower Electronics at Northumbria University, Newcastle upon Tyne, U.K. From\n1992 and 1999, he was a Research Fellow at Aberdeen University, Aberdeen,\nU.K., Nottingham University, Nottingham, U.K., and Heriot-Watt University,\nEdinburgh, U.K., where he was involved in research regarding marine and off-\nshore electrical systems. His research interests include power system harmonics,\napplication of power electronics in power systems, and electromagnetic compat-\nibility of power electronic systems.\nGhanim A. Putrus received the Ph.D. degree from the University of Man-\nchester Institute of Science and Technology, Manchester, U.K.\nHe joined Northumbria University, Newcastle upon Tyne, U.K., as a Senior\nLecturer in Power System Engineering in 1995. Since moving to Northumbria,\nhe has provided consultancy to several companies including Northern Electric\nDistribution Ltd., Newcastle upon Tyne, U.K., VATECH Reyroll National Grid\nCompany (NGC), Coventry, U.K., and Warner Electric, Tyne and Wear, U.K.\nHis research interests include FACTS, custom power technology, power quality,\nand embedded generation.\nDr. Putrus was a member of the 1999\u20132000 IEE Professional Group P7. He is\nstill regularly involved in IEE professional activities such as organizing lectures\nand refereeing papers.\nKenneth S. Smith (M\u201999) received the Ph.D. degree in electrical engineering\nfrom the University of Aberdeen, Aberdeen, U.K., in 1992.\nCurrently, he is with Mott MacDonald\u2019s Power Systems Division in Glasgow,\nU.K., where he is responsible for power system transient studies. He was an aca-\ndemic staff member at the University of Aberdeen and later Heriot-Watt Uni-\nversity, Edinburgh, U.K., for ten years. He held several EPSRC research grants\nto investigate new methods for marine electrical propulsion and interconnection\nof offshore oil platforms.\n"}