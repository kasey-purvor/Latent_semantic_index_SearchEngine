{"doi":"10.1016\/S0304-3975(02)00329-8","coreId":"66666","oai":"oai:dro.dur.ac.uk.OAI2:598","identifiers":["oai:dro.dur.ac.uk.OAI2:598","10.1016\/S0304-3975(02)00329-8"],"title":"Greedy algorithms, H-colourings and a complexity-theoretic dichotomy.","authors":["Puricella,  A.","Stewart,  I. A."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2003-01","abstract":"Let H be a fixed undirected graph. An H-colouring of an undirected graph G is a homomorphism from G to H. If the vertices of G are partially ordered then there is a generic non-deterministic greedy algorithm which computes all lexicographically first maximal H-colourable subgraphs of G. We show that the complexity of deciding whether a given vertex of G is in a lexicographically first maximal H-colourable subgraph of G is NP-complete, if H is bipartite, and ${\\bf \\Sigma}_2^p$-complete, if H is non-bipartite. This result complements Hell and Nesetril's seminal dichotomy result that the standard H-colouring problem is in P, if H is bipartite, and NP-complete, if H is non-bipartite. Our proofs use the basic techniques established by Hell and Nesetril, combinatorially adapted to our scenario","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/66666.pdf","fullTextIdentifier":"http:\/\/dro.dur.ac.uk\/598\/1\/598.pdf","pdfHashValue":"6460e3d5250b4659dea99bc54676b8bb53f27e51","publisher":"Elsevier","rawRecordXml":"<record><header><identifier>\n  \n    \n      oai:dro.dur.ac.uk.OAI2:598<\/identifier><datestamp>\n      2011-06-14T15:31:26Z<\/datestamp><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        Greedy algorithms, H-colourings and a complexity-theoretic dichotomy.<\/dc:title><dc:creator>\n        Puricella,  A.<\/dc:creator><dc:creator>\n        Stewart,  I. A.<\/dc:creator><dc:description>\n        Let H be a fixed undirected graph. An H-colouring of an undirected graph G is a homomorphism from G to H. If the vertices of G are partially ordered then there is a generic non-deterministic greedy algorithm which computes all lexicographically first maximal H-colourable subgraphs of G. We show that the complexity of deciding whether a given vertex of G is in a lexicographically first maximal H-colourable subgraph of G is NP-complete, if H is bipartite, and ${\\bf \\Sigma}_2^p$-complete, if H is non-bipartite. This result complements Hell and Nesetril's seminal dichotomy result that the standard H-colouring problem is in P, if H is bipartite, and NP-complete, if H is non-bipartite. Our proofs use the basic techniques established by Hell and Nesetril, combinatorially adapted to our scenario.<\/dc:description><dc:subject>\n        Computational complexity<\/dc:subject><dc:subject>\n         Constraint satisfaction<\/dc:subject><dc:subject>\n         Graph algorithms<\/dc:subject><dc:subject>\n         Dicotomies.<\/dc:subject><dc:publisher>\n        Elsevier<\/dc:publisher><dc:source>\n        Theoretical computer science, 2003, Vol.290(3), pp.1897-1913 [Peer Reviewed Journal]<\/dc:source><dc:date>\n        2003-01<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:identifier>\n        dro:598<\/dc:identifier><dc:identifier>\n        issn:0304-3975<\/dc:identifier><dc:identifier>\n        doi:10.1016\/S0304-3975(02)00329-8<\/dc:identifier><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/598\/<\/dc:identifier><dc:identifier>\n        http:\/\/dx.doi.org\/10.1016\/S0304-3975(02)00329-8<\/dc:identifier><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/598\/1\/598.pdf<\/dc:identifier><dc:accessRights>\n        info:en-repo\/semantics\/openAccess<\/dc:accessRights><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["0304-3975","issn:0304-3975"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2003,"topics":["Computational complexity","Constraint satisfaction","Graph algorithms","Dicotomies."],"subject":["Article","PeerReviewed"],"fullText":"Durham Research Online\nDeposited in DRO:\n10 October 2008\nVersion of attached file:\nAccepted Version\nPeer-review status of attached file:\nPeer-reviewed\nCitation for published item:\nPuricella, A. and Stewart, I. A. (2003) \u2019Greedy algorithms, H-colourings and a complexity-theoretic\ndichotomy.\u2019, Theoretical computer science., 290 (3). pp. 1897-1913.\nFurther information on publisher\u2019s website:\nhttp:\/\/dx.doi.org\/10.1016\/S0304-3975(02)00329-8\nPublisher\u2019s copyright statement:\nAdditional information:\nUse policy\nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without prior permission or charge, for\npersonal research or study, educational, or not-for-profit purposes provided that:\n\u2022 a full bibliographic reference is made to the original source\n\u2022 a link is made to the metadata record in DRO\n\u2022 the full-text is not changed in any way\nThe full-text must not be sold in any format or medium without the formal permission of the copyright holders.\nPlease consult the full DRO policy for further details.\nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom\nTel : +44 (0)191 334 3042 \u2014 Fax : +44 (0)191 334 2971\nhttp:\/\/dro.dur.ac.uk\nGreedy algorithms, H-\rolourings and a\n\romplexity-theoreti\r di\rhotomy\nAntonio Puri\rella and Iain A. Stewart,\nDepartment of Mathemati\rs and Computer S\rien\re,\nUniversity of Lei\rester, Lei\rester LE1 7RH, U.K.\nAbstra\rt\nLet H be a \fxed undire\rted graph. An H-\rolouring of an undire\rted graph G is a homo-\nmorphism from G to H. If the verti\res of G are partially ordered then there is a generi\r\nnon-deterministi\r greedy algorithm whi\rh \romputes all lexi\rographi\rally \frst maximal H-\n\rolourable subgraphs ofG. We show that the \romplexity of de\riding whether a given vertex\nof G is in a lexi\rographi\rally \frst maximal H-\rolourable subgraph of G is NP-\romplete, if\nH is bipartite, and \u0006\np\n2\n-\romplete, if H is non-bipartite. This result \romplements Hell and\nNe\u0014set\u0014ril's seminal di\rhotomy result that the standard H-\rolouring problem is in P, if H\nis bipartite, and NP-\romplete, if H is non-bipartite. Our proofs use the basi\r te\rhniques\nestablished by Hell and Ne\u0014set\u0014ril, \rombinatorially adapted to our s\renario.\n1 Introdu\rtion\nIn what is now a seminal result, Hell and Ne\u0014set\u0014ril [6\u2104 established a di\rhotomy for\nthe H-\rolouring problem when H is an undire\rted graph: the H-\rolouring problem\nis in P, if H is bipartite, and is NP-\romplete otherwise. Su\rh a (di\rhotomy) re-\nsult \ran also be thought of as a generi\r result in that it provides a \romplete, exa\rt\n\rlassi\f\ration of the \romputational \romplexities of an in\fnite \rlass of problems (in\nthis \rase, the \rlass of H-\rolouring problems). Other su\rh generi\r results exist. For\nexample, Miyano [8\u2104 proved a very general result relating to hereditary properties of\ngraphs: he showed that the problem of de\riding whether a given vertex of a given\nundire\rted graph G, whose verti\res are linearly ordered, lies in the lexi\rographi-\n\rally \frst maximal subgraph of G satisfying some \fxed polynomial-time testable,\nnon-trivial, hereditary property \u0019 is P-\romplete. (Noti\re that the existen\re of an\nH-\rolouring of an undire\rted graph G, i.e., a homomorphism from G to H, is a\nparti\rular hereditary property of G.)\nA number of other di\rhotomy results (involving unequivo\ral \romplexity-theoreti\r\n\rlassi\f\rations) and generi\r results (appli\rable to an in\fnite \rlass of problems) have\n1\nsin\re been obtained. Examples of other di\rhotomy results in\rlude: Feder and Hell's\nresult [4\u2104 that the list homomorphism problem for re\rexive graphs is solvable in\npolynomial-time if the target graph is an interval graph, and NP-\romplete other-\nwise; Feder, Hell and Huang's [5\u2104 result that the list homomorphism problem for\nirre\rexive graphs is solvable in polynomial-time if the \romplement of the target\ngraph is a \rir\rular ar\r graph of \rlique \rovering number two, and NP-\romplete oth-\nerwise; D\u0013\u0010az, Serna and Thilikos's result [2\u2104 that the \romplexity of the list (H;C;K)-\n\rolouring problem mirrors that of the list homomorphism problem; and Dyer and\nGreenhill's result [3\u2104 that the problem of \rounting the H-\rolourings of a graph is\nsolvable in polynomial-time if every \ronne\rted \romponent of H is a \romplete re-\n\rexive graph with all loops present or a \romplete bipartite irre\rexive graph (with\nno loops present), and \u2104P-\romplete otherwise. Examples of other generi\r results\nin\rlude: Miyano's result [9\u2104 that the problem of de\riding whether a given vertex of a\ngiven undire\rted graph G, whose verti\res are linearly ordered, lies in the lexi\rograph-\ni\rally \frst maximal \ronne\rted subgraph of G satisfying some \fxed polynomial-time\ntestable, hereditary property \u0019 that is determined by the blo\rks and non-trivial on\n\ronne\rted graphs is \u0001\np\n2\n-\romplete; and Puri\rella and Stewart's result [11\u2104 that the\nproblem of de\riding whether a given vertex of a given undire\rted graph G, whose\nverti\res are partially ordered, lies in a lexi\rographi\rally \frst maximal subgraph of\nG satisfying some \fxed polynomial-time testable, non-trivial, hereditary property \u0019\nis NP-\romplete.\nDi\rhotomy and generi\r results su\rh as those highlighted above are parti\rularly\nattra\rtive as they give a \ron\rise and simpli\fed view of a parameterized world of\nnatural problems. In this paper, we \ronsider the problem of de\riding whether a\ngiven vertex of a given undire\rted graph G, whose verti\res are partially ordered,\nlies in a lexi\rographi\rally \frst maximal H-\rolourable subgraph of G (where the\nundire\rted graph H is \fxed). In parti\rular, we prove that this problem is NP-\n\romplete, if H is bipartite, and \u0006\np\n2\n-\romplete, if H is non-bipartite; thus establishing\nyet another \romplexity-theoreti\r di\rhotomy result. Our proofs use the te\rhniques\nestablished by Hell and Ne\u0014set\u0014ril in [6\u2104 although they are \rombinatorially adapted\na\r\rording to our \rir\rumstan\res. However, part of Hell and Ne\u0014set\u0014ril's \ronstru\rtions\n\ran be applied verbatim and this substantially shortens our exposition.\n2 Basi\r de\fnitions\nFor standard graph-theoreti\r de\fnitions the reader is referred to [1\u2104, and for standard\n\romplexity-theoreti\r de\fnitions to [10\u2104.\nLet G = (V;E) be an undire\rted graph and suppose that the verti\res of V are\nlinearly ordered. Given a subset S = fs\n0\n; s\n1\n; s\n2\n; : : : ; s\nk\ng of V , where the indu\red\nordering is s\n0\n< s\n1\n< : : : < s\nk\n, we \ran de\fne a lexi\rographi\r order on the set of all\nsubsets of S as follows (we \rall it lexi\rographi\r be\rause we \ronsider s\n0\n; s\n1\n; : : : ; s\nk\nto\nbe our alphabet):\n2\n\u000f for subsets U = fu\n1\n; u\n2\n; : : : ; u\np\ng and W = fw\n1\n; w\n2\n; : : : ; w\nk\ng of S, where u\n1\n<\nu\n2\n< : : : < u\np\nand w\n1\n< w\n2\n< : : : < w\nk\n, we say that U is lexi\rographi\rally\nsmaller than W if:\n{ there is a number t, where 1 \u0014 t \u0014 p, su\rh that u\nt\n< w\nt\nand u\ni\n= w\ni\n, for\nall i su\rh that 1 \u0014 i < t; or\n{ k > p and u\ni\n= w\ni\n, for all i su\rh that 1 \u0014 i \u0014 p.\nLet \u0019 be some property of graphs (our graphs are all undire\rted). If we take S = V\nthen we \ran talk about the lexi\rographi\rally \frst maximal subgraph ofG that satis\fes\n\u0019 (as Miyano does in [8\u2104).\nNow let G = (V;E) be an undire\rted graph, let P be a partial order on V and\nlet s 2 V . We assume that the partial order P is given in the form of an a\ry\rli\r\ndigraph detailing the immediate prede\ressors, i.e., the parents, and the immediate\nsu\r\ressors, i.e., the \rhildren, of ea\rh vertex. We think of a partial order P as\nen\roding a \rolle\rtion of linear orders of the form s = s\n0\n< s\n1\n< s\n2\n< : : : < s\nk\n, where\ns\nj+1\nis a \rhild of s\nj\n, for 0 \u0014 j < k, and s\nk\nhas no \rhildren. Note that a partial order\n\ran en\rode an exponential number of linear orders.\nLet \u0019 be some property of graphs. Now we \ran talk of the lexi\rographi\rally \frst\nmaximal subgraphs of G satisfying \u0019; where we get one su\rh subgraph for every\nlinear order en\roded within P . A property \u0019 on graphs is hereditary if whenever we\nhave a graph with the property \u0019 then the deletion of any vertex and its in\rident\nedges does not produ\re a graph violating \u0019, i.e., \u0019 is preserved by vertex-indu\red\nsubgraphs. It is straightforward to see that the sets of verti\res that indu\re these\nlexi\rographi\rally \frst maximal subgraphs of G satisfying some hereditary property\n\u0019 \ran be obtained using the following non-deterministi\r algorithm GREEDY(\u0019) (if\nP is a linear order then this algorithm \romputes the lexi\rographi\rally \frst maximal\nsubgraph ofG satisfying \u0019). The algorithmGREEDY(\u0019) takes as input 3 arguments:\nan undire\rted graph G = (V;E), a dire\rted a\ry\rli\r graph P = (V;D) and a spe\ri\fed\nvertex s 2 V ; and is as follows:\ninput(G,P,s)\nS := ;\n\rurrent-vertex := s\nif \u0019(S[f\rurrent-vertex g,G ) then (\u0003)\nS := S[f\rurrent-vertex g\nfi\nwhile \rurrent-vertex has at least one \rhild in P do\n\rurrent-vertex := a \rhild of \rurrent-vertex in P\nif \u0019(S[f\rurrent-vertex g,G ) then (\u0003\u0003)\nS := S[f\rurrent-vertex g\nfi\nod\noutput(S )\n3\nwhere \u0019(S [ f\rurrent-vertexg; G) is a predi\rate evaluating to `true' if, and only if,\nthe subgraph of G indu\red by the verti\res of S [ f\rurrent-vertexg satis\fes \u0019. We\nsay that a vertex v is the \rurrent-vertex if we have `frozen' an exe\rution of the\nalgorithm GREEDY(\u0019) immediately prior to exe\ruting either line (\u0003) or line (\u0003\u0003)\nand the value of the variable \rurrent-vertex at this point is v.\nA property \u0019 is \ralled non-trivial on a \rlass of graphs if there are in\fnitely many\ngraphs from this \rlass satisfying \u0019 but \u0019 is not satis\fed by all graphs of the \rlass.\nLet C be a \rlass of graphs and let \u0019 be some property of graphs. The problem\nGREEDY(partial order, C, \u0019) has: as its instan\res tuples (G;P; s; x), where G is\na graph from C, P is a partial order of the verti\res of G and s and x are verti\res\nof G; and as its yes-instan\res those instan\res for whi\rh there exists an exe\rution\nof the algorithm GREEDY(\u0019) on input (G;P; s) resulting in the output of a set of\nverti\res \rontaining the vertex x. The problemGREEDY(linear order, C, \u0019) is de\fned\nsimilarly ex\rept that P is a linear order. As mentioned earlier, when \u0019 is polynomial-\ntime testable, non-trivial and hereditary, Miyano [8\u2104 proved that GREEDY(linear\norder, undire\rted graphs, \u0019) is P-\romplete, and Puri\rella and Stewart [11\u2104 proved\nthat GREEDY(partial order, undire\rted graphs, \u0019) is NP-\romplete.\nLet G and H be graphs. A homomorphism from G to H is a map f from the\nverti\res of G to the verti\res of H su\rh that if (u; v) is an edge of G then (f(u); f(v))\nis an edge of H. The H-\rolouring problem is the problem whose instan\res are graphs\nG and whose yes-instan\res are those graphs G for whi\rh there is a homomorphism\nfrom G to H.\nIf U is a subset of verti\res of the graph G then hUi\nG\nis the subgraph of G indu\red\nby the set of verti\res U . A graph is 3-\rolourable if the verti\res \ran be \roloured with\na unique \rolour from red, white and blue so that two adja\rent verti\res are \roloured\ndi\u000berently; and the 3-\rolouring problem has as an instan\re a graph G and as a\nyes-instan\re a graph G that is 3-\rolourable.\n3 A \romplete problem\nOur proof of our main result in the next se\rtion follows the strategy adopted by\nHell and Ne\u0014set\u0014ril. Essentially, we assume that H is a non-bipartite graph for whi\rh\nthe problem GREEDY(partial order, undire\rted graphs, H-\rolouring) is not \u0006\np\n2\n-\n\romplete and apply a sequen\re of \ronstru\rtions to yield that a known \u0006\np\n2\n-\romplete\nproblem is not \romplete, thereby obtaining a \rontradi\rtion. Our `known' problem\n\u0006\np\n2\n-\romplete is GREEDY(partial order, undire\rted graphs, 3-\rolourable).\nTheorem 1 The problem GREEDY (partial order, undire\rted graphs, 3-\rolourable)\nis \u0006\np\n2\n-\romplete.\nProof Throughout this proof, the problem GREEDY(partial order, undire\rted\ngraphs, 3-\rolourable) shall be denoted G. We shall prove \rompleteness by redu\r-\ning from the problem NOT CERTAIN 3-COLOURING OF BOOLEAN EDGE-\nLABELLED GRAPHS, hen\reforth to be abbreviated as problem N . An instan\re\n4\nof N of size n \ronsists of an undire\rted graph H on n verti\res, some of whose\nedges are labelled with the disjun\rtion of two (possibly identi\ral) literals over the\nset of Boolean variables fX\ni;j\n: i; j = 1; 2; : : : ; ng (the same literal may appear\nin more than one disjun\rtion). A truth assignment t on the Boolean variables of\nfX\ni;j\n: i; j = 1; 2; : : : ; ng makes some of the labels on the edges of H true and some\nfalse. Form the graph t(H) by retaining the edges labelled true, as well as any\nunlabelled edges, and dispensing with the edges labelled false. A yes-instan\re is an\ninstan\re H for whi\rh there exists a truth assignment t resulting in a graph t(H)\nthat \rannot be 3-\roloured. This problem was proven to be \u0006\np\n2\n-\romplete in [12\u2104.\nGiven an instan\re H of the problemN , we shall \ronstru\rt an instan\re (G;P; s; x)\nof the problem G where G is an undire\rted graph, P is a partial order on these same\nverti\res and s and x are two distinguished verti\res. Moreover, H will be a yes-\ninstan\re of N if, and only if, (G;P; s; x) is a yes-instan\re of G; and the \ronstru\rtion\nwill be su\rh that it \ran be \rompleted using logspa\re.\nLet H = (U; F ) and suppose that U = f1; 2; : : : ; ng. We build the undire\rted\ngraph G from H as follows.\n(a) For ea\rh vertex i 2 U , `atta\rh' a \ropy of K\n4\nby identifying vertex i with\none of the verti\res of the \rlique. Denote the other three verti\res by a\ni\n, b\n1\ni\nand b\n2\ni\n. We refer to the original verti\res of U as H-verti\res, the verti\res of\nfa\ni\n: i = 1; 2; : : : ; ng as a-verti\res and the verti\res of fb\n1\ni\n; b\n2\ni\n: i = 1; 2; : : : ; ng\nas b-verti\res.\n(b) Retain any unlabelled edge (i; j) of F (between H-verti\res i and j).\n(\r) For any labelled edge (i; j) of F (between H-verti\res i and j), where i < j and\nwhere the label is L\n1\ni;j\n_L\n2\ni;j\n, repla\re the edge with a \ropy of the graph G\n1\nshown\nin Fig. 1. We use, for example, L\n1\ni;j\nto refer to the \frst literal labelling edge (i; j)\nand also a vertex within a graph G\n1\n: this \rauses no \ronfusion. The verti\res\nof fL\n1\ni;j\n; L\n2\ni;j\n;\n\u0016\nL\n1\ni;j\n;\n\u0016\nL\n2\ni;j\n: (i; j) 2 F; where i < jg are \ralled L-verti\res. Every L-\nvertex of any G\n1\nhas an asso\riated literal, e.g., if the literal L\n1\n4;6\n= :X\n3;2\nthen\nthe asso\riated literal of vertex L\n1\n4;6\nis :X\n3;2\nand the asso\riated literal of vertex\n\u0016\nL\n1\n4;6\nis X\n3;2\n. So, an L-vertex of some G\n1\nmight have the same asso\riated literal\nas an L-vertex of some otherG\n1\n. Finally, the verti\res of f\r\ni;j\n: i; j = 1; 2; : : : ; ng\nare \ralled \r-verti\res, the verti\res of fd\ni;j\n: i; j = 1; 2; : : : ; ng are \ralled d-verti\res\nand the verti\res of fe\n1\ni;j\n; e\n2\ni;j\n: i; j = 1; 2; : : : ; ng are \ralled e-verti\res.\n(d) In\rlude a disjoint \ropy of K\n4\n, whose verti\res are fy; z; w; xg and join verti\res\ny, z and w to every a-vertex. In\rlude the vertex s as an independent vertex.\nOur partial ordering P is de\fned as follows. First, order the Boolean variables\nfX\ni;j\n: i; j = 1; 2; : : : ; ng lexi\rographi\rally as\nX\n1;1\n; X\n1;2\n; X\n1;3\n; : : : ; X\n1;n\n; X\n2;1\n; X\n2;2\n; : : : ; X\nn;n\n5\nand denote this ordering by <\nX\n; so X\n1;1\n<\nX\nX\n1;2\n<\nX\nX\n1;3\n<\nX\n: : :. Next, \ronsider\nthe L-verti\res. We obtain the notions of a positive L-vertex, where the vertex has\nan asso\riated positive literal, and a negative L-vertex, where the vertex has an\nasso\riated negative literal. Order the positive L-verti\res so that if vertex \u0015\ni\nis less\nthan vertex \u0015\nj\nin this ordering then the asso\riated literal of \u0015\ni\nis less than or equal\nto the asso\riated literal of \u0015\nj\nwith respe\rt to the ordering <\nX\n(note that there may\nbe a number of su\rh orderings on the positive L-verti\res: it does not matter whi\rh\nof them we use). We obtain an analogous ordering of the negative L-verti\res by\ntaking \romplements (note that for every positive L-vertex L\nm\ni;j\nor\n\u0016\nL\nm\ni;j\nwith label l,\nthe vertex\n\u0016\nL\nm\ni;j\nor L\nm\ni;j\n, respe\rtively, is a negative L-vertex with label :l; and vi\re\nversa). As we walk down these two orderings in a syn\rhronous fashion, the pairs\nof L-verti\res are always \romplementary as is the pair of asso\riated literals. Denote\nthese orderings as\n\u0015\n1\n< \u0015\n2\n< : : : < \u0015\nk\nand \u0016\n1\n< \u0016\n2\n< : : : < \u0016\nk\n;\nrespe\rtively, where f\u0015\ni\n; \u0016\ni\n: i = 1; 2; : : : ; kg = fL\n1\ni;j\n; L\n2\ni;j\n;\n\u0016\nL\n1\ni;j\n;\n\u0016\nL\n2\ni;j\n: (i; j) 2 F; where\ni < jg.\ni\n1 i\na a a\n...\nz\nn\ni\ni\na\ni\nb\n1\ni\nb\n2\n( )a\ni\nj\nv L\ni,j\n2\nL\ni,j\n1\n-\nthe graph G1\nL\ni,j\n1\ni\nj\ni,j\ne\n1\ni,j\ne\n2\nL\ni,j\n2\nL\ni,j\n1\nL\ni,j\n2\n-\ni,j\nc\ni,j\nd\n( )c\n...\ny\nx\nw\n( )d\nFigure 1. Phases (a), (\r) and (d) of \ronstru\rting G from H.\nOur partial ordering P begins as follows. The vertex s is less than both \u0015\n1\nand\n\u0016\n1\n; and then we have the orderings \u0015\n1\n< \u0015\n2\n< : : : < \u0015\nk\nand \u0016\n1\n< \u0016\n2\n< : : : < \u0016\nk\n.\nAlso, for any index i 2 f1; 2; : : : ; k \u0000 1g, if the asso\riated literal of \u0015\ni\nis di\u000berent\nfrom the asso\riated literal of \u0015\ni+1\nthen additionally \u0015\ni\n< \u0016\ni+1\nand \u0016\ni\n< \u0015\ni+1\n. In\norder to \romplete P , \rhoose any linear ordering of the \r-verti\res, followed by any\nlinear ordering of the d-verti\res, followed by any linear ordering of the e-verti\res,\nfollowed by the ordering 1; 2; : : : ; n of the H-verti\res, followed by any linear ordering\nof the b-verti\res, followed by any linear ordering of the a-verti\res, followed by the\nordering w, y, z, x; and additionally de\fne that both \u0015\nk\nand \u0016\nk\nare less than the\nleast \r-vertex (if there are no L-verti\res then just \ron\ratenate the linear ordering of\nthe \r-verti\res after the vertex s).\n6\nThe \ronstru\rtion of (G;P; s; x) from H is illustrated in Fig. 2 (note that to avoid\n\rluttering the \fgure, not all verti\res are named; and the bold edges \rorrespond to\nthe stru\rture of H). Clearly, this \ronstru\rtion \ran be \rompleted using logspa\re.\ns\n4\n3\n2\n1\nX2,2X2,1 v \u00ac\nv X1,3X2,1\nvX X3,12,1\u00ac\n3\n2\n1\n_\nL3,4\n2\nL3,4\n1\n_\nL\n2\nL3,4\n1\nL2,3\n1\nL1,2\n1\nL2,3\n1\n_\nL1,2\n1\n_\n_\nL2,3\n2\n_\nL1,2\n2\nL2,3\n2\nL1,2\n2\nassociated\nliteral\nX2,1\nassociated\nliteral\nX2,2\nX2,1\na 1\na 2\na 3\nz\ny w\nx\nthelabelled\ngraph H\nthe graph G\nthe partial\norder P a\n4 3,44\n...\nc4 d1c3\n1\nc2\ns\nL1,2\n1\nL2,3\n2\n_\nL2,3\n2\nL2,3\n1\nL1,2\n1\nL3,4\n1\n_ _\nL1,2\n2\nL3,4\n2\nL2,3\n1\n_\nL1,2\n1\n_\nL3,4\n1\nL3,4\n2\n_\nc1\nX1,3 X2,1 X2,1 X2,1 X2,2 X3,1\nX1,3\u00ac X2,1\u00ac X2,1\u00ac X2,1\u00ac X2,2\u00ac X3,1\u00ac\nassociated\nliterals\nassociated\nliterals\nFigure 2. The \ronstru\rtion of (G;P; s; x) from H.\nSuppose that H is a yes-instan\re of problem N . Hen\re, there exists a truth\nassignment t su\rh that t(H) is not 3-\rolourable. Consider the exe\rution of the\nalgorithm GREEDY(3-\rolourable) on (G;P; s; x) where the \rhosen linear order in\nP is that indu\red by the truth assignment t; that is, an L-vertex is \rhosen if, and\nonly if, its asso\riated Boolean literal is set at true by t. The \frst point to note is\nthat s and every L-vertex \rhosen is output by GREEDY(3-\rolourable), as is every\n\r-vertex. Let us freeze the exe\rution at this point. Note that if the truth assignment\nt makes the label of some edge (i; j) of F true then at our freeze-point, the vertex\nd\ni;j\nis adja\rent to at most 2 verti\res of S, and so this vertex d\ni;j\nis subsequently\noutput by GREEDY(3-\rolourable).\nConversely, if the truth assignment t makes the label of some edge (i; j) of F false\nthen at our freeze-point, the vertex d\ni;j\nis adja\rent to 3 mutually adja\rent verti\res\nof S and so this vertex d\ni;j\nis not subsequently output by GREEDY(3-\rolourable).\n7\nUnroll the exe\rution of GREEDY(3-\rolourable) until every d-vertex and e-vertex\nhas been \ronsidered. Note that every e-vertex is output regardless. Let us freeze\nthe exe\rution for a se\rond time at this point.\nOur next task in the exe\rution is to \ronsider the H-verti\res as to whether they\nare output or not. Let (i; j) be some edge of F whi\rh is either unlabelled or whose\nlabel has been made true by t. It may or may not be the \rase that the verti\res i and\nj are output; but if they are both output then at the point after the se\rond of these\nverti\res is output, the subgraph indu\red by the verti\res of S \ran be 3-\roloured but\nnot so that i and j have the same \rolour. This is so be\rause ea\rh of the verti\res d\ni;j\n,\ne\n1\ni;j\nand e\n2\ni;j\nis in S. Hen\re, as we know that t(H) \rannot be 3-\roloured, there must be\nsome H-vertex that is not output; and, \ronsequently, there is at least one a-vertex\noutput. Having an a-vertex output means that not all of fy; z; wg are output whi\rh\nin turn means that x is output. Hen\re, (G;P; s; x) is a yes-instan\re of problem G.\nConversely, suppose that (G;P; s; x) is a yes-instan\re of problem G. Fix an\na\r\repting exe\rution of the algorithm GREEDY(3-\rolourable) on input (G;P; s; x)\nand denote the linear order \rhosen within P by \u0019. This exe\rution gives rise to a\ntruth assignment t on the literals labelling the edges of the graph H: if \u0019 is su\rh\nthat a positive L-vertex, with asso\riated literal X\ni;j\n, say, is \rhosen then set t(X\ni;j\n)\nto be true; and if \u0019 is su\rh that a negative L-vertex, with asso\riated literal :X\ni;j\n,\nsay, is \rhosen then set t(X\ni;j\n) to be false (note that this truth assignment is well-\nde\fned). As before, every L-vertex on \u0019 is output by GREEDY(3-\rolourable); and,\nby arguing as we did earlier, for any i; j 2 f1; 2; : : : ; ng with i < j and where (i; j)\nis a labelled edge of H, the truth assignment t makes L\n1\ni;j\n_ L\n2\ni;j\ntrue if, and only if,\nthe verti\res d\ni;j\n, e\n1\ni;j\nand e\n2\ni;j\nare output.\nAt various points in the exe\rution of GREEDY(3-\rolourable), a \rhe\rk is made\nto see whether the verti\res of S indu\re a 3-\rolourable graph. Consider su\rh a \rhe\rk\nand suppose that the verti\res of fd\ni;j\n; e\n1\ni;j\n; e\n2\ni;j\ng have been pla\red in S. Consider the\nsubgraph K of G indu\red by those verti\res that are both in S and in the \ropy of G\n1\npertaining to the labelled edge (i; j) of H. In parti\rular, \ronsider the role of K when\nit \romes to attempting to \rolour the subgraph of G indu\red by the verti\res of S. A\nsimple \rombinatorial veri\f\ration yields that the role of the verti\res of K is to allow i\nand j to be \roloured with any pair of distin\rt \rolours but not with identi\ral \rolours.\nHen\re, any \rhe\rk to see whether the subgraph of G indu\red by the verti\res of S \ran\nbe 3-\roloured is equivalent to a \rhe\rk of whether the subgraph of t(H) indu\red by\n(verti\res \rorresponding to) the H-verti\res of S \ran be 3-\roloured. We know that\nour a\r\repting \romputation on (G;P; s; x) outputs x. This \ran only happen if not\nall of fy; z; wg are output, i.e., if at least one a-vertex, a\nm\n, say, is output, i.e., if the\nH-vertex m is not output, i.e., if the graph t(H) \ran not be 3-\roloured. The result\nfollows.\n8\n4 The \ronstru\rtion\nWe now prove our main result using the te\rhniques originating with Hell and\nNe\u0014set\u0014ril. Of \rourse, these te\rhniques have to be adapted to our s\renario.\nTheorem 2 The problem GREEDY (partial order, undire\rted graph, H-\rolourable)\nis NP-\romplete, if H is bipartite, and \u0006\np\n2\n-\romplete, if H is non-bipartite.\nProof Throughout the proof we shall denote the problem GREEDY(partial order,\nundire\rted graphs, H-\rolourable) by G\nH\n. Clearly, G\nH\n\ran be solved in \u0006\np\n2\n, if H is\nnon-bipartite, and in NP, if H is bipartite (the latter be\rause the H-\rolourability\nproblem, for H-bipartite, \ran be solved in polynomial-time [6\u2104). Moreover, be\rause\nthe property of being H-\rolourable, for H bipartite, is non-trivial on graphs, hered-\nitary, satis\fed by all sets of independent edges and polynomial-time testable, by\n[11\u2104 we have that G\nH\nis NP-\romplete if H is bipartite\n1\n. A\rtually, note that if H\nis bipartite then G\nH\nand the problem GREEDY(partial order, undire\rted graphs,\nbipartite) are one and the same.\nTo prove that for any non-bipartite graph H, the problem G\nH\nis \u0006\np\n2\n-\romplete, we\nwill modify the proof of Theorem 1 of [6\u2104 whi\rh states that: `If H is bipartite then\nthe H-\rolouring problem is in P. If H is non-bipartite then the H-\rolouring problem\nis NP-\romplete.' The proof begins by detailing three ways of \ronstru\rting a graph\nH\n0\nfrom a graph H su\rh that if the H\n0\n-\rolouring problem is NP-\romplete then the\nH-\rolouring problem is NP-\romplete as well. We will show that su\rh \ronstru\rtions\n\ran be used to prove that the problem G\nH\nis \u0006\np\n2\n-\romplete.\nConstru\rtion A: The indi\rator \ronstru\rtion.\nLet I be a \fxed graph and let i and j be distin\rt verti\res of I su\rh that some\nautomorphism of I maps i to j and j to i. The indi\rator \ronstru\rtion (with respe\rt\nto (I; i; j)) transforms a given graph H into a graph H\n\u0003\nde\fned to be the subgraph\nof H indu\red by all edges (h; h\n0\n) for whi\rh there is a homomorphism of I to H\nmapping i to h and j to h\n0\n. Be\rause of our assumptions on I, the edges of H\n\u0003\nwill\nbe undire\rted. The \ronstru\rtion is illustrated in Fig. 3.\nH\nH\n*\nI\ni j\nFigure 3. The indi\rator \ronstru\rtion.\n1\nA\rtually, the result proven in [11\u2104 insists that the property should be non-trivial on planar\nbipartite graphs, but it is straight-forward to weaken this assumption and still obtain our appli\ra-\ntion.\n9\nLemma 3 If the problem G\nH\n\u0003\nis \u0006\np\n2\n-\romplete then so is G\nH\n.\nProof Assume that G\nH\n\u0003\nis \u0006\np\n2\n-\romplete; and so, in parti\rular, H\n\u0003\nhas at least one\nedge (otherwise H\n\u0003\nwould be the empty graph and G\nH\n\u0003\nwould not be \u0006\np\n2\n-\romplete).\nWe will redu\re G\nH\n\u0003\nto G\nH\n(via a logspa\re redu\rtion). Let (G\n\u0003\n; P\n\u0003\n; s\n\u0003\n; x\n\u0003\n) be an\ninstan\re of G\nH\n\u0003\n. From it, we shall \ronstru\rt an instan\re (G;P; s; x) of G\nH\n.\nGraph G is obtained from G\n\u0003\nas follows. For any vertex i of G\n\u0003\n, there is a\n\rorresponding vertex i of G: we will refer to su\rh verti\res of G as G\n\u0003\n-verti\res (note\nhow we \ronsider the G\n\u0003\n-verti\res of G and the verti\res of G\n\u0003\nas being identi\rally\nnamed). For any edge (u; v) of G\n\u0003\n, we add a \ropy of graph I to G by identifying\nthe G\n\u0003\n-vertex u with vertex i in I and the G\n\u0003\n-vertex v with vertex j in I (all added\n\ropies of I are disjoint).\nThe partial order P \ronsists of a linear order L (any one will do) on the verti\res\nof G whi\rh are not G\n\u0003\n-verti\res, and we \ron\ratenate on to this linear order the\npartial order P\n\u0003\n(of the G\n\u0003\n-verti\res). Vertex s is the \frst vertex of the linear order\nL and vertex x is the G\n\u0003\n-vertex x\n\u0003\n. An illustration of this \ronstru\rtion is depi\rted\nin Fig. 4 (where the graphs I, H and H\n\u0003\nare as in Fig. 3).\nthe partial order P the graph G\ns\nx\ns\nx\nthe partial order P\n\u2026\ns\nx\ns s\nx\nthe graph G\n* *\n*\n*\n*\n*\n* *\nFigure 4. Building (G;P; s; x) from (G\n\u0003\n; P\n\u0003\n; s\n\u0003\n; x\n\u0003\n).\nConsider the algorithm GREEDY(H-\rolourable) on the input (G;P; s). As H\n\u0003\n\rontains at least one edge, there is a homomorphism from I to H. Hen\re, as the\nlinear order L \ronsists of disjoint \ropies of Infi; jg, GREEDY(H-\rolourable) outputs\n10\nevery vertex of L. After \ronsideration of the verti\res of L, GREEDY(H-\rolourable)\nis working with essentially the same partial order as is the algorithm GREEDY(H\n\u0003\n-\n\rolourable) initially on input (G\n\u0003\n; P\n\u0003\n; s\n\u0003\n); so \ronsider exe\rutions of these algorithms\nwith respe\rt to the same subsequent linear order.\nOur indu\rtion hypothesis is as follows: `The \rurrent-vertex in both exe\rutions\nis s\n0\n; GREEDY(H-\rolourable) has so far output the verti\res of L[ fs\n1\n; s\n2\n; : : : ; s\nm\ng,\nwhere vertex s\ni\nis a G\n\u0003\n-vertex, for i = 1; 2; : : : ; m; and GREEDY(H\n\u0003\n-\rolourable)\nhas so far output the verti\res of fs\n1\n; s\n2\n; : : : ; s\nm\ng.'\nSuppose that the indu\rtion hypothesis holds at some point (it \rertainly holds\nwhen s\n0\n= s\n\u0003\n).\nSuppose that GREEDY(H\n\u0003\n-\rolouring) outputs the vertex s\n0\n. This means that\nthere exists an homomorphism f\n\u0003\n: hfs\n0\n; s\n1\n; : : : ; s\nm\ngi\nG\n\u0003\n! H\n\u0003\n. By \ronstru\rtion\nof H\n\u0003\n, there must exist a homomorphism f : hL [ fs\n0\n; s\n1\n; : : : ; s\nm\ngi\nG\n! H, where\nf(s\ni\n) = f\n\u0003\n(s\ni\n), for i = 0; 1; : : : ; m, and f(v) is the `natural' map for v 2 L (derived\nfrom the de\fnition of H\n\u0003\nfrom H). Hen\re, GREEDY(H-\rolourable) outputs the\nvertex s\n0\n.\nConversely, suppose that GREEDY(H-\rolourable) outputs the vertex s\n0\n. This\nmeans that there exists a homomorphism f : hL[fs\n0\n; s\n1\n; : : : ; s\nm\ngi\nG\n! H. Again by\n\ronstru\rtion of H\n\u0003\n, there must exist a homomorphism f\n\u0003\n: hfs\n0\n; s\n1\n; : : : ; s\nm\ngi\nG\n\u0003\n!\nH\n\u0003\n, where f\n\u0003\n(s\ni\n) = f(s\ni\n), for i = 0; 1; : : : ; m. Hen\re, GREEDY(H\n\u0003\n-\rolouring)\noutputs the vertex s\n0\n. The result follows by indu\rtion.\nConstru\rtion B : The sub-indi\rator \ronstru\rtion.\nLet J be a \fxed graph with spe\ri\fed (distin\rt) verti\res j and k\n1\n; k\n2\n; : : : ; k\nt\n, for\nsome t \u0015 1. The sub-indi\rator \ronstru\rtion (with respe\rt to J; j; k\n1\n; k\n2\n; : : : ; k\nt\n)\ntransforms a given graph H with t (distin\rt) spe\ri\fed verti\res h\n1\n; h\n2\n; : : : ; h\nt\nto its\nsubgraph\n~\nH indu\red by the vertex set\n~\nV de\fned as follows. A vertex v of H belongs\nto\n~\nV just if there exists a homomorphism of J to H taking k\ni\nto h\ni\n, for i = 1; 2; : : : ; t,\nand taking j to v. An illustration of this \ronstru\rtion is depi\rted in Fig. 5 (where,\nfor \rlarity, we have shown the verti\res of H ex\rluded from\n~\nH).\nLemma 4 If the problem G\n~\nH\nis \u0006\np\n2\n-\romplete then so is G\nH\n.\nProof Assume that G\n~\nH\nis \u0006\np\n2\n-\romplete; and so, in parti\rular,\n~\nH has at least one\nvertex. We will redu\re G\n~\nH\nto G\nH\n(via a logspa\re redu\rtion). Let (\n~\nG;\n~\nP; ~s; ~x) be an\ninstan\re of G\n~\nH\n. From it, we shall \ronstru\rt an instan\re (G;P; s; x) of G\nH\n.\nThe graph G is built from: a \ropy of\n~\nG, of size n; a \ropy of H; and n \ropies of\nJ (with J and H prior to the statement of the lemma), by identifying the vertex\nk\ni\nin any \ropy of J with the vertex h\ni\nof H, for i = 1; 2; : : : ; t, and identifying\nthe vertex j in the i\nth\n\ropy of J with the i\nth\nvertex of\n~\nG, for i = 1; 2; : : : ; n. The\nverti\res of G \rorresponding to the verti\res of\n~\nG (and the verti\res j of the \ropies of\nJ) are \ralled\n~\nG-verti\res, the verti\res of G \rorresponding to the verti\res of the \ropies\nof J but di\u000berent from j; k\n1\n; k\n2\n; : : : ; k\nt\nare \ralled J-verti\res, and the verti\res of G\n\rorresponding to the verti\res of H are \ralled H-verti\res.\n11\nJj\nk1\nH\nH\n~\nk2\nh1\nh2\nh1\nh2\nFigure 5. Building\n~\nH from H and J .\nThe partial order P \ronsists of any linear ordering of the H-verti\res, \ron\rate-\nnated onto any linear ordering of the J-verti\res \ron\ratenated onto the ordering\n~\nP of\nthe\n~\nG-verti\res. The vertex s is the \frst H-vertex in the ordering P and the vertex\nx is the vertex ~x of\n~\nP . The whole \ronstru\rtion \ran be pi\rtured in Fig. 6. Clearly,\nthis \ronstru\rtion \ran be undertaken using logspa\re.\nWe begin by showing that any exe\rution of GREEDY(H-\rolourable) on input\n(G;P; s) outputs every H-vertex and J-vertex of G. Clearly every H-vertex is\noutput. Consider some \ropy of J (used in the formation of G). As\n~\nH has at least\none vertex, there is a homomorphism from J to H taking k\ni\nto h\ni\n, for i = 1; 2; : : : ; t.\nHen\re, every J-vertex is output. Denote the set of H-verti\res and J-verti\res of G\nby L.\nConsider the algorithm GREEDY(H-\rolourable) on the input (G;P; s), where\nthe \rurrent-vertex is ~s (with the verti\res of L having been output so far), and\nthe algorithm GREEDY(\n~\nH-\rolourable) on the input (\n~\nG;\n~\nP; ~s) where the \rurrent-\nvertex is ~s (note how we \ronsider the\n~\nG-verti\res of G and the verti\res of\n~\nG as\nbeing identi\rally named). Essentially, these two algorithms work with the same\npartial order; so \ronsider exe\rutions of these algorithms with respe\rt to the same\nsubsequent linear order.\nOur indu\rtion hypothesis is as follows: `The \rurrent-vertex in both exe\rutions\nis s\n0\n; GREEDY(H-\rolourable) has so far output the verti\res of L[ fs\n1\n; s\n2\n; : : : ; s\nm\ng,\nwhere ea\rh s\ni\nis a\n~\nG-vertex, for i = 1; 2; : : : ; m; and GREEDY(\n~\nH-\rolourable) has so\nfar output the verti\res of fs\n1\n; s\n2\n; : : : ; s\nm\ng.'\nSuppose that the indu\rtion hypothesis holds at some point (it \rertainly holds\nwhen s\n0\n= ~s).\nSuppose that s\n0\nis output by GREEDY(H-\rolourable). That is, there is a ho-\nmomorphism f : hL [ fs\n0\n; s\n1\n; : : : ; s\nm\ngi\nG\n! H. In parti\rular: f(s\ni\n) is a vertex of\n~\nH,\nfor i = 0; 1; : : : ; m; and if (s\ni\n; s\nj\n) is an edge of\n~\nG then (f(s\ni\n); f(s\nj\n)) is an edge of\n~\nH,\nfor i; j = 0; 1; : : : ; m. Hen\re, we have a homomorphism\n~\nf : hfs\n0\n; s\n1\n; : : : ; s\nm\ngi\n~\nG\n!\n~\nH,\nand so s\n0\nis output by GREEDY(\n~\nH-\rolourable).\n12\n...... ... ...\n...\ng1 g2 gn\n...\nh1 h2 h t\nthe copiesof J\n...\n...\ng1 g2 gn\nh1 h2 h t\nk 1 k 2 k tk 1 k 2 k tk\nj j j\n1 k 2 k t\nG\n~\n~\nH\nthe graph G\nthe partial\norder P\nthe partial order Pthe -vertices and -verticesH J\n\u2026\ns\ns\nx\n~\nFigure 6. Building G from H, \ropies of J and\n~\nG.\nConversely, suppose that s\n0\nis output by GREEDY(\n~\nH-\rolourable). That is,\nthere is a homomorphism\n~\nf : hfs\n0\n; s\n1\n; : : : ; s\nm\ngi\n~\nG\n!\n~\nH. Consider the \ropy of J\n\rorresponding to the\n~\nG-vertex s\ni\nof G. As\n~\nf(s\ni\n) is a vertex of\n~\nH,\n~\nf \ran be extended\nto a homomorphism f : hL [ fs\n0\n; s\n1\n; : : : ; s\nm\ngi\nG\n! H. Hen\re, s\n0\nis output by\nGREEDY(H-\rolourable). The result follows by indu\rtion.\nConstru\rtion C : The edge-sub-indi\rator \ronstru\rtion.\nLet J be a \fxed graph with a spe\ri\fed edge (j; j\n0\n) and t spe\ri\fed verti\res\nk\n1\n; k\n2\n; : : : ; k\nt\n, su\rh that all verti\res j; j\n0\n; k\n1\n; k\n2\n; : : : ; k\nt\nare distin\rt and some auto-\nmorphism of J keeps k\n1\n; k\n2\n; : : : ; k\nt\n\fxed while ex\rhanging the verti\res j and j\n0\n. The\nedge-sub-indi\rator \ronstru\rtion transforms a given graph H with t (distin\rt) spe\r-\ni\fed verti\res h\n1\n; h\n2\n; : : : ; h\nt\ninto its subgraph\n^\nH indu\red by those edges (h; h\n0\n) of H\nfor whi\rh there is a homomorphism of J to H taking k\ni\nto h\ni\n, for i = 1; 2; : : : ; t, and\nj to h and j\n0\nto h\n0\n. The \ronstru\rtion \ran be visualised as in Fig. 7.\nLemma 5 If the problem G\n^\nH\nis \u0006\np\n2\n-\romplete then so is G\nH\n.\nProof Assume that G\n^\nH\nis \u0006\np\n2\n-\romplete; and so, in parti\rular,\n^\nH has at least one\nedge. We will redu\re G\n^\nH\nto G\nH\n(via a logspa\re redu\rtion). Let (\n^\nG;\n^\nP; s^; x^) be an\ninstan\re of G\n^\nH\n. From it, we shall \ronstru\rt an instan\re (G;P; s; x) of G\nH\n.\n13\nH\nh1\nH^\n1\nj jJ\nk\n\u2018\nFigure 7. Building\n^\nH from H and J .\nThe graph G is \ronstru\rted from: a \ropy of\n^\nG, with e edges; a \ropy of H; and e\n\ropies of J (with H and J as prior to the statement of this lemma), by identifying\nevery vertex k\ni\nin any \ropy of J with the vertex h\ni\nof H, for i = 1; 2; : : : ; t, and\nea\rh edge e of\n^\nG with the edge (j; j\n0\n) of a unique \ropy of J . The verti\res of G\n\rorresponding to the verti\res of\n^\nG (and the verti\res j and j\n0\nof the \ropies of J)\nare \ralled\n^\nG-verti\res, the verti\res of G \rorresponding to the verti\res of the \ropies\nof J but di\u000berent from j; k\n1\n; k\n2\n; : : : ; k\nt\nare \ralled J-verti\res, and the verti\res of G\n\rorresponding to the verti\res of H are \ralled H-verti\res.\nThe partial order P \ronsists of any linear ordering of the H-verti\res, \ron\rate-\nnated onto any linear ordering of the J-verti\res \ron\ratenated onto the ordering\n^\nP of\nthe\n^\nG-verti\res. The vertex s is the \frst H-vertex in the ordering P and the vertex\nx is the vertex x^ of\n^\nP . The whole \ronstru\rtion \ran be pi\rtured in Fig. 8. Clearly,\nthis \ronstru\rtion \ran be undertaken using logspa\re.\nWe begin by showing that any exe\rution of GREEDY(H-\rolourable) on input\n(G;P; s) outputs every H-vertex and J-vertex of G. Clearly every H-vertex is\noutput. Consider some \ropy of J (used in the formation of G). As\n^\nH has at least\none edge, there is a homomorphism from J to H taking k\ni\nto h\ni\n, for i = 1; 2; : : : ; t.\nHen\re, every J-vertex is output. Denote the set of H-verti\res and J-verti\res of G\nby L.\nConsider the algorithm GREEDY(H-\rolourable) on the input (G;P; s), where\nthe \rurrent-vertex is s^ (with the verti\res of L having been output so far), and\nthe algorithm GREEDY(\n^\nH-\rolourable) on the input (\n^\nG;\n^\nP; s^) where the \rurrent-\nvertex is s^ (note how we \ronsider the\n^\nG-verti\res of G and the verti\res of\n~\nG as\nbeing identi\rally named). Essentially, these two algorithms work with the same\npartial order; so \ronsider exe\rutions of these algorithms with respe\rt to the same\nsubsequent linear order.\nOur indu\rtion hypothesis is as follows: `The \rurrent-vertex in both exe\rutions\nis s\n0\n; GREEDY(H-\rolourable) has so far output the verti\res of L[ fs\n1\n; s\n2\n; : : : ; s\nm\ng,\nwhere ea\rh s\ni\nis a\n^\nG-vertex, for i = 1; 2; : : : ; m; and GREEDY(\n^\nH-\rolourable) has so\nfar output the verti\res of fs\n1\n; s\n2\n; : : : ; s\nm\ng.'\n14\n... ...\n...\n...\nh1 h2 h t\nthe copiesof J\n...\nh1 h2 h t\nk 1 k 2 k t\nG\nH\nthe graph G\nthe partial\norder P\nthe partial order Pthe -vertices and -verticesH J\n\u2026\ns\ns\nx\n...\nk 1 k 2 k t\nj j \u2018 j j \u2018\n...\nk 1 k 2 k t\nj j \u2018\n^\n^\n^\nFigure 8. Building G from H, \ropies of J and\n^\nG.\nSuppose that the indu\rtion hypothesis holds at some point (it \rertainly holds\nwhen s\n0\n= s^).\nSuppose that s\n0\nis output by GREEDY(H-\rolourable). That is, there is a ho-\nmomorphism f : hL [ fs\n0\n; s\n1\n; : : : ; s\nm\ngi\nG\n! H. In parti\rular, if (s\ni\n; s\nj\n) is an edge\nof\n^\nG then (f(s\ni\n); f(s\nj\n)) is an edge of\n^\nH, for i; j = 0; 1; : : : ; m. Hen\re, we have a\nhomomorphism\n^\nf : hfs\n0\n; s\n1\n; : : : ; s\nm\ngi\n^\nG\n!\n^\nH, and so s\n0\nis output by GREEDY(\n^\nH-\n\rolourable).\nConversely, suppose that s\n0\nis output by GREEDY(\n^\nH-\rolourable). That is,\nthere is a homomorphism\n^\nf : hfs\n0\n; s\n1\n; : : : ; s\nm\ngi\n^\nG\n!\n^\nH. Consider the \ropy of J\n\rorresponding to the\n^\nG-vertex s\ni\nof G. As\n^\nf(s\ni\n) is a vertex of\n^\nH, there must be a\n^\nG-vertex s\nj\nof G su\rh that (\n^\nf(s\ni\n);\n^\nf(s\nj\n)) is an edge of\n^\nH, and so\n^\nf \ran be extended\nto a homomorphism f : hL [ fs\n0\n; s\n1\n; : : : ; s\nm\ngi\nG\n! H. Hen\re, s\n0\nis output by\nGREEDY(H-\rolourable). The result follows by indu\rtion.\nNow we \ran pro\reed as Hell and Ne\u0014set\u0014ril did in [6\u2104. Assume that there exists a\nnon-bipartite graph H for whi\rh the problem G\nH\nis not \u0006\np\n2\n-\romplete. Choose H so\nthat it is non-bipartite and the problem G\nH\n0\nis \u0006\np\n2\n-\romplete for any non-bipartite\ngraph H\n0\n:\n(i) with fewer verti\res than H; or\n15\n(ii) with the same number of verti\res as H but with more edges.\nIt is straightforward to see that, under the assumption above, su\rh an H must exist.\nIn [6\u2104, working from a similar hypothesis and graph H, the proof pro\reeds by\nusing the indi\rator, sub-indi\rator and edge-sub-indi\rator \ronstru\rtions, in tandem\nwith lemmas analogous to Lemmas 3, 4 and 5, to show that H must be a 3-\rlique;\nand hen\re that the 3-\rolouring problem is not NP-\romplete, thus yielding a \rontra-\ndi\rtion. The se\rtions of the proof of the main theorem of [6\u2104 entitled `The stru\rture of\ntriangles' and `The stru\rture of squares' \ran be applied verbatim to our graph H (as\nthe \ronstru\rtions we use are identi\ral and we have our analogous Lemmas 3, 4 and 5).\nHen\re, we may assume that H is 3-\rolourable, i.e., that H is a 3-\rlique. However,\nTheorem 1 yields a \rontradi\rtion as the problem GREEDY(partial order, undire\rted\ngraphs, H-\rolourable) is none other than G\nH\nwhen H is a 3-\rlique, and the result\nfollows.\n5 Con\rlusion\nIn this paper, we have exhibited a \romplexity-theoreti\r di\rhotomy result \ron\rerning\nthe non-deterministi\r \romputation of lexi\rographi\rally \frst maximal H-\rolourable\nsubgraphs of graphs. Our di\rhotomy result is di\u000berent from other di\rhotomy results\nin that it is \ron\rerned with NP-\rompleteness and \u0006\np\n2\n-\rompleteness, as opposed to\n\romputability in polynomial-time and NP-\rompleteness as is more often the \rase.\nThere are natural dire\rtions in whi\rh to extend this resear\rh.\nCan we obtain a \ronstru\rtive proof of our main result?\nCan we obtain a similar result in the \rase of dire\rted graphs or other stru\r-\ntures?\nOf \rourse, it is open as to whether there is a \ronstru\rtive proof of Hell and Ne\u0014set\u0014ril's\nresult and also whether it \ran be extended to dire\rted graphs; but it may be the\n\rase that these questions might be easier in our s\renario.\nWhat is the \romplexity of \rounting the number of distin\rt sets of verti\res output\nby GREEDY (\u0019) (on a given instan\re and for some appropriate property \u0019)\nthat \rontain a given vertex v?\nThis question is motivated by the results of Dyer and Greenhill [3\u2104.\nWhat is the \romplexity of the analogously de\fned lexi\rographi\rally last maximal\nsubgraph problem (again, with respe\rt to an appropriate property \u0019), in the\n\rases when a graph is linearly ordered and partially ordered?\nThe only result we know of as regards \romputing lexi\rographi\rally last subgraphs is\nthat of [7\u2104 where it is proven that de\riding whether a given set of verti\res of a given\nlinearly ordered graph is the lexi\rographi\rally last su\rh maximal independent set is\n\ro-NP-\romplete.\n16\nReferen\res\n[1\u2104 C. Berge, Graphs and Hypergraphs, North-Holland (1973).\n[2\u2104 J. D\u0013\u0010az, M. Serna and D. M. Thilikos, (H;C;K)-\rolorings: fast, easy and hard\n\rases, Pro\reedings of 26th International Symposium on Mathemati\ral Founda-\ntions of Computer S\rien\re, Le\rture Notes in Computer S\rien\re 2136, Springer-\nVerlag, Berlin (2001) 304{315.\n[3\u2104 M. Dyer and C. Greenhill, The \romplexity of \rounting graph homomorphisms,\nRandom Stru\rtures and Algorithms 17 (2000) 260{289.\n[4\u2104 T. Feder and P. Hell, List homomorphisms to re\rexive graphs, Journal of Com-\nbinatorial Theory Series B 72 (1998) 236{250.\n[5\u2104 T. Feder, P. Hell and J. Huang, List homomorphisms and \rir\rular ar\r graphs,\nCombinatori\ra 19 (1999) 487{505.\n[6\u2104 P. Hell and J. Nesetril, On the \romplexity of H-\rolouring. Journal of Combi-\nnatorial Theory Series B 48 (1990) 92{110.\n[7\u2104 D.S. Johnson, M. Yannakakis and C.H. Papadimitriou, On generating all max-\nimal independent sets, Information Pro\ressing Letters 27 (1988) 119{123.\n[8\u2104 S. Miyano, The lexi\rographi\rally \frst maximal subgraph problems: P-\romp-\nleteness and NC algorithms, Mathemati\ral Systems Theory 22 (1989) 47{73.\n[9\u2104 S. Miyano, \u0001\np\n2\n-\romplete lexi\rographi\rally \frst maximal subgraph problems,\nTheoreti\ral Computer S\rien\re 88 (1991) 33{57.\n[10\u2104 C.H. Papadimitriou, Computational Complexity , Addison-Wesley (1994).\n[11\u2104 A. Puri\rella and I.A. Stewart, A generi\r greedy algorithm, partially-ordered\ngraphs and NP-\rompleteness, Pro\reedings of 27th International Workshop on\nGraph-Theoreti\r Con\repts in Computer S\rien\re, Le\rture Notes in Computer\nS\rien\re 2204, Springer-Verlag, Berlin (2001) 306{316.\n[12\u2104 I.A. Stewart, Complete problems involving Boolean labelled stru\rtures and pro-\nje\rtion translations, Journal of Logi\r and Computation 1 (1991) 861{882.\n17\n"}