{"doi":"10.1109\/TCBB.2007.70252","coreId":"65280","oai":"oai:dro.dur.ac.uk.OAI2:6307","identifiers":["oai:dro.dur.ac.uk.OAI2:6307","10.1109\/TCBB.2007.70252"],"title":"Nature reserve selection problem : a tight approximation algorithm.","authors":["Bordewich, M.","Semple, C."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2008-04-01","abstract":"The nature reserve selection problem is a problem that arises in the context of studying biodiversity conservation. Subject to budgetary constraints, the problem is to select a set of regions to be conserved so that the phylogenetic diversity of the set of species contained within those regions is maximized. Recently, it has been shown in a paper by Moulton et al. that this problem is NP-hard. In this paper, we establish a tight polynomial-time approximation algorithm for the Nature Reserve Section Problem. Furthermore, we resolve a question on the computational complexity of a related problem left open by Moulton et al","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/65280.pdf","fullTextIdentifier":"http:\/\/dro.dur.ac.uk\/6307\/1\/6307.pdf","pdfHashValue":"2af4adaf5631379646e40f958948f86c8d73aaeb","publisher":"IEEE","rawRecordXml":"<record><header><identifier>\n  \n    \n      oai:dro.dur.ac.uk.OAI2:6307<\/identifier><datestamp>\n      2011-12-06T16:25:25Z<\/datestamp><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        Nature reserve selection problem : a tight approximation algorithm.<\/dc:title><dc:creator>\n        Bordewich, M.<\/dc:creator><dc:creator>\n        Semple, C.<\/dc:creator><dc:description>\n        The nature reserve selection problem is a problem that arises in the context of studying biodiversity conservation. Subject to budgetary constraints, the problem is to select a set of regions to be conserved so that the phylogenetic diversity of the set of species contained within those regions is maximized. Recently, it has been shown in a paper by Moulton et al. that this problem is NP-hard. In this paper, we establish a tight polynomial-time approximation algorithm for the Nature Reserve Section Problem. Furthermore, we resolve a question on the computational complexity of a related problem left open by Moulton et al. <\/dc:description><dc:publisher>\n        IEEE<\/dc:publisher><dc:source>\n        IEEE\/ACM transactions on computational biology and bioinformatics, 2008, Vol.5(2), pp.275-280 [Peer Reviewed Journal]<\/dc:source><dc:date>\n        2008-04-01<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:identifier>\n        dro:6307<\/dc:identifier><dc:identifier>\n        issn:1545-5963<\/dc:identifier><dc:identifier>\n        doi:10.1109\/TCBB.2007.70252<\/dc:identifier><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/6307\/<\/dc:identifier><dc:identifier>\n        http:\/\/dx.doi.org\/10.1109\/TCBB.2007.70252<\/dc:identifier><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/6307\/1\/6307.pdf<\/dc:identifier><dc:rights>\n        \u00a92008 IEEE. This material is presented to ensure timely dissemination of scholarly and technical work. Copyright and all rights therein are retained by authors or by other copyright holders. All persons copying this information are expected to adhere to the terms and constraints invoked by each author's copyright. In most cases, these works may not be reposted without the explicit permission of the copyright holder.\\ud\n\\ud\nPersonal use of this material is permitted. However, permission to reprint\/republish this material for advertising or promotional purposes or for creating new collective works for resale or redistribution to servers or lists, or to reuse any copyrighted component of this work in other works must be obtained from the IEEE.\\ud\n<\/dc:rights><dc:accessRights>\n        info:en-repo\/semantics\/openAccess<\/dc:accessRights><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["1545-5963","issn:1545-5963"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2008,"topics":[],"subject":["Article","PeerReviewed"],"fullText":"Durham Research Online\nDeposited in DRO:\n06 January 2010\nVersion of attached file:\nPublished Version\nPeer-review status of attached file:\nPeer-reviewed\nCitation for published item:\nBordewich, M. and Semple, C. (2008) \u2019Nature reserve selection problem : a tight approximation algorithm.\u2019,\nIEEE\/ACM transactions on computational biology and bioinformatics., 5 (2). pp. 275-280.\nFurther information on publisher\u2019s website:\nhttp:\/\/dx.doi.org\/10.1109\/TCBB.2007.70252\nPublisher\u2019s copyright statement:\n2008 IEEE. This material is presented to ensure timely dissemination of scholarly and technical work. Copyright and\nall rights therein are retained by authors or by other copyright holders. All persons copying this information are\nexpected to adhere to the terms and constraints invoked by each author\u2019s copyright. In most cases, these works may\nnot be reposted without the explicit permission of the copyright holder. Personal use of this material is permitted.\nHowever, permission to reprint\/republish this material for advertising or promotional purposes or for creating new\ncollective works for resale or redistribution to servers or lists, or to reuse any copyrighted component of this work in\nother works must be obtained from the IEEE.\nAdditional information:\nUse policy\nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without prior permission or charge, for\npersonal research or study, educational, or not-for-profit purposes provided that:\n\u2022 a full bibliographic reference is made to the original source\n\u2022 a link is made to the metadata record in DRO\n\u2022 the full-text is not changed in any way\nThe full-text must not be sold in any format or medium without the formal permission of the copyright holders.\nPlease consult the full DRO policy for further details.\nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom\nTel : +44 (0)191 334 3042 \u2014 Fax : +44 (0)191 334 2971\nhttp:\/\/dro.dur.ac.uk\n  \nDurham Research Online \n \nDeposited in DRO: \n06 January 2010 \n \nPeer-review status: \nPeer-reviewed \n \nPublication status: \nPublished version \n \nCitation for published item: \nBordewich, M. and Semple, C. (2008) 'Nature reserve selection problem : a tight \napproximation algorithm.', IEEE\/ACM transactions on computational biology and \nbioinformatics., 5 (2). pp. 275-280. \n \nFurther information on publishers website: \nhttp:\/\/dx.doi.org\/10.1109\/TCBB.2007.70252 \n \nPublisher\u2019s copyright statement: \n\u00a92008 IEEE. This material is presented to ensure timely dissemination of scholarly and \ntechnical work. Copyright and all rights therein are retained by authors or by other copyright \nholders. All persons copying this information are expected to adhere to the terms and \nconstraints invoked by each author's copyright. In most cases, these works may not be \nreposted without the explicit permission of the copyright holder. \n \nPersonal use of this material is permitted. However, permission to reprint\/republish this \nmaterial for advertising or promotional purposes or for creating new collective works for \nresale or redistribution to servers or lists, or to reuse any copyrighted component of this work \nin other works must be obtained from the IEEE. \n \n \n \nUse policy \n \nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without prior \npermission or charge, for personal research or study, educational, or not-for-profit purposes provided that : \n \n\uf0a7 a full bibliographic reference is made to the original source \n\uf0a7 a link is made to the metadata record in DRO \n\uf0a7 the full-text is not changed in any way \n \nThe full-text must not be sold in any format or medium without the formal permission of the copyright holders. \n \nPlease consult the full DRO policy for further details. \n \nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom \nTel : +44 (0)191 334 2975 | Fax : +44 (0)191 334 2971 \nhttp:\/\/dro.dur.ac.uk \nNature Reserve Selection Problem:\nA Tight Approximation Algorithm\nMagnus Bordewich and Charles Semple\nAbstract\u2014The Nature Reserve Selection Problem is a problem that arises in the context of studying biodiversity conservation. Subject\nto budgetary constraints, the problem is to select a set of regions to be conserved so that the phylogenetic diversity of the set of\nspecies contained within those regions is maximized. Recently, it has been shown in a paper by Moulton et al. that this problem is\nNP-hard. In this paper, we establish a tight polynomial-time approximation algorithm for the Nature Reserve Section Problem.\nFurthermore, we resolve a question on the computational complexity of a related problem left open by Moulton et al.\nIndex Terms\u2014Combinatorial algorithms, phylogenetic diversity, biodiversity conservation.\n\u00c7\n1 INTRODUCTION\nA central task in conservation biology is measuring,predicting, and preserving biological diversity as\nspecies face extinction. In this regard, individual species\nare often the focus of attention. However, as pointed out by\nRodrigues et al. [13], this is not necessarily the best way of\nconserving diversity:\nAlthough conservation action is frequently targeted toward\nsingle species, the most effective way of preserving overall\nspecies diversity is by conserving viable populations in their\nnatural habitats, often by designating networks of protected\nareas.\nIn this paper, we consider a natural computational problem\nin the context of conserving whole habitats instead of\nindividual species.\nDating back to 1992 [1], phylogenetic diversity (PD) is a\nprominent quantitative tool for measuring the biodiversity\nof a collection of species. This measure is based on the\nevolutionary distance among the species in the collection.\nLoosely speaking, if T is a phylogenetic tree whose leaf set\nX represents a set of species and whose edges have real-\nvalued lengths (weights), then the PD score of a subset S of\nX is the sum of the weights of the edges of the minimal\nsubtree of T connecting the species in S. The standard PD\noptimization problem is to find a subset ofX of a given size,\nwhich maximizes the PD score among all subsets of X of\nthat size. Perhaps surprisingly, the so-called greedy algo-\nrithm solves this problem exactly [1], [10], [16].\nA canonical extension of the standard problem allows for\nthe consideration of conserving various regions such as\nnature reserves at some cost. In particular, aside from an\nedge-weighted phylogenetic tree T with leaf set X, we have\na collection A of regions or areas containing species in X,\nwith each region having an associated cost of preservation.\nGiven a fixed budget B, the PD optimization problem for\nthis extension is to find a subset of the regions in A to be\npreserved, which maximizes the PD score of the species\ncontained within at least one preserved region while\nkeeping within the budget. This problem is called the\nBudgeted Nature Reserve Selection (BNRS) and generalizes\nthe analogous unit cost problems described in [9], [11], [12],\nand [13]. Allowing the cost of conserving each region to\nvary provides additional cost structure that is important in\npractice but, as commented in [2] and [5], is often omitted\nfrom such problems in conservation biology. For applica-\ntions of BNRS with unit costs and using the maximum PD\nscore across areas to make assessments in conservation\nplanning, see, for example, [8], [12], and [15].\nMoulton et al. [9] showed that a particular instance of\nBNRS (and, therefore, BNRS itself) is NP-hard; that is, there\nis no polynomial-time algorithm for solving it, unless\nP \u00bc NP. Despite this negative result, in this paper, we show\nthat there is a polynomial-time \u00f01\u0002 1=e\u00de-approximation\nalgorithm for this problem. That is, an efficient algorithm\nthat generates a solution that has at least a \u00f01\u0002 1=e\u00de fraction\n(\u0003 63 percent) of the PD of the optimal solution. Moreover,\nthis approximation ratio is the best possible.\nThis paper is arranged as follows: Section 2 contains a\nformal definition of BNRS and a discussion of related work.\nSection 3 contains the description of the approximation\nalgorithm and the statement of the main theorem, the proof\nof which is established in Section 4. In Section 5, we answer\na computational complexity question on a related problem\nthat was left open in [9]. Throughout most of this paper, we\nrestrict ourselves to PD in the setting of unrooted trees.\nHowever, in Section 6, we extend our earlier results to the\nrooted analog of BNRS (RBNRS). The notation and\nterminology in this paper follows [14].\n2 BUDGETED NATURE RESERVE SELECTION\nIn order to define BNRS formally, we require the following\ndefinitions. A phylogenetic X-tree T is an (unrooted) tree\nIEEE\/ACM TRANSACTIONS ON COMPUTATIONAL BIOLOGY AND BIOINFORMATICS, VOL. 5, NO. 2, APRIL-JUNE 2008 275\n. M. Bordewich is with the Department of Computer Science, University of\nDurham, South Road, Durham DH1 3LE, UK.\nE-mail: m.j.r.bordewich@durham.ac.uk.\n. C. Semple is with the Department of Mathematics and Statistics,\nUniversity of Canterbury, Private Bag 4800, Christchurch, New Zealand.\nE-mail: c.semple@math.canterbury.ac.nz.\nManuscript received 18 Feb. 2007; revised 2 July 2007; accepted 11 Sept.\n2007; published online 13 Sept. 2007.\nFor information on obtaining reprints of this article, please send e-mail to:\ntcbb@computer.org, and reference IEEECS Log Number TCBB-0019-0207.\nDigital Object Identifier no. 10.1109\/TCBB.2007.70252.\n1545-5963\/08\/$25.00 \u0002 2008 IEEE Published by the IEEE CS, CI, and EMB Societies & the ACM\nwith no degree-2 vertices and whose leaf set isX. Let T be a\nphylogenetic X-tree with edge set E and let \u0002 : E ! IR\u00040 be\nan assignment of lengths (weights) to the edges of T .\nIgnoring the dashed edges, Fig. 1 illustrates a phylogenetic\nX-tree with nonnegative real-valued edge weights, where\nX \u00bc fa; b; c; d; e; f; gg.\nFor a subset S of X, the PD of S on T is the sum of the\nedge lengths of the minimal subtree of T that connects S.\nThis sum is denoted as PD\u00f0T ;\u0002\u00de\u00f0S\u00de; however, if there is no\nambiguity, we usually shorten it to PD\u00f0S\u00de. Referring to\nFig. 1, if S \u00bc fa; b; fg, then PD\u00f0S\u00de is equal to the sum of the\nweights of the minimal subtree (dashed edges) that\nconnects a, b, and f ; in particular, PD\u00f0S\u00de \u00bc 12.\nBNRS is formally defined as follows:\nProblem: BNRS\nInstance: A phylogenetic X-tree T , a nonnegative (real\nvalued) weighting \u0002 on the edges of T , a collection A of\nsubsets of X, a cost function c on the sets in A, and a\nbudget B.\nQuestion: Find a subset A0 of A, which maximizes the PD\nscore of\nS\nA2A0 A on T such that\nP\nA2A0 c\u00f0A\u00de \u0005 B.\nReferring to the informal discussions in the Introduction,\nin the statement of BNRS, A is the collection of regions, and\nA0 is an optimal subset of regions that we wish to conserve,\nwhich maximizes the PD score of the species contained in at\nleast one of the preserved regions. Of course, the total cost\nof the preserving the regions in A0 is at most B.\nExample 2.1. As an example of an instance of BNRS, take T\nas the edge-weighted phylogenetic X-tree shown in\nFig. 1, choose A to be\u0002fbg; ff; cg; fc; dg; fa; bg; fa; gg; feg; fg; eg\u0003;\nand set c as the cost function on A defined by c\u00f0fbg\u00de \u00bc 4,\nc\u00f0ff; cg\u00de \u00bc 8, c\u00f0fc; dg\u00de \u00bc 6, c\u00f0fa; bg\u00de \u00bc 10, c\u00f0fa; gg\u00de \u00bc 4,\nc\u00f0feg\u00de \u00bc 4, and c\u00f0fg; eg\u00de \u00bc 5. By setting B \u00bc 24, we now\nhave an instance of BNRS.\nA feasible solution of this instance is\n\u0002ff; cg; fa; bg\u0003 as\nc\u00f0ff; cg\u00de \u00fe c\u00f0fa; bg\u00de \u00bc 8\u00fe 10 \u00bc 18, which is within the\nbudget. Note that the PD score on T associated with this\nfeasible solution is\nPD\u00f0ff; cg [ fa; bg\u00de \u00bc 15:\nAn optimal solution is\n\u0002fbg; ff; cg; fc; dg; fe; gg\u0003. In this\ncase,\nc\u00f0fbg\u00de \u00fe c\u00f0ff; cg\u00de \u00fe c\u00f0fc; dg\u00de\n\u00fe c\u00f0fe; gg\u00de \u00bc 4\u00fe 8\u00fe 6\u00fe 5 \u00bc 23;\nand\nPD\u00f0fbg [ ff; cg [ fc; dg [ fe; gg\u00de \u00bc 21:\nThe BNRS problem extends the problem OPTIMIZING\nDIVERSITY VIA REGIONS described in [9]. The extension\nfrom the latter to the former is that, instead of each region\nhaving a unit cost, the cost of conserving each region is\nallowed to vary. Moulton et al. [9] showed that OPTIMIZ-\nING DIVERSITY VIA REGIONS is NP-hard and, so, conse-\nquently, BNRS is also NP-hard. BNRS also extends the\nproblem BUDGETED MAXIMUM COVERAGE, in which each\nelement of X has a weight, and the objective is to\nmaximize the total weight of\nS\nA2A0 A without the addi-\ntional structure imposed by a tree [7]. An instance of the\nlatter problem may be realized as a BNRS instance by\ntaking T to be a star tree with leaf set X and assigning the\nweight of each element in X to be the length of the\nincident edge in T . (Note that a star tree is a phylogenetic\ntree with a single interior vertex.) The approximation\nalgorithm and its proof presented here closely follow those\nin [7] for the restricted \u201cstar tree problem\u201d but must be\nextended to cover the more complicated interactions of PD\nscore rather than a simple sum of weights. Last, BNRS is\nthe \u201c0!cr 0=1 Nature Reserve Problem\u201d briefly discussed in\n[11, Appendix].\n3 THE APPROXIMATION ALGORITHM\nIn this section, we describe a tight polynomial-time\napproximation algorithm for BNRS called ApproxBNRS.\nThe fact that it is such an algorithm is established in the next\nsection. For a subset G of A, the notations c\u00f0G\u00de and PD\u00f0G\u00de\ndenote\nP\nA2G c\u00f0A\u00de and PD\u00f0[A2GA\u00de, respectively.\nWe begin with an informal overview of ApproxBNRS\nand its subroutine Greedy (see Figs. 2 and 3). By\nconsidering all possibilities, ApproxBNRS initially finds a\nfeasible solution whose size is at most two and which\nmaximizes the PD score on T . The resulting solution is\ncalled H1. Next, the algorithm, in turn, considers every\nsubset of A of size three and applies the subroutine Greedy\nto each of these subsets. Algorithm Greedy is a greedy-like\nalgorithm that takes a subset G0 of size three of A and\nsequentially adds sets from A\u0002 G0. The only criteria for\nwhich set is selected is that, among all available sets, the\nratio of incremental diversity to cost is maximized, and we\nkeep within the budget. The resulting feasible solution that\nmaximizes the PD score is called H2. Finally, ApproxBNRS\ncompares the two feasible solutions H1 and H2 and returns\nthe one with the biggest PD score.\nThe main result of this paper is the following theorem,\nwhose proof is given in the next section.\nTheorem 3.1. ApproxBNRS is a polynomial-time \u00f01\u0002\n1=e\u00de-approximation algorithm for BNRS. Moreover, for any\n\u0003 > 0, BNRS cannot be approximated with an approximation\nratio of \u00f01\u0002 1=e\u00fe \u0003\u00de, unless P \u00bc NP.\n276 IEEE\/ACM TRANSACTIONS ON COMPUTATIONAL BIOLOGY AND BIOINFORMATICS, VOL. 5, NO. 2, APRIL-JUNE 2008\nFig. 1. A phylogenetic X-tree with edge lengths, where\nX \u00bc fa; b; c; d; e; f; gg.\nIn terms of the runtime of ApproxBNRS, running the\ngreedy subroutine is very efficient; however, repeating this\nfor all subsets of A of size three incurs a multiplicative\noverhead of O\u00f0jAj3\u00de. Typically, the number of regions or\nnature reserves under consideration will be small, and\nhence, this overhead is minor. Nevertheless, it is worth\nnoting that in the special case that all regions have the same\ncost, this term can be removed from the runtime. In this\nsituation, the greedy algorithm, starting from a subset G0 of\nA of size two, which maximizes the PD score among all\ntwo-element subsets of A, achieves the approximation ratio\n\u00f01\u0002 1=e\u00de. The proof of this fact is a routine extension of [6],\nusing the same insights regarding the difference between\nPD and the ordinary weight function as we have used in\nthe proof of Theorem 3.1 given in the next section.\n4 PROOF OF THEOREM 3.1\nThis section consists of the proof of Theorem 3.1. Let Sopt\ndenote a subset of A, which is an optimal solution to BNRS.\nIf jSoptj \u0005 2, then ApproxBNRS finds a feasible solution\nwhose PD score is equal to the PD score of Sopt. Therefore,\nwe may assume that jSoptj \u0004 3, in which case it suffices to\nshow that there is a subset G0 of A, with jG0j \u00bc 3, whose\ninput to Greedy (together with A\u0002 G0) results in a subset of\nA, whose PD score is within the approximation ratio stated\nin the theorem.\nLet G0 be the subset fS1; S2; S3g of Sopt such that S1 and\nS2 are chosen to maximize PD\u00f0S1 [ S2\u00de among all subsets of\nSopt of size two and S3 maximizes PD\u00f0S1 [ S2 [ S3\u00de among\nall sets in Sopt n fS1; S2g. Now, consider Greedy applied to\n\u00f0G0;A\u0002 G0\u00de. Let p denote the first iteration, in which a\nmember Al\u00fe1, say, of Sopt \u0002 G0 is considered but, because of\nbudgetary reasons, is not added to the current greedy\nsolution. Up to iteration p, let, in order, A1; A2; . . . ; Al denote\nthe members of A\u0002 G0 that are added to G0 and, for\ni \u00bc 1; . . . ; l, let Gi \u00bc G0 [ fA1; A2; . . . ; Aig. Observe that Gl is\na feasible solution and a subset of the final output G\u0006 of the\ngreedy subroutine, and hence, PD\u00f0G\u0006\u00de \u0004 PD\u00f0Gl\u00de. For\nconvenience, we also let Gl\u00fe1 \u00bc Gl [ fAl\u00fe1g, but note that\nGl\u00fe1 is not a feasible solution, as c\u00f0Gl\u00fe1\u00de > B. Furthermore,\nfor all i, let ci denote c\u00f0Ai\u00de. For a subset S of A, denote the\nminimal subtree of T that connects the elements of X that\nare contained in at least one member of S by T \u00f0S\u00de. Also, let\nE\u00f0T \u00f0S\u00de\u00de denote the edge set of T \u00f0S\u00de. We begin the proof\nwith two lemmas.\nLemma 4.1. For all i 2 f1; 2; . . . ; l\u00fe 1g\nPD\u00f0Gi\u00de \u0002 PD\u00f0Gi\u00021\u00de \u0004 ci\nB\u0002 c\u00f0G0\u00de \u00f0PD\u00f0Sopt\u00de \u0002 PD\u00f0Gi\u00021\u00de\u00de:\nProof. One crucial point to be observed for the approach in\n[7] to be applicable in our setting is that the incremental\ndiversity from adding the entire optimal solution to the\ncurrent partial greedy solution is bounded by the sum of\nthe increments that would be obtained from adding each\nset in the optimal solution individually. We formalize this\nas follows: Let i be any element in f1; 2; . . . ; l\u00fe 1g. Let F\ndenote the set of edges inE\u00f0T \u00f0Sopt [ Gi\u00021\u00de\u00de \u0002 E\u00f0T \u00f0Gi\u00021\u00de\u00de.\nObserve that PD\u00f0Sopt [ Gi\u00021\u00de \u0002 PD\u00f0Gi\u00021\u00de is equal toP\ne2F \u0002\u00f0e\u00de. Since Gi\u00021 is nonempty, there is, for each\ne 2 F , an element in SA2\u00f0Sopt\u0002Gi\u00021\u00deA such that e is on the\npath from that element to a vertex in T \u00f0Gi\u00021\u00de. In particular,\nthere is a set Ae in Sopt \u0002 Gi\u00021 such that T \u00f0Gi\u00021 [Ae\u00de\ncontains e. Since Ai is chosen so that\nPD\u00f0Gi\u00de\u0002PD\u00f0Gi\u00021\u00de\nci\nis\nmaximized, we have, for all A 2 Sopt \u0002 Gi\u00021\nPD\u00f0Gi\u00021 [A\u00de \u0002 PD\u00f0Gi\u00021\u00de\nc\u00f0A\u00de \u0005\nPD\u00f0Gi\u00de \u0002 PD\u00f0Gi\u00021\u00de\nci\n:\nTherefore, as the total cost of the elements in Sopt \u0002 Gi\u00021\nis at most B\u0002 c\u00f0G0\u00de\nBORDEWICH AND SEMPLE: NATURE RESERVE SELECTION PROBLEM: A TIGHT APPROXIMATION ALGORITHM 277\nFig. 2. The greedy algorithm Greedy.\nFig. 3. The approximation algorithm ApproxBNRS.\nPD\u00f0Sopt\u00de \u0002 PD\u00f0Gi\u00021\u00de \u0005 PD\u00f0Sopt [ Gi\u00021\u00de \u0002 PD\u00f0Gi\u00021\u00de\n\u00bc\nX\ne2F\n\u0002\u00f0e\u00de\n\u0005\nX\nA2\u00f0Sopt\u0002Gi\u00021\u00de\nX\nfe2F : e2T \u00f0Gi\u00021[A\u00deg\n\u0002\u00f0e\u00de\n2\n4\n3\n5\n\u00bc\nX\nA2\u00f0Sopt\u0002Gi\u00021\u00de\nPD\u00f0Gi\u00021 [A\u00de \u0002 PD\u00f0Gi\u00021\u00de\nc\u00f0A\u00de c\u00f0A\u00de\n\u0005\nX\nA2\u00f0Sopt\u0002Gi\u00021\u00de\nPD\u00f0Gi\u00de \u0002 PD\u00f0Gi\u00021\u00de\nci\nc\u00f0A\u00de\n\u0005 PD\u00f0Gi\u00de \u0002 PD\u00f0Gi\u00021\u00de\nci\n\u00f0B\u0002 c\u00f0G0\u00de\u00de:\nRearrangement now gives the inequality in the statement\nof the lemma, and the result follows. tu\nLemma 4.2. For all i 2 f1; 2; . . . ; l\u00fe 1g\nPD\u00f0Gi\u00de \u0002 PD\u00f0G0\u00de\n\u0004 1\u0002\nYi\nk\u00bc1\n1\u0002 ck\nB\u0002 c\u00f0G0\u00de\n\u0004 \u0005\" #\n\u00f0PD\u00f0Sopt\u00de \u0002 PD\u00f0G0\u00de\u00de:\nProof. The proof is by induction on i. The result for i \u00bc 1\nimmediately follows from Lemma 4.1.\nNow, assume that i \u0004 2 and that the result holds for\nall j, where j < i. Then, by Lemma 4.1 (for the first\ninequality) and by induction (for the second inequality),\nwe have\nPD\u00f0Gi\u00de \u0002 PD\u00f0G0\u00de \u00bc PD\u00f0Gi\u00021\u00de \u0002 PD\u00f0G0\u00de \u00fe PD\u00f0Gi\u00de\n\u0002 PD\u00f0Gi\u00021\u00de\n\u0004 PD\u00f0Gi\u00021\u00de \u0002 PD\u00f0G0\u00de\n\u00fe ci\nB\u0002 c\u00f0G0\u00de \u00f0PD\u00f0Sopt\u00de \u0002 PD\u00f0Gi\u00021\u00de\u00de\n\u00bc PD\u00f0Gi\u00021\u00de \u0002 PD\u00f0G0\u00de\n\u00fe ci\nB\u0002 c\u00f0G0\u00de \u00f0PD\u00f0Sopt\u00de \u0002 PD\u00f0G0\u00de\n\u0002 \u00f0PD\u00f0Gi\u00021\u00de \u0002 PD\u00f0G0\u00de\u00de\u00de\n\u00bc 1\u0002 ci\nB\u0002 c\u00f0G0\u00de\n\u0004 \u0005\n\u00f0PD\u00f0Gi\u00021\u00de \u0002 PD\u00f0G0\u00de\u00de\n\u00fe ci\nB\u0002 c\u00f0G0\u00de \u00f0PD\u00f0Sopt\u00de \u0002 PD\u00f0G0\u00de\u00de\n\u0004 1\u0002 ci\nB\u0002 c\u00f0G0\u00de\n\u0004 \u0005\n1\u0002\nYi\u00021\nk\u00bc1\n1\u0002 ck\nB\u0002 c\u00f0G0\u00de\n\u0004 \u0005\" #\n\u00f0PD\u00f0Sopt\u00de \u0002 PD\u00f0G0\u00de\u00de\n\u00fe ci\nB\u0002 c\u00f0G0\u00de \u00f0PD\u00f0Sopt\u00de \u0002 PD\u00f0G0\u00de\u00de\n\u00bc 1\u0002\nYi\nk\u00bc1\n1\u0002 ck\nB\u0002 c\u00f0G0\u00de\n\u0004 \u0005\" #\n\u00f0PD\u00f0Sopt\u00de \u0002 PD\u00f0G0\u00de\u00de:\nThis completes the proof of the lemma. tu\nProof of Theorem 3.1. Since c\u00f0Gl\u00fe1\u00de > B, we havePl\u00fe1\nk\u00bc1 ck \u00bc c\u00f0Gl\u00fe1\u00de \u0002 c\u00f0G0\u00de > B\u0002 c\u00f0G0\u00de. Furthermore, the\nfunction\nYl\u00fe1\nk\u00bc1\n1\u0002 ckP\nk ck\n\u0004 \u0005\nhas a maximum at ck \u00bc\nP\nk\nck\n\u00f0l\u00fe1\u00de for all k. Therefore,\n1\u0002\nYl\u00fe1\nk\u00bc1\n1\u0002 ck\nB\u0002 c\u00f0G0\u00de\n\u0004 \u0005\n\u0004 1\u0002\nYl\u00fe1\nk\u00bc1\n1\u0002 ckP\nk ck\n\u0004 \u0005\n\u0004 1\u0002 1\u0002 1\nl\u00fe 1\n\u0004 \u0005l\u00fe1\n\u0004 1\u0002 1=e:\nHence, by Lemma 4.2, we have\nPD\u00f0Gl\u00fe1\u00de \u0002 PD\u00f0G0\u00de \u0004 \u00f01\u0002 1=e\u00de\u00f0PD\u00f0Sopt\u00de \u0002 PD\u00f0G0\u00de\u00de: \u00f01\u00de\nRecalling that G0 \u00bc fS1; S2; S3g, we now show that\nPD\u00f0S1 [ S2 [ S3\u00de \u0002 PD\u00f0S1 [ S2\u00de \u0005 PD\u00f0G0\u00de=3: \u00f02\u00de\nLet Aj \u00bc E\u00f0T \u00f0S1 [ S2 [ S3\u00de\u00de \u0002 E\u00f0T \u00f0\u00f0S1 [ S2 [ S3\u00de \u0002 Sj\u00de\u00de\nfor j \u00bc 1; 2; 3. Since\nPD\u00f0S1 [ S2 [ S3\u00de \u00bc PD\u00f0S1 [ S2\u00de \u00fe\nX\ne2A3\n\u0002\u00f0e\u00de\n\u00bc PD\u00f0S1 [ S3\u00de \u00fe\nX\ne2A2\n\u0002\u00f0e\u00de\n\u00bc PD\u00f0S2 [ S3\u00de \u00fe\nX\ne2A1\n\u0002\u00f0e\u00de;\nand since S1 and S2 were chosen to maximize\nPD\u00f0S1 [ S2\u00de, it follows thatX\ne2A3\n\u0002\u00f0e\u00de \u0005\nX\ne2Aj\n\u0002\u00f0e\u00de; j \u00bc 1; 2:\nIt is easily seen that each edge in E\u00f0T \u00f0S1 [ S2 [ S3\u00de\u00de\noccurs in at most one Aj. Hence,\nPD\u00f0S1 [ S2 [ S3\u00de \u0004\nX3\nj\u00bc1\nX\ne2Aj\n\u0002\u00f0e\u00de\n\u0004 3\nX\ne2A3\n\u0002\u00f0e\u00de;\nand so\nPD\u00f0S1 [ S2 [ S3\u00de \u0002 PD\u00f0S1 [ S2\u00de \u00bc\nX\ne2A3\n\u0002\u00f0e\u00de \u0005 PD\u00f0G0\u00de=3;\ngiving (2).\nNext,\nPD\u00f0Gl\u00fe1\u00de \u0002 PD\u00f0Gl\u00de \u0005 PD\u00f0S1 [ S2 [Al\u00fe1\u00de \u0002 PD\u00f0S1 [ S2\u00de;\nand so\nPD\u00f0Gl\u00fe1\u00de \u0002 PD\u00f0Gl\u00de \u0005 PD\u00f0S1 [ S2 [ S3\u00de\n\u0002 PD\u00f0S1 [ S2\u00de \u0005 PD\u00f0G0\u00de=3:\n\u00f03\u00de\nOtherwise, Al\u00fe1 would have been chosen, instead of S3,\nto be in G0. Putting together (1) and (3), we get\n278 IEEE\/ACM TRANSACTIONS ON COMPUTATIONAL BIOLOGY AND BIOINFORMATICS, VOL. 5, NO. 2, APRIL-JUNE 2008\nPD\u00f0Gl\u00de \u0004 PD\u00f0Gl\u00fe1\u00de \u0002 PD\u00f0G0\u00de=3\n\u0004 \u00f01\u0002 1=e\u00de\u00f0PD\u00f0Sopt\u00de \u0002 PD\u00f0G0\u00de\u00de \u00fe 1\u0002 1\n3\n\u0004 \u0005\nPD\u00f0G0\u00de\n> \u00f01\u0002 1=e\u00dePD\u00f0Sopt\u00de:\nThis proves the first part of the theorem.\nFor the proof of the second part, we begin by defining\nthe problem MAXIMUM k-COVERAGE:\nProblem: MAXIMUM k-COVERAGE\nInstance: A collection A of subsets of X and an integer k.\nQuestion: Find a subset A0 \u00bc fA1; A2; . . . ; Akg of A of\nsize k, which maximizes the size of the set\nA1 [A2 [ \u0007 \u0007 \u0007 [Ak.\nFeige [3] showed that no polynomial-time approximation\nalgorithm for MAXIMUM k-COVERAGE can have an\napproximation ratio better than \u00f01\u0002 1=e\u00de, unless P \u00bc NP.\nObserving that BNRS is a generalization of MAXIMUM\nk-COVERAGE (see the following), it follows that no\napproximation algorithm can exist for BNRS with a ratio\nbetter than \u00f01\u0002 1=e\u00de, unless P \u00bc NP.\nGiven an instance of MAXIMUM k-COVERAGE,\ntake T to be the star tree on leaf set X, in which each\nedge has weight 1. Assign a cost of 1 to each element\nof A and take the budget B \u00bc k. Under this setup, it is\nclear that MAXIMUM k-COVERAGE can be interpreted\nas a special case of BNRS. Hence, a polynomial-time\napproximation algorithm for BNRS with approximation\nratio \u0004 would yield an approximation algorithm for\nMAXIMUM k-COVERAGE with approximation ratio \u0004.\nAccording to Feige [3], no such algorithm can exist for\n\u0004 \u00bc \u00f01\u0002 1=e\u00fe \u0003\u00de, unless P \u00bc NP. tu\n5 OPTIMIZING DIVERSITY WITH COVERAGE\nThe problem OPTIMIZING DIVERSITY WITH COVERAGE\nwas defined in [9], where a very restricted version was\nshown to have a polynomial-time algorithm. While, super-\nficially, this problem is similar to BNRS, the problem\nbehaves very differently. Loosely speaking, we are given an\nedge-weighted phylogenetic X-tree T and a collection A of\nsubsets of X. Here, the members of A represent some\nattributes that the species possess. For example, A \u00bc\nfA1; A2; . . . ; Asg may be a collection of taxonomic groups,\nand each Ai contains the species in X that belong to the\ngroup. Given a fixed positive integer k and positive integers\nn1; n2; . . . ; ns, the PD optimization problem is to find a\nsubset X0 of X of size k, which contains, for all i, at least\nni species with attribute Ai and maximizes the PD score\namong all such subsets ofX of size k. Formally, we have the\nfollowing problem.\nProblem: OPTIMIZING DIVERSITY WITH COVERAGE\nInstance: A phylogenetic X-tree T , a nonnegative\nreal-valued weighting \u0002 on the edges of T , a collection A of\nsubsets of X, a threshold nA for each A 2 A, and a positive\ninteger k.\nQuestion: Find a subset X0 of X, which maximizes the PD\nscore of X0 on T such that jX0j \u0005 k and, for each A 2 A, at\nleast nA species from A are included in X\n0.\nThe restricted case solved in [9] is when each element of\nX appears in exactly one set A 2 A and the subtrees in\nfT \u00f0A\u00de : A 2 Ag are vertex disjoint. While this restricted\nversion is shown to be solvable in polynomial time, the\nquestion of the computational complexity of the problem\nunder less stringent or no restrictions is left open. We end\nthis section by observing that determining if there is even a\nfeasible solution to the general problem OPTIMIZING\nDIVERSITY WITH COVERAGE is NP-hard, let alone finding\nan optimal solution. This is because determining if there is a\nfeasible solution is equivalent to the classic NP-complete\ndecision problem HITTING SET [4].\nProblem: HITTING SET\nInstance: A collection A of subsets of X and an integer k.\nQuestion: Does there exist a subset X0 of X of size at most k\nsuch that A \\X0 6\u00bc ; for all A 2 A?\nFor an instance of HITTING SET as aforementioned,\nconsider the instance of OPTIMIZING DIVERSITY WITH\nCOVERAGE by taking the same sets X and A and integer\nk. Now, take nA \u00bc 1 for all A 2 A and let T be an arbitrary\nphylogenetic X-tree. Then, a subset of X is a feasible\nsolution to the latter problem if and only if it is a feasible\nsolution to the former problem. Conversely, for an instance\nof OPTIMIZING DIVERSITY WITH COVERAGE, consider the\ninstance of HITTING SET by taking the ground set to be X,\nthe bound to be k, and choosing the collection of subsets of\nX to be\nfB : 9A 2 A; B \b A; jBj \u00bc jAj \u0002 nA \u00fe 1g:\nIn short, this collection consists of, for eachA 2 A, all subsets\nof A of size jBj \u00bc jAj \u0002 nA \u00fe 1. It is now easily seen that a\nsubset of X is a feasible solution to this instance of HITTING\nSET if and only if it is a feasible solution to the original\ninstance of OPTIMIZING DIVERSITY WITH COVERAGE.\nThe above-mentioned equivalence suggests that the\nrestrictions required to make OPTIMIZING DIVERSITY WITH\nCOVERAGE solvable or even approximable must be fairly\nsevere. Certainly, they must at least make the associated\nrestricted version of HITTING SET tractable. One example\ncould be to restrict k to be at least\nP\nA2A nA. In this case,\nHITTING SET is trivial, and hence, a feasible solution to\nOPTIMIZING DIVERSITY WITH COVERAGE can be found\neasily. However, it is still not clear whether the optimal\nsolution can be found efficiently.\n6 ROOTED PHYLOGENETIC TREES\nIn practice, one frequently wants to work with the rooted\nanalog of PD. In this short section, we briefly describe how\nApproxBNRS can be applied to RBNRS and the conse-\nquences of Theorem 3.1 for this problem.\nA rooted phylogenetic X-tree T is a rooted tree with no\ndegree-2 vertices, except for, perhaps, the root and whose\nleaf set is X. Let E denote the edge set of T and let \u0002 :\nE ! IR\u00040 be an assignment of lengths (weights) to the edges\nof T . For a subset S of X, the rooted PD (rPD) of S on T is\nthe sum of the edge lengths of the minimal subtree of T that\nconnects S and the root of T . RBNRS is the same as that in\nthe unrooted setting but with the rooted phylogenetic tree\nBORDEWICH AND SEMPLE: NATURE RESERVE SELECTION PROBLEM: A TIGHT APPROXIMATION ALGORITHM 279\nreplacing the unrooted phylogenetic tree and using rPD\ninstead of PD. In particular, it is formally defined as follows:\nProblem: RBNRS\nInstance: A rooted phylogenetic X-tree T , a nonnegative\n(real-valued) weighting \u0002 on the edges of T , a collection A\nof subsets of X, a cost function c on the sets in A, and a\nbudget B.\nQuestion: Find a subset A0 of A, which maximizes the rPD\nscore of\nS\nA2A0 A on T such that\nP\nA2A0 c\u00f0A\u00de \u0005 B.\nWe can interpret an instance of RBNRS as an instance of\nBNRS as follows: Given an instance of RBNRS, let T \u0005 denote\nthe unrooted phylogenetic tree obtained from T by\nadjoining a new leaf \u0005 via a new edge to the root of T\nand then viewing the resulting tree as an unrooted\nphylogenetic tree with leaf set X [ \u0005. Let A\u0005 denote the\nset ffA [ \u0005g : A 2 Ag and let c\u0005 denote the cost function on\nA\u0005 by setting c\u0005\u00f0A [ \u0005\u00de \u00bc c\u00f0A\u00de for all A 2 A. Furthermore,\nlet \u0002\u0005 be the weighting on the edges of T \u0005 by setting the\nweight of the edge incident with \u0005 to be 0 and let \u0002\u0005\u00f0e\u00de \u00bc\n\u0002\u00f0e\u00de for all e 2 E\u00f0T \u00de.\nWith the above setup, let G be a feasible solution to RBNRS\nand let G\u0005 \u00bc fA [ \u0005 : A 2 Gg. Then, G\u0005 is a feasible solution to\nthe above instance of BNRS, and rPD\u00f0G\u00de \u00bc PD\u00f0G\u0005\u00de. Simi-\nlarly, if G0\u0005 is a feasible solution of the above instance of BNRS,\nthen G0 \u00bc fA : A [ \u0005 2 G0\u0005g is a feasible solution of RBNRS,\nand PD\u00f0G0\u0005\u00de \u00bc rPD\u00f0G0\u00de. It is now easily seen from this\nequivalence that ApproxBNRS provides a polynomial-time\n\u00f01\u0002 1=e\u00de-approximation algorithm for RBNRS. Moreover,\nthe argument at the end of the proof of Theorem 3.1, showing\nthat MAXIMUM k-COVERAGE can be interpreted as a special\ncase of BNRS, still works for RBNRS but uses a rooted star\ntree instead of an unrooted star tree. Thus, no approximation\nalgorithm for RBNRS exists with a ratio better than \u00f01\u0002 1=e\u00de,\nunless P \u00bc NP.\nACKNOWLEDGMENTS\nMagnus Bordewich was supported by the EPSRC, and\nCharles Semple was supported by the New Zealand\nMarsden Fund.\nREFERENCES\n[1] D.P. Faith, \u201cConservation Evaluation and Phylogenetic Diversity,\u201d\nBiological Conservation, vol. 61, pp. 1-10, 1992.\n[2] D.P. Faith and A.M. Baker, \u201cPhylogenetic Diversity (PD) and\nBiodiversity Conservation: Some Bioinformatics Challenges,\u201d\nEvolutionary Bioinformatics Online, pp. 70-77, 2006.\n[3] U. Feige, \u201cA Threshold of lnn for Approximating Set Cover,\u201d\nJ. ACM, vol. 45, pp. 634-652, 1998.\n[4] M.R. Garey and D.S. Johnson, Computers and Intractability: A Guide\nto the Theory of NP-Completeness. Freeman, 1979.\n[5] K. Hartmann and M. Steel, \u201cMaximizing Phylogenetic Diversity in\nBiodiversity Conservation: Greedy Solutions to the Noah\u2019s Ark\nProblem,\u201d Systematic Biology, vol. 55, pp. 644-651, 2006.\n[6] D. Hochbaum, \u201cApproximating Covering and Packing Problems:\nSet Cover, Vertex Cover, Independent Set, and Related Problems,\u201d\nApproximation Algorithms for NP-Hard Problems. PWS, 1997.\n[7] S. Khuller, A. Moss, and J. Naor, \u201cThe Budgeted Maximum\nCoverage Problem,\u201d Information Processing Letters, vol. 70, pp. 39-\n45, 1999.\n[8] C. Moritz and D.P. Faith, \u201cComparative Phylogeography and the\nIdentification of Genetically Divergent Areas for Conservation,\u201d\nMolecular Ecology, vol. 7, pp. 419-429, 1998.\n[9] V. Moulton, C. Semple, and M. Steel, \u201cOptimizing Phylogenetic\nDiversity under Constraints,\u201d J. Theoretical Biology, vol. 246,\npp. 186-194, 2007.\n[10] F. Pardi and N. Goldmann, \u201cSpecies Choice for Comparative\nGenomics: Being Greedy Works,\u201d PLoS Genetics 1, p. e71, 2005.\n[11] F. Pardi and N. Goldman, \u201cResource-Aware Taxon Selection for\nMaximising Phylogenetic Diversity,\u201d Systematic Biology, vol. 56,\nno. 3, pp. 431-444, June 2007.\n[12] A.S.L. Rodrigues and K.J. Gaston, \u201cMaximising Phylogenetic\nDiversity in the Selection of Networks of Conservation Areas,\u201d\nBiological Conservation, vol. 105, pp. 103-111, 2002.\n[13] A.S.L. Rodrigues, T.M. Brooks, and K.J. Gaston, \u201cIntegrating\nPhylogenetic Diversity in the Selection of Priority Areas for\nConservation: Does It Make a Difference,\u201d Phylogeny and\nConservation, A. Purvis, J.L. Gittleman, and T. Brooks, eds.,\nCambridge Univ. Press, 2005.\n[14] C. Semple and M. Steel, Phylogenetics. Oxford Univ. Press, 2003.\n[15] T.B. Smith, K. Holder, D. Girman, K. O\u2019Keefe, B. Larison, and Y.\nChan, \u201cComparative Avian Phylogeography of Cameroon and\nEquatorial Guinea Mountains: Implications for Conservation,\u201d\nMolecular Ecology, vol. 9, pp. 1505-1516, 2000.\n[16] M. Steel, \u201cPhylogenetic Diversity and the Greedy Algorithm,\u201d\nSystematic Biology, vol. 54, pp. 527-529, 2005.\nMagnus Bordewich received the MMath de-\ngree and the DPhil degree in mathematics from\nOxford University in 1998 and 2003, respec-\ntively. He was a postdoctoral research fellow in\nthe Department of Mathematics and Statistics,\nUniversity of Canterbury, Christchurch, New\nZealand, and, then, in the School of Computer\nScience, Leeds University, Leeds, United King-\ndom. In 2006, he joined Durham University,\nwhere he is currently a lecturer in the Depart-\nment of Computer Science and has recently been awarded an EPSRC\npostdoctoral fellowship in theoretical computer science, researching on\nrandomized algorithms and approximation in phylogenetics.\nCharles Semple received the BSc degree\n(Hons) in mathematics from Massey University\nand the MSc and PhD degrees in mathematics\nfrom Victoria University of Wellington. Initially a\npostdoctoral fellow, since 2001, he has been a\npermanent staff member at the University of\nCanterbury, where he is currently an associate\nprofessor in the Department of Mathematics and\nStatistics. He was a visiting research fellow in\nMerton College, University of Oxford, in 2003, a\nvisiting professor at the Universite\u00b4 de Montpellier II in 2005, and a\nvisiting fellow in the Isaac Newton Institute for Mathematical Sciences,\nUniversity of Cambridge, in 2007. His research interests include\ncombinatorics, computational complexity, and computational biology.\n. For more information on this or any other computing topic,\nplease visit our Digital Library at www.computer.org\/publications\/dlib.\n280 IEEE\/ACM TRANSACTIONS ON COMPUTATIONAL BIOLOGY AND BIOINFORMATICS, VOL. 5, NO. 2, APRIL-JUNE 2008\n"}