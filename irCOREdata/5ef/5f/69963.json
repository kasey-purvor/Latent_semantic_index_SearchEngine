{"doi":"10.1049\/ip-cta:19982383","coreId":"69963","oai":"oai:eprints.lancs.ac.uk:19480","identifiers":["oai:eprints.lancs.ac.uk:19480","10.1049\/ip-cta:19982383"],"title":"Nonminimal state space approach to multivariable ramp metering control of motorway bottlenecks","authors":["Taylor, C. James","Young, Peter C.","Chotai, Arunkumar","Whittaker, Joseph"],"enrichments":{"references":[{"id":16324271,"title":"Tracking and predicting a network traffic","authors":[],"date":"1997","doi":"10.1016\/s0169-2070(96)00700-5","raw":"WHITTAKER, J., GARSIDE, S., and LINDVELD, K.: \u2018Tracking and predicting a network traffic process\u2019, Int.  J. Forecasting, 1997, 13, pp. 51-61 PAPAGEORGIOU,  M.  (Ed.): \u2018Concise encyclopedia  of  traffic and transportation systems\u2019 (Pergamon Press, Oxford, 1991) YOUNG, P.C.,  BEHZADI, M.A.,  WANG, C.-L.,  and  CHOTAI, A.:  \u2018Direct  digital  and  adaptive  control  by  input-output, state variable feedback pole assignment\u2019, Int. J. Control, 1987, 46, pp. 1867-1881 CHOTAI, A., YOUNG, P.C., and BEHZADI, M.A.: \u2018Self-adaptive  design  of  a  nonlinear  temperature  control  system\u2019, special issue on self-tuning control, IEE Proc. D,  1991, 38, pp. 4149 TAYLOR, C.J., YOUNG, P.C., and CHOTAI, A.: \u2018On the relationshio  between  GPC  and  PIP  control\u2019.  in  CLARKE.  D.W. (Ed )  \u201cAdvances  in  Model-Based  Predictive  Control\u2019  (Oxford University Press, Oxford, 1994), pp  53-68 TAYLOR, J,  WHITTAKER,  J , YOUNG,  P,  and  CHOTAI, A.: \u2018Forecasting and control of  interurban traffic networks using a  state space  formulated  traffic  model\u2019, in  PAPAGEORGIOU, M.,  and  POULIEZOS,  A.  (Eds.):  \u20188th  IFAC  symposium  on Transportation  systems,  16-18  June  1997, Chania,  IFACIIFIPI IFORS preprint\u2019, 1997 vol. 3, pp. 105&1059 PAPAGEORGIOU, M.,  HAJ-SALEM, H.,  and  BLOSSEVILLE, J.-M.: \u2018ALINEA: A local  feedback control law  for  onramp metering\u2019, Tronsp. Res. Rec., 1991, 1320, pp. 58-64 PAPAGEORGIOU, M.,  BLOSSEVILLE, J.-M.,  and  HADJSALEM, H.: \u2018Modelling and real time control of  traffic flow on the  southern  part  of  Boulevard  Peripherique  in  Paris:  Part  I: Modelling, Modelling and real  time control of traffic flow on the southern part of  Boulevard Peripherique in Paris: Part 11:  Coordinated on-ramp metering\u2019, Transp. Res. A, 1990, 24A, (5), pp. 345-359, 361-370 YOUNG, P.C., and WILLEMS, J.C.: \u2018An approach to the linear multivariate  servomechanism problem\u2019, hzt. J. Control, 1972, 15, DV. 961-976 10  YOUNG,  P.C.:  \u2018The instrumental  variable  method:  a  prac$cal approach to  identification  and  system  parameter  estimation , in BARKER, H.A., and YOUNG, P.C. (Eds.): \u2018Identification and System  Parameter  estimation\u2019 (Pergamon,  Oxford, 1985), vol.  1, pp.  1-16 11 YOUNG, P.C.,  LEES, M.,  CHOTAI, A.,  TYCH, W.,  and CHALABI, Z.S.:  \u2018Modelling  and  PIP  control  of  a  glasshouse micro-climate\u2019, Control Eng. Prcict., 1994, 2, pp. 591-604 12  CHOTAI, A.,  YOUNG, P.C.,  MCKENNA, P.G.,  and TYCH, W.: \u2018Proportional integral-plus (PIP) design for delta  (6) operator systems: Part 2,  MIMO systems\u2019, Int. J. Control,  1998; 13  YOUNG, P.C.: \u2018A general approach to identification, estimation and  control  for  a  class  of  nonlinear  dynamic  systems\u2019,  in FRISWELL, M.I., and MOTTERSHEAD, J.E. (Eds.): \u2018Identification  in  Engineering  Systems\u2019  (University  of  Wales,  Swansea, 1996), pp. 436445 14 CHEN, O.J., HOTZ, A.F., BEN-AKIVA,  M.: \u2018Development and evaluation of a dynamic ramp metering control model\u2019, in  PAPAGEORGIOU, M., and POULIEZOS, A. (Eds.): \u20188th IFAC symposium  on  Transportation  systems,  16-18  June  1997,  Chania, IFACIIFIPIIFORS preprint\u2019,  1997, vol. 3, pp. 1162-1 167 70, pp. 149-168 514  IEE Proc.-Control Theory Appl., Vol. 14.5,  No. 6,  November 1998 Authorized licensed use limited to: Lancaster University Library. Downloaded on November 12, 2008 at 09:37 from IEEE Xplore.  Restrictions apply.","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"1998-11","abstract":"The paper discusses the automatic control of motorway traffic flows utilising ramp metering, i.e. traffic lights on the on-ramp entrances. A multivariable ramp metering system is developed, based on the nonminimal state space (NMSS) approach to control system design using adaptive proportional-integral-plus, linear quadratic (PIP\u2013LQ) optimal controllers. The controller is evaluated on a nonlinear statistical traffic model (STM) simulation of the Amsterdam motorway ring road near the Coen Tunnel","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/69963.pdf","fullTextIdentifier":"http:\/\/eprints.lancs.ac.uk\/19480\/1\/getPDF.pdf","pdfHashValue":"3fa594bdf6b84f0b38b87685b183956117918b7e","publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lancs.ac.uk:19480<\/identifier><datestamp>\n      2018-01-24T02:32:33Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D47:4745<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        Nonminimal state space approach to multivariable ramp metering control of motorway bottlenecks<\/dc:title><dc:creator>\n        Taylor, C. James<\/dc:creator><dc:creator>\n        Young, Peter C.<\/dc:creator><dc:creator>\n        Chotai, Arunkumar<\/dc:creator><dc:creator>\n        Whittaker, Joseph<\/dc:creator><dc:subject>\n        GE Environmental Sciences<\/dc:subject><dc:description>\n        The paper discusses the automatic control of motorway traffic flows utilising ramp metering, i.e. traffic lights on the on-ramp entrances. A multivariable ramp metering system is developed, based on the nonminimal state space (NMSS) approach to control system design using adaptive proportional-integral-plus, linear quadratic (PIP\u2013LQ) optimal controllers. The controller is evaluated on a nonlinear statistical traffic model (STM) simulation of the Amsterdam motorway ring road near the Coen Tunnel.<\/dc:description><dc:date>\n        1998-11<\/dc:date><dc:type>\n        Journal Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:relation>\n        http:\/\/dx.doi.org\/10.1049\/ip-cta:19982383<\/dc:relation><dc:identifier>\n        Taylor, C. James and Young, Peter C. and Chotai, Arunkumar and Whittaker, Joseph (1998) Nonminimal state space approach to multivariable ramp metering control of motorway bottlenecks. IEE Proceedings - Control Theory and Applications, 145 (6). pp. 568-574. ISSN 1350-2379<\/dc:identifier><dc:relation>\n        http:\/\/eprints.lancs.ac.uk\/19480\/<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/dx.doi.org\/10.1049\/ip-cta:19982383","http:\/\/eprints.lancs.ac.uk\/19480\/"],"year":1998,"topics":["GE Environmental Sciences"],"subject":["Journal Article","PeerReviewed"],"fullText":"Nonminimal state space approach to multivariable \nramp metering control of motorway bottlenecks \nC. J. Taylor \nI? C. You ng \nA. Chotai \nJ. Whitta ker \nIndexing terms: Motorway trafJcjlow. Automatic control, Ramp metering, Nonminimal state space, Proportional integral plus, Linear quadratic \nAbstract: The paper discusses the automatic \ncontrol of motorway traffic flows utilising ramp \nmetering, i.e. traffic lights on the on-ramp \nentrances. A multivariable ramp metering system \nis developed, based on the nonminimal state \nspace (NMSS) approach to control system design \nusing adaptive proportional-integral-plus, linear \nquadratic (PIP-LQ) optimal controllers. The \ncontroller is evaluated on a nonlinear statistical \ntraffic model (STM) simulation of the \nAmsterdam motorway ring road near the Coen \nTunnel. \n1 Introduction \nThe electronics revolution has led to enormous \nadvances in transportation technology. In particular, \ncommunication advancements, coupled with induction \nloops implanted in road surfaces, allow data on traffic \nbehaviour at distant points in a large network to be \nutilised in real time. Automatic data processing tech- \nniques together with intelligent systems for effectively \nutilising the information are now required. In this \nregard, a dynamic state space modelling technique, \nwhich provides transport management with a \u2018data \nassimilation\u2019 tool for monitoring and prediction of \ninterurban motorway networks, has recently been \ndeveloped [ 11. Although developed primarily to provide \nshort term forecasts, the resulting statistical traffic \nmodel (STM) also provides a good simulation model of \nthe traffic system suitable for investigating new control \nmeasures. \nDuring congestion, mean velocities fall dramatic,dly \nand traffic flow becomes lower than the capacity of the \nroad. In this case, the motorway is not utilised in the \nmost efficient manner and overall travel times and \nqueue lengths are higher than their theoretically opti- \nmum values. Ramp metering utilises traffic lights at the \non-ramp entrances to limit access to the main carriage- \nway of the motorway in an attempt to maintain flow \nclose to the capacity. Most commonly, an occupancy \nset point is employed. Occupancy, which is usually \n0 IEE, 1998 \nIEE Proceedings online no. 19982383 \nPaper fxst received 4th February 1998 and in revised form 6th May 1998 \nThe authors are with the Centre for Research on Environmental Systems \nand Statistics, Lancaster University, UK \nmeasured by induction loops embedded in the road \nsurface, is defined as the proportion of time during \nwhich vehicles are above the loop and is linearly related \nto the density of traffic on the carriageway [[2], p. 1411. \nThe proposed approach to ramp metering control is \nbased on earlier research into nonminimal state space \n(NMSS) control system designs [ 3 ,  41. This approach \nyields proportional-integral-plus (PIP) controllers \nwhich can be considered as logical successors to con- \nventional two- and three-term controllers, but exploit \nmodel-based predictive control action [5]. There are \nnumerous advantages to this more advanced approach: \nthe vagaries of manual tuning are replaced by model- \nbased computation of the control gains; its structure \nalways exploits fully the power of state variable feed- \nback (SVF) methods, thus allowing for the implemen- \ntation of optimal control strategies, such as the PIP \nlinear quadratic (PIP-LQ) controller discussed in this \npaper; and it does not rely on digitisation of a continu- \nous-time design but works directly with discrete-time \ntransfer function (TF) models identified from normal \noperational data. \nThe present paper, which follows up earlier research \nfor the European Community DACCORD project [6], \nutilises STM simulations of the motorway network on \nthe Amsterdam motorway ring road to evaluate the \ncontrol designs. This ring road is a highly monitored \nnetwork and is the focus of a broad traffic manage- \nment programme in The Netherlands. At the Coen \nTunnel, on the western part of the ring, there is often a \ntraffic jam in the southern direction during the morn- \ning peak hour, and in the northern direction during the \nafternoon peak hour. Ramp metering has been applied \nat this location since 1989, when the first metering sys- \ntem in The Netherlands was installed. One particularly \nsuccessful and well known approach, for example, is \nthe ALINEA strategy [7], based on a simple integral \nfeedback controller. \nWhen ramp metering was first introduced near the \nCoen Tunnel, it improved the flow of traffic at this \nlocation. As might be expected, however, there was a \ncorresponding increase in flow from upstream, unme- \ntered (at that time) on-ramps. Clearly, by metering sev- \neral on-ramps, the traffic can be more equally \ndistributed over the entrances to the motorway, in prin- \nciple resulting in fewer disturbances and smaller \nqueues. This simple example illustrates the importance \nof coordination between different on-ramps in a region. \nA degree of coordination may be obtained with \nessentially local controllers, such as ALINEA, by intro- \nIEE Proc-Control Theory Appl.. Vol. 145, No. 6,  November 1998 568 \nAuthorized licensed use limited to: Lancaster University Library. Downloaded on November 12, 2008 at 09:37 from IEEE Xplore.  Restrictions apply.\nducing simple rule-based decisions. However, a full \nmultivariable approach, such as the linear quadratic \nintegral (LQI) control law of Papageorgiou et al. [SI, or \nthe related PIP-LQ method discussed in the present \npaper, provides a mechanism for inherent coordination. \nThe LQI controller, which has been available for many \nyears [9], is a standard LQ control law, with the addi- \ntion of an integral control component to ensure zero \nsteady state offset, even in the presence of output dis- \nturbances to the system. As Papageorgiou et al. empha- \nsise, such an optimal approach provides a powerful \ndesign tool which can be applied directly to nonlinear \nsystems, such as traffic systems, if they can be ade- \nquately linearised around a desired steady state. In the \npresent research, such linearisation is achieved through \nthe use of data-based identification and estimation \ntechniques, where simple linear TF models are obtained \nby recursive estimation based on the telemetered traffic \nflow measurements. \n, \ni \n2 \nlinearisation \nThe statistical traffic model (STM) and \nThe STM [l] includes the following components: (i) a \nstate vector that holds two variables per link, namely \ntraffic density ( r ,  vehicledkm) and flow (q, vehicles\/ \nminute), ordered by the corresponding measurement \nstation; (ii) an observation vector that holds informa- \ntion from the monitoring stations: (iii) a vector of \nexogenous inputs consisting of the flows from the on- \nramp entrances; and (iv) variables that specify the \nbehaviour of the system, such as measures of link \nlength and capacity. The state transition matrix \ndepends on traffic dynamics, which classically follow \ndifferential equations analogous to those of fluid \ndynamics. \nloo 80 h \nI b \n01 I I I I I I I \n0 50 100 150 200 250 300 350 \ndensity, vehlkm \nTypical fundaniental trafic diagram utilised in the solution Fig. 1 \nIn particular, the three types of equations which \ncomprise the model are as follows: a balance equation, \nwhich ensures that vehicles are conserved; a flow equa- \ntion based on the identity q = v\u2019r where v is the velocity \n(km\/hour); and a highly nonlinear, fundamental traffic \ndiagram (FTD) relating the velocity to the density. The \nFTD takes the shape illustrated in Fig. 1, where it is \nclear that during \u2018free flow\u2019 conditions at low densities, \nthe corresponding velocities are high, as would be \nexpected. However, once the density exceeds a critical \nlevel, linear flow conditions end and the velocity falls \ndramatically due to developing congestion. It is this \ncritical density, defining the capacity of the road, that \nIEE Proc.-Control Theory Appl.. Vol. 145, No. 6, November 1558 \nis of most importance when defining the set point for \ncontrol design. The STM equations hold for on-ramps \n(or merging motorways) and off-ramps (or diverging \nmotorways), with the latter requiring the estimation of \na turning fraction between the two downstream choices. \nThe network is built up from a number of such links, \ne.g. for sections of motorway between two adjacent \nmeasurement stations (typically 0.5 km). \nAlthough in previous publications the STM has been \nused as a basis for data assimilation using the Kalman \nFilter [I], the present paper utilises the STM purely as \na simulation tool. For this purpose, the STM parame- \nters are selected to represent particular flow conditions \nof interest, such as free flow, congestion or lane clo- \nsure, with realistic upstream flows, on-ramp demands \nand turning fractions introduced to ensure authentic \ntraffic behaviour. For example, in order to bring the \nresults as close to real traffic conditions as possible, \nmeasured data are employed as inputs to the system \n(i.e. defining the boundary conditions). When used for \nsimulation in this manner, the STM yields traffic \nbehavioural patterns similar to those encountered on \nseveral road networks in The Netherlands [l]. \nIn its basic form, the high order STM is much too \ncomplex for use in analytical control system design. In \norder to develop a linear optimal control algorithm, a \nlinearised, small perturbation, representation of the traf- \nfic system is required and this is normally obtained by \nconventional linearisation of the nonlinear model equa- \ntions. We have found, however, that the behaviour of \nthe nonlinear traffic system can be approximated well \nby simple, reduced order linearised time variable \nparameter (TVP) transfer function models (see eqn. 1 \nin Section 3) that are identified and recursively esti- \nmated directly from simulated or real data using the \nsimplified refined instrumental variable (SRIV) algo- \nrithm [lo]. Such linearised models may be obtained for \nany of the macroscopic traffic variables measured on \nmotorways, including flow, velocity and occupancy. \nThis novel approach to combined linearisation and \nmodel reduction is particularly valuable because it not \nonly identifies directly the range of applicability of the \nlinearised model but it also facilitates the subsequent \ndesign of an adaptive controller using online recursive \nestimation of the model parameters [4]. \nTaylor et al. [6] successfully apply these modelling \ntechniques to actual telemetered traffic data from \nmotorways in The Netherlands and discuss how the \nparameters change over time according to current lev- \nels of congestion. In fact, it was found that the model \nfit is the strongest during the most congested part of \nthe data set. This result is worth stressing: it suggests \nthat the linear model most adequately describes the \ndata when traffic control is most needed. \n3 Nonminimal state space (NMSS) control \ndesign: the PIP-LQ controller \nAs an illustration of the proposed control methodol- \nogy, we consider the coordinated ramp metering of \nnorthbound traffic on the Amsterdam ring road, south \nof the Coen tunnel. The algorithm is implemented on \nan STM simulation of the corridor, assuming that \nmeasurements are available from each of the eight \nSTM links, as in Fig. 2. Note that the STM is based on \ndensity variables rather than occupancy, but since the \ntwo are linearly related the algorithm may be devel- \noped in terms of occupancy without any additional \n569 \nAuthorized licensed use limited to: Lancaster University Library. Downloaded on November 12, 2008 at 09:37 from IEEE Xplore.  Restrictions apply.\ncomplications. As the system illustrated in Fig. 2 con- \nsists of four on-ramps (Ul-U4), an associated four \nlocations may be controlled using SVF methods. Th\u2019ese \nare selected as the \u2018bottlenecks\u2019 immediately follow mg \nthe sections where the on-ramps merge with the motor- \nway (i.e. L2, L4, L6 and L8). \nA =  \nu4 \n- - \na1 c 1  0 0 0 0 0 0 0 0 0 0  \nb2 az cz  0 0 0 0 0 0 0 0 0  \n0 b3 a3 c3 0 0 0 0 0 0 0 0  \n0 0 b4 a4 c q  0 0 0 0 0 0 0  \n0 0 0 b5 a5 c5 0 0 0 0 0 0  \n0 0 0 0 b6 ag CG 0 0 0 0 0  \n0 0 0 0 0 b7 a 7  ~7 0 0 0 0  \n0 0 0 0 0 0 bs ~g 0 0 0 0  \n- b z - a 2 - ~ 2  0 0 0 0 0 1 0 0 0  \n0 0 -b4  -a4 - c 4  0 0 0 0 1 0 0  \n0 0 0 0 -bs -a6 - C F  0 0 0 1 0  \n0 0 0 0 0 0 - b g - a g 0 0 0 1  - \nU \n10.4: L4 p \nwul 0.51 L1 I - \nFig.2 Schematic diugrum of the STM simulation of the Amsterdam \nA10 West showing the relative locutions of the links (LI-U).  on-rmzps \n(UI-U4) and off-ramps (Rl-R3) \nthe numbers on the left indicate the link lengths in kilometres \nAlthough most of the corridor consists of two lanes \nof traffic, at the upstream end of Fig. 2 the links L1. to \nL3 have three lanes; while the on-ramps have one lane \nof traffic, except for U3 which has two. The ramp \nmetering system is intended to allow one car to pass \nthe traffic lights for each green period, usually with a \ncycle time in the range 4.5 to 12 seconds, yielding on- \nramp flows of 5 to 13.33 veh\/min. \n3. I State space representation of the system \nThe local linear model for occupancy at location s \ntakes the following general form: \nOs$ = U s O s , t - l  + ~ s o s - l , t - l  +CsOs+l , t - l+  {dsus , t - l }  \n(1) \nwhere o , - ~ , ~  and o , ~ + ~ , ,  are the occupancies at locations \nimmediately upstream and downstream of o , ~ , ~ ;  us,, is the \nf low from the associated on-ramp (if one exists); and a,7, \nb,, cS, ds are the time variable parameters. In the nota- \ntion of eqn. l ,  02,f is the occupancy at link L2 after the \non-ramp, while u2,, is the on-ramp flow U1 at that loca- \ntion. Of course, if the data-based identification analysis \nsuggests that a higher order model than eqn. I is \nappropriate, this introduces no problems since the PIP \ncontrol system design methods can be applied to T F  \nmodels of any order, with any number of sampled time \ndelays [3-5]. However, analysis of telemetered data \nfrom The Netherlands suggest that higher order models \nare not necessary in this case [6]. \n570 \n7 \nThe associated state space system is described by the \nfollowing nonminimal state space (NMSS) equations \nthat are derived directly from the linear model (eqn. 1) \nand its associated parameter estimates: \nT \nXt = A x t - 1  + But-1 + DYd,t  x \nY t  = cxt (2) \nHere x, is the nonminimal state vector composed only \nof the measured variables which, in the case of the A10 \nWest, takes the following form, \nAuthorized licensed use limited to: Lancaster University Library. Downloaded on November 12, 2008 at 09:37 from IEEE Xplore.  Restrictions apply.\nB =  O O d g O  \n0 0 0 0  \nO O O d s  \n--dz 0 0 0 \n0 -d4 0 0 \n0 0 -& 0 \n- 0 0 0 4 s -  \n0 0 0 1  0 0 0 0  \n0 0 0 0  1 0 0 0  \n0 0 0 0  0 1 0 0  \n0 0 0 0  0 0 1 0  \n-0  0 0 0-  -0  0 0 1- \nT - 1 '  ' 1  D , l o  ' 1  \n0 0 0 0  0 0 0 0  \nc -  \nand has been evaluated in practice on many real \nsystems [7, 113. \nNote that the results obtained in Section 4 (below) \nhave been obtained with a fixed parameter PIP control \nlaw of the above kind (eqn. 9). For all of the simulated \ntraffic conditions investigated so far, this has yielded \nsatisfactory regulation of the traffic flows. However, \nthe recursive SRIV estimation results suggest that the \nparameters of the linear model may change signifi- \ncantly when extreme motorway conditions are encoun- \ntered (see [6]). In such situations, it is advantageous to \nimplement an adaptive PIP controller in which the Ric- \ncati equation and the resulting control gain matrix are \nboth updated at each sample on the basis of the latest \nrecursive SRIV estimates of the linearised model \nparameters (see [4]). \nIn practice, the final stage in the algorithmic design is \nthe translation of the calculated U, into a practical con- \ntrol input to the system: namely a traffic light \nsequence. Most ramp metering systems, such as those \nutilised in The Netherlands, are designed to allow one \nvehicle onto the motorway at a time, so that the con- \ntrol input signal is simply inverted to obtain the \nrequired 'seconds per vehicle' between each green phase \n(the cycling time). However, since the inputs to the \nSTM are flow signals, this step is not required for the \nsimulation study. \nIt is worth noting that, due to the special structure of \nthe non-minimal state vector, the LQ weighting matri- \nces in the cost function (eqn. 8) have particularly sim- \nple interpretation, since the diagonal elements directly \ndefine weights assigned to the measured variables and \nintegral of error states. In the general multivariable \ncase, however, these matrices are not readily translated \ninto exact closed-loop response characteristics, such as \ndecoupling, overshoot and rise times. In this regard, \none recently developed technique that automatically \nmaps the various technical characteristics into the ele- \nments of Q and R, is multi-objective optimisation in its \ngoal attainment form [12]. Rather than directly opti- \nmising the control gains themselves, this method opti- \nmises the parameters of the Cholesky factors of Q, \nwhich has the advantage of generating only guaranteed \nstable optimal solutions. When applied to the problem \nof traffic control, this multi-objective approach may be \nutilised to obtain PIP-LQ controllers that are robust to \na specified range of traffic conditions on the basis of \nrepeated simulations with the STM. \n4 Simulation experiments \nIn the simulation experiments used to evaluate the opti- \nmal PIP-LQ ramp metering control system designs, the \nSTM is solved in MATLAB\/SIMULINK'\" at a 10 sec- \nond sampling interval with a realistic set of traffic \ninputs. Here, measured flow from the A10 motorway at \nthe appropriate location south of the Coen Tunnel (1 5 \nMay 1995) is employed as the upstream input; while \nthe on-ramp inputs are fully constrained within the sat- \nurations currently employed on the real system. In \naddition, a realistic set of on-ramp demands are used in \nthe simulation, so that the final on-ramp flow is the \nminimum of the calculated control input and the flow \nactually approaching the on-ramp. \n4.1 No on-ramp control \nA typical simulation of the STM with the above inputs \nand without any on-ramp control is shown in Figs. 3 \n57 1 \nAuthorized licensed use limited to: Lancaster University Library. Downloaded on November 12, 2008 at 09:37 from IEEE Xplore.  Restrictions apply.\n1 \nflows on the motorway, while avoiding congestion on \nthe approach roads. \ni \nand 4. Since this simulation illustrates the 'uncon- \ntrolled.' response of the traffic system from 2pm until \n8:45 pm, it includes the afternoon 'rush hour', which \noccurs during the middle part of the simulation, as can \nbe seen quite clearly in the on-ramp flows of Fig. 4. It \nis also clear that, while no congestion occurs in link L2, \nthe remaining links become severely congested, as rep- \nresented by the dramatic increase in density illustrated \nin Fig. 3. In fact, the congestion is so severe that the \nassociated velocities for links L6 and L8 remain below \n20km\/h for most of the time and, in practice, the vehi- \ncles may become stationary. \n60' 6or------ \n- 40 50i I \/+In I \n30 30 U == \nY 20 \n4pm 6pm 8pm 4pm 6pm 8pm \ng 20 \nr e \n............................... ....... \n30 \n20- 20' \n4pm 6pm 8pm 4pm 6pm 8pm \nFig. 3 \n(top left, top right, bottom left, bottom right, respectively). Set point used in \nFig. 5 (dotted) \nUncontrolled density at locations L2, LA, Lh and L.8 \nr \n12 12 \n9 9 \nE 6  6 \n4pm 6pm 8pm 4pm 6pm 8pm ._ E \n2 \nI \n12 \n9 \n6 \nI I I I \n4pm 6pm 8pm 4pm 6pm 8pm \nFig.4 Uncontrolled on-rump flow at locutions U1, U2, U3 and U4 \n(top left, top right, bottom left, bottom right, respectively) \n4.2 Unrealistic unconstrained on-ramp \ncontrol \nAs an initial evaluation step, the PIP-LQ controller is \nfirst simulated without any constraints applied to ]:he \ninput signals. Furthermore, it is assumed that the spec- \nified control input signals can be exactly achieved, i.e. \nthere are always vehicles waiting at the on-ramp, ready \nto be released when the controller demands this. In this \nhighly simplified and unrealistic situation, the multivar- \niable PIP-LQ control algorithm successfully maintains \nthe specified densities and, in fact, is able to completely \ndecouple the densities at each of the four bottlenecks, \nshowing the efficacy of the controller when used in an \nunconstrained situation. Such perfect performance is \nnot, of course, possible in the real world: in particular, \non-ramp U2 requires negative flows, while the flow at \nU1 greatly exceeds the demand actually waiting to join \nthe motorway. The next stage in the design exercise, \ntherefore, is to evolve a modified and realistic PIP-I,Q \nstrategy which maintains smooth, uncongested traffic \n572 \n........................................... 35 35 \n30 \n25 c \nL -  f 4pm 6pm 8pm 4pm 6pm 8pm \nF \n3 5 -  \n25 \nI 1 I \n4pm 6pm 8pm 4pm 6pm 8pm \nFig.5 Density for LA simulation with input constraints ut locutions L2, \nLA, L.6 and L8 \n(top left, top right, bottom left, bottom right, respectively). Set point (dotted) \n12 12 \n9 9 \n- $ 6  6 \nc i  J \nE 4pm 6pm 8pm 4pm 6pm 8pm \n. \n._ \nr' \n> ,  \nr 8 12 12 \n9 9 \n6 6 \nI I \n4pm 6pm 8pm 4pm 6pm 8pm \nOn-rump flow for a simulation with input constraints at locations Fig.6 \nUI, U2, U3 and U4 \n(top left, top right, bottom left, bottom right, respectively) \n4.3 Realistic constrained PIP-L 0 control \nFigs. 5 and 6 illustrate the performance of the PIP-LQ \ncontroller when input saturations and the realistic on- \nramp demands are taken into account. In this case the \nQ and R weighting matrices are simply left as identity \nmatrices and the set points at the four locations are \nchosen according to the capacity of the road under \nthese conditions (dotted traces in Fig. 5) .  In this con- \nstrained implementation of the controller, the final on- \nramp flow is the minimum of the calculated control \ninput and the flow actually approaching the on-ramp. \nFor example, the controller selects the maximum on- \nramp flow (13.33 veh\/min\/lane) for U1, since the den- \nsity at L2 is below the set point for the entire simula- \ntion. In this case, however, the actual demand at this \non-ramp is somewhat lower (initially about 8 veh\/min\/ \nlane, rising to 10-11 veh\/min\/lane during the middle of \nthe simulation) and it is this lower figure that is actu- \nally utilised as the on-ramp flow in the simulation. By \ncontrast, at on-ramps U2 and U4, the input is often \nconstrained at its minimum value ( 5  veh\/min\/lane). \nDespite these input constraints, the multivariable \ncontrol algorithm is able to maintain good regulation \nof the density at the four bottlenecks and it clearly pre- \nvents the congestion seen in Figs. 3 and 4. Of course, \nwhen the demands on the network are low during the \nearly afternoon and evening periods, there is no need \nto restrict entry onto the main carriageway. Here, the \ndensities fall well below the set points so the control \nalgorithm specifies the maximum allowed input signals. \nIEE Proc.-Control Theory Appl.. Vol. 145. No. 6,  November 1998 \nAuthorized licensed use limited to: Lancaster University Library. Downloaded on November 12, 2008 at 09:37 from IEEE Xplore.  Restrictions apply.\nI \nIn this case, therefore, the on-ramp inputs depend on \nthe actual demand approaching the motorway from the \nurban network. \nIt is worth noting that when the on-ramp inputs are \noperating within their allowable limits, the control is \nvery good indeed. For example, the PIP-LQ controller \nmaintains tight control of the density close to the Coen \ntunnel at L6 and L8. Similarly, the algorithm reacts \nquickly to deal with the sudden large peaks in the den- \nsity at L4, automatically engaging and disengaging the \nramp metering as required (see Fig. 6). \n, \n40 \nm \nQ -. \n35 \nC \n> \n$ \nc \nV \n30 \nI I \n4pm 5Pm 6pm \nFig.7 \n(-) at location LA \nPIP:LQ control (-) compared to local integral control \nI I \n4pm 5Pm 6Pm \nFig.8 \n(-) at location U4 \nPIP-LQ control (-) compared to local integrul control \n4.4 Comparison with local integral control \nIn Figs. 7 and 8, the performance of the multivariable \nPIP-LQ design is compared with one of the approaches \ncurrently being employed on the real network; namely \nlocal integral control at each location in the corridor, \nwith the integral control gain tuned manually to obtain \nthe best performance. Note that the downstream on- \nramp (U4) is saturated for much of the time during the \nsimulation, as illustrated in Fig. 8. For example, during \nthe period 5:35pm to 5:45pm, the flow at U4 is held at \nthe minimum allowed value of 5 veh\/min\/lane, explain- \ning the overshoot of the set point during this part of \nthe day for both the PIP-LQ and especially for the \nintegral controller. However, the superiority of the \nmultivariable design is clear: as would be expected, if \nthe gain on the local integral controller is too low then \nthe response to disturbances is poor, as in Fig. 7; while \nif the gain is too high, then the input signal tends to be \nvery volatile and there is a danger of instability. The \nadvantage of the PIP-LQ approach is that it is able to \nachieve rapid response, without these problems. \nIEE Proc.-Control Theory Appl. ,  Vol. 145, No. 6, November 1998 \n4.5 Other possibilities \nFurther evaluation of the constrained PIP-LQ control \nsystem reveals a potential problem with the controller \nin its present form; namely that certain traffic condi- \ntions can arise such that \u2018poorly chosen\u2019 set points are \nnot achievable in practice. For example, if the set point \nat L6 in Fig. 5 is increased from 30 to 35 veh\/km\/lane, \nthen the flow to the downstream links is increased to a \npoint where the density at L8 exceeds the set point dur- \ning the most congested part of the day. The input U4 is \nunable to prevent this offset since it becomes saturated \nat its minimum allowed value ( 5  veh\/min\/lane); while \nthe coordination between locations does not yield the \nnecessary reduction in the input from the next \nupstream on-ramp U3. This limitation arises because, \nalthough it is only the positive error that may lead to \ncongestion on the main carriageway, LQ optimisation \npenalises a negative error (when the density is below \nthe set point, as for L6 during the first 2 hours of the \nsimulation) to the same degree as a positive error. This \nis simply because the PIP-LQ controller is basically a \nIinear design, albeit modified to handle the practical \nconstraints. \nOne solution to this kind of problem is to introduce \na simple, rule-based, upper level controller into the sys- \ntem. Here, when an input is saturated at its minimum \nvalue for a specified period of time, the set point at the \nnext upstream location is gradually ramped down. This \nreduces the density downstream because of the natural \nlinkages in the motorway system. We have found that \nsuch a hierarchical controller, programmed to coordi- \nnate the set points at this second level, works very well \nin this example and is based on reasonable heuristics. \nAnother approach which has proven effective is to sim- \nply modify the weighting matrices employed in the LQ \noptimisation. For example, the effect of greatly reduc- \ning the diagonal weighting terms associated with the \nintegral-oferror states for L2, L4 and L6, is to force \nthe control algorithm to concentrate on preventing \ncongestion at L8. This is a reasonable aim in practice, \nsince the greatest problems of congestion occur close to \nthe Coen Tunnel, downstream of the four on-ramps. In \neffect, the controller is able to successfully maintain \ntight control at this location by automatically restrict- \ning entry to the upstream on-ramps U1, U2 and U3 \nwhen necessary. \nThis latter kind of redesign requires manual adjust- \nment of the (usually diagonal) weighting matrices. A \nsuperior alternative, presently under investigation, is to \napply multiple objective optimisation (see Section 3.2) \nand so determine whether improved solutions are pos- \nsible by exploiting fully the off-diagonal elements of the \nweighting matrices. The authors are presently investi- \ngating ways of effectively utilising such multi-objective \noptimisation in the context of dynamic traffic manage- \nment. In this regard, the next stage in the research will \nbe to extend the STM model to provide global evalua- \ntion measures such as total travel times and fuel con- \nsumption. \nOf course, all of the possibilities mentioned above \nentail modification of the linear PIP-LQ control system \ndesign to allow it to handle the constraints and nonlin- \nearities of the real world. This is entirely consistent \nwith previous on-ramp control system designs and \nshould lead to further improvement in the multivaria- \nble performance. However, such developments should \nbe considered as a prelude to the investigation of truly \nSI3  \nAuthorized licensed use limited to: Lancaster University Library. Downloaded on November 12, 2008 at 09:37 from IEEE Xplore.  Restrictions apply.\nnonlinear PIP, or related model-based predictive con- \ntrollers, which take explicit account of the nonlineari- \nties and constraints at the design stage. Such \napproaches are currently receiving attention [ 131. \n5 Conclusions \nThis paper has shown how it is possible to linearise the \nessential dynamics of the nonlinear traffic system and \nso represent a given region of the traffic network i n  a \nnonminimal state space (NMSS) form. This means that \nstate variable feedback techniques based on this NMSS \ndescription, such as the proportional-integral-plus \n(PIP) controller, can be applied to the traffic coni rol \nproblem and so yield self-adaptive, on-ramp metering \ncontrollers which provide a considerable improvement \nover more conventional designs. Here, traffic lights on \nmotorway on-ramps, operated by the PIP controller, \nlimit access to the main carriageway, to prevent the \ndensity of traffic at key bottlenecks from exceeding \ncritical values and so causing congestion. \nRamp metering represents a particularly difficult \ncontrol problem because of the highly constrained, \nnonlinear traffic system. Furthermore, the success of \nany ramp metering methodology is ultimately measured \nin terms of the overall travel times, which depend on \nmany factors in addition to the on-ramp flows. Conse- \nquently, the choice of the occupancy (or other) set \npoint for the controller is of crucial importance. Offline \ncalculation of a constant set point based on the funda- \nmental traffic diagram, contrasts with more sophisti- \ncated approaches utilising online data, where the set \npoints are obtained within a hierarchical system based \non network wide optimisation, as discussed, for exam- \nple, in [14]. The importance of the multivariable PIP \ncontrollers, within this wider context, is that the higher \nlevel objectives will only be effective if there is the pos- \nsibility of very tight coordinated control at the local \nlevel. \nComputer-based simulation models are a well esl ab- \nlished means of testing new approaches to traffic con- \ntrol before they are implemented on real networks. In \nthis tradition, the optimised PIP-LQ designs discussed \nin this paper have been evaluated comprehensively on a \ndetailed MATLABEIMULINK TM simulation of the \nAmsterdam ring road, south of the Coen Tunnel. \u2018The \nsimulation results illustrate the effectiveness of the PIP- \nLQ ramp metering algorithms, both under conditions \nof recurrent congestion (caused by high demand \nexceeding the capacity of the motorway), and in react- \ning to traffic incidents such as lane closure. In particu- \nlar, it is in the response to disturbances away from the \nimmediate area of the on-ramp itself that the PIP algo- \nrithm is particularly useful, since it includes a coordi- \nnated feedback of all the available measurements on \nthe corridor and so can anticipate the onset of conges- \ntion. In this sense, it provides a \u2018second generation\u2019 \n1 \napproach to ramp metering which provides one partic- \nular logical improvement on the mainly local control- \nlers used heretofore. \n6 Acknowledgments \n1 \nThe research described in this paper is partly funded by \nthe European Community DACCORD project, ~ \nTR 1017 in the Fourth Framework Telematics Applica- \ntions Programme, sector Transport. The authors are \nalso grateful for the support of the UK Engineering \nand Physical Sciences Research Council (EPSRC), \ngrant number GR\/J10136. \n7 \n1 \n2 \n3 \n4 \n5 \n6 \n7 \n8 \n9 \nReferences \nWHITTAKER, J., GARSIDE, S., and LINDVELD, K.: \u2018Track- \ning and predicting a network traffic process\u2019, Int. J.  Forecasting, \n1997, 13, pp. 51-61 \nPAPAGEORGIOU, M. (Ed.): \u2018Concise encyclopedia of traffic \nand transportation systems\u2019 (Pergamon Press, Oxford, 1991) \nYOUNG, P.C., BEHZADI, M.A., WANG, C.-L., and CHO- \nTAI, A.: \u2018Direct digital and adaptive control by input-output, \nstate variable feedback pole assignment\u2019, Int. J.  Control, 1987, 46, \npp. 1867-1881 \nCHOTAI, A., YOUNG, P.C., and BEHZADI, M.A.: \u2018Self-adap- \ntive design of a nonlinear temperature control system\u2019, special \nissue on self-tuning control, IEE Proc. D, 1991, 38, pp. 4 1 4 9  \nTAYLOR, C.J., YOUNG, P.C., and CHOTAI, A.: \u2018On the rela- \ntionshio between GPC and PIP control\u2019. in CLARKE. D.W. \n(Ed ) \u201cAdvances in Model-Based Predictive Control\u2019 (Oxford \nUniversity Press, Oxford, 1994), pp 53-68 \nTAYLOR, J ,  WHITTAKER, J , YOUNG, P ,  and CHOTAI, \nA.: \u2018Forecasting and control of interurban traffic networks using \na state space formulated traffic model\u2019, in PAPAGEORGIOU, \nM., and POULIEZOS, A. (Eds.): \u20188th IFAC symposium on \nTransportation systems, 16-18 June 1997, Chania, IFACIIFIPI \nIFORS preprint\u2019, 1997 vol. 3, pp. 105&1059 \nPAPAGEORGIOU, M., HAJ-SALEM, H., and BLOSSE- \nVILLE, J.-M.: \u2018ALINEA: A local feedback control law for on- \nramp metering\u2019, Tronsp. Res. Rec., 1991, 1320, pp. 58-64 \nPAPAGEORGIOU, M., BLOSSEVILLE, J.-M., and HADJ- \nSALEM, H.: \u2018Modelling and real time control of traffic flow on \nthe southern part of Boulevard Peripherique in Paris: Part I: \nModelling, Modelling and real time control of traffic flow on the \nsouthern part of Boulevard Peripherique in Paris: Part 11: Coordi- \nnated on-ramp metering\u2019, Transp. Res. A ,  1990, 24A, (5), pp. 345- \n359, 361-370 \nYOUNG, P.C., and WILLEMS, J.C.: \u2018An approach to the linear \nmultivariate servomechanism problem\u2019, hzt. J. Control, 1972, 15, \nDV. 961-976 \n10 YOUNG, P.C.: \u2018The instrumental variable method: a prac$cal \napproach to identification and system parameter estimation , in \nBARKER, H.A., and YOUNG, P.C. (Eds.): \u2018Identification and \nSystem Parameter estimation\u2019 (Pergamon, Oxford, 1985), vol. 1, \npp. 1-16 \n11 YOUNG, P.C., LEES, M., CHOTAI, A., TYCH, W., and \nCHALABI, Z.S.: \u2018Modelling and PIP control of a glasshouse \nmicro-climate\u2019, Control Eng. Prcict., 1994, 2, pp. 591-604 \n12 CHOTAI, A., YOUNG, P.C., MCKENNA, P.G., and \nTYCH, W.: \u2018Proportional integral-plus (PIP) design for delta (6) \noperator systems: Part 2, MIMO systems\u2019, Int. J.  Control, 1998; \n13 YOUNG, P.C.: \u2018A general approach to identification, estimation \nand control for a class of nonlinear dynamic systems\u2019, in \nFRISWELL, M.I., and MOTTERSHEAD, J.E. (Eds.): \u2018Identifi- \ncation in Engineering Systems\u2019 (University of Wales, Swansea, \n1996), pp. 436445 \n14 CHEN, O.J., HOTZ, A.F., BEN-AKIVA, M.: \u2018Development and \nevaluation of a dynamic ramp metering control model\u2019, in PAPA- \nGEORGIOU, M., and POULIEZOS, A. (Eds.): \u20188th IFAC sym- \nposium on Transportation systems, 16-18 June 1997, Chania, \nIFACIIFIPIIFORS preprint\u2019, 1997, vol. 3, pp. 1162-1 167 \n70, pp. 149-168 \n514 IEE Proc.-Control Theory Appl. ,  Vol. 14.5, No. 6 ,  November 1998 \nAuthorized licensed use limited to: Lancaster University Library. Downloaded on November 12, 2008 at 09:37 from IEEE Xplore.  Restrictions apply.\n"}