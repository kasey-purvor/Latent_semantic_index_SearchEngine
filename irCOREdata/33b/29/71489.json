{"doi":"10.3182\/20060829-3-NL-2908.00006","coreId":"71489","oai":"oai:eprints.lancs.ac.uk:852","identifiers":["oai:eprints.lancs.ac.uk:852","10.3182\/20060829-3-NL-2908.00006"],"title":"An unscented Kalman filter for freeway traffic estimation","authors":["Mihaylova, L.","Boel, R.","Hegiy, A."],"enrichments":{"references":[{"id":16343348,"title":"A compositional stochastic model for real-time freeway tra\u00b1c simulation.","authors":[],"date":"2006","doi":"10.1016\/j.trb.2005.05.001","raw":"Boel, R. and L. Mihaylova (2006). A compositional stochastic model for real-time freeway tra\u00b1c simulation. Transportation Research B 40(4), 319{334.","cites":null},{"id":16343351,"title":"Mixture Kalman \u00aflters.","authors":[],"date":"2000","doi":null,"raw":"Chen, R. and J. Liu (2000). Mixture Kalman \u00aflters. J. Royal Statist. Soc. B 62, 493{508.","cites":null},{"id":16343354,"title":"The cell transmission model: A dynamic representation of highway traf\u00afc consistent with the hydrodynamic theory.","authors":[],"date":"1994","doi":"10.1016\/0191-2615(94)90002-7","raw":"Daganzo, C. (1994). The cell transmission model: A dynamic representation of highway traf\u00afc consistent with the hydrodynamic theory. Transp. Res. B 28B(4), 269{287.","cites":null},{"id":16343357,"title":"Tra\u00b1c and related self-driven many-particle systems.","authors":[],"date":"2002","doi":"10.1103\/revmodphys.73.1067","raw":"Helbing, D. (2002). Tra\u00b1c and related self-driven many-particle systems. Rev. of Modern Phys. 73, 1067{1141.","cites":null},{"id":16343361,"title":"Stateof-the-art of vehicular tra\u00b1c \u00b0ow modelling.","authors":[],"date":"2001","doi":null,"raw":"Hoogendoorn, S.P. and P.H.L. Bovy (2001). Stateof-the-art of vehicular tra\u00b1c \u00b0ow modelling. J. of Systems Contr. Engineer { Proc. of the Institution of Mech. Engineers, Part I 215(14), 283{303.","cites":null},{"id":16343364,"title":"Unscented \u00afltering and nonlinear estimation.","authors":[],"date":"2004","doi":"10.1109\/jproc.2003.823141","raw":"Julier, S. and J. Uhlmann (2004). Unscented \u00afltering and nonlinear estimation. Proceedings of the IEEE 92(3), 401{422.","cites":null},{"id":16343367,"title":"A new approach for \u00afltering nonlinear systems.","authors":[],"date":"1995","doi":"10.1109\/acc.1995.529783","raw":"Julier, S., J. Uhlmann and H. Durrant-White (1995). A new approach for \u00afltering nonlinear systems. In: Proc. of the American Control Conf.. Washington, DC. pp. 1628{1632.","cites":null},{"id":16343370,"title":"Tra\u00b1c \u00b0ow modeling of large-scale motorway using the macroscopic modeling tool METANET.","authors":[],"date":"2002","doi":"10.1109\/tits.2002.806804","raw":"Kotsialos, A., M. Papageorgiou, C. Diakaki, Y. Pavlis and F. Middelham (2002). Tra\u00b1c \u00b0ow modeling of large-scale motorway using the macroscopic modeling tool METANET. IEEE Transactions on Intelligent Transportation Systems 3(4), 282{292.","cites":null},{"id":16343372,"title":"A particle \u00aflter for freeway tra\u00b1c estimation. In:","authors":[],"date":"2004","doi":"10.1109\/cdc.2004.1430359","raw":"Mihaylova, L. and R. Boel (2004). A particle \u00aflter for freeway tra\u00b1c estimation. In: Proc. 43rd IEEE Conf. on Dec. & Contr.. pp. 2106{2111.","cites":null},{"id":16343375,"title":"Macroscopic modelling of tra\u00b1c \u00b0ow on the boulevard P\u00b6 eriph\u00b6 erique in Paris.","authors":[],"date":"1989","doi":null,"raw":"Papageorgiou, M. and J.-M. Blosseville (1989). Macroscopic modelling of tra\u00b1c \u00b0ow on the boulevard P\u00b6 eriph\u00b6 erique in Paris. Transportation Research B 23B(1), 29{47.","cites":null},{"id":16343378,"title":"Highway tra\u00b1c state estimation using improved mixture Kalman \u00aflters for e\u00aeective ramp metering control. In:","authors":[],"date":"2003","doi":"10.1109\/cdc.2003.1272322","raw":"Sun, X., L. Mu~ noz and R. Horowitz (2003). Highway tra\u00b1c state estimation using improved mixture Kalman \u00aflters for e\u00aeective ramp metering control. In: Proc. 42th IEEE Conf. on Dec. and Contr.. USA. pp. 6333{6338.","cites":null},{"id":16343380,"title":"Kalman Filtering and Neural Networks.","authors":[],"date":"2001","doi":"10.1002\/0471221546.ch7","raw":"Wan, E. and R. van der Merwe (2001). Kalman Filtering and Neural Networks. Chapter 7. The Unscented Kalman Filter 7, pp. 221{280. Wiley Publishing.","cites":null},{"id":16343383,"title":"Realtime freeway tra\u00b1c state estimation based on extended Kalman \u00aflter: a general approach.","authors":[],"date":"2005","doi":"10.1016\/j.trb.2004.03.003","raw":"Wang, Y. and M. Papageorgiou (2005). Realtime freeway tra\u00b1c state estimation based on extended Kalman \u00aflter: a general approach. Transportation Research B 39B(2), 141{167.","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2006-08-29","abstract":"This paper addresses the problem of freeway tra\u00b1c flow estimation. The freeway is considered as a network of components representing different freeway stretches called segments. The evolution of the traffic in a segment is modelled as a dynamic stochastic system, influenced by states of neighbour segments. Measurements are received only at boundaries between some segments and averaged within regular time intervals. An Unscented Kalman filter is developed and its performance is compared with a particle filter both for synthetic data and for real traffc data. The intended application is to supply traffc control systems with the estimated traffc state","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/71489.pdf","fullTextIdentifier":"http:\/\/eprints.lancs.ac.uk\/852\/1\/IFAC_symp.pdf","pdfHashValue":"fc7cda7df18d6b1f79071ed61bd3bcdadb03b223","publisher":"IFAC","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lancs.ac.uk:852<\/identifier><datestamp>\n      2018-01-24T02:11:27Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D51:5141:51413735<\/setSpec><setSpec>\n      74797065733D626F6F6B5F73656374696F6E<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        An unscented Kalman filter for freeway traffic estimation<\/dc:title><dc:creator>\n        Mihaylova, L.<\/dc:creator><dc:creator>\n        Boel, R.<\/dc:creator><dc:creator>\n        Hegiy, A.<\/dc:creator><dc:subject>\n        QA75 Electronic computers. Computer science<\/dc:subject><dc:description>\n        This paper addresses the problem of freeway tra\u00b1c flow estimation. The freeway is considered as a network of components representing different freeway stretches called segments. The evolution of the traffic in a segment is modelled as a dynamic stochastic system, influenced by states of neighbour segments. Measurements are received only at boundaries between some segments and averaged within regular time intervals. An Unscented Kalman filter is developed and its performance is compared with a particle filter both for synthetic data and for real traffc data. The intended application is to supply traffc control systems with the estimated traffc state.<\/dc:description><dc:publisher>\n        IFAC<\/dc:publisher><dc:date>\n        2006-08-29<\/dc:date><dc:type>\n        Contribution in Book\/Report\/Proceedings<\/dc:type><dc:type>\n        NonPeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/eprints.lancs.ac.uk\/852\/1\/IFAC_symp.pdf<\/dc:identifier><dc:relation>\n        http:\/\/dx.doi.org\/10.3182\/20060829-3-NL-2908.00006<\/dc:relation><dc:identifier>\n        Mihaylova, L. and Boel, R. and Hegiy, A. (2006) An unscented Kalman filter for freeway traffic estimation. In: Proceedings of the 11th IFAC Symposium on Control in Transportation Systems. IFAC, pp. 31-36.<\/dc:identifier><dc:relation>\n        http:\/\/eprints.lancs.ac.uk\/852\/<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/dx.doi.org\/10.3182\/20060829-3-NL-2908.00006","http:\/\/eprints.lancs.ac.uk\/852\/"],"year":2006,"topics":["QA75 Electronic computers. Computer science"],"subject":["Contribution in Book\/Report\/Proceedings","NonPeerReviewed"],"fullText":"AN UNSCENTED KALMAN FILTER FOR\nFREEWAY TRAFFIC ESTIMATION\nL. Mihaylova \u2217, R. Boel \u2217\u2217 and A. Hegyi \u2217\u2217\u2217\n\u2217 Lancaster University, UK, mila.mihaylova@ieee.org\n\u2217\u2217University of Ghent, Belgium, rene.boel@ugent.be\n\u2217\u2217\u2217Delft University of Technology, the Netherlands,\na.hegyi@dcsc.tudelft.nl\nAbstract: This paper addresses the problem of freeway traffic flow estimation. The\nfreeway is considered as a network of components representing different freeway\nstretches called segments. The evolution of the traffic in a segment is modelled\nas a dynamic stochastic system, influenced by states of neighbour segments.\nMeasurements are received only at boundaries between some segments and\naveraged within regular time intervals. An Unscented Kalman filter is developed\nand its performance is compared with a particle filter both for synthetic data and\nfor real traffic data. The intended application is to supply traffic control systems\nwith the estimated traffic state. Copyright c\u00a92006 IFAC\nKeywords: macroscopic traffic models, unscented Kalman filter, particle filter\n1. INTRODUCTION\nDynamic traffic control offers possibilities to avoid\ntraffic jams on freeways by making better use of\nthe available infrastructure. These control systems\nrely on measures such as ramp metering, dynamic\nspeed limits and route guidance. The choice for\nthe control actions is based on the current traffic\nstate. However, the traffic state is typically un-\navailable everywhere and always on the traffic net-\nwork, because of malfunctioning of sensors (mag-\nnetic loops or cameras) or because the sensors are\nsparsely installed. Further problems are that the\nmeasurements are corrupted by noise and that the\ncontrol systems may need information about the\ntraffic state that is not directly measured (e.g.,\ndensity is generally not measured). In this paper\nthese problems are tackled by using an Unscented\nKalman Filter (UKF) which combines the knowl-\nedge about the traffic behaviour (i.e., a model)\nand the measurements.\nThe highly nonlinear behaviour of traffic can be\ndescribed by macroscopic models (Hoogendoorn\nand Bovy 2001, Papageorgiou and Blosseville\n1989, Helbing 2002) that are suitable for real-time\nproblems in view of the fact that they represent\nthe average traffic behaviour through aggregated\nvariables (flow, density and speed at different loca-\ntions). Most papers dealing with recursive traffic\nstate estimation apply the Extended Kalman filter\n(EKF) to such macroscopic models. For example,\n(Wang and Papageorgiou 2005) propose an EKF\nto estimate the unknown parameters and states\nof a stochastic version of METANET macroscopic\nmodel (Papageorgiou and Blosseville 1989) of free-\nway traffic. These estimators have all the advan-\ntages and disadvantages of the EKF technique:\npresumably computationally cheap, but relying\non a linearisation of the state and measurement\nmodels which can cause filter divergence.\nIn (Sun et al. 2003) a solution to highway traffic\nestimation is proposed by a sequential Monte\nCarlo algorithm, the so-called mixture Kalman\nfiltering, and in (Mihaylova and Boel 2004) a\nparticle filter (PF) is developed. The mixture\nKalman filter (MKF) (Chen and Liu 2000) is\nessentially a bank of Kalman filters run with the\nMonte Carlo sampling approach. The MKF is\napplicable only to conditionally linear Gaussian\nmodels. First-order traffic models represent the\nnetwork, i.e. only the traffic density is modelled,\ndistinguishing between the free-flow mode and\ncongestion mode. The traffic mode is characterised\nin (Sun et al. 2003) by its density.\nIn contrast to (Sun et al. 2003), the traffic in\nthe present paper is described by a second-order\nmacroscopic model, and we develop an UKF that\nestimates both the density and speed. The traffic\nis described by the recently developed model (Boel\nand Mihaylova 2006) that is an extension to the\ncell-transmission model (Daganzo 1994). We com-\npare the UKF to the PF from (Mihaylova and Boel\n2004). The freeway network is modelled as a se-\nquence of segments (Fig. 1). Sensors are available\nonly at some boundaries between segments. Tech-\nnological limitations (such as limited bandwidth\nof communication channels) force one to average\nthese measurements over regular or irregular time\nintervals before they are transmitted to the centre\nwhere the measurement update is carried out.\nThe outline of the paper is as follows. Section 2\npresents the stochastic macroscopic traffic model\nand the model for real-time traffic measurements\nused in the UKF. Section 3 describes the UKF\nfor traffic estimation. The UKF performance is\nevaluated in Section 4. Conclusions and future\nresearch issues are highlighted in Section 5.\n2. FREEWAY TRAFFIC FLOW MODEL\n2.1 Compositional Macroscopic Traffic Model\nTraffic states are estimated consecutively at dis-\ncrete time instants t1, t2, . . . , tk, . . ., based on the\nincoming information transmitted by sensors to\nthe estimation algorithm. The overall state vector\nxk = (xT1,k,x\nT\n2,k, . . . ,x\nT\nn,k)\nT at time tk consists\nof local state vectors xi,k = (Ni,k, vi,k)T , where\nNi,k, [veh], is the number of vehicles counted in\nsegment i \u2208 I = {1, 2, . . . n}, and vi,k, [km\/h], is\ntheir average speed. The traffic state evolution is\ndescribed by the system of equations\nx1,k+1 = f1(Qink , v\nin\nk ,x1,k,x2,k,\u03b71,k), (1)\nxi,k+1 = fi(xi\u22121,k,xi,k,xi+1,k,\u03b7i,k), (2)\nxn,k+1 = fn(xn\u22121,k,xn,k, Qoutk , v\nout\nk ,\u03b7n,k), (3)\nwhere fi is specified by the traffic model, Qink is\nthe number of vehicles entering segment 1 dur-\ning the interval \u2206tk = tk+1 \u2212 tk with average\nspeed vink , Q\nout\nk is the outflow leaving a \u2018fictitious\u2019\nsegment n + 1, with an average speed voutk . \u03b7k is\na Gaussian disturbance vector, reflecting random\nfluctuations and the effect of modelling errors in\nthe state evolution. Note that Qink , v\nin\nk , and Q\nout\nk ,\n \n \n \n \n \n \nLi,k \nSegment i \nNi,k, vi,k Ni-1,k, vi-1,k Ni+1,k, vi+1,k \nQi-1,k Qi,k \nSensor measurements in tk \u2261 ts \n1 2 i-1 i i+1 n-1 n \nQk in, vk in Qk out, vk out \nn+1 \nz1,s zj,s zm,s \nFig. 1. Freeway segments and measurement\npoints. Qi is the number of vehicles leaving\nsegment i, Ni and vi are the average number\nof vehicles and speed in segment i.\nvoutk are respectively, inflow and outflow boundary\nvariables. They are not traffic states and are not\nestimated. They are supplied by the traffic detec-\ntors. A chain of interconnected segments is con-\nsidered, together with their boundary conditions.\nIn this paper the general state-space description\n(1)-(3) takes a particular form of the recently\ndeveloped compositional stochastic macroscopic\ntraffic model (Boel and Mihaylova 2006). This\nspeed-extended cell-transmission model describes\nthe complex traffic behaviour with forward and\nbackward propagation of traffic perturbations and\nis suitable for large networks and for distributed\nprocessing. The forward and backward traffic\nperturbations were characterised by (Daganzo\n1994) through deterministic sending and receiving\nfunctions where piecewise affine representations\nare used. In (Boel and Mihaylova 2006) speed-\ndependent random sending and receiving func-\ntions are introduced that represent also the evo-\nlution of the average speed in each segment. The\nmodel is given in concise form as Algorithm 1.\nThe sending function Si,k for segment i, having\nlength Li, is calculated by (4). Si,k represents the\nvehicles that \u201cintend to leave\u201d segment i within\n\u2206tk. The receiving function Ri,k (6) expresses the\nmaximum number of vehicles that are allowed to\nenter segment i+1. In (6) Nmaxi+1,k characterises the\nmaximum number of vehicles that can simultane-\nously be present in segment i + 1 at sample time\ntk. N\nmax\ni+1,k depends on the available space, Li+1\ntime the number of lanes `i+1,k, in segment i+1,\non the average length A` of vehicles, the average\nspeed vi+1,k and the time distance td between two\nvehicles (in order to allow safe driving).\nThe evolution of Ni,k+1 is governed by the prin-\nciple of conservation of vehicles (9). The traffic\ndensity \u03c1i,k+1, [veh\/km\/lane], is given by (9). The\nanticipated density \u03c1antici,k+1 is then obtained as a\nweighed average between the density of segment i\nand segment i + 1, (11). This corresponds to the\ndrivers\u2019 tendency usually to look ahead when they\nchange their speed. The average vehicle speed\nvi,k+1 is a function of the \u2018intermediate\u2019 speed\nvintermi,k+1 , calculated in step 5 of Algorithm 1, and\nof the equilibrium speed satisfying a speed-density\nrelation ve(\u03c1antici,k+1) (Kotsialos et al. 2002).\nDesign traffic parameters are: the free-flow speed\nvfree, the critical density \u03c1crit (density below\nwhich the interactions between vehicles will be\nnegligible), the density in jam, \u03c1jam, above which\nthe vehicles do not move, and the minimum vehi-\ncle speed vmin. Other details for the model can be\nfound in (Boel and Mihaylova 2006) where this ex-\ntended cell-transmission model has been validated\nboth against the well established METANET\nmodel (Papageorgiou and Blosseville 1989, Kot-\nsialos et al. 2002), and over real traffic data.\nAlgorithm 1. The compositional traffic model.\n1. Forward wave : for i = 1, 2, . . . , n\nSi,k= max\n(\nNi,k\nvi,k.\u2206tk\nLi\n+ \u03b7Si,k, Ni,k\nvmin.\u2206tk\nLi\n)\n(4)\nand set Qi,k = Si,k. (5)\n2. Backward wave : for i = n, n\u2212 1, . . . , 1\nRi,k = N\nmax\ni+1,k \u2212Ni+1,k +Qi+1,k, (6)\nwhere Nmaxi+1,k = (Li+1`i+1,k)\/(A` + vi+1,ktd).\nif Si,k < Ri,k, Qi,k = Si,k, (7)\nelse Qi,k = Ri,k, vi,k = Qi,kLi\/(Ni,k\u2206tk), (8)\n3. Update the number of vehicles inside\nsegments, for i = 1, 2, . . . , n\nNi,k+1 = Ni,k +Qi\u22121,k \u2212Qi,k, (9)\n4. Update the density, for i = 1, 2, . . . , n\n\u03c1i,k+1 = Ni,k+1\/(Li`i,k+1), (10)\n\u03c1antici,k+1 = \u03b1\u03c1i,k+1 + (1\u2212 \u03b1)\u03c1i+1,k+1. (11)\n5. Update of the speed, for i = 1, 2, . . . , n\nvintermi,k+1 =\n\uf8f1\uf8f4\uf8f4\uf8f4\uf8f2\uf8f4\uf8f4\uf8f4\uf8f3\nvi\u22121,kQi\u22121,k + vi,k(Ni,k \u2212Qi,k)\nNi,k+1\n,\nfor Ni,k+1 6= 0,\nvf , otherwise,\nvintermi,k+1 = max(v\ninterm\ni,k+1 , vmin),\nvi,k+1=\u03b2k+1v\ninterm\ni,k+1 + (1\u2212 \u03b2k+1)ve(\u03c1antici,k+1)+ \u03b7vi,k+1,\nwhere\n\u03b2k+1 =\n{\n\u03b2I , if |\u03c1antici+1,k+1 \u2212 \u03c1antici,k+1| \u2265 \u03c1threshold,\n\u03b2II otherwise.\n2.2 Measurement Model\nSensors (magnetic loops, video cameras, radar\ndetectors) are located at boundaries between some\nsegments. Usually, measurements are collected at\nthe entrance and at the exit of the considered road\nstretch, at the on-ramps and off-ramps, etc.\nLet us consider m sensors along the stretch.\nTraffic states are measured at discrete time in-\nstants. The overall measurement vector zs =\n(zT1,s, z\nT\n2,s, . . . , z\nT\nm,s)\nT at time ts consists of local\nmeasurement vectors zj,s = (Qj,s, vj,s)T , where\nj \u2208 J = {1, 2, . . . ,m}. Qj,s is the noisy mea-\nsurement of the number of vehicles crossing the\nboundaries between the corresponding segment\ni and segment i + 1 during the time interval\n\u2206ts = ts+1 \u2212 ts, and vj,s is the measured mean\nspeed of these vehicles. The intervals \u2206ts are\ntypically several times longer than the intervals\n\u2206tk between successive state update steps. In case\nthat \u2206ts > \u2206tk we take measurements at each\ntime step.\nConsider the measurement equation\nzs = h(xs, \u03bes), (12)\nwhere the measurement noise \u03be is a white Gaus-\nsian process, independent from the system noise\n\u03b7. If the interval \u2206ts is different from \u2206tk with\nq steps, i.e. \u2206ts = q\u2206tk, the vehicles crossing the\nboundaries have to correspond to the same time\ninterval as the measurements. Equation (12) takes\nfurther the form\nzj,s =\n(\nQ\u00afj,s\nv\u00afj,s\n)\n+\u03bej,s, (13)\nwhere Q\u00afj,s is the sum of the number of vehi-\ncles (calculated by the state model) crossing the\nboundary between segments i and i+1 within the\ninterval \u2206ts, and v\u00afj,s is their average speed.\n3. AN UNSCENTED KALMAN FILTER FOR\nTRAFFIC FLOW ESTIMATION\nThe UKF relies on the unscented transforma-\ntion (Julier et al. 1995, Julier and Uhlmann\n2004, Wan and van der Merwe 2001), a method\nfor calculating the statistics of a random vari-\nable which undergoes a nonlinear transformation.\nConsider propagating a random variable x (with\ndimension nx) through a nonlinear transformation\ny = f(x). Assume that x has mean x\u02c6 and covari-\nance matrix P . To calculate the statistics of y, a\nmatrix X of 2.nx + 1 sigma points Xi is formed.\nThe system state update is performed based on\nthese sigma Xi points. To compute the mea-\nsurement update step, we propagate the sigma\npoints through the measurement function h and\nwe get transformed points Zi,k\/k\u22121 that form\nthe matrix Zk\/k\u22121. Similarly to the Kalman fil-\nter, the Kalman gain K, the state estimate x\u02c6\nand the corresponding covariance matrix P are\nupdated by (14)-(16). The UKF equations are\ngiven as Algorithm 2. We implemented the UKF\nusing an augmented state vector concatenating\nthe original state and the noise variables: xak =\n(xTk , \u03b7\nT\nk , \u03be\nT\nk )T (Wan and van der Merwe 2001).\nThe corresponding matrix with sigma points is\nX a = ((X x)T , (X \u03b7)T , (X \u03be)T )T . The sigma\npoints of the UKF are deterministically chosen so\nthat they exhibit certain properties, e.g. have a\ngiven mean and covariance. The UKF is formu-\nlated for Gaussian distributions of the noises.\nAlgorithm 2. The Unscented Kalman Filter.\nI. Initialise with:\nx\u02c60 = E[x0], P 0 = E[(x0 \u2212 x\u02c60)(x0 \u2212 x\u02c60)T ],x\u02c6a0 = E[xa0 ],\nP a0 = E[(x\na\n0 \u2212 x\u02c6a0)(xa0 \u2212 x\u02c6a0)T ] = diag{P 0,P \u03b7 ,P \u03be}\nFor k = 1, 2, . . . ,\nII. Calculate sigma points :\nXak\u22121 = [x\u02c6ak\u22121, x\u02c6ak\u22121+\u03b3\n\u221a\nP ak\u22121, x\u02c6\na\nk\u22121\u2212\u03b3\n\u221a\nP ak\u22121],\nwhere\n\u221a\nP ak\u22121 is a Cholesky factor, \u03b3 =\n\u221a\nnx + \u03bb,\n\u03bb = \u03b12(nx + \u03ba)\u2212 nx, 1 \u2264 \u03b1 \u2264 1e\u2212 4, \u03ba = 3\u2212 nx\nIII. Time update :\nXxk\/k\u22121 = f(Xxk\u22121,X \u03b7k\u22121),\nx\u02c6k\/k\u22121 =\n2nx\u2211\ni=0\nW\n(m)\ni Xxi,k\/k\u22121,\nP k\/k\u22121=\n2nx\u2211\ni=0\nW\n(c)\ni [Xxi,k\/k\u22121\u2212x\u02c6k\/k\u22121][Xxi,k\/k\u22121\u2212x\u02c6k\/k\u22121]T ,\nZk\/k\u22121 = h(Xxk\/k\u22121,X \u03bek\u22121),\nz\u02c6k\/k\u22121 =\n2nx\u2211\ni=0\nW\n(m)\ni Zi,k\/k\u22121,\nIV. Measurement update equations:\nP zkzk =\n2nx\u2211\ni=0\nW\n(c)\ni [Zi,k\/k\u22121\u2212z\u02c6k\/k\u22121][Zi,k\/k\u22121\u2212z\u02c6k\/k\u22121]T ,\nPxkzk =\n2nx\u2211\ni=0\nW\n(c)\ni [Xxi,k\/k\u22121\u2212x\u02c6k\/k\u22121][Zi,k\/k\u22121\u2212z\u02c6k\/k\u22121]T ,\nKk = PxkzkP\n\u22121\nzkzk\n, (14)\nx\u02c6k\/k = x\u02c6k\/k\u22121 +Kk(zk \u2212 z\u02c6k\/k\u22121), (15)\nP k\/k = P k\/k\u22121 \u2212KkP zkzkKTk , (16)\nwhere the weights are: W\n(m)\n0 = \u03bb\/(nx + \u03bb),\nW\n(c)\n0 = \u03bb\/(nx + \u03bb) + (1\u2212 \u03b12 + \u03b2),\nW\n(m)\ni =W\n(c)\ni = 1\/2(nx + \u03bb), i = 1, . . . , 2nx.\n4. UKF PERFORMANCE EVALUATION\n4.1 Investigations with Synthetic Data\nThe UKF performance is evaluated versus the\nPF developed in (Mihaylova and Boel 2004) over\nof freeway stretch of 4 [km] consisting of eight\nsegments with data, having periods of conges-\ntion. The data are generated by the compositional\nmodel (Boel and Mihaylova 2006) with indepen-\ndent measurement noises for different runs and\nwith different initial state conditions. The con-\ngestion is due to variations in the inflow Qink\nand outflow Qoutk (shown in Fig. 2) within the\nperiod 1.12 h - 1.7 h and due to the fall in the\nspeed voutk within the interval 2.4 h-2.65 h. The\nmeasurements are generated, by adding measure-\nment noises to the counted number of vehicles\nQi,k and to the speed vi,k for segments 1 and\n8. These measurements are used in the filters\nalso as inflow\/ outflow boundary conditions (for\nthe state model). The augmented state vector is\nxk = (xT1,k,x\nT\n2,k, . . . ,x\nT\n8,k)\nT , i.e. i = 1, 2, . . . , 8,\nand the measurement vector is zs = (zT1,s, z\nT\n8,s)\nT .\nThe per minute aggregated measurements are\nsupplied to the UKF and PF as would be the case\nwith real data. The state prediction is performed\nalso at each intermediate state update time step.\nThe states of all segments between two measure-\nments are estimated as one augmented state vec-\ntor. The filters\u2019 performance is evaluated by the\n1 1.5 2 2.5 3\n0\n2000\n4000\n6000\nFl\now\ns, \n[v\neh\n\/h]\nTime, [h]\n1\n2\n1 1.5 2 2.5 3\n0\n50\n100\n150\nSp\nee\nd,\n [k\nm\/\nh]\nTime, [h]\n1 2\nFig. 2. Boundary conditions: 1 - in, 2 - out\nRoot mean square errors (RMSEs) \u00b2(x\u02c6i,k) =\n[ 1r\n\u2211r\ni=1(\u03b5i,k)\nT (\u03b5i,k)]1\/2, where x\u02c6i,k, \u03b5i,k = xi,k \u2212\nx\u02c6i,k are the errors between the actual xi,k and\nestimated states over r independent Monte Carlo\nruns. Table 3 gives the parameters of the state\nmodel. The evolution of the flow and speed in time\n(for one realisation) is shown in Figs. 3 and 4. We\nsee the backward wave on the evolution of the\nspeed and flow in time. The flow-density and the\nspeed-flow diagrams have the typical bell-shaped\nforms. The filters\u2019 performance is evaluated for\nr = 100 independent Monte Carlo runs. RMSEs\nfor all the eight segments, with respect to density,\nspeed and flow, are presented in Figs. 5-6.\n1 1.5 2 2.5 3\n0\n1000\n2000\n3000\n4000\n5000\nFl\now\n, [\nve\nh\/h\n]\nTime, [h]\n1 1.5 2 2.5 3\n0\n20\n40\n60\n80\n100\n120\nSp\nee\nd,\n [k\nm\/\nh]\nTime, [h]\n \n \n8\n7\n6\n5\n1 2 3 4 5 6 7 8\nFig. 3. Diagrams based on the PF and UKF estimates\n1 1.5 2 2.5 3\n0\n1000\n2000\n3000\n4000\n5000\nFl\now\n, [\nve\nh\/h\n]\nTime, [h]\n1 1.5 2 2.5 3\n0\n20\n40\n60\n80\n100\n120\nSp\nee\nd,\n [k\nm\/\nh]\nTime, [h]\n \n \n1 2 3 4 5 6 7 8\n8\n7\n6\n5\nFig. 4. Diagrams based on the PF and UKF estimates\nWe see the influence of the backward wave on\nthese RMSEs. We observe that the RMSE values\nin segment 1 are smaller than their values in the\nintermediate segment 5 (it is also due to the fact\nthat there are no sensor data in this segment). Ac-\ncording to these results the PF estimates are more\naccurate than the UKF estimates. However, the\nPF complexity is more computationally expensive\nthan the UKF. The complexity of the PF is pro-\nportional to the the number of particles times the\ndimension of the overall state vector,M.nx, whilst\nthe complexity of the UKF is proportional to the\nnumber 2.nx + 1 of sigma points. Note that nx\nis equal to the number of segments n times the\nnumber of states 2 in a segment. We calculated\nthe ratio between the PF and UKF computational\ntime and it is: 2.8 (with M = 100 particles), 5.45\n(with M = 200), 15 (with M = 500). In general,\nthe number of necessary particles is increasing\nwith the increased number of states for reaching a\ncertain accuracy, but not very much. It is difficult\nto characterise in general the PF accuracy and\ncomplexity because they highly depend on the\nroad structure and the traffic conditions.\nTable 3. Parameters of the UKF and PF\nvfree = 120 [km\/h] , vmin = 7.4 [km\/h]\n\u03c1crit = 20.89 [veh\/km\/lane] , \u03c1jam = 180 [veh\/km]\n\u03b1 = 0.65, \u03b2k+1 =\n{\n0.25, if |\u03c1antici+1,k+1 \u2212 \u03c1i,k+1| \u2265 2,\n0.75, otherwise.\n\u2206ti = 10 [sec], td = 2 [sec] , Li = 0.5 [km], i = 1, ..., 8,\nM = 200 particles, td = 2 [sec], A`=0.01 [km], `i = 3\ncov{\u03b7Si,k}=(0.03Ni,kvi,k\u2206tk\/Li)2 [veh]2\ncov{\u03b7Qi} = 12 [veh]2, cov{\u03b7vi} = 3.52 [km\/h]2\ncov{\u03beQi} = 12 [veh]2, cov{\u03bevi} = 52 [km\/h]2\n1 2 3\n0\n5\n\u03c1 1\n1 2 3\n2\n4\n6\nv 1\nRoot Mean Square Errors\n1 2 3\n100\n200\n300\n400\n500\nq 1\n \n \n1 2 3\n0\n5\n\u03c1 2\n1 2 3\n2\n4\n6\nv 2\n1 2 3\n100\n200\n300\n400\n500\nq 2\n1 2 3\n0\n5\n\u03c1 3\n1 2 3\n2\n4\n6\nv 3\n1 2 3\n100\n200\n300\n400\n500\nq 3\n1 2 3\n0\n5\n\u03c1 4\nTime, [h]\n1 2 3\n2\n4\n6\nv 4\nTime, [h]\n1 2 3\n100\n200\n300\n400\n500\nq 4\nTime, [h]\nUKF\nPF\nFig. 5. UKF and PF RMSEs of the density (for\nall lanes) [veh\/km], speed [km\/h] and flow\n[veh\/h] of segments 1-4\n1 2 3\n0\n5\n\u03c1 5\n1 2 3\n2\n4\n6\nRoot Mean Square Errors\nv 5\n1 2 3\n100\n200\n300\n400\n500\nq 5\n \n \n1 2 3\n0\n5\n\u03c1 6\n1 2 3\n2\n4\n6\nv 6\n1 2 3\n100\n200\n300\n400\n500\nq 6\n1 2 3\n0\n5\n\u03c1 7\n1 2 3\n2\n4\n6\nv 7\n1 2 3\n100\n200\n300\n400\n500\nq 7\n1 2 3\n0\n5\n\u03c1 8\nTime, [h]\n1 2 3\n2\n4\n6\nv 8\nTime, [h]\n1 2 3\n100\n200\n300\n400\n500\nq 8\nTime, [h]\nUKF\nPF\nFig. 6. UKF and PF RMSEs of the density (for\nall lanes) [veh\/km], speed [km\/h] and flow\n[veh\/h] of segments 5-8\n \nFig. 7. Schematic representation of the segmentation of\nthe E17 case study freeway. The labels CLOF to\nCLO9 indicate the locations of the traffic measure-\nment cameras. The vertical arrows indicate the loca-\ntion of the used measurements.\n4.2 Application of the UKF to Real Traffic Data\nThe UKF and PF performance has also been\nevaluated with real data, over a stretch of E17\n(between CLOF and CLOA on Fig. 7) freeway\nbetween the cities of Ghent and Antwerp. E17 is\none of the very important Belgian freeways sub-\nject to frequent congestion. Measurement data are\navailable from video cameras installed at location\nCLOA, CLOB, CLOD, CLOE, and CLOF, includ-\ning the total number of vehicles that cross the\nsensor location during each one minute interval,\nand the average speed of these vehicles during\nthat one minute interval. We tested the PF and\nUKF using data measured from September, 2001\nfrom 6.4 [h] a.m. till 10.6 [h] a.m., which period\nincludes heavy congestion. The data are supplied\nfrom two sensors installed at CLOF and CLOA\n(Fig. 7). The link CLOF to CLOA contains an off-\nramp towards and an on-ramp from a parking lot,\nbut we assume that the flow of vehicles using this\nparking lot is negligible so that the conservation\nequation (9) remains valid in the state prediction\nstep. The parameters of the models and of the\nfilters are given in Table 4. The filters generate\nestimates of the state of each segment in a link,\nand also of the speed and density (and hence also\nof the flow) at each boundary between segments.\nFigures 8 presents flow-density diagrams plotted\nbased on the estimates. The bell-shaped diagram\nshows nicely that the estimated states indeed\nhave properties as one can expect for traffic data.\nThese estimates of the density, speed, and flow\nat the boundaries are compared with the mea-\nsured data in the intermediate segment boundary\nCLOD (Figs. 9 and 10).\nTable 4. Parameters of the UKF and PF\nvfree = 120 [km\/h], vmin = 7.4 [km\/h]\n\u03b2k+1 =\n{\n0.3, if |\u03c1antici+1,k+1 \u2212 \u03c1i,k+1| \u2265 2,\n0.7, otherwise.\nL1 = L2 = L3 = 0.6 [km], L4 = L5 = 0.5 [km]\n\u2206ti = 10 [sec], td = 1.5 [sec], A` = 0.01 [km]\n\u03c1crit = 20.89 [veh\/km\/lane], \u03c1jam = 180 [veh\/km]\nM = 100 particles, \u03b1 = 0.65\nGaussian noises \u03b7Si,k , \u03b7vi,k with covariances:\ncov{\u03b7Si,k} = (0.035Ni,kvi,k\u2206tk\/Li)2 [veh]2\ncov{\u03b7vi} = 3.52 [km\/h]2, cov{\u03b7Qi} = 12 [veh]2,\ncov{\u03bevi} = 52 [km\/h]2, cov{\u03beQi} = 12 [veh]2\n0 50 100 150 200 250\n0\n1000\n2000\n3000\n4000\n5000\n6000\nFl\now\n,  \n  [\nve\nh\/h\n]\nDensity, [veh\/km]\nEstimated with PF\n0 50 100 150 200 250\n0\n1000\n2000\n3000\n4000\n5000\n6000\nFl\now\n,  \n  [\nve\nh\/h\n]\nDensity, [veh\/km]\nEstimated with UKF\nFig. 8. Diagrams based on the PF and UKF estimated\nstates\n7 8 9 10\n0\n50\n100\n150\n200\n250\n\u03c1, \n[ve\nh\/k\nm]\n7 8 9 10\n0\n20\n40\n60\n80\n100\nv,\n [k\nm\/\nh]\n7 8 9 10\n0\n2000\n4000\n6000\nQ,\n [v\neh\n\/h]\nFig. 9. PF estimated states (solid line) versus measured\nstates in CLOD (dashed line)\n7 8 9 10\n0\n50\n100\n150\n200\n250\n\u03c1, \n[ve\nh\/k\nm]\n7 8 9 10\n0\n20\n40\n60\n80\n100\nv 3\n, \n[km\n\/h]\n7 8 9 10\n0\n2000\n4000\n6000\nQ, \n[ve\nh\/h\n]\nFig. 10. UKF estimated states (solid line) versus mea-\nsured states in CLOD (dashed line)\n5. CONCLUSIONS AND OPEN ISSUES\nThis paper presents an Unscented Kalman filter\nfor the freeway traffic flow estimation and com-\npares its performance with respect to a parti-\ncle filter. The Unscented Kalman filtering is a\npromising method for traffic flow estimation, re-\nquiring small computational costs. The UKF is\ndeveloped using traffic and observation models\nwith aggregated variables. The traffic is modelled\nby a recently developed stochastic compositional\ntraffic model with interconnected states of neigh-\nbour segments. The UKF and PF performance is\ninvestigated and validated by simulated data and\nby real traffic data from a Belgian freeway. An ad-\nvantage of the UKF compared to the PF is that it\nis less computationally expensive. Both the results\nwith simulated and real traffic data confirm that\nthe UKF provides accurate tracking performance,\nhowever, slightly less accurate than the PF. Both\nthe UKF and the PF are suitable methods for\nreal-time traffic estimation, and both are easy\nto implement because of the fact that they do\nnot require linearisation. Both the UKF and PF,\nextended with on-line mode detection logic, can\nbe used for on-line traffic control strategies, e.g.\nwithin the model predictive control framework.\nAcknowledgments. Financial support by the\nproject DWTC-CP\/40 \u201cSustainability effects of\ntraffic management\u201d, sponsored by the Belgian\ngovernment is acknowledged, and by the Belgian\nProgramme on Inter-University Poles of Attrac-\ntion initiated by the Belgian State, Prime Min-\nister\u2019s Office for Science, Technology and Cul-\nture. We also thank the \u201cVlaams Verkeerscentrum\nAntwerpen\u201d, Antwerp, Belgium for providing the\ndata used in this study.\nREFERENCES\nBoel, R. and L. Mihaylova (2006). A composi-\ntional stochastic model for real-time freeway\ntraffic simulation. Transportation Research B\n40(4), 319\u2013334.\nChen, R. and J. Liu (2000). Mixture Kalman\nfilters. J. Royal Statist. Soc. B 62, 493\u2013508.\nDaganzo, C. (1994). The cell transmission model:\nA dynamic representation of highway traf-\nfic consistent with the hydrodynamic theory.\nTransp. Res. B 28B(4), 269\u2013287.\nHelbing, D. (2002). Traffic and related self-driven\nmany-particle systems. Rev. of Modern Phys.\n73, 1067\u20131141.\nHoogendoorn, S.P. and P.H.L. Bovy (2001). State-\nof-the-art of vehicular traffic flow modelling.\nJ. of Systems Contr. Engineer \u2013 Proc. of\nthe Institution of Mech. Engineers, Part I\n215(14), 283\u2013303.\nJulier, S. and J. Uhlmann (2004). Unscented fil-\ntering and nonlinear estimation. Proceedings\nof the IEEE 92(3), 401\u2013422.\nJulier, S., J. Uhlmann and H. Durrant-White\n(1995). A new approach for filtering nonlinear\nsystems. In: Proc. of the American Control\nConf.. Washington, DC. pp. 1628\u20131632.\nKotsialos, A., M. Papageorgiou, C. Diakaki,\nY. Pavlis and F. Middelham (2002). Traffic\nflow modeling of large-scale motorway using\nthe macroscopic modeling tool METANET.\nIEEE Transactions on Intelligent Transporta-\ntion Systems 3(4), 282\u2013292.\nMihaylova, L. and R. Boel (2004). A particle filter\nfor freeway traffic estimation. In: Proc. 43rd\nIEEE Conf. on Dec. & Contr.. pp. 2106\u20132111.\nPapageorgiou, M. and J.-M. Blosseville (1989).\nMacroscopic modelling of traffic flow on the\nboulevard Pe\u00b4riphe\u00b4rique in Paris. Transporta-\ntion Research B 23B(1), 29\u201347.\nSun, X., L. Mun\u02dcoz and R. Horowitz (2003). High-\nway traffic state estimation using improved\nmixture Kalman filters for effective ramp me-\ntering control. In: Proc. 42th IEEE Conf. on\nDec. and Contr.. USA. pp. 6333\u20136338.\nWan, E. and R. van der Merwe (2001). Kalman\nFiltering and Neural Networks. Chapter 7.\nThe Unscented Kalman Filter 7, pp. 221\u2013280.\nWiley Publishing.\nWang, Y. and M. Papageorgiou (2005). Real-\ntime freeway traffic state estimation based on\nextended Kalman filter: a general approach.\nTransportation Research B 39B(2), 141\u2013167.\n"}