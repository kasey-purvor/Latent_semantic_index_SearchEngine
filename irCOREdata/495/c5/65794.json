{"doi":"10.1215\/S0012-7094-07-14011-0","coreId":"65794","oai":"oai:dro.dur.ac.uk.OAI2:4725","identifiers":["oai:dro.dur.ac.uk.OAI2:4725","10.1215\/S0012-7094-07-14011-0"],"title":"Counting maximal arithmetic subgroups.","authors":["Belolipetsky,  M.","Ellenberg,  J.","Venkatesh,  A."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2007-10-01","abstract":"We study the growth rate of the number of maximal arithmetic subgroups of bounded covolumes in a semisimple Lie group using an extension of the method developed by Borel and Prasad","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/65794.pdf","fullTextIdentifier":"http:\/\/dro.dur.ac.uk\/4725\/1\/4725.pdf","pdfHashValue":"e7152310744d93a11e9d1947822e79f1a86d29b2","publisher":"Duke University Press","rawRecordXml":"<record><header><identifier>\n  \n    \n      oai:dro.dur.ac.uk.OAI2:4725<\/identifier><datestamp>\n      2011-09-08T09:58:18Z<\/datestamp><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        Counting maximal arithmetic subgroups.<\/dc:title><dc:creator>\n        Belolipetsky,  M.<\/dc:creator><dc:creator>\n        Ellenberg,  J.<\/dc:creator><dc:creator>\n        Venkatesh,  A.<\/dc:creator><dc:description>\n        We study the growth rate of the number of maximal arithmetic subgroups of bounded covolumes in a semisimple Lie group using an extension of the method developed by Borel and Prasad.<\/dc:description><dc:subject>\n        Arithmetic groups<\/dc:subject><dc:subject>\n         Lattices<\/dc:subject><dc:subject>\n         Lie groups<\/dc:subject><dc:subject>\n         Maximal lattices<\/dc:subject><dc:subject>\n         Covolume.<\/dc:subject><dc:publisher>\n        Duke University Press<\/dc:publisher><dc:source>\n        Duke mathematical journal, 2007, Vol.140(1), pp.1-33 [Peer Reviewed Journal]<\/dc:source><dc:date>\n        2007-10-01<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:identifier>\n        dro:4725<\/dc:identifier><dc:identifier>\n        issn:0012-7094<\/dc:identifier><dc:identifier>\n        doi:10.1215\/S0012-7094-07-14011-0<\/dc:identifier><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/4725\/<\/dc:identifier><dc:identifier>\n        http:\/\/dx.doi.org\/10.1215\/S0012-7094-07-14011-0<\/dc:identifier><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/4725\/1\/4725.pdf<\/dc:identifier><dc:accessRights>\n        info:en-repo\/semantics\/openAccess<\/dc:accessRights><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["0012-7094","issn:0012-7094"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2007,"topics":["Arithmetic groups","Lattices","Lie groups","Maximal lattices","Covolume."],"subject":["Article","PeerReviewed"],"fullText":"Durham Research Online\nDeposited in DRO:\n27 August 2008\nVersion of attached file:\nPublished Version\nPeer-review status of attached file:\nPeer-reviewed\nCitation for published item:\nBelolipetsky, M. and Ellenberg, J. and Venkatesh, A. (2007) \u2019Counting maximal arithmetic subgroups.\u2019, Duke\nmathematical journal., 140 (1). pp. 1-33.\nFurther information on publisher\u2019s website:\nhttp:\/\/dx.doi.org\/10.1215\/S0012-7094-07-14011-0\nPublisher\u2019s copyright statement:\nAdditional information:\nAppendix by Ellenberg and Venkatesh.\nUse policy\nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without prior permission or charge, for\npersonal research or study, educational, or not-for-profit purposes provided that:\n\u2022 a full bibliographic reference is made to the original source\n\u2022 a link is made to the metadata record in DRO\n\u2022 the full-text is not changed in any way\nThe full-text must not be sold in any format or medium without the formal permission of the copyright holders.\nPlease consult the full DRO policy for further details.\nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom\nTel : +44 (0)191 334 3042 \u2014 Fax : +44 (0)191 334 2971\nhttp:\/\/dro.dur.ac.uk\n Use policy \n \nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without \nprior permission or charge, for personal research or study, educational, or not-for-profit purposes \nprovided that : \n \n\u0083 a full bibliographic reference is made to the original source \n\u0083 a link is made to the metadata record in DRO \n\u0083 the full-text is not changed in any way \n \nThe full-text must not be sold in any format or medium without the formal permission of the copyright \nholders.  \n \nPlease consult the full DRO policy for further details. \n \nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom \nTel : +44 (0)191 334 2975 | Fax : +44 (0)191 334 2971 \nhttp:\/\/dro.dur.ac.uk \nDurham Research Online \n Deposited in DRO:\n27 August 2008\nVersion of attached file:\nPublished\nPeer-review status of attached file:\nPeer-reviewed\nCitation for published item:\nBelolipetsky, M. and Ellenberg, J. and Venkatesh, A. (2007) 'Counting maximal arithmetic\nsubgroups.', Duke mathematical journal., 140 (1), pp.\u00001-33.\nFurther information on publisher\u0000s website:\nhttp:\/\/dx.doi.org\/10.1215\/S0012-7094-07-14011-0\nCOUNTING MAXIMAL ARITHMETIC SUBGROUPS\nMIKHAIL BELOLIPETSKY\nAppendix by JORDAN ELLENBERG and AKSHAY VENKATESH\nAbstract\nWe study the growth rate of the number of maximal arithmetic subgroups of bounded\ncovolumes in a semisimple Lie group using an extension of the method developed by\nBorel and Prasad.\n1. Introduction\nA classical theorem of Wang [W] states that a simple Lie group not locally isomor-\nphic to SL2(R) or SL2(C) contains only finitely many conjugacy classes of discrete\nsubgroups of bounded covolumes. This theorem, which describes the distribution of\nlattices in the higher-rank Lie groups, also brings attention to the quantitative side of\nthe distribution picture. To date, several attempts have been made toward a quantitative\nanalogue of Wang\u2019s theorem, but with inconclusive results.\nThe problem of determining the number of discrete subgroups of bounded co-\nvolumes naturally splits into two parts: the first part is to count maximal lattices, and\nthe second is to count subgroups of bounded index in a given lattice. A recent project\ninitiated by Lubotzky [Lu] resulted in significant progress toward understanding the\nsubgroup growth of lattices and also allowed general conjectures to be formulated\non the asymptotic of the number of lattices of bounded covolumes in semisimple Lie\ngroups (see [BGLM], [GLP], [LN], [LS]). In this article, we consider another aspect\nof the problem: counting maximal lattices in a given semisimple Lie group.\nLet H be a product of groups Hs(ks), s \u2208 S, where S is a finite set, each ks is an\narchimedean local field (i.e., ks = R or C), and Hs(ks) is an absolutely almost simple\nks-group. Then H is a semisimple Lie group. Throughout this article, we consider\nonly semisimple Lie groups of this form. We assume, moreover, that H is connected\nand that none of the factors Hs(ks) is compact or has type A1. In particular, H can be\na noncompact simple Lie group (real or complex) not locally isomorphic to SL2(R)\nor SL2(C).\nLet muH (x) and mnuH (x) denote the number of conjugacy classes of maximal\ncocompact irreducible arithmetic subgroups and the number of conjugacy classes of\nDUKE MATHEMATICAL JOURNAL\nVol. 140, No. 1, c\u00a9 2007\nReceived 6 January 2006. Revision received 14 March 2007.\n2000 Mathematics Subject Classification. Primary 22E40; Secondary 20G30, 20E07.\nBelolipetsky\u2019s work supported in part by a Hebrew University of Jerusalem Golda Meir Postdoctoral Fellowship.\n1\n2 MIKHAIL BELOLIPETSKY\nmaximal non-cocompact irreducible arithmetic subgroups in H of covolume less than\nx, respectively. If the real rank of H is greater than 1, then by Margulis\u2019s theorem\n[M, Th. 1, p. 2], these numbers are equal to the numbers of the conjugacy classes\nof maximal uniform and nonuniform irreducible lattices in H of covolume less than\nx. In the real rank 1 case, there may also exist nonarithmetic lattices that we do not\nconsider here.\nTHEOREM 1\n(A) If H contains an irreducible cocompact arithmetic subgroup (or, equivalently,\nif H is isotypic), then there exist effectively computable positive constants A\nand B that depend only on the type of almost simple factors of H such that for\nsufficiently large x,\nxA \u2264 muH (x) \u2264 xB\u03b2(x),\nwhere \u03b2(x) is a function that we define for an arbitrary \u0002 > 0 as \u03b2(x) =\nC(log x)\u0002 , C = C(\u0002) being a constant that depends only on \u0002.\n(B) If H contains a non-cocompact irreducible arithmetic subgroup, then there\nexist effectively computable positive constants A\u2032, which depend only on the\ntype of almost simple factors of H , and B \u2032, which depends on H , such that for\nsufficiently large x,\nxA\n\u2032 \u2264 mnuH (x) \u2264 xB\n\u2032\n.\nConjecturally, the function \u03b2(x) in part (A) can also be replaced by a constant; the\nconstant B \u2032 in part (B) depends only on the type of almost simple factors of H .\nThis would require, in particular, a polynomial bound on the number of fields with a\nbounded discriminant. The existence of such a bound is an old conjecture in number\ntheory which may derive from Linnik; it appears in a stronger form in Cohen\u2019s book [C,\nConj. 9.3.5]. In fact, we can show an equivalence of the conjecture \u201c\u03b2(x) = const\u201d to\nLinnik\u2019s conjecture (see Sec. 6.6) as a corollary from the proof of Theorem 1.\nTheorem 1 is motivated by the problem of distribution of lattices in semisimple\nLie groups. An application of these results (and their corollaries) to the problem is\npart of a joint work in progress with Lubotzky [BL].\nTo conclude this introduction, let us briefly outline the proof of Theorem 1.\nOur method is based on the work of Borel and Prasad [BP]. What distinguishes our\ntask from theirs is that besides proving the finiteness of the number of arithmetic\nsubgroups of bounded covolumes, we give bounds or, at least, asymptotic bounds for\nthe number. This requires certain modifications to the method on one side and some\nspecial number-theoretic results on the other. In Proposition 3.3, we improve a number-\ntheoretic result from [BP, Sec. 6], which enables us to effectively count the possible\nCOUNTING MAXIMAL ARITHMETIC SUBGROUPS 3\nfields of definition of the maximal arithmetic subgroups. The proof of this proposition\nis technical and is safely skipped in the first reading. The key ingredient for a good\nupper bound for the number of fields is an elaboration of recent work of Ellenberg\nand Venkatesh [EV], which we formulate in Proposition 3.1 and for which a proof is\ngiven in the appendix. After bounding the number of possible fields of definition k, we\ncount admissible k-forms, corresponding collections of local factors, and conjugacy\nclasses of arithmetic subgroups. Here, we use some Galois cohomology techniques,\nthe Hasse principle, and the basic number-theoretic Proposition 3.2. Altogether, these\nlead to the proof of the upper bounds in Theorem 1, which is given in Section 4. The\nlower bounds, which are easier, are established in Section 5.\n2. Preliminaries on arithmetic subgroups\nThis section presents a short account of the fundamental results of Borel and Prasad\n([BP], [P]) which are used in this article. We encourage the reader to look into the\noriginal articles cited above for a better understanding of the subject. Our modest\npurpose here is to fix the notation and to recall some formulas for future reference.\n2.1\nThroughout this article, k is a number field, Ok is its ring of integers, V = V (k)\nis the set of places (valuations) of k which is the union of V\u221e(k) archimedean and\nVf (k) nonarchimedean places, and A = Ak is the ring of ade`les of k. The number\nof archimedean places of k is denoted by a(k) = #V\u221e(k). Let r1(k), r2(k) denote the\nnumber of real and complex places of k, respectively, so a(k) = r1(k) + r2(k). As\nusual, Dk and hk stay for the absolute value of the discriminant of k\/Q and the class\nnumber of k. For a finite extension l of k, Dl\/k denotes the Q-norm of the relative\ndiscriminant of l over k.\nAll logarithms in this article are in base 2, unless stated otherwise.\n2.2\nLet G\/k be an algebraic group defined over a number field k so that there exists a\ncontinuous surjective homomorphism \u03c6 : G(k \u2297Q R)o \u2192 H with a compact kernel.\nWe call such fields k, and we call k-groups G admissible. If S \u2282 V\u221e(k) is the set of\narchimedean places of k over which G is isotropic (i.e., noncompact), then \u03c6 induces\nan epimorphism GS =\n\u220f\nv\u2208S G(kv)o \u2192 H whose kernel is a finite subgroup of GS .\nWe consider G as a k-subgroup of GL(n) for large enough n. We define a subgroup\n\u0004 of G(k) to be arithmetic if it is commensurable with the subgroup of k-integral points\nG(k) \u2229 GL(n,Ok); that is, the intersection \u0004 \u2229 GL(n,Ok) is of finite index in both\n\u0004 and G(k) \u2229 GL(n,Ok). The subgroups of H which are commensurable with \u03c6(\u0004)\nfor some admissible G\/k are called arithmetic subgroups of H defined over the\nfield k.\n4 MIKHAIL BELOLIPETSKY\nWe restrict ourselves to the irreducible lattices, which implies that in the definition\nof the arithmetic subgroups, it is enough to consider only simply connected, absolutely\nalmost simple algebraic groups G (see [M, Chap. 9.1]).\n2.3\nA semisimple Lie group contains irreducible lattices if and only if all its almost\nsimple factors have the same type (H is isotypic). For example, we can take H =\nSL(2,R)a \u00d7 SL(2,C)b or H = SO(p1, q1) \u00d7 SO(p2, q2) (p1 + q1 = p2 + q2), but in\nH = SL(2,R) \u00d7 SL(3,R), all lattices are reducible. Sufficiency of this condition is\nprovided by the Borel-Harder theorem [BH], and its necessity is discussed elsewhere\n(e.g., in [M, Chap. 9.4]). Note that, in general, the assumption that H is isotypic does\nnot imply that H contains nonuniform irreducible lattices, as is shown in an example\nsuggested by Prasad (see [Wi, Prop. 12.31]). This is the reason why we impose an\nadditional assumption concerning the existence of nonuniform irreducible lattices in\nTheorem 1(B).\n2.4\nThe methods of Borel and Prasad depend to a considerable degree on the Bruhat-Tits\ntheory of reductive groups over local fields. We assume familiarity with the theory\nand recall only some basic definitions. An extensive account of what we need can be\nfound in Tits\u2019s survey article [T].\nLet K be a nonarchimedean local field of characteristic zero (a finite extension of\nthe p-adic field Qp), and let G be an absolutely almost simple, simply connected K-\ngroup. The Bruhat-Tits theory associates to G\/K a simplicial complexB = B(G\/K)\non which G(K) acts by simplicial automorphisms that are special. (This implies, in\nparticular, that if an element of G(K) leaves a simplex of B stable, then it fixes the\nsimplex pointwise.) The complexB is called the affine building of G\/K . A parahoric\nsubgroup P of G(K) is defined as a stabiliser of a simplex of B. Every parahoric\nsubgroup is compact and open in G(K) in the p-adic topology. Minimal parahoric\nsubgroups, called Iwahori, are defined as subgroups of G(K) fixing chambers (i.e.,\nmaximal simplexes) in B. All Iwahori subgroups are conjugate in G(K). Maximal\nparahoric subgroups are the maximal compact subgroups of G(K); they are charac-\nterised by the property of being stabilisers of the vertices of B. A maximal parahoric\nsubgroup is called special if it fixes a special vertex ofB. A vertex x \u2208 B is special if\nthe affine Weyl group W of G(K) is a semidirect product of the translation subgroup\nby the isotropy group Wx of x in W . In this case, Wx is canonically isomorphic to\nthe (finite) Weyl group of the K-root system of G. If G is quasi-split over K and\nsplits over an unramified extension of K , then G(K) contains hyperspecial parahoric\nsubgroups. (We refer to [T, Sec. 1.10] for the definition of hyperspecial parahorics.)\nCOUNTING MAXIMAL ARITHMETIC SUBGROUPS 5\nAn important property of these subgroups is that they have maximal volumes among\nall parahoric subgroups (see [T, Sec. 3.8.2]).\n2.5\nWe now define a Haar measure \u00b5 on H with respect to which the volumes of arith-\nmetic quotients are computed. Of course, the final result then holds for any other\nnormalization of the Haar measure on H . The definition and most of the subsequent\nfacts come from [P] and [BP].\nLet G be an admissible simply connected algebraic k-group. If v \u2208 Vf (k), we let\n\u00b5v be the Haar measure on G(kv) which assigns volume 1 to the Iwahori subgroups\nof G(kv). If v is archimedean, we first consider the case where kv = R. There exists\na unique anisotropic R-form Gcpt of G which has a natural Haar measure giving the\ngroup volume 1. This measure can be transferred to G(kv) in a standard way, and we\ndefine \u00b5v as its image; it is a canonical Haar measure on G(R). In the case where\nkv = C, we have G(kv) = G1(R) with G1 = ResC\/RG, and we define \u00b5v to be equal to\nthe canonical measure on G1(R). The Haar measure \u00b5S on GS is defined as a product\nof \u00b5v , v \u2208 S. This also induces the measure \u00b5 on H , and it is easy to check that \u00b5\ndoes not depend on a choice of G and the epimorphism \u03c6 : GS \u2192 H .\n2.6\nA collection P = (Pv)v\u2208Vf of parahoric subgroups Pv of a simply connected k-\ngroup G is called coherent if\n\u220f\nv\u2208V\u221e G(kv) \u00b7\n\u220f\nv\u2208Vf Pv is an open subgroup of the\nade`le group G(Ak). A coherent collection of parahoric subgroups P = (Pv)v\u2208Vf\ndefines an arithmetic subgroup \u0005 = G(k) \u2229\u220fv\u2208Vf Pv of G(k), which is called the\nprincipal arithmetic subgroup associated toP . The corresponding arithmetic subgroup\n\u0005\u2032 = \u03c6(\u0005) \u2282 H is also called principal.\nThe covolume of a principal arithmetic subgroup with respect to the measure \u00b5\ndefined as above is given by Prasad\u2019s formula [P, Th. 3.7]:\n\u00b5(H\/\u0005\u2032) = \u00b5S(GS\/\u0005) = Ddim(G)\/2k (Dl\/D[l:k]k )s\/2\n( r\u220f\ni=1\nmi!\n(2\u03c0)mi+1\n)[k:Q]\n\u03c4k(G) E(P ),\nwhere\n(i) dim(G) and mi denote the dimension and Lie exponents of G;\n(ii) l is a Galois extension of k defined as in [P, Sec. 0.2] (if G is not a k-form\nof type 6D4, then l is the split field of the quasi-split inner k-form of G, and\nif G is of type 6D4, then l is a fixed cubic extension of k contained in the\ncorresponding split field; in all the cases, [l : k] \u2264 3);\n(iii) s = s(G) is an integer defined in [P, Sec. 0.4], and in particular, s = 0 if G is\nan inner form of a split group, while s \u2265 5 if G is an outer form;\n6 MIKHAIL BELOLIPETSKY\n(iv) \u03c4k(G) is the Tamagawa number of G over k since G is simply connected and k\nis a number field \u03c4k(G) = 1; and\n(v) E(P ) = \u220fv\u2208Vf ev is an Euler product of the local factors ev = e(Pv); for\nv \u2208 Vf , ev is the inverse of the volume of Pv with respect to the Haar measure\n\u03b3v\u03c9\n\u2217\nv defined in [P, Secs. 1.3, 2.1].\nThe local factors can be computed using the Bruhat-Tits theory. (In particular,\nev > 1 for every v \u2208 Vf ; see [P, Prop. 2.10(iv)].)\n2.7\nAny maximal arithmetic subgroup \u0004 of H can be obtained as a normaliser in H of\nthe image \u0005\u2032 of some principal arithmetic subgroup of G(k) (see [BP, Prop. 1.4(iv)]).\nMoreover, the collections of parahoric subgroups which are associated to the maximal\narithmetic subgroups have maximal types as shown in Rohlfs [R] (see also [RC]). So,\nin order to compute the covolume of a maximal arithmetic subgroup, we need to be\nable to compute the index of a principal arithmetic subgroup in its normaliser. In a\ngeneral setting, the upper bound for the index was obtained in [BP, Sec. 2]:\n[\u0004 : \u0005\u2032] \u2264 n\u0002#S \u00b7 #H1(k,C)\u03be \u00b7\n\u220f\nv\u2208Vf\n#\u000b\fv .\nHere, n and \u0002 are constants defined below, so n\u0002#S depends only on H and does not\ndepend on the choice of G(k) and \u0005. The group H1(k,C)\u03be is a finite subgroup of the\nfirst Galois cohomology group of k with coefficients in the center of G, as is defined\nin [BP, Sec. 2.10]. The order of H1(k,C)\u03be can be further estimated (see [BP, Sec. 5]);\nthe following bound is a combination of [BP, Props. 5.1, 5.6]:\n#H1(k,C)\u03be \u2264 2h\u0002\u2032l n\u0002a(k)+\u0002\n\u2032a(l)+\u0002#T (Dl\/D[l:k]k )\u0002\u2032\u2032,\nwhere\n(i) n = r + 1 if G is of type Ar ; n = 2 if G is of type Br , Cr (r arbitrary), Dr\n(with r even), or E7; n = 3 if G is of type E6; n = 4 if G is of type Dr (with r\nodd); n = 1 if G is of type E8, F4 or G2;\n(ii) \u0002 = 2 if G is of type Dr (with r even), and \u0002 = 1 otherwise (so the center\nC = C(G) is isomorphic to (Z\/nZ)\u0002 and #C = n\u0002);\n(iii) \u0002 \u2032 = \u0002 if G is an inner form of a k-split group, and \u0002 \u2032 = 1 otherwise;\n(iv) \u0002 \u2032\u2032 = 1 if G\/k is an outer form of type Dr (r even), and \u0002 = 0 otherwise; and\n(v) T is the set of places v \u2208 Vf for which G splits over an unramified extension\nof kv but is not quasi-split over kv .\nFinally, \u000b\fv is a subgroup of the automorphism group of the affine Dynkin diagram\nwhich comes from the adjoint group and preserves the type \fv of Pv . In particular,\n#\u000b\fv \u2264 r + 1, and #\u000b\fv = 1 if Pv is special.\nCOUNTING MAXIMAL ARITHMETIC SUBGROUPS 7\n2.8\nAs a result, we have the following lower bound for the covolume of \u0004:\n\u00b5(H\/\u0004) \u2265 (2n\u0002a(k)+\u0002\u2032a(l)h\u0002\u2032l )\u22121Ddim(G)\/2k\n( Dl\nD[l:k]k\n)s \u2032( r\u220f\ni=1\nmi!\n(2\u03c0)mi+1\n)[k:Q]\n\u03c4k(G)F,\nwhere\n(i) s \u2032 = s\/2\u22121 if G\/k is an outer form of type Dr , r even, but s \u2032 = s\/2 otherwise;\nand\n(ii) F = \u220fv\u2208Vf fv with fv = ev(#\u000b\fv )\u22121 = ev if G is quasi-split over kv and\nPv is hyperspecial (which is true for almost all v), fv = evn\u2212\u0002(#\u000b\fv )\u22121 if\nG splits over an unramified extension of kv but is not quasi-split over kv , and\nfv = ev(#\u000b\fv )\u22121 in the rest of the cases.\nUsing the computations in [BP, Apps. A, C], it is not hard to check that fv > 1\nfor every v \u2208 Vf .\nMore details about this formula can be found in [BP, Secs. 5, 7].\n3. Number-theoretic results\n3.1\nLet Nk,d(x) be the number of k-isomorphism classes of extensions l of k such that\n[l : k] = d , Dl\/k < x, and let N(x) be the number of isomorphism classes of number\nfields with discriminant less than x.\nPROPOSITION\nFor large enough positive x, we have the following:\n(i) given a number field k and a fixed degree d , there exist constants c, b1, b2 > 0,\ndepending only on d , such that Nk,d(x) \u2264 cDb1k xb2 ; and\n(ii) for every \u0002 > 0, there exists a constant C = C(\u0002) > 0 such that\nN(x) \u2264 x\u03b2(x), \u03b2(x) = C(log x)\u0002 .\nProof\nEffectively, the proof\n(i) follows, for example, from [EV, Th. 1.1]; and\n(ii) it follows from the general method used in [EV] but requires some extra work,\nnamely, that we have to know how the implicit constants in [EV, Th. 1.1]\ndepend on the degree of the extensions in order to be sure that this does not\nchange the expected upper bound; this is carried out in detail in the attached\nappendix provided by Ellenberg and Venkatesh. \u0001\n3.2\nLet Qk(x) be the number of squarefree ideals of k of norm at most x.\n8 MIKHAIL BELOLIPETSKY\nPROPOSITION\nFor a number field k, we have\n(i) Qk(x) = (Ress=1(\u03b6k)\/\u03b6k(2)) x + o(x) for x \u2192 \u221e; and\n(ii) there exist absolute constants b3, b4 (not depending on k) such that\nQk(x) \u2264 Db3k xb4 .\nProof\nOf the two items in the preceding proposition, we have the following.\n(i) The proof is a known fact from analytic number theory. For a short and con-\nceptual proof, we refer to [Se, Th. 14].\n(ii) As far as we do not claim that b4 = 1, the proof is easy. Consider the Dedekind\nzeta function of k:\n\u03b6k(s) =\n\u221e\u2211\nn=1\nan\nns\n,\nwhere an is the number of ideals of k of norm n, s > 1.\nLet Ik(x) denote the number of ideals of k of norm less than x. We have\nIk(x) = a1 + a2 + \u00b7 \u00b7 \u00b7 + a[x],\n\u03b6k(s) \u00b7 xs \u2265 Ik(x).\nTaking s = 2, we obtain\nQk(x) \u2264 Ik(x) \u2264 \u03b6k(2) \u00b7 x2 \u2264\n(\u03c02\n6\n)[k:Q]\nx2 \u2264 clogDk1 x2 = Db3k xb4 .\nHere, we used inequalities \u03b6k(2) \u2264 \u03b6 (2)[k:Q] and for k \u000b= Q, [k : Q] \u2264 c logDk . The\nfirst inequality follows from the definition of the functions \u03b6 and \u03b6k , and the second is\na well-known corollary of Minkowski\u2019s discriminant bound. \u0001\n3.3\nFinally, we need an improved version of a number-theoretic result from [BP, Sec. 6].\nThe main idea is that instead of using Ddim(G)\/2k to absorb the small factors in the\nvolume formula, we use only part of it, saving the rest for a later occasion. This is easy\nto achieve for the groups of a large-enough absolute rank; when the rank becomes\nsmall, the estimates become much more delicate.\nLet G\/k be an absolutely almost simple, simply connected algebraic group of\nabsolute rank r \u2265 2, so that the numbers n, \u0002, \u0002 \u2032, s \u2032 and m1 \u2264 \u00b7 \u00b7 \u00b7 \u2264 mr are fixed and\nCOUNTING MAXIMAL ARITHMETIC SUBGROUPS 9\ndefined as in Section 2. Let\nB(G\/k) = Ddim(G)\/2k n\u2212\u0002a(k)\u2212\u0002\u2032a(l)h\u2212\u0002\u2032l (Dl\/D[l:k]k )s \u2032\n( r\u220f\ni=1\nmi!\n(2\u03c0)mi+1\n)[k:Q]\n.\nThen by Section 2.8, we have \u00b5(H\/\u0004) \u2265 (1\/2)B(G\/k)\u03c4k(G)F \u2265 (1\/2)B(G\/k) for\nevery arithmetic subgroup \u0004 of H which is associated to G\/k.\nPROPOSITION\nThere exist positive constants \u03b41, \u03b42 depending only on the absolute type of G such\nthat B(G\/k) \u2265 D\u03b41k D\u03b42l\/k for almost all number fields k.\nProof\nGiven an absolutely almost simple, simply connected algebraic group G of an absolute\ntype T and rank r , we show that for almost all k,\n(i) B(G\/k) \u2265 D dim(G)\/2\u22122k Dl\/k if r \u2265 30;\n(ii) B(G\/k) \u2265 DkDl\/k if r < 30 and T is not A2, A3, B2;\n(iii) B(G\/k) \u2265 D 0.1k Dl\/k if T is A3 or B2;\n(iv) B(G\/k) \u2265 D 0.01k D0.5l\/k if T is A2.\nClearly, these four inequalities all together imply the proposition.\nFirst, assume that G is not a k-form of type 6D4. We have\n[l : k] \u2264 2,\nn\u2212\u0002a(k)\u2212\u0002\n\u2032a(l) \u2265 n\u2212\u0002(a(k)+a(l)) \u2265 (r + 1)\u22123[k:Q].\nIt is known that\nhl \u2264 102\n( \u03c0\n12\n)[l:Q]Dl (1)\n(see [BP, proof of Prop. 6.1]; let us point out that this bound holds without any\nassumption on the degree of the field l);\nDl\/D[l:k]k = Dl\/k \u2265 1. (2)\nCombining the above inequalities, we obtain\nB(G\/k) = Ddim(G)\/2k n\u2212\u0002a(k)\u2212\u0002\u2032a(l)h\u2212\u0002\u2032l (Dl\/D[l:k]k )s \u2032\n( r\u220f\ni=1\nmi!\n(2\u03c0)mi+1\n)[k:Q]\n\u2265 10\u22122\u0002\u2032Ddim(G)\/2\u22122k\n( \u03c0\n12\n)\u2212\u0002\u2032[l:Q]Dl\/k\n( 1\n(r + 1)3\nr\u220f\ni=1\nmi!\n(2\u03c0)mi+1\n)[k:Q]\n\u2265 10\u22122\u0002\u2032Ddim(G)\/2\u22122k Dl\/k\n( 1\n(\u03c0\/12)(r + 1)3\nr\u220f\ni=1\nmi!\n(2\u03c0)mi+1\n)[k:Q]\n.\n10 MIKHAIL BELOLIPETSKY\n(If G is k-split, then s \u2032 = 0, l = k, Dl\/k = 1; in the nonsplit case, we use the fact that\ns \u2032 > 2.)\nSince for i large enough, mi! \f (2\u03c0)mi+1, it is clear that for large enough r ,\n1\n(\u03c0\/12)(r + 1)3\nr\u220f\ni=1\nmi!\n(2\u03c0)mi+1 > 1.\nAn easy, direct computation shows that starting from r = 30,\n10\u22122\u0002\u2032Ddim(G)\/2\u22122k Dl\/k\n( 1\n(\u03c0\/12)(r + 1)3\nr\u220f\ni=1\nmi!\n(2\u03c0)mi+1\n)[k:Q]\n\u2265 Ddim(G)\/2\u22122k Dl\/k.\nSo, for r \u2265 30, \u03b4 = dim(G)\/2 \u2212 2, and any field k, we have B(G\/k) \u2265 D\u03b4kDl\/k , the\nfinite set of the exceptional fields is empty, and case (i) is proved.\nTo proceed with the argument, let us remark that\nB(G\/k) \u2265 D dim(G)\/2\u22122k Dl\/kc,\nwhere c > 0 depends only on the absolute type of G and degree d = [k : Q]. So, if\nthe degree d is fixed, then for any z > 0 that is chosen later, we have\nB(G\/k) \u2265 D dim(G)\/2\u22122\u2212zk Dl\/kDzkc \u2265 D dim(G)\/2\u22122\u2212zk Dl\/k (3)\nfor all k with Dk \u2265 c\u2212z. Since there are only finitely many number fields with a\nbounded discriminant, (3) holds for all but finitely many k of degree d . Since we\nalways have dim(G)\/2 > 2, this allows us to assume (at least when G is not 6D4) that\nthe degree of k is large enough.\nWe now come to case (ii). Let G be not of type 6D4. By the previous remark, we\ncan suppose that [k : Q] is large enough. Due to Odlyzko [O, Th. 1], we have the\nfollowing lower bound for Dk:\nif [k : Q] > 105, then Dk \u2265 55r1(k)212r2(k). (4)\nSo, for [k : Q] > 105,\nB(G\/k) \u2265 10\u22122\u0002\u2032\n( 21dim(G)\/2\u22122\u2212\u03b4\n(\u03c0\/12)(r + 1)3\nr\u220f\ni=1\nmi!\n(2\u03c0)mi+1\n)[k:Q]D\u03b4kDl\/k.\nA direct case-by-case verification shows that for \u03b4 = 1, the latter expression is at least\nD\u03b4kDl\/k . So, if we put z = dim(G)\/2 \u2212 3 in (3), then we obtain that for all but finitely\nmany k, B(G\/k) \u2265 DkDl\/k .\nCOUNTING MAXIMAL ARITHMETIC SUBGROUPS 11\nLet now G\/k be a triality form of type 6D4. We have\n\u0002 = 2, \u0002 \u2032 = 1, n = 2, s \u2032 = 2.5, {mi} = {1, 3, 5, 3},\n[l : k] = 3, and a(l) \u2264 3[k : Q].\nSo, if [k : Q] > 105,\nB(G\/k) \u2265 10\u22122\n( 2114\u22123\u2212\u03b4\n(\u03c0\/12) \u00b7 23 \u00b7\n6 \u00b7 120 \u00b7 6\n(2\u03c0)16\n)[k:Q]D \u03b4kDl\/k.\nFor \u03b4 = 1, it is \u2265 DkDl\/k . If [k : Q] \u2264 105, we still have the inequality (3) (the\nprecise formula for the constant c would be different, but it is not essential), so that,\nfor all but finitely many k, again B(G\/k) \u2265 DkDl\/k . The case (ii) is now settled\ncompletely.\nLet G\/k be of type A3 or B2. As before, we can assume [k : Q] > 105. We have\nB(G\/k) \u2265 10\u22122\n( \u03c0\n12\n)\u2212[l:Q](21dim(G)\/2\u2212[l:k]\u2212\u03b4\nn1+[l:k]\nr\u220f\ni=1\nmi!\n(2\u03c0)mi+1\n)[k:Q]D \u03b4kDl\/k.\nNow, n = 4 and n = 2 for the types A3 and B2, respectively; if l \u000b= k, then [l : Q] =\n2[k : Q]. Using this, it is easy to check that if \u03b4 = 0.1, then B(G\/k) \u2265 D \u03b4kDl\/k in\neach of the possible cases.\nIt remains for us to consider (iv). This is the most difficult case; the proof almost\nrepeats the argument of [BP, Prop. 6.1(vi)].\nWith the notation of [BP], for [l : Q] > 105 we have\nB(G\/k) = D4k \u00b7 3\u2212a(k)\u2212a(l)h\u22121l (Dl\/D[l:k]k )5\/2\n( 1\n24\u03c05\n)[k:Q]\n= D\u03b4kD2\u2212\u03b4\/2l (Dl\/k)1\/23\u2212a(k)\u2212a(l)h\u22121l\n( 1\n24\u03c05\n)[k:Q]\n\u2265 D\u03b4k(Dl\/k)1\/2\n0.02\ns(s \u2212 1)\n( 55(4\u2212\u03b4\u2212s)\/2\n2 \u00b7 33\/2 \u00b7 \u03c0 (6\u2212s)\/2\n)r1(l)( 21(4\u2212\u03b4\u2212s)\n2(4\u2212s) \u00b7 32 \u00b7 \u03c0 (5\u2212s)\n)r2(l)\n\u00d7 exp\n(\n(3 \u2212 \u03b4 \u2212 s)Zl(s) \u2212 (4 \u2212 \u03b4 \u2212 s)\n(c1\n2\n+ (s \u2212 1)\u22121\n)\n+ (0.1 \u2212 (c3 + c4)(s \u2212 1))a(l)\n)\n.\nNow, let \u03b4 = 0.01. Since\n552.99\/2(2 \u00b7 33\/2 \u00b7 \u03c05\/2)\u22121 > 2.19, 212.99(23 \u00b7 32 \u00b7 \u03c04)\u22121 > 1.28,\nand\nexp\n((3 \u2212 \u03b4 \u2212 s)Zl(s)) \u2265 1 if s < 2 \u2212 \u03b4,\n12 MIKHAIL BELOLIPETSKY\nby choosing s > 1 sufficiently close to 1, we obtain that there is an absolute constant\nc6 such that\nD4k \u00b7 3\u2212a(k)\u2212a(l)h\u22121l (Dl\/D[l:k]k )5\/2\n( 1\n24\u03c05\n)[k:Q]\n\u2265 D0.01k (Dl\/k)1\/22.19r1(l)1.28r2(l)c6.\nThe right-hand side is at leastD0.01k (Dl\/k)1\/2 if [l : Q] is large enough, say, [l : Q] > dl\n(and dl \u2265 105).\nIf [l : Q] < dl , then [k : Q] < dl , and by (3) for all but finitely many fields k, we\nhave\nB(G\/k) \u2265 DkDl\/k \u2265 D 0.01k D 0.5l\/k . \u0001\nRemark. The proof provides explicit values of \u03b41, \u03b42 for each of the types; however,\nin many cases, the bound for B(G\/k) can be improved. This requires more careful\nargument and is useful for particular applications.\n4. Proof of Theorem 1: The upper bound\nAs before, H denotes a connected semisimple Lie group whose almost simple factors\nare all noncompact and have the same type different from A1; G is an absolutely\nalmost simple, simply connected k-group admissible in the sense that there exists a\ncontinuous surjective homomorphism G(k \u2297Q R)o \u2192 H with a compact kernel.\n4.1. Counting number fields\nFor a (maximal) arithmetic subgroup \u0004 of H , we have (see Sec. 2.8)\n\u00b5(H\/\u0004) \u2265 1\n2\nB(G\/k)\u03c4k(G)F, (5)\nwhere\n(i) k is the field of definition of \u0004,\n(ii) G\/k is a k-form from which \u0004 is induced (see Sec. 2.2),\n(iii) B(G\/k) = D dim(G)\/2k n\u2212\u0002a(k)\u2212\u0002\u2032a(l)h\u2212\u0002\u2032l (Dl\/D[l:k]k )s \u2032\n(\u220fr\ni=1 mi!\/(2\u03c0)mi+1\n)[k:Q]\n,\n(iv) \u03c4k(G) = 1, and\n(v) F = \u220fv\u2208Vf fv > 1 is considered later.\nBy Proposition 3.3, for all but finitely many number fields k,\n\u00b5(H\/\u0004) \u2265 c1D \u03b41k D \u03b42l\/k,\nwhere \u03b41, \u03b42 are the constants determined by the absolute type of G (which is the type\nof almost simple factors of H ).\nSo, for large enough x, if \u00b5S(H\/\u0004) < x, then Dk < (x\/c1)1\/\u03b41 , Dl\/k <\n(x\/c1)1\/\u03b42 .\nCOUNTING MAXIMAL ARITHMETIC SUBGROUPS 13\nBy Proposition 3.1(ii), the number of such fields k is at most\n( x\nc1\n)\u03b2((x\/c1)1\/\u03b41 ) \u2264 xc2\u03b2(x),\nand by Proposition 3.1(i), for each k the number of such extensions l is at most\ncD b1k\n( x\nc1\n)b2\/\u03b42 \u2264 c( x\nc1\n)b1\/\u03b41( x\nc1\n) b2\/\u03b42 \u2264 xc3 .\nIt follows that the number of all admissible pairs (k, l) is bounded by\nxc2\u03b2(x)+c3,\nand moreover, since k \u000b= Q implies [k : Q] \u2264 c logDk , for all admissible k we have\na(k) \u2264 c4 log x.\n4.2. Non-cocompact case\nIf \u0004 is non-cocompact, the degree of the field of definition of \u0004 is bounded. Indeed,\nthe non-cocompactness of \u0004 implies that the corresponding algebraic group G is\nk-isotropic, so G\/kv is noncompact for every v \u2208 V . It follows that the number\nof infinite places of k is equal to the number #S of almost simple factors of H , so\n[k : Q] \u2264 2#S.\nNow, in Section 4.1, we can consider only the number fields k with [k : Q] \u2264 2#S\nand the number fields l with [l : Q] \u2264 3[k : Q] \u2264 6#S. By Proposition 3.1(i), for\nlarge enough x the number of admissible pairs (k, l) is at most\nxc5, c5 = c5(#S).\n(In fact, here we can use a weaker result from Schmidt [S], who showed that the\nnumber of degree n extensions l of k with Dl\/k < x is bounded by C(n, k)x(n+2)\/4.)\n4.3. Counting k-forms\nGiven an admissible pair (k, l) of number fields, there exists a unique quasi-split k-\nformG for which l is the splitting field (or a certain subfield of the splitting field ifG is\nof type 6D4 and [l : Q] = 3). So, we have an upper bound for the number of quasi-split\ngroups for which there can exist an inner form that defines an arithmetic subgroup\nof covolume less than x. We now fix a quasi-split k-form G and estimate the number\nof admissible inner forms. Since every inner equivalence class of k-forms contains a\nunique quasi-split form, this gives us a bound on the total number of admissible G\/k.\nBy the assumption,\n\u220f\nv\u2208V\u221e(k) G(kv) is isogenous to H \u00d7 K (K is a compact\nLie group), so the kv-form of G is almost fixed at the infinite places of k. More\n14 MIKHAIL BELOLIPETSKY\nprecisely, let ch be the number of nonisomorphic almost simple factors of H . For each\nv \u2208 V\u221e(k), G(kv) is isomorphic to one of ch noncompact (simply connected) groups\nor is compact. Let nh denote the number of places v at which G(kv) is noncompact.\nBy the assumption, nh = #S. This implies that the number of variants for G(kv) at the\ninfinite places of k is bounded by\nc\nnh\nh\n(\na(k)\nnh\n)\n<\n(\ncha(k)\n)nh \u2264 (log x)c6,\nwhere\n(\u00b7\n\u00b7\n)\ndenotes the binomial coefficient.\nLet now v be a finite place of k. The inner kv-forms of G correspond to the\nelements of the first Galois cohomology set H1(kv,G), where G is the adjoint group of\nG. The order of H1(kv,G) can be computed from the cohomological exact sequence\nH1(kv,G) \u2192 H1(kv,G) \u03b4\u2192 H2(kv,C),\nwhich corresponds to the universal kv-covering sequence of groups\n1 \u2192 C \u2192 G \u2192 G \u2192 1.\nFor a simply connected kv-group G, the first cohomology H1(kv,G) is trivial by\nKneser\u2019s theorem (see [K]), so \u03b4 is injective. Furthermore, the group H2(kv,C) can be\nidentified with a subgroup of the Brauer group of kv and then explicitly computed using\nresults from the local class field theory (see [PR, Chap. 6] for details and explanations).\nAs a corollary here, we have that the number of inner kv-forms is bounded by n\u0002 in\nthe notation of Section 2.7. (Recall that n\u0002 = #C is the order of the center of G.)\nLet T1 \u2282 Vf (k) be a (finite) subset of the nonarchimedean places of k such that\nG is not quasi-split over kv for v \u2208 T1. It follows from [P, Prop. 2.10] that there exists\na constant \u03b4 > 0, which depends only on the absolute type of G, such that for every\nv \u2208 T1,\nfv \u2265 n\u2212\u0002(#\u000b\fv )\u22121ev \u2265 q\u03b4v (6)\n(qv denotes the order of the residue field of k at v).\nIndeed, we can take \u03b4 = log(2rvn\u2212\u0002) if the absolute type of G is not A2 and\n\u03b4 = log(22 \u00b7 3\u22121) = 0.415 . . . for the type A2, and we can then check that \u03b4 > 0 and\ninequality (6) holds going through the case-by-case consideration in [BP, App. C.2].\nTo a set T \u2282 Vf (k), we can assign an ideal IT of Ok given by the product of\nprime ideals defining the places in T . Conversely, each squarefree ideal ofOk uniquely\ndefines a subset T in Vf (k) corresponding to its prime decomposition. Note also that\u220f\nv\u2208T qv = Norm(IT ).\nCOUNTING MAXIMAL ARITHMETIC SUBGROUPS 15\nNow, for an arithmetic subgroup \u0004 induced from G, we have\n\u00b5(H\/\u0004) = 1\n2\nB(G\/k)\u03c4k(G)F \u2265 c7\n\u220f\nv\u2208T1\nq\u03b4v .\nThis implies that if \u00b5(H\/\u0004) \u2264 x, then Norm(IT1 ) =\n\u220f\nv\u2208T1 qv \u2264 xc8 . By Proposi-\ntion 3.2(ii), the number of variants for T1 is bounded by xc9 . Moreover, since for every\nv \u2208 Vf , qv \u2265 2, for every such a set T1 we have #T1 \u2264 c10 log x.\nNow, the Hasse principle implies that a k-form of G is uniquely determined by\n(G(kv))v\u2208V (k). The Hasse principle for semisimple groups is valid due to the work of\nKneser, Harder, and Chernousov (see [PR, Chap. 6]). So, the number of the admissible\nk-forms is at most\n(log x)c6xc8n\u0002c10 log x \u2264 xc11 .\n4.4. Counting collections of parahorics\nFor a given large enough x, we have defined a collection of G\/k for which there exists\na (centrally) k-isogenous group G\u2032 that may give rise to the arithmetic subgroups\n\u0004 \u2282 H with \u00b5(H\/\u0004) < x. The number of such k-groups G is finite and can\nbe bounded as in Section 4.3, but each G\/k still defines countably many maximal\narithmetic subgroups. We now fix a group G\/k and estimate the number of coherent\ncollections of parahoric subgroups of G which can give rise to the maximal arithmetic\nsubgroups with covolumes less than x. In the classical language, what we are going\nto do in this section is count the number of admissible genera.\nWe use again the local-to-global approach. Let us fix a central k-isogeny i : G \u2192\nG\u2032 with G\u2032 so that G\u2032S projects onto H . Every maximal arithmetic subgroup \u0004 \u2282 G\u2032S\nis associated to some coherent collection P = (Pv)v\u2208Vf of parahoric subgroups of G\n(see [BP, Prop. 1.4]):\n\u0004 = NG\u2032\n(\ni(\u0005)), \u0005 = G(k) \u2229 \u220f\nv\u2208Vf (k)\nPv.\nThe image of\u0004 inH is an arithmetic subgroup, and every maximal arithmetic subgroup\nof H can be obtained as a projection of some such \u0004.\nFor almost all finite places v of k, G is quasi-split over kv and splits over an\nunramified extension of kv . Moreover, for almost all such v, Pv is hyperspecial. Any\ntwo hyperspecial parahoric subgroups of G(kv) are conjugate under the action of the\nadjoint group G(kv) (see [T, Sec. 2.5]), so P is determined up to the action of G(Af )\nby the types of Pv at the remaining places. Using this, we now count the number of\nP \u2019s.\n16 MIKHAIL BELOLIPETSKY\nAs in Section 4.3, let T1 denote the set of places of k for which G is not quasi-split.\nBy the previous argument, we have\n#T1 \u2264 c10 log x, #(variants for T1) \u2264 xc9 (see Sec. 4.3).\nLet R denote the set of places for which G is quasi-split but is not split over an\nunramified extension of kv . For such places v \u2208 Vf , lv = l \u2297k kv is a ramified\nextension of kv , and so, by the formula from [P, App.], each of such places contributes\nto Dl\/k a power of qv . Again, using Proposition 3.2(ii) and the inequality Dl\/k \u2264 xc\nfrom Section 4.1, we obtain\n#R \u2264 c12 log x, #(variants for R) \u2264 xc13 .\nFinally, let T2 \u2282 Vf \\(T1 \u222aR) be the set of places for which Pv is not hyperspecial. If\nv \u2208 T2, then by [P, Prop. 2.10(iv)],\nev \u2265 (qv + 1)\u22121qrv+1v .\nSimilarly to (6), this implies that\nfv \u2265 q\u03b4v .\nBy Proposition 3.2(ii) and the volume formula,\n#T2 \u2264 c14 log x, #(variants for T2) \u2264 xc15 .\nFor a given v \u2208 Vf , the number of the possible types of parahoric subgroups\n(parametrised by the subsets of the set of simple roots) is bounded by a constant ct that\ndepends only on the absolute type of G. We conclude that for a given G, the number\nof P \u2019s up to the action of G(Af ) is at most\nc#(T1\u222aR\u222aT2)t #(variants for T1 \u222a R \u222a T2) \u2264 c(c10+c12+c14) log xt xc9+c13+c15 = xc16 .\n4.5. Counting conjugacy classes\nIn this final step, we give an upper bound for the number of conjugacy classes of\narithmetic subgroups associated to a fixed group G\u2032\/k and a given G(Af )-orbit of\ncollections of parahoric subgroups P of a simply connected group G centrally k-\nisogenous to G\u2032. We are interested in the G(k)-conjugacy classes of maximal subgroups\nassociated to P which are indexed by the double cosets G(k)\\G(A)\/G\u221eP , where\nG\u221e =\n\u220f\nv\u2208V\u221e G(kv), P v is the stabiliser of Pv in G(kv), and P =\n\u220f\nv\u2208Vf P v is a\ncompact open subgroup of Gf =\n\u220f\nv\u2208Vf G(kv) (see [BP, Prop. 3.10]). The number\nc(P ) of the double cosets is called the class number of G with respect to P . The\nCOUNTING MAXIMAL ARITHMETIC SUBGROUPS 17\nargument is similar to [BP, proof of Prop. 3.9], except that we need to get an explicit\nupper bound for c(P ).\nLet \u03c9 be a nonzero invariant exterior k-form of top degree on G; such a form\nis unique up to multiplication by an element of k\u2217 and is called a Tamagawa form.\nWe denote by |\u03c9| the Haar measure on the ade`le group G(A) determined by \u03c9. The\nnatural embedding of k into A gives an embedding of G(k) in G(A); it is well known\nthat the image of G(k) is a lattice in G(A). By the product formula, its covolume\nwith respect to the measure |\u03c9| does not depend on the choice of the form \u03c9; thus\nthe number \u03c4k(G) := D\u2212 dim(G)\/2k |\u03c9|(G(k)\\G(A)) is correctly defined. It is called the\nTamagawa number of G\/k. By a theorem of Ono in [On], \u03c4k(G) is bounded by a\nconstant multiple of the order of the center of the simply connected covering group\nG multiplied by \u03c4k(G). According to the Weil conjecture, the Tamagawa number of a\nsimply connected group is equal to 1; this has been proved completely for the groups\nover number fields, thanks to the work of many people (see [P, Sec. 3.3] for a short\ndiscussion). Therefore, we have\n|\u03c9|(G(k)\\G(A)) = \u03c4k(G)Ddim(G)\/2k \u2264 c17Ddim(G)\/2k , (7)\nwhere c17 depends only on the absolute type of G.\nComing back to the problem of bounding the class number c(P ), we recall that\nthe double cosets G(k)\\G(A)\/G\u221eP correspond bijectively to the orbits of G\u221eP on\nG(k)\\G(A), which are open. Given an upper bound for |\u03c9|(G(k)\\G(A)), in order to\ngive a bound for c(P ) it is enough to obtain a uniform lower bound for the |\u03c9|-volumes\nof these orbits. The double cosets are represented by elements of Gf , so it is sufficient\nto consider the orbit of the image of a \u2208 Gf which is isomorphic to \u0004a\\G\u221eaPa\u22121,\n\u0004a = G(k) \u2229 G\u221eaPa\u22121. Let \u0004\u2032a be the projection of \u0004a to G\u221e with respect to the\ndecomposition G(A) = G\u221e \u00d7 Gf . As aPa\u22121 is a compact open subgroup of Gf , \u0004\u2032a\nis an arithmetic subgroup of G\u221e. We have\n|\u03c9|(\u0004a\\G\u221eaPa\u22121) = |\u03c9|\u221e(\u0004\u2032a\\G\u221e)|\u03c9|f (P ),\nwhere |\u03c9|\u221e, |\u03c9|f denote the product measures on G\u221e, Gf corresponding to \u03c9.\nIn order to estimate the factors in the right-hand side of the formula, for each\nv \u2208 V (k) we relate the measure |\u03c9| to the canonical measure |\u03c9Gv | on G(kv) defined\nin [G, Secs. 4, 11]. In particular, if G is simply connected, then the measure |\u03c9Gv |\ncoincides with the measure \u03b3v\u03c9\u2217v that is used for the local computations in [P]; for\nv \u2208 V\u221e(k), |\u03c9Gv | is equal to the measure \u00b5 on G(kv) defined as in Section 2.5; and\nfor all but finitely many v, |\u03c9Gv | = |\u03c9|v . Let \u03b3v denote the ratio |\u03c9Gv |\/|\u03c9|v , which by\nthe previous remark is equal to 1 for all but finitely many places v. Hence,\n|\u03c9|(\u0004a\\G\u221eaPa\u22121) = \u00b5\u221e(\u0004\u2032a\\G\u221e)\n\u220f\nv\u2208Vf\n|\u03c9Gv |(P v)\/\n\u220f\nv\u2208V\n\u03b3v.\n18 MIKHAIL BELOLIPETSKY\nWe now recall the main result of [BP], which implies that covolumes of arithmetic\nsubgroups of G\u221e with respect to the measure \u00b5 are bounded from below by a universal\nconstant, and thus, \u00b5\u221e(\u0004\u2032a\\G\u221e) \u2265 \u00b50.\nThe crucial ingredient that allows us to carry out the required estimates is the\nproduct formula for \u03b3v . It was obtained in [P, Th. 1.6] for the simply connected groups\nand later extended by Gross to arbitrary reductive groups defined over number fields\n(see also [Ku] for the groups over global function fields). Thus, by [G, Th. 11.5], we\nhave\n\u220f\nv\u2208V\n\u03b3v = (Dl\/D[l:k]k )s\/2\n( r\u220f\ni=1\nmi!\n(2\u03c0)mi+1\n)[k:Q]\n.\nFinally, we make use of the following inequality.\nCLAIM\nWe have |\u03c9Gv |(P v) \u2265 |\u03c9Gv |(Pv) = e(Pv)\u22121.\nThe proof of this claim, which is given below, is quite technical but not conceptually\nnew; related questions were studied in detail and full generality in [G] and [Ku]. The\nargument falls into several steps.\nProof\nLet K = kv be a nonarchimedean local field, let O be its ring of integers, let G be\na simply connected semisimple K-group, let i : G \u2192 G\u2032 be a central K-isogeny\n(we actually need only the case G\u2032 = G), and let X = X(G) denote the Bruhat-Tits\nbuilding of G\/K .\n(1) We assume first that the groups G and G\u2032 are quasi-split over K . Let x \u2208 X\nbe a special vertex in X chosen as in [G, Sec. 4] (see also [P, Sec. 1.2]). The Bruhat-\nTits theory assigns to G\u2032\/K and x \u2208 X(G) a smooth affine group scheme G\u20320x over\nO. Its generic fiber is isomorphic to G\u2032\/K , and its special fiber G\u20320x is connected.\nLet Px = Gx(O)(= G0x(O)), P \u2032x = G\u20320x(O). Then Px (resp., P \u2032x) is an open compact\nsubgroup of G(K) (resp., G\u2032(K)), Px is the stabiliser of x in G(K), and P \u2032x is contained\nin the stabiliser of x in G\u2032(K) with finite index. Recall also that the measure |\u03c9G| (resp.,\n|\u03c9G \u2032 |) corresponds to a differential \u03c9G (resp., \u03c9G\u2032) of top degree on G (resp., G\u2032) over\nK which has good reduction (see [G, Sec. 4]). This brings us to the conditions of [Oe,\nProp. 1.2.5], which implies\n|\u03c9G|(Px) = #Gx(Fq)q\u2212dim G, |\u03c9G \u2032 |(P \u2032x) = #G\u2032\n0\nx( Fq)q\u2212dim G\n\u2032\n.\n(Fq denotes the residue field of K .)\nCOUNTING MAXIMAL ARITHMETIC SUBGROUPS 19\nSince G and G\u2032 are isogenous, Gx and G\u2032x are isogenous. Hence, dimG = dimG\u2032,\nand by Lang\u2019s theorem (see [L]), #Gx(Fq) = #G\u20320x(Fq). Thus, we obtain |\u03c9G|(Px) =\n|\u03c9G \u2032 |(P \u2032x).\n(2) Now, let C be a chamber of X which contains x, and let \u000f be a subset of C.\nDenote by IC (resp., I \u2032C) the Iwahori subgroup of G(K) (resp., G\u2032(K)) corresponding\nto C. Note that by definition, I \u2032C is the preimage in G\u2032(K) of a Borel subgroup B\n\u2032\nof G\u20320x(Fq). Let P\u000f (resp., P \u2032\u000f) be the parahoric subgroup of G(K) (resp., G\u2032(K))\nassociated to \u000f; so P\u000f = G\u000f(O), P \u2032\u000f = G\u20320\u000f(O), and any parahoric subgroup of\nG(K) is conjugate to some P\u000f. The inclusion \u000f \u2282 C induces a group scheme\nhomomorphism \u03c1\u000fC : G\u20320C \u2192 G\u20320\u000f whose reduction maps the group G\n\u20320\nC onto a Borel\nsubgroup B \u2032 of G\u20320\u000f. Therefore, we have\n[P \u2032\u000f : I \u2032C] = [G\u2032\n0\n\u000f( Fq) : B\n\u2032] = [G\u000f( Fq) : B] = [P\u000f : IC],\nas G\u20320\u000f is isogenous to G\u000f, B \u2032 is isogenous to B, and all the groups are connected. It\nfollows that |\u03c9G \u2032 |(P \u2032\u000f) = |\u03c9G|(P\u000f).\n(3) We finally note that P \u2032\u000f \u2282 P \u2032\u000f (P\n\u2032\n\u000f denotes the stabiliser of \u000f in G\u2032(K)), and\nthus, |\u03c9G \u2032 |(P \u2032\u000f) \u2265 |\u03c9G \u2032 |(P \u2032\u000f) = |\u03c9G|(P\u000f), which implies the desired inequality in the\nquasi-split case.\n(4) In order to extend this result to the general case, we have to recall the definition\nof the canonical measure |\u03c9G| for the general G by pullback from the quasi-split\ninner form (see [G, p. 294]) and its interpretation in terms of the volume form \u03bdG\nassociated to an Iwahori subgroup of G(K) described in [G, pp. 294 \u2013 295]. The\nlatter allows us to apply the argument similar to step (1) to Iwahori subgroups IC\nand I \u2032C corresponding to a chamber C of X(G), proving |\u03c9G|(IC) = |\u03c9G \u2032 |(I \u2032C). All\nthe rest of the proof does not depend on the quasi-split assumption, and the claim\nfollows. \u0001\nLet us collect together the results of this section. We obtain\nc(P ) \u2264 |\u03c9|(G(k)\\G(A))\n\u220f\nv\u2208V \u03b3v\n\u00b50\n\u220f\nv\u2208Vf e(Pv)\u22121\n\u2264 1\n\u00b50\nDdim(G)\/2k (Dl\/D[l:k]k )s\/2\n( r\u220f\ni=1\nmi!\n(2\u03c0)mi+1\n)[k:Q]\n\u03c4k(G)E(P ). (8)\nThis formula can be viewed as an extension of the upper bound for the class number\nfrom [P, Th. 4.3].\nWe now bound the right-hand side of (8). By Sections 4.1 and 4.2, we have\nDk < (x\/c1)1\/\u03b41 , Dl\/k < (x\/c1)1\/\u03b42 , and [k : Q] \u2264 c logDk . By (7), \u03c4k(G) \u2264 c17.\nFrom Sections 4.3 and 4.4, it follows that if \u00b5(H\/\u0004) \u2264 x, then \u220fv\u2208Vf ev \u2264 xc18 for\n20 MIKHAIL BELOLIPETSKY\nsome constant c18 that depends only on the type of almost simple factors of H . Hence,\nit follows from (8) that there exists a constant c19 such that\nc(P ) \u2264 xc19 .\n4.6. The upper bounds\nIt remains to combine the results of the previous sections to get the upper bounds. By\nSections 4.1, 4.3, 4.4, and 4.5,\nmuH (x) \u2264 xc2\u03b2(x)+c3xc11xc16xc19 \u2264 xB\u03b2(x),\nand constant B depends only on the type of almost simple factors of H .\nBy Sections 4.2, 4.3, 4.4, and 4.5,\nmnuH (x) \u2264 xc5xc11xc16xc19 \u2264 xB\n\u2032\n,\nand constant B \u2032 depends on the type and the number of almost simple factors of H .\n5. Proof of Theorem 1: The lower bound\n5.1. Cocompact case\nA theorem of Borel and Harder [BH] implies that a semisimple group over a local\nfield of characteristic zero contains cocompact arithmetic lattices. The method of [BH]\nactually proves the existence of such lattices defined over a given field k, which satisfies\na natural admissibility condition, for any isotypic semisimple Lie group. So, if H has\na1 real and a2 complex almost simple factors (all of the same type) and k is a number\nfield with greater than a1 real and precisely a2 complex places, then H contains a\ncocompact arithmetic subgroup \u00041 defined over k.\nLet \u00040 be a maximal arithmetic subgroup of H which contains \u00041. There exists\nan absolutely almost simple, simply connected k-group G and a principal arithmetic\nsubgroup \u00050 of G such that \u00040 = NH (\u03c6(\u00050)).\nWe assume that x is large enough and estimate the number of principal arithmetic\nsubgroups \u0005 \u2282 G(k) which are associated to the coherent collections of parahoric\nsubgroups ofO-maximal types (see [R], [RC]) and such that \u00b5S(GS\/\u0005) < x. Then for\n\u0004 = NH (\u03c6(\u0005)), we also have \u00b5S(GS\/\u0004) < x. Moreover, by Rohlfs\u2019s theorem, each\nsuch\u0004 is a maximal arithmetic subgroup ofH and all maximal arithmetic subgroups of\nH are obtained as the normalizers of the images of the principal arithmetic subgroups\ncorresponding to O-maximal collections of parahorics.\nThe condition of maximality for the type of a collection of parahoric subgroups\nP = (Pv)v\u2208Vf is a local condition on the types of Pv at each v \u2208 Vf , while O-\nmaximality requires an additional global restriction that is needed to further narrow\nCOUNTING MAXIMAL ARITHMETIC SUBGROUPS 21\ndown the set of admissible collections of parahoric subgroups of maximal types. We\ndo not give precise definitions here, referring the reader to the articles [R] and [RC].\nWhat is important for our argument is that given P0 = (P0,v)v\u2208Vf , a collection of\nparahoric subgroups of O-maximal type, for every v0 \u2208 Vf there exists another O-\nmaximal collection P = (Pv)v\u2208Vf such that for v \u000b= v0, Pv = P0,v and Pv0 \u000b\u223c= P0,v0 .\nThis is clearly true. For the groups of the absolute rank greater than one (which is\nour standing assumption), it is enough to consider the maximal types corresponding\nto single vertices of the affine Dynkin diagram, and for such types, O-maximality can\nbe easily checked.\nWe have\n\u00b5S(GS\/\u0005) = Ddim(G)\/2k (Dl\/D[l:k]k )s\/2\n( r\u220f\ni=1\nmi!\n(2\u03c0)mi+1\n)[k:Q]\n\u03c4k(G) E(P )\n= c1\n\u220f\nv\u2208T\ne(Pv)\/e(P0,v)\n\u2264 c1\n\u220f\nv\u2208T\ne(Pv), c1 = \u00b5S(GS\/\u00050),\nwhere Pv (resp., P0,v) is the closure of \u0005 (resp., \u00050) in G(kv), v \u2208 Vf ; T is a finite\nsubset of the nonarchimedean places of k for which Pv \u000b\u223c= P0,v; and the constant c1\ndepends on G\/k and \u00050 but does not depend on the choice of \u0005.\nIf\n\u220f\nv\u2208T e(Pv) < x\/c1, then \u00b5S(GS\/\u0005) < x. There exists a constant \u03b4 determined\nby the absolute type of G such that for every v \u2208 Vf and every parahoric subgroup\nPv \u2282 G(kv), e(Pv) \u2264 q\u03b4v (e.g., take \u03b4 = dim(G)). This implies\u220f\nv\u2208T\ne(Pv) \u2264\n\u220f\nv\u2208T\nq\u03b4v .\nHence,\n\u220f\nv\u2208T qv < (x\/c1)1\/\u03b4 is sufficient for \u00b5S(G\/\u0005) < x. The number of variants\nfor such sets T is controlled via Proposition 3.2(i). (Note that the field k is fixed.) We\nobtain that for large enough x, there are at least\nc2\n( x\nc1\n)1\/\u03b4\n\u2265 xA\nvariants for T , where the constant A > 0 is determined by \u03b4 and, thus, depends only\non the absolute type of G.\nIt remains to recall that for each T , there exists a collection of parahoric subgroups\nP = (Pv)v\u2208Vf such that Pv = P0,v for v \u2208 Vf \\ T , Pv \u000b\u223c= P0,v for v \u2208 T , and P has\nO-maximal type. Each such collection defines a maximal arithmetic subgroup of H of\n22 MIKHAIL BELOLIPETSKY\ncovolume less than x, and subgroups corresponding to different T \u2019s are not conjugate.\nThe number of maximal arithmetic subgroups obtained this way is at least xA with\nA > 0, a constant depending only on the absolute type of G. This proves the lower\nbound for muH (x).\nNote that all the maximal arithmetic subgroups constructed in this section are\ncommensurable. It is also possible to construct different commensurability classes\nthat contain arithmetic subgroups of covolumes less than x. This may enlarge the\nconstant A in our asymptotic inequality but, since it follows from the first part of\nthe proof and the conjecture on the number of isomorphism classes of fields with\ndiscriminant less than x, would hardly change the type of the asymptotic.\n5.2. Non-cocompact case\nLet now \u00041 be a nonuniform irreducible lattice in H which exists by the assumption\nof Theorem 1(B), and let G be a corresponding algebraic k-group. Arithmetic sub-\ngroups of H which are induced from G(k) are all noncocompact. (They are actually\ncommensurable with \u00041.) To prove the lower bound for mnuH (x), it remains to repeat\nthe argument of Section 5.1 for the group G.\nNote that contrary to the compact case, the existence of non-cocompact arithmetic\nlattices in H generally is not guaranteed by the condition that H is isotypic (for\na counterexample, see Sec. 2.3). The conditions under which such examples can\nbe constructed are rather exceptional; in most cases, isotypic groups contain both\ncocompact and non-cocompact arithmetic subgroups.\nThe theorem is now proved. \u0001\n6. Corollaries, conjectures, remarks\n6.1\nCOROLLARY\nThere exists a constant C1 that depends only on the type of almost simple factors of H\nsuch that if \u0005 is a principal arithmetic subgroup of H and \u0004 = NH (\u0005) has covolume\nless than x, then [\u0004 : \u0005] \u2264 xC1 .\nProof\nBy [BP] (see Sec. 2.7 for the notation and precise references),\n[\u0004 : \u0005] \u2264 n\u0002#S \u00b7 2h\u0002\u2032l n\u0002a(k)+\u0002\n\u2032a(l)+\u0002#T (Dl\/D[l:k]k )\u0002\u2032\u2032 \u00b7\n\u220f\nv\u2208Vf\n#\u000b\fv . (9)\nNow, since \u00b5(H\/\u0004) \u2264 x, the group \u0004 has to satisfy the conditions on the subgroups\nof covolume less than x obtained in the proof of the upper bound of Theorem 1. (In\nTheorem 1, only maximal arithmetic subgroups are considered, but the proof of the\nCOUNTING MAXIMAL ARITHMETIC SUBGROUPS 23\nupper bound applies without a change to arbitrary principal arithmetic subgroups and\ntheir normalisers, thus providing a somewhat stronger result to which we appeal here.)\nWe have\nDl\/D[l:k]k = Dl\/k \u2264 xc1, a(k) \u2264 c2 log x (Sec. 4.1),\n#T \u2264 #T1 \u2264 c3 log x (Sec. 4.3),\n{v \u2208 Vf , #\u000b\fv \u000b= 1} \u2282 T1 \u222a R \u222a T2\nas for the rest of v, Pv is special, so\n#{v \u2208 Vf , #\u000b\fv \u000b= 1} \u2264 #(T1 \u222a R \u222a T2) \u2264 c4 log x (Sec. 4.4).\nAlso, recall that #\u000b\fv \u2264 r + 1, r is the absolute rank of G; hl \u2264 c[l:Q]Dl \u2264 xc5 (see,\ne.g., the proof of Prop. 3.3); and a(l) \u2264 3a(k) (as [l : k] \u2264 3). Altogether, these imply\nthe corollary. \u0001\n6.2\nFor some particular cases, the bound in Corollary 6.1 can be improved. Let us assume\nthat the degrees of the fields of definition of the arithmetic subgroups are bounded.\nThus,\n[k : Q] \u2264 d, (10)\nwhich is the case, for example, if we consider only nonuniform lattices in H .\nAssumption (10) implies that the number m of different prime idealsP1, . . . ,Pm\nof Ok such that Norm(P1 \u00b7 \u00b7 \u00b7Pm) \u2264 x is bounded by c log x\/ log log x, c = c(d)\n(instead of the bound log x that we used for the general case). Indeed, k = Q follows\nfrom the prime number theorem, and the case of arbitrary k of bounded degree can be\neasily reduced to the rational case.\nTherefore, assumption (10) implies that most of the terms in (9) are\nat most clog x\/ log log x with c = c(d). What remains is Dl\/k = Dl\/D[l:k]k (for type\nDr , r even) and hl (or hk if l = k). The former, in fact, appears in the formula as an\nupper bound for 2#R (see [BP, Sec. 5.5]), which again can be improved to clog x\/ log log x\nby the same argument. What remains is the class number.\nGoing back to [BP, Sec. 5, Prop. 0.12], we see that what occurs in the formula\nis not hl but the order of the group Cn(l), which consists of the elements of the class\ngroup C(l) whose orders divide n. (As before, n is a constant determined by the type\nof H .) Instead of using the trivial bound #Cn(l) \u2264 hl , let us keep it as it is. We now\ncome to the following formula:\n[\u0004 : \u0005] \u2264 clog x\/ log log x#Cn(l), x \u2265 \u00b5(H\/\u0004). (11)\n24 MIKHAIL BELOLIPETSKY\nIf n = p is a prime, let \u03c1p(l) denote the p-rank of C(l). Then, clearly, #Cp(l) \u2264\np\u03c1p(l), and in general, for n = p\u03b111 \u00b7 \u00b7 \u00b7p\u03b1mm , #Cn(l) \u2264 p\n\u03b11\u03c1p1 (l)\n1 \u00b7 \u00b7 \u00b7p\u03b1m\u03c1pm (l)m . So, we are\ninterested in the upper bounds for p-ranks of the class groups.\nApparently, even though this and related questions have been much studied, there\nare very few results beyond Gauss\u2019s celebrated theorem, which can be applied in our\ncase. We have the fact that\n(i) if [l : Q] = 2, then \u03c12(l) \u2264 tl \u2212 1 (by Gauss);\n(ii) if [k : Q] = 2 and [l : k] = 2, then \u03c12(l) \u2264 2(tl + tk \u2212 1) (by [Co, Th. 2]),\nwhere tk (resp., tl) denotes the number of primes ramified in k\/Q (resp., l\/k).\nFrom this, we obtain\n#Cn(l) \u2264 nc log x\/ log log x (12)\nif n is a power of 2 and l is as in (i) or (ii).\nSimilar results for other n and other fields can only be conjectured; even \u03c13(k)\nfor quadratic fields k seems to be out of reach with the currently available methods.\nNevertheless, estimates (11) and (12) imply the following corollary.\n6.3\nCOROLLARY\nLet H be a simple Lie group of type A2\u03b1\u22121 (\u03b1 > 1), Br , Cr , Dr (r \u000b= 4), E7, E8, F4, or\nG2. There exists a constant C2 that depends only on the type of H such that if \u0005 is a\nnon-cocompact principal arithmetic subgroup of H and if \u0004 = NH (\u0005) has covolume\nless than x, then [\u0004 : \u0005] \u2264 C log x\/ log log x2 .\nProof\nIndeed, the assumption that H has one of the given types implies that n is a power of\n2 (see the definition of n in Sec. 2.7). Since H is simple and the arithmetic subgroup\nis noncompact, its field of definition k is either Q or an imaginary quadratic extension\nof Q, depending on whether H is a real or complex Lie group (see also Sec. 4.2).\nFinally, the fact that the type of H is not D4 implies that [l : k] \u2264 2. The corollary\nnow follows from the discussion in Section 6.2. \u0001\nWe expect similar estimates to be valid for the nonuniform lattices in other groups,\nbut we do not know how to prove it.\n6.4\nRemark. Concerning the general case, let us point out that if the degrees of the fields\nare a priori not bounded, then we cannot expect a (log x\/ log log x)-bound for the\np-rank of the class group. An example of a sequence of fields ki for which \u03c12(ki)\ngrows as logDki was constructed by Hajir [H, Sec. 5]. The fields ki in Hajir\u2019s example\nform an infinite class field tower. This remark together with the previous estimates\nmotivates the following question:\nCOUNTING MAXIMAL ARITHMETIC SUBGROUPS 25\nIs the estimate in Corollary 6.1 sharp?; that is, given a groupH , is there a constant\nC0 = C0(H ) > 0 such that there exists an infinite sequence of pairwise nonconjugate\nprincipal arithmetic subgroups \u0005i in H for which [\u0004i : \u0005i] \u2265 \u00b5(H\/\u0004i)C0 , where\n\u0004i = NH (\u0005i) and \u00b5 is a Haar measure on H?\nCorollaries 6.1 and 6.3 are important in [BL], in which the growth rate of the number\nof irreducible lattices in semisimple Lie groups is studied.\n6.5\nRemark. Groups of type A1 have been consistently excluded here. It is not feasible to\nuse the formula from Section 2.8 combined with an analogue of Proposition 3.3 for\nthis case, even to prove a finiteness result. However, one can follow another method,\nalso due to Borel, and employ geometric bounds for the index of a principal arithmetic\nsubgroup in a maximal arithmetic. This indeed allows us to establish the finiteness of\nthe number of arithmetic subgroups of bounded covolume in SL(2,R)a \u00d7 SL(2,C)b\n(see [B]). The problem is that the quantitative bounds that can be obtained this way\nare only exponential. We suppose that the true bounds should be similar to the general\ncase (and conjecturally polynomial), although we do not know how to prove this\nconjecture and leave it as an open problem.\nProblem\nFind the growth rate of the number of maximal arithmetic subgroups for the\nsemisimple Lie groups whose almost simple factors have type A1 or obtain a better-\nthan-exponential upper bound for the growth.\n6.6\nThe following two conjectures were mentioned in the introduction.\nCONJECTURE 1\nThere exists an absolute constant B such that for large enough x, the number of\nisomorphism classes of number fields with discriminants less than x is at most xB .\nCONJECTURE 2\nGiven a connected semisimple Lie group H without almost simple factors of type A1\nand without compact factors, there exists a constant BH > 0 which depends only on\nthe type of almost simple factors of H such that for large enough x, the number of\nconjugacy classes of maximal irreducible arithmetic subgroups of H of covolumes\nless than x is at most xBH .\nWe now prove the following proposition.\n26 MIKHAIL BELOLIPETSKY\nPROPOSITION\nConjectures 1 and 2 are equivalent.\nProof\nThe implication that 1 \u2192 2 follows directly from the proof of the upper bounds in\nTheorem 1. Consider the implication that 2 \u2192 1. Assume that Conjecture 2 is true but\nthat Conjecture 1 is false (i.e., muH (x) + mnuH (x) \u2264 xBH for every x > x0, and for an\narbitrary C, there exists x > x0 such that N(x) > xC). Some additional assumptions\non x0 are needed, a fact that becomes clear later; these could have been imposed from\nthe beginning. So, let us fix C > 1, and let x > x0 be such that N(x) > xC .\nLet Ni,j (x) denote the number of extensions of Q of discriminant less than x\nwhich have precisely i real and j complex places. We have\nN(x) =\n\u2211\ni=1,...,n\nj=1,...,m\nNi,j (x).\nThe condition that the discriminants of the fields are less than x implies, by Minkow-\nski\u2019s theorem, that the degrees of the extensions are bounded by c log x for an absolute\nconstant c, and so the number of summands is less than (c log x)2. By Dirichlet\u2019s box\nprinciple, there exists a pair (i, j ) such that Ni,j (x) > xC\/(c log x)2 \u2265 xC\u22121. (This\ninequality requires (c log x)2 \u2264 x, which is true for large enough x and gives a first\ncondition on x0.) Let K be the set of such number fields, #K = Ni,j (x) > xC\u22121.\nConsider a simply connected semisimple Lie group H that has i split real simple\nfactors and j complex simple factors all of the same type. For each k \u2208 K, let G\/k\nbe a simply connected, absolutely simple split group of the same absolute type as the\nsimple factors of H , defined over k. Let P = (Pv)v\u2208Vf be a coherent collection of\nparahoric subgroups of G which are all hyperspecial (such a collection exists since G\nsplits over k), and let \u0005 be the principal arithmetic subgroup of H defined by P . We\nhave\n(a) for S = V\u221e(k), GS \u223c= H ;\n(b) \u00b5(H\/\u0005) = D dim(G)\/2k\n(\u220fr\ni=1 mi!\/(2\u03c0)mi+1\n)[k:Q]E(P ) by Prasad\u2019s formula.\nUsing the orders of finite groups of Lie type, the Euler product E(P ) can be\nexpressed as a product of the Dedekind zeta function of k, and certain Dirichlet L-\nfunctions at the integers mi + 1, mi are the Lie exponents of G (see [P, Rem. 3.11]).\nObvious inequalities L(s, \u03c7) \u2264 \u03b6k(s) and \u03b6k(s) \u2264 \u03b6 (s)[k:Q], for s \u2265 2, imply that\nthere exists a constant c1 that depends only on the type of simple factors of H and\nsuch that each zeta or L-function in the product is bounded from above by c[k:Q]1 . Since\n[k : Q] \u2264 c log x, we have E(P ) \u2264 (cc log x1 )r . By definition of the set K, k \u2208 K\nCOUNTING MAXIMAL ARITHMETIC SUBGROUPS 27\nimplies Dk \u2264 x. Therefore, we obtain\n\u00b5(H\/\u0005) \u2264 xdim(G)\/2cc log x2 (cc log x1 )r \u2264 x\u03b4,\nwhere \u03b4 is greater than 1 and depends only on the type of simple factors of H . The\nlatter inequality may require that x be larger than a certain value that depends on the\ntype of simple factors of H and that gives us the second condition on x0. Clearly, both\nconditions do not depend on C, and both could be imposed from the beginning.\nFor each k \u2208 K, we have at least one maximal arithmetic subgroup of H of\ncovolume less then x\u03b4 . Now, if we take C = \u03b4BH + 1, we arrive at a contradiction\nwith Conjecture 2 for H and x\u03b4 > x0. \u0001\nLet us note that in the proof, Conjecture 2 is used only for non-cocompact arithmetic\nsubgroups of semisimple groups H which have simple factors of a fixed type. It then\nimplies Conjecture 1, which in turn implies Conjecture 2 in the whole generality. It is\npossible to specify further the relation between two conjectures, but we do not go into\ndetails. What we emphasise is that our result provides a new geometric interpretation\nfor a classical number-theoretic problem. An optimistic expectation would be that\nstudy of the distributions of lattices in semisimple Lie groups can give a new insight\non the number fields and their discriminants.\nAppendix\nJORDAN ELLENBERG and AKSHAY VENKATESH\nA.1\nLet N(X) denote the number of isomorphism classes of number fields with discrimi-\nnant less than X.\nTHEOREM\nFor every \u0002 > 0, there is a constant C(\u0002) such that logN(X) \u2264 C(\u0002)(logX)1+\u0002 for\nevery X \u2265 2.\nIn fact, we prove the more precise upper bound that\nlogN(X) \u2264 C6 logX exp(C7\n\u221a\nlog logX)\nfor absolute constants C6, C7.\nThis theorem (almost) follows from [EV, Th. 1.1], the only point being to control\nthe dependence of implicit constants on the degree of the number field.\n28 MIKHAIL BELOLIPETSKY\nWe refer to [EV] for further information and for some motivational comments\nabout the method. In the proof, C1, C2, . . . denote certain absolute constants.\nA.2\nLet K be an extension of Q of degree d \u2265 200. Denote by \u0014(K) the set of embeddings\nof K into C (#\u0014(K) = d), and denote by \u0014(K) a set of representatives for \u0014(K)\nmodulo complex conjugation (in the notation of the article, \u0014(K) = V\u221e(K)). We\nregard the ring of integers OK as a lattice in K \u2297Q R = \u220f\u03c3\u2208\u0014(K) K\u03c3 . We endow the\nreal vector space K \u2297Q R with the supremum norm (i.e., \u2016(x\u03c3 )\u2016 = sup\u03c3 |x\u03c3 |). Here,\n| \u00b7 | denotes the standard absolute value on C. In particular, we obtain a \u201cnorm\u201d on OK\nby restriction. Explicitly, for z \u2208 OK , we have \u2016z\u2016 = sup\u03c3\u2208\u0014(K) |\u03c3 (z)|.\nWe denote by Md(Z) (resp., Md(Q)) the algebra of d by d matrices over Z\n(resp., Q).\nBy trace form we mean the pairing (x, y) \u0010\u2192 TrK\/Q(xy). It is a symmetric\nnondegenerate Q-bilinear pairing on K2.\nLet s be a positive integer that can be specified later. We denote by y =\n(y1, y2, . . . , ys) an ordered s-tuple of elements of OK , and we write \u2016y\u2016 :=\nmax(\u2016y1\u2016, . . . , \u2016ys\u2016). For y = (y1, . . . , ys) \u2208 OsK and l \u2265 1, we set\nS(l) = {(k1, . . . , ks) \u2208 Zs : k1 + \u00b7 \u00b7 \u00b7 + ks \u2264 l, k1, . . . , ks \u2265 0},\nS(y, l) = {yk11 yk22 \u00b7 \u00b7 \u00b7 ykss : (k1, . . . , ks) \u2208 S(l)} \u2282 OK.\n(13)\nIfS is a subset ofS(l), we denote byS(y) the set {yk11 yk22 \u00b7 \u00b7 \u00b7 ykss : (k1, . . . , ks) \u2208 S}.\nA.3\nLEMMA\nLet S be a subset of S(l) such that S(y) spans a Q-linear subspace of K with dimension\nstrictly greater than d\/2. Let S + S be the set of sums of two elements of S. Then\n(S + S)(y) spans K over Q.\nProof (see [EV, Lem. 2.1])\nSuppose that there existed z \u2208 K which was perpendicular, with respect to the trace\nform, to the Q-span of (S + S)(y). Since (S + S)(y) consists precisely of all products\n\u03b1\u03b2, with \u03b1, \u03b2 \u2208 S(y), it follows that\nTrK\/Q(z\u03b1\u03b2) = 0 (\u03b1, \u03b2 \u2208 S(y)). (14)\nCall W \u2282 K the Q-linear span of S(y). Then (14) implies that zW is perpendicular\nto W with respect to the trace form, contradicting dim(W ) > d\/2. \u0001\nCOUNTING MAXIMAL ARITHMETIC SUBGROUPS 29\nA.4\nLEMMA\nLet C \u2282 OK be a finite subset containing 1 and generating K as a field over\nQ. Let z1, z2, . . . , zd be a Q-linear basis for K . For each u \u2208 C, let M(u) =\n(TrK\/Q(uzizj ))1\u2264i,j\u2264d \u2208 Md(Q). Then the Q-subalgebra of Md(Q) generated by\nM(u)M(1)\u22121, as u ranges over C, is isomorphic to K .\nProof (see [EV, Lem. 2.2])\nIn fact, M(u)M(1)\u22121 gives the matrix of multiplication by u, in the basis {zi}. \u0001\nA.5\nWe denote by DK the absolute value of the discriminant of K .\nLEMMA\nThere is an absolute constant C1 \u2208 R such that for any K as above, there exists a\nbasis \u03b31, \u03b32, . . . , \u03b3d for OK over Z such that\n\u2016\u03b3j\u2016 \u2264 \u2016\u03b3j+1\u2016,\nd\u220f\ni=1\n\u2016\u03b3i\u2016 \u2264 D1\/2K Cd1 , \u2016\u03b3i\u2016 \u2264 (Cd1D1\/2K )1\/(d\u2212i) (i < d).\n(15)\nProof\nThis is Minkowski\u2019s second theorem, applied exactly as in [EV, Prop. 2.5]. The final\nstatement of (15) follows from the preceding statements, in view of the fact that\n\u2016\u03b3j\u2016 \u2265 1 for each j . \u0001\nA.6\nLet r, l be integers so that d\/2 < r \u2264 |S(l)| = (l+s\ns\n)\n.\nLEMMA\nSuppose that W \u2282 K is a Q-linear subspace of dimension r , and let S \u2282 S(l) be a\nsubset of size r . Then there exists y = (y1, y2, . . . , ys) \u2208 Ws such that the elements\nof S(y) are Q-linearly independent.\nProof\nThis is precisely [EV, Lem. 2.3]. \u0001\nA.7\nLEMMA\nLet \u0005 = Z\u03b31 + Z\u03b32 + \u00b7 \u00b7 \u00b7 + Z\u03b3r , and let S \u2282 S(l) be a subset of size r . Then there\nis y = (y1, y2, . . . , ys) \u2208 \u0005s such that the elements of S(y) are linearly independent\nover Q, and \u2016y\u2016 \u2264 r2l(Cd1D1\/2K )1\/(d\u2212r).\n30 MIKHAIL BELOLIPETSKY\nProof\nConsidering \u0005s as a Z-module of rank rs, the proof of [EV, Lem. 2.3] shows that\nthere is a polynomial F of degree at most rl in the rs variables so that the elements of\nS(y) are linearly independent over Q whenever F (y) \u000b= 0. Lemma 2.4 of [EV] then\nshows that we can choose such a y whose coefficients are at most (1\/2)(rl + 1) \u2264 rl.\nIt follows that\n\u2016yi\u2016 \u2264 r2l(Cd1D1\/2K )1\/(d\u2212r)\nfor i = 1, 2, . . . , s. \u0001\nA.8\nLEMMA\nThe number of number fields with degree d \u2265 200 and discriminant of absolute value\nat most X is at most\n(C3d)d exp(C4\n\u221a\nlog d)Xexp(C5\n\u221a\nlog d).\nProof\nFix once and for all a total ordering of S(2l). We denote the order relation as\n(k1, . . . , ks) \u227a (k\u20321, . . . , k\u2032s). Choose S \u2282 S(l) of cardinality r as above.\nLet K have degree d over Q and satisfyDK < X. Choose y as in Lemma A.7. By\nLemma A.3, S(2l)(y) spans K over Q. It follows that there exists a subset \u0016 \u2282 S(2l)\nof size d such that {z1, . . . , zd} := {yk11 yk22 \u00b7 \u00b7 \u00b7 ykss : (k1, k2, . . . , ks) \u2208 \u0016} forms a Q-\nbasis for K and such that the ordering z1, . . . , zd conforms with the specified ordering\non \u0016 \u2282 S(2l).\nWe apply Lemma A.4 to {z1, . . . , zd} and C = (1, y1, y2, . . . , ys). Then each\nproduct uzizj (u \u2208 C, 1 \u2264 i, j \u2264 d) is contained in S(4l + 1).\nPut A = (TrK\/Q(yk11 yk22 \u00b7 \u00b7 \u00b7 ykss ))(k1,k2,...,ks )\u2208S(4l+1). For each K , the collection of\nmatrices M(u) is determined by A and \u0016. Since |TrK\/Q(z)| \u2264 d\u2016y\u20164l+1 for any\nz \u2208 S(y, 4l + 1), the number of possibilities for A is at most (d\u2016y\u20164l+1)|S(4l+1)|; since\n\u0016 is a subset of |S(2l)|, the number of possibilities for \u0016 is at most 2|S(2l)|.\nLemma A.4 now yields that the number of possibilities for the isomorphism class\nof K is at most 2|S(2l)|(d\u2016y\u20164l+1)|S(4l+1)|. By our bound on \u2016y\u2016, we now have that the\nnumber of possibilities for K is at most\n2|S(2l)|\n(\nd(r2l(Cd1D1\/2K )1\/(d\u2212r))4l+1\n)|S(4l+1)|\n. (16)\nNote that |S(4l + 1)| = (s+4l+1\ns\n)\n.\nNow, just as in the paragraph following [EV, (2.6)], we choose s to be the greatest\ninteger less than\n\u221a\nlog d and l to be the least integer greater than (ds!)1\/s . Note\nCOUNTING MAXIMAL ARITHMETIC SUBGROUPS 31\nthat l < exp(C2\n\u221a\nlog d). Now, |S(l)| = (s+l\ns\n)\nis at least d , so we may choose r\nbetween d\/2 and 3d\/4. In particular, r2l < d3. Also,\n(\ns+4l+1\ns\n)\nis at most 10sd and\n|S(2l)| = (s+2l\ns\n) \u2264 6sd . Finally, s < 2\u221alog d .\nSubstituting these values into (16), we get the fact that the number of possible K\nis at most\n26sd\n(\nd(d3(Cd1 X1\/2)4\/d)5 exp (C2\n\u221a\nlog d))10sd ,\nwhich is in turn at most\n(C3d)d exp(C4\n\u221a\nlog d)Xexp(C5\n\u221a\nlog d).\n\u0001\nA.9\nPROPOSITION\nThere are absolute constants C6, C7 with\nlogN(X) \u2264 C6 logX exp(C7\n\u221a\nlog logX).\nProof\nBy Minkowski\u2019s discriminant bound, there is an absolute constant C6 > 1 such that\nDK > C[K:Q]6 for any extension K\/Q. Therefore, we may take d to be bounded by\na constant multiple of logX. From Lemma A.8, it now follows that the logarithm of\nthe number of extensions K\/Q with DK < X and [K : Q] \u2265 200 is bounded by\nC6 logX exp(C7\n\u221a\nlog logX). Trivial bounds suffice to show that the number of K\nwith DK < X and [K : Q] < 200 is at most C8X200. \u0001\nAcknowledgments. I am grateful to Alex Lubotzky for the lecture that inspired this\nproject, and for many helpful discussions. I thank Tsachik Gelander, Alireza Salehi\nGolsefidy, Gopal Prasad, and the referees for their critical remarks and suggestions.\nJordan Ellenberg and Akshay Venkatesh contributed valuable number-theoretic sup-\nport to this project.\nReferences\n[BL] M. BELOLIPETSKY and A. LUBOTZKY, Counting manifolds and class field towers, in\npreparation.\n[B] A. BOREL, Commensurability classes and volumes of hyperbolic 3-manifolds, Ann.\nScuola Norm. Sup. Pisa Cl. Sci. (4) 8 (1981), 1 \u2013 33. MR 0616899\n[BH] A. BOREL and G. HARDER, Existence of discrete cocompact subgroups of reductive\ngroups over local fields, J. Reine Angew. Math. 298 (1978), 53 \u2013 64.\nMR 0483367\n32 MIKHAIL BELOLIPETSKY\n[BP] A. BOREL and G. PRASAD, Finiteness theorems for discrete subgroups of bounded\ncovolume in semi-simple groups, Inst. Hautes \u00b4Etudes Sci. Publ. Math. 69 (1989),\n119 \u2013 171; Addendum, Inst. Hautes \u00b4Etudes Sci. Publ. Math. 71 (1990),\n173 \u2013 177. MR 1019963; MR 1079647\n[BGLM] M. BURGER, T. GELANDER, A. LUBOTZKY, and S. MOZES, Counting hyperbolic\nmanifolds, Geom. Funct. Anal. 12 (2002), 1161 \u2013 1173. MR 1952926\n[C] H. COHEN, Advanced Topics in Computational Number Theory, Grad. Texts in Math.\n193, Springer, New York, 2000. MR 1728313\n[Co] G. CORNELL, Relative genus theory and the class group of l-extensions, Trans. Amer.\nMath. Soc. 277 (1983), 421 \u2013 429. MR 0690061\n[EV] J. S. ELLENBERG and A. VENKATESH, The number of extensions of a number field\nwith fixed degree and bounded discriminant, Ann. of Math. (2) 163 (2006),\n723 \u2013 741. MR 2199231\n[GLP] D. GOLDFELD, A. LUBOTZKY, and L. PYBER, Counting congruence subgroups, Acta\nMath. 193 (2004), 73 \u2013 104. MR 2155032\n[G] B. H. GROSS, On the motive of a reductive group, Invent. Math. 130 (1997),\n287 \u2013 313. MR 1474159\n[H] F. HAJIR, On the growth of p-class groups in p-class field towers, J. Algebra 188\n(1997), 256 \u2013 271. MR 1432356\n[K] M. KNESER, Galois-Kohomologie halbeinfacher algebraischer Gruppen u\u00a8ber\np-adischen Ko\u00a8rpern, I, Math. Z. 88 (1965), 40 \u2013 47; II, Math. Z. 89 (1965),\n250 \u2013 272. MR 0174559; MR 0188219\n[Ku] E. KUSHNIRSKY, On some Haar measures on reductive groups, Amer. J. Math. 126\n(2004), 649 \u2013 670. MR 2058386\n[L] S. LANG, Algebraic groups over finite fields, Amer. J. Math. 78 (1956), 555 \u2013 563.\nMR 0086367\n[Lu] A. LUBOTZKY, Subgroup growth and congruence subgroups, Invent. Math. 119\n(1995), 267 \u2013 295. MR 1312501\n[LN] A. LUBOTZKY and N. NIKOLOV, Subgroup growth of lattices in semisimple Lie\ngroups, Acta Math. 193 (2004), 105 \u2013 139. MR 2155033\n[LS] A. LUBOTZKY and D. SEGAL, Subgroup Growth, Progr. Math. 212, Birkha\u00a8user,\nBasel, 2003. MR 1978431\n[M] G. A. MARGULIS, Discrete Subgroups of Semisimple Lie Groups, Ergeb. Math.\nGrenzgeb. (3) 17, Springer, Berlin, 1991. MR 1090825\n[O] A. M. ODLYZKO, Lower bounds for discriminants of number fields, Acta Arith.\n29 (1976), 275 \u2013 297. MR 0401704\n[Oe] J. OESTERLE\u00b4, Nombres de Tamagawa et groupes unipotents en caracte\u00b4ristique p,\nInvent. Math. 78 (1984), 13 \u2013 88. MR 0762353\n[On] T. ONO, \u201cOn Tamagawa numbers\u201d in Algebraic Groups and Discontinuous\nSubgroups (Boulder, Colo., 1965), Proc. Sympos. Pure Math. 9, Amer. Math.\nSoc., Providence, 1966, 122 \u2013 132. MR 0209290\n[PR] V. PLATONOV and A. RAPINCHUK, Algebraic Groups and Number Theory, Pure\nAppl. Math. 139, Academic Press, Boston, 1994. MR 1278263\nCOUNTING MAXIMAL ARITHMETIC SUBGROUPS 33\n[P] G. PRASAD, Volumes of S-arithmetic quotients of semi-simple groups, with an\nappendix by M. Jarden and G. Prasad, Inst. Hautes \u00b4Etudes Sci. Publ. Math. 69\n(1989), 91 \u2013 114. MR 1019962\n[R] J. ROHLFS, Die maximalen arithmetisch definierten Untergruppen zerfallender\neinfacher Gruppen, Math. Ann. 244 (1979), 219 \u2013 231. MR 0553253\n[RC] A. A. RYZHKOV and V. I. CHERNOUSOV, On the classification of maximal arithmetic\nsubgroups of simply connected groups, Sb. Math. 188 (1997), 1385 \u2013 1413.\nMR 1481667\n[S] W. M. SCHMIDT, \u201cNumber fields of given degree and bounded discriminant\u201d in\nColumbia University Number Theory Seminar (New York, 1992), Aste\u00b4risque\n228, Soc. Math. France, Montrouge, 1995, 189 \u2013 195. MR 1330934\n[Se] J.-P. SERRE, Quelques applications du the\u00b4ore`me de densite\u00b4 de Chebotarev, Inst.\nHautes \u00b4Etudes Sci. Publ. Math. 54 (1981), 323 \u2013 401. MR 0644559\n[T] J. TITS, \u201cReductive groups over local fields\u201d in Automorphic Forms, Representations\nand L-functions (Corvallis, Ore., 1977), Part I, Proc. Sympos. Pure Math. 33,\nAmer. Math. Soc., Providence, 1979, 29 \u2013 69. MR 0546588\n[W] H. C. WANG, \u201cTopics on totally discontinuous groups\u201d in Symmetric Spaces (St.\nLouis, Mo., 1969 \u2013 1970), Pure Appl. Math. 8, Dekker, New York, 1972,\n459 \u2013 487. MR 0414787\n[Wi] D. WITTE [D. W. MORRIS], Introduction to arithmetic groups, preprint,\narXiv:math\/0106063v2 [math.DG]\nBelolipetsky\nDepartment of Mathematical Sciences, Durham University, Durham DH1 3LE, United\nKingdom; Institute of Mathematics, Koptyuga 4, 630090 Novosibirsk, Russia;\nmbel@math.nsc.ru\nEllenberg\nDepartment of Mathematics, Princeton University, Princeton, New Jersey 08544-1000, USA;\nellenber@math.princeton.edu\nVenkatesh\nDepartment of Mathematics, Massachusetts Institute of Technology, Cambridge,\nMassachusetts 02139-4307, USA; akshayv@math.mit.edu\n\n"}