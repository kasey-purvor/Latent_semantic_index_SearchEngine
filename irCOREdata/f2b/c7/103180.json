{"doi":"10.1109\/ISCAS.2011.5938152","coreId":"103180","oai":"oai:epubs.surrey.ac.uk:3039","identifiers":["oai:epubs.surrey.ac.uk:3039","10.1109\/ISCAS.2011.5938152"],"title":"Image Forensic of Glare Feature for Improving Image Retrieval Using Benford's Law","authors":["Qadir, G","Zhao, X","Ho, ATS","Casey, MC"],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2011","abstract":"Whilst it is sometimes essential that a scene is well lit before image capture, too much light can cause exposure or glare-based problems. Typically, glare is introduced to images when the camera is pointed towards the light source, and results in a visible distortion in the image. In this paper, we analyse and identify images that contain the `glare' property using the empirical Benford's Law. The experiment is performed on 1338 images, and extracts discrete wavelet High High (HH), High Low (HL) and Low High (LH) sub bands as raw data. The significant digit from each coefficient of all sub bands is then calculated. We then analyse the probability of occurrence of large digits against smaller digits to detect anomalies. All images containing these anomalies are further analysed for the identification of additional salient features. This analysis is performed in accordance with the Benford's Law plot and the help of probability intensity histogram and divergence. Our results indicate that 142 images have irregular Benford's Law curves. For most images, the irregularity occurs at the $5^{th}$ digit. After visual examination, we have found the unbalanced light and high level of brightness in these images. To measure the intensity of light in an image, we compute the probability histogram of gray levels. These results also correlate with the irregular peak identified from the Benford's Law curves. In addition, the divergence is then computed, which shows the deviation between the actual Benford's Law curve and the Benford's Law graph of an image. Our proposed technique is novel and has a potential to be an image forensic tool for quick image analysis","downloadUrl":"","fullTextIdentifier":null,"pdfHashValue":null,"publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:epubs.surrey.ac.uk:3039<\/identifier><datestamp>\n      2017-10-31T14:07:38Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      74797065733D636F6E666572656E63655F6974656D<\/setSpec><setSpec>\n      6469766973696F6E733D656E67616E64706879736963616C736369656E636573:436F6D707574696E67<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/epubs.surrey.ac.uk\/3039\/<\/dc:relation><dc:title>\n        Image Forensic of Glare Feature for Improving Image Retrieval Using Benford's Law<\/dc:title><dc:creator>\n        Qadir, G<\/dc:creator><dc:creator>\n        Zhao, X<\/dc:creator><dc:creator>\n        Ho, ATS<\/dc:creator><dc:creator>\n        Casey, MC<\/dc:creator><dc:description>\n        Whilst it is sometimes essential that a scene is well lit before image capture, too much light can cause exposure or glare-based problems. Typically, glare is introduced to images when the camera is pointed towards the light source, and results in a visible distortion in the image. In this paper, we analyse and identify images that contain the `glare' property using the empirical Benford's Law. The experiment is performed on 1338 images, and extracts discrete wavelet High High (HH), High Low (HL) and Low High (LH) sub bands as raw data. The significant digit from each coefficient of all sub bands is then calculated. We then analyse the probability of occurrence of large digits against smaller digits to detect anomalies. All images containing these anomalies are further analysed for the identification of additional salient features. This analysis is performed in accordance with the Benford's Law plot and the help of probability intensity histogram and divergence. Our results indicate that 142 images have irregular Benford's Law curves. For most images, the irregularity occurs at the $5^{th}$ digit. After visual examination, we have found the unbalanced light and high level of brightness in these images. To measure the intensity of light in an image, we compute the probability histogram of gray levels. These results also correlate with the irregular peak identified from the Benford's Law curves. In addition, the divergence is then computed, which shows the deviation between the actual Benford's Law curve and the Benford's Law graph of an image. Our proposed technique is novel and has a potential to be an image forensic tool for quick image analysis.<\/dc:description><dc:date>\n        2011<\/dc:date><dc:type>\n        Conference or Workshop Item<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:rights>\n        attached<\/dc:rights><dc:identifier>\n        http:\/\/epubs.surrey.ac.uk\/3039\/2\/2011_qadir_zhao_ho_casey_glare.pdf<\/dc:identifier><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/epubs.surrey.ac.uk\/3039\/4\/licence.txt<\/dc:identifier><dc:identifier>\n          Qadir, G, Zhao, X, Ho, ATS and Casey, MC  (2011) Image Forensic of Glare Feature for Improving Image Retrieval Using Benford's Law       <\/dc:identifier><dc:relation>\n        10.1109\/ISCAS.2011.5938152<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/epubs.surrey.ac.uk\/3039\/","10.1109\/ISCAS.2011.5938152"],"year":2011,"topics":[],"subject":["Conference or Workshop Item","PeerReviewed"],"fullText":"Image Forensic of Glare Feature for Improving\nImage Retrieval Using Benford\u2019s Law\nGhulam Qadir\u2217,Xi Zhao, Anthony TS Ho and Matthew Casey\nUniversity of Surrey\nGuildford, UK, GU2 7XH\n\u2217Email: G.Qadir@surrey.ac.uk\nAbstract\u2014 Whilst it is sometimes essential that a scene is well\nlit before image capture, too much light can cause exposure or\nglare-based problems. Typically, glare is introduced to images\nwhen the camera is pointed towards the light source, and results\nin a visible distortion in the image. In this paper, we analyse\nand identify images that contain the \u2018glare\u2019 property using\nthe empirical Benford\u2019s Law. The experiment is performed on\n1338 images, and extracts discrete wavelet High High (HH),\nHigh Low (HL) and Low High (LH) sub bands as raw data.\nThe significant digit from each coefficient of all sub bands is\nthen calculated. We then analyse the probability of occurrence\nof large digits against smaller digits to detect anomalies. All\nimages containing these anomalies are further analysed for\nthe identification of additional salient features. This analysis\nis performed in accordance with the Benford\u2019s Law plot and\nthe help of probability intensity histogram and divergence. Our\nresults indicate that 142 images have irregular Benford\u2019s Law\ncurves. For most images, the irregularity occurs at the 5th digit.\nAfter visual examination, we have found the unbalanced light and\nhigh level of brightness in these images. To measure the intensity\nof light in an image, we compute the probability histogram\nof gray levels. These results also correlate with the irregular\npeak identified from the Benford\u2019s Law curves. In addition, the\ndivergence is then computed, which shows the deviation between\nthe actual Benford\u2019s Law curve and the Benford\u2019s Law graph of\nan image. Our proposed technique is novel and has a potential\nto be an image forensic tool for quick image analysis.\nI. INTRODUCTION\nThe field of digital image forensics is striving hard to restore\nthe lost trust in digital content. Images, which are becoming a\npart of today\u2019s life, are growing vulnerable to digital forgery\n[1]. The readily available image manipulation software, such\nas Photoshop and GIMP are primarily responsible for this.\nApplication of state of the art digital forensic methods for ex-\namination and authentication of digital images is not possible\nwhen images are available in such huge quantity. In order to\ntrace or extract images of certain features or characteristics,\nan automated system is useful which will save precious time\nlost while scanning each image manually. There are systems\nalready in place doing image retrieval with the help of feature\nextraction algorithms such as edge detection, etc.\nA statistical law called, Benford\u2019s Law [2]\u2013[5], has been\nused previously in accounting forensics to detect fraudulent\ndata by Nigirini [5]. Similarly, another study in the field of\npsychology noticed a peak at the digit 5 when people are\nasked to choose from a tampered set of data [6]. In recent\nyears it has attracted the attention of image processing experts.\nIn 2005, Acebo et al [7], showed how light intensity in an\nimage can be used to determine if an image is genuine or\ncomputer generated. Unlike [7], we have applied DWT before\ncalculating 1st digit probabilities and analysed images in the\nfrequency domain, which is better to separate edge details from\nlow frequencies. Similarly, Fu et al [8] have applied Benford\u2019s\nLaw on DCT coefficients in order to detect unknown JPEG\ncompression. In our previous work [9], we have analysed DWT\ncoefficients using Benford\u2019s Law and audited the processing\nhistory applied to JPEG2000 images. We have noticed a sharp\npeak at digit 5 in Benford\u2019s Law curve for some images, which\nbecame the basis for this paper.\nTherefore, we propose a novel use of the Benford\u2019s Law\nto identify unbalanced lighting in an image with the help of\nDWT. In this paper, we will analyse the irregularity in the\nBenford\u2019s Law curve that appears for images with a certain\nfeature. This feature is \u2018glare\u2019, when appeared in or near, a\nfield of view induces unbalanced light that makes an image\ncomparatively brighter in various parts. In effect, the image\nloses its visual quality. To determine if an image possesses\nunbalanced lighting, we will apply a single level of DWT\nto an image and compute its 1st digit probabilities of DWT\ncoefficients. Images with irregular Benford\u2019s Law curves are\nthen identified and analysed further. The divergence, adopted\nfrom Fu et al [8] and Acebo et al [7], which shows how much\nthe Benford\u2019s Law curve of an image deviates from the actual\nBenford\u2019s Law, is also calculated. Furthermore, the intensity\nhistogram, used for measuring the strength of gray levels in\nvarious sections of an image, will compare with its 1st digit\nprobabilities.\nThe rest of the paper is organised as follows: Section II, will\nbriefly describe Benford\u2019s Law, Discrete Wavelet Transform\nand intensity distribution for gray level images. Section III il-\nlustrates our proposed glare image detection method, followed\nby our experimental results and analysis in Section IV. This\nis followed by conclusion and future work in Section V.\nII. BACKGROUND\nA. Benford\u2019s Law\nBenford\u2019s Law, also known as the 1st digits law and sig-\nnificant digits law, was introduced by Frank Benford in 1938\n[3]. Then, Hill [4] expressed Benford\u2019s Law as a logarithmic\ndistribution, for analysis of the probability distribution of\nthe 1st digit (1 \u2212 9) of the number from natural data in\nstatistics. The distribution for Benford\u2019s Law can be expressed\nby Equation 1.\np (x) = log10\n(\n1 +\n1\nx\n)\n, x = 1, 2, ...9 (1)\nWhere x is the 1st digit of the number and p(x) is the\nprobability distribution of x. A typical probability distribution\nof Benford\u2019s Law is shown in Figure 1. Any peaks or irreg-\nularities in the curve mean that the data has been tampered\nwith or is unnatural [5], [6], [7].\nFig. 1. Probability Distribution of Benford\u2019s Law\nB. Discrete Wavelet Transform\nAs shown in Figure 2, Discrete Wavelet Transform (DWT)\ndecomposes an image into a power of single resolution levels\nby applying a collection of low-pass and high-pass filters onto\nthe image in vertical and horizontal directions. This resolution\nlevel consists of four sub-bands, which are Low Low (LL),\nLow High (LH), High Low (HL) and High High (HH).\nThe LL sub-band contains most energy and therefore can be\ndecomposed further [11]. The rest of the sub-bands contain\nedge details.\nLL LH\nHL HH\nFig. 2. DWT Decomposition\nC. Intensity Distribution\nDigital images (and particularly gray scale images) can be\ndescribed in finite terms and discrete quantities, which are\npixel and amplitude [12]. A pixel, which contains a gray level,\nis arranged into two dimensional orders to form a digital\nimage. The intensities are spread randomly over the entire\nimage. In order to calculate the strength of various intensity\nlevels or gray levels, a histogram is computed. As Gonzalez\nand Woods [12] discussed, the probability of occurrence of\nintensity level rk in an image is approximated by Equation 2.\npr(rk) =\nnk\nMN\n, k = 0, 1, 2, \u00b7 \u00b7 \u00b7 , L\u2212 1 (2)\nWhere M and N are the total number of pixel in an image,\nnk is the number of pixels that have intensity rk, and L is the\npossible intensity levels in the image (256 for 8 bit image).\nIII. PROPOSED METHOD\nIn this section, we explain the proposed glare image detec-\ntion process which uses the Benford\u2019s Law model. As shown\nin Figure 3, the test image is first decomposed into LL, LH, HL\nand HH sub-bands through single level DWT (2, 3 and 4 levels\nof DWT can also be applied, but could decrease the detection\nrates). In our experiment, we used the wavelet with Daubechies\n9\/7 filter, which is standard for lossy JPEG2000 compression.\nSecondly, the DWT coefficients of LH, HL and HH sub-bands\nare extracted (LL sub-band is not used as it contains highest\namount of energies and is more sensitive to low frequencies\n[11]), and then the probability distribution of the 1st digits of\nthese DWT coefficients is obtained by using the Benford\u2019s Law\nmodel, as shown in Equation 1. Finally, in order to detect glare,\nthese 1st digit probabilities undergo an image retrieval process,\nas per the pseudocode below.\nif p(x) < p(x+ 1) then\nThis 1st digit\u2019s probability does not obey Benford\u2019s Law\nThis image could have glare\nend if\nIn addition, with the purpose of further investigate the re-\nlationship between the 1st digit probability and intensity\ndistribution, the intensities of the image are calculated using\nEquation 2, which estimate the strength of gray levels present\nin an image in the spatial domain. Moreover, the divergence is\nalso calculated, which measures how much deviation of the 1st\ndigit probability graph from the actual Benford\u2019s Law curve.\nThe divergence adopted from Acebo et al [7] and Fu et al [8],\nis shown in Equation 3.\nx2 =\n9\u2211\ni=1\n(p\u2032i \u2212 pi)2\npi\n, i = 1, 2, \u00b7 \u00b7 \u00b7 9 (3)\nWhere p\u2032i is the actual 1\nst digit probability of the DWT\ncoefficients and pi is the Benford\u2019s Law from Equation 1.\nDWT\nImage \nRetrieval \nProcess\nImage Benford's \nLaw\nGlare Image\nFig. 3. Proposed glare image detection process\nIV. EXPERIMENTAL RESULTS AND ANALYSIS\nOur proposed glare image detection method has detected\n142 (128, 123 and 121 if 2, 3 and 4 levels of DWT applied,\nrespectively) out of 1338 images from UCID [10], which\nhad irregular Benford\u2019s Law curves. Figures 4(b) and 6(b)\nshow two irregular Benford\u2019s Law curves of images \u2018Statue\n1\u2019 (Figure 4(a) ) and \u2018Street\u2019 (Figure 6(a) ), which compared\nwith the actual Benford\u2019s Law curve. By comparing with\nthe regular Benford\u2019s Law curve of image \u2018Statue 2\u2019 (Figure\n5(a)) visually, the unbalance light caused by glare can also\nbe found from Figures 4(a) and 6(a)), which possesses extra\namount of brightness in some parts. Moreover, the intensity\ndistribution histograms of a normal image \u2018Statue 2\u2019, in Figure\n5(c), is somewhat smoother than the glare images \u2018Statue 1\u2019\nand \u2018Street\u2019, in Figures 4(c) and 6(c)).\nIn image \u2018Statue 1\u2019, due to its glare affect, the top boundary\nof the image can not be found visually, which also correlates\nwith its 1st digit probabilities, which do not obey Benford\u2019s\nLaw. Especially, its irregular peak at digit 5 in Figure 4(b),\nwhich is nearly five times higher. Similarly, the top right\nboundary of image \u2019Street\u2019 is also difficult to find visually\nand the amount of its unbalanced light is much less than the\nimage \u2018Statue 1\u2019. Furthermore, in Figure 6(b), the irregular\npeak at digit 5 from its 1st digit probabilities is only twice\nas high. In addition, the intensity distribution histogram in\nFigure 6(c), is smoother than image \u2018Statue 1\u2019 in Figure 4(c).\nTherefore, we conclude that the amount of unbalanced light\nin an image could affect the magnitude of the digit 5 in the\nprobabilities. In contrast, the distribution of gray levels in the\nintensity histogram in Figure 5(c) for image \u2018Statue 2\u2019, is\nspread across a wider range of gray levels smoothly. In Figure\n5(b), the image obeys Benford\u2019s Law and there appears to be\nno significant brightness in the image. The divergence between\nthese 1st digit probabilities and Benford\u2019s Law is shown in\nTable I.\nTABLE I\nDIVERGENCE FROM BENFORD\u2019S LAW CURVE\nImage Divergence\nStatue 1 1.7590\nStatue 2 0.0024\nStreet 0.0919\nFrom Table I, we observe that the divergence of image\n\u2018Statue 2\u2019 is showing the best fit to Benford\u2019s Law, at 0.0024.\nIn comparison, the worst fit at 1.759 is image \u2018Statue 1\u2019\nand followed by image \u2018Street\u2019 at 0.0919. Furthermore, by\ndeducing common artefacts that are present in both sets of\nimages that follow or do not follow Benford\u2019s Law, the only\nfeature left is glare (extra brightness). Hence, we can conclude\nthat the glare feature in an image results in an irregularity in\nits 1st digit probabilities.\nIn addition, we also simulated an attack by appending\nartificial glare into the images. The attack is implemented by\nusing \u201clens flare filter\u201d function with the brightness increased\nto 135% in Adobe Photoshop CS5 image editing software.\nFrom this experiment, the results showed that both regular\nand irregular 1st digit probabilities are not influenced by the\nartificial glare, and therefore our method could also identify\nwhether there is natural or artificial glare present in an image.\nV. CONCLUSION AND FUTURE WORK\nIn this paper, we presented a method of extracting images\nwith glare (such as unbalanced lighting) out of the bulk of im-\nages in DWT domain using Benford\u2019s Law. Any irregularities\nin an image could be detected as peaks via the Benford\u2019s Law\ncurves. The peaks were mainly located at digit 5. We found\nvia experiments that 142 images have this irregularity from\n1338 images, and the amount of glare feature (unbalanced\nlight) in an image could affect the magnitude of digit 5 in\n1st digit probabilities. In order to further analyse the irregular\nBenford\u2019s Law curve, the intensity distribution histogram of\ntest images was also calculated for comparison. We found\na good correlation between the 1st digit probabilities and\nintensity distribution of its gray level. The divergence was\nalso calculated between the 1st digit probability curve and\nBenford\u2019s Law, such as image \u2018Statue 2\u2019, at 0.0024. Our\nmethod could also identify whether there is natural or artificial\nglare present in an image. In future work, more tests will be\nperformed on images under different natural light conditions.\nFurther research with Fourier Transform instead of DWT for\ncomparative analysis will also be considered.\nACKNOWLEDGMENT\nGhulam Qadir would like to acknowledge the financial\nsupport of COMSATS Institute of Information Technology,\nIslamabad, Pakistan for the sponsorship of his PhD scholar-\nship.\nREFERENCES\n[1] Farid, H., A Survey of Image Forgery Detection, IEEE Signal Processing\nMagazine, Papers 26(2), pp. 16-25, 2009.\n[2] Newcomb, S., Note on the frequency of use of the different digits in\nNatural Numbers, American Journal of Mathematics, Papers 4(1), pp.\n39-40, 1881.\n[3] Benford, F., The law of anomalous numbers, Proc. Amer.Phil.Soc.78, pp.\n551-572, 1938.\n[4] Hill, T. P., A statistical derivation of the significant-digit law, Statistical\nScience, Papers (10), pp. 354-363, 1996.\n[5] Nigrini, M.J., I\u2019ve got your number, Journal of Accountancy, May, 1999.\n[6] Burns, B. D., Sensitivity to Statistical Regularities: People (Largely)\nFollow Benford\u2019s Law, in: N.Taatgen and H.Van Rijn (eds.), Proc. Thirty-\nFirst Annual Conference of the Cognitive Science Society, Cognitive\nScience Society, Austin, TX, pp. 28722877, 2009.\n[7] Acebo, E. and Sbert, M., Benford\u2019s law for natural and synthetic images,\nComputational Aestetics in Graphics, Visualizations and Imaging, 2005.\n[8] Fu, D., Shi, Y. Q. and Su, Q., A generalized Benford\u2019s Law for JPEG\ncoefficients and its applications in image forensics, Proc. SPIE 6506,\n1L1-1L11, 2007.\n[9] Qadir, G., Zhao, X., and Ho, A. T. S., Estimating JPEG2000 compression\nfor image forensics using Benford\u2019s Law, Proc. SPIE 7723, 77230J, 2010.\n[10] Schaefer, G. and Stich, M., UCID - An Uncompressed Colour Image\nDatabase, Proc. SPIE, Storage and Retrieval Methods and Applications\nfor Multimedia 2004, pp. 472-480, San Jose, USA.\n[11] Farid, H., and Lyu, Siwei., Higher-order wavelet Statistics and their\nApplication to Digital Forensics, Proc. IEEE Workshop on Statistical\nAnalysis in Computer Vision, 2003.\n[12] Gonzalez, R. C., and Woods, R. E., Digital Image Processing, Pearson\nPrentice Hall, 2008.\n(a)\n0 1 2 3 4 5 6 7 8 9 10\n0\n0.05\n0.1\n0.15\n0.2\n0.25\n0.3\n0.35\n0.4\n0.45\n1st Digits\nPr\nob\nab\nilit\nie\ns\n \n \nSingle Level DWT\nBenford\u2019s Law\n(b)\n0 50 100 150 200 250\n0\n0.05\n0.1\n0.15\n0.2\n0.25\n0.3\n0.35\n0.4\n0.45\n(c)\nFig. 4. (a) Statue 1, (b) 1st digit probabilities & Benford\u2019s Law, (c) Probability Histogram\n(a)\n0 1 2 3 4 5 6 7 8 9 10\n0\n0.05\n0.1\n0.15\n0.2\n0.25\n0.3\n0.35\n0.4\n0.45\n1st Digits\nPr\nob\nab\nilit\nie\ns\n \n \nSingle Level DWT\nBenford\u2019s Law\n(b)\n0 50 100 150 200 250\n0\n0.05\n0.1\n0.15\n0.2\n0.25\n0.3\n0.35\n0.4\n0.45\n(c)\nFig. 5. (a) Statue 2, (b) 1st digit probabilities & Benford\u2019s Law, (c) Probability Histogram\n(a)\n0 1 2 3 4 5 6 7 8 9 10\n0\n0.05\n0.1\n0.15\n0.2\n0.25\n0.3\n0.35\n0.4\n0.45\n1st Digits\nPr\nob\nab\nilit\nie\ns\n \n \nSingle Level DWT\nBenford\u2019s Law\n(b)\n0 50 100 150 200 250\n0\n0.05\n0.1\n0.15\n0.2\n0.25\n0.3\n0.35\n0.4\n0.45\n(c)\nFig. 6. (a) Street, (b) 1st digit probabilities & Benford\u2019s Law, (c) Probability Histogram\n"}