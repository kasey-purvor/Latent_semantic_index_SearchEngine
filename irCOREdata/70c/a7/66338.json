{"doi":"10.1016\/S0166-218X(02)00251-2","coreId":"66338","oai":"oai:dro.dur.ac.uk.OAI2:1910","identifiers":["oai:dro.dur.ac.uk.OAI2:1910","10.1016\/S0166-218X(02)00251-2"],"title":"Finding paths in graphs avoiding forbidden transitions.","authors":["Szeider, S."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2003-03-15","abstract":"Let v be a vertex of a graph G; a transition graph T(v) of v is a graph whose vertices are the edges incident with v. We consider graphs G with prescribed transition systems T={T(v) | vV(G)}. A path P in G is called T-compatible, if each pair uv,vw of consecutive edges of P form an edge in T(v). Let  be a given class of graphs (closed under isomorphism). We study the computational complexity of finding T-compatible paths between two given vertices of a graph for a specified transition system  . Our main result is that a dichotomy holds (subject to the assumption P\u2260NP). That is, for a considered class  , the problem is either (1) NP-complete, or (2) it can be solved in linear time. We give a criterion\u2014based on vertex induced subgraphs\u2014which decides whether (1) or (2) holds for any given class","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/66338.pdf","fullTextIdentifier":"http:\/\/dro.dur.ac.uk\/1910\/1\/1910.pdf","pdfHashValue":"294432aa0ed30238b3b3065aaf1920e9335bd4b7","publisher":"Elsevier","rawRecordXml":"<record><header><identifier>\n  \n    \n      oai:dro.dur.ac.uk.OAI2:1910<\/identifier><datestamp>\n      2016-10-03T09:59:47Z<\/datestamp><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        Finding paths in graphs avoiding forbidden transitions.<\/dc:title><dc:creator>\n        Szeider, S.<\/dc:creator><dc:description>\n        Let v be a vertex of a graph G; a transition graph T(v) of v is a graph whose vertices are the edges incident with v. We consider graphs G with prescribed transition systems T={T(v) | vV(G)}. A path P in G is called T-compatible, if each pair uv,vw of consecutive edges of P form an edge in T(v). Let  be a given class of graphs (closed under isomorphism). We study the computational complexity of finding T-compatible paths between two given vertices of a graph for a specified transition system  . Our main result is that a dichotomy holds (subject to the assumption P\u2260NP). That is, for a considered class  , the problem is either (1) NP-complete, or (2) it can be solved in linear time. We give a criterion\u2014based on vertex induced subgraphs\u2014which decides whether (1) or (2) holds for any given class.<\/dc:description><dc:subject>\n        Compatible path<\/dc:subject><dc:subject>\n         Transition<\/dc:subject><dc:subject>\n         Edge-colored graph<\/dc:subject><dc:subject>\n         Forbidden pairs<\/dc:subject><dc:subject>\n         NP-Completeness<\/dc:subject><dc:subject>\n         Linear time algorithm.<\/dc:subject><dc:publisher>\n        Elsevier<\/dc:publisher><dc:source>\n        Discrete applied mathematics, 2003, Vol.126(2-3), pp.261-273 [Peer Reviewed Journal]<\/dc:source><dc:date>\n        2003-03-15<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:identifier>\n        dro:1910<\/dc:identifier><dc:identifier>\n        issn:0166-218X<\/dc:identifier><dc:identifier>\n        doi:10.1016\/S0166-218X(02)00251-2<\/dc:identifier><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/1910\/<\/dc:identifier><dc:identifier>\n        http:\/\/dx.doi.org\/10.1016\/S0166-218X(02)00251-2<\/dc:identifier><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/1910\/1\/1910.pdf<\/dc:identifier><dc:accessRights>\n        info:en-repo\/semantics\/openAccess<\/dc:accessRights><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["issn:0166-218X","0166-218x"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2003,"topics":["Compatible path","Transition","Edge-colored graph","Forbidden pairs","NP-Completeness","Linear time algorithm."],"subject":["Article","PeerReviewed"],"fullText":"Durham Research Online\nDeposited in DRO:\n14 October 2008\nVersion of attached file:\nAccepted Version\nPeer-review status of attached file:\nPeer-reviewed\nCitation for published item:\nSzeider, S. (2003) \u2019Finding paths in graphs avoiding forbidden transitions.\u2019, Discrete applied mathematics.,\n126 (2-3). pp. 261-273.\nFurther information on publisher\u2019s website:\nhttp:\/\/dx.doi.org\/10.1016\/S0166-218X(02)00251-2\nPublisher\u2019s copyright statement:\nAdditional information:\nUse policy\nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without prior permission or charge, for\npersonal research or study, educational, or not-for-profit purposes provided that:\n\u2022 a full bibliographic reference is made to the original source\n\u2022 a link is made to the metadata record in DRO\n\u2022 the full-text is not changed in any way\nThe full-text must not be sold in any format or medium without the formal permission of the copyright holders.\nPlease consult the full DRO policy for further details.\nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom\nTel : +44 (0)191 334 3042 \u2014 Fax : +44 (0)191 334 2971\nhttp:\/\/dro.dur.ac.uk\n Use policy \n \nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without \nprior permission or charge, for personal research or study, educational, or not-for-profit purposes \nprovided that : \n \n\u0083 a full bibliographic reference is made to the original source \n\u0083 a link is made to the metadata record in DRO \n\u0083 the full-text is not changed in any way \n \nThe full-text must not be sold in any format or medium without the formal permission of the copyright \nholders.  \n \nPlease consult the full DRO policy for further details. \n \nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom \nTel : +44 (0)191 334 2975 | Fax : +44 (0)191 334 2971 \nhttp:\/\/dro.dur.ac.uk \nDurham Research Online \n Deposited in DRO:\n14 October 2008\nVersion of attached file:\nAccepted\nPeer-review status of attached file:\nPeer-reviewed\nCitation for published item:\nSzeider, S. (2003) 'Finding paths in graphs avoiding forbidden transitions.', Discrete applied mathematics.,\n126 (2-3), pp.\u0000261-273.\nFurther information on publishers website:\nhttp:\/\/dx.doi.org\/10.1016\/S0166-218X(02)00251-2\nPublishers copyright statement:\nThe original publication is available at www.springerlink.com\nFinding paths in graphs avoiding\nforbidden transitions\nStefan Szeider 1\nInstitute of Discrete Mathematics, Austrian Academy of Sciences,\nSonnenfelsgasse 19, A\u20131010 Vienna, Austria\nAbstract\nLet v be a vertex of a graph G; a transition graph T (v) of v is a graph whose vertices\nare the edges incident with v. We consider graphs G with prescribed transition\nsystems T = { T (v) | v \u2208 V (G) }. A path P in G is called T -compatible, if each\npair uv, vw of consecutive edges of P form an edge in T (v). Let A be a given class\nof graphs (closed under isomorphism). We study the computational complexity of\nfinding T -compatible paths between two given vertices of a graph for a specified\ntransition system T \u2286 A. Our main result is that a dichotomy holds (subject to\nthe assumption P 6= NP). That is, for a considered class A, the problem is either\n(1) NP-complete, or (2) it can be solved in linear time. We give a criterion\u2014based\non vertex induced subgraphs\u2014which decides whether (1) or (2) holds for any given\nclass A.\nKey words: Transition, compatible path, complexity, NP-completeness, linear\ntime algorithm, edge-colored graph, forbidden pairs.\n1 Introduction\nA transition in a graph is a pair of adjacent edges. We consider the problem\nof finding paths between two given vertices avoiding forbidden transitions (or\nequivalently, paths that use only allowed transitions); such paths are called\ncompatible. For a vertex v, the set of allowed transitions define a graph T (v)\non the set of edges incident with v; the graph T (v) is called the transition\ngraph of v.\nIf, for example, all transition graphs are cliques, then the compatible-path-\nproblem is trivial, since every path is compatible. It is natural to ask for the\n1 This work has been supported by the Austrian Science Fund, P13417-MAT\n1\ncomputational complexity of the compatible-path-problem with respect to a\ngiven class A of transition graphs. We give a complete answer to this question\nshowing that\u2014with respect to a given class A\u2014the problem is either\n(1) NP-complete, or\n(2) can be solved in linear time\n(both cases exclude each other if P 6= NP holds). We supply a \u2018forbidden\ninduced subgraph\u2019-criterion which decides whether (1) or (2) prevails. For the\nlinear time cases we present algorithms which not only decide existence but\nactually find a compatible path (if one exists) in linear time.\nIn the final section we give an application of our linear time results to the\nproblem of finding alternating paths in edge-colored graphs and extend a result\nby Bang-Jensen and Gutin [1].\nOur work is closely related to [10], where the complexity of finding compatible\n2-factors is studied. Compatible paths and cycles have been intensively studied\nin the context of eulerian graphs (see [5] for a survey on this topic).\n2 Basic notions and notation\nFor graph theoretic terminology not defined in this paper, the reader is referred\nto [3]. All graphs considered are finite and simple. The set of vertices and the\nset of edges of a graph G are denoted by V (G) and E(G), respectively. For\na vertex v \u2208 V (G) we write EG(v) for the set of all edges of G which are\nincident with v. The degree of a vertex v is denoted by d(v); for d \u2265 0 we put\nVd(G) := { v \u2208 V (G) | d(v) = d }. We write H \u2264 G if H is a vertex-induced\nsubgraph of G.\nLet G be a graph. A transition graph T (v) of a vertex v \u2208 V (G) is some graph\nwhose vertices are the edges ofG incident to v; i.e., V (T (v)) = EG(v). A system\nof allowed transitions (or transition system, for short) T is a set { T (v) | v \u2208\nV (G) } where T (v) is a transition graph of v. A path P = v0, e1, v1, . . . , ek, vk\nin G is T -compatible if eiei+1 \u2208 E(T (vi)) for every 1 \u2264 i \u2264 k \u2212 1.\nInstead of specifying allowed transitions we could also specify explictly the\nforbidden transitions by defining F (v) to be the compliment graph of T (v);\nthis approach has been pursued, e.g., in [7,6,5]. However, we consider allowed\ntransitions in order to be consistent with a closely related work by Kratochv\u00b4\u0131l\nand Poljak [10], who studied the complexity of finding compatible 2-factors.\n2\nP3 K3 K2 + K2 P4 L4\nFig. 1.\nLetA be a class of graphs closed under isomorphism. We consider the following\nproblem.\nA-COMPATIBLE PATH (or A-CP for short)\nInstance: a graph G with transition system T \u2286 A, two distinct vertices\nx, y \u2208 V (G).\nQuestion: is there a T -compatible path from x to y?\nObviously, this problem is in NP.\nWe refer by P3, K3, K2 +K2, P4, and L4 (the lollipop graph on four vertices)\nto the graphs depicted in Figure 1; the closure of a class A of graphs by taking\nvertex-induced subgraphs is denoted by Aind. Now we can formulate our main\nresult.\nTheorem 1 The problem A-CP is NP-complete if Aind contains at least one\nof the sets\n{P3, K2 +K2}, {K3, K2 +K2}, {P4}, {L4};\nin all other cases the problem is solvable in linear time.\n3 NP-completeness results\nThe following proposition is the key for our NP-completeness results. In its\nproof we use an intermediary reduction of 3-SAT (which is well-known to be\nNP-complete, see e.g., [9]) to the problem of finding paths in graphs avoiding\nforbidden pairs of vertices (i.e., paths that use at most one vertex of each\nprescribed forbidden pair). This reduction is based on a construction by Gabow\net.al. [8]; however, to obtain our results we must proceed more painstakingly\nthan in [8]. (We note in passing that in [8] the quoted NP-completeness result\nis formulated for directed graphs; though it is easy to observe that it applies\nas well to the same problem for undirected graphs. Garey and Johnson [9,\nProblem GT53, p. 203] quote only the directed version of the problem.)\nIf X1, . . . , Xk are graphs, then we write \u3008X1, . . . , Xk\u3009 for the smallest class of\ngraphs closed under isomorphism containing X1, . . . , Xk.\n3\ns1\ns2\ns3t1\nt2\nt3\nt\u22171 t\n\u2217\n2s\n\u2217\n2 s\n\u2217\n3\nv1,1\nv1,2\nv1,3\nv2,1\nv2,2\nv2,3\nv3,1\nv3,2\nv3,3\nFig. 2. The graph G obtained from a set of three clauses (cf. the proof of Proposi-\ntion 2).\nProposition 2 The problems \u3008K3, K2 +K2\u3009-CP and \u3008P3, K2 +K2\u3009-CP are\nNP-complete. In particular, these problems remain NP-complete if we consider\nonly instances (G, T, x, y) such that\n\u2022 x, y \u2208 V3(G),\n\u2022 there is matching M with V (M) = V3(G) \\ {x, y}, and\n\u2022 for every v \u2208 V3(G) with EG(v) = {e1, e2, eM} and eM \u2208 M we have\ne1eM , e2eM \u2208 E(T (v)).\nPROOF. First we show that 3-SAT reduces polynomially to \u3008K3, K2+K2\u3009-\nCP; in symbols,\n3-SAT \u221d \u3008K3, K2 +K2\u3009-CP. (1)\nLet A be a set of boolean variables and \u03d5 = {C1, . . . , Cn} a collection of\nclauses (i.e., sets of literals) over A such that for 1 \u2264 i \u2264 n the clause Ci is of\nthe form {xi,1, xi,2, xi,3} for three distinct literals xi,j, 1 \u2264 j \u2264 3. We think of\n\u03d5 as a boolean formula in conjunctive normal form. We may assume that no\nclause of \u03d5 contains both x and x for any literal x, and that \u03d5 has no pure\nliterals (literals that occur only positively or only negatively).\nFor each clause Ci we construct a graph Gi with V (Gi) = {si, ti, vi,1, vi,2, vi,3}\nand E(Gi) =\n\u22c33\nj=1{sivi,j, vi,jti} (we assume that V (Gi) and V (Gi\u2032) are disjoint\nfor i 6= i\u2032). For i = 1, . . . , n \u2212 1 we subdivide the edge vi,1ti by introducing\na new vertex t\u2217i and similarly, for i = 2, . . . , n we subdivide the edge sivi,1\nby introducing a new vertex s\u2217i . Let G\n\u2217\ni denote the graph obtained by this\nconstruction. Now we join the graphs G\u22171, . . . , G\n\u2217\nn by adding edges t\n\u2217\ni s\n\u2217\ni+1, i =\n1, . . . , n\u22121, and denote the obtained graph by G (for an example see Figure 2).\nWe call a pair of vertices {vi,j, vi\u2032,j\u2032} forbidden if xi,j = xi\u2032,j\u2032 holds for the\ncorresponding literals in \u03d5; let F be the set of all forbidden pairs. An s1\u2013tn\npath P in G is called satisfying if V (P ) does not contain both vertices of\nsome forbidden pair. It is easy to check that to every truth assignment which\nsatisfies \u03d5 there corresponds a satisfying path in G, and vice versa. Since \u03d5\ncontains no pure literals, each vertex vi,j (1 \u2264 i \u2264 n, 1 \u2264 j \u2264 3) is contained\nin at least one forbidden pair.\nNext we modify G and F such that each vertex is contained in at most one\nforbidden pair. Assume that a vertex v is contained in q > 1 forbidden pairs,\nsay {v, vi}, for i = 1, . . . , q. Let u, u\n\u2032 be the two vertices adjacent with v. We\n4\nremove v from G and add instead a u\u2013u\u2032 path of length q+1 introducing new\nvertices w1, . . . , wq. For i = 1, . . . , q we replace the forbidden pair {v, vi} by\n{wi, vi}. We repeat this construction for all vertices contained in more than\none forbidden pair and denote the resulting graph and the new set of forbidden\npairs by G\u2032 and F \u2032, respectively. It still holds that G\u2032 contains a satisfying path\nif and only if G contains a satisfying path. Note that all vertices of G\u2032 have\ndegree 2 or 3; if d(v) = 2 then v is contained in exactly one pair of F \u2032; if\nd(v) = 3, then v \u2208 {si, ti, s\n\u2217\ni , t\n\u2217\ni } for some 1 \u2264 i \u2264 n.\nLet G\u2217 be the graph obtained by identifying vertices which form a forbidden\npair; i.e., if {v1, v2} \u2208 F\n\u2032, EG\u2217(v1) = {e1, f1}, and EG\u2217(v2) = {e2, f2}, then we\nremove v1, v2, and make e1, e2, f1, f2 incident with a new vertex v1,2. Note that\nall vertices in the new graph G\u2217 have degree 3 or 4. For each new vertex v1,2\nwe define a transition graph T \u2217(v1,2) \u2208 \u3008K2 + K2\u3009 by setting E(T\n\u2217(v1,2)) :=\n{e1f1, e2f2}; for the remaining vertices of G\n\u2217 we choose T \u2217(v) \u2208 \u3008K3\u3009. We have\ndefined a transition system T \u2217 = { T \u2217(v) | v \u2208 V (G\u2217) } \u2286 \u3008K3, K2 +K2\u3009.\nIt is easy to verify that a satisfying path in G\u2032 corresponds to a T \u2217-compatible\ns1\u2013tn path in G\n\u2217, and vice versa. Since our constructions can be carried out\nin polynomial time, (1) follows.\nNext we show that we can replace T \u2217 by a transition system T \u2217\u2217 \u2286 \u3008P3, K2 +\nK2\u3009. For all v \u2208 V4(G\n\u2217) we put T \u2217\u2217(v) := T \u2217(v). Since the transition graphs of\ns1 and tn are irrelevant with respect to compatible s1\u2013tn paths, we can choose\nT \u2217\u2217(s1), T\n\u2217\u2217(tn) \u2208 \u3008P3\u3009 arbitrarily. For each vertex v \u2208 V3(G\n\u2217) \\ {s1, tn} we\nselect one of its incident edges hv:\nv = si \u21d2 hv := sis\n\u2217\ni (2 \u2264 i \u2264 n)\nv = s\u2217i \u21d2 hv := s\n\u2217\ni t\n\u2217\ni\u22121 (2 \u2264 i \u2264 n)\nv = ti \u21d2 hv := tit\n\u2217\ni (1 \u2264 i \u2264 n\u2212 1)\nv = t\u2217i \u21d2 hv := t\n\u2217\ni s\n\u2217\ni+1 (1 \u2264 i \u2264 n\u2212 1).\nWe observe that for every T \u2217\u2217-compatible s1\u2013tn path P in G\n\u2217 and v \u2208 V3(G\n\u2217)\\\n{s1, tn} it follows that\nv \u2208 V (P ) implies hv \u2208 E(P ). (2)\nFor v \u2208 V3 \\ {s1, tn} with EG\u2217(v) = {e, f, hv} we put\nE(T \u2217\u2217(v)) := {ehv, fhv}.\nBy (2) it follows that every T \u2217-compatible s1\u2013tn path is also T\n\u2217\u2217-compatible;\nthe converse holds trivially. Since T \u2217\u2217 \u2286 \u3008P3, K2 +K2\u3009 by definition, we have\nshown that\n\u3008K3, K2 +K2\u3009-CP \u221d \u3008P3, K2 +K2\u3009-CP.\n5\nv0\ne4\ne3\ne1\ne2\n\u21d2\nv1,4\nv2,3\nw\u2032\nu4\nu3\ne4\ne3\ng4\ng3\nf4\nf3\nw\nu1\nu2\ne1\ne2\ng1\ng2\nf1\nf2\nFig. 3. Illustration of Construction 1\nThus, the first statement of the proposition holds. Note that\nM = { tit\n\u2217\ni | 1 \u2264 i \u2264 n\u2212 1 } \u222a { sis\n\u2217\ni | 2 \u2264 i \u2264 n }\nis a matching in G\u2217. Hence it is easy to check that the instances obtained by\nthe above constructions satisfy the second statement of the proposition. \u0003\nIn view of the proof of the preceding proposition, K3 and P3 can be considered\nas \u2018branching\u2019 transition graphs, whereas K2 +K2 as an \u2018exclusive\u2019 transition\ngraph. It turns out, that in all NP-complete cases of A-CP, A must contain\nboth, branching transition graphs and exclusive transition graphs. Lemma 3\nbelow shows that any graph on four vertices containing K3 or P3 as vertex-\ninduced subgraph can be used as branching transition graph. On the other\nhand, Lemma 4 shows that P4 and L4 are exclusive transition graphs. Finally,\nLemma 6 shows that any graph containing K3 or P3 (respectively, K2 +K2,\nP4, or L4) as vertex-induced subgraph can be used as branching (respectively,\nexclusive) transition graph.\nNext we define a construction which we shall use several times in subsequent\nproofs.\nConstruction 1 Let G be a graph and v0 a vertex of G with EG(v0) =\n{e1, . . . , e4}. We obtain a graph G\n\u2032 as follows (see Figure 3 for an illustration).\nWe split v0 into vertices v1,4 and v2,3 such that e1, e4 are incident with v1,4\nand e2, e3 are incident with v2,3. We add new vertices w, w\n\u2032 and the edges\nf1 = v1,4w, f2 = wv2,3, f3 = v2,3w\n\u2032, and f4 = w\n\u2032v1,4. Now we take two copies\nof K5 (say K5 and K\n\u2032\n5) and remove one edge of each copy. Now each copy\nhas two vertices of degree 3, say u1, u2 and u3, u4, respectively. We add edges\ng1 = u1w, g2 = u2w, g3 = u3w\n\u2032, g4 = u4w\n\u2032, and denote the new graph by G\u2032.\nNote that all vertices in V (G\u2032) \\ V (G) have degree 4.\n6\nLemma 3 Let Z be a graph with at most four vertices such that K3 \u2264 Z or\nP3 \u2264 Z. Then \u3008Z,K2 +K2\u3009-CP is NP-complete.\nPROOF. Let X \u2208 {K3, P3} such that X \u2264 Z. If |V (Z)| = 3, then the\nlemma follows directly from Proposition 2; hence assume |V (X)| = 4. Writing\n\u3008X,K2 +K2\u3009-CP* for the problem \u3008X,K2 +K2\u3009-CP restricted to instances\nwhich satisfy the additional properties stated in the second claim of Proposi-\ntion 2, we show that\n\u3008X,K2 +K2\u3009-CP* \u221d \u3008Z,K2 +K2\u3009-CP. (3)\nLet (G, T, x, y) be an instance of \u3008X,K2 +K2\u3009-CP* and M a matching of G\naccording to Proposition 2. We apply local replacements to eliminate succes-\nsively vertices whose transition graph is in \u3008Z\u3009.\nLet eM = vv\n\u2032 \u2208M with EG(v) = {e1, e4, eM} and EG(v\n\u2032) = {e2, e3, eM}. Note\nthat\ne1eM , e4eM \u2208 E(T (v)) and e2eM , e3eM \u2208 E(T (v\n\u2032)). (4)\nWe remove eM from G and identify v and v\n\u2032, denoting the vertex obtained by\nidentifying v and v\u2032 by v0. Now we apply Construction 1 w.r.t. v0 and obtain a\ngraph G\u2032. A transition system T \u2032 of G\u2032 can be defined as follows. For the new\nvertices v \u2208 V (G\u2032) \\ V (G) we choose transition graphs from \u3008Z\u3009 such that\ne1f1, e4f1 \u2208 E(T\n\u2032(v1,4)),\nf2e2, f2e3 \u2208 E(T\n\u2032(v2,3)),\nf1f2 \u2208 E(T\n\u2032(w)).\nFor the remaining vertices v we put T \u2032(v) = T (v). In view of (4), we observe\nthat G contains a T -compatible x\u2013y path if and only if G\u2032 contains a T \u2032-com-\npatible x\u2013y path. We apply this construction for each eM \u2208 M and end up\nwith a graph G\u2032\u2032 and a transition system T \u2032\u2032 such that T \u2032\u2032(v) \u2208 \u3008Z,K2 +K2\u3009\nfor all v \u2208 V (G\u2032\u2032) \\ {x, y}, and T \u2032\u2032(z) \u2208 \u3008X\u3009 for z \u2208 {x, y}. Hence it remains\nto alter the transition graphs of x and y.\nLet G\u2032\u20321 be a disjoint copy G\n\u2032\u2032, where x1, y1 \u2208 V (G\n\u2032\u2032\n1) are the vertices which\ncorrespond to x, y \u2208 V (G\u2032\u2032), respectively. Further, let T \u2032\u20321 be the transition\nsystem of G\u2032\u20321 that works on G\n\u2032\u2032\n1 exactly as T\n\u2032\u2032 works on G\u2032\u2032. We obtain a\ngraph H from the union of G\u2032\u2032 and G\u2032\u20321 by adding edges xx1 and yy1. For\nz \u2208 {x, y} (respectively, z \u2208 {x1, y1}) we choose TH(z) \u2208 \u3008Z\u3009 such that\nT \u2032\u2032(z) \u2264 TH(z) (respectively, T\n\u2032\u2032\n1 (z) \u2264 TH(z)). For all other vertices v of H\nwe keep the inherited transition graphs from T \u2032\u2032 or T \u2032\u20321 , i.e., TH(v) = T\n\u2032\u2032(v)\nor TH(v) = T\n\u2032\u2032\n1 (v). By construction, TH \u2286 \u3008Z,K2 + K2\u3009. It is easy to check\nthat H contains a TH -compatible x\u2013y path if and only if G\n\u2032\u2032 contains a T \u2032\u2032-\n7\ncompatible x\u2013y path. Hence (3) holds. Since \u3008X,K2+K2\u3009-CP* is NP-complete\nby Proposition 2, the lemma now follows. \u0003\nLemma 4 Let Z be a graph with at most four vertices such that K3 \u2264 Z or\nP3 \u2264 Z. The problems \u3008Z, P4\u3009-CP and \u3008Z,L4\u3009-CP are NP-complete.\nPROOF. We show that\n\u3008Z,K2 +K2\u3009-CP\u221d\u3008Z, P4\u3009-CP, and (5)\n\u3008Z, P4\u3009-CP\u221d\u3008Z,L4\u3009-CP. (6)\nLet (G, T, x, y) be an instance of \u3008Z,K2 +K2\u3009-CP. If the transition graph of\nx or y is isomorphic to K2 + K2, then we can replace it by some transition\ngraph isomorphic to P4 without effect to the existence of compatible x\u2013y paths.\nHence we have only to consider v0 \u2208 V (G) \\ {x, y} with T (v0) \u2208 \u3008K2 +K2\u3009.\nLet E(T (v0)) = {e1e2, e3e4}. We apply Construction 1 w.r.t. v0 and obtain a\ngraph G\u2032. The transition graphs of the new vertices can be chosen from \u3008P4\u3009\nsuch that f1f2 \u2208 E(T\n\u2032(w)), f3f4 \u2208 E(T\n\u2032(w\u2032)), and\nE(T \u2032(v1,4)) = {e1f1, f1f4, f4e4},\nE(T \u2032(v2,3)) = {e2f2, f2f3, f3e3}.\nFor the remaining vertices v \u2208 V (G)\\V (G\u2032) we put T \u2032(v) = T (v). We observe\nthat there is a T -compatible x\u2013y path in G if and only if there is a T \u2032-com-\npatible x\u2013y path in G\u2032. By multiple applications of this construction we can\neliminate successively all vertices v with T (v) \u2208 \u3008K2 +K2\u3009 such that we end\nup with an instance (G\u2032\u2032, T \u2032\u2032, x, y) of \u3008Z, P4\u3009-CP. Obviously, this construction\ncan be carried out in polynomial time, whence (5) follows.\nFor (6) we proceed likewise. Let (G, T, x, y) be an instance of \u3008Z, P4\u3009-CP.\nAgain, we replace the transition graphs of x or y by graphs from \u3008L4\u3009, if\nnecessary. Now consider some v0 \u2208 V (G) \\ {x, y} with T (v0) \u2208 \u3008P4\u3009, say\nE(T (v0)) = {e1e2, e1e3, e3e4}. As above, we construct a graph G\n\u2032 applying\nConstruction 1 and we define a transition system T \u2032 for G\u2032 as follows. For the\nnew vertices v \u2208 V (G\u2032) \\ V (G) we choose transition graphs from \u3008L4\u3009 such\nthat f1f2 \u2208 E(T\n\u2032(w)), f3f4 \u2208 E(T\n\u2032(w\u2032)), and\nE(T \u2032(v1,4)) = {e1f1, f1f4, f4e4, e1f4},\nE(T \u2032(v2,3)) = {e2f2, f2f3, f3e3, e3f2}.\nFor the remaining vertices v \u2208 V (G) \\ V (G\u2032) we put T \u2032(v) = T (v). Again, it\ncan be verified that there is a T -compatible x\u2013y path in G if and only if there\n8\nis a T \u2032-compatible x\u2013y path in G\u2032. Charring out the above construction for\nevery v \u2208 V (G) \\ {x, y} with T (v) \u2208 \u3008P4\u3009 we obtain an instance (G\n\u2032\u2032, T \u2032\u2032, x, y)\nof \u3008Z,L4\u3009-CP; whence (6) holds true. In view of Lemma 3 and (5), the result\nnow follows. \u0003\nIn order to show Lemma 6 below, we need the following result, which is based\non an observation by Fleischner [4].\nLemma 5 Let n, k be positive integers with n > k and n \u2261 k (mod 2). Then\nthere is a graph Gn,k and v\n\u2217 \u2208 V (Gn,k) such that\n(1) d(v) = n for all v \u2208 V (Gn,k) \\ {v\n\u2217},\n(2) d(v\u2217) = k, and\n(3) |V (Gn,k)| \u2264 2n+ 2.\nPROOF. Case 1: k is even (n may be even or odd). Take Kn+1 and a\nmatchingM \u2286 E(Kn+1) of size k\/2. Subdivide the edges inM and identify the\nnew vertices. The graph obtained by this construction has obviously properties\n1\u20133.\nCase 2 : both n and k are odd. If k = 1 we obtain Gn,n\u22121 by the above\nconstruction; let u\u2217 \u2208 V (Gn,n\u22121) with d(u\n\u2217) = n \u2212 1. Add a new vertex v\u2217\nand the edge v\u2217u\u2217. Again we have constructed a graph Gn,k with the claimed\nproperties. Now assume k > 1. By the construction applied in Case 1 we obtain\n(disjoint) graphs Gn,k\u22121 and Gn,n\u22121. Let v\n\u2217 \u2208 V (Gn,k\u22121) and u\n\u2217 \u2208 V (Gn,n\u22121)\nwith d(v\u2217) = k\u22121 and d(u\u2217) = n\u22121, respectively. We connect the two graphs\nby adding the edge v\u2217u\u2217. The obtained graph satisfies properties 1\u20133 as well,\nwhence the lemma is shown true. \u0003\nNote that if k is odd and n > k is even, then a graph Gn,k cannot exist (by the\nHandshaking Lemma, the number of vertices of odd degree is always even).\nTherefore, in the proof of the next lemma, we have to apply Lemma 3 as an\nintermediate step before we can apply the above construction.\nLemma 6 Let X \u2208 {K3, P3}, Y \u2208 {K2 +K2, P4, L4} and A a class of graphs\nclosed under isomorphism such that X, Y \u2208 Aind. Then Aind-CP is NP-com-\nplete.\nPROOF. Let X \u2032, Y \u2032 \u2208 A such that X \u2264 X \u2032 and Y \u2264 Y \u2032. If X = X \u2032, then\nlet Z := X; otherwise, let Z be a graph with |V (Z)| = 4 and X \u2264 Z \u2264 X \u2032.\nWe show that\n\u3008Z, Y \u3009-CP \u221d \u3008X \u2032, Y \u2032\u3009-CP. (7)\n9\nLet (G, T, x, y) be an instance of \u3008Z, Y \u3009-CP. Consider v0 \u2208 V (G) with T (v0) \/\u2208\n\u3008X \u2032, Y \u2032\u3009 (consequently d(v0) = 4). In order to assign to v0 a transition graph\nwhich belongs to \u3008X \u2032, Y \u2032\u3009, we have to increase its degree first. If T (v0) \u2208 \u3008Z\u3009,\nthen we put n := |V (X \u2032)|, otherwise we put n := |V (Y \u2032)|. Next we take Gn,n\u22124\n(see Lemma 5) with v\u2217 \u2208 V (Gn,n\u22124), d(v\n\u2217) = n\u2212 4, and we obtain a graph G\u2032\nfrom G by adding Gn,n\u22124 and identifying v\n\u2217 and v0. Let v\n\u2217\n0 denote the vertex\nobtained by identification of v\u2217 and v0 (thus d(v\n\u2217\n0) = n follows). We define\na transition system T \u2032 of G\u2032: if T (v0) \u2208 \u3008Z\u3009, then we choose T\n\u2032(v\u22170) \u2208 \u3008X\n\u2032\u3009,\notherwise we choose T \u2032(v\u22170) \u2208 \u3008Y\n\u2032\u3009; in any case we assure T (v0) \u2264 T\n\u2032(v\u22170); for\nv \u2208 V (G) \u2229 V (G\u2032) we put T \u2032(v) := T (v), and for v \u2208 V (Gn,n\u22124) \\ {v\n\u2217} we\nchoose T \u2032(v) \u2208 \u3008T (v\u22170)\u3009 arbitrarily.\nApplying this construction to all vertices of G whose transition graph is not\ncontained in \u3008X \u2032, Y \u2032\u3009, we end up with an instance (G\u2032\u2032, T \u2032\u2032, x\u2032\u2032, y\u2032\u2032) of \u3008X \u2032, Y \u2032\u3009-\nCP such that G contains a T -compatible x\u2013y path if and only if G\u2032\u2032 contains\na T \u2032\u2032-compatible x\u2032\u2032\u2013y\u2032\u2032 path. Evidently, this construction can be carried out\nin polynomial time; thus (7) holds true. In view of Lemmas 3 and 4 the result\nnow follows. \u0003\nSince P3 \u2264 P4 and P3 \u2264 L4, Lemma 6 yields the NP-completeness part of\nTheorem 1.\n4 Linear time results\nFor a graphG we write G\u25e6 for the graph obtained by removing isolated vertices\nfrom it.\nLemma 7 Let A be a class of graphs closed under isomorphism such that\nnone of the sets\n{P3, K2 +K2}, {K3, K2 +K2}, {P4}, {L4}\nis contained in Aind. Then at least one of the following holds.\n(1) X\u25e6 is a matching for every X \u2208 Aind.\n(2) X\u25e6 is a complete multipartite graph for every X \u2208 Aind.\nPROOF. The assumption implies that at least one of the following cases\nprevails.\n10\n{P3, K3} \u2229 A\nind = \u2205; (8)\n{K2 +K2, P4, L4} \u2229 A\nind = \u2205. (9)\nIf (8) holds, then we observe that each X \u2208 A has only vertices of degree 0\nor 1; i.e., X\u25e6 is a matching.\nNow we assume that (9) holds. We will show thatX\u25e6 is a complete multipartite\ngraph for every X \u2208 Aind. Suppose to the contrary that there is someX \u2208 Aind\nsuch that X\u25e6 is not a complete multipartite graph. It follows that there are\nthree distinct vertices u, u\u2032, v \u2208 V (X\u25e6) with uu\u2032 \u2208 E(X\u25e6) but neither uv \u2208\nE(X\u25e6) nor u\u2032v \u2208 E(X\u25e6). Since X\u25e6 contains no isolates, v must be adjacent\nwith a fourth vertex v\u2032. Consider the subgraph Y ofX\u25e6 induced by {u, u\u2032, v, v\u2032}.\nClearly Y \u2208 Aind. We have to consider four possibilities for EY (v\n\u2032), namely\n{v\u2032v}, {v\u2032v, v\u2032u}, {v\u2032v, v\u2032u\u2032}, and {v\u2032v, v\u2032u, v\u2032u\u2032}. We observe that in the first\ncase Y is isomorphic to K2 +K2, in the second and third case to P4, and in\nthe last case to L4. In any case we have a contradiction to (9). Hence X\n\u25e6 is\ncomplete multipartite for every X \u2208 Aind. \u0003\nProposition 8 Let A be a class of graphs closed under isomorphism such that\nX\u25e6 is a matching for every X \u2208 Aind. Then A-CP can be solved in linear time.\nIn particular, for an instance (G, T, x, y) of A-CP we need at most O(|E(G)|)\ntime to find a T -compatible x\u2013y path if it exists, or to determine that it does\nnot exist.\nPROOF. Let (G, T, x, y) be an instance of A-CP. We set v0 = x, EG(v0) =\n{f1, . . . , fr}, and trace out a T -compatible path P = v0, e1, v1, e2, v2 . . . as\nfollows. Starting in v0 we have r = |EG(v0)| possibilities for choosing the first\nedge v0v1. However, for every vi with i > 0 there is at most one choice for\nthe next edge; namely, since T (vi)\n\u25e6 is a matching, either ei = vi\u22121vi is an\nisolated vertex of T (vi) (and we cannot extend P ), or there is a unique edge\nviw \u2208 EG(vi) which forms an allowed transition with ei. In the latter case, if\nw \/\u2208 {v0, . . . , vi\u22121}, then we extend the path putting vi+1 := w (otherwise, if\nw \u2208 {v0, . . . , vi\u22121}, then we cannot extend the path). We continue this process\nuntil the path cannot be extended. The selection of the first edge is the only\nnondeterministic step in the above construction; hence we conclude that there\nare exactly r non-extendable T -compatible paths (say, P1, . . . , Pr) which start\nin x. If there is any T -compatible x\u2013y path, then it is evidently a subpath of\nsome Pi, 1 \u2264 i \u2264 r.\nWe claim that every edge of G lies on at most two paths Pj, Pk, (1 \u2264 j <\nk \u2264 r). We suppose the contrary and conclude that some edge of G must be\ntraversed\u2014starting in x\u2014by at least two paths Pj , Pk, in the same direction\n(1 \u2264 j < k \u2264 r). Let Pj = v0, e1, v1, e2, v2 . . . es, vs and choose the minimal in-\ndex i \u2208 {1, . . . , s} such that ei is traversed by Pj and Pk in the same direction.\n11\n\u00b7 \u00b7 \u00b7\nE0\n\u00b7\u00b7\u00b7\nE1\n\u00b7\u00b7\u00b7\nE2\n\u00b7\u00b7\u00b7\nEk\n\u00b7\u00b7\u00b7\nv0\nv\u20320\nv1\nv\u20321\nv2\nv\u20322\nvk\nv\u2032k\nw1 w2\nFig. 4. Illustration for the proof of Proposition 9; the matching M(v) is indicated\nby bold lines.\nBy construction of Pj and Pk, i 6= 1 follows. Since Pk is T -compatible, some\nedge f of Pk forms an allowed transition with ei; thus fei \u2208 E(T (vi\u22121)). How-\never, we also have ei\u22121ei \u2208 E(T (vi\u22121)). By assumption, T (vi\u22121)\n\u25e6 is a matching,\nhence ei\u22121 = f and so ei\u22121 \u2208 E(Pk) follows. Hence ei\u22121 is traversed by Pj and\nPk in the same direction; a contradiction to the particular choice of i. Whence\nthe claim is shown true, and we have\nk\u2211\ni=1\n|E(Pi)| = O(E(G)). (10)\nEvidently, the construction of each individual path Pi, 1 \u2264 i \u2264 r, can be\ncarried out in O(|E(Pi)|) time. Hence the proposition follows from (10). \u0003\nProposition 9 Let A be a class of graphs closed under isomorphism such\nthat X\u25e6 is a complete multipartite graph for every X \u2208 Aind. Then A-CP can\nbe solved in linear time. In particular, for an instance (G, T, x, y) of A-CP\nwe need at most O(|V (G)| + |E(G)|) time to find a T -compatible x\u2013y path if\nit exists, or to determine that it does not exist.\nPROOF. We are going to reduce A-CP to the problem of finding an aug-\nmenting path in a graph w.r.t. some matching. Let (G, T, x, y) be an instance\nof A-CP. Isolated vertices of G can be deleted in\nO(|V (G)|) (11)\ntime; if x or y is deleted, then G has no T -compatible x\u2013y path by trivial\nreasons. Hence, w.l.o.g., we assume that G has no isolated vertices. For each\nv \u2208 V (G) \\ {x, y} we apply the following construction (see Figure 4) which is\nan extension of a construction used by Tutte [13]. Let E0 \u2286 V (T (v)) be the set\nof isolated vertices of T (v). Since T (v)\u25e6 = T (v)\u2212E0 is a complete multipartite\ngraph, there is a partition of EG(v) \\E0 into mutually disjoint sets E1, . . . , Ek\nsuch that ef \u2208 E(T (v)\u25e6) if an only if e \u2208 Ei and f \u2208 Ej for some i 6= j. We\nsplit v into vertices v0, . . . , vk such that the edges in Ei are incident with vi,\n0 \u2264 i \u2264 k. For i = 0, . . . , k we add a new vertex v\u2032i and the edge viv\n\u2032\ni. Finally,\n12\nwe add two new vertices w1 and w2, the edge w1w2, and for each 1 \u2264 i \u2264 n,\n1 \u2264 j \u2264 2, the edge v\u2032iwj (note that v\n\u2032\n0 is not joined to w1 or w2 and is\ntherefore an end vertex). Evidently, the set M(v) = {v0v\n\u2032\n0, . . . , vkv\n\u2032\nk, w1w2} is\na matching.\nWe form a graph G\u2032 by applying this construction to every v \u2208 V (G) \\ {x, y}.\nSince for every v \u2208 V (G) at most 4d(v) new edges have been added, we have\n|E(G\u2032)| = O(|E(G)|). (12)\nAssuming the use of suitable data structures, G\u2032 can be constructed from G\nin O(|E(G)|) time. We put M =\n\u22c3\nv\u2208V (G)\\{x,y}M(v) and observe that M is a\nmatching ofG\u2032 which covers all vertices of G\u2032 except x and y. It is easy to verify\nthat G contains a T -compatible x\u2013y path if and only if G\u2032 contains anM-aug-\nmenting path (see Figure 4); moreover, if some some M-augmenting path P \u2032\nof G\u2032 is found, then it can be transformed efficiently into a T -compatible x\u2013y\npath P in G.\nOne needs at most O(|E(G\u2032)|) time to detect an M-augmenting path P \u2032 of\nG\u2032, and to construct P \u2032 if it exists (see [12, pp. 121]). Hence, by (11), (12) and\nthe preceding considerations, the proposition follows. \u0003\nIn view of Lemma 7, the remaining part of Theorem 1 now follows from Propo-\nsitions 8 and 9. Whence Theorem 1 is shown true.\n5 An application to edge-colored graphs\nLet c \u2265 2 be an integer. A graph G is called c-edge-colored if every edge of\nG has one of c colors; formally, a map \u03c7G : E(G) \u2192 {1, . . . , c} is specified\n(note that the coloring need not be a \u2018proper\u2019 edge-coloring). A path P (or\ncycle C) in a c-edge-colored graph G is called properly colored if incident edges\nof P (or C, respectively) differ in color. Numerous results on c-edge-colored\ngraphs (and applications of properly colored paths and cycles to genetics) can\nbe found in Chapter 11 of Bang-Jensen and Gutin\u2019s book [2].\nWe consider the following problem.\nPROPERLY COLORED PATH\nInstance: a c-edge-colored graph G, two distinct vertices x, y \u2208 V (G).\nQuestion: does G contain a properly colored path from x to y?\nThis problem is known to be solvable in linear time for c = 2 ([1], see also [2]).\n13\nApplying Proposition 9, we extend this result to arbitrary c \u2265 2. (It seems\nto be feasible to apply the construction defined in the proof of Proposition 9\nto generalize other results on c-edge-colored graphs from c = 2 to the general\ncase; one such application can be found in [11].)\nLet G be a c-edge-colored graph. For each v \u2208 V (G) the c-edge-coloring\ninduces a partition of EG(v) into (nonempty and mutually disjoint) classes\nE1, . . . , Ek, k \u2264 c, such that for e, f \u2208 EG(v), \u03c7G(e) = \u03c7G(f) if and only\nif e and f belong to the same class Ei, 1 \u2264 i \u2264 k. This partition defines a\ncomplete multipartite graph T\u03c7(v) with V (T\u03c7(v)) = EG(v) and E(T\u03c7(v)) =\n{ ef | \u03c7G(e) 6= \u03c7G(f) }. Let T\u03c7 = { T\u03c7(v) | v \u2208 V (G) } be the corresponding\ntransition system. It can be verified easily that properly colored paths and\nT\u03c7-compatible paths coincide in G. Whence Proposition 9 yields the following\ncorollary.\nCorollary 10 The problem PROPERLY COLORED PATH can be solved\nin linear time.\nReferences\n[1] J. Bang-Jensen and G. Gutin. Alternating cycles and trails in 2-edge-coloured\ncomplete multigraphs. Discrete Math., 188(1\u20133):61\u201372, 1998.\n[2] J. Bang-Jensen and G. Gutin. Digraphs: Theory, Algorithms, Applications.\nSpringer Monographs in Mathematics. Springer Verlag, 2000.\n[3] R. Diestel. Graph Theory, volume 173 of Graduate Texts in Mathematics.\nSpringer Verlag, 2nd edition, 2000.\n[4] H. Fleischner. Personal communication.\n[5] H. Fleischner. Eulerian Graphs and Related Topics, Part 1, Volume 1.\nAnnals of Discrete Mathematics 45. Elsevier Science Publishers, North-Holland,\nAmsterdam, 1990.\n[6] H. Fleischner and A. Frank. On circuit decomposition of planar eulerian graphs.\nJ. Combin. Theory Ser. B, 50:245\u2013253, 1988.\n[7] H. Fleischner and B. Jackson. Compatible path-cycle-decompositions of plane\ngraphs. J. Combin. Theory Ser. B, 42:94\u2013121, 1987.\n[8] H. N. Gabow, S. N. Maheshwari, and L. J. Osterweil. On two problems in the\ngeneration of program test paths. IEEE Transactions on Software Engineering,\nSE-2(3):227\u2013231, 1976.\n[9] M. R. Garey and D. R. Johnson. Computers and Intractability. W. H. Freeman\nand Company, New York, 1979.\n14\n[10] J. Kratochv\u00b4\u0131l and S. Poljak. Compatible 2-factors. Discr. Appl. Math., 36:253\u2013\n266, 1992.\n[11] S. Szeider. On theorems equivalent with Kotzig\u2019s result on graphs with unique\n1-factors. To appear in Ars Combinatoria.\n[12] R. E. Tarjan. Data Structures and Network Algorithms, volume 44 of Regional\nConference Series in Applied Mathematics. Society for Industrial and Applied\nMathematics (SIAM), Philadelphia, PA, 1983.\n[13] W. T. Tutte. A short proof of the factor theorem for finite graphs. Canadian\nJ. Math., 6:347\u2013352, 1954.\n15\n"}