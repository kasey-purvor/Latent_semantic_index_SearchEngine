{"doi":"10.1109\/SPEEDHAM.2008.4581332","coreId":"54793","oai":"oai:eprints.lincoln.ac.uk:2408","identifiers":["oai:eprints.lincoln.ac.uk:2408","10.1109\/SPEEDHAM.2008.4581332"],"title":"Novel battery model of an all-electric personal rapid transit vehicle to determine state-of-health through subspace parameter estimation and a Kalman Estimator","authors":["Gould, C","Bingham, Chris","Stone, D A","Bentley, P"],"enrichments":{"references":[{"id":1028620,"title":"A new approach to linear filtering and prediction problems\u201d,","authors":[],"date":"1982","doi":"10.1115\/1.3662552","raw":"R. E. Kalman, \u201cA new approach to linear filtering and prediction problems\u201d, Transactions of the ASME - Journal of Basic Engineering, Series D, p.35-45, 1982","cites":null},{"id":1027688,"title":"Aging effects in valveregulated lead-acid batteries\u201d,","authors":[],"date":"1993","doi":"10.1109\/intlec.1993.388583","raw":"D. Berndt, E. Meissner, R. Rusch, \u201cAging effects in valveregulated lead-acid batteries\u201d, 15th International Telecommunications Energy Conference (INTELEC), vol.2, p139-145, Sep. 1993","cites":null},{"id":1027812,"title":"Aging mechanisms and service life of leadacid batteries\u201d,","authors":[],"date":null,"doi":"10.1016\/j.jpowsour.2003.09.052","raw":"P. Ruetschi, \u201cAging mechanisms and service life of leadacid batteries\u201d, Journal of power souces, vol.127, p33-44,","cites":null},{"id":1026777,"title":"An adaptive battery monitoring system for an electric vehicle,&quot;","authors":[],"date":"1998","doi":"10.1109\/pedes.1998.1330701","raw":"Sinclair, R. Duke, S. Round, &quot;An adaptive battery monitoring system for an electric vehicle,&quot; Proceedings. International Conference on Power Electronic Drives and Energy Systems for Industrial Growth, vol.2, p786-791, Dec. 1998","cites":null},{"id":1027022,"title":"Battery state of health estimation through coup de fouet,&quot;","authors":[],"date":"2000","doi":"10.1109\/intlec.2000.884309","raw":"C. S. C. Bose, F. C. Laman, &quot;Battery state of health estimation through coup de fouet,&quot; 22nd International Telecommunications Energy Conference (INTELEC), p597-601, 2000","cites":null},{"id":1028056,"title":"Elecktrochemische Kinetik\u201d,","authors":[],"date":"1961","doi":"10.1007\/978-3-642-86547-3","raw":"K. J. Vetter, \u201cElecktrochemische Kinetik\u201d, Springer, Berlin, p268, 1961","cites":null},{"id":1027384,"title":"New estimation filtering for battery management systems of lead-acid cells in hybrid electric vehicles\u201d,","authors":[],"date":"2007","doi":null,"raw":"Pyung-Soo Kim, \u201cNew estimation filtering for battery management systems of lead-acid cells in hybrid electric vehicles\u201d, Int. Journal of Computer Science and Network Security, vol.7, no.2, Feb. 2007","cites":null},{"id":1026616,"title":"Observer techniques for estimating the state-of-charge and state-of-health of VRLABs for hybrid-electric vehicles,&quot; Vehicle Power and Propulsion,","authors":[],"date":"2005","doi":"10.1109\/vppc.2005.1554646","raw":"B. S. Bhangu, P. Bentley, D. A. Stone, C. M. Bingham, &quot;Observer techniques for estimating the state-of-charge and state-of-health of VRLABs for hybrid-electric vehicles,&quot; Vehicle Power and Propulsion, 2005 IEEE Conference, p.780-789, Sep. 2005","cites":null},{"id":1028296,"title":"System identification \u2013 Theory for the user\u201d, 2nd ed,","authors":[],"date":"1999","doi":"10.1109\/mra.2012.2192817","raw":"L.Ljung, \u201cSystem identification \u2013 Theory for the user\u201d, 2nd ed, PTR Prentice Hall, p317-353, 1999","cites":null},{"id":1027099,"title":"Takahiro Yanagihara, \u201cState of charge estimation of sealed lead-acid batteries used for electric vehicles\u201d,","authors":[],"date":"1998","doi":"10.1109\/pesc.1998.701957","raw":"Atsuo Kawamura, Takahiro Yanagihara, \u201cState of charge estimation of sealed lead-acid batteries used for electric vehicles\u201d, 29th Annual IEEE Power Electronics Specialists Conference, vol.1, p583-587, May 1998","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2008","abstract":"Abstract--The paper describes a real-time adaptive\\ud\nbattery model for use in an all-electric Personal Rapid\\ud\nTransit vehicle. Whilst traditionally, circuit-based models\\ud\nfor lead-acid batteries centre on the well-known Randles\u2019\\ud\nmodel, here the Randles\u2019 model is mapped to an equivalent\\ud\ncircuit, demonstrating improved modelling capabilities and\\ud\nmore accurate estimates of circuit parameters when used in\\ud\nSubspace parameter estimation techniques. Combined with\\ud\nKalman Estimator algorithms, these techniques are\\ud\ndemonstrated to correctly identify and converge on voltages\\ud\nassociated with the battery State-of-Charge, overcoming\\ud\nproblems such as SoC drift (incurred by coulomb-counting\\ud\nmethods due to over-charging or ambient temperature\\ud\nfluctuations).\\ud\nOnline monitoring of the degradation of these estimated\\ud\nparameters allows battery ageing (State-of-Health) to be\\ud\nassessed and, in safety-critical systems, cell failure may be\\ud\npredicted in time to avoid inconvenience to passenger\\ud\nnetworks.\\ud\nDue to the adaptive nature of the proposed methodology,\\ud\nthis system can be implemented over a wide range of\\ud\noperating environments, applications and battery\\ud\ntopologies","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/54793.pdf","fullTextIdentifier":"http:\/\/eprints.lincoln.ac.uk\/2408\/1\/gould_1.pdf","pdfHashValue":"72046a6d0e5a98c25600c234e4e0ca0568490cb2","publisher":"Institution of Electronic and Electrical Engineers","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lincoln.ac.uk:2408<\/identifier><datestamp>\n      2014-08-28T09:24:53Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D6A6163735F48:6A6163735F48363030<\/setSpec><setSpec>\n      74797065733D636F6E666572656E63655F6974656D<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/eprints.lincoln.ac.uk\/2408\/<\/dc:relation><dc:title>\n        Novel battery model of an all-electric personal rapid transit vehicle to determine state-of-health through subspace parameter estimation and a Kalman Estimator<\/dc:title><dc:creator>\n        Gould, C<\/dc:creator><dc:creator>\n        Bingham, Chris<\/dc:creator><dc:creator>\n        Stone, D A<\/dc:creator><dc:creator>\n        Bentley, P<\/dc:creator><dc:subject>\n        H600 Electronic and Electrical Engineering<\/dc:subject><dc:description>\n        Abstract--The paper describes a real-time adaptive\\ud\nbattery model for use in an all-electric Personal Rapid\\ud\nTransit vehicle. Whilst traditionally, circuit-based models\\ud\nfor lead-acid batteries centre on the well-known Randles\u2019\\ud\nmodel, here the Randles\u2019 model is mapped to an equivalent\\ud\ncircuit, demonstrating improved modelling capabilities and\\ud\nmore accurate estimates of circuit parameters when used in\\ud\nSubspace parameter estimation techniques. Combined with\\ud\nKalman Estimator algorithms, these techniques are\\ud\ndemonstrated to correctly identify and converge on voltages\\ud\nassociated with the battery State-of-Charge, overcoming\\ud\nproblems such as SoC drift (incurred by coulomb-counting\\ud\nmethods due to over-charging or ambient temperature\\ud\nfluctuations).\\ud\nOnline monitoring of the degradation of these estimated\\ud\nparameters allows battery ageing (State-of-Health) to be\\ud\nassessed and, in safety-critical systems, cell failure may be\\ud\npredicted in time to avoid inconvenience to passenger\\ud\nnetworks.\\ud\nDue to the adaptive nature of the proposed methodology,\\ud\nthis system can be implemented over a wide range of\\ud\noperating environments, applications and battery\\ud\ntopologies.<\/dc:description><dc:publisher>\n        Institution of Electronic and Electrical Engineers<\/dc:publisher><dc:date>\n        2008<\/dc:date><dc:type>\n        Conference or Workshop contribution<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/eprints.lincoln.ac.uk\/2408\/1\/gould_1.pdf<\/dc:identifier><dc:identifier>\n          Gould, C and Bingham, Chris and Stone, D A and Bentley, P  (2008) Novel battery model of an all-electric personal rapid transit vehicle to determine state-of-health through subspace parameter estimation and a Kalman Estimator.  In: Power Electronics, Electrical Drives, Automation and Motion, 2008. SPEEDAM 2008. International Symposium on, 11-13 June 2008, Ischia, Italy.  <\/dc:identifier><dc:relation>\n        http:\/\/dx.doi.org\/10.1109\/SPEEDHAM.2008.4581332<\/dc:relation><dc:relation>\n        10.1109\/SPEEDHAM.2008.4581332<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/eprints.lincoln.ac.uk\/2408\/","http:\/\/dx.doi.org\/10.1109\/SPEEDHAM.2008.4581332","10.1109\/SPEEDHAM.2008.4581332"],"year":2008,"topics":["H600 Electronic and Electrical Engineering"],"subject":["Conference or Workshop contribution","PeerReviewed"],"fullText":" Abstract--The paper describes a real-time adaptive \nbattery model for use in an all-electric Personal Rapid \nTransit vehicle. Whilst traditionally, circuit-based models \nfor lead-acid batteries centre on the well-known Randles\u2019 \nmodel, here the Randles\u2019 model is mapped to an equivalent \ncircuit, demonstrating improved modelling capabilities and \nmore accurate estimates of circuit parameters when used in \nSubspace parameter estimation techniques. Combined with \nKalman Estimator algorithms, these techniques are \ndemonstrated to correctly identify and converge on voltages \nassociated with the battery State-of-Charge, overcoming \nproblems such as SoC drift (incurred by coulomb-counting \nmethods due to over-charging or ambient temperature \nfluctuations).  \nOnline monitoring of the degradation of these estimated \nparameters allows battery ageing (State-of-Health) to be \nassessed and, in safety-critical systems, cell failure may be \npredicted in time to avoid inconvenience to passenger \nnetworks.  \nDue to the adaptive nature of the proposed methodology, \nthis system can be implemented over a wide range of \noperating environments, applications and battery \ntopologies. \n \nIndex Terms--Battery management systems; Energy storage; \nParameter estimation; System identification. \nI.  INTRODUCTION \nThe ULTra (Urban Light Transport \u2013 Fig. 1) is a \nPersonal Rapid Transit (PRT) vehicle developed by \nAdvanced Transport Systems Ltd [1], which is an \nunmanned, steer-by-wire electric vehicle capable of \ncarrying a 500kg payload at speeds up to 40kmph, for the \npurpose of improving the transportation needs of a busy \ncity or other public space (e.g. Heathrow airport in this \ncase) with minimal environmental impact.  \nWith the increasing requirements for environmentally-\nfriendly vehicles, and the search for adequate traffic \ncongestion solutions, more and more cities are turning to \nsmall all-electric or hybrid-electric passenger vehicles, \npromoting greater research into the requirements of \n                                                          \nThe authors would like to thank the Engineering and Physical \nSciences Research Council for supporting this work. \nefficient energy storage systems and their management. \n \n \nFig. 1.ULTra Personal Rapid Transit vehicle \n \nMoreover, with the increasing development of X-by-\nwire control systems, the large transient power demands \n(Fig. 2) on such vehicles are requiring more accurate \nbattery State-of-Function (SoF) prediction techniques, so \nthat State-of-Charge (SoC - the amount of charge \navailable in the battery at any time to sink\/source \nexcessive transients) and State-of-Health (SoH - the \nability of that battery to repeatedly provide its rated \ncapacity over time), can be readily assessed to avoid \ninconvenience to passengers and\/or catastrophic failure of \nthe safety-critical battery pack. \n \n0 200 400 600 800 1000 1200 1400 1600 1800 2000 2200\n-200\n-150\n-100\n-50\n0\n50\n100\nTime (s)\nIn\npu\nt C\nur\nre\nnt\n (A\n)\n \nFig. 2. ULTra driving cycle current-profile \n  Novel Battery Model of an All-Electric \nPersonal Rapid Transit Vehicle to Determine \nState-of-Health through Subspace Parameter \nEstimation and a Kalman Estimator \nC. R. Gould\u2020, C. M. Bingham, D. A. Stone, P. Bentley \nUNIVERSITY OF SHEFFIELD \nDepartment of Electronic and Electrical Engineering \nMappin Street, Sheffield, S1 3JD, UK \nTel. +44 (0) 114 2225847, Fax. +44 (0) 114 2225196, \n\u2020E-mail: c.gould@sheffield.ac.uk \nSPEEDAM 2008\nInternational Symposium on Power Electronics,\nElectrical Drives, Automation and Motion\n1217\n978-1-4244-1664-6\/08\/$25.00 \u00a92008 IEEE\n Whilst SoC characterisation techniques have been \npublished for lead-acid battery technologies [2-6], SoH \ndetermination is less well-reported, primarily because the \nSoH is a qualitative rather than quantitative measure of \nthe ageing of a battery [7,8]. In most cases, the SoH is \nestimated by monitoring the degradation of specific \nbattery model parameters, as suggested in [2], where SoH \ndeterioration is demonstrated through use of the well-\nknown Randles\u2019 battery circuit model [9] using static \nparameters in a closed-loop Extended Kalman Filter \n(EKF). For dynamic drive cycles described by Fig. 2, \nhowever, static parameter values will not suffice to \nproduce an accurate model in either open- or closed-loop \nsystems.  \nThis paper focuses on providing an accurate dynamic \nmodel of systems placed under stresses such as the \nULTra drive-cycle, with its large bipolar transients and \nrequirements for occasional charge scenarios. Here it will \nbe shown that the Randles\u2019 model can be mapped to an \nequivalent circuit, allowing Subspace parameter \nestimation algorithms to be performed online in \ncombination with a simple Kalman Estimator (KE). This \nmodel is demonstrated to be more accurate than the \nRandles\u2019 circuit for estimation algorithms, allowing \nadaptive identification and convergence of the model \nvoltages associated with SoC and SoH monitoring. The \nresulting dynamic parameter estimates will also be shown \nto be useful for fault-prediction and battery end-of-life \ndetermination. \n \nII.  BATTERY MODEL \nThe ULTra relies on a system of 12V Valve-Regulated \nLead-Acid (VRLA) batteries, nominally rated between \n45Ahrs (at the C5 rate) and 50Ahrs (at the C20 rate). \nFig. 3 illustrates the Randles\u2019 model circuit where Rd \nrepresents the self-discharge resistance, Cb is considered \nthe main charge store, and the voltage across it a suitable \nindicator of SoC, whilst SoH can be inferred by any \ndecrease in the value of Cb. Ri models the resistance of \nthe battery\u2019s terminals and inter-cell connections, whilst \nRt and Cs describe transient effects resulting from shifting \nion concentrations and plate current densities.  \n \n \n \nFig. 3. Randles\u2019 battery model \n \nThrough use of a star-delta transform, the Randles\u2019 \nmodel may be mapped to the equivalent circuit shown in \nFig. 4, where the star points of Fig 3 are labelled 1, 2 and \n3, with centre C. Note that points 2 and 3 are shorted, and \ntherefore the resulting delta points will also require a \nshort in parallel with the impedance expected.  \n \n \n \nFig. 4. Mapped equivalent circuit \n \nThe remaining two impedances are manipulated until \nsensible circuit parameters are achieved, resulting in an \nimpedance consisting of a capacitor and resistor in series \n(Cn and Rn), and an impedance consisting of a capacitor \nand resistor in parallel (Cp and Rp). The component \nmappings and SoC voltage mapping is shown in (1) and \n(2) respectively, whilst state-space equations are listed in \n(3) for Randles\u2019, and (4) for the mapped circuit.  \n \n( ) ( )\n( ) tdpbsbtn\nsbsbpsbbn\nRRRCCCRR\nCCCCCCCCC\n+=+=\n+=+=\n22\n2\n\/\n\/\/   \n(1) \n( ) ( )pnpCnCC CCCVCVV pnb ++= \/  (2) \n( )\n( )\niinCCo\ntsCtinC\ndbCdinC\nRIVVV\nRCVRIV\nRCVRIV\nbs\nss\nbb\n++=\n\u2212=\n\u2212=\n\/\n\/\n&\n&\n (3) \n( )\niinCo\np\nin\npnp\npnC\npn\nC\nC\nnn\nC\nnn\nC\nC\nRIVV\nC\nI\nRRC\nRRV\nCR\nV\nV\nRC\nV\nCR\nV\nV\np\npn\np\npn\nn\n+=\n++\u2212=\n+\u2212=\n&\n&\n (4) \nIII.  SUBSPACE PARAMETER ESTIMATION: \nThe input-output relationship of a discrete-time state \nspace model with system matrices Ad, Bd, Cd and Dd and \nwhite noises w(t), v(t) (5), can also be represented by the \nrelationship shown in (6), for any invertible matrix \u2018T\u2019. It \ncan be shown (Ljung 10.80-10.129 [10]), that the system \nof matrices Ad, Bd, Cd, Dd, and initial conditions )0(~x  \ngiven sufficient input-output data, may then be estimated \nby solution of the resulting Subspace algorithms by a \nleast squares method. \n \n)()(D)(C)(\n)()(B)(A)1(\ndd\ndd\ntvtutxty\ntwtutxtx\n++=\n++=+   \n(5) \nVo \nRi \nRt\nCb Rd \nCs\nIin \nVCb \nVCs\nRp Vo\nRi\nRn \nCp \nCn\nIin\nVCp \nVCn\n1 \n2 3\n1 \n2 3 \nC \n1218\n )()(D)(~C)(\n)(~)(B)(~A)1(~\ndd\nd\n1\nd\n1\ntvtutxTty\ntwtuTtxTTtx\n++=\n++=+ \u2212\u2212  (6) \n \nThis allows static battery model parameters to be \nestimated for a \u2018window\u2019 of input-output data (Iin and Vo). \nTo capture the dynamic variation of the battery \nparameters, a FIFO buffer is used to store the \naccumulation of input-output data. Due to the large time-\nconstants involved with Cn and Rp it is impossible to \nacquire sufficient buffered data for accurate estimation of \nthe exact values of Cn and Rp, without neglecting other, \nmore transient parameter variations (i.e. occasional \ncharging periods), and so a structured Subspace \nestimation model is used in which the time constant \nassociated with the product CnRn is assumed to be large \n(compared to the time constant associated with CpRn) and \nconstant, over a small buffer of data (90 seconds). \nLikewise, Rp is assumed to be sufficiently large (5k\u2126) so \nthat ( ) 1\/ \u2192+ ppn RRR . Inaccuracies in Cn will be \ncorrected for by the inherent KE predictor-corrector \naction, allowing determination of Cn, and hence Cb and \nSoH. \n  \nIV.  KALMAN ESTIMATOR THEORY \nThe Kalman Estimator [11] is particularly useful for \nthis methodology, since it optimally estimates states \naffected by broadband noise within the system bandwidth \n(i.e. tries to minimise the sum-of-squared errors between \nactual and estimated states), which may not be able to be \nfiltered classically. The recursive use of predictor-\ncorrector algorithms is also beneficial, since at each \nstage, the updated parameter estimates may be used to aid \nthe KE in convergence.  \nThe implementation of the KE is similar in all respects \nto [2], whereby a discrete-time equivalent model (as used \nin the Subspace parameter estimation) of a system\u2019s state-\nvariable description (7) is generated, using a first-order \nTaylor series expansion, resulting in (8). \n \n)(C)(\n)(B)(A)(\ntxty\ntutxtx\n=\n+=&   \n(7) \n1d1\ndd1\nC\nBA\n++\n+\n=\n+=\nkk\nkkk\nxy\nuxx  (8) \n \nwhere, with sampling period, Tc \nCCBBAIA ddd \u2248\u2248+\u2248 cc TT   (9) \nThis system is now assumed to be corrupted by \nstationary Gaussian white noise consisting of a system \ndisturbance additive vector \u03c3k and model disturbance \nadditive vector \u03bck, both of which are considered to have \nzero mean value for all k and have the following \nrespective covariance matrices \n \n[ ][ ] kR kQkk kk  allfor E\n allfor E\nT\nT\n=\n=\n\u03bc\u03bc\n\u03c3\u03c3   (10) \n \n \nwhere E is the expectation operator. \nThis allows the physical system to be described by \n(11) \n11d1\ndd1\nC\nBA\n+++\n+\n+=\n\u0393++=\nkkk\nkkkk\nxz\nuxx\n\u03bc\n\u03c3   \n(11) \nwhere z is now used to describe the measured output (e.g. \noV  incorporating the Gaussian noise) and \u0393 represents the \ncoupling between the model disturbances on each state. \nBeneficially, the KE may be implemented recursively, \nso that at each sample step \u2018k\u2019 the algorithms operate on \ninput and output data collected up to and including the kth \nsample in a prediction\/correction system as demonstrated \nin the diagram shown in Fig 5. Intuitively this will \nrequire initial estimates for the states and covariance \nmatrices considered by the model. \n \n \n \nFig. 5. Recursive implementation of KE algorithms \nInitial matrices   \nand parameters   \n \u23a5\n\u23a5\u23a6\n\u23a4\n\u23a2\u23a2\u23a3\n\u23a1= )0(\n)0(\n\u02c6 0\/0\np\nn\nC\nC\nV\nV\nx  0=T\nForm Ad, Bd etc with current parameters \nPre-process measured voltage (remove iin RI ) \nPredict states \nkkkkk uxx d\/d\/1 B\u02c6A\u02c6 +=+\nCalculate error covariance and Kalman gain  \nTT\nkkkk \u0393\u0393+=+ QAPAP d\/d\/1  [ ] 1d\/1dd\/11 RCPCCPK \u2212+++ += TkkTkkk\nCorrect state prediction  [ ]kkkkkkkk xzxx \/1d11\/11\/1 \u02c6CK\u02c6\u02c6 ++++++ \u2212+=\nCalculate \nbC\nV  and apply filter \nUpdate error covariance  [ ] kkkk \/1d1k1\/1 PCK-IP ++++ =\n?s90>T  \nApply Subspace algorithms \nUpdate Parameters \n1+= TT  No \nYes \n1219\n  \nWith respect to notation, the KE estimates are \ndescribed as in [2], where the KE estimate 1\/1\u02c6 ++ kkx  is \ncalculated from the previous estimate kkx \/\u02c6 , the input \nsignals (in this case current into the positive terminal of \nthe battery) is termed u, and the measured signals, z. \nThe KE is implemented using the state-space \nequations of (4), and initial conditions and covariance \nmatrices of (12), whilst the sampling frequency is \nselected to be 1Hz to maintain model accuracy whilst \navoiding excessive computation complexity. The sample \ntime, is therefore selected to be s1=cT . \nThe output voltage is first pre-processed to remove the \nvoltage dropped across Ri (known from parameter \nestimation), allowing one of the states (\npC\nV ) to be \nimmediately calculated. This allows greater prediction \naccuracy over the Randles\u2019 model.  \n \n\u23a5\u23a6\n\u23a4\u23a2\u23a3\n\u23a1==\n\u23a5\u23a6\n\u23a4\u23a2\u23a3\n\u23a1=\u23a5\u23a6\n\u23a4\u23a2\u23a3\n\u23a1=\n3.13\n3.13\n10\n1.00\n001.0\n100\n010\n0\/0\n0\nxR\nQP\n  \n(12) \n \nRESULTS \nThe KE is initialised with Ri = 6m\u2126, Rn = 10m\u2126, Cp = \n2000F, Cn = 90000F, and used to monitor the effect that a \ncontinuous series of cycles constructed from Fig. 2 has on \na fully charged, well-conditioned battery. After 90s, and \nat regular subsequent intervals (10s in this case) the \nSubspace algorithms of [10] are used to adapt the battery \nmodel parameters online, resulting in the time-varying \nparameters shown in Fig. 6, 7 and 8, demonstrating that \ncareful monitoring of these parameters can indicate \ndangerous areas of operation such as over-\ncharge\/discharge situations as well as possible fault \nconditions such as cell short-circuits. \n \n0 2000 4000 6000 8000 10000 12000 14000 16000\n0\n0.01\n0.02\n0.03\n0.04\n0.05\n0.06\n0.07\n0.08\nTime (s)\nR\nes\nis\nta\nnc\ne \nR\ni (\n\u03a9)\n \nFig. 6. Online estimated battery parameter: Ri \n \n0 2000 4000 6000 8000 10000 12000 14000 16000\n0\n0.2\n0.4\n0.6\n0.8\n1\n1.2\n1.4\n1.6\n1.8\n2 x 10\n4\nTime (s)\nC\nap\nac\nita\nnc\ne \nC\np \n(F\n)\n \nFig. 7. Online estimated battery parameter: Cp  \n \n0 2000 4000 6000 8000 10000 12000 14000 16000\n0\n0.01\n0.02\n0.03\n0.04\n0.05\n0.06\n0.07\n0.08\n0.09\n0.1\nTime (s)\nR\nes\nis\nta\nnc\ne \nR\nn \n( \u03a9\n)\n \nFig. 8. Online estimated battery parameter: Rn \n \n \nThe KE estimates of \nnC\nV  and \npC\nV  can be manipulated \nusing (2) to provide an estimate of \nbC\nV  (indicating the \nvariation of SoC), which is passed through a low-pass \nfilter (\u03c9c = 0.057rads-1), and shown in Fig. 9, to \ndemonstrate the ability of the KE to converge compared \nto a current integration technique (which requires a priori \nknowledge of Cb and )0(\nbC\nV ).  \n \n0 2000 4000 6000 8000 10000 12000 14000 16000\n8\n9\n10\n11\n12\n13\n14\nTime (s)\nVo\nlta\nge\n V\nC\nb \n(V\n)\nVCb by current integration (Cb=88500F)\nVCb from Kalman Estimator\nMeasured open-cct voltage\n \nFig.9 Estimated VCb showing convergence of KE to correct initial \ncondition using mapped circuit model \n1220\n 0 2000 4000 6000 8000 10000 12000 14000 16000\n8\n9\n10\n11\n12\n13\n14\nTime (s)\nVo\nlta\nge\n V\nC\nb \n(V\n)\nVCb by current integration (Cb=88500F)\nVCb from Kalman Estimator\nMeasured open-cct voltage\n  \nFig.10 Estimated VCb using Randles\u2019 circuit model showing incorrect \nparameter estimation and convergence for Time > 12000s \n \nFig.10 demonstrates the result if the Randles\u2019 model is \nused instead of the mapped model for both Subspace \nparameter estimation and the KE algorithms. It can be \nseen that both models exhibit excellent initial \nconvergence, yet it is evident that the Randles\u2019 model \nshows incorrect convergence due to erroneous parameter \nestimation, for operation at low SoC (i.e. after 12000s). \nConversely, the advantageous feature of the mapped \nequivalent circuit\u2019s readily identifiable state allows more \naccurate parameter estimation, and subsequently better \nvoltage convergence. \nThe variation in Cb\/SoH (Fig. 11) may be estimated by \napplying a linear curve-fit to buffered estimations of \nbC\nV , \nand by considering the integrated current through this \ncapacitor over these buffer durations (typically 1800s to \nprovide stable results). \n \n0 5000 10000 15000\n0\n2\n4\n6\n8\n10\n12\n14 x 10\n4\nTime (s)\nC\nap\nac\nita\nnc\ne \nC\nb \n(F\n)\nCb from gradient of VCb\nLinear approximation of constant Cb\n \nFig. 11 Resulting variation of Cb from gradient of observed VCb of Fig. 9 \n \nIt can be seen that after the initial convergence of the \nSubspace parameter and KE algorithms, the value of Cb \nsettles to an almost constant average value between 3000s \nand 10000s (i.e. the region of preferred operation \nbetween ~80% and ~30% SoC). This action can be used \nduring accelerated ageing tests, where the battery is \ncharged at the C10 rate, and then discharged by a \ncontinuous sequence of the current profile illustrated in \nFig. 2, until catastrophic battery failure is witnessed. The \nresulting degradation of the average value of Cb can then \nbe seen over time (Fig. 12), and a linear relationship \napplied (13), where N is the test number. \n \n0 5 10 15 20 25 30 35 40\n7\n7.5\n8\n8.5\n9\n9.5\n10 x 10\n4\nTest Number\nEs\ntim\nat\ned\n C\nb \n(F\n)\n \nCb = - 248*N + 9.3e+004\nEstimated values\nLinear approximation\n \nFig. 12. Decline in estimated Cb with \u2018age\u2019 of battery \n \n93000248 +\u2212= NCb  (13) \nIn a similar manner, as each test is implemented, the \ntotal current demand can be integrated, allowing an \nestimate of the total available capacity of the battery \nduring each test. The reduction in the available capacity \nof the battery under test can be seen in Fig. 13, and again, \nthis relationship may be approximated with the linear \nexpression shown in (14). \n \n0 5 10 15 20 25 30 35 40\n40\n45\n50\n55\nTest Number\nC\nap\nac\nity\n b\ny \ncu\nrr\nen\nt i\nnt\neg\nra\ntio\nn \n(A\nhr\ns)\n \nAhrs = - 0.0625*N + 48.8\nEstimated values\nLinear approximation\n \nFig. 13. Reduction of available capacity with \u2018age\u2019 of battery \n \n8.480625.0 +\u2212= NAhrs  (14) \nBy manipulation of (13) and (14), an expression (15) \nrelating the total available capacity of a battery under test \nto the estimated average value of Cb can be found (See \nFig. 14), so that not only the relative State-of-Health can \nbe estimated, but also the total capacity of the battery at \nthat particular time. This in turn allows more accurate \ncurrent-integration SoC techniques to be employed (now \nthat the necessary a priori knowledge can be estimated), \nand corrected using the convergence features of the KE \n1221\n algorithms to ensure correct \nbC\nV  and State-of-Charge \nestimation is achieved. \n \n4.2500025.0 += bCAhrs  (15) \n \n7.8 8 8.2 8.4 8.6 8.8 9 9.2\nx 10\n4\n45.5\n46\n46.5\n47\n47.5\n48\n48.5\n49\nC\nap\nac\nity\n (A\nhr\ns)\nEstimated Cb (F)\nAhrs=0.00025*Cb+25.4 \n \nFig. 14. Relationship between estimated Cb and available capacity \n \n \nAs an example, for the case of the battery with SoH \nand SoC demonstrated in Fig 9, the estimated Cb of \n88500F from Fig 11 maps to an available capacity of \n47.5Ahrs, compared to that of 47.4Ahrs achieved by \nintegrating the total current demand. The battery is \ntherefore shown to be in good health.  \n \nV.  CONCLUSION \nA novel battery modelling methodology for an all-\nelectric Personal Rapid Transit vehicle is proposed \nconsisting of novel battery circuit model, Kalman \nEstimator and novel online Subspace parameter \nestimation, for the purpose of battery State-of-\nHealth\/State-of-Charge estimation. The use of Subspace \nestimation algorithms allows the observer to adaptively \nestimate and converge on voltages associated with these \nfunctionality indicators, so that ambient temperature \neffects and battery self-discharge issues are automatically \ncompensated for. Results show improved voltage \npredictions compared to algorithms including the \nRandles\u2019 model. Moreover the resulting parameter \nestimations can identify fault conditions and areas of \nunsafe operation. \n \nACKNOWLEDGMENT \nThe authors would like to thank Advanced Transport \nSystems Ltd for their cooperation in this work, and \nparticularly Nicolas Zurlinden for providing the ULTra \ndriving cycle data and press-shots. \n \nREFERENCES \n[1] http:\/\/www.atsltd.co.uk \n[2] B. S. Bhangu, P. Bentley, D. A. Stone, C. M. Bingham, \n\"Observer techniques for estimating the state-of-charge \nand state-of-health of VRLABs for hybrid-electric \nvehicles,\" Vehicle Power and Propulsion, 2005 IEEE \nConference, p.780-789, Sep. 2005  \n[3] Sinclair, R. Duke, S. Round, \"An adaptive battery \nmonitoring system for an electric vehicle,\" Proceedings. \nInternational Conference on Power Electronic Drives and \nEnergy Systems for Industrial Growth, vol.2, p786-791, \nDec. 1998 \n[4] C. S. C. Bose, F. C. Laman, \"Battery state of health \nestimation through coup de fouet,\" 22nd International \nTelecommunications Energy Conference (INTELEC), \np597-601, 2000 \n[5] Atsuo Kawamura, Takahiro Yanagihara, \u201cState of charge \nestimation of sealed lead-acid batteries used for electric \nvehicles\u201d, 29th Annual IEEE Power Electronics Specialists \nConference, vol.1, p583-587, May 1998 \n[6] Pyung-Soo Kim, \u201cNew estimation filtering for battery \nmanagement systems of lead-acid cells in hybrid electric \nvehicles\u201d, Int. Journal of Computer Science and Network \nSecurity, vol.7, no.2, Feb. 2007 \n[7] D. Berndt, E. Meissner, R. Rusch, \u201cAging effects in valve-\nregulated lead-acid batteries\u201d, 15th International \nTelecommunications Energy Conference (INTELEC), \nvol.2, p139-145, Sep. 1993 \n[8] P. Ruetschi, \u201cAging mechanisms and service life of lead-\nacid batteries\u201d, Journal of power souces, vol.127, p33-44, \n2004 \n[9] K. J. Vetter, \u201cElecktrochemische Kinetik\u201d, Springer, \nBerlin, p268, 1961 \n[10] L.Ljung, \u201cSystem identification \u2013 Theory for the user\u201d, \n2nd ed, PTR Prentice Hall, p317-353, 1999 \n[11] R. E. Kalman, \u201cA new approach to linear filtering and \nprediction problems\u201d, Transactions of the ASME - Journal \nof Basic Engineering, Series D, p.35-45, 1982 \n \n \n \n1222\n"}