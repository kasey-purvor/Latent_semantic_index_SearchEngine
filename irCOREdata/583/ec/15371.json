{"doi":"10.1080\/18128600903500110","coreId":"15371","oai":"oai:dro.dur.ac.uk.OAI2:7546","identifiers":["oai:dro.dur.ac.uk.OAI2:7546","10.1080\/18128600903500110"],"title":"Using principal curves to analyse traffic patterns on freeways.","authors":["Einbeck, Jochen","Dwyer, Jo"],"enrichments":{"references":[{"id":879169,"title":"A generic characterization of equilibrium speed-flow curves.","authors":[],"date":"2008","doi":null,"raw":null,"cites":null},{"id":877288,"title":"A nested clustering technique for freeway operating condition classification.","authors":[],"date":"2007","doi":"10.1111\/j.1467-8667.2007.00498.x","raw":null,"cites":null},{"id":877287,"title":"A new approach for modelling of fundamental diagrams.","authors":[],"date":"2002","doi":"10.1016\/S0965-8564(01)00043-X","raw":null,"cites":null},{"id":879166,"title":"An application of neural network on traffic speed prediction under adverse weather condition.","authors":[],"date":"2003","doi":null,"raw":null,"cites":null},{"id":879172,"title":"Core Team","authors":[],"date":"2009","doi":null,"raw":null,"cites":null},{"id":877282,"title":"Empirical features of congested traffic states and their implications for traffic modelling.","authors":[],"date":"2007","doi":null,"raw":null,"cites":null},{"id":877285,"title":"Freeway performance measurement system (PeMS) version 4.","authors":[],"date":"2004","doi":null,"raw":null,"cites":null},{"id":877284,"title":"Generalized monotonic regression based on B-splines with an application to air pollution data.","authors":[],"date":"2007","doi":"10.1093\/biostatistics\/kxl036","raw":null,"cites":null},{"id":879168,"title":"Modeling traffic\u2019s flow-density relation: Accomodation of multiple flow regimes and traveler types.","authors":[],"date":"2001","doi":null,"raw":null,"cites":null},{"id":879165,"title":"Principal curves.","authors":[],"date":"1989","doi":null,"raw":null,"cites":null},{"id":879173,"title":"pspline: Penalized Smoothing Splines. R package version 1.0-12. R port by Brian Ripley.","authors":[],"date":"2007","doi":null,"raw":null,"cites":null},{"id":879170,"title":"Realtime merging traffic control with applications to toll plaza and work zone man29 agement.","authors":[],"date":"2008","doi":null,"raw":null,"cites":null},{"id":877283,"title":"Short-term prediction of traffic dynamics with real-time recurrent learning algorithms.","authors":[],"date":"2009","doi":"10.1080\/18128600802591681","raw":null,"cites":null},{"id":877286,"title":"Some theorectical aspects of road traffic research.","authors":[],"date":"1952","doi":"10.1680\/ipeds.1952.11259","raw":null,"cites":null},{"id":879164,"title":"Synthesis of recent work on the nature of speed-flow and flow-occupancy (or density) relations on freeways.","authors":[],"date":"1992","doi":null,"raw":null,"cites":null},{"id":879171,"title":"The mathematics of high-tech highways.","authors":[],"date":"2001","doi":null,"raw":null,"cites":null},{"id":879167,"title":"The PeMS algorithms for accurate, real-time estimates of g-factors and speeds from single-loop detectors.","authors":[],"date":"2001","doi":null,"raw":null,"cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2011-05-01","abstract":"Scatterplots of traffic speed versus flow have caught considerable attention over the last decades due to their characteristic half-moon like shape. Modelling data of this type is difficult as both variables are actually not a function of each other in the sense of causality, but are rather jointly generated by a third latent variable, which is a monotone function of the traffic density. We propose local principal curves as a tool to describe and model speed-flow data, which takes this viewpoint into account. We introduce the  concept of calibration curves to determine the relationship between the latent variable (represented by the parametrization of the principal curve) and the traffic density. We apply local principal curves to a variety of speed-flow diagrams from Californian freeways, including some so far unreported pattern","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/15371.pdf","fullTextIdentifier":"http:\/\/dro.dur.ac.uk\/7546\/1\/7546.pdf","pdfHashValue":"442a28dc0264c3e248b16bb53c8c839eb8e624a3","publisher":"Taylor & Francis","rawRecordXml":"<record><header><identifier>\n  \n    \n      oai:dro.dur.ac.uk.OAI2:7546<\/identifier><datestamp>\n      2011-10-27T13:58:54Z<\/datestamp><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        Using principal curves to analyse traffic patterns on freeways.<\/dc:title><dc:creator>\n        Einbeck, Jochen<\/dc:creator><dc:creator>\n        Dwyer, Jo<\/dc:creator><dc:description>\n        Scatterplots of traffic speed versus flow have caught considerable attention over the last decades due to their characteristic half-moon like shape. Modelling data of this type is difficult as both variables are actually not a function of each other in the sense of causality, but are rather jointly generated by a third latent variable, which is a monotone function of the traffic density. We propose local principal curves as a tool to describe and model speed-flow data, which takes this viewpoint into account. We introduce the  concept of calibration curves to determine the relationship between the latent variable (represented by the parametrization of the principal curve) and the traffic density. We apply local principal curves to a variety of speed-flow diagrams from Californian freeways, including some so far unreported patterns<\/dc:description><dc:subject>\n        Fundamental diagram<\/dc:subject><dc:subject>\n         Capacity<\/dc:subject><dc:subject>\n         Local principal curves<\/dc:subject><dc:subject>\n         Smoothing.<\/dc:subject><dc:publisher>\n        Taylor & Francis<\/dc:publisher><dc:source>\n        Transportmetrica, 2011, Vol.7(3), pp.229-246 [Peer Reviewed Journal]<\/dc:source><dc:date>\n        2011-05-01<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:identifier>\n        dro:7546<\/dc:identifier><dc:identifier>\n        issn:1812-8602<\/dc:identifier><dc:identifier>\n        issn: 1944-0987<\/dc:identifier><dc:identifier>\n        doi:10.1080\/18128600903500110 <\/dc:identifier><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/7546\/<\/dc:identifier><dc:identifier>\n        http:\/\/dx.doi.org\/10.1080\/18128600903500110 <\/dc:identifier><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/7546\/1\/7546.pdf<\/dc:identifier><dc:rights>\n        This is an electronic version of an article to be published in Einbeck, Jochen and Dwyer, Jo (2010) 'Using principal curves to analyze traffic patterns on freeways.', Transportmetrica. Transportmetrica is available online at: http:\/\/www.tandf.co.uk\/journals\/ttra with the open URL of your article.<\/dc:rights><dc:accessRights>\n        info:en-repo\/semantics\/openAccess<\/dc:accessRights><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["1812-8602"," 1944-0987","issn:1812-8602","issn: 1944-0987"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2011,"topics":["Fundamental diagram","Capacity","Local principal curves","Smoothing."],"subject":["Article","PeerReviewed"],"fullText":"Durham Research Online\nDeposited in DRO:\n11 November 2010\nVersion of attached file:\nAccepted Version\nPeer-review status of attached file:\nPeer-reviewed\nCitation for published item:\nEinbeck, Jochen and Dwyer, Jo (2011) \u2019Using principal curves to analyse traffic patterns on freeways.\u2019,\nTransportmetrica., 7 (3). pp. 229-246.\nFurther information on publisher\u2019s website:\nhttp:\/\/dx.doi.org\/10.1080\/18128600903500110\nPublisher\u2019s copyright statement:\nThis is an electronic version of an article to be published in Einbeck, Jochen and Dwyer, Jo (2010) \u2019Using principal\ncurves to analyze traffic patterns on freeways.\u2019, Transportmetrica. Transportmetrica is available online at:\nhttp:\/\/www.tandf.co.uk\/journals\/ttra with the open URL of your article.\nAdditional information:\nUse policy\nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without prior permission or charge, for\npersonal research or study, educational, or not-for-profit purposes provided that:\n\u2022 a full bibliographic reference is made to the original source\n\u2022 a link is made to the metadata record in DRO\n\u2022 the full-text is not changed in any way\nThe full-text must not be sold in any format or medium without the formal permission of the copyright holders.\nPlease consult the full DRO policy for further details.\nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom\nTel : +44 (0)191 334 3042 \u2014 Fax : +44 (0)191 334 2971\nhttp:\/\/dro.dur.ac.uk\nUsing principal curves to analyze traffic patterns on\nfreeways\nJochen Einbeck\u2217 and Jo Dwyer\nDurham University, Department of Mathematical Sciences,\nScience Laboratories, South Road,\nDurham, UK\nAbstract\nScatterplots of traffic speed versus flow have caught considerable attention over\nthe last decades due to their characteristic half-moon like shape. Modelling data\nof this type is difficult as both variables are actually not a function of each other in\nthe sense of causality, but are rather jointly generated by a third latent variable,\nwhich is a monotone function of the traffic density. We propose local principal\ncurves as a tool to describe and model speed-flow data, which takes this viewpoint\ninto account. We introduce the concept of calibration curves to determine the\nrelationship between the latent variable (represented by the parametrization of\nthe principal curve) and the traffic density. We apply local principal curves to a\nvariety of speed-flow diagrams from Californian freeways, including some so far\nunreported patterns.\nKey Words: fundamental diagram; capacity; local principal curves; smoothing.\n\u2217jochen.einbeck@durham.ac.uk\n1 Introduction\nScatterplots of speed versus flow have been widely analyzed and discussed in trans-\nportation science, and have recently attracted new interest with the rapid advances in\nthe development of Intelligent Transportation Systems. As an example, consider data\nplotted in figure 1 (left), recorded on 10th July 2007 (00:00 to 23:59) on the Califor-\nnian Freeway I280-N, Lane 1, VDS (\u201cvehicle detector station\u201d) number 716450. The\ndata show a characteristic and frequently reported half-moon like shape. Roughly,\nthe upper and the lower cluster correspond to uncongested and congested operating\ncondition, respectively, and the few data points between them to an unstable transi-\ntion region. Based on a cluster analysis, Xia & Chen (2007) argued that actually five\ndifferent operating conditions should be distinguished.\nUnder equilibrium conditions, i.e. stationary speed and spatially homogeneous\ndensity, it is well known that the speed v and the flow q are related through the\nfundamental identity q = kv, where k is the traffic density. The association between\nspeed, flow and density is often referred to as the fundamental diagram. As Wu (2002)\npoints out, the fundamental identity specifies the fundamental diagram only up to one\ndegree of freedom. In other words, one has to impose an additional constraint on\nany pair of the three variables in order to specify the fundamental diagram fully.\nThis is usually achieved by fixing the k \u2212 v relationship. For instance, the original\nmodel suggested by Greenshields (1935) uses k(v) = kj(1 \u2212 v\/vf ), where kj is the\njam density corresponding to v = 0 and and vf the free-flow speed. Having fixed the\nspeed-density relationship, the speed-flow relationship is determined by q(v) = k(v)v,\nwhich in the special case of the Greenshields model (hereafter: GM) takes the shape\nq(v) = kjv(1 \u2212 v\/vf ), i.e. a parabola without an intercept. Several other, generally\nmore complex, functional relationships between k and v have been proposed since\n2\nthen, see e.g. Kockelman (2001) or Wu (2002) for an overview on this literature.\nAn interesting and early reference comparing different speed-density models from a\nstatistical point of view is Drake, Schoefer & May (1967). More recently, Wu (2002)\nproposed to avoid the usually applied \u201ctrial and error\u201d model selection strategy by\nrelating the parameters of the fundamental diagram to microscopic road parameters.\nThe reason why the k \u2212 v relationship is preferred to any other pair of variables is\nsimply that this is the only one which is monotonic. This is illustrated in figure 1\n(right), using here occupancy, the quantity returned by default by PeMS, which is\nroughly linearly related to density (Hall, 2002).\n50 100 150 200\n20\n40\n60\n80\n10\n0\n12\n0\nFlow (veh\/5 min)\nAv\nera\nge\n Sp\nee\nd (k\nm\/h\n)\n0.0 0.1 0.2 0.3 0.4\n20\n40\n60\n80\n10\n0\n12\n0\nOccupancy\nAv\nera\nge\n Sp\nee\nd (k\nm\/h\n)\nFigure 1: Fundamental diagram recorded on Freeway I280-N; left: speed-flow; right:\nspeed-occupancy.\nThere have hardly been made any attempts at modelling the q \u2212 v relationship\ndirectly (rather than through the k\u2212 v relationship); Li (2008) mentions one instance\nused in the Highway capacity manual 2000. One reason for this reluctance may be\nthat any functional form between q and v is hard to justify. Obviously, v cannot be\n3\nseen as a function of q as we have potentially two different outputs for the same input.\nBut also the other way round, q = q(v), seems somewhat contrived: speed v is quite\ndifficult to measure while the flow q is very easy to measure \u2014 realistically, nobody\nwould be interested in predicting flow from speed. Also, traffic flow is not a function\nof speed in the sense of causality, it is rather that drivers have to obey the constraints\nset by the current road conditions, and this will affect both speed and flow. As a\nconsequence, it seems more natural to consider both variables as the two-dimensional\noutput of a function\n\uf8eb\n\uf8ed q\nv\n\uf8f6\n\uf8f8 (t) of some (latent) variable, say t. This also does the job\nof fixing the remaining degree of freedom in the fundamental diagram, but it implies a\nsymmetric view on the variables; the resulting model is invariant w.r.t. interchanging\nthe coordinate axes for q and v.\nThe statistical concept corresponding to this viewpoint is a principal curve: a\nsmooth curve passing through the \u201cmiddle of the data cloud\u201d. Principal curves were\nintroduced by Hastie & Stuetzle (1989) (hereafter: HS) as a nonparametric extension\nto linear principal component analysis. Chen, Zhang, Tang & Wang (2004) have ap-\nplied HS principal curves to speed-flow data and showed that this leads generally to\nbetter fits than the Greenshields-type parametric models of flow given speed. We will\ntake things on from here and illustrate the benefits and relevance of principal curves\nin the context of the fundamental diagram. The methodology that we will be using for\nthe actual curve fitting is that of local principal curves (Einbeck, Tutz & Evers, 2005b,\nhereafter LPC). In Section 2, we explain briefly how LPCs work, and we demonstrate\nthat the curve parametrization, representing the latent variable, is a monotonic func-\ntion of the traffic density, which was singled out as \u201cthe primary factor to define the\nlevel of service on a freeway\u201d by Xia & Chen (2007). Specifically, we introduce the\nnovel concept of a calibration curve, which relates the curve parametrization to den-\n4\nsity or occupancy. In Section 3, we fit local principal curves to a temporal sequence of\nspeed-flow diagrams, compare them with HS and Greenshields curves, and link them\nto the notion of capacity. We further give an overview of characteristic speed-flow\npatterns collected in the course of our studies, some of which do not follow the \u201cclas-\nsical\u201d shape of the fundamental diagram. We finish with a conclusion in Section 4.\nThe techniques proposed in this paper are still feasible even if no measured values of\ndensity or occupancy have been provided. Hence, when we use occasionally the term\nspeed-flow diagram instead of fundamental diagram, we emphasize that we do have\nthe speed and flow values, but not necessarily anything else, available.\n2 Principal curves and the fundamental diagram\nPrincipal curves are smooth curves passing through the middle of the distribution of\na data cloud. Several competing concepts of principal curves have been developed\nover the last 20 years, which can be divided into two major families: (i) \u201cTop-down\u201d\nmethods, such as HS curves, start with some straight line, which is then iteratively\nbent until it fits satisfactorily through the data cloud and some global error criterion\nis minimized; (ii) \u201cBottom-up\u201d methods construct the principal curve point by point,\nat each iteration only considering the information provided in the local neighborhood.\nBottom up methods feature generally a larger flexibility at the expense of higher\nvariability. A representant of this family are local principal curves (Einbeck, Tutz &\nEvers, 2005b):\n2.1 Local principal curves\nTo fix terms, let KH(\u00b7) = |H|\n\u22121\/2K\n(\nH\u22121\/2 \u00b7\n)\n, with K(\u00b7) being a 2\u2212dimensional kernel\nfunction (e.g. a two-dimensional Gaussian density), H = diag(h2\n1\n, h2\n2\n) a multivariate\n5\n(2\u00d72) bandwidth matrix, wxi = KH(xi\u2212x)\/\n\u2211n\ni=1 KH(xi\u2212x), and x\nT\ni = (xi1, xi2), i =\n1, . . . , n (think of xi1 = qi as flow-values and xi2 = vi as speed-values). The \u201cmiddle\u201d\nof the data cloud is estimated as follows:\nAlgorithm: Local principal curves (LPC)\n1. Select a starting point x0 \u2208 R\n2 and a step size t0 > 0. Set x = x0.\n2. Calculate the local center of mass \u00b5x =\n\u2211n\ni=1 w\nx\ni xi at x. Denote by \u00b5\nx\nj the j-th\ncomponent of \u00b5x, j = 1, 2.\n3. Estimate the local covariance matrix \u03a3x = (\u03c3xjk) \u2208 R\n2\u00d72 at x via\n\u03c3xjk =\n\u2211n\ni=1 w\nx\ni (xij \u2212 \u00b5\nx\nj )(xik \u2212 \u00b5\nx\nk).\nLet \u03b3x be the first eigenvector of \u03a3x.\n4. Setting x := \u00b5x + t0\u03b3\nx, one finds the updated value of x.\n5. Repeat steps 2 to 4 until the sequence of \u00b5x remains approximately constant (im-\nplying that the end of the data cloud is reached). Then set again x = x0, set\n\u03b3x := \u2212\u03b3x and continue with step 4.\nIn words, this algorithm does nothing other than compute alternately a local\ncenter of mass and a localized first principal component. The series of local centers\nof mass \u00b5x make up the local principal curve. For the data from figure 1, they are\nplotted through \u201c+\u201d symbols in figure 2 (left), and the curve is obtained from them\nthrough linear (as done here) or cubic interpolation. This algorithm is implemented\nin the lpc function which runs under R (R Development Core Team, 2009) and is\navailable for download from the source given in the Conclusion of this paper. The\nstep size t0 and the bandwidths h1 and h2 are not chosen automatically as part of\nthis algorithm, but need to be specified. This choice is simplified when both variables\noperate on the same scales, or when the data are previously scaled e.g. by dividing\nboth variables through their range. In this case it is reasonable to set h1 = h2 \u2261 h,\n6\nand to set the step length t0 equal to h as well. When working with speed-flow data,\nwhere speed is measured in km\/h and flow in veh\/5 min, the range of both variables is\nof a similar magnitude, so that there is no need for rescaling or for the use of unequal\nbandwidths. As most fundamental diagrams operate on a similar range of flow and\nspeed values, there is also no need to choose the bandwidth h for each data set anew.\nThe starting point x0 can be selected at random or by hand, and does not need to\nbe part of the data cloud. The shape of the fitted curve can vary depending on the\ncluster or branch in which it is situated, but the actual position within the particular\nbranch is of little relevance. In order to obtain the half-moon shape we recommend\nto place it somewhere in the congested half. Unless otherwise stated, we work with\nh = t0 = 12 and x0 = (150, 50)\nT for all examples throughout this paper.\nThough the LPC algorithm does not optimize a global error criterion, it is right\nto say that a \u201cgood\u201d fit corresponds to one which results in small orthogonal distances\nbetween data and curve (unlike vertical ones as in the regression context). Residuals\ndo not play an active role in the construction of the curve but, if desired, they can be\nretrospectively calculated through the distance between a data point and its orthogonal\nprojection on the curve; see figure 2 (right) for a graphical illustration of this concept.\n2.2 Parametrization and Calibration\nSo far, the local principal curve is simply defined by a set of points. This may be\nuseful for descriptive purposes, but does not yet allow to make use of the curve for\nfurther purposes, for instance prediction. Therefore, the curve has to be parametrized,\nso that it can be written in functional form, (q, v)T (t), and the parametrization needs\n7\n50 100 150 200\n2\n0\n4\n0\n6\n0\n8\n0\n1\n0\n0\n1\n2\n0\nFlow (veh\/5 min)\nA\nv\ne\nra\ng\ne\n S\np\ne\ne\nd\n (k\nm\n\/h\n)\n+++++++\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n++++++\n++++++++++++++\n50 100 150 200\n2\n0\n4\n0\n6\n0\n8\n0\n1\n0\n0\n1\n2\n0\nFlow (veh\/5 min)\nA\nv\ne\nra\ng\ne\n S\np\ne\ne\nd\n (k\nm\n\/h\n)\nFigure 2: Speed-flow data from 10\/07\/2007 on Freeway I280-N, VDS 716450; left:\nwith local centers of mass \u00b5x (+) and local principal curve (solid); right: with orthog-\nonal projections onto the curve (dashed).\nto be linked to measurable quantities.\nIn principle, any parametrization which keeps the right order of data points can\nbe chosen. For example, the most simple one would be an enumeration t = 1, 2, 3, . . .\nof all points \u00b5x starting e.g. from the left top. Another parametrization, which is\ncommonly used for HS principal curves, is the unit-speed parametrization, meaning\nthat distances in the parameter space correspond to distances in the data space. For\nLPCs, this parametrization would be calculated point by point by adding the Euclidean\ndistance between the current and the last local center of mass, \u00b5x. An advantage of this\nparametrization is that it entails an automatic stopping rule in step 5: if the difference\nbetween two subsequent parameters falls below a certain threshold the algorithm stops.\nParameters between adjacent \u00b5x are then retrospectively calculated through the arc\nlength of a cubic spline function laid through them (Einbeck, Evers & Hinchliff, 2009).\n8\nThe benefit of having estimated a function (q, v)T (t) seems still questionable as\nwe have not measured t. However, note that, from the fundamental identity of traffic\nflow, we can estimate the average traffic density along the principal curve through\nk(t) = q(t)\/v(t), where (q, v)T (t) are the estimated local centers of mass. Plotting k(t)\nversus t for the LPC which was fitted in figure 2 (left) leads to figure 3 (left). Here, we\nsee how the traffic density falls monotonically with t (at this occasion t = 0 happened\nto be at the congested end of the principal curve; if the value t = 0 was associated to the\nleft top corner then the function k(t) would be monotonically increasing). We call the\nresulting curve (t, k(t)) a calibration curve. It can be used to determine the parameter\nvalue t from the density k. Then one can use the principal curve to predict speed (v)\nand flow (q) simultaneously from t, and therefore, from k. For instance, for a density\nk = 40 veh\/km, one gets from the calibration curve in figure 3 (left) that t\u02c6 = 41.42,\nand from the fitted local principal curve the estimates (q\u02c6, v\u02c6)T (t\u02c6) = (137.94, 41.50)T ,\nmeasured in veh\/5min and km\/h, respectively.\nFor almost all speed-flow diagrams which can be represented by a single-branched\nprincipal curve, the calibration curve will be monotonic irrespective of the parametriza-\ntion used. Minor perturbations from this monotonicity will occur if (and only if) the\nspeed-flow data cloud is so strongly skewed that there exists a line through the origin\ncutting the principal curve twice. This has a purely mathematical reason: points on\na line through the origin have a constant ratio q(t)\/v(t). Hence, if there is such a\nline which is crossed twice, then k(t) = q(t)\/v(t) will also take this value twice (at\nnon-neighboring values of t), and the monotonicity is broken. This is quite unlikely\nto happen except at the area around the tails of the principal curve (an example for\nsuch a situation is provided in figure 6, bottom right). If necessary, such minor devia-\ntions from monotonicity could be smoothed out using a nonparametric smoother with\n9\nmonotonicity constraint (e.g. Tutz & Leitenstorfer, 2007).\nIt should be noted that the equilibrium fundamental identity of traffic flow, k =\nq\/v, holds only approximately along the principal curve. The reason for this is that its\nderivation uses a couple of assumptions, one of which being the existence of a number\nof substreams, in each of which all vehicles are travelling at the same speed (Wardrop,\n1952), which is not met as soon as congestion comes in (Hall, 2002). However, as the\nprincipal curve is already approximative in nature, this is not a real concern.\n0 50 100 150 200 250\n0\n10\n20\n30\n40\n50\nt\nq(t)\n\/v(t\n)\n0 50 100 150 200 250\n0.0\n0.1\n0.2\n0.3\n0.4\nt\noc\nc(t)\nFigure 3: Calibration curves for speed-flow diagram from figure 1; left: using the\nfundamental identity; right: using measured occupancies.\nAn alternative to this procedure, which does not require the use of the fundamental\nidentity, is to use the true, observed density, or any other measured quantity which\nis related to it, for calibration. For instance, we may wish to use the occupancies\nprovided by PeMS for this purpose. We cannot do this directly as the local centers of\nmass generally do not correspond to data points; which implies that we do not have a\n10\nmeasured occupancy for them. However, we do have the measured occupancy for all\nthe data points, and one can compute the projection index ti of any data point (qi, vi)\nT\nprojected orthogonally onto the curve. For the data from 10\/07\/2007, this process is\nvisualized in figure 2 (right). Next, the occupancies are plotted against the projection\nindices. The resulting data cloud, depicted in figure 3 (right), still has to be smoothed\nto obtain the calibration curve. We have used penalized splines (Ramsey, 2007) but\nany other nonparametric smoother could be used. As expected, the smoothed curve is\nvery similar in shape to that one obtained through the fundamental identity. Having\nnow two calibration curves for the same data, one could also use them to convert\ndensity to or from occupancy, but we do not pursue this idea further.\n3 Analysis of Californian speed-flow diagrams\n3.1 Data\nOur data has been retrieved from the PeMS 7.3 database (Varaiya, 2004) which records\ndaily traffic data on all major Californian freeways. All reported patterns comprise\nthe time interval from 0.00 to 23.59 of the date stated. The data is collected using\nloop detectors, i.e. buried coils of wire, whose induction is altered when driven over\nby a vehicle. Their method is to measure the flow, the number of vehicles that go\nover a \u201cloop\u201d per unit time, and occupancy, the amount of time each vehicle takes\nto drive over a loop, of traffic every 30 second period. This is the raw data. This\nis then processed and the average speed, flow and occupancy is calculated for each\nloop over each 5 minute period. So when looking at a speed-flow diagram, each\n11\npoint plotted represents the average speed of all cars that passed the loop over 5\nminutes and how many of them there were. Collecting the data for each 30 second\nperiod separately allows PeMS to detect faulty loops very quickly, thus minimizing\nthe number of \u201choles\u201d, a time period with no data, for which they have to calculate an\naverage using nearby loops and past data. The speed cannot be calculated directly, as\nonly single detector loops are used. Instead, PeMS calculates the \u201cg-factor\u201d, a quantity\ninvolving the average length of the vehicles on each freeway, in each lane at certain\ntimes of the day and week, which combined with the time it takes each one to fully\ndrive over a loop, gives an algorithm with which the speed can be calculated. Details\nof the PeMS algorithms are provided in Jia, Chen, Coifman & Varaiya (2001). For an\naccount of more recent developments in traffic data collection, see Atluri, Chowdury,\nKanhere, Fries, Sarasua & Ogle (2009).\n3.2 A temporal sequence of fundamental diagrams\nWe investigate speed-flow data recorded on the Californian Freeway 1280-N, Lane 1,\nVDS 716450. The layout of this road around the detector position is shown in figure\n4. We consider six consecutive weekdays from Monday 9th of July to Saturday 14th\nof July 2007 (figure 5), and also six consecutive Tuesdays (figure 6) starting from\n26th of June 2007. We have fitted each the local principal curve, and, for the sake\nof comparison, a HS principal curve and a Greenshields-type curve for each diagram.\nFor the LPC, we use throughout the default parameter values for h, t0 and x0 as given\nin Section 2.1, except for Saturday 14\/07\/2007 where we used x0 = (150, 130)\nT . For\nthe fitting of HS curves, the flow values had to be scaled by the factor 2\/3 in order\nto obtain reasonable results. We observe that, as expected given the results by Chen,\n12\nFigure 4: Road layout for freeway 1280-N around VDS 716450 (symbolized through\na triangle). Lane 1 is the fastest lane, i.e. the lane in the top. Traffic flows from left\nto right. Picture taken from PeMS.\nZhang, Tang & Wang (2004), LPCs and HS curves stay generally closer to the data\nthan GM curves. It is also unsurprising that the GM curve produces a useless result\nfor the Saturday, where no congestion was observed. It feels difficult to decide which\nof HS or LPC gives the better fit. We will argue in the next subsection that the\ndifference between the two curves is rather qualitative than just a quantitative matter\nof goodness-of-fit.\nModelling speed-flow data through principal curves would only make really sense\nif the fitted curve is repeatable; i.e. if two principal curves fitted at the same location\nat different days are similar (under otherwise similar conditions). Therefore, we plot\nthe fitted LPCs for the six weekdays and Tuesdays, respectively, in each one plot and\nlook at their variability. The result is provided in figure 7. We make the following\nobservations: (i) The variability of speed-flow data recorded on consecutive days is\nlarger than the variability between specific weekdays (here Tuesday) over several weeks;\n(ii) The principal curve representation makes it easy to identify \u201coutlying fundamental\ndiagrams\u201d. For instance, in figure 7 (left) the line at the top corresponds clearly to the\nfree-flow situation on Saturday, while in figure 7 (right) the curve drifting away in the\nbottom-right region is the last of the six Tuesdays, the 31st of July, where the summer\nholiday season approaches its peak, leading to less congestion during workdays; (iii)\n13\n0 50 100 150 200\n20\n40\n60\n80\n10\n0\n12\n0\n09\/07\/2007\nFlow (veh\/5 min)\nAv\ne\nra\nge\n S\npe\ned\n (k\nm\/\nh)\nLPC\nHS\nGM\n50 100 150 200\n20\n40\n60\n80\n10\n0\n12\n0\n10\/07\/2007\nFlow (veh\/5 min)\nAv\ne\nra\nge\n S\npe\ned\n (k\nm\/\nh)\n50 100 150 200\n20\n40\n60\n80\n10\n0\n12\n0\n11\/07\/2007\nFlow (veh\/5 min)\nAv\ne\nra\nge\n S\npe\ned\n (k\nm\/\nh)\n50 100 150 200\n20\n40\n60\n80\n10\n0\n12\n0\n12\/07\/2007\nFlow (veh\/5 min)\nAv\ne\nra\nge\n S\npe\ned\n (k\nm\/\nh)\n50 100 150 200\n20\n40\n60\n80\n10\n0\n12\n0\n13\/07\/2007\nFlow (veh\/5 min)\nAv\ne\nra\nge\n S\npe\ned\n (k\nm\/\nh)\n50 100 150\n20\n40\n60\n80\n10\n0\n12\n0\n14\/07\/2007\nFlow (veh\/5 min)\nAv\ne\nra\nge\n S\npe\ned\n (k\nm\/\nh)\nFigure 5: Speed-flow data from VDS 716450 with local principal curve, HS principal\ncurve, and Greenshields curve, for six consecutive weekdays starting 9th of July 2007.\n14\n0 50 100 150 200 250\n20\n40\n60\n80\n10\n0\n12\n0\n26\/06\/2007\nFlow (veh\/5 min)\nAv\ne\nra\nge\n S\npe\ned\n (m\nph\n)\nLPC\nHS\nGM\n50 100 150 200\n20\n40\n60\n80\n10\n0\n12\n0\n03\/07\/2007\nFlow (veh\/5 min)\nAv\ne\nra\nge\n S\npe\ned\n (m\nph\n)\n50 100 150 200\n20\n40\n60\n80\n10\n0\n12\n0\n10\/07\/2007\nFlow (veh\/5 min)\nAv\ne\nra\nge\n S\npe\ned\n (m\nph\n)\n0 50 100 150 200\n20\n40\n60\n80\n10\n0\n12\n0\n17\/07\/2007\nFlow (veh\/5 min)\nAv\ne\nra\nge\n S\npe\ned\n (m\nph\n)\n50 100 150 200\n20\n40\n60\n80\n10\n0\n12\n0\n24\/07\/2007\nFlow (veh\/5 min)\nAv\ne\nra\nge\n S\npe\ned\n (m\nph\n)\n50 100 150 200\n20\n40\n60\n80\n10\n0\n12\n0\n31\/07\/2007\nFlow (veh\/5 min)\nAv\ne\nra\nge\n S\npe\ned\n (m\nph\n)\nFigure 6: Speed-flow data from VDS 716450 with local principal curve, HS principal\ncurve, and Greenshields curve, for six consecutive Tuesdays starting 26th of June 2007.\n15\nOtherwise, the shape and position of the principal curves does not vary substantially.\nHence, if one has a \u201creference principal curve\u201d for a certain road then this may be\nused to predict the traffic behaviour in the future.\n0 50 100 150 200\n0\n20\n40\n60\n80\n10\n0\n12\n0\nFlow\nSp\nee\nd\n0 50 100 150 200\n0\n20\n40\n60\n80\n10\n0\n12\n0\nFlow\nSp\nee\nd\nFigure 7: Speed-flow data from VDS 716450 with fitted LPCs; left: six consecutive\nweekdays; right: six consecutive Tuesdays.\n3.3 Capacity, and capacity drop\nThe capacity of a road at a particular location is usually defined as the maximum flow\nrate qmax achievable under equilibrium conditions (Wu, 2002). The equilibrium road\ncapacity can be read from the fundamental diagram by taking that point of the fitted\ncurve which corresponds to a maximum flow rate. Table 1 lists the road capacities\nobtained for the six consecutive Tuesdays considered earlier, for all three methods of\nestimation. For the LPC and HS technique, we use the maximum over all flow rates\ngiven in the local center of masses, or knots of the fitted curve, respectively. For the\n16\nTable 1: Estimated capacities in veh\/hour for Lane 1 of freeway I-280N on six con-\nsecutive Tuesdays, with means and standard deviations of the six estimates given\nunderneath.\nqmax LPC HS GM\n26\/06\/2007 2041.34 1929.08 2077.41\n03\/07\/2007 1941.19 2021.51 2064.37\n10\/07\/2007 2017.30 2103.89 2084.48\n17\/07\/2007 1956.83 2082.53 2177.26\n24\/07\/2007 2045.29 2107.66 2176.81\n31\/07\/2007 1961.09 2048.67 2156.70\nqmax 1993.84 2048.89 2122.84\ns(qmax) 46.19 67.40 52.87\nGreenshields model, we take the maximum of the fitted parabola q = bv + cv2, which\nis attained at v = \u2212b\/2c. For a better comparability with other literature we provide\nthe results in veh\/hour and not veh\/5 min, i.e. we multiply all obtained values by\n12. We observe that the Greenshields model produces the highest capacities; they\nare overestimated as also observed by Wu (2002). Both HS and LPC produce road\ncapacities (or better, in our context: lane capacities) far below the GM values. It is\nnot clear whether the HS or LPC capacities are closer to the true capacities, but the\nLPC estimates are at least more precise and repeatable as their standard deviation\nis considerably smaller. Interestingly, they are even less variable than the capacities\nobtained from GM \u2013 one would expect a parametric model to be superior at least in\nterms of variability!\n17\nOf particular interest for traffic engineers is the capacity at bottlenecks, i.e. lo-\ncations where the total arriving flow reaches or exceeds the downstream capacity,\nfor instance due to a merging of lanes (Papageorgiou, Papamichail, Spiliopoulou &\nLentzakis, 2008). This creates congestion, and the exiting flow is reduced below the\ndownstream capacity of the bottleneck. This phenomenon is usually referred to as\ncapacity drop. We see from Table 1 that the estimated capacity for LPC was gen-\nerally smaller than that estimated for HS or GM. The sole exception for this is the\ndata from 26\/06\/2007; however here the HS fit was clearly suboptimal and it seems\nas if it was not fully converged. From figure 6 we observe that the fitted LPC falls\nmuch sharper compared to their HS or GM counterpart, a behaviour which is in line\nwith literature stating that there should be a vertical drop of speed (Hall, Hurdle &\nBanks, 1992). This rapid decrease happens where the limit to the number of vehicles\nthat can be driving on the freeway without affecting their average speed is reached. A\npossible conclusion is that the LPC accounts more accurately for a capacity drop, i.e.\nits maximal flow value estimates directly the reduced capacity due to capacity drop\nrather than the maximum output flow.\nTaking it strictly, speed-flow data with capacity drop are not only curved but\nalso branched, as at some occasions vehicles manage to maintain their speed at high\nflow values during queue formation. The point at which the curve starts to bend\ncan be close to the highest flow value as e.g. on 09\/07\/2007, or at any point along\nthe freeflow section of the data cloud, see also figure 8 (a). The existence of such a\nsidewards branch has already been reported by Hall, Hurdle & Banks (1992) in their\nschematic speed-flow diagram in figure 2. Unlike HS curves, local principal curves\nprovide the methodology to deal with this. The simple solution is to determine two\nstarting points by hand, one in the congested and one in the uncongested part, fit each\n18\nbranch as usual, and overlay the curves. This is exemplarily illustrated through a thin\ncurve added to the plot for the data from 10\/07\/2007 in figure 6. One can think of\nthe flow range covered by the thin curve as the extent of the capacity drop. We note\nfinally that for local principal curves an automatic procedure to detect the positions\nof the bifurcations is available. A full description of this technique would burst the\nframework of this paper, for details see Einbeck, Tutz & Evers (2005a).\n3.4 Selected representative patterns\nHere we provide a list of further interesting patterns which we encountered during our\nstudies. Some are just special variations of the fundamental diagram, while others\nhave an entirely different shape. We do not claim our list to be exhaustive but it\nis representative of the full range of patterns we found in an extensive search. We\nhave fitted a local principal curve to each of them, using at several occasions multiple\nstarting points in order to cover all branches. Due to the particular shape of the\npatterns, most of the starting points are different from our default value given in\nSection 2.1, but we will in general just report in which branch they were located as\nthis is all that is relevant. We use again h = t0 = 12 unless stated otherwise, but\nh = t0 in any case. We do not compare our results to HS or GM as these methods are\nnot able to deal with branched patterns.\nTwo regimes. The data shown in figure 8 (a) was collected on July 11th 2007 on\nLane 1 of Freeway SR57-N. This is, in principle, nothing else than a usual fundamental\ndiagram, just that the time between reaching the flow limit of the freeway and severe\ncongestion is much smaller, whereas previously this change happened gradually, with\n19\n0 50 100 150\n20\n40\n60\n80\n10\n0\n12\n0\n(a) 11\/07\/2007, VDS 1202053\nFlow (veh\/5 min)\nAv\ne\nra\nge\n S\npe\ned\n (k\nm\/\nh)\n0 20 40 60 80 100 120\n20\n40\n60\n80\n10\n0\n(b) 10\/07\/2007, VDS 1202263\nFlow (veh\/5 min)\nAv\ne\nra\nge\n S\npe\ned\n (k\nm\/\nh)\n0 10 20 30 40 50\n20\n40\n60\n80\n10\n0\n(c) 16\/07\/2007, VDS 401513\nFlow (veh\/5 min)\nAv\ne\nra\nge\n S\npe\ned\n (k\nm\/\nh)\n0 50 100 150 200\n40\n60\n80\n10\n0\n12\n0\n14\n0\n(d) 14\/12\/2006, VDS 717672\nFlow (veh\/5 min)\nAv\ne\nra\nge\n S\npe\ned\n (k\nm\/\nh)\n0 10 20 30 40 50 60\n20\n40\n60\n80\n10\n0\n(e) 09\/07\/2007, VDS 1213624\nFlow (veh\/5 min)\nAv\ne\nra\nge\n S\npe\ned\n (k\nm\/\nh)\n0 50 100 150 200\n80\n10\n0\n12\n0\n14\n0\n(f) 09\/07\/2007, VDS 1202322\nFlow (veh\/5 min)\nAv\ne\nra\nge\n S\npe\ned\n (k\nm\/\nh)\nFigure 8: Representative speed-flow patterns collected from PeMS, with fitted local\nprincipal curves. The corresponding road layouts are provided in figure 9.\n20\nthe flow rate and speed decreasing over perhaps one or two hours. This situation\ncould occur on a freeway frequented by people travelling to or from work, or due to\nan accident just after the loop, as the number of vehicles on the freeway would then\nincrease almost instantaneously at a certain time. Taking the viewpoint that these are\ntwo disjoint regimes (without a genuine transition region) which cannot be described\nby a single-branched curve, one could fit separate branches using appropriate starting\npoints in each cluster (see solid lines in figure 8 (a)). This requires to use a relatively\nsmall bandwidth, here h = 6. If one takes the view that this is a usual fundamental\ndiagram, one can increase the bandwidth to our usual setting h = 12, which gives the\ndashed line, and the typical \u03c4 -shaped curve is obtained, which is now similar to that\none in figure 6 on 10\/07\/2007, just featuring a more radical capacity drop.\nNight time drivers. When considering any speed-flow relationship, it is often\nobserved that the freeflow data with a small flow rate decreases in speed also as shown\nin figure 8 (b), whose data was collected on Freeway SR57-N, Lane 5, on July 10th\n2007. An explanation for this is that free flow at a very low flow rate is likely to occur\nvery late at night when the freeways are at their least busy, therefore many road users\nwill choose to drive at a slightly slower speed than they might do at such a flow rate\nduring the day. This effect is especially visible on very busy freeways as then the only\nvery low flow rates during freeflow would be late at night, however on a quieter freeway\nvery low flow rates are much more likely to occur during the day too, so instead of\na curve like that shown above, the left end of the freeflow section might get thicker,\nrepresenting very low flow rates both in the day, at a high speed, and the night, at\na lower speed. This data is extremely curved, however the LPC, using a randomly\nchosen starting point, does model it very closely.\n21\nUndertaking. Another different effect that can be observed in the slowest lane\nof a freeway is that of undertaking. The typical speed-flow curve with a slow free flow\nspeed can be seen in the data cloud given in figure 8 (c) from Freeway I80-W, Lane\n5, on July 16th 2007. Additionally, the curve has average speeds much higher than\nthe freeflow speed at low flow rates. This can be explained by considering that slower\nlanes may be used for undertaking other vehicles, in which case a much higher speed\nthan the average free flow speed of the heavy vehicles which generally occupy this\nlane must be used. It is impractical to attempt to undertake when this lane is busy,\nwhen the flow is high, which is why the effect is isolated to a small range of flow rate\nonly. This data cloud is modelled using two starting points. Specifically, one starting\npoint in the bottom cluster launched a curve which covered almost the entire data\ncloud (thick line). A second curve with starting point x0 = (35, 50)\nT was fitted for\nthe remaining data points associated to very high flow values (thin line).\nChange in driving conditions. Figure 8 (d) represents the type of data cloud\nthat occurs when there has been some change in the driving conditions and was taken\non Freeway I210-E, Lane 1, on Dec 14th 2006. Adverse weather or road works are\ntwo examples of incidents that can cause this kind of change. In such circumstances,\nroad users will generally decrease their choice of freeflow speed in order to have bet-\nter control of their vehicle. During a period of congestion, however, the decrease in\naverage speed is much smaller as it is very slow anyway. Therefore, if the data is\ncollected over a period of time in which we have both normal road conditions and ad-\nverse weather conditions and both freeflow and congestion has occurred within both,\nthe data cloud will have the appearance shown in the graph, with two branches (or\nregimes), representing the freeflow at the two different average speeds, connected to\nthe congestion curves which are approximately the same under both conditions. This\n22\neffect is discussed in detail in Huang & Ran (2003). The LPC is fitted using three\nstarting points, i.e. one on each branch, and a slightly lower bandwidth than usual,\nh = 11.\nSlow lanes. Data taken from the slowest lanes on a freeway can take a different\nshape than the faster lanes. The data shown in figure 8 (e), which was taken from\nFreeway SR57-S, Lane 5, on July 9th 2007, has its smallest flow rate at the highest\naverage speed and then increases in flow inversely to the speed. This effect could be\nexplained by considering the fact that heavy vehicles have a bigger stopping distance,\nso have to leave a bigger distance between themselves and the vehicle in front of\nthem. Therefore it is possible that the drivers slow down at a much lower flow rate\ncompared to the previous situations. The reduced speed implies a reduced stopping\ndistance, allowing each vehicle to become closer to the one in front, which in turn\nleads to increasing flow. Of course, if the slow lane became more congested the flow\nwould then decrease with the speed as for a usual speed-flow pattern. The LPC is\neasily fitted for this data using any randomly chosen starting point. Since this curve\nis unbranched and cut only once by any straight line through the origin, it could also\nbe calibrated.\nFaulty data. The data shown in figure 8 (f), taken on Freeway SR57-S, Lane 1,\nVDS number 1202322 during July 9th 2007, is an example demonstrating the occur-\nrence of unusual data possibly caused by one or more faulty VDS detector as discussed\nin Pescovitz (2001). In general these faults in the PeMS database are identified and\n\u201ccorrected\u201d, either by looking at the corresponding data from a series of nearby work-\ning VDS detectors, looking at the history of that VDS detector, or combining the two.\nThere are some cases, of course, where faulty data is overlooked. A common type of\n23\nfaulty data is a long period of time in which exactly the same average speed is recorded\nfor every five minute period. The local principal curve has fitted this data by using\none starting point in each of the two branches.\n4 Conclusion\nWe have investigated local principal curves as a tool for modelling of speed-flow re-\nlationships. We argued that neither a functional relationship of type v = v(q) nor\nq = q(v) accounts for the true nature of the data, which is that actually both variables\ncan be considered as being generated simultaneously from some underlying distribu-\ntion, and that they are jointly driven by a third variable: the traffic density.\nPrincipal curves are an attractive tool for the modelling of speed-flow data which\ntake this symmetric association between both variables into account. They treat both\nvariables as jointly generated depending on some underlying parameter t, which we\nhave shown to be closely and monotonically related to the traffic density. As such,\nwe could consider the parametrization in itself as another measure of \u201ctraffic con-\ncentration\u201d, a broader term suggested by Hall (2002) encompassing both density and\noccupancy. The relationship between parameter and density can be quantified through\na calibration curve, an approximate version of which can be generated even without\nknowledge of the traffic density via the fundamental identity of traffic flow (in princi-\nple, also an external \u201creference\u201d calibration curve, which would form a characteristic\nof the road under certain default conditions, could be used instead, if one standardizes\nthe \u201c0\u201d value of the parametrization).\n24\n(a)\n(b)\n(c)\n(d)\n(e)\n(f)\nFigure 9: Road layouts corresponding to each pattern considered in Section 3.4. Traffic\nflows from left to right. Lane 1 is the fastest (\u201ctop\u201d) lane in each panel. The detectors\nare positioned in the center of each extract. The pictures are taken from PeMS.\n25\nFor the estimation of the principal curve, a variety of algorithms are available\n\u2014 however, the implementation should provide access to the parametrization, and\nthe curve should be smooth rather than a polygonal line, as the projected points will\ncluster around the edges of the segments otherwise. This leaves us essentially with the\ntwo methods applied in this paper, the HS curves and the LPCs, or variants of them.\nWe do not want to use this paper to make the case that either of them gives a better\ngoodness of fit than the other one. Other papers have carried out investigations of this\ntype (Delicado & Huerta, 2003, Einbeck, Tutz & Evers, 2005b), but the results should\nnot be over-valued as in all principal curve algorithms there are quite a few tuning\nparameters and options to choose, and any attempt to decide for a best principal curve\nalgorithm based on such an arbitrary choice seems elusive. However, we have tried\nto argue that LPCs and HS curves indeed show an intrinsically different behavior at\nflow values close to the road capacity, which is not just a matter of goodness-of-fit. In\nSection 3.4 we gave some examples of more complex patterns (branched, disconnected),\nwhich, by definition, could not be dealt with using HS curves. One should also note\nthat it has been frequently demonstrated (e.g. Delicado & Huerta, 2003) that HS\nprincipal curves can heavily fail even for single-branched connected clouds when the\ndata structure is strongly bent or twisted (e.g. a spiral). The problem is that they\nare based on an initially estimated line (usually the first linear principal component\nline). If the order of projection indices of the data projected onto this line is very\ndifferent from the projection indices of the data onto the \u201cideal\u201d principal curve (i.e.\na smooth curve which would capture the structure of the entire data cloud), then\nthis cannot be corrected in later iterations of the algorithm. Advantages of LPCs are\ntheir simplicity (a simple alternation between calculation of the local mean and the\nlocalized first principal component), the availability of additional tools for projection\nand prediction (which does not mean that this couldn\u2019t be implemented for HS curves\n26\nas well), and their flexibility to adapt to very complex data structures. This comes at\nthe price of somewhat larger variability compared to other principal curve algorithms,\nand the choice of the starting point x0 can play quite a crucial role for some data sets.\nTo make sure that the reader is able to reproduce all results presented in this work,\nwe have put the R source code of all data analyses carried out in this paper at\nhttp:\/\/www.maths.dur.ac.uk\/\u223cdma0je\/lpc\/lpc.htm,\nalong with the R function lpc itself.\nWe have also provided an overview of types of speed-flow diagrams, based on an\nextensive search of patterns collected from the PeMS database, which may be useful for\nfurther reference. Our intention was not to treat all mathematical and technical details\nin full depth. The nature and value of calibration curves for multi-regime situations as\nin Section 3.4 has not been investigated yet and deserves further attention. We finish\nwith a word of caution: Though principal curves may be suitable for descriptive and\ncomparative purposes, and to a certain extent also for prediction, they cannot account\nfor the complex traffic dynamics and stochastic processes underlying particularly the\ncongestion and transition regions. For instance, even if one manages to calibrate a\ncurve as in figure 8 (d), it does not seem very likely that this provides a reliable\nreference for the behavior of the road in the future. A thorough investigation of\ncongested traffic states taking the complex spatiotemporal behavior of traffic data into\naccount has been provided by Scho\u00a8nhof & Helbing (2007). More recently, Sheu, Lan &\nHuang (2009) discussed a novel real-time recurrent learning algorithm for short-term\nprediction of traffic dynamics.\n27\nAcknowledgments\nThe second author of this paper was supported by Nuffield Research Bursary URB\/34397.\nWe are grateful to M.Z.F. Li, Nanyang Business School, Singapore, for helpful com-\nments at the draft stage of this paper, and M. Zayed, Durham University, UK, for his\ncontribution to the R implementation of the lpc function.\nReferences\nAtluri, M., Chowdury, M., Kanhere, N., Fries, R., Sarasua, W., and Ogle, J. (2009).\nDevelopment of a sensor system for traffic data collection. Journal of Advanced\nTransportation 43, 1\u201320.\nChen, D., Zhang, J., Tang, S., and Wang, J. (2004). Freeway traffic stream modeling\nbased on principal curves and its analysis. IEEE Transactions on Intelligent\nTransportation Systems 5, 246\u2013258.\nDelicado, P. and Huerta, M. (2003). Principal curves of oriented points: Theoretical\nand computational improvements. Computational Statistics 18, 293\u2013315.\nDrake, L. S., Schoefer, J. L., and May, A. D. (1967). A statistical analysis of speed-\ndensity hypotheses. Highway Research Record 154, 53\u201387.\nEinbeck, J., Evers, L., and Hinchliff, K. (2009). Data compression and regression\nbased on local principal curves. In A. Fink, B. Lausen, W. Seidel, & A. Ultsch\n(Eds.), Advances in Data Analysis, Data Handling and Business Intelligence,\nHeidelberg, pp. 701\u2013712. Springer.\nEinbeck, J., Tutz, G., and Evers, L. (2005a). Exploring multivariate data structures\n28\nwith local principal curves. In C. Weihs & W. Gaul (Eds.), Classification - The\nUbiquitous Challenge., Heidelberg, pp. 257\u2013263. Springer.\nEinbeck, J., Tutz, G., and Evers, L. (2005b). Local principal curves. Statistics and\nComputing 15, 301\u2013313.\nGreenshields, B. D. (1935). A study of traffic capacity. Highway Research Board\nProc. 14, 448\u2013477.\nHall, F. L. (2002). Traffic stream characteristics. In N. H. Gartner, C. J. I. Messer,\n& A. Rathi (Eds.), Traffic flow theory: A state-of-the-art report. Georgetown\nPike, VA: Turner Fairbank Highway Research Center (TFHRC).\nHall, F. L., Hurdle, V. F., and Banks, J. M. (1992). Synthesis of recent work on\nthe nature of speed-flow and flow-occupancy (or density) relations on freeways.\nTransportation Research Record 1365, 12\u201317.\nHastie, T. and Stuetzle, W. (1989). Principal curves. J. Amer. Statist. Assoc. 84,\n502\u2013516.\nHuang, S. H. and Ran, B. (2003). An application of neural network on traffic speed\nprediction under adverse weather condition. In TRB 2003 Annual Meeting CD-\nROM. www.ltrc.lsu.edu\/TRB 82\/TRB2003-000915.pdf.\nJia, Z., Chen, C., Coifman, B., and Varaiya, P. (2001). The PeMS algorithms for\naccurate, real-time estimates of g-factors and speeds from single-loop detectors.\nProceedings of the IEEE 4th International ITS Conference.\nKockelman, K. M. (2001). Modeling traffic\u2019s flow-density relation: Accomodation\nof multiple flow regimes and traveler types. Transportation 24, 363\u2013374.\nLi, M. Z. F. (2008). A generic characterization of equilibrium speed-flow curves.\nTransportation Science 42, 220\u2013235.\nPapageorgiou, M., Papamichail, I., Spiliopoulou, A., and Lentzakis, A. (2008). Real-\ntime merging traffic control with applications to toll plaza and work zone man-\n29\nagement. Transportation Research Part C 16, 535\u2013553.\nPescovitz, D. (2001). The mathematics of high-tech highways. ScienceMat-\nters@Berkeley 1, Issue 2.\nR Development Core Team (2009). R: A Language and Environment for Statistical\nComputing. Vienna, Austria: R Foundation for Statistical Computing. ISBN\n3-900051-07-0.\nRamsey, J. (2007). pspline: Penalized Smoothing Splines. R package version 1.0-12.\nR port by Brian Ripley.\nScho\u00a8nhof, M. and Helbing, D. (2007). Empirical features of congested traffic states\nand their implications for traffic modelling. Transportation Science 41, 135\u2013166.\nSheu, J.-B., Lan, L., and Huang, Y.-S. (2009). Short-term prediction of traffic dy-\nnamics with real-time recurrent learning algorithms. Transportmetrica 5, 59\u201383.\nTutz, G. and Leitenstorfer, F. (2007). Generalized monotonic regression based on\nB-splines with an application to air pollution data. Biostatistics 8, 654\u2013673.\nVaraiya, P. (2004). Freeway performance measurement system (PeMS) version 4.\nTechnical Report 31, California Partners for Advanced Transit and Highways\n(PATH).\nWardrop, J. G. (1952). Some theorectical aspects of road traffic research. Proceedings\nof the Institution of Civil Engineers, Part II 1, 325\u2013362.\nWu, N. (2002). A new approach for modelling of fundamental diagrams. Transporta-\ntion Research Part A 36, 867\u2013884.\nXia, J. and Chen, M. (2007). A nested clustering technique for freeway operat-\ning condition classification. Computer-Aided Civil and Infrastructure Engineer-\ning 22, 430\u2013437.\n30\n"}