{"doi":"10.1109\/TMI.2004.830524","coreId":"56301","oai":"oai:eprints.lincoln.ac.uk:1216","identifiers":["oai:eprints.lincoln.ac.uk:1216","10.1109\/TMI.2004.830524"],"title":"Measurement of retinal vessel widths from fundus images based on 2-D modeling","authors":["Lowell, J.","Hunter, Andrew","Steel, D.","Basu, A.","Ryder, R.","Kennedy, R. L."],"enrichments":{"references":[{"id":18442194,"title":"A method of estimating the calibre of retinal arteries in the living eye by means of opthalmoscope, illustrated results in some normal and pathological cases,\u201d Trans.","authors":[],"date":"1936","doi":null,"raw":"H. Neame, \u201cA method of estimating the calibre of retinal arteries in the living eye by means of opthalmoscope, illustrated results in some normal and pathological cases,\u201d Trans. Ophthalmological Societies of the United Kingdom, vol. 56, pp. 155\u2013162, 1936.","cites":null},{"id":18442182,"title":"Accurate vessel width measurement from fundus photographs: a new concept,\u201d","authors":[],"date":"1994","doi":"10.1136\/bjo.78.1.24","raw":"S.M.B. Rassam, V. Patel, 0. Brinchmann-Hansen, O. Engvold, and E.M. Kohner, \u201cAccurate vessel width measurement from fundus photographs: a new concept,\u201d British Journal of Ophthalmology, vol. 78, pp. 24\u201329, 1994.","cites":null},{"id":18442203,"title":"Automated grading of venous beading,\u201d","authors":[],"date":"2000","doi":"10.1006\/cbmr.1995.1020","raw":"P.H. Gregson, Z. Shen, R.C. Scott, and V. Kozousek, \u201cAutomated grading of venous beading,\u201d Computers and Biomedical Research, vol. 28, pp. 291\u2013304, 2000.","cites":null},{"id":18442198,"title":"Comparison of methods of measuring vessel widths on retinal photographs and","authors":[],"date":"2004","doi":"10.1016\/0002-9394(69)93448-5","raw":"J.V. Hodge, J.C. Parr, and G.F.S. Spears, \u201cComparison of methods of measuring vessel widths on retinal photographs and March 5, 2004 DRAFT22 the effect of \ufb02uorescein injection on apparent retinal vessel calibre,\u201d American Journal of Ophthalmology, vol. 68, pp. 1060\u20131068, 1969.","cites":null},{"id":18442205,"title":"Computer algorithms for the automated measurements of retinal arteriolar diameters,\u201d","authors":[],"date":"2001","doi":null,"raw":"N. Chapman, N. Witt, X. Goa, A. Bharath, A.V. Stanton, S.A. Thom, and A.D. Hughes, \u201cComputer algorithms for the automated measurements of retinal arteriolar diameters,\u201d British Journal of Ophthalmology, vol. 85, pp. 75\u201379, 2001.","cites":null},{"id":18442193,"title":"Detection and measurement of retinal vessels in fundus images using amplitude modi\ufb01ed second-order gaussian \ufb01lter,\u201d","authors":[],"date":"2002","doi":"10.1109\/10.979356","raw":"L. Gang, O. Chutatape, and S.M. Krishnan, \u201cDetection and measurement of retinal vessels in fundus images using amplitude modi\ufb01ed second-order gaussian \ufb01lter,\u201d IEEE Transactions on Biomedical Engineering, vol. 49, no. 2, February 2002.","cites":null},{"id":18442190,"title":"Detection of blood vessels in retinal images using two-dimensional matched \ufb01lters,\u201d","authors":[],"date":"1989","doi":"10.1109\/42.34715","raw":"S. Chaudhuri, S. Chatterjee, N. Katz, M. Nelson, and M. Goldbaum, \u201cDetection of blood vessels in retinal images using two-dimensional matched \ufb01lters,\u201d IEEE Transactions on Medical Imaging, vol. 8, pp. 263\u2013369, 1989.","cites":null},{"id":18442183,"title":"Early treatment diabetic retinopathy study research group, \u201cFundus photographic risk factors for progression of diabetic retinopathy,\u201d","authors":[],"date":"1991","doi":"10.1016\/s0161-6420(13)38014-2","raw":"Early treatment diabetic retinopathy study research group, \u201cFundus photographic risk factors for progression of diabetic retinopathy,\u201d Ophthalmology, vol. 98, pp. 823\u2013833, 1991.","cites":null},{"id":18442189,"title":"Locating the blood vessels in retinal images by piecewise threshold probing of a matched \ufb01lter response,\u201d","authors":[],"date":"2000","doi":"10.1109\/42.845178","raw":"A. Hoover, V. Kouznetsova, and M. Goldbaum, \u201cLocating the blood vessels in retinal images by piecewise threshold probing of a matched \ufb01lter response,\u201d IEEE Transactions on Medical Imaging, vol. 19, pp. 203\u2013210, 2000.","cites":null},{"id":18442200,"title":"Microphotometry of the blood column and light streak on retinal vessels in fundus photographs,\u201d","authors":[],"date":"1986","doi":"10.1111\/j.1755-3768.1986.tb00698.x","raw":"O. Brinchmann-Hansen and O. Engvold, \u201cMicrophotometry of the blood column and light streak on retinal vessels in fundus photographs,\u201d Acta Ophthalmologica, Supplement, vol. 179, pp. 9\u201319, 1986.","cites":null},{"id":18442211,"title":"Neural Networks for Pattern Recognition, Clarendon Press,","authors":[],"date":"1995","doi":"10.1145\/294828.1067910","raw":"C.M. Bishop, Neural Networks for Pattern Recognition, Clarendon Press, Oxford, 1995. March 5, 2004 DRAFT23 \ufb01g1.eps24 \ufb01g2a.eps25 \ufb01g2b.eps26 \ufb01g3.eps27 \ufb01g4a.eps28 \ufb01g4b.eps29 \ufb01g5a.eps30 \ufb01g5b.eps31 \ufb01g6a.eps32 \ufb01g6b.eps33 \ufb01g7a.eps34 \ufb01g7b.eps35 \ufb01g8.eps36 \ufb01g9a.eps37 \ufb01g9c1.eps38 \ufb01g9c2.eps39 \ufb01g9c3.eps40 \ufb01g9c4.eps41 \ufb01g9b.eps42 \ufb01g9c.eps","cites":null},{"id":18442187,"title":"Peripheral vascular disease is associated with abnormal arteriolar diameter relationships at bifurcations in the human retina,\u201d","authors":[],"date":"2002","doi":"10.1042\/cs20010281","raw":"N. Chapman, G. Dell\u2019omo, M.S. Sartini, and N. Witt, \u201cPeripheral vascular disease is associated with abnormal arteriolar diameter relationships at bifurcations in the human retina,\u201d Clinical Science (London), vol. 103, pp. 111\u2013116, 2002.","cites":null},{"id":18442209,"title":"Quanti\ufb01cation and characterisation of artieries","authors":[],"date":"2000","doi":"10.1016\/s0169-2607(00)00082-1","raw":"X.W. Goa, A. Bharath, A. Stanton, A. Hughes, N. Chapman, and S. Thom, \u201cQuanti\ufb01cation and characterisation of artieries in retinal images,\u201d Computer Methods and Programs in Biomedecine, vol. 63, pp. 133\u2013146, 2000.","cites":null},{"id":18442184,"title":"Quantitative measurement of changes in retinal vessel diameter in ocular fundus images,\u201d","authors":[],"date":"2000","doi":"10.1016\/s0167-8655(00)00084-2","raw":"L. Pedersen, M. Grunkin, B. Ersboll, K. Madsen, et al., \u201cQuantitative measurement of changes in retinal vessel diameter in ocular fundus images,\u201d Pattern Recognition Letters, vol. 21, pp. 1215\u20131223, 2000.","cites":null},{"id":18442185,"title":"Retinal arteriolar diameters and elevated blood pressure: the atherosclerosis risk in communities study,\u201d","authors":[],"date":"1999","doi":"10.1093\/oxfordjournals.aje.a009997","raw":"A.R. Sharrett, L.D. Hubbard, L.S. Cooper, P.D. Sorlie, et al., \u201cRetinal arteriolar diameters and elevated blood pressure: the atherosclerosis risk in communities study,\u201d American Journal Epidemiology, vol. 150, pp. 263\u2013270, 1999.","cites":null},{"id":18442188,"title":"Retinal microvascular abnormalities and incident stroke: the atherosclerosis risk in communities study,\u201d","authors":[],"date":"2001","doi":"10.1016\/s0140-6736(01)06253-5","raw":"T.Y. Wong, R. Klein, D.J. Couper, L.S. Cooper, et al., \u201cRetinal microvascular abnormalities and incident stroke: the atherosclerosis risk in communities study,\u201d Lancet, vol. 358, pp. 1134\u20131140, 2001.","cites":null},{"id":18442186,"title":"Retinal microvascular abnormalities and their relationship with hypertension, cardiovascular disease and mortality,\u201d","authors":[],"date":"2001","doi":"10.1016\/s0039-6257(01)00234-x","raw":"T.Y. Wong, R. Klein, B.E. Klein, J.M. Tielsch, et al., \u201cRetinal microvascular abnormalities and their relationship with hypertension, cardiovascular disease and mortality,\u201d Survey of Ophthalmology, vol. 46, no. 59-80, 2001.","cites":null},{"id":18442195,"title":"Scanning densitometer for photographic fundus measurements,\u201d","authors":[],"date":"1966","doi":"10.1016\/0002-9394(66)92195-7","raw":"T. Behrendt, \u201cScanning densitometer for photographic fundus measurements,\u201d American Journal of Ophthalmology, vol. 62, pp. 689\u2013693, 1966.","cites":null},{"id":18442192,"title":"Semi-automatic segmentation of vascular network images using a rotating structuring element (rose) with mathematical morphology and dual feature thresholding,\u201d","authors":[],"date":null,"doi":"10.1109\/42.241865","raw":"B.D. Thackray and A.C. Nelson, \u201cSemi-automatic segmentation of vascular network images using a rotating structuring element (rose) with mathematical morphology and dual feature thresholding,\u201d Pattern Recognition, vol. 15, pp. 431\u2013443, 1982.","cites":null},{"id":18442196,"title":"Signs in the fundus oculi and arterial hypertension. unconventional assessment and signi\ufb01cance,\u201d","authors":[],"date":"1967","doi":null,"raw":"A. Kagan, E. Aurell, and G. Tibblin, \u201cSigns in the fundus oculi and arterial hypertension. unconventional assessment and signi\ufb01cance,\u201d Bull WHO, vol. 36, pp. 231\u2013241, 1967.","cites":null},{"id":18442191,"title":"The apparent and true width of the blood column,\u201d","authors":[],"date":"1986","doi":"10.1111\/j.1755-3768.1986.tb00700.x","raw":"O. Brinchmann-Hansen and H. Heier, \u201cThe apparent and true width of the blood column,\u201d Acta Ophthalmologica, Supplement, vol. 179, pp. 29\u201332, 1986.","cites":null},{"id":18442207,"title":"The detection and quanti\ufb01cation of retinopathy using digital angiograms,\u201d","authors":[],"date":"1994","doi":"10.1109\/42.363106","raw":"L. Zhou, M.S. Rzeszotarski, L.J. Singerman, and J.M. Chokreff\u2018, \u201cThe detection and quanti\ufb01cation of retinopathy using digital angiograms,\u201d IEEE Transactions on Medical Imaging, vol. 13, no. 4, December 1994.","cites":null},{"id":18442202,"title":"Theoretical relationships between light streak characteristics and optical properties of retinal vessels,\u201d","authors":[],"date":"1986","doi":"10.1111\/j.1755-3768.1986.tb00701.x","raw":"O. Brinchmann-Hansen and H. Heier, \u201cTheoretical relationships between light streak characteristics and optical properties of retinal vessels,\u201d Acta Ophthalmologica, Supplement, vol. 179, pp. 33\u201337, 1986.","cites":null}],"documentType":{"type":0.5555555556}},"contributors":[],"datePublished":"2004-10","abstract":"Changes in retinal vessel diameter are an important sign of diseases such as hypertension, arteriosclerosis and diabetes mellitus. Obtaining precise measurements of vascular widths is a critical and demanding process in automated retinal image analysis as the typical vessel is only a few pixels wide. This paper presents an algorithm to measure the vessel diameter to subpixel accuracy. The diameter measurement is based on a two-dimensional difference of Gaussian model, which is optimized to fit a two-dimensional intensity vessel segment. The performance of the method is evaluated against Brinchmann-Hansen's half height, Gregson's rectangular profile and Zhou's Gaussian model. Results from 100 sample profiles show that the presented algorithm is over 30% more precise than the compared techniques and is accurate to a third of a pixel","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/56301.pdf","fullTextIdentifier":"http:\/\/eprints.lincoln.ac.uk\/1216\/1\/Lowell2004TMIMeasurementOfRetinalVesselWidthsFromFundusImagesBasedOn2DModeling.pdf","pdfHashValue":"64250ebfddfb51f80705868a843f6acec7839ac5","publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lincoln.ac.uk:1216<\/identifier><datestamp>\n      2013-03-13T08:25:49Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D6A6163735F47:6A6163735F47343030<\/setSpec><setSpec>\n      7375626A656374733D6A6163735F47:6A6163735F47373430<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/eprints.lincoln.ac.uk\/1216\/<\/dc:relation><dc:title>\n        Measurement of retinal vessel widths from fundus images based on 2-D modeling<\/dc:title><dc:creator>\n        Lowell, J.<\/dc:creator><dc:creator>\n        Hunter, Andrew<\/dc:creator><dc:creator>\n        Steel, D.<\/dc:creator><dc:creator>\n        Basu, A.<\/dc:creator><dc:creator>\n        Ryder, R.<\/dc:creator><dc:creator>\n        Kennedy, R. L.<\/dc:creator><dc:subject>\n        G400 Computer Science<\/dc:subject><dc:subject>\n        G740 Computer Vision<\/dc:subject><dc:description>\n        Changes in retinal vessel diameter are an important sign of diseases such as hypertension, arteriosclerosis and diabetes mellitus. Obtaining precise measurements of vascular widths is a critical and demanding process in automated retinal image analysis as the typical vessel is only a few pixels wide. This paper presents an algorithm to measure the vessel diameter to subpixel accuracy. The diameter measurement is based on a two-dimensional difference of Gaussian model, which is optimized to fit a two-dimensional intensity vessel segment. The performance of the method is evaluated against Brinchmann-Hansen's half height, Gregson's rectangular profile and Zhou's Gaussian model. Results from 100 sample profiles show that the presented algorithm is over 30% more precise than the compared techniques and is accurate to a third of a pixel.<\/dc:description><dc:date>\n        2004-10<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/eprints.lincoln.ac.uk\/1216\/1\/Lowell2004TMIMeasurementOfRetinalVesselWidthsFromFundusImagesBasedOn2DModeling.pdf<\/dc:identifier><dc:identifier>\n          Lowell, J. and Hunter, Andrew and Steel, D. and Basu, A. and Ryder, R. and Kennedy, R. L.  (2004) Measurement of retinal vessel widths from fundus images based on 2-D modeling.  Medical Imaging, IEEE Transactions on, 23  (10).   pp. 1196-1204.  ISSN UNSPECIFIED  <\/dc:identifier><dc:relation>\n        http:\/\/dx.doi.org\/10.1109\/TMI.2004.830524<\/dc:relation><dc:relation>\n        10.1109\/TMI.2004.830524<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/eprints.lincoln.ac.uk\/1216\/","http:\/\/dx.doi.org\/10.1109\/TMI.2004.830524","10.1109\/TMI.2004.830524"],"year":2004,"topics":["G400 Computer Science","G740 Computer Vision"],"subject":["Article","PeerReviewed"],"fullText":"1Measurement of retinal vessel widths from\nfundus images based on 2D modelling\nJames Lowell Andrew Hunter David Steel Ansu Basu Robert Ryder\nR. Lee Kennedy\nJ. Lowell and A. Hunter, Dept. Applied Computer Science, University of Lincoln, Brayford Pools, Lincoln, UK.\nahunter@lincoln.ac.uk\nD. Steel, Sunderland Eye Infirmary, Queen Alexandra Road, Sunderland, SR2 9HP\nA. Basu and R. Ryder, Dept. Diabetes and Endocrinology, City Hospital, Dudley Rd., Birmingham, B18 7QH, UK\nR.L. Kennedy, Diabetes Unit, Queen\u2019s Medical Centre, University Hospital Nottingham, NG7 2UH.\nMarch 5, 2004 DRAFT\n2Abstract\nChanges in retinal vessel diameter are an important sign of diseases such as hypertension, arteriosclerosis and\ndiabetes mellitus. Obtaining precise measurements of vascular widths is a critical and demanding process in auto-\nmated retinal image analysis as the typical vessel is only a few pixels wide. This paper presents an algorithm to\nmeasure the vessel diameter to sub-pixel accuracy. The diameter measurement is based on a two-dimensional dif-\nference of Gaussian model, which is optimized to fit a two-dimensional intensity vessel segment. The performance\nof the method is evaluated against Brinchmann-Hansen\u2019s half height, Gregson\u2019s rectangular profile and Zhou\u2019s\nGaussian model. Results from 100 sample profiles show that the presented algorithm is over 30% more precise\nthan the compared techniques and is accurate to a third of a pixel.\nI. INTRODUCTION\nThis paper presents an algorithm for the automatic measurement of blood vessel diameters\nin retinal images. This paper focuses on the specific technical issue of accurate diameter mea-\nsurement, and does not address the other stages involved in the diagnosis of disease based on\nvascular pathology. In particular, we assume that approximate vessel center lines have been pre-\nviously found. We argue that the diameter measurement stage is sufficiently critical to deserve\ncareful study in its own right. Diameter measurements are made by fitting a 2D model, which\nresembles an idealized cross sectional profile running along the length of a vessel segment in a\nsmall region of interest. The model is fitted on an intensity image produced by extracting the\ngreen channel from an original color digital image. We evaluate the algorithm against alternative\napproaches using a set of 100 cross section profiles from five down-sampled high definition fun-\ndus images, and present results showing that it is significantly superior to previously published\nmethods.\nA. Motivation\nThe retinal vessels are the only part of the central circulation that can be viewed directly and\nstudied in detail [1]. Segmentation and measurement of the retinal vessels is therefore of cen-\ntral interest in a number of diseases, including some that are primarily retinal disorders, such\nas diabetic retinopathy - the leading cause of blindness in the working population of industrial-\nized countries [2] - and others, such as arteriosclerosis, hypertension and stroke, which are not\nprimarily retinal, but where it is known that changes in the morphology of the retinal vessels\ndo occur, and can be predictive of risk. In general, automated segmentation and measurement\nMarch 5, 2004 DRAFT\n3is desirable to improve reliability and reproducibility of measurements, and in some cases to\nsupport wide-spread automated screening for vascular conditions.\nA variety of morphological changes occur to retinal vessels in different disease conditions;\nhowever, in this paper we are exclusively concerned with changes in the calibre (diameter, width)\nof vessels. The change in width of retinal vessels within the fundus is believed to be indicative of\nthe risk level of diabetic retinopathy [3]; venous beading (unusual variations in diameter along\na vein) is one of the most powerful predictor of proliferate diabetic retinopathy [2]. Generalized\nand focal retinal arteriolar narrowing and arteriovenous nicking have been shown to be strongly\nassociated with current and past hypertension reflecting the transient and persistent structural\neffects of elevated blood pressure on the retinal vascular network [4] [5]. In addition retinal\narteriolar bifurcation diameter exponents have been shown to be changed significantly in patients\nwith peripheral vascular disease and arteriosclerosis [6] and a variety of retinal microvascular\nabnormalities have been shown to be related to the risk of stroke [7]. Future precise retinal\nvascular analysis may allow risk stratification of a variety of arteriosclerotic diseases and clarify\nthe microvascular contributions to clinical cardiovascular disease. It is worth noting that, in all\nthese cases, it is not the absolute diameter of the vessel that is of interest, but variation in the\ndiameter along a vessel.\nSegmentation of vessels and measurement of the vascular diameter are two critical and chal-\nlenging technical tasks in any system attempting automated diagnosis of vascular conditions.\nA number of methods for segmenting the vascular network have been reported in the literature\n[8] [9], with some success at least for larger vessels, although many papers gloss over the dif-\nficulty of reliably segmenting vessels in images of diseased retina, where there are significant\ndistractors present; robust segmentation therefore remains an important research issue.\nThis paper concentrates on the diameter measurement issue. On a standard 30\u25e6 fundal image\nwith resolution 760 \u00d7 570, moderately sized vessels are as little as 6\u20138 pixels in width. Con-\nsequently, even with improving fundal camera resolutions, errors in diameter measurement of\nthe order of a single pixel are large enough to significantly compromise attempts to characterize\nanomalies in vessel width, except for gross anomalies on the largest vessels. We are not aware\nof any studies indicating exactly at what point vascular diameter changes become clinically sig-\nnificant in different conditions \u2013 it may indeed be that such studies have not yet been conducted\nMarch 5, 2004 DRAFT\n4due to the difficulty in making sufficiently accurate measurements. Nonetheless, given the level\nof accuracy of existing algorithms and the fact that vascular conditions are progressive, we be-\nlieve that improvements in the accuracy of the diameter measurement algorithm may potentially\nprove very valuable.\nThis paper introduces a new algorithm, based on fitting a local 2D vessel model, which can\nmeasure vascular width to an accuracy of about one third of a pixel. We demonstrate that this\nis significantly better performance than previously published methods. The method may be\nintegrated with any vessel segmentation algorithm [8] [9], and with any algorithm to diagnose\npathology on the basis of vessel calibre. Although we do not, in this paper, attempt to apply the\ndiameter measurement algorithm in diagnosis of any particular vascular pathology, we believe\nthe technique is of sufficiently widespread potential to be of interest in its own right.\nB. Contents of Paper\nIn section II we outline the retinal vessel structure and discuss the true versus apparent width\nof the blood column. We briefly describe common vessel segmentation algorithms in Section\nIII, and overview previously published diameter-measuring algorithms in Section IV. In section\nV we discuss the new diameter-measurement algorithm. We evaluate the algorithm against\nalternatives from the literature in section VI and conclude in Section VII.\nII. RETINAL VESSEL STRUCTURE\nLight emitted from a fundus camera or ophthalmoscopy is reflected back by the retina and\nchoroids. Blood vessels absorb some of the reflected light, absorbing into the wall and the\nblood. When an image of a blood vessel is viewed from point C (see figure 1), the apparent\nwidth of the vessel is believed to be the width of the streaming column of erythrocytes viewed\nperpendicular to the flow direction (point P) [10]. The surrounding plasma zone and the vessel\nwall are transparent. Variations in the thickness of the vessel wall and the index of refraction\nhave negligible influence on the apparent width of the blood column.\nDue to the measured indices of refraction in the plasma and vitreous, it is accepted that within\nwide physiological limits the apparent width of the blood column is proportional to the true\nwidth [10]. Looking at the retinal blood vessel as a vascular cross-section, the overall transmit-\ntance through a vessel including the blood column and wall resembles a Gaussian curve. Finding\nMarch 5, 2004 DRAFT\n5fig1.eps\nFig. 1. The apparent and true width of the blood column Based on Brinchmann-Hansen, 0; Heier, H. Acta Oph-\nthalmolog. Suppl. 1986,179,29-32.\nthe point that the blood column meets the wall on that curve is extremely difficult and has in-\nspired many algorithms (see section IV). To complicate the problem further, some blood vessels\ninclude a light streak known as a light reflex that run down the central length of the blood vessel.\nNa\u0131\u00a8ve approaches can be fooled into thinking that the light reflex is the edge of the vessel.\nThe light reflex is understood to run across the surface of the plasma zone and the blood\ncolumn and is believed to be generated from a rough reflecting surface and the intravascular\ncolumn of erythrocytes [10]. Light reflexes are more common in younger retinas due to their\nincreased reflective surfaces. However, arteriosclerosis can also affect the appearance of the light\nreflex by changing the reflective index of the vessel wall, thus increasing the observed intensity.\nIII. OVERVIEW OF VESSEL SEGMENTATION ALGORITHMS\nThis paper presents an algorithm for measuring the vascular diameter, which is designed for\nuse in a larger system. The overall process consists of detecting and segmenting vessels, sam-\npling points along vessels; measuring diameters; and drawing conclusions about vascular health.\nThe contribution of this paper is in vascular measurement, not segmentation. Nonetheless, in this\nsection we briefly discuss the first of these stages, to place the diameter measurement method in\ncontext.\nIn the vascular segmentation stage, the approximate centreline of vessels is detected. A num-\nber of algorithms for this process have been published. The most popular approach is to use an\nelongated linear filter with a Gaussian or similar profile, rotated through a number of angles and\nconvolved with the image [8] [9] [11] [12]. The highest response filter is selected for each pixel\nand can be thresholded to provide a vessel image, which is subsequently thinned and cleaned up\nMarch 5, 2004 DRAFT\n6to identify vessel segments. This convolution approach encounters a number of problems due to\nthe retinal background variation and low contrast of the fainter vessels with the local surround-\nings. It is also prone to false responses around bright objects such as exudates and reflection\nartifacts.\nIn this paper we use our own non-linear order-statistic based \u201ctramline\u201d filter, which is robust\nagainst bright object distractors. Briefly, it is a generalized grey-level morphological top-hat\nfilter, with two specialized structuring elements: first, a line oriented along the direction of\nthe blood vessel; second, two \u201ctram-lines\u201d oriented in the same direction and lying to either\nside of the vessel. The filter response is the difference between the minimum intensity in the\nouter tramline structuring element and the maximum intensity level in the inner line structuring\nelement. This filter has a strong response when the inner line is aligned within a blood vessel\nand the outer tramlines to either side of the vessel. The lines are each of length nine pixels,\nwith the tramlines displaced five pixels to either side of the central line. The filter is rotated\nthrough twelve angles and the maximum response selected. In reality, maximum and minimum\nvalues are too noise-sensitive, and we use the third largest and third smallest values instead. We\nevaluated the algorithm on the Stare database [8], calculating the percentage of the gold-standard\nvasculature recovered by length, and the degree of false positive vessel detection as a percentage\nof gold-standard length (this contrasts with Hoover\u2019s evaluation which is per-pixel). Under these\ncriteria, the Stare method achieves 57% sensitivity by length, with 8.5% false positive rate; the\ntram-line algorithm achieves 57.2% sensitivity and 2.9% false positive rate.\nA typical vessel map is shown in figure 2. Once segmented, the vessel center lines are regu-\nlarly sampled to provide points for diameter measurement. Diameter measurement algorithms,\nincluding ours, do not function correctly at major vessel branch points, crossing points, or where\nthere are parallel vessels in close proximity or overlapping (where junction exponents are to\nbe calculated the measurements are made just before and after the junction, not on it). Our\nalgorithm inherently removes junction points and crossings, which is advantageous for some\napplications, such as venous beading detection, and disadvantageous for others (detection and\nmeasurement of junctions). The diameter measurement algorithm, however, is entirely separate\nfrom the segmentation algorithm.\nMarch 5, 2004 DRAFT\n7fig2a.eps fig2b.eps\nFig. 2. Pre-processing a) Vessel map. b) Vessel map overlay.\nIV. DIAMETER MEASUREMENT ALGORITHMS\nVascular response to different physiological pathologies has been widely studied using a va-\nriety of methods. Measurements have been made both directly using ophthalmoscopy and in-\ndirectly using fundus photographs. Direct methods that require ophthalmoscopic observations\nare often inaccurate due to non-standardized illumination, low magnification, and a subjective\nbias [13]. More objective measurements are possible from fundus images in which the film\ntransmission has been converted to intensity [14] [15] [16]. Converting the film transmission to\nintensity has been described as the only objective measure of the properties of the photographed\neye; however, the observer has a restricted ability in discriminating between grey intensity levels\n[17], so that the measuring \u201cby eye\u201d directly from green channel intensity images is difficult and\nerror prone.\nAs a result, a vascular cross-section is often presented in graphical form; see figure 3. The\nintensity level of the background retina is often different on either side of the vessel and the\nvessel often contains a bright reflex.\nDue to pulse variations in vessel calibre, retinal photographs taken at the same fundus posi-\ntion will not yield the same vascular width, if exposed at different times. However, the use of\nrelative widths (i.e. the ratios of individual widths to the average vessel width) can ensure repro-\nducibility, as pulse characteristics, as with variable illumination conditions from incident light,\nare discounted in ratios. It is also important to note that, for automated diagnostic purposes,\nobtaining consistent measurements is more important than obtaining the actual vessel widths, as\nit is variations in widths along a vessel, or ratios of widths at difference points in the vessel, that\nMarch 5, 2004 DRAFT\n8fig3.eps\nFig. 3. Sample vessel profile.\nfig4a.eps fig4b.eps\nFig. 4. a) Full width half maximum. b) Rectangular profile.\nis of interest, rather than the absolute value of the width.\nSeveral previous authors have presented algorithms for measuring vascular diameters. Brinchmann-\nHansen et al [17] [18] measured widths of retinal vessels using micro densitometry and observed\nthe importance of the central light reflex which prevents na\u0131\u00a8ve approaches from working well.\nThey presented an algorithm called Full Width Half Maximum (FWHM) to measure vascular\ndiameters. This approach calculates a \u201chalf height point\u201d on the left and right sides of the initial\nestimated mid-point of the profile. On each side, the minimum and maximum intensity levels\nare calculated, and the \u201chalf height point\u201d is located where the profile crosses the mid point in\nintensity between the minimum and maximum. The FWHM estimate of the profile width is then\nthe distance between these half height points; see figure 4a. This approach is also called Half\nHeight Full Width (HHFW).\nGregson et al [19] introduced an alternative approach, comprising of a rectangular profile of\na fixed height that is fitted to the profile data. The height is fixed to the difference between the\nminimum and maximum intensity values in the profile. The width of the rectangular profile is\nMarch 5, 2004 DRAFT\n9adjusted until the area under the rectangular profile is equal to the area under the profile data;\nsee figure 4b.\nChapman et al [20], compares three methods of automated vascular measurements with man-\nual recorded vessel diameters. A Gaussian function using non-linear regression, a Sobel edge\ndetection algorithm and a sliding linear regression filter (SLRF) are all compared. Chapman\nstates that using the Sobel edge detection algorithm to locate the blood vessel edges is unreliable\ndue to a tendency to wrongly locate the central light reflex as the vessel edge. Chapman found\nthe SLRF method to be most accurate and robust of these three methods; however, it is not prac-\ntical for low-resolution images, as a minimum number of 10 pixels are required to estimate the\nslope by linear regression.\nChapman et al [20] and Zhou et al [21] have both experimented with Gaussian fitting func-\ntions to estimate vessel width. Chapman reported the Gaussian function fairing badly in compar-\nison with the SLRF method. Zhou, on the other hand, reported promising results using a Gaus-\nsian model. Pedersen et al [3] presented an algorithm that used a cubic spline with 6 degrees\nof freedom to model the vascular profile and reduce noise. This method did not measure vessel\ndiameters directly, but helped to reduce noise and relied upon Gregson\u2019s rectangular profile for\nwidth measurements. Gao et al [22] used a Difference-of-Gaussian to improve performance on\nvessels with a light reflex.\nA number of authors have used matched filters to detect and segment blood vessels, including\nfilters with Gaussian profiles. Gang et al [12] showed that the width control parameter of a\ngaussian profile matched-filter is linearly related to the actual blood vessel width.\nThe majority of the aforementioned approaches use a one-dimensional cross-sectional profile\nto measure the vascular diameter. Matched filters, in contrast, form a two-dimensional profile\nthat is more resilient to poorly positioned profiles, and poorly defined vascular edges, but are ap-\nplied at set sizes (typically in steps of one pixel). The proposed method uses a two-dimensional\nmodel with a Gaussian or Difference-of-Gaussian profile, which is iteratively optimized to best\nfit the observed vessel. This allows us to calculate the vessel width to sub-pixel accuracy, and\nthe smoothing introduced by the two-dimensional nature of the profile improves this accuracy.\nIn this paper the presented algorithm is compared to a Gaussian fitting function, HHFW and\nGregson\u2019s rectangular profile and superior performance is demonstrated.\nMarch 5, 2004 DRAFT\n10\nV. METHOD\nA. Model definition\nThe 2D model in its most basic form consists of an idealized straight vessel segment, with\na Gaussian profile, G1, orthogonal to the vessel direction, which can be optimized to closely\nmap a vessel segment; see figure 5. The size and shape of the model is controlled by a small\nnumber of parameters, which can be adjusted to fit the model to the actual vessel profile; we use\nvariable-metric optimization to find a good set of parameters. As it is important that the model\nmimics the vessel segment being measured as accurately as possible, a variation can be used to\nmodel the light reflex that is apparent in some vessel segments. This is achieved by subtracting\na second small Gaussian curve, G2, from the main one. The second Gaussian is oriented at the\nsame angle as the first, and is independently adjustable allowing the overall model to fit well to\nboth blood vessel column wall and light reflex. As not all vessel segments have a light reflex,\nboth models with and without light reflex are fitted and the model with the best fit is selected.\nThe 2D model without light reflex (see figure 5) has a profile shape governed by equations 1\nand 2.\n\u03b1 = xsin \u03b8 \u2212 ycos \u03b8 \u2212 \u00b5 (1)\nfx,y = t\u2212 h1e\u2212s1\u03b12 (2)\nwhere x and y map the profile data range in this example from \u221210 to +10 in increments of 1.\nThe model parameters are: t, the profile maximum; h1, the height of the Gaussian; s1, the width\nof the Gaussian, equal to 1\n\u03c321\n; \u03b8, the orientation of the model; and \u00b5, the offset of the Gaussian\ncenter from the initial center estimate, orthogonal to the orientation. Figure 5 illustrates the\nmodel and parameters (barring \u00b5).\nThe two-dimensional model with light reflex shares the same base parameters as its non light\nreflex counterpart. The light reflex variation to the core archetype consists of a Gaussian curve\nG2 subtracted from G1. Additional parameters are included to control the shape and size of\nthe light reflex. These parameters, h2 and s2, set the height and width of the Gaussian G2\nrespectively. The model with light reflex is expressed by equation 3, and illustrated in figure 6.\nMarch 5, 2004 DRAFT\n11\nfig5a.eps\nfig5b.eps\nFig. 5. Model without Light Reflex. a) Cross-section of Profile. b) Two-dimensional Representation.\nfig6a.eps\nfig6b.eps\nFig. 6. Model with Light Reflex. a) One-dimensional Representation. b) Two-dimensional Representation.\nfx,y = t\u2212 (h1e\u2212s1\u03b12 \u2212 h2e\u2212s2\u03b12) (3)\nB. Optimization\nB.1 Two stage optimization process\nA two-stage optimization process is used to orientate and shape the models to fit a 2D vessel\nsegment, within an oriented rectangular region of interest centered at an initial point, (px, py),\ntaken from the vascular profile, and oriented along the vessel line as estimated from previous\nand next points in the vascular profile; see figure 7. In the first stage, a relatively long vascular\nregion of interest is formed, the model width is fixed to a fairly broad value, and the algorithm\ndetermines the exact orientation, offset and height. In the second stage, a shorter region of\ninterest is formed, the orientation is fixed, and the width, offset and height are determined to\nMarch 5, 2004 DRAFT\n12\ngreater accuracy. Models both with and without a light reflex are optimized at each stage, the\nmodel which best fits the vessel segment is selected, and the width is calculated from the final\nparameters.\nThe two stage process is necessary for two reasons. First, the short model is poor at determin-\ning the angle as it lacks sufficient support along the vessel line. Second, it is prone to \u201cdefault\nerrors,\u201d where the model completely fails to capture the vessel shape (e.g. by forming a very\nwide, flat Gaussian fitted on one side to the background region) if the initial settings are too\nfar from the correct values. The first stage, however, is very robust. It handles well the entire\nrange of typical vessel widths, and inaccuracies in the initial vessel center line up to 66% (at a\n95% confidence level there is no statistically significant change in vessel width measurements\nup to this disarticulation). In our experience it is almost unknown for the algorithms that deter-\nmine the initial line to exceed a 66% error in center line determination. Once the first stage has\ndetermined the angle, and reasonable starting values for the other parameters, the second stage\ndetermines a more accurate local width measurement, and is very reliable.\nB.2 Vascular region of interest and mask\nThe 2D model is fitted to a local section of vessel, within a rectangular region of interest\n(ROI) that is oriented at the initial estimated angle, \u03b8, of the blood vessel. The use of an ori-\nented ROI is important as the background intensity varies fairly quickly, and there may be other\nvessel segments nearby; in early work using a square region of interest oriented with the image\naxes, we found that such features in the corners of the ROI could have detrimental effects. For\ncomputational convenience we calculate the bounding rectangle of the ROI, and form a mask\nto identify the ROI; see figure 7. We then perform the calculations over the bounding rectan-\ngle, and multiply through by the mask, zx,y, to ensure that only the pixels within the ROI take\neffect. Given a ROI of length L (along the vessel orientation) and width W (orthogonal to it),\nthe mask is applied to a region area from px \u2212 X to px + X and py \u2212 Y to py + Y , where\nX = (L cos \u03b8 +W sin \u03b8), Y = (L sin \u03b8 +W cos \u03b8).\nThe size of the ROI depends upon the stage of model optimization. In the first stage a 15\u00d7 15\nROI is used to enable the 2D model to fix the local angle against a sufficiently long vessel seg-\nment and to find the vessel \u201cline\u201d despite noise. In the second phase a 5\u00d7 20 ROI allows the 2D\nmodel obtain a good localized diameter measurement. With the average width of larger vessels\nMarch 5, 2004 DRAFT\n13\nfig7a.eps fig7b.eps\nFig. 7. Vascular model. a) Vessel segments points. b) Mask and Region of Interest\nin a 760\u00d7 570 fundus images being 6\u2212 9 pixels, both ROI are large enough to allow flexibility\nfor off centered and beaded vessels, and to accommodate sufficient areas of the background.\nB.3 Initial settings of model\nThe initial settings of the model parameters are extremely important. Bad initial settings may\nresult in poor parameter optimization and an undesirable fit between model and vessel, leading\nto an inaccurate width measurement.\nThe initial settings for all of the parameters have been determined by trial and error. We set\nh1 = 1.5d, h2 = 0.5d where d is the difference between the minimum and maximum intensity\nvalues within the region of interest. The offset \u00b5 is set to zero. The width of the Gaussian G1, s1,\nis set to 0.1, giving a medium width with respect to the expected range, allowing the model to fit\nto both larger and smaller profiles. The width of the Gaussian G2, s2, is set to 0.8. The value of\n\u03b8 is determined by the vector connecting neighboring vessel segment points Pn\u22121 to Pn+1 (this\ngives a good enough starting value for the model to be optimized to the true angle).\nB.4 Parameter Optimization\nTo effectively optimize the model, we used Quasi-Newton (variable metric) minimization\n[23], a fast iterative algorithm that adjusts the model from the initial settings, by minimizing\nan error function that summarizes the goodness of fit of the current model. The procedure also\nrequires a function giving the gradient of the error function with respect to each of the model\nparameters. The error function we use is the sum-squared disparity between the model estimate\nand actual intensity values at the centers of the pixels in the region of interest, as expressed by\nequation 4.\nE =\n1\n2\nX\u2211\nx=\u2212X\nY\u2211\ny=\u2212Y\nzx,y(fx,y \u2212 Ipx+x,py+y)2 (4)\nMarch 5, 2004 DRAFT\n14\nWhere I is the image, f the model and z is the region of interest mask. The model is substi-\ntuted by equations 5 and 6 for two-dimensional models without and with light reflex respectively.\nThe formulae for the gradients of this error function with respect to the model parameters are\ngiven in Appendix A.\nC. Determining the model width\nOnce the model has been fitted, its parameters are used to estimate the vessel width. As\npreviously noted, for further automated analysis it is important that the width measurement be\nconsistent, rather than that it coincide with the user\u2013perceived edge of the blood column, and\nany consistent bias can easily be removed.\nFor the single Gaussian model, the sigma parameter is the most appropriate estimator; this\ncoincides with the inflection point on the slope of the vessel side. For the Difference-of-Gaussian\nmodel, we also use the inflection point on the side slope; however, there is no simple analytical\nexpression that yields its position. Instead, we use a simple line search procedure to locate a\nzero of the second derivative of the model, and the offset of this inflexion point defines the\nvessel width.\nVI. TESTING AND RESULTS\nA. Benchmarking Method\nThe refractive index and the distance between the retina and the camera lens affect vascular\ndiameters observed from a retinal camera [20]. Absolute measures of diameter are therefore\ndifficult to obtain. The only appropriate method of testing and comparing a new measurement\ntechnique is to compare measurements from the same vessel. To this end we tested the accuracy\nand precision of the presented algorithm using 100 gold standard widths obtained from five\nhigh-resolution fundus images with a 45 degree field of view, and photographed using a Canon\n60uv fundus camera. All 100 vessel widths were selected from non-tortuous vessel segments\nbetween bifurcations. The dimensions of the high-resolution images were 3300 \u00d7 2600 pixels,\napproximately four times larger than the standard 760\u00d7570 lower resolution fundus counterparts\nused in our screening programs. By manually measuring widths on the high-resolution images,\nand down-sampling the images to test the algorithms at low resolution, we obtain gold standard\nwidths with sub-pixel accuracy. It is against this benchmark that the accuracy and precision of\nMarch 5, 2004 DRAFT\n15\nfig8.eps\nFig. 8. Kick Points\nthe algorithm was measured.\nThe width measurements from the aforementioned high-resolution images were taken at seg-\nment points and fixed angles derived by the algorithm during the blood vessel segmentation and\nprofile data extraction phases. At segment point P the angle \u03b8 was used to plot an orthogonal\nprofile line to the vessel centreline. The profile length from the full size fundus images was set\nto 80 pixels, 4 times larger than that used in the scaled image; the profile was constructed using\nbilinear interpolation.\nA sophisticated technique called \u201ckick points\u201d, due to Rassam et al [1], was used to manually\ncalculate the vascular widths from the full size images. The \u201ckick points\u201d are visible points on\nthe slopes of intensity profiles, defined as the first skew points. Kick points occur where the\nwall meets the most lateral extent of the blood column; the horizontal distance between the kick\npoints indicates the blood column width (see figure 8) .\nRassam et al [1], states that the kick points approach is more accurate than finding the width\nat half the height; however, kick points are not always visible. If the blood column and the\nvessel wall have the same optical densities then kick points will not appear. To observe the kick\npoints, the photograph must be high resolution and well focused, as the shape of the intensity\ncurve changes with focusing. This makes the detection of the kick points difficult but has no\neffect on the degree of separation between points. On our images, kick points were visible on\nthe high-resolution images, but not on the down-sampled versions.\nThe sections of the images used, vessel locations, measurement points and gold standard\nwidth are available from http:\/\/facs.lincoln.ac.uk\/Research\/LowellDiameter.htm,\nto allow other authors to compare with our method.\nMarch 5, 2004 DRAFT\n16\nB. Models tested\nA comparison was made between the presented algorithm and three other well-established\napproaches. The algorithms of Brinchmann-Hansen and Heier\u2019s full width half maximum [18],\nGregson et al\u2019s rectangular profile [19] and Zhou et al\u2019s Gaussian model [21] were implemented\nusing exactly the same intensity profiles calculated at the same segment points and angles as the\n2D model. As previously discussed, the 2D algorithm is given a rectangular region of interest\ncentered at the initial profile center point. In contrast, the three benchmark algorithms use a one-\ndimensional profile which we determine by bi-linear interpolation along the profile direction.\nOne justification for using a 2D model is that this smooths the local diameter estimates. As\nan additional comparison, we also collected the average width measurement from an ensemble\nof 1D profiles spanning the same range as the 2D model, to see if similar results can be obtained\njust by averaging 1D profiles. The reasoning behind this study was to confirm that the 2D model\nwas not just behaving like a series of 1D Gaussian models. In this test, if any of the ensemble\n1D profile parameters were outside a specified range (indicating a failure in model fitting) that\nprofile was excluded from the averaging process (one-dimensional profiles are more susceptible\nto such instabilities than the 2D model).\nC. Results\nIn this application it is more important that the algorithm produces results that are precise\n(low error variance) than accurate (low mean error), as consistency is more significant than\nabsolute diameter. Any consistent bias is easily subtracted to determine the true width. However\nif the results fluctuate, no compensation is possible. For this reason, the error standard deviation\nwas used rather than the mean to assess the performance of the algorithms. The 100 width\nestimates, \u03c9i, returned from each algorithm were subtracted from 100 appropriately scaled user\nbenchmark widths, \u03c8i, giving a width difference \u03c6i = \u03c9i \u2212 \u03c8i. The standard deviation of the\nwidth differences was then taken, \u03c3\u03c6.\nWe verified that the difference in standard deviations between the 2D model and the alternative\napproaches is statistically significant. An F-test was performed to test the null hypothesis that the\nvariance of the 2D model is equal to that of the next best model, the \u201caverage 1D\u201d model. The\nF-test uses the variance ratio (0.52\/0.342=2.212) to test for significant differences in variances.\nMarch 5, 2004 DRAFT\n17\nTABLE I\nSTANDARD DEVIATION OF WIDTH DIFFERENCE AT A SCALING OF 4\n\u03c3\u03c6\n2D Model 0.34\nAvg 1D Gaussian 0.5\n1D Gaussian 0.58\nHHFM 0.62\nGregson 0.84\nWith 99 degrees of freedom in each sample, the F-test critical values are 1.39 at 95% confidence,\n1.6 at 99% confidence. Consequently we reject the null hypothesis, and conclude that the 2D\nmethod is better than the average 1D model, even at the 99% confidence level. Similar pairwise\ncomparisons indicate the superiority of the 2D model over the other alternative algorithms.\nZhou et al [21] claimed that their approach, the 1D Gaussian model, was more precise than\nother algorithms, including FWHM. Our study supports this claim. However, the presented 2D\nalgorithm is 32%more precise again. The 1D Gaussian model is also prone to failure to converge\nsufficiently enough to obtain a sensible width reading (4% of diameters in our tests). Using an\nensemble of 1D models eradicates this problem, and so the ensemble estimate out-performed\nthe single Gaussian model.\nIt is worth noting that the 2D model algorithm is accurate, on average, to 0.34 of a pixel; given\nthat the manual process underlying the ground-truth measurements for the tests is accurate to\nonly 0.25 pixels this is excellent performance. If a more accurate ground-truth were available it\nis possible that even better performance could be demonstrated.(see figure 9a).\nD. Effectiveness of the light reflex model\nTo assess the effectiveness of the model\u2019s light reflex in producing a more precise measure-\nment, 20 benchmark widths that include a visible light reflex were used to compare against\nwidths taken from the model with and without light reflex. It was found that the 2D model with\nlight reflex gave results that were 13% more precise than given by its basic model counterpart\nin cases where the vessel segment included a light reflex. Although the improvement in the\nMarch 5, 2004 DRAFT\n18\nperformance by using a light reflex model is marginal, it is statistically significant.\nE. Effect of high curvature on precision\nTo evaluate the effect of high curvature vessel segments on the model\u2019s precision, 28 widths\nfrom high curvature points were calculated. It was found that at the 95% confidence level, there\nwas no statistically significant change in width precision between normal and high curvature\nwidths (see figure 9b). This gives us some confidence that the algorithm will work to a reason-\nable extent even on somewhat tortuous vessels, although we note that both segmentation and\nmeasurement are liable to fail on profoundly looped vessels, where the vessel crosses itself or\ntwo segments run very closely in parallel. Detailed measurement of neovascular vessels remains\nan open question.\nF. Effect of beaded vessels on precision\nTo assess the consequence of dramatic width changes within a vascular segment, 40 widths\nfrom beaded vessels were taken. The algorithm deteriorated the standard deviation increasing by\n\u03c3\u03c6 = 0.124 pixels to \u03c3\u03c6 = 0.464 pixels (a statistically significant difference at 95% confidence).\nThe other algorithms suffered a similar deterioration in precision with Gregson\u2019s method per-\nforming second best at \u03c3\u03c6 = 0.771 pixels. Comparing these two models show that the 2D model\nis better than Gregson\u2019s method and the findings were statistically significant at 99% confidence.\n(see figure 9c).\nVII. CONCLUSION AND DISCUSSION\nWe have presented an algorithm to automatically extract width measurements from retinal\nvessels. This plays a critical part in the structured analysis of the retina, and is potentially useful\nin the automated diagnosis of eye diseases such as diabetic retinopathy and arteriosclerosis.\nComparing the vascular widths returned by the presented algorithm, HHFW, Gregson and\na 1D Gaussian, it was shown that the presented model is more precise by over 30%. This is\na considerable amount when small changes in the vascular diameter can alter the outcome of\nsearches for pathology.\nDuring model fitting, a sophisticated optimization (Quasi-Newton) strategy was used, and\nappropriate energy function derivatives introduced.\nMarch 5, 2004 DRAFT\n19\nfig9a.eps\nfig9c1.eps fig9c2.eps\nfig9c3.eps fig9c4.eps\nfig9b.eps\nFig. 9. Detected widths on: Top) straight; Middle) curved; Bottom) beaded vessel segment.\nThe use of a 2D model circumvents problems caused by noisy data such as small vessel\nbranches and introduces a degree of smoothing that helps to improve the model fit. We have\nshown that the inclusion of a Difference-of-Gaussians model improves performance over a single\nGaussian where there is a visible light reflex. Finally, we note that the algorithm is robust enough\nto make sub-pixel accurate measurements on relatively low-resolution images, where vessels are\nonly a few pixels wide.\nMarch 5, 2004 DRAFT\n20\nAPPENDIX A\nThe Quasi-Newton (BFGS) optimization procedure uses a gradient descent approach, and\nconsequently requires the calculation of the gradient of the error function with respect to the\nmodel parameters.\nThe differential of the error function (see equation 4) with respect to the model f is given by:\n\u03b4E\n\u03b4f\n=\nX\u2211\nx=\u2212X\nY\u2211\ny=\u2212Y\nzx,y(fx,y \u2212 Ipx+x,py+y) (5)\nIndividual terms of the error gradient are derived by using the chain rule, multiplying equation\n5 by the differentials of the model with respect to individual parameters.\nThe partial differentials for the parameters h1, h2, s1, s2, \u00b5 and \u03b8 (see equations 1 and 3) are\nexpressed below:\n\u03b4f\n\u03b4h1\n= \u2212e\u2212s1\u03b12 (6)\n\u03b4f\n\u03b4h2\n= e\u2212s2\u03b1\n2 (7)\n\u03b4f\n\u03b4s1\n= h1\u03b1\n2e\u2212s1\u03b1\n2 (8)\n\u03b4f\n\u03b4s2\n= \u2212h2\u03b12e\u2212s2\u03b12 (9)\n\u03b4f\n\u03b4\u03b8\n= 2\u03b1(\u2212x sin \u03b8 + y cos \u03b8)(h1s1e\u2212s1\u03b12 \u2212 h2s2e\u2212s2\u03b12)\n(10)\n\u03b4f\n\u03b4\u00b5\n= 2\u03b1(\u2212h1s1e\u2212s1\u03b12 + h2s2e\u2212s2\u03b12) (11)\nMarch 5, 2004 DRAFT\n21\nACKNOWLEDGMENT\nThis project was supported by Diabetes UK, Project Grant No. BDA:RD00\/0002033.\nThe authors would like to thank the referees for their detailed and useful suggestions, which\nhave helped to greatly improve this paper.\nREFERENCES\n[1] S.M.B. Rassam, V. Patel, 0. Brinchmann-Hansen, O. Engvold, and E.M. Kohner, \u201cAccurate vessel width measurement\nfrom fundus photographs: a new concept,\u201d British Journal of Ophthalmology, vol. 78, pp. 24\u201329, 1994.\n[2] Early treatment diabetic retinopathy study research group, \u201cFundus photographic risk factors for progression of diabetic\nretinopathy,\u201d Ophthalmology, vol. 98, pp. 823\u2013833, 1991.\n[3] L. Pedersen, M. Grunkin, B. Ersboll, K. Madsen, et al., \u201cQuantitative measurement of changes in retinal vessel diameter\nin ocular fundus images,\u201d Pattern Recognition Letters, vol. 21, pp. 1215\u20131223, 2000.\n[4] A.R. Sharrett, L.D. Hubbard, L.S. Cooper, P.D. Sorlie, et al., \u201cRetinal arteriolar diameters and elevated blood pressure:\nthe atherosclerosis risk in communities study,\u201d American Journal Epidemiology, vol. 150, pp. 263\u2013270, 1999.\n[5] T.Y. Wong, R. Klein, B.E. Klein, J.M. Tielsch, et al., \u201cRetinal microvascular abnormalities and their relationship with\nhypertension, cardiovascular disease and mortality,\u201d Survey of Ophthalmology, vol. 46, no. 59-80, 2001.\n[6] N. Chapman, G. Dell\u2019omo, M.S. Sartini, and N. Witt, \u201cPeripheral vascular disease is associated with abnormal arteriolar\ndiameter relationships at bifurcations in the human retina,\u201d Clinical Science (London), vol. 103, pp. 111\u2013116, 2002.\n[7] T.Y. Wong, R. Klein, D.J. Couper, L.S. Cooper, et al., \u201cRetinal microvascular abnormalities and incident stroke: the\natherosclerosis risk in communities study,\u201d Lancet, vol. 358, pp. 1134\u20131140, 2001.\n[8] A. Hoover, V. Kouznetsova, and M. Goldbaum, \u201cLocating the blood vessels in retinal images by piecewise threshold\nprobing of a matched filter response,\u201d IEEE Transactions on Medical Imaging, vol. 19, pp. 203\u2013210, 2000.\n[9] S. Chaudhuri, S. Chatterjee, N. Katz, M. Nelson, and M. Goldbaum, \u201cDetection of blood vessels in retinal images using\ntwo-dimensional matched filters,\u201d IEEE Transactions on Medical Imaging, vol. 8, pp. 263\u2013369, 1989.\n[10] O. Brinchmann-Hansen and H. Heier, \u201cThe apparent and true width of the blood column,\u201d Acta Ophthalmologica,\nSupplement, vol. 179, pp. 29\u201332, 1986.\n[11] B.D. Thackray and A.C. Nelson, \u201cSemi-automatic segmentation of vascular network images using a rotating structuring\nelement (rose) with mathematical morphology and dual feature thresholding,\u201d Pattern Recognition, vol. 15, pp. 431\u2013443,\n1982.\n[12] L. Gang, O. Chutatape, and S.M. Krishnan, \u201cDetection and measurement of retinal vessels in fundus images using am-\nplitude modified second-order gaussian filter,\u201d IEEE Transactions on Biomedical Engineering, vol. 49, no. 2, February\n2002.\n[13] H. Neame, \u201cA method of estimating the calibre of retinal arteries in the living eye by means of opthalmoscope, illustrated\nresults in some normal and pathological cases,\u201d Trans. Ophthalmological Societies of the United Kingdom, vol. 56, pp.\n155\u2013162, 1936.\n[14] T. Behrendt, \u201cScanning densitometer for photographic fundus measurements,\u201d American Journal of Ophthalmology, vol.\n62, pp. 689\u2013693, 1966.\n[15] A. Kagan, E. Aurell, and G. Tibblin, \u201cSigns in the fundus oculi and arterial hypertension. unconventional assessment and\nsignificance,\u201d Bull WHO, vol. 36, pp. 231\u2013241, 1967.\n[16] J.V. Hodge, J.C. Parr, and G.F.S. Spears, \u201cComparison of methods of measuring vessel widths on retinal photographs and\nMarch 5, 2004 DRAFT\n22\nthe effect of fluorescein injection on apparent retinal vessel calibre,\u201d American Journal of Ophthalmology, vol. 68, pp.\n1060\u20131068, 1969.\n[17] O. Brinchmann-Hansen and O. Engvold, \u201cMicrophotometry of the blood column and light streak on retinal vessels in\nfundus photographs,\u201d Acta Ophthalmologica, Supplement, vol. 179, pp. 9\u201319, 1986.\n[18] O. Brinchmann-Hansen and H. Heier, \u201cTheoretical relationships between light streak characteristics and optical properties\nof retinal vessels,\u201d Acta Ophthalmologica, Supplement, vol. 179, pp. 33\u201337, 1986.\n[19] P.H. Gregson, Z. Shen, R.C. Scott, and V. Kozousek, \u201cAutomated grading of venous beading,\u201d Computers and Biomedical\nResearch, vol. 28, pp. 291\u2013304, 2000.\n[20] N. Chapman, N. Witt, X. Goa, A. Bharath, A.V. Stanton, S.A. Thom, and A.D. Hughes, \u201cComputer algorithms for the\nautomated measurements of retinal arteriolar diameters,\u201d British Journal of Ophthalmology, vol. 85, pp. 75\u201379, 2001.\n[21] L. Zhou, M.S. Rzeszotarski, L.J. Singerman, and J.M. Chokreff\u2018, \u201cThe detection and quantification of retinopathy using\ndigital angiograms,\u201d IEEE Transactions on Medical Imaging, vol. 13, no. 4, December 1994.\n[22] X.W. Goa, A. Bharath, A. Stanton, A. Hughes, N. Chapman, and S. Thom, \u201cQuantification and characterisation of artieries\nin retinal images,\u201d Computer Methods and Programs in Biomedecine, vol. 63, pp. 133\u2013146, 2000.\n[23] C.M. Bishop, Neural Networks for Pattern Recognition, Clarendon Press, Oxford, 1995.\nMarch 5, 2004 DRAFT\n23\nfig1.eps\n24\nfig2a.eps\n25\nfig2b.eps\n26\nfig3.eps\n27\nfig4a.eps\n28\nfig4b.eps\n29\nfig5a.eps\n30\nfig5b.eps\n31\nfig6a.eps\n32\nfig6b.eps\n33\nfig7a.eps\n34\nfig7b.eps\n35\nfig8.eps\n36\nfig9a.eps\n37\nfig9c1.eps\n38\nfig9c2.eps\n39\nfig9c3.eps\n40\nfig9c4.eps\n41\nfig9b.eps\n42\nfig9c.eps\n"}