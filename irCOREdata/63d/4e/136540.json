{"doi":"10.1029\/2008SW000401.","coreId":"136540","oai":"oai:bradscholars.brad.ac.uk:10454\/4106","identifiers":["oai:bradscholars.brad.ac.uk:10454\/4106","10.1029\/2008SW000401."],"title":"Automated Solar Activity Prediction: A hybrid computer platform using machine learning and solar imaging for automated prediction of solar flares","authors":["Colak, Tufan","Qahwaji, Rami S.R."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"04\/06\/2009","abstract":"yesThe importance of real-time processing of solar data especially for space weather applications is increasing continuously. In this paper, we present an automated hybrid computer platform for the short-term prediction of significant solar flares using SOHO\/Michelson Doppler Imager images. This platform is called the Automated Solar Activity Prediction tool (ASAP). This system integrates image processing and machine learning to deliver these predictions. A machine learning-based system is designed to analyze years of sunspot and flare data to create associations that can be represented using computer-based learning rules. An imaging-based real-time system that provides automated detection, grouping, and then classification of recent sunspots based on the McIntosh classification is also created and integrated within this system. The properties of the sunspot regions are extracted automatically by the imaging system and processed using the machine learning rules to generate the real-time predictions. Several performance measurement criteria are used and the results are provided in this paper. Also, quadratic score is used to compare the prediction results of ASAP with NOAA Space Weather Prediction Center (SWPC) between 1999 and 2002, and it is shown that ASAP generates more accurate predictions compared to SWPC.EPSR","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/136540.pdf","fullTextIdentifier":"https:\/\/bradscholars.brad.ac.uk\/bitstream\/10454\/4106\/3\/spaceweatherfinalsubmitted.pdf","pdfHashValue":"6b9edb12b9d5224176055227019677a7529ec85e","publisher":"AGU","rawRecordXml":"<record><header><identifier>\n        \n            \n                oai:bradscholars.brad.ac.uk:10454\/4106<\/identifier><datestamp>\n                2016-09-09T14:50:44Z<\/datestamp><setSpec>\n                com_10454_413<\/setSpec><setSpec>\n                col_10454_6345<\/setSpec>\n            <\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:doc=\"http:\/\/www.lyncode.com\/xoai\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n            \nAutomated Solar Activity Prediction: A hybrid computer platform using machine learning and solar imaging for automated prediction of solar flares<\/dc:title><dc:creator>\nColak, Tufan<\/dc:creator><dc:creator>\nQahwaji, Rami S.R.<\/dc:creator><dc:subject>\nSolar Imaging<\/dc:subject><dc:subject>\nSpace Weather<\/dc:subject><dc:subject>\nImage Processing<\/dc:subject><dc:subject>\nMachine Learning<\/dc:subject><dc:subject>\nSolar flares<\/dc:subject><dc:subject>\nPrediction<\/dc:subject><dc:subject>\nSunspots<\/dc:subject><dc:description>\nyes<\/dc:description><dc:description>\nThe importance of real-time processing of solar data especially for space weather applications is increasing continuously. In this paper, we present an automated hybrid computer platform for the short-term prediction of significant solar flares using SOHO\/Michelson Doppler Imager images. This platform is called the Automated Solar Activity Prediction tool (ASAP). This system integrates image processing and machine learning to deliver these predictions. A machine learning-based system is designed to analyze years of sunspot and flare data to create associations that can be represented using computer-based learning rules. An imaging-based real-time system that provides automated detection, grouping, and then classification of recent sunspots based on the McIntosh classification is also created and integrated within this system. The properties of the sunspot regions are extracted automatically by the imaging system and processed using the machine learning rules to generate the real-time predictions. Several performance measurement criteria are used and the results are provided in this paper. Also, quadratic score is used to compare the prediction results of ASAP with NOAA Space Weather Prediction Center (SWPC) between 1999 and 2002, and it is shown that ASAP generates more accurate predictions compared to SWPC.<\/dc:description><dc:description>\nEPSRC<\/dc:description><dc:date>\n2009-12-15T16:21:08Z<\/dc:date><dc:date>\n2009-12-15T16:21:08Z<\/dc:date><dc:date>\n04\/06\/2009<\/dc:date><dc:type>\nArticle<\/dc:type><dc:type>\nAccepted Manuscript<\/dc:type><dc:identifier>\nColak T, and Qahwaji RSR (2009) Automated Solar Activity Prediction: A hybrid computer platform using machine learning and solar imaging for automated prediction of solar flares. Space Weather. 7(6).<\/dc:identifier><dc:identifier>\n900013770<\/dc:identifier><dc:identifier>\n900148480<\/dc:identifier><dc:identifier>\nhttp:\/\/hdl.handle.net\/10454\/4106<\/dc:identifier><dc:identifier>\nSpace Weather, 7, S06001, doi:10.1029\/2008SW000401.<\/dc:identifier><dc:language>\nen<\/dc:language><dc:relation>\nhttp:\/\/www.agu.org\/pubs\/crossref\/2009\/2008SW000401.shtml<\/dc:relation><dc:rights>\n\u00a9 2009 American Geophysical Union. Reproduced in accordance with the publisher's self-archiving policy.<\/dc:rights><dc:publisher>\nAGU<\/dc:publisher>\n<\/oai_dc:dc>\n<\/metadata>\n        <\/record>","journals":null,"language":null,"relations":["http:\/\/www.agu.org\/pubs\/crossref\/2009\/2008SW000401.shtml"],"year":2009,"topics":["Solar Imaging","Space Weather","Image Processing","Machine Learning","Solar flares","Prediction","Sunspots"],"subject":["Article","Accepted Manuscript"],"fullText":"  \nThe University of Bradford Institutional \nRepository \nhttp:\/\/bradscholars.brad.ac.uk \nThis work is made available online in accordance with publisher policies. Please \nrefer to the repository record for this item and our Policy Document available from \nthe repository home page for further information. \nTo see the final version of this work please visit the publisher\u2019s website. Where \navailable access to the published online version may require a subscription. \nAuthor(s): Colak, Tufan and Qahwaji, Rami S. R. \nTitle: Automated Solar Activity Prediction: A hybrid computer platform using \nmachine learning and solar imaging for automated prediction of solar flares. \nPublication year: 2009. \nJournal title: Space Weather. \nPublisher: American Geophysical Union. \nLink to original published version: \nhttp:\/\/www.agu.org\/pubs\/crossref\/2009\/2008SW000401.shtml \nCitation: Colak, T., and Qahwaji, R. S. R. (2009). Automated Solar Activity \nPrediction: A hybrid computer platform using machine learning and solar imaging \nfor automated prediction of solar flares. Space Weather, Vol. 7, No. 6. \nCopyright statement: \u00a9 2009 American Geophysical Union. Reproduced in \naccordance with the publisher's self-archiving policy. \n 1 \nASAP: A Hybrid Computer Platform Using Machine 1 \nLearning and Solar Imaging for Automated Prediction of 2 \nSignificant Solar Flares  3 \nT. Colak1 and R. Qahwaji 2 4 \n[1] University of Bradford, Bradford, United Kingdom, t.colak@bradford.ac.uk 5 \n[2] University of Bradford, Bradford, United Kingdom, r.s.r.qahwaji@brad.ac.uk 6 \nAbstract 7 \nThe importance of real-time processing of solar data especially for space weather 8 \napplications is increasing continuously. In this paper, we present an automated hybrid 9 \ncomputer platform (ASAP) for the short-term prediction of significant solar flares using 10 \nSOHO\/MDI images. This system integrates image processing and machine learning to deliver 11 \nthese predictions. A machine learning-based system is designed to analyze years of sunspots 12 \nand flares data to extract knowledge and to create associations that can be represented using 13 \ncomputer-based learning rules. An imaging-based real time system that provides automated 14 \ndetection, grouping and then classification of recent sunspots based on the McIntosh 15 \nclassification is also created and integrated within this system. The properties of the sunspot 16 \nregions are extracted automatically by the imaging system and processed using the machine 17 \nlearning rules to generate the real-time predictions. Several performance measurement criteria 18 \nare used and the results are provided in this paper.  19 \n1 Introduction 20 \nSpace weather is defined by the U.S. National Space Weather Program (NSWP) as 21 \n\u201cconditions on the Sun and in the solar wind, magnetosphere, ionosphere, and thermosphere 22 \n 2 \nthat can influence the performance and reliability of space-borne and ground-based 23 \ntechnological systems and can endanger human life or health\u201d (Koskinen et al., 2001). The 24 \nimportance of understanding of space weather is increasing because of the way solar activity 25 \naffects life on Earth. We also rely more and more on communications and power systems, 26 \nboth vulnerable to space weather.  27 \nThe most dramatic solar activity events affecting the terrestrial environment are solar 28 \nflares and Coronal Mass Ejections (CMEs) (Pick et al., 2001). Solar flares and CMEs are 29 \nsolar eruptions that can spew vast quantities of radiation and charged particles into space 30 \n(Lenz, 2004). The ability to predict major solar storms can give companies sufficient lead 31 \ntime to implement preventive measures (Lenz, 2004). Satellite operators, space agencies, 32 \naviation industry, power generation and distribution industry, oil and gas industry and 33 \nrailways can benefit from an effective space weather prediction system.  34 \nSolar activity is the driver of space weather. In order to predict solar activities we need to 35 \nuse real-time, high-quality data and data processing techniques (Wang et al., 2003). An 36 \nautomated space weather prediction service can be designed by combining solar physics with 37 \nadvanced image processing and machine learning techniques. Eruptions on the Sun, which are 38 \nrelated to solar flares, travel to Earth in about 8 minutes in forms of light, radio waves, or X-39 \nrays. Proper warning of magnetic storms on Earth can be initiated if appropriate instruments 40 \nto observe the Sun, the intervening space, and the Earth\u2019s magnetic field, are combined with 41 \nefficient data processing techniques.  42 \nThere are various research groups and organizations scattered around the world that are 43 \nworking on solar analysis and forecasting. These analyses and forecasts are subjective and 44 \ndepend mainly on the expert knowledge, but it is affected by fatigue and other human-related 45 \nfactors. On the other hand, objective computerized analysis of solar images can provide 46 \n 3 \nautomated processing and a very consistent performance by exploiting the large 47 \ncomputational capabilities of modern computers to analyze and compare large amounts of 48 \ncurrent and historical data. However, the real challenge today is to design high-performance 49 \nand accurate computer-based systems. 50 \nTo our knowledge, there has been no fully automated system that can provide real-time 51 \nprediction of significant solar flares that may affect our life on Earth. The accuracies of the 52 \nprevious semi-automated systems that have been designed are generally lower compared to 53 \nthe performance provided by subjective analysis. For example, WOLF (Miller, 1988) is an 54 \nexpert system that has been created to analyze active regions and sunspots and then predict 55 \nthe probability of solar flare occurrence. WOLF has a knowledge base consisting of a set of 56 \n\u201cif-then\u201d rules and an inference engine which applies these rules. Manual user interaction is 57 \nrequired to provide a description for the observed active region and sunspots. WOLF would 58 \nthen determine the McIntosh classification for the associated sunspot and hence, the 59 \nprobability of the described group producing a flare of specified X-ray intensity.  60 \nTHEO (McIntosh, 1990) is another expert system that is also based on the McIntosh 61 \nclassification system, but includes information on spot growth, rotation and shear, and 62 \ninferred magnetic topology. Both systems are not fully automated as they require user 63 \ninteraction and are not designed to handle solar images directly or automatically. 64 \nIn this paper we introduce our fully automated pilot system called ASAP, which 65 \nintegrates image processing, machine learning and solar physics to provide automated 66 \nprediction of solar flares based on the characteristics of sunspots. The prediction system is 67 \ncomposed of two major stages: an image processing system and a machine learning system.  68 \nThe imaging system processes MDI continuum and magnetogram images in real-time mode 69 \nto detect and classify sunspot groups and then determine their properties. On the other hand, 70 \n 4 \nthe machine learning system is trained using historical sunspots and flares data. Association 71 \nalgorithms are designed to associate flares with the sunspot groups that caused them and to 72 \ncreate training sets that are used to train the learning algorithms and produce computerized 73 \nlearning rules. We will demonstrate the reliability of this system by testing it on recent solar 74 \nimages and comparing the generated predictions with the actual solar flares reported in solar 75 \ncatalogues.  76 \nThis paper is organized as follows: Section 2 describes the imaging system that is 77 \nresponsible for the automated grouping and classification of sunspots, Section 3 describes the 78 \nmachine learning system that is trained on historical sunspots and flares data. The integration, 79 \nperformance and evaluation of the whole system are discussed in Section 4.  The concluding 80 \nremarks and suggestions for future work are presented in Section 5. 81 \n2 Sunspot Detection and Classification 82 \nA computer system that can automatically detect, group, and classify sunspots based on 83 \nthe McIntosh classification was presented in (Colak and Qahwaji, 2007). This system applies 84 \nimaging techniques to SOHO\/MDI continuum and magnetogram images to detect sunspot 85 \nregions and extract their properties including their McIntosh classifications. In this work, this 86 \nsystem for the first time is integrated with a machine learning-based system to provide real-87 \ntime prediction for the possible occurrence of flares, which is described in the next section.  88 \n2.1 SOHO MDI images  89 \nThe MDI instrument on SOHO provides almost continuous observations of the Sun in 90 \nthe white light continuum, in the vicinity of the Ni I 6767.8 \u00c5 photospheric absorption line. 91 \nThe instrument images the sun with a 1024x1024 CCD camera (Scherrer et al., 1995). White 92 \nlight pictures show how the Sun appears to the naked eye, while MDI continuum 93 \n 5 \n(intensitygram) images are primarily used for sunspot observations. SOHO provides two to 94 \nfour MDI intensitygram images per day and twice as many magnetogram images with 95 \ncoverage which has been continuous since 1995. 96 \nMDI magnetogram images are used to measure the velocity and line-of-sight magnetic 97 \nfield strengths in the Sun's photosphere. The magnetogram images show the magnetic fields 98 \nof the solar photosphere, with black and white areas indicating opposite magnetic polarities. 99 \nThe dark areas are regions of \"south\" magnetic polarity (pointing toward the Sun) and the 100 \nwhite regions have \"north\" magnetic polarity (pointing outward). These images can be used 101 \nfor detecting active regions. In daily life magnetogram images are also used by observatories 102 \nto study and cluster sunspot groups. 103 \n2.2 Summary of sunspot detection and classification algorithms  104 \nThe detailed design and testing of this part of the system and description of algorithms 105 \nare presented in (Colak and Qahwaji, 2007). Our automated sunspot detection, grouping and 106 \nclassification algorithm consists of three main stages: Pre-processing, sunspot detection and 107 \ngrouping, and sunspot classification. These stages can be summarized as follows: 108 \nPre-processing of MDI images. 109 \nStage-1 processing: Applied to both continuum and magnetogram images. 110 \no Detect the solar disk, determine its radius and centre, create a mask and remove any 111 \ninformation or marks (i.e., date and direction) from the image using the mask created. 112 \no Calculate the Julian date and solar coordinates (The position angle, heliographic latitude, 113 \nheliographic longitude) for the image using the equations in (Meeus, 1998).  114 \nStage-2 processing: Applied only to magnetogram images. 115 \n 6 \no Map the magnetogram image from the Heliocentric-Cartesian coordinates to the 116 \nCarrington Heliographic coordinates. 117 \no Re-map the image to Heliocentric-Cartesian coordinates. Use centre, radius and solar 118 \ncoordinates of the continuum image as the new centre, radius and solar coordinates of the 119 \nmagnetogram image.  120 \nSunspot grouping (Figure1). 121 \no Detect sunspot candidates from MDI continuum images using intensity thresholding. 122 \no Detect active region candidates from MDI magnetogram images using morphological 123 \nimage processing algorithms. The MDI magnetogram images show the footprint of the 124 \nmagnetic fields of the solar photosphere, with dark and light areas indicating opposite 125 \nmagnetic polarities. These dark and light areas are detected separately and combined 126 \nafterwards to determine the active region candidates.   127 \no Apply region growing to combine sunspot and active region candidates.  128 \no Use neural networks to combine regions of opposite magnetic polarities in order to 129 \ndetermine the exact boundaries of sunspot groups.  130 \no Mark the detected sunspot groups. 131 \n 132 \nMcIntosh-based classification  133 \no Extract local features from every sunspot in every group using image processing and 134 \nneural networks. 135 \no Extract the length, height and area of the sunspot. 136 \n 7 \no Use neural networks to decide the type of penumbra (i.e., Mature or Rudimentary) 137 \nand whether the sunspot is Symmetric or Asymmetric. 138 \no Extract features from each sunspot group using image processing. The extracted features 139 \nare length, largest spot, polarity and distribution.  140 \no Apply all the extracted features to a decision tree to determine their McIntosh 141 \nclassification. 142 \n3 Solar Flare Prediction using Machine Learning 143 \nSolar flare research has shown that flares are mostly related to sunspots and active 144 \nregions. A survey studying the reported associations between flares and sunspots in the solar 145 \nphysics literature is presented in (Qahwaji and Colak, 2007). 146 \nThe system we introduce here extracts the expert knowledge embedded in historical data 147 \n(i.e., solar catalogues) and represents it in computerized learning rules that enable computers 148 \nto analyze recent solar data and provide reliable predictions. The implantation of this system 149 \nis discussed below.  150 \n3.1  Knowledge Representation of Historical Data 151 \nData from the publicly available sunspots group catalogue and the solar flares catalogue 152 \nprovided by the National Geophysical Data Centre (NGDC) are compared to find the 153 \nassociations between sunspots and flares. NGDC keeps records of data from several 154 \nobservatories around the world and holds one of the most comprehensive publicly available 155 \ndatabases for solar features and activities. The NGDC flares catalogue provides information 156 \nabout dates, starting and ending times for flare eruptions, location, x-ray classification, and 157 \nthe National Oceanic and Atmospheric Administration (NOAA) number for the active regions 158 \n 8 \nthat are associated with the detected flares, while the NGDC sunspots catalogue provides 159 \ninformation about their date, time, location, physical properties, and classification.  160 \nBoth catalogues are investigated to associate significant flares with the sunspots that 161 \nhave caused them. All the reported flares and sunspots for the periods from 1\nst\n January 1982 162 \ntill 31\nst\n December 2006, which includes 4595 (4258 M, and 337 X class) solar flares and 163 \n186324 sunspot groups are analyzed using the association algorithm described in (Qahwaji 164 \nand Colak, 2007). The association algorithm is based on comparing the location (i.e. same 165 \nNOAA number) and timing information (maximum 6 hours time difference between the 166 \nerupting flare and its classified sunspot) of sunspot groups and solar flares. The association 167 \nalgorithm has managed to associate a total of 2346 (2156 M, and 190 X class) solar flares 168 \nwith their corresponding 2107 sunspot groups using their NOAA numbers and the six hours 169 \ntime difference. The difference between the number of solar flares and the number of 170 \nassociated sunspots is caused by the fact a sunspot group could produce more than one solar 171 \nflare within the six hours time period. It is also worth mentioning that 4595 M and X class 172 \nsolar flares and 186324 sunspot groups are reported in the NGDC catalogues during this 173 \nperiod. However, only 3575 (3272 M, and 305 X class) solar flares have location information. 174 \nAlso after eliminating the sunspot groups with missing or wrong entries in the sunspot 175 \ncatalogues the number of sunspot groups is reduced to 166719.  176 \n3.2 Flares Prediction system 177 \nThe learning system introduced in this work is inspired by our previous work in 178 \n(Qahwaji and Colak, 2007). Learning algorithms such as Neural Network (NN), Support 179 \nVector Machines (SVM) and Radial Bases Functions (RBF) were optimized, trained and then 180 \ncompared for flares predictions in (Qahwaji and Colak, 2007). In this work, features such as 181 \nMcIntosh classifications and daily sunspot numbers were used as inputs to the learning 182 \n 9 \nalgorithms. The training and generalization performances of the learning algorithms were 183 \nevaluated using testing tools such as the Jack-knife technique (Fukunaga, 1990).  184 \nIn (Qahwaji and Colak, 2007) the sunspot numbers were calculated using a solar cycle 185 \nfitting model as suggested by (Hathaway et al., 1994). This was important then especially 186 \nwhen dealing with historical data and trying to identify patterns of associations that could 187 \ncause solar flare eruptions. However, this model is not quite suitable for real-time 188 \nimplementation as required by this work because the prediction of the solar cycle in the near 189 \nfuture is not quite accurate.   Therefore, in this paper we are using the area of sunspot groups 190 \ntogether with the McIntosh classes as inputs to the learning algorithms in order to generate 191 \npredictions for the M and X-class flares.  192 \nOur solar flare prediction is composed of two Neural Network (NN) systems that are 193 \nworking together as illustrated in Figure 2. The first NN uses the numerical representations of 194 \nthe three McIntosh classes for the sunspot under consideration together with its sunspot area 195 \nas inputs. It generates the probability that this sunspot region is going to produce a significant 196 \nsolar flare in six hours time. Hence, our NN has four input nodes and one output node. This 197 \nNN is trained using sunspot regions and solar flare associations as described above. The 198 \ntraining vector for this NN contains numerical values representing the four inputs and their 199 \ncorresponding target. The target represents the actual \u201cFLARE\u201d \/ \u201cNO FLARE\u201d cases. This 200 \ntraining vector is constructed as shown in Table 1. For example, if there is a sunspot region 201 \nwith a McIntosh classification of FKI and an area of 600 in millionths of solar hemisphere 202 \nthat is associated with a M or X-class flare then the training vector will be [0.9, 0.9, 0.5, 0.24; 203 \n0.9].  204 \n 205 \n 10 \nTable 1:  Inputs and output values for first neural network that is used for determining the 206 \nflaring probability.  207 \nInputs Output \nMcIntosh classes \nNormalized \n(with 2500) \nsunspot area \n \nFLARE =0.9 \nNO FLARE= 0.1 \nA= 0.10 \nH= 0.15 \nB= 0.30 \nC= 0.45 \nD= 0.60 \nE= 0.75 \nF= 0.90 \nX= 0 \nR=0.10 \nS=0.30 \nA=0.50 \nH=0.70 \nK=0.90 \nX=0 \nO=0.10 \nI=0.50 \nC=0.90 \nWhen the first NN predicts that a flare is going to occur, the second NN is activated to 208 \ndetermine whether the predicted flare is going to be M or X-class flare. The second NN is 209 \ntrained using a new training set that contains only the sunspot groups that were associated 210 \nwith X and M-class flares. Hence, this NN consists of four inputs and two outputs. The first 211 \noutput represents the M-class while the second represents the X-class flares. These outputs are 212 \nassigned as described below:  213 \nIf the sunspot group is associated with a M-class flare then the first output will be 0.9 214 \nand the second will be 0.1.  215 \nIf the sunspot group is associated with a X-class flare then the first output will be 0.1 216 \nand the second will be 0.9. 217 \nIf the sunspot group is associated with both M and X-class flares then the first and 218 \nsecond outputs will be 0.9. 219 \nFor example if there is a sunspot region with McIntosh classification of EKI and area of 500 220 \nin millionths of solar hemisphere that is associated only with M flare then the training vector 221 \nwill be [0.75, 0.9, 0.5, 0.20; 0.9, 0.1].  222 \n 11 \n3.3 Optimization of the Neutral Networks Prediction System 223 \nThe two neural networks are optimized by finding the minimum Mean Squared Error 224 \n(MSE) during training for different NN topologies. MSE is calculated using  Equation (1): 225 \n2\ni i\n1\n1\nMSE = ( )\nn\ni\np - r\nn \uf03d\n\uf0e5\n                                                    (1) 226 \nWhere, n is the total number of examples in the training vector, pi is the calculated 227 \nvalue of each output for the inputs given in the training vector, and ri is the real output value 228 \ngiven in the training vector.      229 \nSeveral training experiments are carried out while changing the number of nodes in the 230 \nhidden layer from 1 to 20. For every new experiment the MSE of the training is recorded and 231 \nthe number of hidden nodes with the least MSE is chosen. Both networks are optimized by 232 \nusing one hidden layer with ten nodes for the first NN and eleven nodes for the second NN.   233 \n4 Practical Implementation and Evaluation of the Hybrid System 234 \nThe imaging and machine learning systems are integrated for the hybrid solar flares 235 \nprediction system. The final system is shown in Figure 3. The complete integrated hybrid 236 \nsystem provides automated prediction of solar flares from MDI images. The system starts its 237 \nreal-time operations by processing SOHO\/MDI continuum and magnetogram images in the 238 \nmanner explained in Section 2 to provide automated McIntosh classifications for the detected 239 \nsunspots. Then the McIntosh classified sunspots and their calculated areas are fed to the 240 \nmachine learning system described in Section 3 which is trained with 14 years of data after 241 \napplying the association algorithm. Based on the embedded learning rules the system predicts 242 \nif a major solar flare is going to occur or not. If a major solar flare is predicted then the 243 \nprobability of this solar flare to be M or X-class flare is also predicted. The entire system is 244 \n 12 \nimplemented in C++. It takes about 15 seconds to process the latest SOHO\/MDI continuum 245 \nand magnetogram images and generate these predictions.  246 \n4.1 Evaluation of the System  247 \nThe performance of the hybrid system was evaluated by comparing the generated 248 \npredictions with the actual flares activities as reported by NOAA SEC\n1\n in the NGDC X-ray 249 \nsolar flare catalogue. The system was tested on solar MDI intensitygram images from 1st 250 \nMarch to 30th April 2001. This period corresponds to high solar activity that produced 251 \nconsiderable number of M and X solar flares, which is important to test our system 252 \nefficiently. 253 \nThere were 241 MDI continuum (intensitygram) images available during this period 254 \nthat corresponds to four images per day. These MDI continuum images and their 255 \ncorresponding 241 MDI magnetogram images are processed using the hybrid system and a 256 \nsunspot catalogue is created which we refer to as the Automated Sunspot Catalogue (ASC). 257 \nParts of ASC are shown in Table 2. All the automatically detected and classified sunspot 258 \ngroups and their flaring probabilities are provided. In addition to the ASC, the hybrid system 259 \nrepresents its predictions visually as shown in Figure 4. The generated images show the 260 \ndetected sunspot groups and their flaring probabilities. 261 \n 262 \n 263 \n 264 \n                                                 \n1\n http:\/\/www.sec.noaa.gov\/ \n 13 \nTable 2:  The Automated Sunspot Catalogue (ASC).  L (Length of the sunspot group), N 265 \n(Number of sunspots within the group), F (significant Flaring),  M(M-class flaring), X (X-266 \nclass flaring), and PRO (Probability). 267 \nDate       Time  Location CLS  L. N. Area F.PRO.   M.PRO. X.PRO. 268 \n01\/04\/2001 06:24 N25E25   HKX   1  4  134 0.1383       0       0 269 \n01\/04\/2001 06:24 N22W26   CSO  13  8  170 0.1126       0       0 270 \n01\/04\/2001 06:24 N16W45   FKC  28 25 1387 0.8147  0.8039  0.1206 271 \n01\/04\/2001 06:24 N11E22   CAO   4  7   56 0.0990       0       0 272 \n01\/04\/2001 06:24 N10W07   CAO   3  3   28 0.0975       0       0 273 \n01\/04\/2001 06:24 N09E29   AXX   1  0    8 0.0981       0       0 274 \n01\/04\/2001 06:24 S01W30   BXO   2  0    9 0.1047       0       0 275 \n01\/04\/2001 06:24 S05E04   DAO  17  6  128 0.1444       0       0 276 \n01\/04\/2001 06:24 S09W11   FSO  22 18  427 0.4202       0       0 277 \n01\/04\/2001 06:24 S07W29   DSO   6  7   89 0.1045       0       0 278 \n01\/04\/2001 06:24 S12W36   HRX   1  1   16 0.0927       0       0 279 \n01\/04\/2001 06:24 S12W75   BXO   2  6   68 0.1116       0       0 280 \n01\/04\/2001 06:24 S13E60   AXX   1  1  151 0.1457       0       0 281 \n 282 \nIn order to test the hybrid system we compared the solar flare predictions of each 283 \nsunspot group in ASC to the x-ray solar flares reported in the NGDC solar flare catalogues. 284 \nBetween 1st March and 30th April 2001 there were 84 reported M and X class solar flares. 285 \nOut of these 84 solar flares 75 of them were M-class and 9 of them were X- class flares.  286 \nIn order to associate the sunspot groups detected by our algorithms with x-ray solar flares 287 \nreported in the NGDC catalogue, we had to modify the association algorithm, introduced in 288 \n(Qahwaji and Colak, 2007), to compare sunspots and solar flares based on their locations 289 \n(latitude and longitude) instead of using their NOAA numbers. The new modifications are 290 \nnecessary because the sunspot groups in ASC do not have NOAA numbers. Also, not all the 291 \nsolar flares reported in NGDC flares catalogue have location information and the solar flares 292 \nwithout location information are not included in this study. The association algorithm that we 293 \nhave used here is explained below: 294 \n\uf0b7 Read all the sunspot groups and their solar flare predictions as reported in ASC. 295 \n 14 \n\uf0b7 Read the actual M and X-class flares with location information as reported in the NGDC 296 \nsolar flare catalogue. 297 \n\uf0b7 Carry out extensive search to associate each actual flare with its corresponding sunspot 298 \ngroup by comparing their longitude, latitude, and time information. In order to confirm 299 \nthat a sunspot group and a solar flare are associated the following criteria must be met: 300 \no The difference between the longitude of the sunspot group and the solar flare must 301 \nbe less than 10 degrees. 302 \no The difference between the latitude of the sunspot group and solar flare must be 303 \nless than 10 degrees. 304 \no The difference in time between the detected sunspot group and its associated flare 305 \nshould be less than six hours. 306 \n\uf0b7 If all the criteria are satisfied then highlight this sunspot group as associated with a solar 307 \nflare, otherwise highlight it as not associated.  308 \nAfter the completion of the association process the prediction performance is evaluated 309 \nusing various verification measures as explained below. 310 \n4.2 Verification Results  311 \nThe hybrid system generates predictions in numerical format, between 0.0 and 1.0, as 312 \nshown in Table 2. A threshold value of 0.5 (50%) is used for determining the final predictions 313 \nin this paper. If the output generated by the hybrid system is above this threshold value then a 314 \nflare is predicted to occur. On the other hand, if the generated output is less than the threshold 315 \nvalue then no flare is expected. In order to calculate the success of the generated predictions  316 \nthe association results are investigated using the following four criteria: 317 \n 15 \n\uf0b7 If a sunspot group is associated with an actual flare, as explained previously, and a 318 \nflares prediction is generated then this prediction is successful. 319 \n\uf0b7 If a sunspot group is associated with an actual flare but no flares prediction is 320 \ngenerated then this prediction is not successful. 321 \n\uf0b7 If a sunspot group is not associated with any actual flare and no flares prediction is 322 \ngenerated then this prediction is successful. 323 \n\uf0b7 If a sunspot group is not associated with any actual flare but a flares prediction is 324 \ngenerated then this prediction is not successful. 325 \nFor our testing period there exist 84 reported M and X-class flares in the NGDC 326 \ncatalogue. Only 63 (56 M- class and 7 X-class) have location information. These solar flares 327 \nare compared with 2016 sunspot groups that were detected from 241 MDI image pairs and 328 \nrecorded in ASC.  329 \nSeveral forecast verification measures are used to evaluate our results as shown in table 3. 330 \nThe measures used are: Probability of Detection (POD), False Alarm Rate (FAR), Percent 331 \nCorrect (PC), Heidke Skill Score (HSS) and Quadratic Score (QR). These forecast measures 332 \nare defined well in a recent paper by (Balch, 2008) and readers can refer to this paper for 333 \nmore information.   334 \nTable 3: Prediction evaluation measures  335 \n Flare M Flare X Flare \nQuadratic Score (QR) 0.055345 0.148737 0.158486 \nProbability of Detection (POD) 0.833333 0.814815 0.666667 \nFalse Alarm Rate (FAR) 0.769231 0.661538 0.969231 \nPercent Correct (PC) 0.939980 0.966270 0.966766 \nHeidke Skill Score (HSS) 0.363193 0.473472 0.090920 \n 16 \nThe quadratic score (QR) is simply the mean square error of the probabilities provided 336 \nby the hybrid system. It is a measure to calculate the accuracy in probability predictions. A 337 \nsmaller QR indicates better accuracy in predictions. A perfect QR which is zero would require 338 \nan accurate prediction of solar flare every time a solar flare occurs and an accurate prediction 339 \nof no activity every time an event does not occur (Balch, 2008). The QR of our hybrid system 340 \nfor significant solar flare prediction, M-class predictions and X-class predictions are 341 \ncalculated 0.055345, 0.148737 and 0.158486 respectively. These values are encouraging 342 \nespecially for the significant solar flare prediction as it is close to zero.  343 \nPOD measures the probability of actual solar flares being predicted correctly by the 344 \nhybrid system. POD of a significant, M-class, and X-class solar flare predictions are 345 \n0.833333, 0.814815, and 0.666667, respectively. This means that the hybrid system predicted 346 \n83.3% of the significant solar flares correctly and this includes 81.4% of the M-class solar 347 \nflares and 66.6% of the X-class flares correctly.  348 \nFAR measures the probability of the hybrid system predicting a solar flare that 349 \nactually does not occur. FAR of a significant, M-class, and X-class solar flare are found to be 350 \n0.769231, 0.661538, and 0.969231, respectively. This means that 76.9% of the significant 351 \nsolar flares, 66.15% of the M-class flare, 96.15% of the X-class flare predictions by hybrid 352 \nsystem were wrong.  353 \nPC is a measure showing the correct prediction rate of the overall system which is the 354 \nratio of successful flare and no flare predictions by our hybrid system. PC of significant, M-355 \nclass, and X-class solar flare predictions are found to be 0.939980, 0.966270, and 0.966766 356 \nrespectively. This means that the prediction rates of the hybrid system are very good when we 357 \ntake into account the correct flare and no flare predictions. 358 \n 17 \nHSS is a measure showing the chance factor in predictions. The HSS can range from -1 359 \n(for no correct predictions) to +1 (for all correct predictions) and a value of zero is interpreted 360 \nas the predictions been generated mainly by chance. HSS of a significant, M-class, and X-361 \nclass solar flare are calculated 0.363193, 0.473472, and 0.090920 respectively. These 362 \nnumbers demonstrate that our system provides good performance for the significant flares and 363 \nM-class predictions, but the performance of the X-class flares predictions is close to being 364 \nproduced by chance. 365 \n5 Conclusions 366 \nIn this paper we have introduced, for the first time, an automated hybrid system called 367 \nASAP that integrates advanced machine learning and image processing techniques with solar 368 \nphysics to predict automatically whether a significant solar flare is going to erupt and the 369 \nprobability of this flare being X or M class flare.  370 \nThe current results as presented in Section 4 are quite satisfactory but the performance of 371 \nthe hybrid system depends on the generalization capabilities of the machine learning system 372 \nand the grouping and classification performance of the image processing system. For our 373 \nhybrid system the HSS, POD, PC, and QR measures are quite good specially when predicting 374 \nthat a significant solar flare is going to erupt within six hours. However, the same thing 375 \ncannot be said for FAR measure. This is caused mostly because of the six hours limit we used 376 \nfor predictions validity. There were some complex structured sunspot groups that can be 377 \ntracked in several continues images and predicted to produce a significant flare by our hybrid 378 \nsystem but this did not take place within the first six hours after detection, but rather in later 379 \nstages. More than 90% of the sunspot groups that were predicted by the hybrid system to 380 \nproduce a significant flare actually produced a significant flare during their life time which is 381 \nalso good to determine if the group possesses a threat.     382 \n 18 \nThe prediction rates for the hybrid system can be improved by using the generalization 383 \ncapability of machine learning system. Better generalization is obtained when more training 384 \ndata are used. Hence, we believe that it is important to monitor the performance of the hybrid 385 \nsystem during its initial launch stages which includes comparing the prediction performance 386 \nwith the actual flares reported by NOAA. Evolutionary algorithms may be used to allow the 387 \nlearning algorithms to evolve and provide better optimization and generalization. 388 \nTherefore, ASAP is also designed to be web compliant and a real-time version is 389 \navailable at http:\/\/spaceweather.inf.brad.ac.uk\/index.html as a beta version since March 2007. 390 \nThis system connects automatically to SOHO\u2019s website2  to download the latest MDI 391 \ncontinuum and magnetogram images. After automatically running the algorithms described in 392 \nthis paper the results are displayed on our website in a visual format as shown in Figure 4 and 393 \nalways updated automatically. 394 \nThe processing time for our system is approximately 15 seconds to process the two MDI 395 \nimages and generate the predictions. This enables our system to provide near-real time 396 \nclassifications and predictions. The system can be modified to accept other types of solar 397 \nimages. Sometimes the characteristics of a sunspot group can change rapidly in hours and 398 \ncause flares, it is almost impossible for a human observer to determine what triggers this 399 \nprocess without having the appropriate tools. We believe that the system introduced here can 400 \nhelp researcher or observers to investigate and understand solar features and activities and to 401 \nidentify patterns that could be useful for space weather predictions.  402 \nIn our previous work (Qahwaji et al., 2007), (Qahwaji and Colak, 2007), we have shown 403 \nthat SVM provides better generalization performance compared to NN. In the near future we 404 \nwill integrate these findings and use SVM networks to enhance the generated predictions. We 405 \n                                                 \n2\n http:\/\/sohowww.nascom.nasa.gov\/data\/realtime\/ Last Access: 2008 \n 19 \nalso believe designing a sunspots group tracking system that studies the evolution of the 406 \nsunspot groups can improve the overall performance. 407 \n 408 \nAcknowledgements 409 \nThis work is supported by EPSRC (GR\/T17588\/01) and (EP\/F022948\/1) grants, which is 410 \nentitled \u201cImage Processing and Machine Learning Techniques for Short-Term Prediction of 411 \nSolar Activity\u201d and \"Image Processing, Machine Learning and Geometric Modeling for 412 \nthe 3D Representation of Solar Features\", respectively.  413 \nReferences 414 \nBALCH, C. C. (2008): Updated verification of the Space Weather Prediction Centre\u2019s solar energetic particle 415 \nprediction model. Space Weather 6,  416 \nCOLAK, T. & QAHWAJI, R. (2007): Automated McIntosh-based classification of sunspot groups using MDI 417 \nimages. Topical Issues in Solar Physics,  418 \nFUKUNAGA, K. (1990): Introduction to Statistical Pattern Recognition. Academic Press, New York. 419 \nHATHAWAY, D., WILSON, R. M. & REICHMANN, E. J. (1994): The Shape of the Sunspot Cycle. Solar 420 \nPhysics 151, 177. 421 \nKOSKINEN, H., TANSKANEN, E., PIRJOLA, R., PULKKINEN, A., DYER, C., RODGERS, D. & CANNON, 422 \nP. (2001): Space Weather Effects Catalogue. ESA Space Weather Program Feasibility Studies FMI, QinetiQ, 423 \nRAL Consortium. 424 \nLENZ, D. (2004): Understanding and Predicting Space Weather. The Industrial Physicist 9\/6, 18-21. 425 \nMCINTOSH, P. S. (1990): The Classification Of Sunspot Groups. Solar Physics 125\/2, 251-267. 426 \nMEEUS, J. (1998): Astronomical Algorithms - Second Edition. Willmann-Bell, Inc., Virginia. 427 \nMILLER, R. W. (1988): Wolf - A Computer Expert System for Sunspot Classification And Solar-Flare 428 \nPrediction. Journal of The Royal Astronomical Society Of Canada 82\/4, 191-203. 429 \nPICK, M., LATHUILLERE, C. & LILENSTEN, J. (2001): Ground Based Measurements. In: (ed.)^(eds): ESA 430 \nSpace Weather Program Feasibility Studies Alcatel-LPCE Consortium. 431 \nQAHWAJI, R. & COLAK, T. (2007): Automatic Short-Term Solar Flare Prediction Using Machine Learning 432 \nand Sunspot Associations. Solar Physics 241\/1, 195-211. 433 \nQAHWAJI, R., COLAK, T., AL-OMARI, M. & IPSON, S. (2007): Automated Machine Learning Based 434 \nPrediction of CMEs Based on Flare Associations Topical Issues in Solar Physics,  435 \nSCHERRER, P. H., BOGART, R. S., BUSH, R. I., HOEKSEMA, J. T., KOSOVICHEV, A. G., SCHOU, J., 436 \nROSENBERG, W., SPRINGER, L., TARBELL, T. D., TITLE, A., WOLFSON, C. J., ZAYER, I., AKIN, 437 \nD., CARVALHO, B., CHEVALIER, R., DUNCAN, D., EDWARDS, C., KATZ, N., LEVAY, M., 438 \nLINDGREN, R., MATHUR, D., MORRISON, S., POPE, T., REHSE, R. & TORGERSON, D. (1995): The 439 \nsolar oscillations investigation - Michelson Doppler Imager. Solar Physics 162\/1-2, 129-188. 440 \nWANG, H., QU, M., SHIH, F., DENKER, C., GERBESSIOTIS, A., LOFDAHL, M., REES, D. & KELLER, C. 441 \n(2003): Innovative Information Technology for Space Weather Research. In: (ed.)^(eds): AAS 204th 442 \nMeeting, Session 52 Virtual Observations in Solar Physics.  The American Astronomical Society. 443 \n 444 \n 445 \n 446 \n 20 \n 447 \nFigure 1: Stages and result of sunspot detection and grouping process. 448 \n 449 \n 21 \n 450 \nFigure 2: Machine learning system for flare prediction. 451 \n 452 \n 453 \n 454 \n 455 \n 456 \nFigure 3: The final hybrid system 457 \n 22 \n 458 \nFigure 4: Two images generated by the hybrid system. The image to the left shows the 459 \ndetected sunspot groups and the image to the right shows the classification and flaring 460 \nprobabilities of the detected sunspot groups. The image to the right is updated automatically 461 \non http:\/\/spaceweather.inf.brad.ac.uk\/index.html every time a new MDI continuum image is 462 \navailable on SOHO\u2019s website. 463 \n"}