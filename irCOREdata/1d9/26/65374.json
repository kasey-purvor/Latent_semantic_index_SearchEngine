{"doi":"10.1016\/j.disc.2003.11.030","coreId":"65374","oai":"oai:dro.dur.ac.uk.OAI2:6082","identifiers":["oai:dro.dur.ac.uk.OAI2:6082","10.1016\/j.disc.2003.11.030"],"title":"Amalgamations of factorizations of complete equipartite graphs.","authors":["Hilton,  A. J. W.","Johnson,  Matthew."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2004-07-01","abstract":"Let t be a positive integer, and let L=(l1,\u2026,lt) and K=(k1,\u2026,kt) be collections of nonnegative integers. A graph has a (t,K,L) factorization if it can be represented as the edge-disjoint union of factors F1,\u2026,Ft where, for 1it, Fi is ki-regular and at least li-edge-connected. In this paper we consider (t,K,L)-factorizations of complete equipartite graphs. First we show precisely when they exist. Then we solve two embedding problems: we show when a factorization of a complete \u03c3-partite graph can be embedded in a (t,K,L)-factorization of a complete s-partite graph, \u03c3<s, and also when a factorization of Ka,b can be embedded in a (t,K,L)-factorization of Kn,n, a,bn. Our proofs use the technique of amalgamations of graphs.Let t be a positive integer, and let L=(l1,\u2026,lt) and K=(k1,\u2026,kt) be collections of nonnegative integers. A graph has a (t,K,L) factorization if it can be represented as the edge-disjoint union of factors F1,\u2026,Ft where, for 1it, Fi is ki-regular and at least li-edge-connected. In this paper we consider (t,K,L)-factorizations of complete equipartite graphs. First we show precisely when they exist. Then we solve two embedding problems: we show when a factorization of a complete \u03c3-partite graph can be embedded in a (t,K,L)-factorization of a complete s-partite graph, \u03c3<s, and also when a factorization of Ka,b can be embedded in a (t,K,L)-factorization of Kn,n, a,bn. Our proofs use the technique of amalgamations of graphs","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/65374.pdf","fullTextIdentifier":"http:\/\/dro.dur.ac.uk\/6082\/2\/6082.pdf","pdfHashValue":"a775b41f81e5ae2d362c6c5940fc506820c7eb9d","publisher":"Elsevier","rawRecordXml":"<record><header><identifier>\n  \n    \n      oai:dro.dur.ac.uk.OAI2:6082<\/identifier><datestamp>\n      2011-11-25T09:40:55Z<\/datestamp><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        Amalgamations of factorizations of complete equipartite graphs.<\/dc:title><dc:creator>\n        Hilton,  A. J. W.<\/dc:creator><dc:creator>\n        Johnson,  Matthew.<\/dc:creator><dc:description>\n        Let t be a positive integer, and let L=(l1,\u2026,lt) and K=(k1,\u2026,kt) be collections of nonnegative integers. A graph has a (t,K,L) factorization if it can be represented as the edge-disjoint union of factors F1,\u2026,Ft where, for 1it, Fi is ki-regular and at least li-edge-connected. In this paper we consider (t,K,L)-factorizations of complete equipartite graphs. First we show precisely when they exist. Then we solve two embedding problems: we show when a factorization of a complete \u03c3-partite graph can be embedded in a (t,K,L)-factorization of a complete s-partite graph, \u03c3<s, and also when a factorization of Ka,b can be embedded in a (t,K,L)-factorization of Kn,n, a,bn. Our proofs use the technique of amalgamations of graphs.Let t be a positive integer, and let L=(l1,\u2026,lt) and K=(k1,\u2026,kt) be collections of nonnegative integers. A graph has a (t,K,L) factorization if it can be represented as the edge-disjoint union of factors F1,\u2026,Ft where, for 1it, Fi is ki-regular and at least li-edge-connected. In this paper we consider (t,K,L)-factorizations of complete equipartite graphs. First we show precisely when they exist. Then we solve two embedding problems: we show when a factorization of a complete \u03c3-partite graph can be embedded in a (t,K,L)-factorization of a complete s-partite graph, \u03c3<s, and also when a factorization of Ka,b can be embedded in a (t,K,L)-factorization of Kn,n, a,bn. Our proofs use the technique of amalgamations of graphs.<\/dc:description><dc:publisher>\n        Elsevier<\/dc:publisher><dc:source>\n        Discrete mathematics, 2004, Vol.284(1-3), pp.157-175 [Peer Reviewed Journal]<\/dc:source><dc:date>\n        2004-07-01<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:identifier>\n        dro:6082<\/dc:identifier><dc:identifier>\n        issn:0012-365X<\/dc:identifier><dc:identifier>\n        doi:10.1016\/j.disc.2003.11.030<\/dc:identifier><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/6082\/<\/dc:identifier><dc:identifier>\n        http:\/\/dx.doi.org\/10.1016\/j.disc.2003.11.030<\/dc:identifier><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/6082\/2\/6082.pdf<\/dc:identifier><dc:accessRights>\n        info:en-repo\/semantics\/openAccess<\/dc:accessRights><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["issn:0012-365X","0012-365x"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2004,"topics":[],"subject":["Article","PeerReviewed"],"fullText":"Durham Research Online\nDeposited in DRO:\n14 October 2009\nVersion of attached file:\nAccepted Version\nPeer-review status of attached file:\nPeer-reviewed\nCitation for published item:\nHilton, A. J. W. and Johnson, Matthew. (2004) \u2019Amalgamations of factorizations of complete equipartite\ngraphs.\u2019, Discrete mathematics., 284 (1-3). pp. 157-175.\nFurther information on publisher\u2019s website:\nhttp:\/\/dx.doi.org\/10.1016\/j.disc.2003.11.030\nPublisher\u2019s copyright statement:\nAdditional information:\nUse policy\nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without prior permission or charge, for\npersonal research or study, educational, or not-for-profit purposes provided that:\n\u2022 a full bibliographic reference is made to the original source\n\u2022 a link is made to the metadata record in DRO\n\u2022 the full-text is not changed in any way\nThe full-text must not be sold in any format or medium without the formal permission of the copyright holders.\nPlease consult the full DRO policy for further details.\nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom\nTel : +44 (0)191 334 3042 \u2014 Fax : +44 (0)191 334 2971\nhttp:\/\/dro.dur.ac.uk\n  \nDurham Research Online \n \nDeposited in DRO: \n14 October 2009 \n \nPeer-review status: \nPeer-reviewed \n \nPublication status of attached file: \nAccepted for publication \n \nCitation for published item: \nHilton, A. J. W. and Johnson, Matthew. (2004) 'Amalgamations of factorizations of complete \nequipartite graphs.', Discrete mathematics., 284 (1-3). pp. 157-175. \n \nFurther information on publisher\u2019s website: \nhttp:\/\/dx.doi.org\/10.1016\/j.disc.2003.11.030 \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \nUse policy \n \nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without prior \npermission or charge, for personal research or study, educational, or not-for-profit purposes provided that : \n \n\uf0a7 a full bibliographic reference is made to the original source \n\uf0a7 a link is made to the metadata record in DRO \n\uf0a7 the full-text is not changed in any way \n \nThe full-text must not be sold in any format or medium without the formal permission of the copyright holders. \n \nPlease consult the full DRO policy for further details. \n \nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom \nTel : +44 (0)191 334 2975 | Fax : +44 (0)191 334 2971 \nhttp:\/\/dro.dur.ac.uk \nAmalgamations of factorizations of\ncomplete equipartite graphs\nA. J. W. Hilton\nDepartment of Mathematics\nUniversity of Reading\nWhiteknights\nP.O. Box 220\nReading\nRG6 6AX\nU.K.\nMatthew Johnson\nDepartment of Mathematics\nLondon School of Economics\nHoughton Street\nLondon\nWC2A 2AE\nU.K.\nTo Curt Lindner with thanks for the inspiration he has provided the\nauthors.\nAbstract\nLet t be a positive integer, and let L = (l1, . . . , lt) and K =\n(k1, . . . , kt) be collections of nonnegative integers. A graph has a\n(t,K,L) factorization if it can be represented as the edge-disjoint\nunion of factors F1, . . . , Ft where, for 1 \u2264 i \u2264 t, Fi is ki-regular\n1\nand at least li-edge-connected. In this paper we consider (t,K,L)-\nfactorizations of complete equipartite graphs. First we show precisely\nwhen they exist. Then we solve two embedding problems: we show\nwhen a factorization of a complete \u03c3-partite graph can be embed-\nded in a (t,K,L)-factorization of a complete s-partite graph, \u03c3 < s,\nand also when a factorization of Ka,b can be embedded in a (t,K,L)-\nfactorization of Kn,n, a, b \u2264 n. Our proofs use the technique of amal-\ngamations of graphs.\n1 Introduction\nWe denote the complete s-partite graph with n vertices in each part K\n(s)\nn .\nLet t be a positive integer, let K = (k1, k2, . . . , kt) and L = (l1, l2, . . . , lt)\nwhere, for 1 \u2264 i \u2264 t, ki is a positive integer and li is a nonnegative integer.\nA factorization F1, . . . , Ft of a graph such that, for 1 \u2264 i \u2264 t, Fi is ki-regular\nand has edge-connectivity at least li is called a (t,K, L)-factorization. We\ndescribe exactly when K\n(s)\nn has a (t,K, L)-factorization:\nTheorem 1 A (t,K, L)-factorization of K\n(s)\nn exists if and only if\n(A1)\nt\u2211\ni=1\nki = n(s\u2212 1),\n(A2) if ns is odd then each ki is even,\n(A3) for 1 \u2264 i \u2264 t, li \u2264 ki, and\n(A4) li = 0 if ki = 1.\nIf n \u2208 {1, 2}, then K(s)n is either the complete graph or the complete graph\nless a one-factor. These cases of Theorem 1 were first proved by Johnstone\n[6]. They were subsequently proved by Johnson [5] using amalgamations,\nand here we attempt to generalize the results and techniques of that paper\n(which presented many results on (t,K, L)-factorizations of complete graphs)\nto obtain results on complete equipartite graphs.\nWe believe that the only other non-trivial case of Theorem 1 previously\nproved is when each ki = li = 2, that is when each factor is a Hamilton cycle.\nThis case was first proved by Laskar and Auerbach [7], who constructed the\n2\nfactorizations, and independently by Hilton and Rodger [4] using amalgama-\ntions.\nWe sketch how the technique of amalgamations is used. This will lead us\nto the other theme of this paper: embeddings.\n1.1 Amalgamations\nConsider a partition of a graphG\u2019s vertex set into subsets V1, . . . , Vr. Then an\namalgamation of G has vertex set V1, . . . , Vr and for each edge in G joining a\npair of vertices in Vi, 1 \u2264 i \u2264 r, there is a loop on Vi in the amalgamation, and\nfor each edge in G joining a vertex in Vi to a vertex in Vj, 1 \u2264 i < j \u2264 r, there\nis an edge ViVj in the amalgamation. (We can think of the amalgamation as\nbeing obtained from G by merging vertices that belong to the same subset\nwhilst retaining all edges.)\nIf G has a factorization, then we can represent it as an edge-colouring: the\nfactors are the colour classes (in this paper we frequently use the equivalence\nof factorizations and edge-colourings). This colouring can be transferred\nto an amalgamation of G\u2014each edge of the amalgamation has the same\ncolour as the corresponding edge of G. In what follows when we refer to an\namalgamation we mean a graph that has been edge-coloured. Suppose that\nG = K\n(s)\nn and that it has a particular type of factorization, say a Hamiltonian\ndecomposition. Then we can find some properties that an amalgamation of\nG must possess. For example we can find the number of loops on each vertex,\nthe number of edges between each pair of vertices and the number of edges\nof each colour incident with each vertex. We call any edge-coloured graph\nthat satisfies these properties an outline Hamiltonian decomposition of K\n(s)\nn .\nThe aim when using amalgamations is to prove that every outline graph is\nan amalgamated graph. So in our example, for each outline Hamiltonian\ndecomposition we would have to find a Hamiltonian decomposition of which\nit is an amalgamation.\n1.2 Embeddings\nAmalgamations can be used to prove embedding results. Suppose that we\nhave a factorization (or an edge-colouring) of K\n(\u03c3)\nn . Add to it a vertex v.\nJoin v to each vertex of K\n(\u03c3)\nn by n(s \u2212 \u03c3) edges and put n2\n(\ns\u2212 \u03c3\n2\n)\nloops\non v to form a graph G. Complete the edge-colouring of G by colouring the\n3\nedges incident with v. (Note that G can be seen to be K\n(s)\nn with n(s \u2212 \u03c3)\nvertices merged.) If G is an outline factorization (of some specified type) of\nK\n(s)\nn and we have proved that every outline graph is an amalgamated graph,\nthen there is factorization of K\n(s)\nn in which the factorization of K\n(\u03c3)\nn is embed-\nded; we can think of this factorization of K\n(s)\nn as being obtained from G by\nsplitting v into n(s\u2212 \u03c3) vertices. From the properties that define an outline\nfactorization we can work back to find the properties that the factorization\nof K\n(\u03c3)\nn must possess if it is to be embedded.\nHilton [1] first used the technique of amalgamations in the context of\nembedding factorizations of graphs: he considered Hamiltonian decomposi-\ntions of the complete graph. Generalizations of his results to decompositions\nof the complete graph into regular factors of prescribed degree and edge-\nconnectivity have been proved by various authors; see, for example, [3, 8, 10].\nThe most general result of this kind was obtained by Johnson [5] who con-\nsidered (t,K, L)-factorizations of the complete graph. Hilton, with Rodger,\ngeneralized his original result in a different direction by considering Hamil-\ntonian decompositions of the complete equipartite graph [4]. In this paper,\nwe unite these two strands of research by considering (t,K, L)-factorizations\nof the complete equipartite graph.\nIn the next section we formally introduce amalgamations of (t,K, L)-\nfactorizations of complete equipartite graphs, and at the end of the section\nwe use amalgamations to prove Theorem 1. In the final section we consider\nembedding problems. We suppose that we have a factorization of K\n(\u03c3)\nn , and\nask when it can be embedded in a (t,K, L)-factorization of K\n(s)\nn , \u03c3 < s.\nWe also look at embedding factorizations of Ka,b in (t,K, L)-factorizations\nof Kn,n, a, b \u2264 n.\nAs noted before, K\n(s)\n1 = Ks and K\n(s)\n2 = K2s \u2212 I, where I is a 1-factor.\nResults on amalgamations and embeddings of (t,K, L)-factorizations of these\ngraphs are already known and can be found in [5]. So in this paper we assume\nthroughout that n \u2265 3.\n4\n2 Amalgamated factorizations\n2.1 Detachments\nBefore we formally define amalgamations we require another definition. Let\nD andG be graphs. D is a detachment ofG if there is a bijection \u03c1: E(D) \u2212\u2192\nE(G) and a surjection \u03c3: V (D) \u2212\u2192 V (G) such that\n\u2022 if e is a loop on v in D, then \u03c1(e) is a loop on \u03c3(v) in G,\n\u2022 if e is an edge joining v and w in D and \u03c3(v) = \u03c3(w), then \u03c1(e) is a\nloop on \u03c3(v) in G, and\n\u2022 if e is an edge joining v and w in D and \u03c3(v) 6= \u03c3(w), then \u03c1(e) is an\nedge joining \u03c3(v) and \u03c3(w) in G.\nWe can think of D as being obtained from G by splitting vertices. Some\nauthors refer to detachments as disentanglements.\nLet G be a graph of which we seek to find a detachment. We define three\nfunctions f, c, e: P(V (G)) \u2212\u2192 Z, (P(V (G)) is the power set of V (G)). For\neach set of vertices V \u2286 V (G), let f(V ) be the total number of vertices we\nwish to split the vertices of V into, let c(V ) be the number of components in\nG\u2212V , and let e(V ) be the number of edges (including loops) that are incident\nwith at least one vertex in V (loops and edges incident twice with vertices\nin V are only counted once). We need the following result of Nash-Williams\n[9].\nProposition 2 Let k and l be nonnegative integers. Let G be a graph (pos-\nsibly containing multiple edges and loops) in which the degree of each vertex\nis a multiple of k. Then G has an l-edge-connected k-regular detachment if\nand only if\n(X1) G is l-edge-connected,\n(X2) if l = 1, then for all V \u2286 V (G), f(V ) + c(V ) \u2264 e(V ) + 1,\n(X3) if l is odd and l = k, then G has no cutvertex with degree 2l, and\n(X4) if l is odd and l = k, then G is not a loopless graph that contains exactly\ntwo vertices each with degree 2l. \u0003\n5\n2.2 Amalgamations\nAn amalgamation is the opposite of a detachment, except that we define\namalgamations on graphs which have an edge-colouring. Let t be a positive\ninteger. Let F and H be t-edge-coloured graphs. H is an amalgamation of F\nif there is a bijection \u03c6: E(F ) \u2212\u2192 E(H) and a surjection \u03c8: V (F ) \u2212\u2192 V (H)\nsuch that\n\u2022 if e is a loop coloured i on v in F , then \u03c6(e) is a loop coloured i on\n\u03c8(v) in H,\n\u2022 if e is an edge coloured i joining v and w in F and \u03c8(v) = \u03c8(w), then\n\u03c6(e) is a loop coloured i on \u03c8(v) in H, and\n\u2022 if e is an edge coloured i joining v and w in F and \u03c8(v) 6= \u03c8(w), then\n\u03c6(e) is an edge coloured i joining \u03c8(v) and \u03c8(w) in H.\nLet Fi and Hi be the subgraphs of F and H induced by edges coloured i,\n1 \u2264 i \u2264 t.\nLet t, n, K and L satisfy conditions (A1) to (A4) of Theorem 1. Sup-\npose that F = K\n(s)\nn is t-edge-coloured and that Fi is ki-regular and li-edge-\nconnected, 1 \u2264 i \u2264 t. We think of the vertex set of K(s)n as being composed\nof s parts P1, . . . , Ps where each part is a set of n independent vertices. If H\nis an amalgamation of F , then define f : V (H) \u2212\u2192 N by\nf(v) = |{u : u \u2208 V (K(s)n ), \u03c8(u) = v}|,\nand, for 1 \u2264 h \u2264 s, define fh: V (H) \u2212\u2192 N by\nfh(v) = |{u : u \u2208 Ph, \u03c8(u) = v}|.\nSo f counts the vertices that are merged to form v and, for 1 \u2264 h \u2264 s,\nfh tells us how many of these vertices are from Ph. Together H, f and fh,\n1 \u2264 h \u2264 s, form an amalgamated (t,K, L)-factorization of K(s)n .\nProposition 3 Let H, f and fh, 1 \u2264 h \u2264 s, be an amalgamated (t,K, L)-\nfactorization of K\n(s)\nn . Then\n(B1) for all pairs of distinct vertices v, w \u2208 V (H), there are\n\u2211\nh1,h2\u2208{1,...,s}\nh1 6=h2\nfh1(v)fh2(w)\nedges joining v to w,\n6\n(B2) for all v \u2208 V (H), there are\n\u2211\n1\u2264h1<h2\u2264s\nfh1(v)fh2(v) loops on v,\n(B3) for all v \u2208 V (H), for 1 \u2264 i \u2264 t, v is incident with kif(v) edges of\ncolour i (counting loops twice),\n(B4)\n\u2211\nv\u2208V (H)\nf(v) = ns, and, for 1 \u2264 h \u2264 s,\n\u2211\nv\u2208V (H)\nfh(v) = n, and\n(B5) for 1 \u2264 i \u2264 t, Hi has an li-edge-connected ki-regular detachment.\nProof: The number of edges joining vertices v and w (possibly v = w) in\nthe amalgamation is equal to the number of edges in K\n(s)\nn joining a vertex\nmerged to form v to a vertex merged to form w, and pairs of vertices are\njoined by one edge in K\n(s)\nn unless they are in the same part. This is enough\nto prove (B1) and (B2). There are f(v) vertices merged to form v and each\nis incident with ki edges coloured i, 1 \u2264 i \u2264 t, so (B3) is satisfied. As we\nnoted f and fh count vertices in V (K\n(s)\nn ) and Ph respectively. In each case\neach vertex in the set is counted exactly once so (B4) is satisfied. Finally,\nfor (B5), note that Fi is a li-edge-connected ki-regular detachment of Hi. \u0003\n2.3 Outline factorizations\nA t-edge-coloured graph H, a function f : V (H) \u2212\u2192 N and functions fh:\nV (H) \u2212\u2192 N, 1 \u2264 h \u2264 s, form an outline (t,K, L)-factorization of K(s)n\nif they satisfy (B1) to (B5). By Proposition 3, an amalgamated (t,K, L)-\nfactorization of K\n(s)\nn is an outline (t,K, L)-factorization of K\n(s)\nn . As we shall\nsee, the converse is not true in general. However, we can prove that a par-\nticular type of outline factorization of K\n(s)\nn is an amalgamated factorization.\nTheorem 4 Let H, f and fh, 1 \u2264 h \u2264 s, be an outline (t,K, L)-factorization\nof K\n(s)\nn such that li 6= 1, 1 \u2264 i \u2264 t. Then H, f and fh, 1 \u2264 h \u2264 s are an\namalgamated (t,K, L)-factorization of K\n(s)\nn if for each v \u2208 V (H) either\n(Z1) for 1 \u2264 h \u2264 s, fh(v) \u2208 {0, n}, or\n(Z2) fh(v) = 0 for all but one value of h.\n7\nBefore the proof is given we make some remarks about the possibility of\nproving a more general outline\/amalgamation theorem.\nThere are two restrictions on the outline factorizations covered by Theo-\nrem 4. First we have that li 6= 1, 1 \u2264 i \u2264 t. We cannot find an example that\nshows that a theorem without this condition is not true, but we cannot prove\nsuch a theorem. We shall see later why we would have difficulty proving the\ntheorem if we allowed li = 1\nThe second restriction is given by (Z1) and (Z2). Let H be an outline\ngraph that satisfies these two conditions. Suppose that there is a factorization\nof K\n(s)\nn of which H is an amalgamation: we can think of it as being obtained\nby splitting the vertices of H. (Z1) and (Z2) say that each vertex in H must\nbe split either into vertices that comprise all of some number of the parts of\nK\n(s)\nn or into vertices that all belong to the same part of K\n(s)\nn . We consider\nsome examples that show why we impose such restrictions.\nIn the first example let H, f and fh, 1 \u2264 h \u2264 3 be the outline (3, K, L)-\nfactorization of K\n(3)\n3 , with K = L = (2, 2, 2), shown in Figure 1 (for vi 6= X,\nf(vi) = 1, fh(vi) = 1 if\n\u2308\ni\n3\n\u2309\n= h, fh(vi) = 0 otherwise; f(X) = 2, f1(X) =\nf2(X) = 1, f3(X) = 0). We call this an outline Hamiltonian decomposition.\nIt is easy to check that (B1) to (B5) are satisfied, yet we can show that H,\nf and fh, 1 \u2264 h \u2264 3 are not an amalgamation of a (3, K, L)-factorization\nof K\n(3)\n3 . Suppose that K\n(3)\n3 has a Hamiltonian decomposition F1, F2, F3 such\nthat Fi is a detachment of Hi, 1 \u2264 i \u2264 3. Suppose also that the two vertices\ninto which X is split are labelled v1 and v4 so that the parts of K\n(3)\n3 are\n{v1, v2, v3}, {v4, v5, v6} and {v7, v8, v9}. Consider F1, a 9-cycle obtained from\nH1 by splitting X into two vertices, v1 and v4. Clearly each is adjacent to\none of v2 and v7, and one of v5 and v8. The edge v1v2 is not in K\n(3)\n3 so\nwe must have v1v7 \u2208 E(F1). But by a similar argument we must also have\nv1v7 \u2208 E(F2), a contradiction.\nWe have established that a general outline\/amalgamation theorem can-\nnot be proved without some restrictions. Is it possible though to lessen the\nrestrictions of Theorem 4? In [4] Hilton and Rodger considered outline Hamil-\ntonian decompositions of K\n(s)\nn . They stated that H, f and fh, 1 \u2264 h \u2264 s\nwere amalgamations of Hamiltonian decompositions if they satisfied\n(Z1\u2217) for some vertex u \u2208 V (H), fh(u) \u2208 {0, n} for all but at most one value\nof h, and\n8\n@\n@\n@\n@\n@\n@\n@q\nq\nq\nq\nq\nq\nq\nq\nv6\nv7\nv2\nX\nv5\nv8\nv9\nv3\nH1\n@\n@\n@\n@\n@\n@\n@q\nq\nq\nq\nq\nq\nq\nq\nv5\nv7\nv3\nX\nv6\nv9\nv8\nv2\nH2\nq\nq\nq\nq\nq\nq\nq\nq\nv6\nv7\nv2\nX\nv5\nv8v9\nv3\nH3\nFigure 1: Outline Hamiltonian decomposition of K\n(3)\n3\n9\n@\n@\n@\n\u0000\n\u0000\n\u0000\n\u0000\n\u0000\n\u0000\n@\n@\n@r\nr\nr\nr\nr\nr\nr\nr\nr\nr\nr\nrX\nv9\nv3\nv11\nv5\nv8\nv1\nv10\nv4\nv7\nv2\nv6\nH1\n\u001a\n\u001a\n\u001a\n\u001a\nZ\nZ\nZ\nZ\u001a\n\u001a\n\u001a\n\u001a\nZ\nZ\nZ\nZ\u001a\n\u001a\n\u001a\n\u001a\nZ\nZ\nZ\nZ\u001a\n\u001a\n\u001a\n\u001a\nZ\nZ\nZ\nZ\u0001\n\u0001\n\u0001\n\u0001\nA\nA\nA\nA\n\u0013\n\u0013\n\u0013\n\u0013\nS\nS\nS\nS\n@\n@\n@\u0000\n\u0000\n\u0000\nr\nr\nr\nr\nr\nr\nr\nr r\nr r\nr\nX\nv8\nv3\nv1\nv6 v9\nv2\nv10\nv4\nv11\nv5\nv7\nH2\n\u001a\n\u001a\n\u001a\n\u001a\nZ\nZ\nZ\nZ \u001a\n\u001a\n\u001a\n\u001a\nZ\nZ\nZ\nZ\u001a\n\u001a\n\u001a\n\u001a\nZ\nZ\nZ\nZ\u001a\n\u001a\n\u001a\n\u001a\nZ\nZ\nZ\nZ\u0001\n\u0001\n\u0001\n\u0001\nA\nA\nA\nA\nr\nr\nr\nr\nr\nr\nr\nr r\nr\nr\nr\nX\nv1\nv10\nv9 v2\nv5 v8\nv6 v11\nv7\nv4\nv3\nH3\n\u001a\n\u001a\n\u001a\n\u001a\nZ\nZ\nZ\nZ \u001a\n\u001a\n\u001a\n\u001a\nZ\nZ\nZ\nZ\b\b\n\b\b\nHHHH\n\u0001\n\u0001\n\u0001\n\u0001\nA\nA\nA\nA\nA\nA\nA\nA\n\u0001\n\u0001\n\u0001\n\u0001\nr\nr\nr\nr rrr\nr\nr\nrr\nr\nX\nv1\nv6\nv7 v2\nv3 v4\nv5 v8\nv9\nv10\nv11\nH4\n\u001a\n\u001a\n\u001a\n\u001a\nZ\nZ\nZ\nZ\u001a\n\u001a\n\u001a\n\u001a\nZ\nZ\nZ\nZ\u001a\n\u001a\n\u001a\n\u001a\nZ\nZ\nZ\nZ\u001a\n\u001a\n\u001a\n\u001a\nZ\nZ\nZ\nZ\u0001\n\u0001\n\u0001\n\u0001\nA\nA\nA\nA\n\u0013\n\u0013\n\u0013\n\u0013\nS\nS\nS\nS\n@\n@\n@\u0000\n\u0000\n\u0000\nr\nr\nr\nr\nr\nr\nr\nr r\nr r\nr\nX\nv11\nv2\nv1\nv5 v9\nv3\nv10\nv6\nv8\nv7\nv4\nH5\n@\n@\n@\n\u0000\n\u0000\n\u0000\n\u0010\u0010\n\u0010\nPPPr\nr\nr\nr\nr\nr\nr\nr\nrr\nr\nr\nX\nv6\nv4\nv8\nv9\nv2\nv3\nv5\nv11\nv7\nv1\nv10\nH6\nFigure 2: Outline Hamiltonian decomposition of K\n(5)\n3\n10\n(Z2\u2217) for each vertex v \u2208 V (H) \\ {u}, fh(v) = 0 for all but one value of h.\nWe show that this is not true. Let H, f and fh, 1 \u2264 h \u2264 5 be the out-\nline Hamiltonian decomposition of K\n(5)\n3 illustrated in Figure 2 (for vi 6= X,\nf(vi) = 1 and fh(vi) = 1 if\n\u2308\ni\n3\n\u2309\n= h, fh(vi) = 0 otherwise; f(X) = 4,\nfh(X) = 0, 1 \u2264 h \u2264 3, f4(X) = 1, f5(X) = 3). We show that h, f and fh,\n1 \u2264 h \u2264 5 are not an amalgamation of a Hamiltonian decomposition of K(s)n .\nSuppose there is such a decomposition into Hamilton cycles F1, . . . , F6 and\nX is split into vertices labelled v12, v13, v14, v15 so that the parts of K\n(5)\n3 are\n{v3i+1, v3i+2, v3i+3}, 0 \u2264 i \u2264 4. Therefore any loop on X in Hi corresponds\nto an edge in Fi joining v12 to one of v13, v14, v15 (since these latter three\nvertices are independent). But there are three loops on X in H1 so in F1 v12\nmust have degree at least 3, a contradiction.\nWe could avoid such counterexamples by extending the definition of out-\nline factorizations. Consider a (t,K, L)-factorization of K\n(s)\nn , and a subset\nof the vertices that contains f1 vertices from the first part and f2 vertices\nfrom the second part. The number of edges in the subgraph of a ki-factor\ninduced by these vertices is at most (min{f1, f2}min{ki,max{f1, f2}}) (sup-\npose f1 < f2; every edge in the subgraph is incident with one of the f1\nvertices in the first part, and each of these vertices has degree not more than\nki\u2014since this is its degree in the ki-factor\u2014and not more than f2\u2014since\nit is joined by at most one edge to each of the f2 vertices in the second\npart). Hence we can add to Proposition 3 a sixth property of amalgamated\n(t,K, L)-factorizations.\n(B6) Each vertex v has at most\u2211\n1\u2264h1<h2\u2264s\nmin{fh1(v), fh2(v)}min{ki,max{fh1(v), fh2(v)}}\nloops of colour i, 1 \u2264 i \u2264 t.\nThen we could add (B6) to the definition of an outline (t,K, L)-factorization\nof K\n(s)\nn . It is possible, but not obvious, that with this extra condition Hilton\nand Rodger\u2019s theorem on Hamiltonian decompositions could be proved. How-\never, in the more general case it is possible to find outline factorizations that\nsatisfy (Z1\u2217), (Z2\u2217) and (B6) but are not amalgamations. We have an exam-\nple, but it is too large to describe here.\n11\n2.4 Swap-sets\nBefore we prove Theorem 4, we must introduce an important tool first used\nin [2]. Let a and b be vertices each of degree d in a multigraph G. Let u be\na neighbour of a and v be a neighbour of b in G. To (a, b)-swap the vertices\nu and v means to form a new graph from G by deleting the edges au and bv,\nand adding the edges av and bu. Clearly this manoeuvre leaves the degrees\nof all the vertices unaltered.\nWe can find d neighbours of a in G by counting a vertex u as a neighbour\nof a as many times as there are edges au. An (a, b)-swap-set is a collection\nof d pairs of vertices such that each neighbour of a is the first element of\nexactly one pair and each neighbour of b is the second element of exactly one\npair. We call the pairs (a, b)-pairs. The proof of the following lemma uses\nan argument from [2]\nLemma 5 If a and b are vertices each of degree d in a l-edge-connected\nmultigraph G, then there exists an (a, b)-swap-set S such that a graph obtained\nfrom G by (a, b)-swapping any number of (a, b)-pairs in the swap-set is at least\nl-edge-connected.\nWe call a swap-set that satisfies this lemma an (a, b, l)-swap-set.\nProof: First form S. In G we can find l edge-disjoint a\u2013b paths auj \u00b7 \u00b7 \u00b7 vjb,\n1 \u2264 j \u2264 l. Let (uj, vj) be a pair in S. For any edges ab in G not already\nconsidered as one of the paths, let (b, a) be a pair in S. Complete S by\npairing off the remaining neighbours of a and b arbitrarily.\nConsider a graph obtained from G by (a, b)-swapping pairs in S. It\ncontains l edge-disjoint a\u2013b paths since, for 1 \u2264 j \u2264 l, it contains either\nauj \u00b7 \u00b7 \u00b7 vjb or buj \u00b7 \u00b7 \u00b7 vja. Now we use induction to prove the lemma. We\nknow that G is l-edge-connected. Suppose that after some number of (a, b)-\nswaps we have obtained a graph H that is l-edge-connected, and then we\n(a, b)-swap a further (a, b)-pair (u, v) to obtain a graph J . That is, au and\nbv are deleted in H and replaced by av and bu to obtain J . If J is not l-edge\nconnected, then we can find a minimal edge-cutset E such that |E| < l. We\nshow that H has an edge-cutset of the same size as E, a contradiction. Let\nC1 and C2 be the two connected components of J \u2212 E. In J there are l\nedge-disjoint a\u2013b paths so a and b must be in the same component of J \u2212E,\nsay C1. If u and v are also both in C1, then in J \u2212 E we could reverse the\n12\n(a, b)-swap of u and v to obtain H \u2212 E which would also have two compo-\nnents. If u and v are both in C2, then av and bu must both be in E. Thus\n(E \\ {av, bu})\u222a{au, bv} is an edge-cutset of H. Finally, suppose that u is in\nC1 and v is in C2. Then av \u2208 E and bu \u2208 C1. Let E \u2032 = (E \\ {av}) \u222a {bv}\nand C \u20321 = (C1 \u2212 {bu}) \u222a {au}. Thus H \u2212E \u2032 has two connected components,\nC \u20321 and C2. \u0003\n2.5 Proof of Theorem 4\nWe will find a (t,K, L)-factorization of K\n(s)\nn of which H, f and fh, 1 \u2264 h \u2264 s\nare an amalgamation.\nBy (B5), for 1 \u2264 i \u2264 t, Hi has an li-edge-connected ki-regular detachment\nFi. Hi is called a colour class and Fi is called a factor. Let V (K\n(s)\nn ) be the\nvertex set of each factor. Label the vertices of each factor so that for each\nvertex v in H the set of vertices into which v is split when Fi is obtained\nfrom Hi is the same for each i, 1 \u2264 i \u2264 t. Also let the number of vertices in\nPh, 1 \u2264 h \u2264 s, formed when v is split be fh(v). Let U also be a graph with\nvertex set V (K\n(s)\nn ) that contains each edge of each factor. We need to alter\nthe factors until U = K\n(s)\nn whilst retaining the property that each factor Fi is\na ki-regular li-edge-connected detachment of the corresponding colour class\nHi, 1 \u2264 i \u2264 t.\nLet V (H) = {v1, v2, . . . , vr}. Let V (K(s)n ) = V1 \u222a V2 \u222a \u00b7 \u00b7 \u00b7 \u222a Vr, where\nVj, 1 \u2264 j \u2264 r, is the set of vertices\u2014called a set of split vertices\u2014that was\nformed by the splitting of the vertex vj in each Hi. For 1 \u2264 j \u2264 r, 1 \u2264 h \u2264 s,\nlet Ijh = Vj \u2229Ph; we call these sets independent sets of split vertices. So each\nset of split vertices can be partitioned into independent sets of split vertices.\nNote that |Ijh| = fh(vj). If a part Ph of V (K(s)n ) is a subset of a set of\nsplit vertices, then it is called a single part (i.e fh(vj) = n for some j); if it\ncontains vertices from more than one set of split vertices, then it is called a\nmixed part.\nLet x and y each be either a vertex, an independent set of split vertices\nor a set of split vertices. Then p(x, y) is the number of edges in U that\njoin x to y and q(x, y) is the number of edges in K\n(s)\nn that join x to y. If\np(x, y) = q(x, y), then we may say that x and y are joined the correct number\nof times.\nThere are four main stages to the proof. At each stage we use (a, b)-swaps\nto make alterations to the factors and thus also to U . (Note that to avoid\n13\nintroducing further notation we use the same names\u2014Fi, 1 \u2264 i \u2264 t, and\nU\u2014for graphs before and after making (a, b)-swaps). In (C1) to (C4) we\nstate the property U has at the end of each stage.\n(C1) For each independent set of split vertices Ijh and each set of split\nvertices Vz, p(Ijh, Vz) = q(Ijh, Vz).\n(C2) For each pair of independent sets of split vertices Ijh and Izg, p(Ijh, Izg) =\nq(Ijh, Izg).\n(C3) For each vertex v and each independent set of split vertices Ijh,\np(v, Ijh) = q(v, Ijh).\n(C4) For each pair of vertices v and w, p(v, w) = q(v, w).\nNote that when (C4) is satisfied, U = K\n(s)\nn and the proof is complete.\nFor the first two stages we will work not with the factors Fi but with\ngraphs F \u2217i that are amalgamations of the factors and detachments of the\ncolour classes. They are called partially amalgamated factors and are ob-\ntained from the factors by merging vertices that belong to the same single\npart. That is, they have vertex set A \u222aB where\nA = {v \u2208 K(s)n : v is in a mixed part},\nB = {P \u2217 : P is a single part},\nand for each edge uv in Fi\n\u2022 if u and v are both in mixed parts, then there is an edge uv in F \u2217i ,\n\u2022 if u is in a mixed part and v is a single part P , then there is an edge\nuP \u2217 in F \u2217i , and\n\u2022 if u is in a single part P1 and v is in a single part P2, then there is an\nedge P \u22171P\n\u2217\n2 in F\n\u2217\ni .\nNote that F \u2217i , 1 \u2264 i \u2264 t, is li-edge-connected. Let U\u2217 be a graph also with\nvertex set A\u222aB that contains each edge of each partially amalgamated factor.\nIf V \u2286 K(s)n is a set of split vertices, then the subset of A\u222aB that comprises\nthe vertices formed when the vertices of V were merged is also called a set\nof split vertices and is denoted V \u2217; independent subsets of split vertices in\nA \u222a B are similarly defined and denoted. Note that, by (Z1) and (Z2), in\n14\nU\u2217 sets of split vertices contain either vertices in A or vertices in B but not\nboth, and each vertex in B is an independent set of split vertices.\nLet x and y each be either a vertex, an independent set of split vertices\nor a set of split vertices in U\u2217. Then p\u2217(x, y) denotes the number of edges\nthat join x to y in U\u2217 and q\u2217(x, y) denotes the number of edges that join x\nto y in an amalgamation of K\n(s)\nn with vertex set A \u222aB. Note that (B1) and\n(B2) say that each pair of sets of split vertices in U and U\u2217 are joined the\ncorrect number of times.\nBefore we come to the four main stages of the proof, we remove any loops\nfrom the partially amalgamated factors. Note that the vertices of A belong\nto sets of split vertices that belong to mixed parts, and therefore, by (Z1)\nand (Z2), to sets of split vertices V \u2217j such that fh(vj) = 0 for all but one\nvalue of h. Hence, by (B2), the vertices of A do not have any loops. Suppose\nthat there is a loop on P \u2217 \u2208 B in F \u2217i . Let V \u2217z be the set of split vertices that\ncontains P \u2217. By (B2), fh(vz) > 0 for more than one value of h so there is\na vertex Q\u2217 \u2208 V \u2217z , P \u2217 6= Q\u2217. If there is also a loop on Q\u2217, then we delete\nthe two loops and add two edges that each join P \u2217 to Q\u2217. Otherwise we\ncan find an edge Q\u2217u, u 6= P \u2217, and we delete this edge and the loop on P \u2217\nand add edges P \u2217Q\u2217 and P \u2217u. In each case F \u2217i remains an li-edge-connected\ndetachment of Hi and the vertices\u2019 degrees do not change.\nLet P \u2217 and Q\u2217 be vertices in B that belong to the same set of split\nvertices. Each has degree kin in F\n\u2217\ni , 1 \u2264 i \u2264 t, and therefore each has kin\nneighbours. By Lemma 5 we can find a (P \u2217, Q\u2217, li)-swap set. We call this\nset S\u2217i (P\n\u2217, Q\u2217). Recall that this is a collection of kin (P \u2217, Q\u2217)-pairs in F \u2217i\nsuch that each neighbour of P \u2217 is the first element of exactly one pair and\neach neighbour of Q\u2217 is the second element of exactly one pair and that if we\n(P \u2217, Q\u2217)-swap pairs in S\u2217i (P\n\u2217, Q\u2217), then F \u2217i remains li-edge-connected, and as\nP \u2217 and Q\u2217 belong to the same set of split vertices, F \u2217i remains a detachment\nof Hi.\nWe show that after performing any number of (P \u2217, Q\u2217)-swaps on F \u2217i , we\ncan always find a detachment Fi that is an li-edge-connected ki-factor ofK\n(s)\nn .\nProposition 2 tells us when it is possible to find such detachments. Of the\nfour conditions, (X2) does not apply since we have that li 6= 1, 1 \u2264 i \u2264 t, and\n(X3) and (X4) do not apply since n 6= 2 so F \u2217i has no vertex of degree 2ki.\nThus we only require that (X1) is satisfied, and as we have just noted, F \u2217i\nremains li-edge-connected. (We observe that if li = 1, then (X2) would not\nnecessarily remain satisfied after a (P \u2217, Q\u2217)-swap. This is the reason that we\n15\ncannot prove the theorem if we allow li = 1.)\nWe recast (C1) and (C2) in terms of the partially amalgamated factors.\nConsider (C1). Each independent set of split vertices in A is also a set of\nsplit vertices so by (B1) is already joined the correct number of times to\nevery other set of split vertices. We must alter the partially amalgamated\nfactors so that each independent set of split vertices in B is joined the correct\nnumber of times to each set of split vertices. But the independent sets of\nsplit vertices in B are its vertices so we require that\n(C1\u2217) for each P \u2217 \u2208 B, for 1 \u2264 j \u2264 r, p\u2217(P \u2217, V \u2217j ) = q\u2217(P \u2217, V \u2217j ).\nWhen (C1\u2217) is satisfied each independent set of split vertices in A will be\njoined the correct number of times to every other independent set of split\nvertices (in A and B). We require that the same is true for independent sets\nof split vertices in B so we further alter the partially amalgamated factors\nso that\n(C2\u2217) for each distinct pair P \u2217, Q\u2217 \u2208 B, p\u2217(P \u2217, Q\u2217) = q\u2217(P \u2217, Q\u2217).\nWhen (C2\u2217) is satisfied the partially amalgamated factors will have detach-\nments that satisfy (C2).\nWe begin with (C1\u2217). Let the set-discrepancy of the partially amalga-\nmated factors be defined by\n\u03b4\u2217s =\nr\u2211\nj=1\n\u2211\nP \u2217\u2208B\n|p\u2217(P \u2217, Vj)\u2212 q\u2217(P \u2217, Vj)|.\nWhen \u03b4\u2217s = 0, (C1\n\u2217) is satisfied. We must alter the partially amalgamated\nfactors so that \u03b4\u2217s is reduced if it is greater than zero.\nAs we noted, each pair of sets of split vertices in U\u2217 is joined the correct\nnumber of times. Thus, for 1 \u2264 j \u2264 r, for each set of split vertices V \u2217z \u2286 B,\u2211\nP \u2217\u2208V \u2217z\np\u2217(P \u2217, V \u2217j ) =\n\u2211\nP \u2217\u2208V \u2217z\nq\u2217(P \u2217, V \u2217j ). (1)\nIf \u03b4\u2217s 6= 0, then there is a vertex P \u2217 \u2208 B and a set of split vertices V \u2217z1\nsuch that p\u2217(P \u2217, V \u2217z1) 6= q\u2217(P \u2217, V \u2217z1). By (1), we can assume without loss of\ngenerality that\np\u2217(P \u2217, V \u2217z1) > q\n\u2217(P \u2217, V \u2217z1) (2)\n16\nand that there exists another vertex Q\u2217 \u2208 B that is in the same set of split\nvertices as P \u2217 such that\np\u2217(Q\u2217, V \u2217z1) < q\n\u2217(Q\u2217, V \u2217z1). (3)\nFrom S\u2217i (P\n\u2217, Q\u2217), 1 \u2264 i \u2264 t, we create a further set S\u2217(P \u2217, Q\u2217): for 1 \u2264 i \u2264 t,\nif (u, v) \u2208 S\u2217i (P \u2217, Q\u2217), then (i, u, v) \u2208 S\u2217(P \u2217, Q\u2217). Note that there is an\nobvious one-to-one relationship between the neighbours, over all the partially\namalgamated factors, of P \u2217 and the triples of S\u2217(P \u2217, Q\u2217). Similarly for the\nneighbours of Q\u2217.\nClaim 6 There is a sequence of sets of split vertices\n\u0393 = V \u2217z1 , V\n\u2217\nz2\n, . . . , V \u2217zm\nsuch that\n(D1) V \u2217z\u03b1 6= V \u2217z\u03b2 if \u03b1 6= \u03b2,\n(D2) either p\u2217(P \u2217, V \u2217zm) < q\n\u2217(P \u2217, V \u2217zm) or p\n\u2217(Q\u2217, V \u2217zm) > q\n\u2217(Q\u2217, V \u2217zm), and\n(D3) for 2 \u2264 j \u2264 m, there is a triple (ij, uj, vj) \u2208 S\u2217(P \u2217, Q\u2217) where uj \u2208\nV \u2217zj\u22121 and vj \u2208 V \u2217zj .\nProof: In fact, we shall prove that there is a sequence of sets of split vertices\n\u2206 = V \u2217g1 , V\n\u2217\ng2\n, . . . , V \u2217gm\u2032\nsuch that\n(E1) V \u2217g1 = V\n\u2217\nz1\n,\n(E2) V \u2217g\u03b1 6= V \u2217g\u03b2 if \u03b1 6= \u03b2,\n(E3) either p\u2217(P \u2217, V \u2217gm\u2032 ) < q\n\u2217(P \u2217, V \u2217gm\u2032 ) or p\n\u2217(Q\u2217, V \u2217gm\u2032 ) > q\n\u2217(Q\u2217, V \u2217gm\u2032 ), and\n(E4) for 2 \u2264 j \u2264 m\u2032, there is a triple (ij, uj, vj) \u2208 S\u2217(P \u2217, Q\u2217) where uj \u2208 V \u2217gh\nfor some h \u2208 {1, 2, . . . , j \u2212 1} and vj \u2208 V \u2217gj .\n17\nIt is easy to see that \u2206 has a subsequence that has V \u2217g1 = V\n\u2217\nz1\nas the first\nterm and satisfies (D1), (D2) and (D3). (Let V \u2217gm\u2032 be the final term and work\nbackwards. If V \u2217g\u03b1 is the last term reached, then if \u03b1 = 1 the subsequence\nis found. Otherwise, by (E4), there is a triple (i\u03b1, u\u03b1, v\u03b1). Let the previous\nterm of the sequence be the set of split vertices V \u2217g\u03b2 that contains u\u03b1. As\n\u03b2 < \u03b1 we must eventually get back to V \u2217g1 .)\nWe find \u2206. The first term V \u2217g1 = V\n\u2217\nz1\nwas found before the claim was\nstated. Suppose that we have found the first \u00b5 terms, and that this se-\nquence of \u00b5 terms satisfies (E1), (E2) and (E4) with m\u2032 = \u00b5. If for any\n\u03b1 \u2208 {1, 2, . . . , \u00b5}\np\u2217(P \u2217, V \u2217g\u03b1) < q\n\u2217(P \u2217, V \u2217g\u03b1), or\np\u2217(Q\u2217, V \u2217g\u03b1) > q\n\u2217(Q\u2217, V \u2217g\u03b1),\nthen we pick the smallest such \u03b1 and let \u2206 = V \u2217g1 , V\n\u2217\ng2\n, . . . , V \u2217g\u03b1 as this also\nsatisfies (E3). Otherwise, for 1 \u2264 j \u2264 \u00b5,\np\u2217(P \u2217, V \u2217gj) \u2265 q\u2217(P \u2217, V \u2217gj), (4)\np\u2217(Q\u2217, V \u2217gj) \u2264 q\u2217(Q\u2217, V \u2217gj). (5)\nLet W = V \u2217g1 \u222a V \u2217g2 \u222a \u00b7 \u00b7 \u00b7 \u222a V \u2217g\u00b5 . As P \u2217 and Q\u2217 are in the same set of split\nvertices, q\u2217(P \u2217, V \u2217j ) = q\n\u2217(Q\u2217, V \u2217j ), 1 \u2264 j \u2264 r. By (2), (3), (4) and (5), over\nall the factors P \u2217 has more neighbours than Q\u2217 in W . In S\u2217(P \u2217, Q\u2217) there\nis a triple corresponding to each neighbour of P \u2217 in each factor; similarly\nthere is a triple corresponding to each neighbour of Q\u2217. So there is a triple\n(i\u00b5+1, u\u00b5+1, v\u00b5+1) \u2208 S\u2217(P \u2217, Q\u2217), such that u\u00b5+1 \u2208 W and v\u00b5+1 \/\u2208 W . Let the\nset of split vertices containing v\u00b5+1 be V\n\u2217\ng\u00b5+1\n. Then V \u2217g\u00b5+1 6= V \u2217gj , 1 \u2264 j \u2264 \u03c9,\nsince V \u2217g\u00b5+1 6\u2286 W .\nWe must eventually find a set of split vertices that satisfies (E3): note\nthat\nr\u2211\nj=1\np\u2217(P \u2217, V \u2217j ) =\nr\u2211\nj=1\nq\u2217(P \u2217, V \u2217j ), (6)\nsince both sums are equal to n2(s \u2212 1), the sum of the degrees of P \u2217 taken\nover all the factors. As p\u2217(P \u2217, V \u2217z1) > q\n\u2217(P \u2217, V \u2217z1), there is at least one set of\nsplit vertices Vz such that p\n\u2217(P \u2217, V \u2217z ) < q\n\u2217(P \u2217, V \u2217z ) and therefore Vz, at least,\nsatisfies (E3). This completes the proof of Claim 6. \u0003\nWe use the claim to reduce \u03b4\u2217s . For 2 \u2264 j \u2264 m, (P \u2217, Q\u2217)-swap uj and vj\n18\nin F \u2217ij . Each new partially amalgamated factor F\n\u2217\ni obtained in this way is an\nli-edge-connected detachment of the corresponding colour class Hi.\nFor 2 \u2264 j \u2264 m\u2212 1, an edge from P \u2217 to a vertex, uj+1, that is in V \u2217zj , has\nbeen deleted and an edge from P \u2217 to a vertex, vj, that is in V \u2217zj has been\nadded. Thus p\u2217(P \u2217, V \u2217zj) is unchanged. Similarly p\n\u2217(Q\u2217, V \u2217zj), 2 \u2264 j \u2264 m\u2212 1,\nis unchanged.\nThe edge P \u2217u2 is deleted so p\u2217(P \u2217, V \u2217z1) is reduced by 1. Hence, by (2),\n\u03b4\u2217s is also reduced by 1. The addition of Q\n\u2217u2 causes p\u2217(Q\u2217, V \u2217z1) to increase\nby 1 so, by (3), \u03b4\u2217s decreases further by 1.\nConsider (D2). If p\u2217(P \u2217, V \u2217zm) < q\n\u2217(P \u2217, V \u2217zm), then the addition of P\n\u2217vm\ncauses p\u2217(P \u2217, V \u2217zm) to increase by 1, and \u03b4\n\u2217\ns is reduced further by 1. The\ndeletion of Q\u2217vm may cause \u03b4\u2217s to increase by 1, but at worst \u03b4\n\u2217\ns is reduced\nby 2 overall. The other possibility is that p\u2217(Q\u2217, V \u2217zm) > q\n\u2217(Q\u2217, V \u2217zm), and by\na similar argument \u03b4\u2217s is reduced overall by at least 2 in this case also. Note\nthat the partially amalgamated factors remain loopless.\nBy repeated application of Claim 6, \u03b4\u2217s is reduced to zero. Thus (C1\n\u2217)\nis satisfied, that is, every independent set of split vertices in B is joined the\ncorrect number of times to every set of split vertices. Independent sets of\nsplit vertices in A were already joined the correct number of times to each set\nof split vertices, so by finding detachments Fi of each F\n\u2217\ni we could obtain a\nset of factors that satisfies (C1). For now however, we continue to work with\nthe partially amalgamated factors. We show that when (C1\u2217) is satisfied, we\ncan further alter them so that (C2\u2217) is also satisfied, that is, so that each\npair of independent sets of split vertices in B is joined the correct number of\ntimes (remember that the independent sets of split vertices in B are just its\nvertices).\nLet the independent-set-discrepancy \u03b4\u2217i of the partially amalgamated fac-\ntors be defined by\n\u03b4\u2217i =\n\u2211\nP\u2217,Q\u2217\u2208B\nQ\u2217 6=P \u2217\n|p\u2217(P \u2217, Q\u2217)\u2212 q\u2217(P \u2217, Q\u2217)|.\nIf (C2\u2217) is satisfied, then \u03b4\u2217i = 0. We describe a method that will reduce\n\u03b4\u2217i if it is greater than zero.\nWe need only consider sets of split vertices that each contain at least two\nvertices in B since if a vertex P \u2217 \u2208 B is the only vertex in a set of split\nvertices, then, by (C1\u2217) it is already joined the correct number of times to\nevery other vertex in B.\n19\nClaim 7 Suppose that P \u2217 and Q\u2217 are vertices in B in the same set of split\nvertices and that I\u2217z1 \/\u2208 {P \u2217, Q\u2217} is an independent set of split vertices such\nthat\np\u2217(P \u2217, I\u2217z1) > q\n\u2217(P \u2217, I\u2217z1), (7)\np\u2217(Q\u2217, I\u2217z1) < q\n\u2217(Q\u2217, I\u2217z1). (8)\nLet S\u2217(P \u2217, Q\u2217) be defined as before. Then there is a sequence of independent\nsets of split vertices\n\u0393 = I\u2217z1 , I\n\u2217\nz2\n, . . . , I\u2217zm\nsuch that\n(F1) I\u2217zj \/\u2208 {P \u2217, Q\u2217}, 1 \u2264 j \u2264 m,\n(F2) I\u2217z\u03b1 6= I\u2217z\u03b2 if \u03b1 6= \u03b2,\n(F3) either p\u2217(P \u2217, I\u2217zm) < q\n\u2217(P \u2217, I\u2217zm) or p\n\u2217(Q\u2217, I\u2217zm) > q\n\u2217(Q\u2217, I\u2217zm), and\n(F4) for 2 \u2264 j \u2264 m, there is a triple (ij, uj, vj) \u2208 S\u2217(P \u2217, Q\u2217) where uj \u2208\nI\u2217zj\u22121 and vj \u2208 I\u2217zj .\nProof: Again we shall actually prove that there is a sequence of independent\nsets of split vertices\n\u2206 = I\u2217g1 , I\n\u2217\ng2\n, . . . , I\u2217gm\u2032\nsuch that\n(G1) I\u2217g1 = I\n\u2217\nz1\n,\n(G2) I\u2217gj \/\u2208 {P \u2217, Q\u2217}, 1 \u2264 j \u2264 m,\n(G3) I\u2217g\u03b1 6= I\u2217g\u03b2 if \u03b1 6= \u03b2,\n(G4) either p\u2217(P \u2217, I\u2217gm\u2032 ) < q\n\u2217(P \u2217, I\u2217gm\u2032 ) or p\n\u2217(Q\u2217, I\u2217gm\u2032 ) > q\n\u2217(Q\u2217, I\u2217gm\u2032 ), and\n(G5) for 2 \u2264 j \u2264 m\u2032, there is a triple (ij, uj, vj) \u2208 S\u2217(P \u2217, Q\u2217) where uj \u2208 I\u2217gh\nfor some h \u2208 {1, 2, . . . , j \u2212 1} and vj \u2208 I\u2217gj .\n20\nAs before, from \u2206 we can find \u0393.\nThe first term of \u2206, I\u2217g1 = I\n\u2217\nz1\n, is known by the hypothesis. Suppose that\nwe have found the first \u00b5 terms. If the sequence is not complete, then we can\nassume that, for 1 \u2264 j \u2264 \u00b5,\np\u2217(P \u2217, I\u2217gj) \u2265 q\u2217(P \u2217, I\u2217gj), (9)\np\u2217(Q\u2217, I\u2217gj) \u2264 q\u2217(Q\u2217, I\u2217gj). (10)\nLet W = I\u2217g1 \u222a I\u2217g2 \u222a \u00b7 \u00b7 \u00b7 \u222a I\u2217g\u00b5 . As P \u2217 and Q\u2217 are both vertices in B,\nq\u2217(P \u2217, I\u2217) = q\u2217(Q\u2217, I\u2217), for every independent set of split vertices I\u2217 \/\u2208\n{P \u2217, Q\u2217}. Therefore, by (7), (8), (9) and (10), over all the partially amalga-\nmated factors P \u2217 has more neighbours than Q\u2217 in W . So there is a triple\n(i\u00b5+1, u\u00b5+1, v\u00b5+1) \u2208 S\u2217(P \u2217, Q\u2217) such that u\u00b5+1 \u2208 W and v\u00b5+1 \/\u2208 W . Let the\nindependent set of split vertices containing v\u00b5+1 be I\n\u2217\ng\u00b5+1\n. Then I\u2217g\u00b5+1 6= I\u2217gj ,\n1 \u2264 j \u2264 \u00b5, since I\u2217g\u00b5+1 6\u2282 W , and I\u2217g\u00b5+1 \/\u2208 {P \u2217, Q\u2217} since v\u00b5+1 \/\u2208 {P \u2217, Q\u2217} as\nv\u00b5+1 = P\n\u2217 would imply that u\u00b5+1 = Q\u2217, and v\u00b5+1 = Q\u2217 would imply that\nthere is a loop on Q\u2217.\nWe must eventually find a set of split vertices that satisfies (G4): note\nthat \u2211\np\u2217(P \u2217, I\u2217) =\n\u2211\nq\u2217(P \u2217, I\u2217), (11)\n(where the sums are over all independent sets of split vertices I\u2217) since both\nsums are equal to n2(s\u2212 1), the sum of the degrees of P \u2217 taken over all the\nfactors. As p\u2217(P \u2217, I\u2217z1) > q\n\u2217(P \u2217, I\u2217z1), there is at least one independent set of\nsplit vertices I\u2217 such that p\u2217(P \u2217, I\u2217) < q\u2217(P \u2217, I\u2217) and therefore I\u2217, at least,\nsatisfies (F3). This completes the proof of Claim 7. \u0003\nWe describe how to use the claim to reduce \u03b4\u2217i .\nChoose a set of split vertices V \u2217z \u2286 B such that\n(C1\u2217a) for every independent set of split vertices I\u2217 \u2208 B \\ V \u2217z , p\u2217(I\u2217, V \u2217j ) =\nq\u2217(I\u2217, V \u2217j ), 1 \u2264 j \u2264 r.\nAs (C1\u2217) implies (C1\u2217a) we can begin by choosing any set as V \u2217z . If possible\nchoose a pair of independent sets of split vertices P \u2217 \u2208 V \u2217z , I\u2217z1 6\u2286 V \u2217z that\nsatisfies (7). By (C1\u2217a), there exists Q\u2217 \u2208 V \u2217z that satisfies (8). Now we\ncan use Claim 7. For 2 \u2264 j \u2264 m, (P \u2217, Q\u2217)-swap (uj, vj) in F \u2217ij . Thus\nfor 2 \u2264 j \u2264 m \u2212 1, we add P \u2217vj to F \u2217ij and delete P \u2217uj+1 from F \u2217ij+1 ,\nand so p\u2217(P \u2217, I\u2217zj) is unchanged since vj, uj+1 \u2208 I\u2217zj . Similarly p\u2217(Q\u2217, I\u2217zj) is\n21\nunchanged, 2 \u2264 j \u2264 m \u2212 1. By (7) and (8), the deletion of P \u2217u2 and the\naddition of Q\u2217u2 reduce \u03b4\u2217i by 2, and, by (F4), the addition of P\n\u2217vm and the\ndeletion of Q\u2217vm at worst have no further effect on \u03b4\u2217i . Note that no loops\nare created.\nConsider how these (P \u2217, Q\u2217)-swaps affect \u03b4\u2217s . Let V\n\u2217\nzj\nbe the set of split\nvertices that contains I\u2217zj , 1 \u2264 j \u2264 m. For 2 \u2264 j \u2264 m \u2212 1, p\u2217(P \u2217, I\u2217zj)\nand p\u2217(Q\u2217, I\u2217zj) were unchanged so p\n\u2217(P \u2217, V \u2217zj) and p\n\u2217(Q\u2217, V \u2217zj) do not change.\nNote that\np\u2217(P \u2217, V \u2217z1) and p\n\u2217(Q\u2217, V \u2217zm) are reduced by 1, and (12)\np\u2217(P \u2217, V \u2217zm) and p\n\u2217(Q\u2217, V \u2217z1) are increased by 1. (13)\nNote that V \u2217z1 and V\n\u2217\nzm are both subsets of B since they contain Iz1 and Izm\nwhich satisfy (7) and (F4) respectively and we know that each independent\nset of split vertices in A is already joined the correct number of times to P \u2217\nand Q\u2217.\nAs P \u2217, Q\u2217 \u2282 V \u2217z , (C1\u2217a) remains satisfied. So we look for further pairs\nP \u2217 \u2208 Vz, I\u2217z1 6\u2282 Vz, and repeat the process. When no such pairs remain we\nhave p\u2217(P \u2217, I\u2217) = q\u2217(P \u2217, I\u2217) for every P \u2217 \u2208 V \u2217z , for every independent set\nof vertices I\u2217 \/\u2208 V \u2217z . As p\u2217(P \u2217, V \u2217j ) =\n\u2211\np\u2217(P \u2217, I\u2217) (where the sum is over\nall independent sets of vertices I\u2217 \u2286 V \u2217j ), we have p\u2217(P \u2217, V \u2217j ) = q\u2217(P \u2217, V \u2217j ),\n1 \u2264 j \u2264 r, j 6= z. By (6), this implies that p\u2217(P \u2217, V \u2217z ) = q\u2217(Q\u2217, V \u2217z ) also.\nThus\n(C1\u2217b) for every vertex P \u2217 \u2208 V \u2217z , p\u2217(P \u2217, V \u2217j ) = q\u2217(P \u2217, V \u2217j ), 1 \u2264 j \u2264 r.\nNote that (C1\u2217a) and (C1\u2217b) together imply (C1\u2217).\nNow find a pair P \u2217 \u2208 V \u2217z , I\u2217z1 \u2208 V \u2217z that satisfies (7). By (C1\u2217b), there\nexists Q\u2217 \u2208 V \u2217z that satisfies (8) so we can reduce \u03b4\u2217i further using the claim\nand the method of (P \u2217, Q\u2217)-swapping just described. Note that V \u2217z1 = V\n\u2217\nz and\nthat V \u2217zm = V\n\u2217\nz (since only I\n\u2217\nzm \u2208 V \u2217z can satisfy (F4)). Thus (12) and (13)\ncancel each other out and (C1\u2217a) and (C1\u2217b) remain satisfied. We repeat\nthis until there are no further pairs P \u2217, I\u2217z1 \u2208 V \u2217z that satisfy (7). Then we\nbegin the whole process again with another choice of V \u2217z . Eventually \u03b4\n\u2217\ni is\nreduced to zero and (C2\u2217) is satisfied.\nTherefore we can find detachments of the partially amalgamated factors\nthat form a set of factors that satisfy (C2), and it is these we work with for\nthe rest of the proof.\n22\nWhether or not independent sets of split vertices belong to the same\nset of split vertices is not important in the next two stages of the proof.\nTherefore we can label the independent sets of split vertices more simply as\nI1, I2, . . . , Ir\u2032 .\nBy (C2), for 1 \u2264 j < z \u2264 r\u2032,\np(Ij, Iz) = q(Ij, Iz). (14)\nLet the independent-set-discrepancy of the factors be defined by\n\u03b4i =\n\u2211\na\u2208V (K(s)n )\nr\u2032\u2211\nj=1\n|p(a, Ij)\u2212 q(a, Ij)|.\nWhen (C3) is satisfied, \u03b4i = 0. If \u03b4i > 0, we must show how to reduce it.\nLet j and z be fixed. By (14),\u2211\na\u2208Iz\np(a, Ij) =\n\u2211\na\u2208Iz\nq(a, Ij). (15)\nIf \u03b4i > 0, then for some vertex a and some z1, p(a, Iz1) 6= q(a, Iz1). We\ncan assume that\np(a, Iz1) > q(a, Iz1), (16)\np(b, Iz1) < q(b, Iz1), (17)\nwhere b is a vertex in the same independent set of split vertices as a.\nBy Lemma 2, for each Fi we can form an (a, b, li)-swap-set which we call\nSi(a, b). We form a further set S(a, b): for 1 \u2264 i \u2264 t, if (c, d) \u2208 Si(a, b), then\n(i, c, d) \u2208 S(a, b). Thus S(a, b) contains ordered triples (i, c, d) where c is a\nneighbour of a and d is a neighbour of b in Fi. Note that there is an obvious\none-to-one relationship between the triples of S(a, b) and the neighbours,\nover all the factors, of a, and also between the triples of S(a, b) and the\nneighbours, over all the factors, of b.\nClaim 8 There is a sequence of independent sets of split vertices\n\u0393 = Iz1 , Iz2 , . . . , Izm\nsuch that\n23\n(H1) Iz\u03b1 6= Iz\u03b2 if \u03b1 6= \u03b2,\n(H2) either p(a, Izm) < q(a, Izm) or p(b, Izm) > q(b, Izm), and\n(H3) for 2 \u2264 j \u2264 m, there is a triple (ij, cj, dj) \u2208 S(a, b) where cj \u2208 Izj\u22121\nand dj \u2208 Izj .\nProof: In fact we shall prove that there is a sequence of independent sets of\nsplit vertices\n\u2206 = Ig1 , Ig2 , . . . , Igm\u2032\nsuch that\n(I1) Ig1 = Iz1 ,\n(I2) Ig\u03b1 6= Ig\u03b2 if \u03b1 6= \u03b2,\n(I3) either p(a, Igm\u2032 ) < q(a, Igm\u2032 ) or p(b, Igm\u2032 ) > q(b, Igm\u2032 ), and\n(I4) for 2 \u2264 j \u2264 m\u2032, there is a triple (ij, cj, dj) \u2208 S(a, b) where cj \u2208 Igh for\nsome h \u2208 {1, 2, . . . , j \u2212 1} and dj \u2208 Igj .\nFrom \u2206 we can find \u0393.\nThe first term Ig1 = Iz1 was found before the claim was stated. If the\nsequence is not complete, then we can assume that, for 1 \u2264 j \u2264 \u00b5,\np(a, Igj) \u2265 q(a, Igj), (18)\np(b, Igj) \u2264 q(b, Igj). (19)\nLet W = Ig1 \u222a Ig2 \u222a \u00b7 \u00b7 \u00b7 \u222a Ig\u00b5 . As a and b are in the same set of split vertices,\nq(a, Ij) = q(b, Ij), 1 \u2264 j \u2264 r. Therefore, by (16), (17), (18) and (19) over\nall the factors a has more neighbours than b in W . So there is a triple\n(i\u00b5+1, c\u00b5+1, d\u00b5+1) \u2208 S(a, b), such that c\u03c9+1 \u2208 W and d\u00b5+1 \/\u2208 W . Let the set\nof split vertices containing d\u00b5+1 be Vg\u00b5+1 . Then Vg\u00b5+1 6= Vgj , 1 \u2264 j \u2264 \u00b5, since\nVg\u00b5+1 6\u2282 W .\nWe will eventually find a set of split vertices that satisfies (I3): note that\nr\u2211\nj=1\np(a, Ij) =\nr\u2211\nj=1\nq(a, Ij), (20)\nsince both sums are equal to n(s \u2212 1), the sum of the degrees of a taken\nover all the factors. As p(a, Vz1) > q(a, Vz1), there is at least one set of split\n24\nvertices Vz such that p(a, Vz) < q(a, Vz) and therefore Vz, at least, satisfies\n(I3). This completes the proof of Claim 8. \u0003\nFor 2 \u2264 j \u2264 m, we (a, b)-swap cj and dj in Fij . Each new factor Fi ob-\ntained is clearly ki-regular and, by Lemma 5, it is li-edge-connected. It is\nalso a detachment of the corresponding colour class Hi.\nFor 2 \u2264 j \u2264 m \u2212 1, p(a, Izj) and p(b, Izj) are unchanged. By (16) and\n(17) the reduction in p(a, Iz1) and the increase in p(b, Iz1) reduce \u03b4i by 2. By\n(H2) the changes in p(a, Izm) and p(b, Izm) at worst have no effect on \u03b4i. The\nfactors remain loopless.\nFinally we alter the factors so that (C4) is satisfied\nLet the vertex-discrepancy of the factors be defined by\n\u03b4v =\n\u2211\nac\u2208E(K(s)n )\n|p(a, c)\u2212 1|.\nIf (C4) is satisfied, then \u03b4v = 0. If \u03b4v > 0, then we show how to reduce it.\nWe need only consider independent sets of split vertices that each contain\nat least two vertices: let Iz be an independent set of split vertices that\ncontains just one vertex c. Let a be a vertex in a different part. As (C3)\nis satisfied, p(a, Iz) = q(a, Iz) = 1. As p(a, c) = p(a, Iz), we already have\np(a, c) = 1.\nClaim 9 Suppose that a and b are vertices in the same independent set of\nsplit vertices, that c1 \/\u2208 {a, b} and that\np(a, c1) > 1, (21)\np(b, c1) < 1. (22)\nLet S(a, b) be defined as before. Then there is a sequence of vertices c1, c2, . . . , cm\nsuch that\n(J1) cj \/\u2208 {a, b}, 2 \u2264 j \u2264 m,\n(J2) c\u03b1 6= c\u03b2 if \u03b1 6= \u03b2,\n(J3) either p(a, cm) < 1 or p(b, cm) > 1, and\n(J4) for 1 \u2264 j \u2264 m\u2212 1 there is a triple (ij, cj, cj+1) \u2208 S(a, b).\n25\nProof: The first term of the sequence is known by the hypothesis. If the\nsequence is not complete, then we can assume, for 1 \u2264 j \u2264 \u00b5,\np(a, cj) \u2265 1,\np(b, cj) \u2264 1.\nAs p(a, c\u00b5) \u2265 1 we can find a triple (i\u00b5, c\u00b5, c\u00b5+1) \u2208 S(a, b). As there are\nno loops and c\u00b5+1 is a neighbour of b, c\u00b5+1 6= b. By (J1), c\u00b5 6= b and a\nis the second element of a pair in Si\u00b5(a, b) only if b is the first element, so\nc\u00b5+1 6= a. By (22), p(b, c1) = 0, so c\u00b5+1 6= c1. As p(b, cj) \u2264 1, 2 \u2264 j \u2264 \u00b5,\nthere is at most one triple in S(a, b) with cj as the third element and we have\nalready found one such triple (namely (ij\u22121, cj\u22121, cj)). Therefore c\u00b5+1 6= cj,\n2 \u2264 j \u2264 \u00b5.\nThe sequence must terminate: there is a finite number of vertices and it\nis easily seen that p(a, c1) > 1 implies that for some vertex c, p(a, c) < 1.\nThis completes the proof of Claim 9. \u0003\nWe describe how to use the claim to reduce the vertex-discrepancy. First\nchoose an independent set of split vertices Iz such that\n(C3a) for every vertex c \/\u2208 Iz, p(c, Ij) = q(c, Ij), 1 \u2264 j \u2264 r.\nAs (C3) implies (C3a) we can initially choose any set of split vertices as Iz.\nIf possible choose a pair of vertices a \u2208 Iz, c1 \/\u2208 Iz that satisfy (21). By\n(C3a) there is a vertex b \u2208 Iz that satisfies (22). Therefore we use Claim 9:\nfor 1 \u2264 j \u2264 m \u2212 1, (a, b)-swap (cj, cj+1) in Fij . For 2 \u2264 j \u2264 m \u2212 1, p(a, cj)\nand p(b, cj) are unchanged. By (21), the deletion of ac1 reduces \u03b4v by 1, and,\nby (22), the addition of bc1 reduces \u03b4v further by 1. By (J3), the addition of\nacm and the deletion of bcm at worst has no net effect on \u03b4v. So overall \u03b4v is\nreduced by at least 2. As cj \/\u2208 {a, b}, 1 \u2264 j \u2264 m, no loops are created.\nConsider the effect of these (a, b)-swaps on \u03b4i. Let Izj be the set of split\nvertices that contains cj, 1 \u2264 j \u2264 m. For 2 \u2264 j \u2264 m\u2212 1, p(a, cj) and p(b, cj)\nwere unchanged so p(a, Izj) and p(b, Izj) are unchanged. Note that\np(a, Iz1) and p(b, Izm) are reduced by 1, and (23)\np(a, Izm) and p(b, Iz1) are increased by 1. (24)\nAs a, b \u2208 Iz, (C1a) remains satisfied (even though (C1) does not). So we can\nlook for further pairs a \u2208 Iz, c1 \/\u2208 Vz that satisfy (21) and repeat the process.\n26\nWhen no such pairs remain we have p(a, c) = 1 for every a \u2208 Iz, c \/\u2208 Iz.\nFor 1 \u2264 j \u2264 r, j 6= z, p(a, Ij) =\n\u2211\nc\u2208Ij\np(a, c) = |Ij|. Thus p(a, Ij) = q(a, Ij),\n1 \u2264 j \u2264 r, j 6= z. By (20), this implies that p(a, Iz) = q(a, Iz) also. Thus\n(C3b) for every vertex a \u2208 Iz, p(a, Ij) = q(a, Ij), 1 \u2264 j \u2264 r.\nNote that (C3a) and (C3b) together imply (C3).\nNow if possible choose a pair a \u2208 Iz, c \u2208 Iz that satisfies (21). By (C3b),\nthere is a vertex b \u2208 Iz that satisfies (22), so we can use the claim to reduce\n\u03b4v further. Note that Iz1 = Iz (since Iz1 is the set that contains c1). Note\nalso that that Izm = Iz since cm \u2208 Izm and Im satisfies (J3) and we know\nthat p(a, c) = 1 for all a \u2208 Iz, c \/\u2208 Vz. Thus (23) and (24) cancel each other\nout and (C3a) and (C3b) remain satisfied. Look for further pairs a, c1 \u2208 Iz\nthat satisfy (21) and reduce \u03b4v further. When no such pairs remain (C3) is\nsatisfied since (C3a) and (C3b) are satisfied, and we can begin the process\nagain with another choice of Iz. Eventually \u03b4v is reduced to zero and (C4) is\nsatisfied. This completes the proof of Theorem 4. \u0003\n2.6 Proof of Theorem 1\nThe following four sentences prove the necessity of the four conditions. The\ndegree of a vertex in K\n(s)\nn is equal to the sum of its degrees in the factors.\nBy the handshaking lemma, a regular graph on an odd number of vertices\nmust have even degree. The set of all edges incident with a vertex form an\nedge-cutset. A 1-factor of a simple graph (other than K2) is not connected.\nNow we have to show that there exists a (t,K, L)-factorization of K\n(s)\nn\nwhenever (A1) to (A4) are satisfied. By Theorem 4, unless li = 1 for some i it\nis sufficient to find an outline (t,K, L)-factorization of K\n(s)\nn that satisfies (Z1)\nand (Z2). It easy to find such outline factorizations H, f and fh, 1 \u2264 h \u2264 s.\nLet V (H) = {v}. Let there be n2\n(\ns\n2\n)\nloops on v (this is the number of edges\nin K\n(s)\nn ). Let nski\/2 of the loops be coloured i, 1 \u2264 i \u2264 t. Let f(v) = ns\nand let fh(v) = n, 1 \u2264 h \u2264 s. It is easy to see that H, f and fh, 1 \u2264 h \u2264 s,\nsatisfy (B1) to (B5).\nNow for the case where some li = 1. Replace every instance of 1 in L\nwith 2 to obtain L\u2032. Note that, by (A4), if li = 1, then ki \u2265 2 so t, K and L\u2032\nsatisfy (A1) to (A4). A (t,K, L\u2032)-factorization is also a (t,K, L)-factorization\nsince li prescribes only the minimum edge-connectivity. \u0003\n27\n3 Embedding factorizations\nThe most general embedding result that we might aim to find would show\nwhen it is possible to find an embedding of a factorization of G = Ka1,...,as\nin a (t,K, L)-factorization of K\n(s)\nn , where ai \u2264 n, 1 \u2264 i \u2264 s. To prove\nthis using amalgamations however, we would have to add one vertex v0 to\nG to create an outline (t,K, L)-factorization of K\n(s)\nn . Thus we would have\nfh(v0) = n \u2212 ah, 1 \u2264 h \u2264 s. But if we are to use Theorem 4 we require, by\n(Z1) and (Z2), that fh(v0) \u2208 {0, n}, 1 \u2264 h \u2264 s. In Theorem 11, we find a\nway around this difficulty in the bipartite case and show when a factorization\nof Ka,b can be embedded in a (t,K, L)-factorization of Kn,n, a, b \u2264 n. In the\ngeneral case however, we confine ourselves to the following: in Theorem 10\nwe show precisely when a factorization G1, . . . , Gt of K\n(\u03c3)\nn can be embedded\nin a (t,K, L)-factorization F1, . . . , Ft of K\n(s)\nn (except that we again have the\nrestriction li 6= 1, 1 \u2264 i \u2264 t). This has only been proved previously for the\ncase of Hamiltonian decompositions [4].\n3.1 Embedding equipartite graphs\nWe need some definitions before we can state the theorem. Let \u03c9i be the num-\nber of connected components ofGi and let these components be Ci,1, . . . , Ci,\u03c9i .\nLet \u03b5i,j =\n\u2211\nv\u2208V (Ci,j)\nki \u2212 dGi(v), and let \u03b5i =\n\u03c9i\u2211\nj=1\n\u03b5i,j. Let ri,j be the number of\nminimal separating sets of Ci,j that contain fewer than li edges, let these sets\nbe Ei,j1 , E\ni,j\n2 , . . . , E\ni,j\nri,j\n, and let Ci,jm1 and C\ni,j\nm2\nbe the connected components of\nCi,j \u2212 Ei,jm . Let \u03b5i,j,mp =\n\u2211\nv\u2208V (Ci,jmp )\nki \u2212 dGi(v).\nTheorem 10 Suppose that n, s, t,K and L are such that a (t,K, L)-factorization\nof K\n(s)\nn exists and that li 6= 1, 1 \u2264 i \u2264 t. Let \u03b1 = n(s\u2212\u03c3). A t-edge-coloured\nK\n(\u03c3)\nn can be embedded in a (t,K, L)-factorization of K\n(s)\nn if and only if\n(I) dGi(v) \u2264 ki for each v \u2208 V (K(\u03c3)n ), for 1 \u2264 i \u2264 t,\n(II) \u03b5i,j \u2265 li for 1 \u2264 i \u2264 t, 1 \u2264 j \u2264 \u03c9i,\n(III) \u03b1 \u2265 max{\u03b5i\/ki : 1 \u2264 i \u2264 t}, and\n28\n(IV) \u03b5i,j,mp \u2265 li \u2212 |Ei,jm |, for 1 \u2264 i \u2264 t, 1 \u2264 j \u2264 \u03c9i, 1 \u2264 m \u2264 ri,j, 1 \u2264 p \u2264 2.\nProof: By Theorem 1, we may assume that conditions (A1) to (A4) are\nsatisfied.\nNecessity: suppose that a t-edge-colouredK\n(\u03c3)\nn is embedded in an (t,K, L)-\nfactorization of K\n(s)\nn . We show that the conditions of the theorem hold.\nAs Gi is a subgraph of a ki-regular graph, dGi(v) \u2264 ki for each v \u2208\nV (K\n(\u03c3)\nn ), for 1 \u2264 i \u2264 t. So (I) holds.\nBy definition \u03b5i,j is the number of edges incident with the vertices of Ci,j\nin E(Fi) \\E(Gi). All these edges join Ci,j to V (K(s)n ) \\ V (K(\u03c3)n ) and form an\nedge-cutset so there must be at least li of them. So (II) holds.\nSimilarly, \u03b5i is the number of edges incident with the vertices of Gi in\nE(Fi)\\E(Gi), and all these edges join Gi to one of the \u03b1 vertices of V (K(s)n )\\\nV (K\n(\u03c3)\nn ) which each have degree ki. Thus \u03b5i \u2264 ki\u03b1. So (III) holds.\nFor 1 \u2264 i \u2264 t, 1 \u2264 j \u2264 \u03c9i, 1 \u2264 m \u2264 ri,j, there must be li edge-disjoint\npaths from Ci,jm1 to C\ni,j\nm2\n. We know that |Ei,jm | of these paths are in Ci,j. The\nremainder must go through V (K\n(s)\nn ) \\ V (K(\u03c3)n ). Therefore there must be at\nleast li \u2212 |Ei,jm | edges from each of Ci,jm1 and Ci,jm2 to V (K(s)n ) \\ V (K(\u03c3)n ). So\n(IV) holds as \u03b5i,j,mp is the number of edges incident with the vertices of C\ni,j\nmp\nin E(Fi) \\ E(Gi).\nSufficiency: to complete the proof we must show that if the four conditions\nhold then we can find an embedding. From K\n(\u03c3)\nn we form H, f and fh, 1 \u2264\nh \u2264 s, an outline (t,K, L)-factorization of K(s)n . Let V (H) = V (K(\u03c3)n )\u222a{v0}.\nLet f(v0) = \u03b1, let f(v) = 1 for each v \u2208 V (K(\u03c3)n ). Let fh(v0) = 0, 1 \u2264 h \u2264 \u03c3,\nand let fh(v0) = n, \u03c3 + 1 \u2264 h \u2264 s. If v \u2208 K(\u03c3)n , then let fh(v) = 1 if v \u2208 Ph,\nelse let fh(v) = 0. The edge set of H contains the edges of K\n(\u03c3)\nn (which are\nalready coloured) and\n\u2022 for 1 \u2264 i \u2264 t, for each v \u2208 K(\u03c3)n , there are ki \u2212 dGi(v) edges coloured i\nfrom v0 to v, and\n\u2022 for 1 \u2264 i \u2264 t, there are (\u03b1ki \u2212 \u03b5i)\/2 loops coloured i on v0.\nIf we can prove that H, f and fh, 1 \u2264 h \u2264 s, are an outline (t,K, L)-\nfactorization of K\n(s)\nn , then we can apply Theorem 4. Any (t,K, L)-fac-\ntorization F1, . . . , Ft of K\n(s)\nn of which H, f and fh, 1 \u2264 h \u2264 s, is an amalga-\nmation is such that Gi is a subgraph of Fi.\n29\nWe check that the number of loops added of each colour is an integer. As\n\u03b1 = n(s\u2212 \u03c3),\n\u03b1ki \u2212 \u03b5i\n2\n=\nn(s\u2212 \u03c3)ki \u2212 \u03b5i\n2\n=\nkins\n2\n\u2212 \u03b5i \u2212 kin\u03c3 \u2212 \u03b5i\n2\nwhich is an integer since, by (A2), kins is even and (kin\u03c3 \u2212 \u03b5i)\/2 = |E(Gi)|.\nWe must show that H, f and fh, 1 \u2264 h \u2264 s, satisfy (B1) to (B5).\nFor v, w \u2208 V (K(\u03c3)n ), there is one edge joining v to w unless they are in\nthe same part. For v \u2208 V (K(\u03c3)n ), the number of edges from v to v0 is\nt\u2211\ni=1\n(ki \u2212 dGi(v)) =\nt\u2211\ni=1\nki \u2212\nt\u2211\ni=1\ndGi(v)\n= n(s\u2212 1)\u2212 n(\u03c3 \u2212 1)\n= \u03b1\n=\n\u2211\nh1,h2\u2208{1,...,s}\nh1 6=h2\nfh1(v)fh2(v0).\nSo (B1) is satisfied.\n30\nFor v \u2208 V (K(\u03c3)n ) there are no loops on v. The number of loops on v0 is\nt\u2211\ni=1\n\u03b1ki \u2212 \u03b5i\n2\n=\nt\u2211\ni=1\n\u03b1ki\n2\n\u2212\nt\u2211\ni=1\n\u2211\nv\u2208V (K(\u03c3)n )\nki \u2212 dGi(v)\n2\n=\n\u03b1n(s\u2212 1)\n2\n\u2212\n\u2211\nv\u2208V (K(\u03c3)n )\nt\u2211\ni=1\nki \u2212 dGi(v)\n2\n=\n\u03b1n(s\u2212 1)\n2\n\u2212\n\u2211\nv\u2208V (K(\u03c3)n )\nn(s\u2212 1)\u2212 n(\u03c3 \u2212 1)\n2\n=\n\u03b1n(s\u2212 1)\n2\n\u2212\n\u2211\nv\u2208V (K(\u03c3)n )\n\u03b1\n2\n=\n\u03b1n(s\u2212 1)\n2\n\u2212 \u03b1n\u03c3\n2\n=\n\u03b1n(s\u2212 1\u2212 \u03c3)\n2\n=\nn2(s\u2212 \u03c3)(s\u2212 \u03c3 \u2212 1)\n2\n= n2\n(\ns\u2212 \u03c3\n2\n)\n=\n\u2211\n1\u2264h1<h2\u2264s\nfh1(v0)fh2(v0)\nSo (B2) is satisfied.\nFor v \u2208 V (K(\u03c3)n ) there are dGi(v) + (ki \u2212 dGi(v)) = ki = kif(v) edges of\neach colour incident with v. The number of edges of each colour incident\nwith v0 is \u2211\nv\u2208V (K(\u03c3)n )\n(ki \u2212 dGi(v)) + \u03b1ki \u2212 \u03b5i = \u03b5i + \u03b1ki \u2212 \u03b5i\n= \u03b1ki\n= kif(v0).\nSo (B3) is satisfied.\nIt is easy to see that (B4) is satisfied.\n31\nTo show that (B5) is satisfied we must show that each Hi has an li-edge-\nconnected ki-regular detachment. Thus we show that each Hi satisfies the\nconditions of Proposition 2.\nFirst we show that each Hi is li-edge-connected. Suppose that Hi is not\nli-edge-connected. Then there is a minimal edge-cutset E such that |E| < li.\nAs E is minimal it will contain only edges from one component of Gi, say\nCi,1, and perhaps also edges from v0 to Ci,1. It cannot contain only edges\nfrom v0 to Ci,1 since there are\n\u2211\nv\u2208V (Ci,j)\n(ki \u2212 dGi(v)) = \u03b5i,j such edges and, by\n(II), \u03b5i,j \u2265 li. The edges of E contained in Ci,1 form one of its minimal\nseparating sets, say Ei,11 , and we can assume that the two components of\nHi \u2212 E are Ci,111 and Hi \u2212 Ci,111 . Therefore E must also contain all the edges\nfrom Ci,111 to v0. There are\n\u2211\nv\u2208V (C11i,1)\n(ki \u2212 dG1(v)) = \u03b5i,1,11 such edges. So\n|E| = |Ei,11 |+ \u03b5i,1,11\n\u2265 li,\nby (IV), a contradiction. So each Hi satisfies (X1).\nAs li 6= 1, 1 \u2264 i \u2264 t we need not consider (X2). Since n 6= 3 by\nassumption, \u03b1 6= 2 and we need not consider (X3).\nFinally, (X4) is satisfied since each Hi contains more than two vertices.\n\u0003\n3.2 Embedding bipartite graphs\nWe consider an embedding of an edge-coloured Ka,b with colour classes\nG1, . . . , Gt in a (t,K, L)-factorization F1, . . . , Ft of Kn,n. As well as the defi-\nnitions used in Theorem 10 we need the following. For each component Ci,j\nof Hi let \u03b3i,j be\nmin\nm,x,y\nx 6=y\n\uf8f1\uf8f2\uf8f3|Ei,jm |+ \u2211\nv\u2208V (Ci,jm1 )\u2229Px\n(ki \u2212 dGi(v)) +\n\u2211\nv\u2208V (Ci,jm2 )\u2229Py\n(ki \u2212 dGi(v)),\n\u2211\nv\u2208V (Ci,j)\u2229Px\n(ki \u2212 dGi(v))\n\uf8fc\uf8fd\uf8fe\nNote that the two parts of Kn,n are P1 and P2 where the set of a independent\nvertices of Ka,b are embedded in P1 and the set of b independent vertices are\nembedded in P2.\n32\nTheorem 11 Suppose that n, s = 2, t,K and L are such that a (t,K, L)-\nfactorization of Kn,n exists, and that li 6= 1, 1 \u2264 i \u2264 t. Let a and b be\nintegers, 1 \u2264 a, b \u2264 n. A t-edge-coloured Ka,b can be embedded in a (t,K, L)-\nfactorization of Kn,n if and only if\n(I) dGi(v) \u2264 ki for each v \u2208 V (Ka,b), for 1 \u2264 i \u2264 t,\n(II) \u03b5i,j \u2265 li for 1 \u2264 i \u2264 t, 1 \u2264 j \u2264 \u03c9i,\n(III) 2n\u2212 (a+ b) \u2265 max{\u03b5i\/ki : 1 \u2264 i \u2264 t},\n(IV) if a = n \u2212 2 and ki = li is odd, then, for 1 \u2264 j \u2264 \u03c9i, if there exists\nv \u2208 P2\u2229Ci,j such that dGi(v) < ki, then either there exists w \u2208 P1\u2229Ci,j\nsuch that dGi(w) < ki or for all u \u2208 P2 \\ Ci,j, dGi(u) = ki.\n(V) if b = n \u2212 2 and ki = li is odd, then, for 1 \u2264 j \u2264 \u03c9i, if there exists\nv \u2208 P1\u2229Ci,j such that dGi(v) < ki, then either there exists w \u2208 P2\u2229Ci,j\nsuch that dGi(w) < ki or for all u \u2208 P1 \\ Ci,j, dGi(u) = ki.\n(VI)\n\u2211\u03c9i\nj=1 \u03b3i,j + [(2n\u2212 (a+ b))ki \u2212 \u03b5i]\/2 \u2265 li, 1 \u2264 i \u2264 t, and\n(VII) \u03b5i,j,mp \u2265 li \u2212 |Ei,jm |, for 1 \u2264 i \u2264 t, 1 \u2264 j \u2264 \u03c9i, 1 \u2264 m \u2264 ri,j, 1 \u2264 p \u2264 2.\nProof: By Theorem 1, we may assume that conditions (A1) to (A4) are\nsatisfied.\nNecessity: suppose that a t-edge-colouredK\n(\u03c3)\nn is embedded in an (t,K, L)-\nfactorization of K\n(s)\nn . We show that the conditions (III), (IV), (V) and (VI)\nof the theorem hold. The others are identical to conditions of Theorem 10\nand the reasons for their are necessity are the same.\nNote that \u03b5i is the number of edges incident with the vertices of Gi in\nE(Fi) \\E(Gi). These edges are all incident with the 2n\u2212 (a+ b) vertices of\nV (Kn,n) \\ V (Ka,b) which each have degree ki. Thus \u03b5i \u2264 (2n\u2212 (a+ b))ki. So\n(III) holds.\nSuppose that a = n \u2212 2, ki = li is odd and there exists v \u2208 P2 \u2229 Ci,j\n(for some j) such that dGi(v) < ki. Thus v is joined to at least one of the\ntwo vertices of P1 \\ V (Ka,b). If there is a vertex u \u2208 P2 \u2229 (Ka,b \\ Ci,j) such\nthat dGi(u) 6= ki and there is no vertex w \u2208 P1 \u2229 Ci,j such that dGi(w) < ki,\nthen the two vertices of P1 \\ Ka,b form a cutset. Let J1 and J2 be the two\ncomponents obtained when the cutset is removed. There must be ki paths\nfrom J1 to J2 through the cutset so each of the two vertices must be joined\n33\nto each of J1 and J2 by ki\/2 edges. This is a contradiction since ki is odd.\nSo (IV) holds. A similar argument shows that (V) holds.\nFrom the argument that shows that (III) holds we can see that in Fi\nthere are [(2n\u2212 (a+ b))ki\u2212 \u03b5i]\/2 edges joining vertices of P1 \\V (Ka,b) =W1\nto vertices of P2 \\ V (Ka,b) = W2. We will form an edge-cutset of Fi that\nseparates W1 from W2. First we take all the edges joining vertices of W1 to\nvertices of W2. Next we ensure there is no path from W1 to W2 through Ci,j,\n1 \u2264 j \u2264 \u03c9i. We do this by, for each j, taking either all the edges from Ci,j\nto W1 (or W2) or taking an edge-cutset E\ni,j\nm from Ci,j and also all edges from\nCi,jm1 to W1 and from C\ni,j\nm2\nto W2 (or vice versa). Thus the minimum number\nof edges incident with Ci,j we must take is \u03b3i,j, and so the edge-cutset formed\nhas at least\n\u2211\nj \u03b3i,j + [(2n\u2212 (a+ b))ki \u2212 \u03b5i]\/2 edges. So (VI) holds.\nSufficiency: to complete the proof we must show that if the conditions\nhold then we can find an embedding. FromKa,b we formH, f and fh, 1 \u2264 h \u2264\n2, an outline (t,K, L)-factorization of Kn,n. Let V (H) = V (Ka,b) \u222a {v1, v2}.\nLet f(v1) = f1(v1) = n \u2212 a; let f(v2) = f2(v2) = n \u2212 b. For each v \u2208 Ka,b,\nlet fh(v) = 1, if v \u2208 Ph, else let fh(v) = 0. Henceforth when we refer to P1\nand P2 we will mean vertices in Ka,b; we do not consider the vertices v1 and\nv2 to be in these parts. The edge set of H contains the edges of Ka,b (which\nare already coloured) and\n\u2022 for each v \u2208 P1, there are ki \u2212 dGi(v) edges coloured i from v to v2,\n\u2022 for each v \u2208 P2, there are ki\u2212dGi(v) edges coloured i from v to v1, and\n\u2022 for 1 \u2264 i \u2264 t, there are [(2n\u2212 (a + b))ki \u2212 \u03b5i]\/2 edges coloured i from\nv1 to v2\nBy (III), the number of edges of each colour from v1 to v2 is not negative.\nIf we can prove that H, f and fh, 1 \u2264 h \u2264 2, are an outline (t,K, L)-\nfactorization of Kn,n, then we can apply Theorem 4. Any (t,K, L)-fac-\ntorization F1, F2, . . . , Ft of Kn,n of which H, f and fh, 1 \u2264 h \u2264 s, is an\namalgamation is such that Gi is a subgraph of Fi.\nWe note that it is a simple matter to form H from the edge-coloured Ka,b.\nWe add edges so that the vertices of V (Ka,b) are incident with the correct\nnumber of edges of each colour and then add edges between v1 and v2 so that\nthe total number of edges of each colour is correct. Most importantly, we do\nnot have to make any choices about how to colour edges.\nAs an aside, we note this would not be the case if we tried to use the\nsame technique to embed Ka1,...,as in K\n(s)\nn , s > 2. Suppose we add s vertices\n34\nv1, . . . , vs to form an outline graph where vi is the vertex that will be split to\ncomplete Pi. Now suppose that a vertex v \u2208 P1 in Ka1,...,as is incident with\nless than k1 edges of colour 1. Then in the outline graph, we have to have\nan edge coloured 1 from v to vi, i 6= 1. So we have a choice of vi (whereas\nin the bipartite case we have to choose v2). So rather than proving that a\nparticular outline graph satisfies (B1) to (B5), we have to show that at least\none graph (of all the possible ones we could choose to create) satisfies the\nconditions.\nBack to the proof: we must show that H, f and fh, 1 \u2264 h \u2264 s, satisfy\n(B1) to (B5).\nFor v, w \u2208 V (Ka,b), there is one edge joining v to w unless they are in the\nsame part. There are no edges from vertices in P1 to v1 and from vertices in\nP2 to v2. For v \u2208 P1, the number of edges from v to v2 is\nt\u2211\ni=1\n(ki \u2212 dGi(v)) =\nt\u2211\ni=1\nki \u2212\nt\u2211\ni=1\ndGi(v)\n= n\u2212 b\n=\n\u2211\nh1,h2\u2208{1,2}\nh1 6=h2\nfh1(v)fh2(v2).\nA similar argument shows that each v \u2208 P2 is joined to v1 by the correct\nnumber of edges. The number of edges from v1 to v2 is\nt\u2211\ni=1\n(2n\u2212 (a+ b))ki \u2212 \u03b5i\n2\n=\n2n\u2212 (a+ b)\n2\nt\u2211\ni=1\nki \u2212\nt\u2211\ni=1\n\u2211\nv\u2208V (Ka,b)\nki \u2212 dGi(v)\n2\n= n2 \u2212 (a+ b)n\n2\n\u2212\n\u2211\nv\u2208V (Ka,b)\nt\u2211\ni=1\nki \u2212 dGi(v)\n2\n= n2 \u2212 (a+ b)n\n2\n\u2212\n\u2211\nv\u2208P1\nn\u2212 b\n2\n\u2212\n\u2211\nv\u2208P2\nn\u2212 a\n2\n= n2 \u2212 (a+ b)n\n2\n\u2212 a(n\u2212 b)\n2\n\u2212 b(n\u2212 a)\n2\n= (n\u2212 b)(n\u2212 a)\n=\n\u2211\nh1,h2\u2208{1,2}\nh1 6=h2\nfh1(v1)fh2(v2).\n35\nSo (B1) is satisfied.\nThere are no loops in H so (B2) is satisfied.\nFor v \u2208 V (Ka,b), there are dGi(v) + (ki \u2212 dGi(v)) = ki = kif(v) edges of\neach colour incident with v. We must show that v1 and v2 are incident with\nthe correct number of edges of each colour. First note that\n\u03b5i =\n\u2211\nv\u2208V (Ka,b)\nki \u2212 dGi(v)\n= (a+ b)ki \u2212\n\u2211\nv\u2208P1\ndGi(v)\u2212\n\u2211\nv\u2208P2\ndGi(v).\nClearly the two sums are equal so\u2211\nv\u2208P2\ndGi(v) =\n(a+ b)ki \u2212 \u03b5i\n2\n.\nThe number of edges coloured i incident with v1 is\n\u2211\nv\u2208P2\n(ki \u2212 dGi(v)) +\n(2n\u2212 (a+ b))ki \u2212 \u03b5i)\n2\n= bki \u2212\n\u2211\nv\u2208P2\ndGi(v) +\n(2n\u2212 (a+ b))ki \u2212 \u03b5i)\n2\n= bki \u2212 (a+ b)ki\n2\n+\n\u03b5i\n2\n+\n(2n\u2212 (a+ b))ki \u2212 \u03b5i)\n2\n= (n\u2212 a)ki\n= kif(v1)\nA similar argument shows that v2 is incident with kif(v2) edges of colour i.\nSo (B3) is satisfied.\nIt is easy to see that (B4) is satisfied.\nFinally to show that (B5) is satisfied we must show that each Hi has an\nli-edge-connected ki-regular detachment. Thus we show that each Hi satisfies\nthe conditions of Proposition 2.\nFirst we show that each Hi is li-edge-connected. Suppose that Hi is\nnot li-edge-connected. Then there is a minimal edge-cutset E such that\n|E| < li. We consider two cases. First assume that v1 and v2 are in the\nsame component of Hi\u2212E. As E is minimal it will contain only edges from\n36\none component of Gi, say Ci,1, and perhaps also edges from v1 and v2 to\nCi,1. It cannot contain only edges from v1 and v2 to Ci,1 since there are\u2211\nv\u2208V (Ci,j)\n(ki \u2212 dGi(v)) = \u03b5i,j such edges and by (II), \u03b5i,j \u2265 li. The edges of\nE contained in Ci,1 form one of its minimal separating sets, say E\ni,1\n1 , and\nwe can assume that the two components of Hi \u2212 E are Ci,111 and Hi \u2212 Ci,111 .\nTherefore E must also contain all the edges from Ci,111 to v1 and v2. There\nare\n\u2211\nv\u2208V (C11i,1)\n(ki \u2212 dG1(v)) = \u03b5i,1,11 such edges. So\n|E| = |Ei,11 |+ \u03b5i,1,11\n\u2265 li,\nby (VII), a contradiction.\nNow assume that v1 and v2 are in different components of Hi \u2212E. Thus\nE must contain the [(2n \u2212 (a + b))ki \u2212 \u03b5i]\/2 edges from v1 to v2. For each\ncomponent Ci,j, E contains either all the edges from Ci,j to one of v1 or v2,\nor an edge-cutset of Ci,j, say E\ni,j\n1 , and all the edges from C\ni,j\n1,1 to v1 and from\nCi,j1,2 to v2 (or vice versa). It follows from (VI) that |E| \u2265 li. So each Hi\nsatisfies (X1).\nAs li 6= 1, 1 \u2264 i \u2264 t we need not consider (X2),\nHi has a vertex of degree 2li only if a = n \u2212 2 or b = n \u2212 2. We can\nsee that, by (IV) and (V), these vertices will not be cutvertices so (X3) is\nsatisfied.\nFinally, (X4) is satisfied since each Hi contains more than two vertices.\n\u0003\nReferences\n[1] A. J. W. Hilton, Hamiltonian decompositions of complete graphs, J.\nCombin. Theory B, 36 (1984), 125-134.\n[2] A. J. W. Hilton and M. Johnson, An algorithm for finding factorizations\nof complete graphs, J. Graph Theory, 43 (2003), 132-136.\n[3] A. J. W. Hilton, M. Johnson, C. A. Rodger and E. B. Wantland, Amalga-\nmations of connected k-factorizations, J. Combin. Theory B, 88 (2003),\n267-279.\n37\n[4] A. J. W. Hilton and C. A. Rodger, Hamiltonian decompositions of com-\nplete regular s-partite graphs, Discrete Math., 48 (1986), 63-78.\n[5] M. Johnson, Amalgamations of factorizations of complete graphs, sub-\nmitted.\n[6] W. R. Johnstone, Decompositions of complete graphs, Bull. London\nMath. Soc., 32 (2000), 141-145.\n[7] R. Laskar and B. Auerbach, On decomposition of r-partite graphs into\nedge-disjoint Hamilton circuits, Discrete Math. 14 (1976), 265\u2013268.\n[8] C. St. J. A. Nash-Williams, Amalgamations of almost regular edge-\ncolourings of simple graphs J. Combin. Theory B, 43 (1987), 322-342.\n[9] C. St. J. A. Nash-Williams, Connected detachments of graphs and gen-\neralized Euler trails, J. London Math. Soc., 31 (1985), 17-29.\n[10] C. A. Rodger and E. B. Wantland, Embedding edge-colorings into 2-\nedge-connected k-factorizations of Kkn+1, J. Graph Theory, 10 (1995),\n169-185.\n38\nMatthew Johnson\nDepartment of Mathematics\nLondon School of Economics\nHoughton Street\nLondon\nWC2A 2AE\nU.K.\nemail: matthew@maths.lse.ac.uk\n39\n"}