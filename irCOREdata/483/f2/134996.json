{"doi":"10.1016\/j.jnnfm.2004.11.005","coreId":"134996","oai":"oai:bradscholars.brad.ac.uk:10454\/522","identifiers":["oai:bradscholars.brad.ac.uk:10454\/522","10.1016\/j.jnnfm.2004.11.005"],"title":"A study of the quadratic molecular stress function constitutive model in simulation","authors":["Olley, Peter"],"enrichments":{"references":[],"documentType":{"type":0.8888888889}},"contributors":[],"datePublished":"2004","abstract":"Constitutive models that conform to separable KBKZ specification have been shown to fit steady-state strain hardening rheological data in planar and uniaxial elongational flows, but with inaccuracy in the rate of strain hardening. The single parameter Molecular Stress Function model of Wagner [Rheol. Acta, 39 (2000), 97-109] has been shown to accurately fit the rise-rate in experimental data for a number of strain hardening and strain softening materials. We study this models accuracy against the well characterised IUPAC LDPE data, and present a method for full implementation of this model for flow solution which is suitable for incorporating into existing separable KBKZ software. A new method for particle tracking in arbitrarily aligned meshes, which is efficient and robust, is given.\\ud\nThe Quadratic Molecular Stress Function (QMSF) model is compared to existing separable KBKZ based models, including one which is capable of giving planar strain hardening; the QMSF is shown to fit experimental rheological and contraction flow data more convincingly. The issue of `negative correction pressures\u00bf notable in some Doi-Edwards based models is addressed. The cause is identified, and leads to a logical method of calculation which does not give these anomalous results","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/134996.pdf","fullTextIdentifier":"https:\/\/bradscholars.brad.ac.uk\/bitstream\/10454\/522\/3\/QMSF2005.pdf","pdfHashValue":"7c99a9d1e3f389ce3323085caf3fd6c346895b60","publisher":null,"rawRecordXml":"<record><header><identifier>\n        \n            \n                oai:bradscholars.brad.ac.uk:10454\/522<\/identifier><datestamp>\n                2014-05-20T09:31:04Z<\/datestamp><setSpec>\n                com_10454_413<\/setSpec><setSpec>\n                col_10454_6345<\/setSpec>\n            <\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:doc=\"http:\/\/www.lyncode.com\/xoai\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n            \nA study of the quadratic molecular stress function constitutive model in simulation<\/dc:title><dc:creator>\nOlley, Peter<\/dc:creator><dc:subject>\nMolecular Stress Function<\/dc:subject><dc:subject>\nMSF<\/dc:subject><dc:subject>\nStress<\/dc:subject><dc:subject>\nStrain Hardening<\/dc:subject><dc:subject>\nKBKZ<\/dc:subject><dc:subject>\nNegative Correction Pressure<\/dc:subject><dc:description>\nConstitutive models that conform to separable KBKZ specification have been shown to fit steady-state strain hardening rheological data in planar and uniaxial elongational flows, but with inaccuracy in the rate of strain hardening. The single parameter Molecular Stress Function model of Wagner [Rheol. Acta, 39 (2000), 97-109] has been shown to accurately fit the rise-rate in experimental data for a number of strain hardening and strain softening materials. We study this models accuracy against the well characterised IUPAC LDPE data, and present a method for full implementation of this model for flow solution which is suitable for incorporating into existing separable KBKZ software. A new method for particle tracking in arbitrarily aligned meshes, which is efficient and robust, is given.\\ud\nThe Quadratic Molecular Stress Function (QMSF) model is compared to existing separable KBKZ based models, including one which is capable of giving planar strain hardening; the QMSF is shown to fit experimental rheological and contraction flow data more convincingly. The issue of `negative correction pressures\u00bf notable in some Doi-Edwards based models is addressed. The cause is identified, and leads to a logical method of calculation which does not give these anomalous results.<\/dc:description><dc:date>\n2008-09-01T14:10:27Z<\/dc:date><dc:date>\n2008-09-01T14:10:27Z<\/dc:date><dc:date>\n2004<\/dc:date><dc:type>\nArticle<\/dc:type><dc:identifier>\nOlley, P.(2004). A study of the quadratic molecular stress function constitutive model in simulation. Journal of Non-Newtonian Fluid Mechanics. Vol.125 Nos. 2-3, 171-183.<\/dc:identifier><dc:identifier>\nhttp:\/\/hdl.handle.net\/10454\/522<\/dc:identifier><dc:language>\nen<\/dc:language><dc:relation>\nhttp:\/\/dx.doi.org\/10.1016\/j.jnnfm.2004.11.005<\/dc:relation><dc:rights>\n\u00a9 2004 Elsevier. Reproduced in accordance with the publisher's self-archiving policy.<\/dc:rights>\n<\/oai_dc:dc>\n<\/metadata>\n        <\/record>","journals":null,"language":null,"relations":["http:\/\/dx.doi.org\/10.1016\/j.jnnfm.2004.11.005"],"year":2004,"topics":["Molecular Stress Function","MSF","Stress","Strain Hardening","KBKZ","Negative Correction Pressure"],"subject":["Article"],"fullText":" The University of Bradford Institutional \nRepository \n \nThis work is made available online in accordance with publisher policies. Please \nrefer to the repository record for this item and our Policy Document available from \nthe repository home page (http:\/\/bradscholars.brad.ac.uk\/dspace) for further \ninformation. \nTo see the final version of this work please visit the publisher\u2019s website. Where \navailable access to the published online version may require a subscription. \n \nAuthor(s): Olley, Pete \nTitle: A study of the quadratic stress function constitutive model in simulation \nPublication year: 2004 \nJournal title: Journal of Non-Newtonian Fluid Mechanics \nISSN number: 0377- 0257 \nPublisher: Elsevier \nPublisher\u2019s site:  http:\/\/www.sciencedirect.com  \nLink to original published version: http:\/\/dx.doi.org\/10.1016\/j.jnnfm.2004.11.005 \nCopyright statement: \u00a9 2004 Elsevier. Reproduced in accordance with the \npublisher\u2019s self-archiving policy. \n \nA study of the Quadratic Molecular Stress Function constitutive model in \nsimulation \n \nP. Olley \nSchool of Engineering, Design and Technology\/ IRC in Polymer Engineering \nUniversity of Bradford \nUK \n \nabstract \nConstitutive models that conform to separable KBKZ specification have been shown \nto fit steady-state strain hardening rheological data in planar and uniaxial elongational \nflows, but with inaccuracy in the rate of strain hardening. The single parameter \nMolecular Stress Function model of Wagner [Rheol. Acta, 39 (2000), 97-109] has \nbeen shown to accurately fit the rise-rate in experimental data for a number of strain \nhardening and strain softening materials. We study this models accuracy against the \nwell characterised IUPAC LDPE data, and present a method for full implementation \nof this model for flow solution which is suitable for incorporating into existing \nseparable KBKZ software. A new method for particle tracking in arbitrarily aligned \nmeshes, which is efficient and robust, is given. \nThe Quadratic Molecular Stress Function (QMSF) model is compared to existing \nseparable KBKZ based models, including one which is capable of giving planar strain \nhardening; the QMSF is shown to fit experimental rheological and contraction flow \ndata more convincingly. The issue of \u2018negative correction pressures\u2019 notable in some \nDoi-Edwards based models is addressed. The cause is identified, and leads to a logical \nmethod of calculation which does not give these anomalous results. \n \nKeywords: Molecular Stress Function, MSF, simulation, strain hardening, KBKZ, \nnegative correction pressure \n \n1. Introduction \n \nForms of the separable KBKZ model [1] have had success (though generally within \nsome limit) in modelling a large number of experimental rheological data. \nPapanastasiou\u2019s damping function [2] has been very successful in fitting data for \nsteady-state uniaxial elongational viscosity, shear viscosity, and First Normal Stress \nDifference for both strain hardening and strain softening materials. This has led to \nconsiderable success in simulating axisymmetric flows of strain hardening polymer \nmelt [3-9]. The model has also been successful in simulating planar flows of strain-\nsoftening melt [6,10-12], but has not been so successful in modelling strain-hardening \nplanar flows as it does not give  simultaneous planar strain-hardening and shear \nsoftening behaviour [9]. An adaptation of the KBKZ [13] permitted steady state \nvalues for planar elongation viscosity, uniaxial elongational viscosity, and shear \nviscosity to be fitted simultaneously; the rate of strain hardening was, however, below \nthat seen in  experimental results [13]. The model has been applied to several flows, \nincluding planar flows of strain hardening polymer melt, with improved success due \nto capturing significant features of strain hardening behaviour [13-15]. \n \nSignificant improvement, particularly in capturing the rate of strain hardening, is \nsuggested by use of the Molecular Stress Function (MSF) model [16-20]. The MSF \n 1\nmodel is based upon considerations of the geometry and stored energy of the polymer \nsegments undergoing deformation; a particular version, the Quadratic Molecular \nStress Function (QMSF) model [19] has been shown to fit transient planar elongation, \nuniaxial elongation, biaxial elongation and First and Second Normal Stress Difference \nmeasurements for strain hardening flows. The accuracy of fit is remarkable \nparticularly as only a single adjustable parameter is used in the model. Convective \nConstraint Release (CCR) [21] is incorporated into the model described in reference \n[20], in a manner that effectively separates elongational and rotational damping \nfunctions. The versions preceding the CCR model can be recognized as following the \n\u2018separabilty\u2019 assumption [20]. \n \nThere have been many recent developments in simulation of time-integral viscoelastic \nflows. Two dimensional time dependent flows have been solved by convecting \ndeformation fields, to achieve a purely Eulerian method [22] ; three dimensional time \ndependant flows have be modelled using a Lagrangian mesh approach with \nremeshing, and information transfer, when the mesh becomes distorted [23]. A \nmodified version of the QMSF with CCR has been implemented and applied to \nmembrane inflation [24]. Direct comparison has been made between a time integral \nmodel, its differential approximation and an inelastic model in a complex flow [25]. \n \nThere have been other recent developments in rheological modelling, with a strong \nemphasis on molecularly based models. Notable amongst these developments are the \nPom Pom model [26, 27], and developments in differential models [28,29]. Molecular \nconsiderations have led to some models that employ fractional powers of the Finger \nStrain Tensor [30,31]. \n  \nThe single parameter QMSF model without constraint release, described in reference \n[19] has been shown to have many strong points. The model also has an elegant \nphysical derivation in its favour, and provides a natural bridge between earlier KBKZ \nmodels, and the MSF with CCR model, described in ref. [20]. It is this single \nparameter QMSF model that this work focuses on. \n \n2. The Molecular Stress Function Model \n The Molecular Stress Function (MSF) model is based on the extra-stress, \u03c4(t) \nbeing given by: \n ( ) ( ) ( ) tdtttmt t \u2032\u2032\u2032\u2212= \u222b \u221e\u2212 MSFS\u03c4  ,     Eq.1 \nwhere  S is the strain measure, and MSF ( )ttm \u2032\u2212  is the memory function between time \n in the past, and the current time t. The strain measure of the Molecular Stress \nFunction is given by: \nt \u2032\n 2\n25\nu\nf \u2032\n\u2032\u2032= uuSMSF ,       Eq.2 \n \nwhere u  is a deformed vector given by \u2032\n        Eq.3 0\n1 u)t'F(t,u' \u2212=\nF is the deformation gradient tensor between time t \u2032  in the past, and the current time \nt, and u0 is a vector of (initially) unit length. The brackets : , denote the average \nover the surface of a sphere of unit radius, i.e.: \n 2\n \u222b\u2126 \u2126= dhh \u03c041 .       Eq.4 \n \nThe strain measure, SMSF is related to the Doi-Edwards Strain Function, SDE,  the \nrelationship is: \n \nDEMSF SS\n2f=        Eq.5 \nFigure 1 suggests the deformations of tube segments, according to the Doi-Edwards \nmodel, in an extensional flow. The division by  in Eq .2 , inherent to the Doi-\nEdwards strain tensor, normalises the length of the deformed segments, but \neffectively draws the \u2018strain ellipse\u2019 back to being a \u2018strain sphere\u2019 (see Figure 1). \nThus the Doi-Edwards model assumes a constant cross-section under elongation; the \norientation of the segments is accounted for, but the stretching of the tube is not \naccounted for [19]. This indicates the need for \u2018f \n2u\u2032\n2\u2019 in Eq.2. \n \nThe value f represents the ratio of initial to final tube diameters ao\/a . The ratio f has \nbeen defined as a function of u\u2032 , or u\u2032ln . A pair of parameter-free models are \nderived from first principles: the Linear Molecular Stress Function (LMSF) is for \nmodelling linear molecules; the parameter-free model is derived as: \n \n><= 'ln2 uef ,        Eq.6 \nin ref. [18],and the Quadratic Strain Function (QMSF) for modelling long chain \nbranched molecules; is derived in ref. [19] in parameter-free form: \n \n2\n1\n2\n1 'ln22 += >< uef        Eq.7 \n We concentrate on a recent single-parameter model for f  [19] which includes the \nnotion of a maximum tube stretch. This includes the idea of tube-slip at high \ndeformations, which gives rise to a maximum tube stretch; the tube-slip coefficient is \ndefined in terms of stored energy E, and a maximum value of stored energy, Emax. The \nstored energy is proportional to f 2-1. These principles are used to derive single \nparameter models for the LMSF and QMSF: \n \nFor the LMSF: \n( ) ( ) \uf8fa\uf8fa\uf8fb\n\uf8f9\n\uf8ef\uf8ef\uf8f0\n\uf8ee\n\uf8f7\uf8f7\uf8f8\n\uf8f6\n\uf8ec\uf8ec\uf8ed\n\uf8eb\n\u2212\n\u2212\u2212+\u2212+=\n\u2032\n1\n1exp111 2\nmax\nln\n2\nmax\n2\nf\neff\nu\n ,     Eq.8 \n \nand for the QMSF: \n ( ) ( ) \uf8fa\uf8fa\uf8fb\n\uf8f9\n\uf8ef\uf8ef\uf8f0\n\uf8ee\n\uf8f7\uf8f7\uf8f8\n\uf8f6\n\uf8ec\uf8ec\uf8ed\n\uf8eb\n\u2212\n\u2212\u2212+\u2212+=\n\u2032\n12\n1exp111 2\nmax\nln2\n2\nmax\n2\nf\neff\nu\n.    Eq.9 \n \nIn the remainder of this work, we use LMSF to refer to Eq.8, and QMSF to refer to \nEq.9. \n \n 3\n The effective difference between the two models is the different rate at which the \nfunctions rise to differentiate between linear tube behaviour, and branched (quadratic) \ntube behaviour. The parameter,  sets the maximum value that can attain. 2maxf\n2f\n \nFigure 2 plots u\u2032ln  against strain for shear, uniaxial elongation and planar \nelongation. In elongation the value of u\u2032ln  rises much faster than in shear. \nConsideration of the Finger Strain Tensor and Eq.3 in shear and elongational flows, \nindicates that, at high strains, u\u2032ln  will be approximately equal to strain in \nelongational flows, whereas it will be of the order of ln(strain) in shear flows. The \ncurves for planar and uniaxial elongation are very close. Figure 3 shows the variation \nof  with 2f u\u2032ln  for LMSF and QMSF models. The parameter  is set equal to \n80.0 (as used in later simulations) for the curves shown. The curves both rise to the set \nmaximum; the QMSF reaches the plateau value at a value of \n2\nmaxf\nu\u2032ln  of  \u22483.5, whereas \nthe LMSF reaches the plateau at much higher strains ( u\u2032ln  \u22486 ). \n \nThe model is attractive for a number of reasons: it has a solid physical basis, and has \nbeen shown to gives good fits to experimental data for strain hardening and strain \nsoftening polymer melts using only a single parameter. It is reasonably easy to \nimplement in code that can solve flows of separable KBKZ fluids, since the same \n\u2018backwards tracking\u2019 approach can be employed. A good approximation to the Doi-\nEdwards tensor SDE can be estimated from the Cauchy and Finger strain tensors using \nCurrie\u2019s closure [32]; and a good approximation to u\u2032ln can be deduced from the \nmathematical derivation in the same work. We compute both SDE and u\u2032ln  by a \ndirect integration scheme which is applicable to models with and without an analytical \nevaluation of the spherical integral. \n \n2.1 Computation of an integral over the surface of a unit sphere \nThe following procedure is used to compute 'ln u   and 2u \u2032\n\u2032\u2032uu , thus allowing the \nstrain measure, SMSF to be calculated.  \nThe notation h  implies averaging the function h over the surface of a unit sphere, ie. \n \u2126= \u222b\u2126 dhh \u03c041        Eq.10 \n \nAn integration method using points that are (exactly) evenly distributed over a unit \nsphere was shown to be efficient in ref [33]; the method for setting the positions of the \nevenly spaced points was not given. We take the approach of calculating integration \nweights for a grid of elements on the surface of the sphere. \n \nConsideration of Fig. 4 shows that an element of surface at position (\u03b8, \u03c6), on a unit \nsphere,  has an area, , given by: \u2126d\n \n \u03b8\u03c6\u03b8 ddd sin=\u2126        Eq.11 \n 4\nwhere \u03c6d  and \u03b8d are infinitesimally small increments in \u03c6  and \u03b8  respectively. For \nnumerical integration with finite increments in \u03c6  and \u03b8 , \u03c6\u2206  and \u03b8\u2206  it is \nappropriate to use: \n \u03c6\u03b8\u03b8\u03b8\u03b8\u03b8 \u2206\u2206\uf8f7\uf8f7\uf8f8\n\uf8f6\uf8ec\uf8ec\uf8ed\n\uf8eb \uf8f7\uf8f8\n\uf8f6\uf8ec\uf8ed\n\uf8eb \u2206\u2212+\uf8f7\uf8f8\n\uf8f6\uf8ec\uf8ed\n\uf8eb \u2206+=\u2206\u2126\n2\nsin\n2\nsin\n2\n1  ,   Eq.12 \n \nwhich recognises the difference in lengths of opposite edges (in the \u03b8 direction) of an \nelement of finite dimensions. \n \nEq.12 provides weightings for the direct integration scheme used to calculate both \n'ln u  and  SDE ; n1 elements are used to span the \u03c0 radians range of \u03b8, and n2 \nelements are used to span the 2\u03c0 radians range of \u03c6. \nji\nni\nji\nnj\nhwdh ,\n,1\n,\n,11 24\n1 \u2211 \u2211\u222b\n= =\u2126\n\u2248\u2126\u03c0      Eq.13 \n \nwhere: \u03c6\u03b8\u03b8\u03b8\u03b8\u03b8 \u2206\u2206\uf8fa\uf8fb\n\uf8f9\uf8ef\uf8f0\n\uf8ee \uf8f7\uf8f8\n\uf8f6\uf8ec\uf8ed\n\uf8eb \u2206\u2212+\uf8f7\uf8f8\n\uf8f6\uf8ec\uf8ed\n\uf8eb \u2206+\u2126= 2sin2sin~2\n1\n, iijiw ,  Eq.14 \n \n1n\n\u03c0\u03b8 =\u2206  , \n2\n2\nn\n\u03c0\u03c6 =\u2206 and i\u03b8  is computed such that all i\u03b8 are placed in the centre of \nelements; the first is placed in the centre of an element ranging from \u03b8\u03b8\u03b8 \u2206== to0 : \n \n21\n\u03b8\u03b8 \u2206= ,        Eq.15 \nthen the remaining n  positions follow from : 11 \u2212 ( 11 ,...2for niii )=\u2206+= \u2212 \u03b8\u03b8\u03b8 .    Eq.16 \n \nSimilarly j\u03c6  can be computed from  \n21\n\u03c6\u03c6 \u2206= ,         Eq.17 \nthen    ( 21 ,...2for njjj )=\u2206+= \u2212 \u03c6\u03c6\u03c6 .    Eq.18 \n \nWe use \u2126~ , in place of \u03c04 , where \u2126~  ( )\u03c04\u2245  is the surface area of the sphere \nas computed by the corresponding  non-normalised integration scheme: \n\u2211 \u2211\n= = \uf8f7\n\uf8f7\n\uf8f8\n\uf8f6\n\uf8ec\uf8ec\uf8ed\n\uf8eb \u2206\u2206\uf8fa\uf8fb\n\uf8f9\uf8ef\uf8f0\n\uf8ee \uf8f7\uf8f8\n\uf8f6\uf8ec\uf8ed\n\uf8eb \u2206\u2212+\uf8f7\uf8f8\n\uf8f6\uf8ec\uf8ed\n\uf8eb \u2206+=\u2126\n1,1 2,1 2\nsin\n2\nsin\n2\n1~\nni nj\nii \u03c6\u03b8\u03b8\u03b8\u03b8\u03b8 .  Eq.19 \n \nThis computation needs performing only once for the chosen n1 and n2 and has the \neffect of reducing systematic error due to finite integration. \n  \nFor clarity, the value of hi,j in Eq.13  is the value of h at position ( )ji \u03c6\u03b8 , . \n \n 5\nIn the particular case  of calculating SDE and u\u2032ln , it is necessary to specify the \ndeformed vector u'  corresponding to a polar position ( )\u03c6\u03b8 , ; this is calculated from \n, where  0\n1 u)t'F(t,u' \u2212=\n\u03b8\n\u03c6\u03b8\n\u03c6\u03b8\ncos\nsinsin\ncossin\n==\nz\ny\nx\nu\nu\nu\n0u .     Eq.20 \n \nThus at each angular position, ln is calculated using: 'u\n( )2'2'2'2'2'2' ln\n2\n1ln'ln zyxzyx uuuuuuu ++=\uf8f7\uf8f8\n\uf8f6\uf8ec\uf8ed\n\uf8eb ++= ,  Eq.21 \n \nand 2'u\nu'u' can be computed at that polar position. \n \nNote that for F , the computation of  SI= DE = ( )2'u\nu'u'5  should give exactly \nIS\nIFDE 3\n5== . Due to the errors inherent in finite integration, the computed value will \ndiffer from this, introducing a small artificial difference into the diagonal terms in the \nstrain tensor, this gives a small, artificial, normal stress difference. This small artifact \nis, however, sufficient to give large errors in calculations of apparent viscosity at low \nstrains. Hence, denoting the directly computed value of SDE at F=I by  \nIFDE\nS =\n~ ,  and \ndenoting the directly computed value of SDE at a general value of  F by  DES\n~ , we \nreduce the systematic error in the computation of SDE by using:  \n \n  \nIFDEDEDE\nSISS =\u2212+=\n~\n3\n5~ .     Eq.22 \n \n2.2 Comparison of MSF model with Rheological data \nThe model has been demonstrated to accurately fit experimental data for strain \nhardening and strain softening polymers in many different extensional experiments.  \nWe assess this model against data for the well-characterised IUPAC LDPE. We \nassume that the memory term in Eq. 1 can be represented by the well known sum of \nexponential decay constants: \n ( ) ( )\u2211 \u2032\u2212\u2212=\u2032\u2212\ni\ntt\ni\ni ie\ng\nttm \u03bb\u03bb ,      Eq.23 \nwhere \u03bbi and gi are relaxation times and relaxation modulii, respectively. The \nconstitutive data used is Laun\u2019s data for IUPAC LDPE at 150\u00b0C (from refs.[34,35]) \nThe data is reproduced in Table 1, along with temperature-shifted data at 125\u00b0C and \n160\u00b0C.  \n \nFigure 5 compares QMSF model with transient viscosity data for IUPAC LDPE that \nwere made at 125\u00b0C. A rate of 0.05s-1  was used for shear, uniaxial elongational, and \nplanar elongational measurements. The fit was obtained with fmax2 set to a value of 80; \n 6\nthe value was chosen to optimise the fit to the transient elongational data. It is \nimmediately apparent that both uniaxial and planar strain-hardening are being \nexhibited by the model (as shown in ref. [19]). The rise rate of the elongational data is \nmatched closely. This rise rate is largely independent of the actual value of  fmax2 that \nis used in the QMSF model; the value of fmax2 that is chosen effectively sets the \nplateau value for elongational viscosity, and only affects the rise rate significantly in \nthe region shortly before the plateau. The shear viscosity is slightly higher than the \nexperimental data. It is interesting to compare the results with curves for the LMSF, \nand also the adapted KBKZ described in ref. [13]. A value of fmax2 of 80 was again \nused for the LMSF (raising the value above 80 has very little effect on computed \nviscosity, since fmax2 is reached at very large strains in the LMSF). The adapted KBKZ \nwas used with 2 parameters (\u03b1 =2.5 and \u03b2=0.003) as employed for fitting steady-state \nIUPAC data in [13]. Figure 6 compares the three models against transient planar \nelongational data at 0.05s-1. The LMSF model is seen to have lower natural rise-rate \nthan the QMSF. Interestingly the rise-rate of the adapted KBKZ (which was noted to \nrise too slowly, compared with the strain hardening data [13]) follows a similar path \nto the LMSF.  \n \nHaving obtained a value for fmax2 (obtained from fitting transient elongational data \nonly) it is interesting to plot the results thus predicted for steady-state viscosity \nagainst the well known steady state data for IUPAC LDPE (from[34 - 36]). The \nresults are plotted in Figure 7. It is noted that shear viscosity and N1 are significantly \nhigher than the experimental data. The data for uniaxial elongational  is under \npredicted at low elongational rates, and over predicted at high elongational rates - a \nsituation that appears to be \u2018normal\u2019 for models that do not use different parameters \nfor different relaxation modes. Whilst we do not believe that it is within the \u2018spirit\u2019 of \nthe model to use different parameters for different relaxation times: \u201c(fmax2)i \u201c , we can \nconfirm that the adoption of this multi-parameter method does give a very close fit to \nboth transient and steady state elongational data, with a reduced over-prediction of \nshear and N1 data. By contrast the adapted KBKZ described in [13] does not give a \ngood fit to the transient data when used with a similar number of parameters; earlier \nversions of the KBKZ did not give strain hardening in planar elongational flow[13]. \n It should be noted that the single fitting parameter was based upon obtaining the best \nfit to the transient elongational data (as opposed to a value that was a compromise, in \nsome sense, between all rheological data). Other values for fmax2 gave some \nimprovement to the fitting of shear viscosity, and N1, but at cost to the fitting of \ntransient elongational data. \n \n3.  Simulation method \nA finite element based solution method has been implemented to find the flow \nsolution for flows obeying the QMSF model. Overall, the requirements for solving \nthese flows are similar to the requirements for solving other time-integral models, \nsuch as the separable KBKZ; the integration of the strain measure tensor, SMSF , \ndetailed earlier in this work, is the largest required addition. Significant improvements \nare detailed for particle tracking through elements, and for the time-integration of the \ndeformation gradient tensor, over the methods described in ref. [13]; these methods \nfollow on from methods developed by Dupont and Crochet [3], and Luo and Mitsoulis \n[4]. \n   \n 7\n3.1 Overview of the solution method \nThe simulation uses 9-noded bi-quadratic elements to represent velocity components, \nwith one order lower interpolation used for pressure. The simulation begins with a \nNewtonian flow solution. For each Gauss point in each element, the strain history is \ncalculated by tracking the past history of a \u2018particle\u2019 of fluid back upstream. A typical \ntrajectory will be through many elements; it is necessary to determine which element \nthe particle has reached and the velocity and velocity gradient information at that \npoint. This information allows the deformation gradient tensor to be tracked, and from \nthis the strain function SMSF can be computed. Obtaining the strain function over the \nparticles history permits Eq.1 to be integrated. We use a large number of 5 point \nGauss-Legendre elements for this time integration. \n    \n3.2 Particle tracking \nTo compute the stress state at a position according to time-integral equations, the \ndeformation history of a particle must be computed. A particles trajectory is tracked \nbackwards using a standard kinematic procedure: \n \uf8f7\uf8f7\uf8f8\n\uf8f6\n\uf8ec\uf8ec\uf8ed\n\uf8eb\n\u2202\n\u2202+\u2202\n\u2202\u2032+\u2032\u2212\u2032=\u2032\u2212\u2032\ny\nuv\nx\nuuttutxttx\n2\n)()(~\n2\u03b4\u03b4\u03b4  ,   Eq.24 \n \uf8f7\uf8f7\uf8f8\n\uf8f6\n\uf8ec\uf8ec\uf8ed\n\uf8eb\n\u2202\n\u2202+\u2202\n\u2202\u2032+\u2032\u2212\u2032=\u2032\u2212\u2032\ny\nvv\nx\nvuttvtytty\n2\n)()(~\n2\u03b4\u03b4\u03b4  ,   Eq.25 \nwhere ( ( ) ( )tytx )\u2032\u2032 ,  is the particles position at time t \u2032 , and \n( ) (( tyt ) )ttx \u2032\u2212\u2032\u2032\u2212\u2032 \u03b4\u03b4 ~,~  is the particles approximate position a small increment in \ntime, t \u2032\u03b4 , earlier. As discussed in ref [13], the approximate position will not lie \nprecisely on the original streamline. The position is now adjusted back onto its \noriginal streamline with a movement normal to its velocity using: \n xttxttx \u03b4\u03b4\u03b4 +\u2032\u2212\u2032=\u2032\u2212\u2032 )(~)( ,     Eq.26 \n~ yttytty \u03b4\u03b4\u03b4 +\u2032\u2212\u2032=\u2032\u2212\u2032 )()( ,     Eq.27 \n \nwhere  \nx\nkx \u2202\n\u2202= \u03c8\u03b4 ,       Eq.28 \n  \ny\nky \u2202\n\u2202= \u03c8\u03b4 ,       Eq.29 \nand  22\n0\n~\n\uf8f7\uf8f8\n\uf8f6\uf8ec\uf8ed\n\uf8eb \u2202\u2202+\uf8f7\uf8f8\n\uf8f6\uf8ec\uf8ed\n\uf8eb \u2202\u2202\n\u2212=\nyx\nk \u03c8\u03c8\n\u03c8\u03c8      Eq.30 \nThe streamfunction is \u03c8 , 0\u03c8 is the value of streamfunction at the Gauss point where \ntracking began, and \u03c8~  is the value of streamfunction at the approximate position. The \nmethod prevents the accumulation of small errors in tracking, giving both improved \naccuracy and convergence. The derivation is given in [13]. \n \n3.2.1 Determining the current element and element co-ordinates \n In a finite element based implementation, a principal difficulty lies in determining \nwhich element that a position, defined by ( )yx , , lies in. Additionally to obtain any \ninformation on nodal variable and their derivatives, the position must be mapped to \nthe elements natural co-ordinates ( )\u03b7\u03be , . It is possible to use a rectangular grid of \n 8\nelements, which makes element identification possible through a direct mapping; \nhowever this limits flexibility in meshing.  The streamline tracking method of Luo \nand Tanner [38] identified the element that shared the edge through which the \npreviously \u2018occupied\u2019 element was exited; this allowed flexible meshing. The method \nnow described identifies both the element that contains an arbitrary ( )yx ,  position,  \nand the corresponding element coordinates. The method has broad application to other \ntracking and remeshing  problems.  \n\u03b7and\n22 yx\n)i\n22\n9 ii yxa\nex\n \nFor each element, a polynomial (in x, and y)  is obtained for the element natural \ncoordinates. For 2 dimensional natural coordinates \u03b7\u03be and  \n ),(1 yxf=\u03be  and  ),(2 yxf=\u03b7      Eqs.31 \nThe appropriate terms in x and y to use for a given element can be determined from \n\u2018Pascals triangle\u2019 (or more prosaically by noting the powers of  \u03be  that are used \nin the elements interpolation functions, and using the same powers of x and y). Thus \nfor a nine node bi-quadratic element we have: \n9\n2\n8\n2\n7\n2\n6\n2\n54321),( axyayxayaxaxyayaxaayxf ++++++++=  Eq.32 \n \nwhere the coefficients, aj are initially unknown. To find the coefficients, for the \nequation for \u03be for example, one can use the known values ( ii yx \u03be,, at each of the 9 \nnodes, to give an equation: \n2\n8\n2\n7\n2\n6\n2\n54321 iiiiiiiiiii yxayxayaxayxayaxaa ++++++++=\u03be   Eq.33 \n \nRepeating over the 9 nodes of the element gives a system of 9 equations: this can be \nsolved to provide the coefficients of aj for \u03be in that element. Similarly a function for \u03b7 \ncan be obtained for that element, and this repeated to cover all elements. The process \nneeds performing only once unless the mesh is altered.  \n \nAn elements natural coordinates have a definite valid range (normally \nmaxminmaxmin and \u03b7\u03b7\u03b7\u03be\u03be\u03be \u2264\u2264\u2264\u2264 )yx ,\n for 2D quadrilateral elements). It can be \ndetermined if a position ( could be within an element by checking that the \nnatural coordinates given by Eq.31 is within this allowed range (with a small \nallowance). The position given by the element interpolation functions, ( ) s \nnow computed using the usual interpolation. \ney,  i\n ;        Eq.34 \u2211= jje xx \u03c6 \u2211= jje yy \u03c6\n \nThis position will generally be found to be differ from the original position by an \namount given by yx \u03b4\u03b4 and  where: \n \ne\ne\nyy\nxx\ny\nx\n\u2212\n\u2212=\u03b4\n\u03b4\n        Eq.35 \n \nA form of Newtons approximation can be used to find the small changes in \n\u03b7\u03b4\u03be\u03b4 and that are required to give the original positions: \n ( )\ny\nx\n\u03b4\n\u03b4\n\u03b7\u03b4\n\u03be\u03b4 1TJ \u2212=        Eq.36 \n \n 9\n \nNote that  JT is the transpose of the Jacobian most commonly used in finite element \ncomputation, ie. \n \n \n\u03b7\u03b7\n\u03be\u03be\n\u2202\n\u2202\n\u2202\n\u2202\n\u2202\n\u2202\n\u2202\n\u2202\n= yx\nyx\nJ         Eq.37 \n \nOne or two iterations will normally obtain values of \u03b7\u03be and  that return the input \nposition to within negligible error. \n  \nA complication can arise: due to \u2018multiple root\u2019 behaviour of quadratic and higher \nbased elements, it is possible to find more than one element for which Eq.31 gives \n\u2018valid-range\u2019 values of \u03b7\u03be and\n)\n. These can usually be eliminated immediately if the \nvalues of ( yx \u03b4\u03b4 ,  from Eq.35 are larger than the largest dimension of the element. \nMore subtle \u2018aliases\u2019 can be identified after an iteration of the Newton\u2019s \napproximation method, which will give values of \u03b7\u03be and  that are outside the valid \nrange. \n \n3.2.2 Tracking Efficiency \nThe key to making the method efficient is to maintain, for each element, a list of the \nneighbouring elements that exiting particles have previously been tracked into. For \nmost elements this will contain only 1, 2, or 3 elements. Upon finding that a particle \nhas left a particular element, the elements in this elements \u2018list of previously tracked \ninto\u2019 are checked first; this will normally yield the correct new element without \nextensive searching of the whole mesh. \n \nThe computation of the coefficients for \u03b7\u03be and  over ~103 elements takes only a \nfraction of a second in total on a modern PC. The method is robust, and appears \ngeneral for 1D, 2D and 3D Legendre-type elements. \n \n3.3 Time integration of the extra-stress tensor \nThe time integration of Eq.1 is accomplished by employing five point Gauss-\nLegendre integration of each of a large number of time segments. At each of these \nGauss point the deformation rate tensor, )t( \u2032L , is constructed where jiij xuL \u2202\u2202= . \nContinuous velocity gradients are used to construct )t( \u2032L  (computed by the least-\nsquares method described in [37] ). For the Legendre type of element used, \nincompressibility is enforced in an average sense; it is to be expected that at any \ngeneral point, \u03b5=++ 332211 LLL , where \u03b5  represents the error in incompressibility. \nThis error is \u2018shared\u2019 between the three diagonal components of L to maintain a \nphysically meaningful deformation gradient tensor; see [9]. \n \nThe deformation gradient tensor is computed by solution of : \n )()()( st\ntd\nsd FLF \u2032=  ,       Eq.38 \n 10\nwhere  [37]. We use a 4tts \u2032\u2212= th order Runge-Kutta method to calculate F. For \naccuracy we solve Eq.38 by repeatedly applying the Runge-Kutta process over small \ntime increments ( )s\u03b4\u03b4  which may be far smaller than the time-steps indicated by \neither the requirements for tracking or the requirements for time-integration of Eq. 1. \nPreviously we have ensured that ( ) 50\/1\u2264\u00d7 ijLs\u03b4\u03b4\n4\/\n for any element of the tensor L \n[13].  An analytical solution of Eq.38  indicates that it is the largest eigenvalue of L,  \nKmax , that sets the growth rate of F with time; the time step employed in solving \nEq.38 should then be related to Kmax . The largest eigenvalue of L can be obtained for \nlittle computational cost using the \u2018power method\u2019 e.g. [39]. For current simulations \nwe ensure that ( )\u00d7s 1max \u2264K\u03b4\u03b4  which appears to give similar accuracy and \nrobustness as the previous criteria, but is significantly faster in practise as the \napproach identifies, accurately, where small time steps are needed to compute F, and \nwhere large time steps are permissible. \n \nThe Doi-Edwards strain measure, SDE and u\u2032ln  can then be calculated, from F, \nusing the integration formulae in section 2.1. This allows SMSF to be computed using \nEqs.5, 8, and 9. Given that the history of SMSF  is known, the extra-stress tensor, \u03c4, \ncan be calculated by time-integration of Eq.1. \n \n3.4  Updating the velocity and pressure fields \nUpon computing a new stress field, an updated velocity and pressure field is required. \nThe method used is an adaptation of the method given in ref [40]. The details of our \nfinite element based implementation of the method are given in ref [13]; only an \noutline is given here. \n \nFor an assumed steady-state solution, with negligible inertia and body forces, we \nrequire: \n \u03c3\u22c5\u2207 v = 0,        Eq.39 \nwhere \u03c3v is the total viscoelastic stress, ie \u03c3v = \u03c4v - I p , where \u03c4v is the viscoelastic \nextra-stress, p is pressure, and I is the identity matrix. The velocity is now introduced \nby subtracting notional Newtonian extra-stresses from both sides (the Newtonian \nstresses are given by ( )TLL +\u00b5  where \u00b5 is a viscosity, and L is the deformation rate \ntensor). This leads to: \n ( )( ) ( )( )\nNvN\np TT LLILL +\u2212\u2207=\u2212+\u2207\u2212 + \u00b5\u00b5 \u03c4.. 1  .  Eq.40 \n \nThe subscripts imply that viscoelastic stresses and Newtonian stresses from iteration \nN are used to calculate the N+1 th velocity and pressure field. The full finite element \nformulation is given in ref [13]. The AVSS scheme [41] uses a similar method but \nwith individual values of \u00b5 for each element. \n \nThe value of \u00b5 that is used is important:  we  use 0\u00b5\u03c9\u00b5 = , where 0\u00b5  is the \nnumerically predicted low rate shear viscosity given by \u2211= g ii\u03bb\u00b50 and \u03c9 is a \nrelaxation parameter. If \u03c9  is chosen too large, then convergence will be attained \nexcessively slowly; if \u03c9  is chosen too small then large instabilities will occur. In \nthese simulations on a model that (accurately) predicts the steep strain hardening \ncurve of IUPAC LDPE, \u03c9  needed setting to values of between 2 and 50. \n 11\nConvergence criteria for the simulations was that , where is the \nmaximum change in any velocity component, divide by the maximum flow velocity. \nA relative pressure change of 10\n310\u2212<\u2206 rV\u03c9 rV\u2206\n-2 or better was obtained for all flow solutions. \nxyx\n\u03c3\u2202\n\u2202\n\u2202\n\u2202\n\u2202\n\u2202\n \n \n4 Determination of Correction Pressure in Doi-Edwards based models \n   \nSpecial considerations are found to be necessary for some Doi-Edwards based (and \nsome other) constitutive models when calculating correction pressure from simulation \nresults. It has been suggested that QMSF based models give negative correction \npressures, which has been used as a major criticism. The following demonstrates the \npotential for these apparently negative correction pressures (in Doi-Edwards based, \nand also in some KBKZ models), and gives a logical approach to resolve this \nanomaly. The difference between inlet and outlet pressures has often been referred to \nas \u2018the die pressure drop\u2019 in simulation work, without indication of measuring points. \nA study of the dependence of calculated values for \u03b4Pen for different measuring points \n(centreline to wall) in ref. [7] showed a moderate variation when using the PSM \nmodel without any contribution from the Cauchy tensor. We show, with reasons, a \nmuch stronger dependence of  \u03b4Pen on measuring point for the QMSF model. \n \nCorrection pressure, \u03b4Pen, is defined as \n \n \nw\nduoutin\nen\nPPPP\nP \u03c4\u03b4 2\n\u2206\u2212\u2206\u2212\u2212=       Eq.41 \nwhere Pin is the inlet pressure to the contraction die, Pout is the outlet pressure of the \ncontraction die, \u2206Pu is the pressure drop expected from fully developed wall shear \nstress in the upstream section, and \u2206Pd is the pressure drop expected from fully \ndeveloped wall shear stress in the section downstream of the contraction. For a \ncapillary of length, L, wall shear stress, \u03c4w , and radius, R the expected pressure drop \nis 2 L\u03c4w  \/ R; similarly for a planar slit of half-height, h, the expected drop is  L\u03c4w \/ h.  \nConsider a fully developed planar flow in a slit, with the flow in the x-direction. The \nvelocity components in the y and z directions (v and w respectively) are both zero. \nThe flow will have a different shearing rate at different values of \u2018y\u2019. Consider that \nCauchy\u2019s equation for motion in the y-direction is: \n 0=\u2202\n\u2202+\u2202\n\u2202\nyyxy yx\n\u03c3\u03c3        Eq.42 \nfor steady flow. For fully developed flow we have =0,  hence: \n ( ) 0=\u2212\u2202\u2202=\u2202\u2202 pyy yyyy \u03c4\u03c3 ,      Eq.43 \nwhere \u03c4yy is the extra-stress, and p is pressure.  \nConsider first Newtonian flow: for Newtonian flow, \u03c4yy is proportional to \ny\nv   \nwhich is equal to zero for this x-direction flow. It follows from Eq.43 that \ny\np is zero \nfor a Newtonian flow \u2013 this gives the familiar \u2018vertical\u2019 contours of pressure similar to \n 12\nthose shown in Figure 8 (a). Hence the pressure at a point on the centreline will be the \nsame as the pressure at the corresponding point on the wall. \n \nConsider now separable KBKZ type equations; the strain measures are the Finger \nstrain tensor, with (sometimes) a contribution from the Cauchy strain Tensor. In the \nsteady state shearing flow being considered, yy\u03c4  comes from the \u201cyy\u201d component of \nthe Finger strain tensor ( =1 in shear) and the \u201cyy\u201d component of the Cauchy tensor ( \n= \u03b32 +1 in shear).  \n \nIf only the Finger Strain Tensor is used  then 0\u2245\u2202\n\u2202\ny\nyy\u03c4 , and thus 0\u2245\u2202\n\u2202\ny\np  (the gradient \nis not exactly zero, since the stress also depends on the damping and memory \nfunctions, which are affected by shear rate). If C  is used in place of C , then I1 \u2212\u2212 1\u2212\nyy\u03c4 will be identically zero in the shear flow described and vertical contours of \npressure are seen (see Figure 8 (a)). If the model employs a non zero contribution \nfrom the Cauchy Tensor, then the \u201c\u03b32 +1\u201d term in shear contributes directly to  yy\u03c4 ; as \na result 0\u2260\u2202\n\u2202\ny\nyy\u03c4 , and according to Eq. 43 there will be a pronounced pressure \ngradient in the \u201cy\u201d direction. The qualitative implications above are all confirmed in \nsimulation. \n \nWe lastly consider the Doi-Edwards strain tensor, or to be precise Currie\u2019s \napproximation to it [32]. This approximates the Doi-Edwards strain tensor as a \nweighted sum of the Finger strain tensor, and the Cauchy tensor. The same logic that \nis used for the separable KBKZ model implies that the pressure gradient, normal to \nthe direction of flow, will be non zero, certainly if Currie\u2019s approximation is used. \nSimulation results confirm this for a full implementation of the Doi-Edwards strain \nmeasure. The gain give by f 2 in the MSF model has the affect of magnifying this \neffect (compare (b) and (c) in Figure 8). \n \n \n \nConstitutive Model Pressure gradient \nnormal  to fully \ndeveloped shear flow \ncomment \nNewtonian Zero pressure contours normal to \nflow \nKBKZ using Finger strain \ntensor C-1 \n\u22600 weak effect, Second Normal \nStress Difference, N2=0 \nKBKZ using C-1 - I Zero N2=0 \nKBKZ using Finger and \nCauchy strain tensor \n\u22600 Strength of effect depends \nupon relative weighting of \nFinger and Cauchy tensors \nDoi-Edwards Strain tensor \u22600 Moderate effect, no strain \nhardening \nQMSF \u22600 Pronounced effect, includes \nstrain hardening \n 13\nTo resolve the problem of \u201cnegative correction pressures\u201d with models that give a \nnon-zero \u2018\u2202p\/\u2202n\u2019, as defined above, it is necessary to measure Pin, and Pout at the wall \n\u2013 not at the centreline. This seems appropriate since the correction pressures can be \nviewed as a means of comparing actual pressure drop, with the pressure drop expected \nsolely from shear at the walls. We can confirm that measuring Pin and Pout at the \ncentreline does give strong negative values of \u201ccorrection pressures\u201d, particularly at \nhigh flow rates, for the QMSF model (example values are given in section 5.1). For \nthe models for which  \u2018\u2202p\/\u2202n\u2019 is zero, the change makes no difference (provided that a \nfully developed inlet flow profile is used as a boundary condition). The values of \ncorrection pressure that we list are all obtained from measurements at the wall. \n \n \n5. Evaluation of QMSF model in flow simulation \n \nWe report a number of simulations that indicate the behaviour of the QMSF material \nmodel in planar and axisymmetric contraction die flows. This behaviour is compared \nwith the \u2018PSM\u2019 KBKZ model [2], which is known to give good agreement with \nexperimental data for opening angle for 4:1 axisymmetric flow of IUPAC LDPE; it is \nalso known that it does not give strain hardening response in planar flows. Additional \ncomparison is made to the \u2018adapted\u2019 KBKZ model [13], which does give strain \nhardening in both axisymmetric and planar flows, but which underestimates the strain \nhardening rate for branched polymer melts [13]. \nMeasures which are compared include the vortex opening angle (using a definition \nthat is suitable for both \u2018convex\u2019 and \u2018concave\u2019 vortexes, given in ref. [13]), and the \nvortex intensity (see [3], or [37] for definition). A third measure that is investigated is \nthe correction pressure; this is evaluated for all models as described in section 4.  \nFor clarity, the one-parameter QMSF model (Eq.9) is used with f 2max = 80.0 . All \nmodels used the rheological data for 160\u00b0C shown in Table 1. The \u2018adapted\u2019 KBKZ \nand the \u2018PSM\u2019 KBKZ and the adjustable parameters that were used are specified in \nTable 2. \n  \n5.1 Flow in a 8:1 contraction ratio planar die \nFigure 9 shows the vortex details obtained using the QMSF model at apparent shear \nrates of 4, 16, and 64s-1. For comparison the corresponding plots for the adapted \nKBKZ model are plotted. It is apparent that vortex size increases with flow rate, as \nfound experimentally; the QMSF model gives a larger and stronger vortex. \n \nVortex area is indicated by the opening angle, as shown in Figure 10. The QMSF \ngives steadily increasing vortex angle, once expansion begins at around 0.5s-1. Both \nQMSF and adapted KBKZ are seen to give a larger vortex with increasing flow rate in \nplanar contraction flows, in keeping with experimental observation. Vortex angle is \ngenerally greater with the QMSF model. The PSM model, as shown previously [9], is \nseen to give a vortex angle that decreases with flow rate, in contrast to experimental \nobservation. \n \n Figure 11 plots the vortex intensities against shear rate for the QMSF, PSM, and \nadapted KBKZ. The QMSF model gives a much earlier and stronger rise in vortex \nintensity than the adapted KBKZ. A peak in vortex intensity is seen at around 32 s-1 \nfor the QMSF model; although the vortex size and angle continues to rise after this \npeak. \n 14\nThe correction pressures are shown in Figure 12, in all case these are calculated using \nthe inlet and outlet pressures at the die walls as discussed earlier. Using wall \npressures, the QMSF model is seen to give a positive correction pressure at all flow \nrates. The QMSF model  shows a steeper rise in correction pressures at high flow \nrates, which is consistent with the model showing the most strain hardening at \nmoderate strains. The adapted KBKZ shows considerably lower correction pressures. \nThe PSM model shows the lowest correction pressures, which seems consistent with \nits lack of strain-hardening in planar flows.  \n \nThe levels of Correction Pressure for the QMSF model at low flow rates are of \ninterest: in this planar flow they appear to asymptote to zero, and have not been found \nto go below zero, even at much lower flow rates than those shown. If the inlet and \noutlet pressures on the centreline are used, then negative correction pressures would \nobtained (for example the correction pressure at 0.5s-1 is -0.50, and at 32s-1, the \ncorrection pressure is -2.0). Negative values of \u2018correction pressure\u2019 are highly \nquestionable from a physical point of view; our use of wall pressures appears logical \nwhen a parameter is being calculated that relates wall shear and associated pressure \ndrop.  \n \n5.2 Flow in a 4:1 contraction ratio axisymmetric die \nThe QMSF model appears to be a significant improvement over the adapted KBKZ \nand PSM models in planar contraction flow; the models are here compared in a 4:1 \nabrupt contraction axisymmetric flow to give an indication as to which features are \ngenerally true of the models. \nFigure 13 compares the opening angles obtained. The PSM model is known to be \nquite accurate on this measure, and is reported to be around 2\u00b0 below experimental \nresults [3]. By comparison the QMSF model, and adapted KBKZ fall short, with the \nQMSF model being closer. \nFigure 14 shows the vortex intensities obtained. The PSM model gives the highest \nintensity, and the adapted KBKZ the weakest. In this flow the QMSF model exhibits a \npeak in vortex intensity at a lower rate, around 4 s-1; thus the elongation rate at which \npeak vortex intensity is seen differs by a factor of four between the two flows. The \nadapted KBKZ also shows a peak in vortex intensity at around 16 s-1. \nThe correction pressures are shown in Figure 15. In addition to giving largest vortex \ngrowth in this flow, the PSM model is seen to give the largest correction pressures. \nThe correction pressures from the QMSF model stay away from zero in this flow. \nInterestingly, the correction pressures from the adapted KBKZ model are similar to \nthose from the PSM model until a rate of 8 s-1, after this point they are similar to the \nQMSF model. \n \nOver both geometries the simulation results from the QMSF model are the most \nconvincing: the results are closer to the experimental measurements in axisymmetric \nflow than the adapted KBKZ, and far better than the PSM in planar contraction flow. \nThe PSM model apparently gives the best results of the three models in the 4:1 \naxisymmetric flow, but as it gives qualitatively incorrect results with geometry change \nfrom axisymmetric contraction to planar contraction, it seems unsafe to assume that it \nwill be reliable for flows with significant non-axisymmetric elongation. \n \n 15\n6. Discussion and conclusions \nThe \u2018adapted KBKZ\u2019 model improved over the \u2018PSM KBKZ\u2019 model in the sense that \nit allows strain hardening in planar flows to be modelled. The form of Quadratic \nMolecular Stress Function model that has been implemented and studied has many \nfeatures that make it more appealing than the \u2018adapted KBKZ\u2019 model. It has a more \nsolid physical derivation, and only one adjustable parameter.  Within the confines of \none parameter the model gives a good fit to transient and steady-state elongational \nviscosities for IUPAC LDPE, and has previously been shown to give very good \nagreement with other viscometric measures for strain-hardening polymers [19]. \nCapturing the rate of strain-hardening is a particularly important improvement over \nthe adapted KBKZ model. In simulations of converging flow in an axisymmetric die \nthe model gives vortex sizes that are nearly as close to experiment as those given by \nthe PSM model, and are significantly closer than those given by the adapted KBKZ. \nIn planar contraction flows, where the PSM model fails to predict even a qualitative \nvortex growth (due to lack of planar strain hardening), the QMSF model gives strong \nand early vortex growth; again it appears to improve significantly over the adapted \nKBKZ. This particular form of the QMSF model (with one adjustable parameter) \ngives some degree of over-prediction of steady state shear viscosity and First Normal \nStress Difference for IUPAC LDPE, when the single parameter is obtained from \ntransient elongational viscosity.  \n \nA different model, the Linear Molecular Stress Function (LMSF) model must be \nemployed if modelling a linear polymer that exhibits strain softening. \n \nImplementation of the model is not particularly difficult compared with a KBKZ \nimplementation; in particular the model is readily implemented in a \u2018backwards time-\nintegration\u2019 method as normally used for the KBKZ model. It is possible to compute \nthe Doi-Edwards tensor and <ln u\u2032> by direct integration, a method that has \napplication to models with or without an analytical evaluation or approximation of the \nspherical integral. \n \nThe particle\/element tracking methods described have proven valuable in making this \n\u2018tricky\u2019 part of stress calculation robust, and self-contained. In particular, the method \nis general for different element of the Legendre class, provided that the same order of \ninterpolation is used in all principal directions. The method works efficiently on \nmeshes where the elements change alignment with respect to coordinate axes, or flow. \nThe simple technique of recording the most common element changes, and checking \nthese first, keeps search-time close to a minimum. The method has broad application \nto other tracking and remeshing problems. \n \nThere is some cost involved: direct integration of SDE and  <ln u\u2032> is computationally \nexpensive, with simulation times increased by a factor of around three using our \nintegration method. An approximation to <ln u\u2032> can be deduced from the derivation \nof the approximation for SDE  in ref. [32]1. We consider this approximation to be \u2018very \ngood\u2019 in elongation, and \u2018good\u2019 in shear (e.g. 5% and 15% over-estimate of <ln u\u2032> at \n                                                 \n1 Thanks to a referee for pointing this out, we take the approximation to be ( ) \uf8f7\uf8f8\uf8f6\uf8ec\uf8ed\uf8eb \uf8f7\uf8f8\uf8f6\uf8ec\uf8ed\uf8eb \u2212++\u2248\u2032 1413271ln5.0ln 5.021 IIu  \n 16\nshear values of 10 and 100 respectively). This approximation would remove the \nincrease in computation time if found satisfactory for simulation. \n \nConvergence was generally more difficult to achieve than with the adapted KBKZ \nmodel, we believe this is due to the high strain-hardening rates that can be accurately \nfitted. Significantly higher relaxation was needed, with a corresponding increase in \nthe number of iterations that were required for convergence. This difficulty does not \nappear to be a problem with the QMSF model, but a difficulty of simulating flows \nwith strong strain hardening, when this strain hardening is accurately captured in the \nconstitutive model.  \n \nAcknowledgements \nThe author is grateful to Professor Manfred Wagner for invaluable conversations on \nthe physics and approach of the Molecular Stress Function model, and is grateful for \nsome very helpful comments from referees. \n \nReferences \n \n[1] Wagner M.H., A constitutive analysis of uniaxial elongational flow data of low-\ndensity polyethylene melt  , J.Non-Newt.Fluid Mech., 4 (1978), 39. \n[2] A.C. Papanastasiou,  L.E. Scriven and C.W. Macosko., An Integral Constitutive \nEquation for Mixed Flows: Viscoelastic Characterization ,J. Rheol., 27 (1983), \n387. \n[3] S. Dupont and M.J. Crochet, The vortex growth of a K.B.K.Z. fluid in an abrupt \ncontraction , J.Non-Newt.Fluid Mech., 29 (1988), 81. \n[4] X.-L Luo and E. Mitsoulis, A numerical study of the effect of elongational viscosity \non vortex growth in contraction flows of polyethylene melts , J. Rheol., 34 (1990), \n309. \n[5] A. Goublomme. Ph.D. Thesis, Louvain-la-Neuve, (1992) \n[6] D.G. Kiriakidis, H.J. Park, E. Mitsoulis, B. Vergnes and J.-F. Agassant., A study of \nstress distribution in contraction flows of an LLDPE melt , J.Non-Newt.Fluid \nMech., 47 (1993), 339. \n[7] B. Bernstein, K. A. Feigl, E. T. Olsen, Steady flows of viscoelastic fluids in \naxisymmetric abrupt contraction geometry: A comparison of numerical results J. \nRheol. 38 (1994), 53. \n[8] R. Ahmed, R.F. Liang and M.R. Mackley, The experimental observation and \nnumerical prediction of planar entry flow and die swell for molten polyethylenes  ,  \nJ. Non-Newt. Fluid Mech., 59 (1995), 129. \n[9] Olley, P.,Spares, R., and Coates, P.D., A method for implementing time-integral \nconstitutive equations in commercial CFD packages  , J. Non-Newtonian Fluid \nMech., 86, (1999), 337. \n[10] A. Goublomme, M.J. Crochet, Numerical prediction of extrudate swell of a high-\ndensity polyethylene: further results  , J. Non-Newt. Fluid Mech. 47 (1993), 281. \n[11] A. Goublomme, B. Drailly and M.J.Crochet, Numerical prediction of extrudate \nswell of a high-density polyethylene ,  J. Non-Newt. Fluid Mech., 44 (1992), 171. \n[12] H.J. Park, D.G. Kiriakidis, E. Mitsoulis, Birefringence studies in die flows of an \nHDPE melt,  J. Rheol. 36 (1992), 1563. \n[13] Olley, P., An adaptation of the separable KBKZ equation for comparable response \nin planar and axisymmetric flow  ,  J. Non-Newtonian Fluid Mech, 95 (2000), 35. \n 17\n[14] Mitsoulis, E., Numerical simulation of entry flow of the IUPAC-LDPE melt , J. \nNon-Newtonian Fluid Mech., 97 (2001), 13. \n[15] Mitsoulis, E., Entry flow of LDPE melts in a planar contraction , J. Non-Newtonian \nFluid Mech., 111 (2003), 41. \n[16] Wagner, M.H. and Schaeffer, J., Nonlinear strain measures for general biaxial \nextension of polymer melts,J. Rheol., 36 (1992), 1. \n[17] Wagner, M.H. and Schaeffer, Assessment of nonlinear strain measures for \nextensional and shearing flows of polymer melts, J., Rheol. Acta, 33 (1994), 506.  \n[18] Wagner, M.H., Ehrecke, P., Hachmann, P., Meissner, J., A constitutive analysis of \nuniaxial, equibiaxial and planar extension of a commercial linear high-density \npolyethylene melt J.Rheol., 42 (1998), 621. \n[19] Wagner, M.H., Bastian, H., Hachmann, P., Meissner, J., Kurzbeck, S., Munstedt, \nH., Langouche, F., The strain-hardening behaviour of linear and long-chain \nbranched polyolefin melts in extensional flows,  Rheol. Acta , 39 (2000), 97. \n[20] Wagner, M.H., Rubio, P., Bastian, H., The molecular stress function model for \npolydisperse polymer melts with dissipative convective constraint release  J.Rheol, \n45 (2001), 1387. \n[21] Marrucci, G., Dynamics of entanglements: A nonlinear model consistent with the \nCox-Merz rule  , J. Non-Newtonian Fluid Mech., 62 (1996), 279. \n[22] Peters, E.A.J.F, Hulsen, M.A., and van den Brule, B.H.A.A., Instationary Eulerian \nviscoelastic flow simulations using time seperable Rivlin-Sawyers constitutive \nequations, J. Non-Newtonian Fluid Mech., 89 (2000), 209. \n[23] Rasmussen, H.K., Lagrangian viscoelastic flow computations using the Rivlin-\nSawyers constitutive model, J. Non-Newtonian Fluid Mech., 92 (2000), 227. \n[24] Rasmussen, H.K., Lagrangian viscoelastic flow computations using a generalised \nmolecular stress function model, J. Non-Newtonian Fluid Mech., 106 (2002), 107. \n[25] Wapperom, P., and Keunnings, R., Simulation of linear polymer melts in transient \ncomplex flow, J. Non-Newtonian Fluid Mech., 95 (2000), 67. \n \n[26] McLeish, T.C.B, Larson, R.G., Molecular constitutive equations for a class of \nbranched polymers: The pom-pom polymer ,J. Rheol. 42 (1998), 81. \n[27] Milner, S.T., McLeish, T.C.B, Likhtman, A.E., Microscopic theory of convective \nconstraint release ,  J.Rheol., 45 (2001), 539. \n[28] Arjen, C.B.B, Grillet, A.M., Peters, G.W.M., Baaijens, F.P.T., Viscoelastic analysis \nof complex polymer melt flows using the eXtended Pom\u2013Pom model , J. Non \nNewtonian Fluid Mech., 108 (2002), 301. \n[29] Wilco, M.H.V., Peters, G.W.M., Baaijens, F.P.T, Numerical simulations of the \nplanar contraction flow for a polyethylene melt using the XPP model  , J. Non \nNewtonian Fluid Mech., 117 (2004), 73. \n[30] Ianniruberto, G, Marrucci, G., A simple constitutive equation for entangled \npolymers with chain stretch , J.Rheol., 45 (2001), 1305. \n[31] Ianniruberto, G, Marrucci, G., A multi-mode CCR model for entangled polymers \nwith chain stretch , J. Non Newtonian Fluid Mech., 102 (2002), 385. \n[32] Currie, P.K., Calculations on the Doi-Edwards Model for Concentrated Polymer \nSystems, in \u201cRheology\u201d, the Proc. of the ninth Inter. Congress on Rheology, \nAcapulco, Mexico (1984) \n[33]  van Heel, A.G.P,  Hulsen, M.A., and van den Brule, B.H.A.A, Simulation of the \nDoi-Edwards model in complex flow, J. Rheol., 43 (1999), 1239. \n 18\n[34] Laun, J.M., Description of the non-linear shear behaviour of a low density \npolyethylene melt by means of an experimentally determined strain dependent \nmemory function, Rheol. Acta., 17 (1978), 1. \n[35]  Laun, J.M. and Munstedt, H., Elongational behaviour of a low density polyethylene \nmelt, Rheol. Acta., 17 (1978), 415. \n \n[36] Meissner, J., Basic parameters, melt rheology, processing and end use properties of \nthree similar low density polyethylene samples, Pure Appl. Chem., 42 (1975), 553-\n612 \n[37]  Luo, X.-L., Mitsoulis, E., A numerical study of the effect of elongational viscosity \non vortex growth in contraction flows of polyethylene melts, J. Rheol., 34 (1990), \n309. \n[38] Luo, X.-L. and Tanner, R.I., A streamline element scheme for solving viscoelastic \nflow problems part II: Integral constitutive models, J. Non Newtonian Fluid Mech., \n22 (1986), 61. \n[39] Chapra, S.C., and Canale, R.P., Numerical methods for engineers, McGraw-Hill \nPublishers, third edition (1998), ISBN 0-07-010938-9 \n[40] M. Viriyayuthakon and B. Caswell, Finite element simulation of viscoelastic flow, \nJ. Non Newtonian Fluid Mech., 6 (1980), 245. \n[41] Sun, J., Phan-Thien, N., and Tanner, R.I., An adaptive viscoelastic stress splitting \nscheme and its applications: AVSS\/SI and AVSS\/SUPG, J. Non Newtonian Fluid \nMech., 65 (1996), 75. \n 19\nList of figure captions: \n \nFigure 1 Schematic of tube deformations: uo is the original undeformed vector, u\u2032 is the \ndeformed vector given by u\u2032=F-1uo, and u\u2032 \/ u\u2032 is the normalised deformed vector. \n \nFigure 2 Variation of <ln u\u2019> with shear or Hencky strain in shear, planar extensional, and \nuniaxial extensional flows  \n \nFigure 3 Variation of f2 with <ln u\u2019> for the Linear MSF, and Quadratic MSF models. f2max is \nset to 80.0 in both cases \n \nFigure 4 Elemental area, d\u2126, of the surface of a sphere of radius r \n \nFigure 5 Comparison between QMSF and transient viscosity data for IUPAC LDPE at 125\u00b0C \n \nFigure 6 Comparison between experimental data for planar elongational viscosity at 0.05s-1 for \nIUPAC LDPE, and the QMSF, LMSF, and adapted KBKZ models \n \nFigure 7 Comparison of QMSF predictions for uniaxial elongational viscosity, shear viscosity, \nand N1 against experimental results for IUPAC LDPE at 150\u00b0C. Prediction for \nplanar elongational viscosity is also shown (dotted). The value for the single \nparameter f2max (=80.0) was obtained from transient data. \n \nFigure 8 Comparison of pressure contours in fully developed region of die slit.  \n(a) time-integral using (C-1 \u2013 I) h(I1, I2), (b) time-integral using Doi-Edwards \ntensor, (c) time-integral using QMSF tensor (strain hardening) \n \nFigure 9 Vortex details for the QMSF model and for the adapted KBKZ model in planar \ncontraction flow; contours are plotted at integer multiples of 0.1% \n \nFigure 10  Comparison of opening angles obtained for three models in 8:1 planar contraction \nflow \n \nFigure 11  Comparison of vortex intensity obtained for three models in 8:1 planar contraction \nflow \n \nFigure 12  Comparison of correction pressures obtained for three models in 8:1 planar \ncontraction flow \n \nFigure 13  Comparison of opening angles obtained for three models in 4:1 axisymmetric \ncontraction flow \n \nFigure 14  Comparison of vortex intensities obtained for three models in 4:1 axisymmetric \ncontraction flow \n \nFigure 15  Comparison of correction pressures obtained for three models in 4:1 axisymmetric \ncontraction flow \n \n 20\nTables: \n \nTable 1  Rheological data for IUPAC LDPE at 125\u00b0C, 150\u00b0C, and 160\u00b0C \n \ni 1 2 3 4 5 6 7 8 \ngi (Pa) \n \n1.29\u00d7105 9.48\u00d7104 5.86\u00d7104 2.67\u00d7104 9.80\u00d7103 1.89\u00d7103 1.80\u00d7102 1.00\u00d7100 \n\u03bbi  (s) \n(150\u00b0C) \n10.0\u00d710-5 10.0\u00d710-4 10.0\u00d710-3 10.0\u00d710-2 10.0\u00d710-1 10.0\u00d7100 10.0\u00d7101 10.0\u00d7102 \n\u03bbi (s) \n(160\u00b0C) \n7.01\u00d710-5 7.01\u00d710-4 7.01\u00d710-3 7.01\u00d710-2 7.01\u00d710-1 7.01\u00d7100 7.01\u00d7101 7.01\u00d7102 \n\u03bbi (s) \n(125\u00b0C) \n26.2\u00d710-5 26.2\u00d710-4 26.2\u00d710-3 26.2\u00d710-2 26.2\u00d710-1 26.2\u00d7100 26.2\u00d7101 26.2\u00d7102 \n \n \n \nTable 2 Specification of the \u2018PSM KBKZ and the \u2018adapted\u2019 KBKZ used in this work, \nand their parameters \n \nReference name Specification Adjustable \nparameters \n\u2018PSM\u2019 KBKZ \u222b \u221e\u2212 \u2212 \u2212\u2212++=\nt\ndt\nII\nttttmt '\n3)1(\n)',()',()(\n21\n1\n\u03b2\u03b2\u03b1\n\u03b1\u03c4 C  \u03b1 = 14.38 \u03b2 = 0.018 \n\u2018adapted\u2019 KBKZ \u222b \u221e\u2212 \u2212 \u2212++=\nt\ndt\nSS\nttttmt '\n)1(\n)',()',()( 2\n1\n\u03b2\u03b2\u03b1\n\u03b1\u03c4 C  , \nwhere  312 \u2212= IS\n\u03b1 = 2.5 \n\u03b2 = 0.003 \n \n \n \n \n \n \n \n \n \n \n \n \n \n 21\nuo u\u2019 u \/\u2019 u\u2019\n \n \n \n \nFigure 1 Schematic of tube deformations: uo is the original undeformed vector, u\u2032 is \nthe deformed vector given by u\u2032=F-1uo, and u\u2032 \/ u\u2032 is the normalised deformed vector. \n \n \n \n \n 22\n \n \n \n0\n2\n4\n6\n8\n10\n0.1 1 10\nShear strain (Hencky strain) \n< \nln\n u\n'>\nshear\nplanar extension\nuniaxial extension\n \nFigure 2 Variation of <ln u\u2019> with shear or Hencky strain in shear, planar extensional, \nand uniaxial extensional flows  \n \n \n \n \n 23\n \n \n \n \n0.0\n20.0\n40.0\n60.0\n80.0\n100.0\n0.0 2.0 4.0 6.0 8.0\n< ln u' >\nf2\nLMSF\nQMSF\n \n \nFigure 3 Variation of f2 with <ln u\u2019> for the Linear MSF, and Quadratic MSF models. \nf2max is set to 80.0 in both cases \n \n 24\n \n \nd  = r  sin  d  d\u2126 \u03b8 \u03b82 \u03c6\n \n \n \nFigure 4 Elemental area, d\u2126, of the surface of a sphere of radius r \n \n \n \n 25\n \n \n \n \nFigure 5 Comparison between QMSF and transient viscosity data for IUPAC LDPE at \n1e5\n1e6\n1e7\n1 10 100 1000\nvi\nsc\nos\nity\n (P\na \ns)\ntime (s)\nExpt.: planar \/ 4\nExpt.: uniaxial \/ 3\nExpt.: shear\nQMSF: planar \/ 4\nQMSF: uniaxial \/ 3\nQMSF: shear\n1e4\n \n \n \n125\u00b0C \n \n \n \n \n \n \n 26\n1 10 100\nModel: KBKZ \nModel: LMSF \n1.0e4\n1.0e5\n1.0e6\nTr\nan\nsi\nen\nt p\nla\nna\nr e\nlo\nng\nat\nio\nna\nl v\nis\nco\nsi\nty\n (P\na \ns)\ntime (s)\nExperiment         +\nModel: QMSF \n \n \n \nFigure 6 Comparison between experimental data for planar elongational viscosity at \n0.05s-1 for IUPAC LDPE, and the QMSF, LMSF, and adapted KBKZ models \n \n \n \n 27\n 28\n \nFigure 7 Comparison of QMSF predictions for uniaxial elongational viscosity, shear \n1e3\n1e4\n1e5\n1e6\n1e7\n0.0001 0.001 0.01 0.1 1 10 100 1000\n S\nhe\nar\n(e\nlo\nng\nat\nio\nna\nl) \nvi\nsc\nos\nity\n  (\nP\na \ns)\n a\nnd\n N\n1 \n(P\na)\n1e2\n1e1\n \nviscosity, and N1 against experimental results for IUPAC LDPE at 150\u00b0C. Prediction \nfor planar elongational viscosity is also shown (dotted). The value for the single \nparameter f2max (=80.0) was obtained from transient data. \n \n \n \n \n \n \n \n \nFigure 8 Comparison of pressure contours in fully developed region of die slit.  \n(a) time-integral using (C-1 \u2013 I) h(I1, I2), (b) time-integral using Doi-Edwards tensor, \n(c) time-integral using QMSF tensor (strain hardening) \n 29\n164 \u2212= sa\u03b3&\n14 \u2212= sa\u03b3&\n116 \u2212= sa\u03b3&\nFigure 9 Vortex details for the QMSF model and for the adapted KBKZ m\nplanar contraction flow; contours are plotted at integer multiples of 0.1% \n  \nodel in \n30\n0\n5\n10\n15\n20\n25\n30\n35\n40\n45\n0.1 1 10 100\nApparent Shear Rate (s-1)\nO\npe\nni\nng\n A\nng\nle\n (d\neg\nre\nes\n) QMSF\nPSM\nAdapted KBKZ\n \nFigure 10  Comparison of opening angles obtained for three models in 8:1 planar \ncontraction flow \n \n 31\n0\n0.1\n0.2\n0.3\n0.4\n0.5\n0.6\n0.7\n0.8\n0.9\n1\n0.1 1 10 100\nApparent Shear Rate (s-1)\nVo\nrt\nex\n In\nte\nns\nity\n (%\n) QMSF\nPSM\nAdapted KBKZ\n \nFigure 11  Comparison of vortex intensity obtained for three models in 8:1 planar \ncontraction flow \n 32\n00.5\n1\n1.5\n2\n2.5\n3\n3.5\n4\n0.1 1 10 100\nApparent Shear Rate (s-1)\nCo\nrr\nec\ntio\nn \nP\nre\nss\nur\ne \n(-)\nQMSF\nPSM\nAdapted KBKZ\n \nFigure 12  Comparison of correction pressures obtained for three models in 8:1 planar \ncontraction flow \n 33\n0\n5\n10\n15\n20\n25\n30\n35\n40\n45\n50\n0.1 1 10 100\nApparent Shear Rate (s-1)\nO\npe\nni\nng\n A\nng\nle\n (d\neg\nre\nes\n)\nQMSF\nPSM\nAdapted KBKZ\n \nFigure 13  Comparison of opening angles obtained for three models in 4:1 \naxisymmetric contraction flow \n \n 34\n02\n4\n6\n8\n10\n12\n0.1 1 10 100\napparent shear rate (s-1)\nV\nor\nte\nx \nIn\nte\nns\nity\n (%\n)\nQMSF\nPSM\nAdapted KBKZ\n \nFigure 14  Comparison of vortex intensities obtained for three models in 4:1 \naxisymmetric contraction flow \n \n 35\n00.5\n1\n1.5\n2\n2.5\n3\n3.5\n4\n0.1 1 10 100\nApparent shear rate (s-1)\nCo\nrr\nec\ntio\nn \nP\nre\nss\nur\ne\nQMSF\nPSM\nAdapted KBKZ\n \nFigure 15  Comparison of correction pressures obtained for three models in 4:1 \naxisymmetric contraction flow \n \n 36\n"}