{"doi":"10.1215\/S0012-7094-04-12513-8","coreId":"65777","oai":"oai:dro.dur.ac.uk.OAI2:4820","identifiers":["oai:dro.dur.ac.uk.OAI2:4820","10.1215\/S0012-7094-04-12513-8"],"title":"On two geometric theta lifts.","authors":["Bruinier,  J.","Funke,  J."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2004-01-01","abstract":"The theta correspondence has been an important tool in studying cycles in locally symmetric spaces of orthogonal type. In this paper we establish for the orthogonal group O(p,2) an adjointness result between Borcherds's singular theta lift and the Kudla-Millson lift. We extend this result to arbitrary signature by introducing a new singular theta lift for O(p,q). On the geometric side, this lift can be interpreted as a differential character, in the sense of Cheeger and Simons, for the cycles under consideration","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/65777.pdf","fullTextIdentifier":"http:\/\/dro.dur.ac.uk\/4820\/1\/4820.pdf","pdfHashValue":"65c95dc0d0d6821d851b8e7fc29d52c0427218b6","publisher":"Duke University Press","rawRecordXml":"<record><header><identifier>\n  \n    \n      oai:dro.dur.ac.uk.OAI2:4820<\/identifier><datestamp>\n      2011-09-08T13:50:22Z<\/datestamp><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        On two geometric theta lifts.<\/dc:title><dc:creator>\n        Bruinier,  J.<\/dc:creator><dc:creator>\n         Funke,  J.<\/dc:creator><dc:description>\n        The theta correspondence has been an important tool in studying cycles in locally symmetric spaces of orthogonal type. In this paper we establish for the orthogonal group O(p,2) an adjointness result between Borcherds's singular theta lift and the Kudla-Millson lift. We extend this result to arbitrary signature by introducing a new singular theta lift for O(p,q). On the geometric side, this lift can be interpreted as a differential character, in the sense of Cheeger and Simons, for the cycles under consideration.<\/dc:description><dc:publisher>\n        Duke University Press<\/dc:publisher><dc:source>\n        Duke mathematical journal, 2004, Vol.125(1), pp.45-90 [Peer Reviewed Journal]<\/dc:source><dc:date>\n        2004-01-01<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:identifier>\n        dro:4820<\/dc:identifier><dc:identifier>\n        issn:0012-7094<\/dc:identifier><dc:identifier>\n        doi:10.1215\/S0012-7094-04-12513-8<\/dc:identifier><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/4820\/<\/dc:identifier><dc:identifier>\n        http:\/\/dx.doi.org\/10.1215\/S0012-7094-04-12513-8<\/dc:identifier><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/4820\/1\/4820.pdf<\/dc:identifier><dc:accessRights>\n        info:en-repo\/semantics\/openAccess<\/dc:accessRights><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["0012-7094","issn:0012-7094"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2004,"topics":[],"subject":["Article","PeerReviewed"],"fullText":"Durham Research Online\nDeposited in DRO:\n27 August 2008\nVersion of attached file:\nPublished Version\nPeer-review status of attached file:\nPeer-reviewed\nCitation for published item:\nBruinier, J. and Funke, J. (2004) \u2019On two geometric theta lifts.\u2019, Duke mathematical journal., 125 (1). pp.\n45-90.\nFurther information on publisher\u2019s website:\nhttp:\/\/dx.doi.org\/10.1215\/S0012-7094-04-12513-8\nPublisher\u2019s copyright statement:\nAdditional information:\nUse policy\nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without prior permission or charge, for\npersonal research or study, educational, or not-for-profit purposes provided that:\n\u2022 a full bibliographic reference is made to the original source\n\u2022 a link is made to the metadata record in DRO\n\u2022 the full-text is not changed in any way\nThe full-text must not be sold in any format or medium without the formal permission of the copyright holders.\nPlease consult the full DRO policy for further details.\nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom\nTel : +44 (0)191 334 3042 \u2014 Fax : +44 (0)191 334 2971\nhttp:\/\/dro.dur.ac.uk\n Use policy \n \nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without \nprior permission or charge, for personal research or study, educational, or not-for-profit purposes \nprovided that : \n \n\u0083 a full bibliographic reference is made to the original source \n\u0083 a link is made to the metadata record in DRO \n\u0083 the full-text is not changed in any way \n \nThe full-text must not be sold in any format or medium without the formal permission of the copyright \nholders.  \n \nPlease consult the full DRO policy for further details. \n \nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom \nTel : +44 (0)191 334 2975 | Fax : +44 (0)191 334 2971 \nhttp:\/\/dro.dur.ac.uk \nDurham Research Online \n Deposited in DRO:\n27 August 2008\nVersion of attached file:\nPublished\nPeer-review status of attached file:\nPeer-reviewed\nCitation for published item:\nBruinier, J. and Funke, J. (2004) 'On two geometric theta lifts.', Duke mathematicaljournal., 125 (1), pp.\u000045-90.\nFurther information on publisher\u0000s website:\nhttp:\/\/dx.doi.org\/10.1215\/S0012-7094-04-12513-8\nON TWO GEOMETRIC THETA LIFTS\nJAN HENDRIK BRUINIER and JENS FUNKE\nAbstract\nThe theta correspondence has been an important tool in studying cycles in locally\nsymmetric spaces of orthogonal type. In this paper we establish for the orthogonal\ngroup O(p, 2) an adjointness result between Borcherds\u2019s singular theta lift and the\nKudla-Millson lift. We extend this result to arbitrary signature by introducing a new\nsingular theta lift for O(p, q). On the geometric side, this lift can be interpreted as\na differential character, in the sense of Cheeger and Simons, for the cycles under\nconsideration.\nContents\n1. Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 45\n2. Basic notation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 50\n3. Weak Maass forms . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54\n4. Special Schwartz forms . . . . . . . . . . . . . . . . . . . . . . . . . . 64\n5. The theta lifts . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 70\n6. Main results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77\n7. The singular theta lift as a current . . . . . . . . . . . . . . . . . . . . 83\nReferences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 88\n1. Introduction\nBorcherds [B1] introduced a \u201csingular\u201d theta lift from modular forms of (typically)\nnegative weight for SL2(R) to the orthogonal group O(p, 2). This gave rise not only\nto remarkable product expansions of automorphic forms for O(p, 2) but also to the\nrealization of generating series of certain special divisors in locally symmetric spaces\nattached to O(p, 2) as holomorphic modular forms of positive weight (see [B2]). The\nBorcherds lift was generalized by Bruinier and studied in connection with the coho-\nmology of the special divisors (see [Br2], [Br1]).\nDUKE MATHEMATICAL JOURNAL\nVol. 125, No. 1, c\u00a9 2004\nReceived 17 March 2003. Revision received 7 November 2003.\n2000 Mathematics Subject Classification. Primary 11F27; Secondary 11F55, 14C25.\nBruinier\u2019s work supported by a Heisenberg-Stipendium of the Deutsche Forschungsgemeinschaft (German Re-\nsearch Foundation).\nFunke\u2019s work supported by the J. E. Marsden Postdoctoral Fellowship 2002\/2003 and by National Science Foun-\ndation grant number DMS-02-11133 at the Fields Institute, Toronto, Canada.\n45\n46 BRUINIER and FUNKE\nOn the other hand, the Weil representation and theta series have been used in a\nmore classical way by several people (e.g., [S], [O], [RS], [TW], [W]) to show that\ngenerating series of special cycles in orthogonal and unitary locally symmetric spaces\nof arbitrary signature are modular forms. In greatest generality this was done by Kudla\nand Millson (see, e.g., [KM4]).\nThe purpose of this paper is threefold.\n(1) For O(p, 2), we derive an adjointness result between the Kudla-Millson lift\nand the Borcherds lift.\n(2) We also introduce a new singular theta lift of Borcherds type for O(p, q) and\nobtain a similar relationship to the Kudla-Millson lift.\n(3) As a geometric application, we show that the exterior derivative of the current\ninduced by this singular theta lift is closely related to the delta current of a\nspecial cycle.\nWe sketch the main results of the paper in more detail.\nLet V be a quadratic space over Q of signature (p, q), and write D for the asso-\nciated symmetric space. Let L be an even lattice in V , let 0 be a finite index subgroup\nof the group of units of L , and let X = 0\\D be the associated locally symmetric\nspace. The special cycles arise from subsymmetric spaces of codimension q induced\nby embeddings of orthogonal groups of signature (p \u2212 1, q) into O(V ).\nTo simplify the exposition, we assume for now that L is unimodular. In the\nmain body of the paper, we treat the case of arbitrary level by using the setting of\nBorcherds\u2019s vector-valued modular forms. Moreover, for q odd, this is essential in\norder to obtain a nonzero theory.\nWe first introduce a new space of automorphic forms of (typically negative)\nweight k. Its importance lies in the fact that on the one hand we systematically treat\nthis space as the input space for both the Borcherds lift for O(p, 2) and its extension\nto O(p, q), while on the other hand it satisfies a duality with the space of holomor-\nphic cusp forms of (positive) weight 2 \u2212 k. This duality, interesting in its own right,\nis crucial for us.\nNamely, we let Hk be the space of weak Maass forms. This space consists of\nthe smooth functions f on the upper half-plane H which transform with weight k =\n2 \u2212 (p + q)\/2 under SL2(Z), are annihilated by the weight k Laplacian, and satisfy\nf (\u03c4 ) = O(eCv) as \u03c4 = u + iv \u2192 i\u221e for some constant C > 0. For f \u2208 Hk , put\n\u03bek( f ) = R\u2212k(vk f\u00af ), where R\u2212k is the standard raising operator for modular forms of\nweight\u2212k. We prove that \u03bek defines an antilinear map \u03bek : Hk \u2192 M !2\u2212k , where M !2\u2212k\nis the space of meromorphic modular forms of weight 2 \u2212 k which are holomorphic\nonH (see Prop. 3.2). It is easily checked that M !k is the kernel of \u03bek . We let H\n+\nk be the\npreimage of S2\u2212k , the space of cusp forms of weight 2\u2212 k.\nON TWO GEOMETRIC THETA LIFTS 47\nTHEOREM 1.1\nThe bilinear pairing between S2\u2212k and H+k , defined by\n{g, f } = (g, \u03bek( f ))2\u2212k\nfor g \u2208 S2\u2212k and f \u2208 H+k , induces a nondegenerate pairing of S2\u2212k and H+k \/M !k .\nHere ( , )2\u2212k is the Petersson scalar product for modular forms of weight 2\u2212 k.\nThe main point here is to show that the map \u03bek is surjective. The proof uses methods\nfrom complex geometry and is ultimately based on Serre duality. The pairing {g, f }\ncan be explicitly evaluated in terms of the Fourier coefficients of g and the singular\npart of f (Prop. 3.5). Note that Borcherds [B2] established a similar duality statement\n(in terms of formal power series).\nFor signature (p, 2), when D is Hermitian, we then introduce the Borcherds lift\nas a map on H+k ; that is, for any f \u2208 H+k , its lift is given by integrating f \u2208 H+k\nagainst 2(\u03c4, z, \u03d50) (\u03c4 = u + iv \u2208 H, z \u2208 D), the Siegel theta series attached to the\nstandard Gaussian \u03d50 on V (R) (see also [B1], [Br2]):\n8(z, f ) =\n\u222b reg\nSL2(Z)\\H\nf (\u03c4 )2(\u03c4, z, \u03d50)\ndu dv\nv2\n. (1.1)\nThe integral is usually divergent, and a suitable regularization was found by Har-\nvey and Moore [HM]. The regularization process leads to logarithmic singularities\nalong certain special cycles Z( f ) in D, which in this case are divisors. Moreover,\n3B(z, f ) := ddc8(z, f ) actually extends to a closed smooth (1, 1)-form on X . Here\nd and dc are the standard (exterior) differential operators on D. Hence we have a map\n3B : H+k \u2212\u2192 Z 2(X) (1.2)\nfrom H+k to the space of closed 2-forms on X . For f \u2208 M !k one has 3B( f ) =\na+(0), where a+(0) is the constant coefficient of f , and  is the suitably normal-\nized Ka\u00a8hler form on D.\nOn the other hand, Kudla and Millson [KM4] construct for general signature\n(p, q) a theta series 2(\u03c4, z, \u03d5KM ) associated to a certain Schwartz function \u03d5KM on\nV (R) taking values in Z q(X). Then for \u03b7 \u2208 Z (p\u22121)qc (X), the compactly supported\nclosed (p \u2212 1)q-forms on X , the Kudla-Millson lift is defined by\n3KM (\u03c4, \u03b7) =\n\u222b\nX\n\u03b7 \u22272(\u03c4, z, \u03d5KM ).\nIt turns out that 3KM (\u03c4, \u03b7) is actually a holomorphic modular form of weight 2\u2212 k,\nso that we have a map\n3KM : Z (p\u22121)qc (X) \u2212\u2192 M2\u2212k, (1.3)\n48 BRUINIER and FUNKE\nwhich also factors through cohomology. Moreover, the Fourier coefficients of 3KM\nare given by periods of \u03b7 over the special cycles.\nTHEOREM 1.2\nAssume that D is Hermitian, that is, assume that q = 2, and let f \u2208 H+k with constant\ncoefficient a+(0). We then have the following identity of closed 2-forms on X :\n3B(z, f ) =\n(\n2(\u03c4, z, \u03d5KM ), \u03bek( f )\n)\n2\u2212k + a+(0).\nTherefore the maps3B and3KM are naturally adjoint via the standard pairing ( , )X\nof Z 2p\u22122c (X) with Z 2(X) and the pairing { , } of M2\u2212k with H+k ; that is,(\n\u03b7,3B( f )\n)\nX = {3KM (\u03b7), f } + a+(0)(\u03b7,)X .\nFurthermore, this duality factors through cohomology and H+k \/M !k , respectively (see\nalso Th. 6.3).\nThis result is based on the fundamental relationship between the two theta series in-\nvolved.\nTHEOREM 1.3\nLet L2\u2212k be the lowering Maass operator of weight 2\u2212 k on H. Then\nL2\u2212k2(\u03c4, z, \u03d5KM ) = \u2212ddc2(\u03c4, z, \u03d50). (1.4)\nWe show this by switching to the Fock model of the Weil representation. Then the\nidea for the proof of Theorem 1.2 is given by the following formal (!) calculation:(\n2(\u03d5KM ), \u03bek( f )\n)\n2\u2212k \u201c=\u201d \u2212\n(\nL2\u2212k2(\u03d5KM ), vk f\u00af\n)reg\n\u2212k\n\u201c=\u201d (ddc2(\u03d50), vk f\u00af )reg\u2212k \u201c=\u201d ddc \u222b reg\nSL2(Z)\\H\n2(\u03d50) f\ndu dv\nv2\n.\nThe first equality would follow from the adjointness of the raising and lowering op-\nerators, except that the second scalar product no longer converges and needs to be\nregularized. At this point, one also obtains an error term involving the Ka\u00a8hler form.\nThe second equality follows from the key fact provided by Theorem 1.3, and the last\nequality by interchanging the integration and differentiation (which also needs careful\nconsideration). Additional difficulties occur in the intermediate steps, where one must\ndeal with singularities along the special divisors.\nAs an application, we are able to recover several of the geometric properties of\nthe Borcherds lift in [Br2], often with simpler proofs.\nON TWO GEOMETRIC THETA LIFTS 49\nFor general signature (p, q), the work of Kudla and Millson [KM4] shows that\nthere exists a theta function 2(\u03c4, z, \u03c8) taking values in the (q \u2212 1)-forms of X such\nthat\nL2\u2212k2(\u03c4, z, \u03d5KM ) = d2(\u03c4, z, \u03c8).\nThis is the exact analogue of the identity (1.4) in the Hermitian case. Hence for\nf \u2208 H+k we define a singular theta lift 8(z, f, \u03c8) by replacing 2(\u03c4, z, \u03d50) with\n2(\u03c4, z, \u03c8) in (1.1). Note that the image is no longer scalar valued but instead is a\n(q \u2212 1)-form with higher-order singularities along the special cycle Z( f ) (see Prop.\n5.6). The point is that although Borcherds introduces his lift for arbitrary signature\nand for general (scalar-valued) theta kernels, he focuses on the Hermitian case. In\nparticular, the geometric interpretation given in [B2] and [Br2] applies only to this\ncase. Hence from this aspect the lift 8(z, f, \u03c8) and its features are new. We put\n3\u03c8 (z, f ) = \u2212d8(z, f, \u03c8), and one sees that this again extends to a closed smooth\nq-form on M . Moreover, it essentially vanishes for f \u2208 M !k . One obtains the following\nas above (for a precise statement, see Th. 6.3).\nTHEOREM 1.4\nIn the case of signature (p, q), the lifts 3KM and 3\u03c8 are adjoint.\nThis construction of a singular theta lift for general signature does indeed lead to new\ninformation.\nTHEOREM 1.5\nLet f \u2208 H+k . Then 3\u03c8 (z, f ) is a harmonic representative of the Poincare\u00b4 dual class\nof the cycle Z( f ). Moreover, we have the following equality of currents:\nd[8(z, f, \u03c8)] + \u03b4Z( f ) = [3\u03c8 (z, f )].\nIn particular, the pair (Z( f ),8(z, f, \u03c8)) defines a differential character in the sense\nof Cheeger and Simons (see [C], [CS]). For q = 2, we have in addition for the\nBorcherds lift,\nddc[8(z, f )] + \u03b4Z( f ) = [3B(z, f )];\nthat is, 8(z, f ) is a Green\u2019s function for the divisor Z( f ).\nFor q = 2, the latter result already follows from [Br2] and [Br1]. We also briefly\ndiscuss the relationship of 8(z, f ) to Green\u2019s functions for the special divisors con-\nstructed by Oda and Tsuzuki [OT] and Kudla [K2], [K1].\nThe results of this paper are subject to several extensions and generalizations. On\nthe one hand, one should be able to introduce suitable singular theta lifts for unitary\ngroups since [KM4] covers these groups as well. This is of particular interest since\n50 BRUINIER and FUNKE\nin this case the symmetric spaces are Hermitian. In particular, such a lift should lead\nto the explicit construction of Green\u2019s currents for cycles on these spaces of complex\ncodimension q . On the other hand, Funke and Millson [FM1] have recently developed\na theory for special cycles with coefficients analogous to the Kudla-Millson lift. This\nalso should give rise to new singular theta lifts with geometric importance. On a more\nspeculative note, it is a very interesting problem to generalize the present results to\nspecial cycles of higher codimension. In the framework of this paper, one would need\nto define a suitable singular theta lift for the symplectic group Spn(R), and for this\none would need analogues of the space H+k and of Theorem 1.1. We hope to come\nback to these issues in the near future.\nThe paper is organized as follows. After setting up the basic notation in Section\n2, we discuss in Section 3 the space of weak Maass forms Hk in detail and prove\nTheorem 1.1. In Section 4, we consider in detail the Fock model of the Weil represen-\ntation and the Schwartz forms \u03d5KM and \u03c8 , and we derive Theorem 1.3. We discuss\nthe Kudla-Millson lift and the Borcherds lift in Section 5, introducing for general sig-\nnature the lift 8(z, f, \u03c8). Two of our main results, Theorems 1.2 and 1.4, are proved\nin Section 6. Finally, Theorem 1.5 is considered in Section 7.\n2. Basic notation\nLet V be a rational vector space over Q with a nondegenerate bilinear form ( , ) of\nsignature (p, q); we assume dim V \u2265 3. Let L be an even lattice in V (i.e., q(x) :=\n(x, x)\/2 \u2208 Z for x \u2208 L), and write L# for its dual. We write V\u2212 (resp., L\u2212) for the\nvector space V (resp., Z-module L) together with the bilinear form \u2212( , ).\nWe pick an orthogonal basis {vi } of V (R) = V \u2297Q R such that (v\u03b1, v\u03b1) = 1\nfor \u03b1 = 1, . . . , p and (v\u00b5, v\u00b5) = \u22121 for \u00b5 = p + 1, . . . , p + q. We denote the\ncorresponding coordinates by xi . Throughout the paper we use the subscript \u03b1 for the\n\u201cpositive\u201d variables and \u00b5 for the \u201cnegatives\u201d ones. We realize the symmetric space\nassociated to V as the set of negative q-planes in V (R):\nD ' {z \u2282 V (R); dim z = q and ( , )|z < 0}.\nOccasionally, we write Dp,q to emphasize the signature. The assignment z 7\u2192 z\u22a5\ngives the identification Dp,q ' Dq,p.\nWe have D ' G\/K with G = SO0(V (R)), the connected component of the\northogonal group, and with K , the maximal compact subgroup of G stabilizing z0 =\nspan{v\u00b5; p + 1 \u2264 \u00b5 \u2264 p + q}.\nFor z \u2208 D, we associate the standard majorant ( , )z given by\n(x, x)z = (xz\u22a5, xz\u22a5)\u2212 (xz, xz),\nwhere x = xz+xz\u22a5 \u2208 V (R) is given by the orthogonal decomposition V (R) = z\u2295z\u22a5.\nON TWO GEOMETRIC THETA LIFTS 51\nLet g be the Lie algebra of G, and let g = p+k be its Cartan decomposition. Then\np ' g\/k is isomorphic to the tangent space at the base point of D, and with respect to\nthe above basis of V (R) we have\np '\n{(\n0 X\nt X 0\n)\n; X \u2208 Mp,q(R)\n}\n' Mp,q(R). (2.1)\nFor q = 2, it is well known that D is Hermitian, and we assume that the complex\nstructure on p is given by right multiplication with J = ( 0 1\u22121 0 ).\nLet 0 \u2282 G be a congruence subgroup of the orthogonal group of L fixing the\ndiscriminant lattice L#\/L , and let X = 0\\D be the associated locally symmetric\nspace. Throughout we assume that 0 is torsion free such that 0 acts freely on D, and\nX is a real analytic manifold of dimension pq. Observe that, for instance, the principal\ncongruence subgroup 0(N ) of level N (of the discriminant kernel of O(L)), that is,\nthe kernel of the natural homomorphism O(L) \u2192 O((L#\/N )\/L), is torsion free for\nN \u2265 3 (which is seen similarly as [Fr, Chap. II.6, Hilfssatz 6.5]).\nFor x \u2208 V (R) with q(x) > 0, we let\nDx = {z \u2208 D; z \u22a5 x}.\nNote that Dx is a subsymmetric space of type Dp\u22121,q attached to the orthogonal\ngroup Gx , the stabilizer of x in G. Put 0x = 0 \u2229 Gx . Then for x \u2208 L#, the quotient\nZ(x) = 0x\\Dx \u2212\u2192 X\ndefines an (in general, relative) cycle in X . For h \u2208 L#\/L and n \u2208 Q, the group 0\nacts on Lh,n = {x \u2208 L + h; q(x) = n} with finitely many orbits, and we define the\ncomposite cycle\nZ(h, n) =\n\u2211\nx\u22080\\Lh,n\nZ(x).\nOccasionally, we identify Z(h, n) with its preimage in D.\nBorcherds [B2] and Bruinier [Br2] (for O(2, p)) use vectors of negative length to\ndefine special cycles (which are divisors in that case); by switching to the space V\u2212,\nthese are the same as the divisors for Dp,2 defined above by vectors of positive length.\nWe orient D and the cycles Dx as in [KM4, pp. 130 \u2013 131]. Note that for q even,\nDx and D\u2212x have the same orientation, while for q odd, the opposite. Moreover, for\nq = 2, this orientation coincides with the orientation given by the complex structure\non D and Dx .\nLet G \u2032 = Mp2(R) be the twofold cover of SL2(R), realized by the two choices\nof holomorphic square roots of \u03c4 7\u2192 j (g, \u03c4 ) = c\u03c4 + d; here \u03c4 \u2208 H = {w \u2208\nC; =(w) > 0}, the upper half-plane, and g = ( a bc d ) \u2208 SL2(R). Therefore elements of\nMp2(R) are of the form (g, \u03c6(\u03c4 )) with g \u2208 SL2(R) and \u03c6(\u03c4) a holomorphic function\n52 BRUINIER and FUNKE\nsuch that \u03c6(\u03c4)2 = j (g, \u03c4 ). The multiplication is given by (g1, \u03c61(\u03c4 ))(g2, \u03c62(\u03c4 )) =\n(g1g2, \u03c61(g2\u03c4)\u03c62(\u03c4 )), where SL2(R) acts on H by linear fractional transformations.\nFor z = rei\u03b8 \u2208 C\u00d7 with \u03b8 \u2208 (\u2212pi, pi] and r positive, we take\u221az = z1\/2 = r1\/2ei\u03b8\/2.\nOccasionally, we just write g for (g,\n\u221a\nj (g, \u03c4 )) \u2208 G \u2032.\nWe write K \u2032 for the inverse image of SO(2) ' U(1) under the covering map\nMp2(R) \u2212\u2192 SL2(R). Note that for k\u03b8 \u2208 SO(2) with k\u03b8 =\n( cos(\u03b8) sin(\u03b8)\n\u2212 sin(\u03b8) cos(\u03b8)\n)\n(\u03b8 \u2208\n(\u2212pi, pi]), we obtain a character of K \u2032 by the assignment\n\u03c71\/2 :\n(\nk\u03b8 ,\u00b1\n\u221a\nj (k\u03b8 , \u03c4 )\n) 7\u2192 \u00b1\u221a j (k\u03b8 , i)\u22121 = \u00b1ei\u03b8\/2.\nWe denote by \u03c9 = \u03c9V the Schro\u00a8dinger model of the (restriction of the) Weil\nrepresentation of G \u2032\u00d7O(V (R)) acting onS (V (R)), the space of Schwartz functions\non V (R). We have\n\u03c9(g)\u03d5(x) = \u03d5(g\u22121x)\nfor \u03d5 \u2208 S (V (R)) and g \u2208 O(V (R)). The action of G \u2032 is given as follows:\n\u03c9\n(\nm(a)\n)\n\u03d5(x) = a(p+q)\/2\u03d5(ax)\nfor a > 0 and with m(a) =\n(\na 0\n0 a\u22121\n)\n;\n\u03c9\n(\nn(b)\n)\n\u03d5(x) = epi ib(x,x)\u03d5(x)\nwith n(b) = ( 1 b0 1 ); and\n\u03c9(S)\u03d5(x) = \u221ai q\u2212p\u03d5\u02c6(\u2212x)\nwith S = (( 0 \u221211 0 ) ,\u221a\u03c4), and where \u03d5\u02c6(y) = \u222bV (R) \u03d5(x)e2pi i(x,y) dx is the Fourier\ntransform. If p+ q is even, (1, t) \u2208 G \u2032 acts trivially, otherwise by multiplication by t .\nFor \u03d5 \u2208 S (V (R)) and h \u2208 L#\/L , we define the theta function\n\u03b8(g\u2032, \u03d5, h) =\n\u2211\n\u03bb\u2208L+h\n\u03c9(g\u2032)\u03d5(\u03bb) (g\u2032 \u2208 G \u2032).\nWe write 0\u2032 for the inverse image of SL2(Z) in Mp2(R). For the generators S and\nT = (n(1), 1) of 0\u2032, we then have\n\u03b8(Tg\u2032, \u03d5, h) = epi i(h,h)\u03b8(g\u2032, \u03d5, h) (2.2)\nand, by Poisson summation,\n\u03b8(Sg\u2032, \u03d5, h) =\n\u221a\ni\nq\u2212p\u221a|L#\/L| \u2211\nh\u2032\u2208L#\/L\ne\u22122pi i(h,h\u2032)\u03b8(g\u2032, \u03d5, h\u2032). (2.3)\nON TWO GEOMETRIC THETA LIFTS 53\nEquations (2.2) and (2.3) define a representation %L of 0\u2032 acting on the group algebra\nC[L#\/L], whose standard basis elements we denote by eh , h \u2208 L#\/L . We introduce\nthe vector\n2(g\u2032, \u03d5, L) := (\u03b8(g\u2032, \u03d5, h))h\u2208L#\/L = \u2211\nh\u2208L#\/L\n\u03b8(g\u2032, \u03d5, h)eh,\nand we see\n2(\u03b3 g\u2032, \u03d5, L) = %L(\u03b3 )2(g\u2032, \u03d5, L)\nfor all \u03b3 \u2208 0\u2032. Note that with respect to the standard scalar product \u3008 , \u3009 on C[L#\/L]\n(linear in the first and antilinear in the second variable), we have %L\u2212 = %\u2217L = %\u00afL ;\nthat is, L and L\u2212 give rise to dual representations. From (2.2) and (2.3) it is clear that\n%L coincides with the representation %L considered in [B1] and [Br2]. Ultimately, %L\ngoes back to Shintani [S], which is also a good reference for the above discussion.\nLet \u03d5 now be an eigenfunction under the action of K \u2032; that is, \u03c9(k\u03b8 )\u03d5 =\n\u03c7r1\/2(k\u03b8 )\u03d5 for some r \u2208 Z, so that\n2(g\u2032k\u03b8 , \u03d5, L) = \u03c7r1\/2(k\u03b8 )2(g\u2032, \u03d5, L).\nThen we can associate to 2(g\u2032, \u03d5, L) a (vector-valued) function on the upper half-\nplane in the usual way: We let g\u2032\u03c4 =\n(\n1 u\n0 1\n) (\nv1\/2 0\n0 v\u22121\/2\n)\nwith \u03c4 = u + iv \u2208 H be the\nstandard element moving the base point i \u2208 H to \u03c4 , and we define\n2(\u03c4, \u03d5, L) := j (g\u2032\u03c4 , i)r\/22(g\u2032\u03c4 , \u03d5, L) =\n\u2211\nh\u2208L#\/L\n\u2211\n\u03bb\u2208L+h\n\u03d5(\u03bb, \u03c4, z)eh\nwith\n\u03d5(\u03bb, \u03c4, z) = j (g\u2032\u03c4 , i)r\/2\u03c9(g\u2032\u03c4 )\u03d5(\u03bb).\nHence, for (\u03b3, \u03c6) \u2208 0\u2032,\n2(\u03b3 \u03c4, \u03d5, L) = \u03c6(\u03c4)r%L(\u03b3, \u03c6)2(\u03c4, \u03d5, L); (2.4)\nthat is,2(\u03c4, \u03d5, L) is a C\u221e-automorphic form of weight r\/2 with respect to the repre-\nsentation %L . (Note, however, that it is usually not an eigenfunction of the Laplacian.)\nWe denote the real analytic functions onH satisfying the transformation property\n(2.4) with weight k by Ak,L .\nFrom now on we frequently drop the lattice L from the argument of 2(g\u2032, \u03d5, L).\nThe space of K -invariant Schwartz functionsS (V (R))K is of particular interest\nas we have\nS\n(\nV (R)\n)K ' [S (V (R))\u2297 C\u221e(D)]G,\nwhere the isomorphism is given by evaluation at the base point z0 of D. Note that for\nsuch \u03d5(x, z) \u2208 [S (V (R))\u2297 C\u221e(D)]G , the theta function 2(g\u2032, z, \u03d5) is 0-invariant\nas a function of z; hence it descends to a function on X .\n54 BRUINIER and FUNKE\nThe Gaussian on V (R) is given by \u03d50(x) = e\u2212pi\n\u2211p+q\ni=1 x2i . Certainly \u03d50 \u2208\nS (V (R))K , and the corresponding function in [S (V (R))\u2297 C\u221e(D)]G is given by\n\u03d50(x, z) = e\u2212pi(x,x)z .\nOccasionally, we write \u03d5 p,q0 to emphasize the signature. We have\n2(\u03c4, z, \u03d50) =\n\u2211\nh\u2208L#\/L\n\u2211\n\u03bb\u2208L+h\n\u03d50(\u03bb, \u03c4, z)eh \u2208 A(p\u2212q)\/2,L \u2297 C\u221e(X)\nand\n\u03d50(\u03bb, \u03c4, z) = vq\/2 exp\n(\npi i((\u03bb, \u03bb)u + (\u03bb, \u03bb)ziv)\n)\n= vq\/2 exp (pi i((\u03bbz\u22a5, \u03bbz\u22a5)\u03c4 + (\u03bbz, \u03bbz)\u03c4\u00af )).\n3. Weak Maass forms\nIn this section we introduce a new space of Maass wave forms. In particular, we es-\ntablish a pairing with holomorphic modular forms and obtain a duality theorem for\nthis pairing. The results of this section can be viewed either as an analytic version of\nthe Serre duality result in [B2, Sec. 3] or as an algebraic approach to [Br2, Chap. 1].\nLet k \u2208 (1\/2)Z with k 6= 1. (In our later applications k will be smaller than 1.\nHowever, we do not need that here.) Moreover, let 0\u2032\u2032 \u2264 0\u2032 be a subgroup of finite\nindex.\nWe write Hk,L(0\u2032\u2032) for the space of weak Maass forms of weight k with repre-\nsentation %L for the group 0\u2032\u2032. By definition, this is the space of twice continuously\ndifferentiable functions f : H\u2192 C[L#\/L] satisfying the following:\n(i) f (\u03b3 \u03c4) = \u03c6(\u03c4)2k%L(\u03b3, \u03c6) f (\u03c4 ) for all (\u03b3, \u03c6) \u2208 0\u2032\u2032;\n(ii) there is a C > 0 such that for any cusp s \u2208 Q \u222a {\u221e} of 0\u2032\u2032 and (\u03b4, \u03c6) \u2208 0\u2032\nwith \u03b4\u221e = s, the function fs(\u03c4 ) = \u03c6(\u03c4)\u22122k%\u22121L (\u03b4, \u03c6) f (\u03b4\u03c4 ) satisfies fs(\u03c4 ) =\nO(eCv) as v\u2192\u221e (uniformly in u, where \u03c4 = u + iv);\n(iii) 1k f (\u03c4 ) = 0, where\n1k = \u2212v2\n( \u22022\n\u2202u2\n+ \u2202\n2\n\u2202v2\n)\n+ ikv\n( \u2202\n\u2202u\n+ i \u2202\n\u2202v\n)\n(3.1)\ndenotes the usual hyperbolic Laplace operator in weight k.\nSince 1k is an elliptic differential operator, such a function f is automatically\nreal analytic. We mainly work with the full group 0\u2032, and therefore we abbreviate\nHk,L = Hk,L(0\u2032). The transformation property (i) implies that any f \u2208 Hk,L has a\nFourier expansion\nf (\u03c4 ) =\n\u2211\nh\u2208L#\/L\n\u2211\nn\u2208Q\na(h, n; v)e(nu)eh,\nON TWO GEOMETRIC THETA LIFTS 55\nwhere e(u) = e2pi iu , as usual. The coefficients a(h, n; v) vanish unless n \u2212\nq(h) \u2208 Z. In particular, the denominators of the indices n of all nonzero co-\nefficients a(h, n; v) are bounded by the level N of the lattice L . Since the ele-\nment Z = ((\u22121 00 \u22121 ), i) of 0\u2032 acts by %L(Z)eh = iq\u2212pe\u2212h , we have the relation\na(h, n; v) = (\u22121)k+(q\u2212p)\/2a(\u2212h, n; v). This implies that any weak Maass form in\nHk,L vanishes if 2k 6\u2261 p \u2212 q (mod 2).\nBecause of property (iii), the coefficients a(h, n; v) satisfy the second-order dif-\nferential equation 1ka(h, n; v)e(nu) = 0 as functions in v. If n = 0, one finds that\na(h, 0; v) is a linear combination of 1 and v1\u2212k . If n 6= 0, then, writing b(2pinv) for\na(h, n; v), it is easily seen that b(w) is a solution of the second-order linear differen-\ntial equation\n\u22022\n\u2202w2\nb(w)\u2212 b(w)+ k\nw\n( \u2202\n\u2202w\nb(w)+ b(w)\n)\n= 0,\nwhich is independent of h and n. It is immediately checked that e\u2212w is a solution.\nA second, linearly independent solution is found by reduction of the order. Here we\nchoose the function\nH(w) = e\u2212w\n\u222b \u221e\n\u22122w\ne\u2212t t\u2212k dt.\nThe integral converges for k < 1 and can be holomorphically continued in k (for\nw 6= 0) in the same way as the Gamma function. If w < 0, then H(w) = e\u2212w0(1\u2212\nk,\u22122w), where 0(a, x) denotes the incomplete Gamma function as in [AS, (6.5.3)].\nThe function H(w) has the asymptotic behavior\nH(w) \u223c\n{\n(2|w|)\u2212ke\u2212|w| for w\u2192\u2212\u221e,\n(\u22122w)\u2212kew for w\u2192+\u221e.\n(Clearly, the functions |w|k\/2e\u2212w\/2 and |w|k\/2H(w\/2) are the special values of the\nstandard Whittaker functions W\u03bd,\u00b5(|w|) and M\u03bd,\u00b5(|w|) for \u03bd = sgn(n)k\/2, \u00b5 =\nk\/2\u2212 1\/2 as in [AS, Chap. 13].) We find that\na(h, n; v) =\n{\na+(h, 0)+ a\u2212(h, 0)v1\u2212k if n = 0,\na+(h, n)e\u22122pinv + a\u2212(h, n)H(2pinv) if n 6= 0,\nwith complex coefficients a\u00b1(h, n). Thus any weak Maass form f of weight k has a\nunique decomposition f = f + + f \u2212, where\nf +(\u03c4 ) =\n\u2211\nh\u2208L#\/L\n\u2211\nn\u2208Q\na+(h, n)e(n\u03c4)eh, (3.2a)\nf \u2212(\u03c4 ) =\n\u2211\nh\u2208L#\/L\n(\na\u2212(h, 0)v1\u2212k +\n\u2211\nn\u2208Q\nn 6=0\na\u2212(h, n)H(2pinv)e(nu)\n)\neh . (3.2b)\n56 BRUINIER and FUNKE\nNote that if f satisfies condition (ii) above, then all but finitely many a+(h, n) (resp.,\na\u2212(h, n)) with negative (resp., positive) index n vanish.\nLet us briefly recall the Maass raising and lowering operators on nonholomorphic\nmodular forms of weight k. They are defined as the differential operators\nRk = 2i \u2202\n\u2202\u03c4\n+ kv\u22121 and Lk = \u22122iv2 \u2202\n\u2202\u03c4\u00af\n.\nThe raising operator Rk maps Ak,L to Ak+2,L , and the lowering operator Lk maps\nAk,L to Ak\u22122,L . The Laplacian 1k can be expressed in terms of Rk and Lk by\n\u22121k = Lk+2Rk + k = Rk\u22122Lk . (3.3)\nThe following lemma is proved by a straightforward computation.\nLEMMA 3.1\nLet f \u2208 Hk,L be a weak Maass form of weight k, and write f = f ++ f \u2212 as in (3.2).\nThen\nLk f = Lk f \u2212\n= \u22122v2\u2212k\n\u2211\nh\u2208L#\/L\n(\n(k \u2212 1)a\u2212(h, 0)+\n\u2211\nn\u2208Q\nn 6=0\na\u2212(h, n)(\u22124pin)1\u2212ke(n\u03c4\u00af )\n)\neh .\nWe write M !k,L(0\u2032\u2032) for the space of holomorphic C[L#\/L]-valued functions on H\nsatisfying the transformation property (i) above and being meromorphic at the cusps\nof 0\u2032\u2032. We call such modular forms weakly holomorphic. Identity (3.3) implies that\nM !k,L(0\u2032\u2032) \u2282 Hk,L(0\u2032\u2032). If we also require holomorphicity (vanishing) at the cusp,\nwe obtain the space of holomorphic modular forms Mk,L(0\u2032\u2032) (cusp forms Sk,L(0\u2032\u2032)).\nFinally, if 0\u2032\u2032 is the full modular group 0\u2032, then we briefly write M !k,L , Mk,L , and Sk,L\nfor these spaces of modular forms. They were first considered by Borcherds in [B1]\nand later in [Br2].\nThe lattice L\u2212 gives rise to the dual representation %\u2217L = %\u00afL . Hence we can\nconsider Ak,L\u2212 , and so on, also as the space of modular forms with respect to the dual\nrepresentation %\u2217L of %L . We make frequent use of this fact.\nRecall that the Petersson scalar product on Mk,L is given by\n( f, g)k,L =\n\u222b\n0\u2032\\H\n\u3008 f, g\u3009vk d\u00b5 (3.4)\nfor f, g \u2208 Mk,L whenever the integral converges absolutely. Here d\u00b5 = v\u22122 du dv\ndenotes the usual invariant volume form on H.\nON TWO GEOMETRIC THETA LIFTS 57\nPROPOSITION 3.2\nThe assignment f (\u03c4 ) 7\u2192 \u03bek( f )(\u03c4 ) := vk\u22122Lk f (\u03c4 ) = R\u2212kvk f (\u03c4 ) defines an antilin-\near mapping\n\u03bek : Hk,L \u2212\u2192 M !2\u2212k,L\u2212 . (3.5)\nIts kernel is M !k,L \u2282 Hk,L .\nProof\nBy Lemma 3.1, the function \u03bek( f )(\u03c4 ) is holomorphic on H. It vanishes if and only\nif f \u2212 vanishes. It is meromorphic at the cusp via the growth condition on f . The\ntransformation behavior of \u03bek( f )(\u03c4 ) is easily checked.\nWe let H+k,L denote the inverse image of the space of holomorphic cusp forms S2\u2212k,L\u2212\nunder the mapping \u03bek . Hence, if f \u2208 H+k,L , then the Fourier coefficients a\u2212(h, n)\nwith nonnegative index n vanish, so f \u2212 is rapidly decreasing for v \u2192 \u221e. Clearly,\nM !k,L \u2282 H+k,L . Moreover, if k \u2265 2, then f \u2212 vanishes for all f \u2208 H+k,L .\nNow let f \u2208 Hk,L , and write its Fourier expansion as in (3.2). Then we call the\nFourier polynomial\nP( f )(\u03c4 ) =\n\u2211\nh\u2208L#\/L\n\u2211\nn\u2208Q\nn\u22640\na+(h, n)e(n\u03c4)eh (3.6)\nthe principal part of f . Observe that if f \u2208 H+k,L , then f \u2212 P( f ) is exponentially\ndecreasing as v\u2192\u221e. (This property could actually be used to define the space H+k,L\nin an alternative way.)\nLEMMA 3.3\nIf f \u2208 Hk,L , then there is a constant C > 0 such that f (\u03c4 ) = O(eC\/v) as v \u2192 0,\nuniformly in u.\nProof\nThis follows from the transformation behavior and the growth of f in the same way\nas the analogous statement for holomorphic modular forms.\nLater, we need the following growth estimate for the Fourier coefficients of weak\nMaass forms.\nLEMMA 3.4\nLet f \u2208 Hk,L , and write its Fourier expansion as in (3.2). Then there is a constant\n58 BRUINIER and FUNKE\nC > 0 such that the Fourier coefficients satisfy\na+(h, n) = O(eC\n\u221a|n|), n \u2192+\u221e,\na\u2212(h, n) = O(eC\n\u221a|n|), n \u2192\u2212\u221e.\nIf f \u2208 H+k,L , then the a\u2212(h, n) actually satisfy the stronger bound a\u2212(h, n) =\nO(|n|k\/2) as n \u2192\u2212\u221e.\nProof\nTo prove the asymptotic for a\u2212(h, n), we consider the weakly holomorphic modular\nform \u03bek( f ) \u2208 M !2\u2212k,L\u2212 . By Lemma 3.1 and the formula for the Fourier coefficients,\nwe have\n2a\u2212(h, n)(\u22124pin)1\u2212k = \u2212\n\u222b 1\n0\n\u2329\nvk\u22122Lk f (\u03c4 ), eh\n\u232a\ne(n\u03c4) du. (3.7)\nThus, according to Lemma 3.3, we get\na\u2212(h, n)\u001c |n|k\u22121\n\u222b 1\n0\neC\/ve\u22122pinv du\nfor all positive 0 < v \u2264 1 with some positive constant C (independent of v and n). If\nwe take v equal to 1\/\n\u221a|n|, we see that\na\u2212(h, n)\u001c |n|k\u22121eC\n\u221a|n|e2pi\n\u221a|n|\nfor all n < 0, proving the first assertion on the a\u2212(h, n).\nFrom \u03bek( f ) \u2208 M !2\u2212k,L\u2212 it can be deduced that the individual functions f + and\nf \u2212 in the splitting f = f + + f \u2212 also satisfy the estimate of Lemma 3.3. We may\napply the above argument to\na+(h, n) =\n\u222b 1\n0\n\u2329\nf +(\u03c4 ), eh\n\u232a\ne(\u2212n\u03c4) du (3.8)\nto derive the estimate for the a+(n, h) as n \u2192+\u221e.\nIf f \u2208 H+k,L , then \u03bek( f ) \u2208 S2\u2212k,L\u2212 is a holomorphic cusp form. Hence the\nusual Hecke bound for the Fourier coefficients of cusp forms implies that the left-\nhand side of (3.7) is bounded by some constant times |n|1\u2212k\/2 for all n < 0. Thus\na\u2212(h, n) = O(|n|k\/2) as n \u2192\u2212\u221e.\nThe estimates of Lemma 3.4 are far from being optimal. However, they are sufficient\nfor our purposes. Observe that all the above results have obvious generalizations to\nfinite index subgroups 0\u2032\u2032 \u2264 0\u2032.\nON TWO GEOMETRIC THETA LIFTS 59\nPut \u03ba = 2 \u2212 k. We now define a bilinear pairing between the spaces M\u03ba,L\u2212 and\nH+k,L by putting\n{g, f } = (g, \u03bek( f ))\u03ba,L\u2212 (3.9)\nfor g \u2208 M\u03ba,L\u2212 and f \u2208 H+k,L .\nPROPOSITION 3.5\nLet g \u2208 M\u03ba,L\u2212 with Fourier expansion g =\n\u2211\nh,n b(h, n)e(n\u03c4)eh , and let f \u2208 H+k,L\nwith Fourier expansion as in (3.2). Then the pairing (3.9) of g and f is determined\nby the principal part of f . It is equal to\n{g, f } =\n\u2211\nh\u2208L#\/L\n\u2211\nn\u22640\na+(h, n)b(h,\u2212n). (3.10)\nProof\nWe begin by noticing that \u3008g, f \u3009 d\u03c4 is a 0\u2032-invariant 1-form on H. We have\nd\n(\u3008g, f \u3009 d\u03c4) = \u2202\u00af(\u3008g, f \u3009 d\u03c4) = \u2329g, \u2202\n\u2202\u03c4\u00af\nf\n\u232a\nd \u03c4\u00af d\u03c4 = \u2212\u3008g, Lk f \u3009 d\u00b5.\nHence, by Stokes\u2019s theorem, we get\u222b\nFt\n\u3008g, Lk f \u3009 d\u00b5 = \u2212\n\u222b\n\u2202Ft\n\u3008g, f \u3009 d\u03c4 =\n\u222b 1\/2\n\u22121\/2\n\u2329\ng(u + i t), f (u + i t)\u232a du,\nwhere\nFt =\n{\n\u03c4 \u2208 H; |\u03c4 | \u2265 1, |u| \u2264 1\n2\n, and v \u2264 t\n}\n(3.11)\ndenotes the truncated fundamental domain for the action of SL2(Z) on H. In the last\nline we have used the invariance of \u3008g, f \u3009 d\u03c4 . If we insert the Fourier expansions of\nf and g, we see that the integral over u picks out the zeroth Fourier coefficient of\n\u3008g, f \u3009. Thus \u222b\nFt\n\u3008g, Lk f \u3009 d\u00b5 =\n\u2211\nh\n\u2211\nn\u22640\na+(h, n)b(h,\u2212n)+ O(e\u2212\u03b5t )\nfor some \u03b5 > 0. We finally obtain\n{g, f } = lim\nt\u2192\u221e\n\u222b\nFt\n\u3008g, Lk f \u3009 d\u00b5 =\n\u2211\nh\u2208L#\/L\n\u2211\nn\u22640\na+(h, n)b(h,\u2212n),\nas asserted.\n60 BRUINIER and FUNKE\nObserve that the definition of the pairing (3.9) immediately implies that {g, f } = 0\nfor all f \u2208 M !k,L .\nBy (3.10), we get nontrivial relations among the coefficients of modular forms\nin M\u03ba,L\u2212 . These are also easily obtained by means of the residue theorem on the\nRiemann sphere. Moreover, it is clear that {g, f } = 0 for all Eisenstein series g \u2208\nM\u03ba,L\u2212 . This fact can be used to determine the constant term of a weak Maass form\nf \u2208 H+k,L in terms of the coefficients with negative index: For instance, if k < 0 and\na \u2208 C[L#\/L] satisfies both %L(T )a = a and %L(Z)a = i\u22122ka, then there is a unique\nEisenstein series Ea \u2208 M\u03ba,L\u2212 whose constant term is equal to a. The pairing {Ea, f }\ngives a formula for the scalar product in C[L#\/L] of the constant term of f and a\u00af.\nTHEOREM 3.6\nThe pairing between the quotient H+k,L\/M !k,L and S\u03ba,L\u2212 induced by (3.9) is nondegen-\nerate.\nIt suffices to show that the mapping \u03bek : H+k,L \u2192 S\u03ba,L\u2212 is surjective. This is an\nimmediate consequence of the following.\nTHEOREM 3.7\nThe mapping \u03bek : Hk,L \u2192 M !\u03ba,L\u2212 defined in Proposition 3.2 is surjective.\nBefore beginning the proof, we need to introduce some notation.\nLet 0\u2032\u2032 \u2264 0\u2032 be a normal subgroup of finite index. We write X (0\u2032\u2032) for the\ncompact modular curve corresponding to 0\u2032\u2032, and we write pi : H \u2192 X (0\u2032\u2032) for the\ncanonical map. The Poincare\u00b4 metric 1\/v2 on H induces a Ka\u00a8hler metric on X (0\u2032\u2032)\n(with logarithmic singularities at the cusps). We write \u2217 for the corresponding Hodge\nstar operator.\nWe denote the sheaf of holomorphic functions (resp., 1-forms) on X (0\u2032\u2032) by O\n(resp., ), and we denote the sheaf of smooth differential forms of type (p, q) by\nE p,q . If D is a divisor on X (0\u2032\u2032), then we write OD for the sheaf corresponding to\nD. The sections of OD over an open subset U \u2282 X (0\u2032\u2032) are given by meromorphic\nfunctions f satisfying div( f ) \u2265 \u2212D on U .\nIf L is any O-module on X (0\u2032\u2032), we let E p,q(U,L ) denote the L -valued\nsmooth differential forms on an open set U \u2282 X (0\u2032\u2032), that is, the sections of\nE p,q \u2297O L over U . Moreover, we write Lk,L for the O-module sheaf of modu-\nlar forms of weight k with representation %L on X (0\u2032\u2032). If U \u2282 X (0\u2032\u2032) is open,\nthen the sections Lk,L(U ) are holomorphic C[L#\/L]-valued functions on the open\nsubset pi\u22121(U ) \u2282 H satisfying the transformation law of modular forms of weight\nk with representation %L for 0\u2032\u2032, and being holomorphic at the cusps. If 0\u2032\u2032 acts\nON TWO GEOMETRIC THETA LIFTS 61\nfreely on H, then Lk,L is a holomorphic vector bundle. A Hermitian metric (with\nlogarithmic singularities at the cusps) on it is given by the Hermitian scalar product\n( f, g)\u03c4 = \u3008 f, g\u3009vk on the fiber over pi(\u03c4), where \u03c4 = u + iv \u2208 H and \u3008 f, g\u3009 denotes\nthe standard scalar product on C[L#\/L] as before.\nThe dual vector bundle L \u2217k,L of Lk,L can be identified with the vector bundle\nL\u2212k,L\u2212 of modular forms of weight \u2212k with representation %\u2217L on X (0\u2032\u2032). The map-\nping f 7\u2192 vk f\u00af defines an antilinear bundle isomorphismLk,L \u2192 L \u2217k,L . It induces a\nHodge star operator\n\u2217\u00afL : E p,q \u2297O Lk,L \u2212\u2192 E 1\u2212p,1\u2212q \u2297O L \u2217k,L , \u2217\u00afL (\u03c6 \u2297 f ) = (\u2217\u03c6\u00af)\u2297 (vk f\u00af ),\nonLk,L -valued smooth differential forms on X (0\u2032\u2032) (see [We, Chap. V.2]). It is easily\nverified that\n\u2217\u00afL ( f ) = vk\u22122 f\u00af du dv for f \u2208 E 0,0(U,Lk,L), (3.12a)\n\u2217\u00afL ( f d\u03c4) = ivk f\u00af d \u03c4\u00af for f d\u03c4 \u2208 E 1,0(U,Lk,L), (3.12b)\n\u2217\u00afL ( f\u00af d \u03c4\u00af ) = ivk f d\u03c4 for f\u00af d \u03c4\u00af \u2208 E 0,1(U,Lk,L). (3.12c)\nThe Laplace operator on differential forms in E p,q(U,Lk,L) is given by\n2 = \u2202\u00af \u2217\u00afL \u2202\u00af \u2217\u00afL + \u2217\u00afL \u2202\u00af \u2217\u00afL \u2202\u00af .\nBy a straightforward computation using (3.12), it can be shown that\n2 f = \u2217\u00afL \u2202\u00af \u2217\u00afL \u2202\u00af f = Rk\u22122Lk f = \u22121k f (3.13)\nfor functions f \u2208 E 0,0(U,Lk,L).\nProof of Theorem 3.7\nLet 0\u2032\u2032 \u2264 0\u2032 be a normal subgroup of finite index which acts freely on H. We\nfirst prove the analogous result for the group 0\u2032\u2032, namely, that the mapping \u03bek :\nHk,L(0\u2032\u2032)\u2192 M !\u03ba,L\u2212(0\u2032\u2032) is surjective.\nWe consider the Riemann surface X = X (0\u2032\u2032) using the above notation. Let\ns1, . . . , sr be the cusps of X , and write D = \u2211i si for the divisor on X given by\nthe cusps. Let n be a positive integer. By tensoring the Dolbeault resolution of the\nstructure sheaf O with the locally free O-module Lk,L \u2297O OnD , we get the exact\nsheaf sequence\n0 \u2212\u2192 O\u2297Lk,L\u2297OnD \u2212\u2192 E 0,0\u2297Lk,L\u2297OnD \u2202\u00af\u22971\u22971\u2212\u2212\u2212\u2212\u2192 E 0,1\u2297Lk,L\u2297OnD \u2212\u2192 0.\nSince E p,q \u2297Lk,L \u2297OnD is a fine sheaf, it is acyclic. Hence we obtain the following\nlong exact cohomology sequence:\n0 \u2212\u2192 (Lk,L \u2297 OnD)(X) \u2212\u2192 E 0,0(X,Lk,L \u2297 OnD)\n\u2212\u2192 E 0,1(X,Lk,L \u2297 OnD) \u2212\u2192 H1(X,Lk,L \u2297 OnD) \u2212\u2192 0. (3.14)\n62 BRUINIER and FUNKE\nWe claim that H1(X,Lk,L \u2297 OnD) vanishes if n is large. In fact, using Serre\nduality (see [We, Chap. V, Th. 2.7]), we find\nH1(X,Lk,L \u2297 OnD) \u223c= H0(X, \u2297L \u2217k,L \u2297 O\u2217nD) \u223c= H0(X,L\u03ba,L\u2212 \u2297 O\u2212(n+1)D).\nBecause the number of zeros (counted with multiplicities) of holomorphic modular\nforms of fixed weight \u03ba is bounded, the latter cohomology group vanishes if n is\nsufficiently large. This proves the claim.\nNow let g \u2208 M !\n\u03ba,L\u2212(0\n\u2032\u2032). We want to show that there is an f \u2208 Hk,L(0\u2032\u2032) such\nthat \u03bek( f ) = g. We choose a positive integer n greater than or equal to the orders of\nthe poles of g at the cusps and such that H1(X,Lk,L \u2297 OnD) vanishes. Then the 1-\nform g d\u03c4 defines a global holomorphic section in E 1,0(X,L \u2217k,L\u2297OnD). Applying the\nHodge star operator, we get the 1-form iv\u2212k g\u00af d \u03c4\u00af \u2208 E 0,1(X,Lk,L \u2297 OnD). By virtue\nof the exact sequence (3.14), we find that there is a function f \u2208 E 0,0(X,Lk,L\u2297OnD)\nsatisfying \u2202\u00af f = iv\u2212k g\u00af d \u03c4\u00af . But this is equivalent to saying\n\u2212vk\u22122Lk f d \u03c4\u00af = g\u00af d \u03c4\u00af .\nWe are left to show that 1k f = 0. This follows from\n\u22121k f = 2 f = \u2217\u00afL \u2202\u00af \u2217\u00afL \u2202\u00af f = \u2217\u00afL \u2202\u00af \u2217\u00afL iv\u2212k g\u00af d \u03c4\u00af = \u2212\u2217\u00afL \u2202\u00af g d\u03c4 = 0,\ncompleting the proof of Theorem 3.7 for the group 0\u2032\u2032.\nFor the full modular group 0\u2032, we use the fact that the cohomology of a fi-\nnite group acting on a C-vector space vanishes. This implies that H j (X (0\u2032),L ) \u223c=\nH j (X (0\u2032\u2032),L )0\u2032\/0\u2032\u2032 for any coherent O-module L . Hence the assertion follows by\nconsidering the (0\u2032\/0\u2032\u2032)-invariant subspaces in (3.14).\nCOROLLARY 3.8\nThe following sequences are exact:\n0 \/\/ M !k,L \/\/ Hk,L\n\u03bek \/\/ M !\n\u03ba,L\u2212\n\/\/ 0,\n0 \/\/ M !k,L \/\/ H\n+\nk,L\n\u03bek \/\/ S\u03ba,L\u2212 \/\/ 0.\nWe also need a slight variation of the above duality result. To formulate it, we in-\ntroduce a second pairing between the spaces H+k,L and M\u03ba,L\u2212 . If g \u2208 M\u03ba,L\u2212 with\nFourier expansion g = \u2211h,n b(h, n)e(n\u03c4)eh , and f \u2208 H+k,L with Fourier expansion\nas in (3.2), then we put\n{g, f }\u2032 =\n\u2211\nh\u2208L#\/L\n\u2211\nn<0\na+(h, n)b(h,\u2212n). (3.15)\nON TWO GEOMETRIC THETA LIFTS 63\nThis definition differs from (3.10) by the fact that we sum only over negative n. We\nlet M !!k,L be the subspace of M !k,L consisting of those weakly holomorphic modular\nforms f whose constant term\n\u2211\nh a\n+(h, 0)eh in the Fourier expansion is orthogonal\nto the constant terms of all g \u2208 M\u03ba,L\u2212 with respect to \u3008\u00b7, \u00b7\u3009. If k < 0 or if k = 0 and\n%L does not contain the trivial representation, then, using Eisenstein series in M\u03ba,L\u2212 ,\none sees that M !!k,L simply consists of those f \u2208 M !k,L with vanishing constant term.\nOtherwise, the fact that Eisenstein series of weight \u2264 2 may be nonholomorphic\nimplies that some f \u2208 M !!k,L may have nonvanishing constant term. If f \u2208 M !!k,L\nor g \u2208 S\u03ba,L\u2212 , then {g, f } = {g, f }\u2032. In particular, the pairing {g, f }\u2032 vanishes if\nf \u2208 M !!k,L .\nCOROLLARY 3.9\nThe pairings between H+k,L\/M !!k,L and M\u03ba,L\u2212 (resp., H\n+\nk,L\/M\n!\nk,L and S\u03ba,L\u2212) induced\nby (3.15) are nondegenerate.\nThis can be proved using Theorem 3.6 and Eisenstein series in M\u03ba,L\u2212 . The details are\nleft to the reader.\nRemark 3.10\nIf h \u2208 L#\/L and m \u2208 Z + q(h) is negative, the Hejhal Poincare\u00b4 series Fh,m(\u03c4, \u03ba\/2)\ndefined in [Br2, Def. 1.8, Prop. 1.10] (see also [H], [N]) are examples of weak Maass\nforms in H+k,L . If k < 0, it can be shown that they span the whole space H\n+\nk,L (see\n[Br2, Prop. 1.12]). Moreover, one can check that \u03bek(Fh,m(\u03c4, \u03ba\/2)) equals, up to a\nconstant factor, the usual holomorphic Poincare\u00b4 series Ph,\u2212m(\u03c4 ) \u2208 S\u03ba,L\u2212 (as defined,\ne.g., in [Br2, Chap. 1.2.1]). Therefore, for \u03ba > 2 (and k < 0), the above duality\nstatement also follows from [Br2, Chap. 1]. However, the approach of the present\npaper is more conceptual while also covering the low weights \u03ba = 3\/2 and 2 (where\nthe Ph,\u2212m would need to be defined by Hecke summation).\nThe principal part of the Hejhal Poincare\u00b4 series Fh,m(\u03c4, \u03ba\/2) is equal to\ne(m\u03c4)eh + (\u22121)k+(q\u2212p)\/2e(m\u03c4)e\u2212h + constant term.\nThis shows that up to the constant term, any Fourier polynomial as in (3.6) occurs as\nthe principal part P( f ) of some f \u2208 H+k,L . This can also be deduced from Theorem\n3.7 as follows.\nPROPOSITION 3.11\nFor every Fourier polynomial of the form\nQ(\u03c4 ) =\n\u2211\nh\u2208L#\/L\n\u2211\nn\u2208Z+q(h)\nn<0\na+(h, n)e(n\u03c4)eh\n64 BRUINIER and FUNKE\nwith a+(h, n) = (\u22121)k+(q\u2212p)\/2a+(\u2212h, n), there exists an f \u2208 H+k,L with principal\npart P( f ) = Q + c for some T -invariant constant c \u2208 C[L#\/L]. The function f is\nuniquely determined if k < 0 (and in certain cases also for k = 0).\nProof\nGiven Q as above, we define a linear functional \u03bbQ on S\u03ba,L\u2212 via the right-hand side\nof (3.15). By virtue of Corollary 3.9, this functional is represented by a weak Maass\nform h \u2208 H+k,L ; that is, {g, h} = \u03bbQ(g) for all g \u2208 S\u03ba,L\u2212 . The functional \u03bbQ\u2212P(h)\nthen vanishes identically on S\u03ba,L\u2212 . Hence, by a variant of [B2, Th. 3.1] (see [Br2,\nTh. 1.17]), there exists a weakly holomorphic h\u2032 \u2208 M !k,L with principal part Q \u2212\nP(h)+ c for some T -invariant constant c \u2208 C[L#\/L]. Then f := h + h\u2032 \u2208 H+k,L has\nprincipal part Q + c.\nRemark 3.12\nBorcherds [B2] uses equation (3.10) to introduce a pairing between formal Laurent\nseries and formal power series. Via Serre duality, he also obtains that M !k,L is the\northogonal complement of S\u03ba,L\u2212 , but he does not consider weak Maass forms.\n4. Special Schwartz forms\nFor the following discussion the reader should consult [KM4, Secs. 5 \u2013 8] and [FM1,\nappendix].\nKudla and Millson constructed (in more generality) Schwartz forms \u03d5KM on\nV (R) taking values in A q(D), the differential q-forms on D. More precisely,\n\u03d5KM \u2208\n[\nS\n(\nV (R)\n)\u2297A q(D)]G ' [S (V (R))\u2297\u2227q(p\u2217)]K ,\nwhere the isomorphism is again given by evaluation at the base point of D. In fact,\n\u03d5KM (x) is closed for all x \u2208 V (R).\nWe let X\u03b1\u00b5 (1 \u2264 \u03b1 \u2264 p, p+ 1 \u2264 \u00b5 \u2264 p+q) denote the elements of the obvious\nbasis of p in (2.1), and we let \u03c9\u03b1\u00b5 be the elements of the dual basis which pick out the\n\u03b1\u00b5th coordinate of p. Then \u03d5KM is given by applying the operator\nD = 1\n2q\/2\np+q\u220f\n\u00b5=p+1\n[ p\u2211\n\u03b1=1\n(\nx\u03b1 \u2212 12pi\n\u2202\n\u2202x\u03b1\n)\n\u2297 A\u03b1\u00b5\n]\nto the standard Gaussian \u03d50 \u2297 1 \u2208\n[\nS (V (R))\u2297\u22270(p\u2217)]K :\n\u03d5KM = D(\u03d50 \u2297 1).\nHere A\u03b1\u00b5 denotes the left multiplication by \u03c9\u03b1\u00b5. Note that this is 2q\/2 times the\ncorresponding quantity in [KM4]. It is easy to see that \u03d5KM is K -invariant, and by\n[KM1, Th. 3.1], it is an eigenfunction of K \u2032 of weight (p + q)\/2.\nON TWO GEOMETRIC THETA LIFTS 65\nFor a multi-index \u03b1 = (\u03b11, . . . , \u03b1q) \u2208 {1, . . . , p}q , we have\n\u03d5KM (x) =\n\u2211\n\u03b1\nP\u03b1(x) \u03d50(x) \u03c9\u03b11 p+1 \u2227 \u00b7 \u00b7 \u00b7 \u2227 \u03c9\u03b1q p+q ,\nwhere P\u03b1(x) is an (in general, nonhomogeneous) polynomial of degree q. For \u03b1 =\n(\u03b1, . . . , \u03b1), P\u03b1(x) is given by\nP\u03b1(x) = (4pi)\u2212q\/2Hq(\n\u221a\n2pix\u03b1),\nwhere Hq(t) = (\u22121)qet2 dqdtq e\u2212t\n2\nis the qth Hermite polynomial. For \u201cmixed\u201d \u03b1,\nP\u03b1(x) is a product of Hermite functions in the x\u03b1 .\nIn particular, we have (see [KM1, Prop. 5.1])\n\u03d5KM (0) = eq , (4.1)\nwhere for q = 2l even, eq is the Euler form of the symmetric space D (which is the\nEuler class (see, e.g., [KN]) of the tautological vector bundle over D; i.e., the fiber\nover a point z \u2208 D is given by the negative q-plane z) and zero for q odd. Here eq is\nnormalized such that it is given in\n\u2227q(p\u2217) by\neq =\n(\n\u2212 1\n4pi\n)l 1\nl!\n\u2211\n\u03c3\u2208Sq\nsgn(\u03c3 )p+\u03c3(1),p+\u03c3(2) \u00b7 \u00b7 \u00b7p+\u03c3(2l\u22121),p+\u03c3(2l)\nwith\n\u00b5\u03bd =\np\u2211\n\u03b1=1\n\u03c9\u03b1\u00b5 \u2227 \u03c9\u03b1\u03bd .\nNote that for q = 2,  := \u2212e2 is positive; that is, it defines a Ka\u00a8hler form on the\nHermitian domain D.\nThe space of K \u2032-finite vectors in S (V (R)) is given by the so-called polynomial\nFock space S(V (R)) \u2282 S (V (R)) which consists of those Schwartz functions on\nV (R) of the form p(x)\u03d50(x), where p(x) is a polynomial function on V (R). Dif-\nferentiating the action of Mp2(R) \u00d7 O(V (R)) on S(V (R)), we obtain the associated\naction of the Lie algebra sl2\u00d7o(V ), which we also denote by \u03c9. Then there is an inter-\ntwining map \u03b9 : S(V (R)) \u2212\u2192 P(Cp+q) to the infinitesimal Fock model of the Weil\nrepresentation acting on the space of complex polynomialsP(Cp+q) in p + q vari-\nables such that \u03b9(\u03d50) = 1. We denote the variables inP(Cp+q) by z\u03b1 (1 \u2264 \u03b1 \u2264 p)\nand z\u00b5 (p + 1 \u2264 \u00b5 \u2264 p + q). Then the intertwining map \u03b9 satisfies\n\u03b9\n(\nx\u03b1 \u2212 12pi\n\u2202\n\u2202x\u03b1\n)\n\u03b9\u22121 = \u2212 i\n2pi\nz\u03b1,\n\u03b9\n(\nx\u00b5 \u2212 12pi\n\u2202\n\u2202x\u00b5\n)\n\u03b9\u22121 = i\n2pi\nz\u00b5.\n66 BRUINIER and FUNKE\nNote that this coincides with [FM1, p. 41] and differs from [KM4, p. 153] since a\nslightly different realization of the Schro\u00a8dinger model is used there.\nClearly, the form \u03d5KM is in the polynomial Fock space. We see\n\u03d5KM =\n(\u2212i\u221a2\n4pi\n)q \u2211\n\u03b11,...,\u03b1q\nz\u03b11 \u00b7 \u00b7 \u00b7 z\u03b1q \u2297 \u03c9\u03b11 p+1 \u2227 \u00b7 \u00b7 \u00b7 \u2227 \u03c9\u03b1q p+q (4.2)\nwhen considered as an element in\n[\nP(Cp+q)\u2297\u2227q(p\u2217)]K .\nIn the Fock model, the Weil representation acts as follows: For o(V (R)), we have\n\u03c9(X\u03b1\u00b5) = \u22124pi \u2202\n2\n\u2202z\u03b1\u2202z\u00b5\n+ 1\n4pi\nz\u03b1z\u00b5.\nThe elements R and L in sl2(C) (which correspond to the raising and lowering oper-\nators R and L on H; see Sec. 3) are given by\nR = 1\n2\n(\n1 i\ni \u22121\n)\nand L = 1\n2\n(\n1 \u2212i\n\u2212i \u22121\n)\n,\nand their action is\n\u03c9(R) = 1\n8pi\np\u2211\n\u03b1=1\nz2\u03b1 \u2212 2pi\np+q\u2211\n\u00b5=p+1\n\u22022\n\u2202z2\u00b5\n, (4.3)\n\u03c9(L) = \u22122pi\np\u2211\n\u03b1=1\n\u22022\n\u2202z2\u03b1\n+ 1\n8pi\np+q\u2211\n\u00b5=p+1\nz2\u00b5. (4.4)\nThe differentiation d in the Lie algebra complex\n[\nP(Cp+q)\u2297\u2227(p\u2217)]K is given\nby\nd =\n\u2211\n\u03b1,\u00b5\n\u03c9(X\u03b1\u00b5)\u2297 A\u03b1\u00b5.\nFrom this it is easy to see that \u03d5KM is closed.\nWe also define a form\n\u03c8KM = \u03c8 \u2208\n[\nP(Cp+q)\u2297\n\u2227\nq\u22121(p\u2217)\n]K\n(4.5)\n(and therefore in [S(V (R))\u2297A q\u22121(D)]G) by\n\u03c8KM = \u221212(p + q \u2212 1)h(\u03d5KM ), (4.6)\nwhere h is the operator on\n[\nP(Cp+q)\u2297\u2227\u2217(p\u2217)]K given by\nh =\n\u2211\n\u03b1,\u00b5\nz\u00b5\n\u2202\n\u2202z\u03b1\n\u2297 A\u2217\u03b1\u00b5.\nON TWO GEOMETRIC THETA LIFTS 67\nHere A\u2217\u03b1\u00b5 denotes the (interior) multiplication with X\u03b1\u00b5; that is, A\u2217\u03b1\u00b5(\u03c9\u03b1\u2032\u00b5\u2032) =\n\u03b4\u03b1\u03b1\u2032\u03b4\u00b5\u00b5\u2032 .\nLEMMA 4.1\nWe have\n\u03c8KM =\n(\u2212i\u221a2\n4pi\n)q \u22121\n2(q \u2212 1)!\n\u00d7\n\u2211\n\u03b11,...,\u03b1q\u22121\nz\u03b11 \u00b7 \u00b7 \u00b7 z\u03b1q\u22121 det\n\uf8eb\uf8ec\uf8ec\uf8ec\uf8ed\nz p+1 \u00b7 \u00b7 \u00b7 z p+q\n\u03c9\u03b11 p+1 . . . \u03c9\u03b11 p+q\n...\n...\n\u03c9\u03b1q\u22121 p+1 . . . \u03c9\u03b1q\u22121 p+q\n\uf8f6\uf8f7\uf8f7\uf8f7\uf8f8 ,\nwhere the determinant in the noncommutative algebraP(Cp+q)\u2297\u2227\u2217(p\u2217) is defined\ninductively via expansion along the first row.\nProof\nWe give a brief sketch. We first note that (easily checked by induction)\n\u03d5KM =\n(\u2212i\u221a2\n4pi\n)q 1\nq!\n\u2211\n\u03b11,...,\u03b1q\nz\u03b11 \u00b7 \u00b7 \u00b7 z\u03b1q det(), (4.7)\nwhere\n =\n\uf8eb\uf8ec\uf8ed\u03c9\u03b11 p+1 . . . \u03c9\u03b11 p+q... ...\n\u03c9\u03b1q p+1 . . . \u03c9\u03b1q p+q\n\uf8f6\uf8f7\uf8f8 .\nThe action of the operator A\u2217\u03b2\u00b5 on det() can be computed by expanding det()\nalong the (p \u2212 \u00b5)th column. If we write \u03bd\u00b5 for the ((q \u2212 1) \u00d7 (q \u2212 1))-matrix\nobtained from  by canceling the \u03bdth row and the (p \u2212 \u00b5)th column, we have\nA\u2217\u03b2\u00b5 det() = \u2212\nq\u2211\n\u03bd=1\n(\u22121)\u00b5\u2212pA\u2217\u03b2\u00b5\u03c9\u03b1\u03bd\u00b5 det(\u03bd\u00b5) = \u2212\nq\u2211\n\u03bd=1\n(\u22121)\u00b5\u2212p\u03b4\u03b2\u03b1\u03bd det(\u03bd\u00b5).\nA little calculation then shows\n\u03c8KM = \u2212(\u2212i\n\u221a\n2\/4pi)q\n2(p + q \u2212 1)(q \u2212 1)!\n\u00d7\n\u2211\n\u03b11,...,\u03b1q\n\u2202\n\u2202z\u03b1q\nz\u03b11 \u00b7 \u00b7 \u00b7 z\u03b1q det\n\uf8eb\uf8ec\uf8ec\uf8ec\uf8ed\nz p+1 . . . z p+q\n\u03c9\u03b11 p+1 . . . \u03c9\u03b11 p+q\n...\n...\n\u03c9\u03b1q\u22121 p+1 . . . \u03c9\u03b1q\u22121 p+q\n\uf8f6\uf8f7\uf8f7\uf8f7\uf8f8 .\nOne now applies the product rule to obtain the assertion.\n68 BRUINIER and FUNKE\nTHEOREM 4.2 (Kudla and Millson [KM4, Sec. 8])\n(i) We have the identity\n\u03c9(L)\u03d5KM = d\u03c8KM .\n(ii) We have that \u03c8KM is an eigenfunction of K \u2032 with weight (p + q)\/2\u2212 2.\nExample 4.3\nFor signature (p, 1), we have in the Fock model (Schro\u00a8dinger model) of the Weil\nrepresentation,\n\u03d5KM = \u2212i\n\u221a\n2\n4pi\np\u2211\n\u03b1=1\nz\u03b1 \u2297 \u03c9\u03b1p+1 = (\u03b9\u2297 1)\n(\u221a\n2\np\u2211\n\u03b1=1\nx\u03b1\u03d50 \u2297 \u03c9\u03b1p+1\n)\nand\n\u03c8KM = i\n\u221a\n2\n8pi\nz p+1 \u2297 1 = (\u03b9\u2297 1)\n( 1\u221a\n2\nx p+1\u03d50 \u2297 1\n)\n.\nWe now specialize to the case of signature (p, 2), that is, q = 2, when we have\nan underlying complex structure on D. Then by the conventions of Section 2, the\noperators \u2202 and \u2202\u00af on D are given by\n\u2202 = 1\n2\n\u2211\n\u03b1\n\u03c9(X\u03b1p+1 \u2212 i X\u03b1p+2)\u2297 (\u03c9\u03b1p+1 + i\u03c9\u03b1p+2),\n\u2202\u00af = 1\n2\n\u2211\n\u03b1\n\u03c9(X\u03b1p+1 + i X\u03b1p+2)\u2297 (\u03c9\u03b1p+1 \u2212 i\u03c9\u03b1p+2).\nWe set dc = (1\/(4pi i))(\u2202 \u2212 \u2202\u00af), so that ddc = \u2212(1\/(2pi i))\u2202\u2202\u00af . Note that in this\ncase, \u03d5KM is actually a (1, 1)-form.\nTHEOREM 4.4\nIn the case of signature (p, 2), we have\n\u03c9(L)\u03d5KM = \u2212ddc\u03d50.\nRemark 4.5\nTheorem 4.2 states that there is a (q \u2212 1)-form \u03c8 such that \u03c9(L)\u03d5KM = d\u03c8KM\n(for any signature). So Theorem 4.4 suggests (and it is easily checked) that in the\nHermitian case one has\n\u03c8 = \u2212dc\u03d50. (4.8)\nON TWO GEOMETRIC THETA LIFTS 69\nFrom this perspective we can consider Theorem 4.4 as the Weil representation-\ntheoretic analogue of the ddc-lemma in complex geometry.\nWe prove the theorem by computing the two sides separately. For the left-hand side,\nby (4.4) and (4.2) we easily see the following.\nLEMMA 4.6\nFor signature (p, 2),\n\u03c9(L)\u03d5KM = 12pi\np\u2211\n\u03b1=1\n\u03c9\u03b1p+1 \u2227 \u03c9\u03b1p+2\n\u2212 1\n64pi3\n(z2p+1 + z2p+2)\n\u2211\n\u03b11,\u03b12\nz\u03b11z\u03b12 \u03c9\u03b11 p+1 \u2227 \u03c9\u03b12 p+2.\nFor the right-hand side, we get the same.\nLEMMA 4.7\nFor signature (p, 2),\n\u2212ddc\u03d50 = 12pi\np\u2211\n\u03b1=1\n\u03c9\u03b1p+1 \u2227 \u03c9\u03b1p+2\n\u2212 1\n64pi3\n(z2p+1 + z2p+2)\n\u2211\n\u03b11,\u03b12\nz\u03b11z\u03b12 \u03c9\u03b11 p+1 \u2227 \u03c9\u03b12 p+2.\nProof\nWe have\n1\n2\n\u03c9(X\u03b1p+1 \u00b1 i X\u03b1p+2) = \u22122pi \u2202\n\u2202z\u03b1\n( \u2202\n\u2202z p+1\n\u00b1 i \u2202\n\u2202z p+2\n)\n+ 1\n8pi\nz\u03b1(z p+1 \u00b1 i z p+2).\nWe first see\n\u2202\u00af(\u03d50) = 18pi\n\u2211\n\u03b1\nz\u03b1(z p+1 + i z p+2)(\u03c9\u03b1p+1 \u2212 i\u03c9\u03b1p+2)\n70 BRUINIER and FUNKE\nand then\n\u2202\u2202\u00af(\u03d50) = \u221212\n\u2211\n\u03b1\n(\u03c9\u03b1p+1 + i\u03c9\u03b1p+2) \u2227 (\u03c9\u03b1p+1 + i\u03c9\u03b1p+2)\n\u2212 1\n64pi2\n\u2211\n\u03b11,\u03b12\nz\u03b11z\u03b12(z p+1 \u2212 i z p+2)(z p+1 + i z p+2)\n\u00d7 (\u03c9\u03b11 p+1 + i\u03c9\u03b11 p+2) \u2227 (\u03c9\u03b12 p+1 \u2212 i\u03c9\u03b12 p+2)\n= i\n\u2211\n\u03b1\n\u03c9\u03b1p+1 \u2227 \u03c9\u03b1p+2\n\u2212 i\n32pi2\n\u2211\n\u03b11,\u03b12\nz\u03b11z\u03b12(z\n2\np+1 + z2p+2) \u03c9\u03b11 p+1 \u2227 \u03c9\u03b12 p+2.\nThe lemma follows.\n5. The theta lifts\n5.1. The Kudla-Millson lift\nWe consider the Schwartz function \u03d5KM from Section 4. Since \u03d5KM is closed and an\neigenfunction of K \u2032 of weight \u03ba = (p + q)\/2, we get\n2(\u03c4, z, \u03d5KM ) \u2208 A\u03ba,L \u2297Z q(X);\nthat is,2(\u03c4, z, \u03d5KM ) is a nonholomorphic modular form of weight \u03ba associated to the\nrepresentation %L with values inZ q(X), the closed q-forms on X . (In fact, it extends\nto a closed q-form on the Borel-Serre compactification X\u00af of X ; see [FM2].) We then\ncan consider the assignment\n\u03b7 7\u2192 3KM (\u03c4, \u03b7) :=\n\u222b\nX\n\u03b7 \u22272(\u03c4, z, \u03d5KM ),\nwhich is defined for rapidly decreasing (p\u22121)q-forms on X . This map factors through\nH (p\u22121)qc (X), the de Rham cohomology with compact support of X .\nTHEOREM 5.1 (Kudla and Millson; see [KM4, Th. 2])\nFor \u03b7 closed and rapidly decreasing, the function 3KM (\u03c4, \u03b7) is holomorphic on H\nand at the cusp (even though 2(\u03c4, z, \u03d5KM ) is not). We therefore have a map\n3KM : H (p\u22121)qc (X) \u2212\u2192 M\u03ba,L .\nThe Fourier expansion is given by\n3KM (\u03c4, \u03b7)h = \u03b4h0\n( \u222b\nX\n\u03b7 \u2227 eq\n)\n+\n\u2211\nn>0\n( \u222b\nZ(h,n)\n\u03b7\n)\ne(n\u03c4);\nON TWO GEOMETRIC THETA LIFTS 71\nthat is, the nth Fourier coefficient of 2(\u03c4, z, \u03d5KM )h is a Poincare\u00b4 dual form of the\ncycle Z(h, n). Here (for q even), eq is the Euler form of the symmetric space D (see\n(4.1)). For q odd, 3KM (\u03c4, \u03b7) is a cusp form.\nRemark 5.2\nFor p = 1 and X noncompact, we have H0c (X) = 0, so that Theorem 5.1 would be\nempty. However, in that case, the q-form 2(\u03c4, z, \u03d5KM ) is actually rapidly decreasing\non X (see [FM2]), and therefore it defines a class in Hqc (X). This corresponds to the\nfact that the cycles Z(h, n) are a collection of points in this situation. Hence 3KM is\ndefined on H0(X) ' R, and for q \u2265 3, the lift 3KM (\u03c4, \u03b7) is a holomorphic modular\nform (see [FM2]), while for q = 2, it is nonholomorphic (see [Fu]).\n5.2. The singular theta lift\n5.2.1. The Hermitian case\nHere we assume that V has signature (p, 2) such that the corresponding symmetric\ndomain is Hermitian. We put k = 1\u2212 p\/2 and \u03ba = 1+ p\/2. In this section we briefly\nrecall some facts on the Borcherds lift from weakly holomorphic elliptic modular\nforms of weight k to automorphic forms on the orthogonal group O(V (R)) (see [B1])\nand its generalization to weak Maass forms (see [Br2]).\nWe consider the Siegel theta function 2(\u03c4, z, \u03d5 p,20 ) \u2208 A\u2212k,L \u2297 C\u221e(X). The\n(additive) Borcherds lift of a weak Maass form f \u2208 H+k,L\u2212 is defined by the theta\nintegral\n8(z, f ) = 8(z, f, \u03d50) =\n\u222b reg\n0\u2032\\H\n\u2329\nf (\u03c4 ),2(\u03c4, z, \u03d5 p,20 )\n\u232a\nd\u00b5. (5.1)\nThe integral is typically divergent and needs to be regularized in the following way\n(indicated by the superscript \u201creg\u201d): If F is a 0\u2032-invariant function on H, we consider\nfor an additional complex parameter s \u2208 C the function\nlim\nt\u2192\u221e\n\u222b\nFt\nF(\u03c4 )v\u2212s d\u00b5, (5.2)\nwhere Ft denotes the truncated fundamental domain (3.11) for the action of SL2(Z)\non H. Formally, at s = 0, the quantity (5.2) equals the usual integral of F over 0\u2032\\H.\nHowever, even if this diverges, (5.2) sometimes converges for <(s) \u001d 0 and has a\nmeromorphic continuation to a neighborhood of s = 0. Then we define\u222b reg\n0\u2032\\H\nF(\u03c4 ) d\u00b5 (5.3)\nto be the constant term in the Laurent expansion of (5.2) at s = 0. So one feature of the\nregularization consists in prescribing the order of integration, the other in introducing\ns and looking at the Laurent expansion. The above regularization of the theta integral\n72 BRUINIER and FUNKE\nfor weakly holomorphic modular forms was discovered by Harvey and Moore [HM]\nand vastly generalized by Borcherds [B1]. In connection with weak Maass forms, it\nwas investigated in [Br2].\nRemark 5.3\nNote that in [B1] and [Br2] the Borcherds lift is actually defined for signature (2, p).\nIdentifying the symmetric spaces Dp,2 and D2,p and switching to the space V\u2212, one\nhas\n8(z, f ) = ( f (\u03c4 ),2(\u03c4, z, \u03d52,p0 , L\u2212))regk,L\u2212,\nwhere the integral defining the Peterson scalar product is regularized as above. The\nright-hand side is the definition used in [B1] and [Br2]. The definition given here is\nmore convenient for our purposes.\nPROPOSITION 5.4\nDenote the Fourier expansion of f \u2208 H+k,L\u2212 as in (3.2). The regularized integral for\n8(z, f ) converges to a 0-invariant C\u221e-function on D with a logarithmic singularity\nalong the divisor\n\u22122\n\u2211\nh\n\u2211\nn\u2208Q<0\na+(h, n)Z(h,\u2212n).\nProof\nSee [B1, Sec. 6] and [Br2, Sec. 2.2].\nWe list some further properties of 8(z, f ): Outside its singularities, the function\n8(z, f ) is almost an eigenfunction of the invariant Laplacian 1 on D induced by the\nCasimir element of the universal enveloping algebra of the Lie algebra of O(V (R)).\nMore precisely, if we normalize 1 as in [Br2, Chap. 4.1], we have 18(z, f ) =\na+(0, 0)p\/4. Consequently, since1 is an elliptic differential operator on D, the func-\ntion 8(z, f ) is actually real analytic outside its singularities.\nIt is proved in [Br2, Chap. 3.2] that 8(z, f ) can be split into a sum\n8(z, f ) = \u22122 log |9(z, f )| + \u03be(z, f ), (5.4)\nwhere \u03be(z, f ) is real analytic on the whole domain D and 9(z, f ) is a meromorphic\nfunction on D whose divisor equals\nZ( f ) :=\n\u2211\nh\n\u2211\nn\u2208Q<0\na+(h, n)Z(h,\u2212n). (5.5)\nIf f \u2208 M !k,L\u2212 and its Fourier coefficients a+(h, n) with negative index are integral,\nthen \u03be(z, f ) reduces to a \u201csimple\u201d function and 9(z, f ) is a meromorphic modular\nON TWO GEOMETRIC THETA LIFTS 73\nform for the group 0 of weight a+(0, 0). This is the (multiplicative) Borcherds lift\nfrom M !k,L\u2212 to meromorphic modular forms for 0. If f is not holomorphic, then\n9(z, f ) is far from being modular under 0. (Caution: It is, in general, not true that\n\u03be(z, f ) is equal to the regularized theta integral of f \u2212, as one might think.)\nFrom these considerations it can be deduced that the (1, 1)-form\n3B( f ) := ddc8(z, f ) = ddc\u03be(z, f ) (5.6)\nis closed, harmonic, 0-invariant, and of moderate growth. It represents the Chern\nclass of the divisor (5.5) in the second cohomology H2(X). In particular, we have\u222b\nZ( f )\n\u03b7 =\n\u222b\nX\n\u03b7 \u22273B( f ) (5.7)\nfor any rapidly decreasing 2(p\u22121)-form \u03b7. If f \u2208 M !k,L\u2212 , then3B( f ) = a+(0, 0);\nthat is, a multiple of the Ka\u00a8hler form  = \u2212e2 on D and actually vanishes for f \u2208\nM !!k,L\u2212 and k < 0.\nWe summarize part of the above discussion in the following theorem.\nTHEOREM 5.5 (see [Br2, Chap. 5])\nThe assignment f 7\u2192 3B( f ) defines a linear mapping H+k,L\u2212 \u2192 Z 1,1mg (X) to the\nspaceZ 1,1mg (X) of closed (1, 1)-forms of moderate growth on X . The induced mapping\nH+k,L\u2212 \u2192 Z 1,1mg (X)\/C factors through H+k,L\u2212\/M !k,L\u2212 .\n5.2.2. The real case\nWe now consider the case of general signature (p, q). If x \u2208 V (R), we put |x | =\n|(x, x)|1\/2. Moreover, as before we let \u03ba = (p + q)\/2 and k = 2 \u2212 \u03ba . The Schwartz\nform \u03c8 = \u03c8KM (see Sec. 4) has weight \u2212k = (q + p)\/2 \u2212 2 by Theorem 4.2(ii);\nhence\n2(\u03c4, z, \u03c8) \u2208 A\u2212k,L \u2297A q\u22121(X).\nNote that the components of 2(\u03c4, z, \u03c8) are given by(\n2(\u03c4, z, \u03c8)\n)\nh = v1\u2212q\/2\n\u2211\n\u03bb\u2208L+h\nP\u03c8 (\n\u221a\nv\u03bb, z)\u03d5 p,q0 (\u03bb, \u03c4, z),\nwith a (in general, nonhomogeneous) polynomial P\u03c8 (x, z) \u2208 [P(V (R)) \u2297\nA q\u22121(D)]G of degree q . By Lemma 4.1, P\u03c8 can be written as\nP\u03c8 (x, z) =\n\u2211\n\u03b1\nQ\u03b1(x, z) R\u03b1(x, z), (5.8)\nwhere the sum extends over all multi-indices \u03b1 = (\u03b11, . . . , \u03b1q\u22121). Here Q\u03b1 is poly-\nnomial in [P(V (R)) \u2297 A 0(D)]G of degree q \u2212 1 (in fact, a product of Hermite\n74 BRUINIER and FUNKE\nfunctions as for \u03d5KM ), which depends only on xz\u22a5 , while R\u03b1 is a homogeneous linear\npolynomial in [P(V (R))\u2297A q\u22121(D)]G , which depends only on xz . In particular, we\nhave P\u03c8 (0, z) = 0. We normalize the polynomials so that at the base point z0, we\nhave\nR\u03b1(x) = R\u03b1(x, z0) = \u22121\u221a\n2(q \u2212 1)! det\n\uf8eb\uf8ec\uf8ec\uf8ec\uf8ed\nx p+1 \u00b7 \u00b7 \u00b7 x p+q\n\u03c9\u03b11 p+1 \u00b7 \u00b7 \u00b7 \u03c9\u03b11 p+q\n...\n...\n\u03c9\u03b1q\u22121 p+1 \u00b7 \u00b7 \u00b7 \u03c9\u03b1q\u22121 p+q\n\uf8f6\uf8f7\uf8f7\uf8f7\uf8f8 ,\nand the leading term of Q\u03b1(x) = Q\u03b1(x, z0) is given by 2(q\u22121)\/2\u220fq\u22121i=1 x\u03b1i .\nLet f \u2208 H+k,L\u2212 be a weak Maass form. We then define a singular theta lift of\nBorcherds\u2019s type for signature (p, q) by\n8(z, f, \u03c8) := (2(\u03c4, z, \u03c8), vk f )reg\u2212k,L = \u222b reg\n0\u2032\\H\n\u2329\n2(\u03c4, z, \u03c8), f\n\u232a\nd\u00b5. (5.9)\nWe define the cycle Z( f ) associated to f by (5.5), as in the Hermitian case. Note\nthat the Fourier coefficients satisfy a+(\u2212h, n) = (\u22121)qa+(h, n), corresponding to\nZ(\u2212h, n) = (\u22121)q Z(h, n). In particular, we have Z(Fh,m) = 2Z(h,\u2212m), where\nFh,m is the Hejhal Poincare\u00b4 series (see Rem. 3.10).\nPROPOSITION 5.6\nThe regularized integral for8(z, f, \u03c8) converges to a 0-invariant C\u221e-function on D\nwith singularities along Z( f ). More precisely, there exist G-invariant scalar-valued\npolynomials Q\u02dc\u03b1(x, z) \u2208 [P(V (R))\u2297A 0(D)]G of degree (q\u22121) such that in a small\nneighborhood of w \u2208 D the singularity is of type\u2211\nh\n\u2211\nn\u2208Q<0\na+(h, n)\n\u2211\n\u03bb\u2208w\u22a5\u2229Lh,\u2212n\n\u2211\n\u03b1\nQ\u02dc\u03b1(\u03bbz\u22a5\/|\u03bbz|, z)R\u03b1(\u03bbz\/|\u03bbz|, z).\nThe leading term Q\u02dc\u03b1,q\u22121 of Q\u02dc\u03b1 at the base point z0 is given by\nQ\u02dc\u03b1,q\u22121(x) = 0(q\/2)\u221a\n2piq\/2\nq\u22121\u220f\ni=1\nx\u03b1i .\nNote that all sums in the above formula are finite. The polynomials Q\u02dc\u03b1 and R\u03b1 depend\nonly on the signature (p, q) and not on f .\nExample 5.7\nIn the hyperbolic case (q = 1), we have Q\u02dc = 1\/\u221a2 and R(x, z) = (x, gvp+q)\/\n\u221a\n2\nON TWO GEOMETRIC THETA LIFTS 75\nwith z = gz0 for some g \u2208 G, and the singularity near w \u2208 D is given by\n1\n2\n\u2211\nh\n\u2211\nn\u2208Q<0\na+(h, n)\n\u2211\n\u03bb\u2208w\u22a5\u2229Lh,\u2212n\n\u2211\n\u03b1\nsgn(\u03bb, gvp+q).\nIn particular, 8(z, f, \u03c8) is locally bounded.\nProof of Proposition 5.6\nThe argument follows, in large part, [B1, Sec. 6]. Since the function f \u2212 is exponen-\ntially decreasing as v\u2192\u221e, and 2(\u03c4, z, \u03c8) has moderate growth, the integral\u222b\nF\n\u2329\nf \u2212(\u03c4 ),2(\u03c4, z, \u03c8)\n\u232a\nd\u00b5\nover the standard fundamental domainF = {\u03c4 \u2208 H; |\u03c4 | \u2265 1, |u| \u2264 1\/2} for SL2(Z)\nconverges absolutely and defines a real analytic function on D. Moreover, the integral\nof \u3008 f +(\u03c4 ),2(\u03c4, z, \u03c8)\u3009 over the compact subset F1 \u2282 H converges absolutely and\ndefines a real analytic function on D. Hence we are left to consider the function\nh(z, s) =\n\u222b \u221e\n1\n\u222b 1\/2\n\u22121\/2\n\u2329\nf +(\u03c4 ),2(\u03c4, z, \u03c8)\n\u232a\nv\u22122\u2212s du dv.\nIf we insert the Fourier expansions, the integration over u picks out the constant term\nin the Fourier expansion of \u3008 f +(\u03c4 ),2(\u03c4, z, \u03c8)\u3009. Thus\nh(z, s) =\n\u2211\n\u03bb\u2208L#\na+\n(\n\u03bb,\u2212q(\u03bb)) \u222b \u221e\n1\nP\u03c8 (\n\u221a\nv\u03bb, z) exp\n(\n4pivq(\u03bbz)\n)\nv\u22121\u2212s dv. (5.10)\n(Note that q(\u03bbz) \u2264 0 for all \u03bb in the above sum.) By the growth of f , it has only\nfinitely many nonzero Fourier coefficients a+(h, n) with negative index n. Hence, if\nU \u2282 D is a relatively compact neighborhood of w and \u03b5 > 0, then by reduction\ntheory the set\nS f (U, \u03b5) =\n{\n\u03bb \u2208 L#; a+(\u03bb,\u2212q(\u03bb)) 6= 0 and |q(\u03bbz)| < \u03b5 for some z \u2208 U\n}\nis finite. We split the sum over \u03bb \u2208 L# in (5.10) into the sum over \u03bb \u2208 S f (U, \u03b5) and\nthe sum over \u03bb \u2208 L# \u2212 S f (U, \u03b5). The latter sum is, up to a constant factor, majorized\nby \u2211\n\u03bb\u2208L#\u2212S f (U,\u03b5)\n\u2223\u2223a+(\u03bb,\u2212q(\u03bb))\u2223\u2223 exp (2piq(\u03bbz)),\nlocally uniformly in s \u2208 C and z \u2208 U . According to Lemma 3.4, there exists a constant\n76 BRUINIER and FUNKE\nC > 0 such that this sum is majorized by\u2211\n\u03bb\u2208L#\na+(\u03bb,\u2212q(\u03bb)) 6=0\nexp\n(\nC\n\u221a|q(\u03bb)| + 2piq(\u03bbz))\n=\n\u2211\n\u03bb\u2208L#\na+(\u03bb,\u2212q(\u03bb)) 6=0\nexp\n(\nC\n\u221a|q(\u03bb)| + piq(\u03bb)) exp (\u2212 pi\n2\n(\u03bb, \u03bb)z\n)\n\u001c\n\u2211\n\u03bb\u2208L#\nexp\n(\n\u2212 pi\n2\n(\u03bb, \u03bb)z\n)\n,\nwhich clearly converges. We may conclude that the sum over \u03bb \u2208 L# \u2212 S f (U, \u03b5) in\n(5.10) (and all its derivatives) converges locally uniformly absolutely for s \u2208 C and\nz \u2208 U . In particular, it defines a C\u221e-function for z \u2208 U at s = 0.\nHence the singularity of 8(z, f, \u03c8) for z \u2208 U is dictated by the finite sum\nh1(z, s) =\n\u2211\n\u03bb\u2208S f (U,\u03b5)\na+\n(\n\u03bb,\u2212q(\u03bb)) \u222b \u221e\n1\nP\u03c8 (\n\u221a\nv\u03bb, z) exp\n(\n4pivq(\u03bbz)\n)\nv\u22121\u2212s dv.\nNote that, so far, the argument works for any polynomial P(x, z).\nSince P\u03c8 (0, z) = 0, the term for \u03bb = 0 does not contribute (and this implies that\nh1(z, s) will actually be holomorphic at s = 0). We are left to consider (for \u03bb 6= 0)\n\u03c8\u02dc(\u03bb, z, s) :=\n\u222b \u221e\n1\nP\u03c8 (\n\u221a\nv\u03bb, z) exp\n(\n4pivq(\u03bbz)\n)\nv\u22121\u2212s dv\n=\n\u2211\n\u03b1\nR\u03b1(\u03bbz, z)\n\u222b \u221e\n1\nQ\u03b1(\n\u221a\nv\u03bbz\u22a5, z) exp\n(\n4pivq(\u03bbz)\n)\nv1\/2\u2212s dv\nv\n=\n\u2211\n\u03b1\nR\u03b1(\u03bbz, z)\nq\u22121\u2211\n`=0\nQ\u03b1,`(\u03bbz\u22a5, z)\n\u222b \u221e\n1\nexp\n(\n4pivq(\u03bbz)\n)\nv`\/2+1\/2\u2212s dv\nv\n=\n\u2211\n\u03b1\nR\u03b1(\u03bbz, z)\nq\u22121\u2211\n`=0\nQ\u03b1,`(\u03bbz\u22a5, z)|4piq(\u03bbz)|s\u2212(`+1)\/2\n\u00d7 0\n(`+ 1\n2\n\u2212 s, |4piq(\u03bbz)|\n)\n. (5.11)\nHere Q\u03b1,`(\u03bbz\u22a5, z) denotes the homogeneous component of degree ` of Q\u03b1(\u03bbz\u22a5, z),\nand 0(a, x) = \u222b\u221ex e\u2212t ta\u22121 dt is the incomplete Gamma function as in [AS, (6.5.3)].\nThis shows that h1(z, s) has a meromorphic continuation in s to the whole com-\nplex plane and is holomorphic at s = 0. The claim now follows from the recur-\nrence relations of the incomplete Gamma function and from 0(q\/2, |4piq(\u03bbz)|) =\n0(q\/2)+ O(|\u03bbz|) as \u03bbz \u2192 0.\nON TWO GEOMETRIC THETA LIFTS 77\nAnalogously to the Hermitian situation, we define the map 3\u03c8 by\n3\u03c8 (z, f ) = \u2212d8(z, f, \u03c8). (5.12)\nThis is the analogue to the map3B considered in the Hermitian case. The correspond-\ning geometric properties easily follow from the relationship to the Kudla-Millson lift,\nwhich we establish in the next section.\nRemark 5.8\nIn the Hermitian case of signature (p, 2), we have now defined two singular theta lifts:\nthe Borcherds lift 8(z, f ) = 8(z, f, \u03d50) and 8(z, f, \u03c8) = 8(z, f,\u2212dc\u03d50). We see\nlater that we actually have (outside Z( f ))\ndc8(z, f ) = \u22128(z, f, \u03c8);\nthat is, one can interchange the differential operator dc on the orthogonal domain D\nwith the regularized SL2(R)-integral.\nRemark 5.9\nAnalogously to [Br2, Chap. 4], one can show that 8(z, f, \u03c8) is harmonic, that is,\nannihilated by the Laplacian for the symmetric space D. In particular, 8(z, f, \u03c8) is\nreal analytic.\n6. Main results\nRecall (with \u03ba = (p + q)\/2 and k = 2 \u2212 \u03ba) the map \u03bek( f ) = R\u2212k(vk f\u00af ) \u2208 S\u03ba,L for\nf \u2208 H+k,L\u2212 . Since2(\u03c4, z, \u03d5KM ) is moderately increasing in \u03c4 , we can therefore study\nthe scalar product (\n2(\u03c4, z, \u03d5KM ), \u03bek( f )\n)\n\u03ba,L \u2208 Z q(X).\nTHEOREM 6.1\nLet V be of signature (p, q), and let f \u2208 H+k,L\u2212 . Then, outside Z( f ), the set of\nsingularities of the lift 8(z, f, \u03c8), we have(\n2(z, \u03d5KM ), \u03bek( f )\n)\n\u03ba,L \u2212 a+(0, 0)eq = \u2212d8(z, f, \u03c8) = 3\u03c8 (z, f ). (6.1)\nFor the Borcherds lift in signature (p, 2), we have, outside Z( f ),(\n2(z, \u03d5KM ), \u03bek( f )\n)\n\u03ba,L + a+(0, 0) = ddc8(z, f ) = 3B(z, f ). (6.2)\nHere a+(0, 0) is the constant coefficient of the Fourier expansion of f , eq is the Euler\nform on D for q even (and zero for q odd), and  = \u2212e2 is the Ka\u00a8hler form for the\nHermitian domain Dp,2.\n78 BRUINIER and FUNKE\nTHEOREM 6.2\n(i) 3\u03c8 ( f ) extends to a smooth closed q-form of moderate growth on X .\n(ii) If f \u2208 M !k,L\u2212 is weakly holomorphic, then\n3\u03c8 ( f ) = \u2212a+(0, 0)eq .\n(iii) In particular, 3\u03c8 induces a map\n3\u03c8 : H+k,L\u2212\/M !k,L\u2212 \u2212\u2192 Hq(X)\/Ceq .\nProof\nThis follows immediately from Theorem 6.1. The left-hand side of (6.1) is smooth and\nhas moderate growth, which gives (i). The assertion (ii) follows from \u03bek( f ) = 0 for\nf \u2208 M !k,L\u2212 .\nObserve that in view of (6.2) one obtains new proofs of the corresponding properties\nof the Borcherds lift for O(p, 2) listed in Section 5.2.1.\nWe denote by (\u00b7, \u00b7)X the natural pairing between Z qp\u2212`rd (X), the closed rapidly\ndecreasing (qp\u2212 `)-forms, andZ `mg(X), the closed `-forms of moderate growth. Re-\ncall that by Poincare\u00b4 duality this induces a nondegenerate pairing between Hqp\u2212`c (X)\nand H `(X) (see [BT]).\nOn the other hand, recall the pairings { , } and { , }\u2032 between M\u03ba,L and H+k,L\u2212\ndefined in (3.9) and (3.15).\nTHEOREM 6.3\nThe Kudla-Millson lift 3KM : Z q(p\u22121)rd (X) \u2192 M\u03ba,L and the lift 3\u03c8 : H+k,L\u2212 \u2192\nZ\nq\nmg(X) are adjoint in the following sense: For any \u03b7 \u2208 Z q(p\u22121)rd (X) and any f \u2208\nH+k,L\u2212 , we have (\n\u03b7,3\u03c8 ( f )\n)\nX =\n{\n3KM (\u03b7), f\n}\u2032\n.\nMoreover, this duality factors through the nondegenerate pairings on the cohomology\nlevel and that of M\u03ba,L with H+k,L\u2212\/M\n!!\nk,L\u2212 .\nProof\nUsing (6.1), we see that(\n\u03b7,3\u03c8 ( f )\n)\nX + a+(0, 0)(\u03b7, eq)X =\n(\n\u03b7, (2KM (\u03c4, Z), \u03bek( f ))\u03ba,L\n)\nX\n= ((\u03b7,2KM (\u03c4, Z))X , \u03bek( f ))\u03ba,L\n= {3KM (\u03b7), f }.\nON TWO GEOMETRIC THETA LIFTS 79\nHere, in the second equality, we have exchanged the order of integration. This is valid\nbecause the latter integrals converge absolutely. Now the assertion follows from the\nFourier expansion of the Kudla-Millson lift (see Th. 5.1) and the definition of the\npairing { , }\u2032.\nRemark 6.4\nIn signature (p, 2), the statement of Theorem 6.3 holds with 3\u03c8 replaced by the lift\n3B .\nCOROLLARY 6.5\nFor \u03b7 \u2208 Z q(p\u22121)rd (X) and f \u2208 H+k,L\u2212 , we have(\n\u03b7,3\u03c8 ( f )\n)\nX =\n\u222b\nZ( f )\n\u03b7.\nFor q even, this also holds with \u03b7 = ep\u22121q . In particular, 3\u03c8 ( f ) is a harmonic repre-\nsentative of the Poincare\u00b4 dual form of the cycle Z( f ).\nProof\nBy Theorem 5.1 and Proposition 3.5, we have{\n3KM (\u03b7), f\n} = a+(0, 0) \u222b\nX\n\u03b7 \u2227 eq +\n\u2211\nh\u2208L#\/L\n\u2211\nn<0\na+(h, n)\n\u222b\nZ(h,n)\n\u03b7\n= a+(0, 0)(\u03b7, eq)X +\n\u222b\nZ( f )\n\u03b7.\nThe claim now follows from Theorem 6.3. The above calculation also holds for \u03b7 =\nep\u22121q (see [KM3]); hence the corollary is valid in this case as well.3\u03c8 ( f ) is harmonic\nby Remark 5.9 or, alternatively, by [KM3, Th. 4.1].\nProof of Theorem 6.1\nWe would like to use the adjointness of R\u2212k and \u2212L2\u2212k to compute(\n2(z, \u03d5KM ), \u03bek( f )\n)\n2\u2212k,L =\n(\n2(z, \u03d5KM ), R\u2212k(vk f\u00af )\n)\n2\u2212k,L .\nHowever, due to the rapid growth of f , the scalar product (L2\u2212k2(z, \u03d5KM ), vk f\u00af )\u2212k,L\ndoes not converge. We have to proceed more carefully.\nLetFt be the truncated fundamental domain (see (3.11)) for the action of SL2(Z)\non H. For g \u2208 A2\u2212k,L and h \u2208 A\u2212k,L\u2212 , we then have (see [Br2, Lem. 4.2], correcting\n80 BRUINIER and FUNKE\na sign error)\u222b\nFt\n\u3008g, R\u2212kh\u3009v\u2212k du dv = \u2212\n\u222b\nFt\n\u3008L2\u2212kg, h\u3009v2\u2212k du dv\n+\n\u222b 1\/2\n\u22121\/2\n\u2329\ng(u + i t), h(u + i t)\u232av\u2212k du. (6.3)\nNote that we do not require any regularity for g or h at the cusp. We apply (6.3) for\ng = 2(\u03c4, z, \u03d5KM ) and h = vk f\u00af and obtain the following.\nLEMMA 6.6\nWe have (\n2(z, \u03d5KM ), R\u2212k(vk f\u00af )\n)\n2\u2212k,L\n= lim\nt\u2192\u221e\n\u222b\nFt\n\u2329\n2(\u03c4, z, \u03d5KM ), R\u2212kvk f\u00af\n\u232a\nv\u2212k du dv (6.4)\n= lim\nt\u2192\u221e\n(\n\u2212\n\u222b\nFt\n\u2329\nL2\u2212k2(\u03c4, z, \u03d5KM ), f\u00af\n\u232a du dv\nv2\n(6.5)\n+\n\u222b 1\/2\n\u22121\/2\n\u2329\n2(u + i t, z, \u03d5KM ), f (u + i t)\n\u232a\ndu\n)\n. (6.6)\nNext, we would like to compute the limit in (6.5) and (6.6) separately. We see that\nthis is possible for z \/\u2208 Z( f ), while for z \u2208 Z( f ) the limits of both terms do not\nexist (in (6.5) and (6.6), the singularities cancel each other out). We first consider\nthe term (6.6). The integration picks out the zeroth Fourier coefficient of \u30082(u +\ni t, z, \u03d5KM ), f (u + i t)\u3009.\nLEMMA 6.7\nOutside Z( f ), we have\nlim\nt\u2192\u221e\n\u222b 1\/2\n\u22121\/2\n\u2329\n2(u + i t, z, \u03d5KM ), f (u + i t)\n\u232a\ndu = a+(0, 0)eq ,\nwhile the limit does not exist for z \u2208 Z( f ). In particular, the limit defines a smooth\ndifferential form on D \u2212 Z( f ) which extends smoothly to D.\nProof\nSince f \u2212 is rapidly decreasing in v, we see that\nlim\nt\u2192\u221e\n\u222b 1\/2\n\u22121\/2\n\u2329\n2(u + i t, z, \u03d5KM ), f \u2212(u + i t)\n\u232a\ndu = 0.\nON TWO GEOMETRIC THETA LIFTS 81\nWe write \u03d5KM (x, z) = PKM (x, z)\u03d50(x, z), where PKM is a polynomial in\n[P(V (R))\u2297A q(D)]G depending only on xz\u22a5 . For f +, we then have\u222b 1\/2\n\u22121\/2\n\u2329\n2(u + i t, z, \u03d5KM ), f +(u + i t)\n\u232a\ndu\n= \u03d5KM (0)a+(0, 0)+\n\u2211\n\u03bb\u2208L#\u22120\nPKM (\n\u221a\nt\u03bb, z)a+\n(\n\u03bb,\u2212q(\u03bb))e4piq(\u03bbz)t .\nFor z \u2208 Z( f ) (hence \u03bbz = 0), the sum clearly diverges as t \u2192 \u221e; otherwise, the\nsum is rapidly decreasing in t by arguments similar to the proof of Proposition 5.6.\nThe lemma now follows from \u03d5KM (0) = eq (see (4.1)).\nLEMMA 6.8\nThe quantity in (6.5) is given by\nlim\nt\u2192\u221e\n\u222b\nFt\n\u2329\nL2\u2212k2(\u03c4, z, \u03d5KM ), f\u00af\n\u232a\nd\u00b5 =\n\u222b reg\n0\u2032\\H\n\u2329\nL2\u2212k2(\u03c4, z, \u03d5KM ), f\u00af\n\u232a\nd\u00b5\n=\n\u222b reg\n0\u2032\\H\n\u2329\n2(\u03c4, z, d\u03c8), f\u00af\n\u232a\nd\u00b5.\nThis defines a smooth form on D \u2212 Z( f ) which extends smoothly to all of D.\nProof\nThe second equality follows from the fundamental fact\nL2\u2212k2(\u03c4, z, \u03d5KM ) = 2(\u03c4, z, d\u03c8),\nwhich is Theorem 4.2. From Lemmas 6.6 and 6.7, it follows that the limit exists,\ndefining a smooth form outside Z( f ). As (6.4) defines a smooth form on D, the limit\nextends to all of D. As the limit exists, it is, by definition, the regularized integral.\n(This corresponds to L\u03d5KM (0) = d\u03c8(0) = 0.)\nCombining Lemmas 6.6, 6.7, and 6.8, we obtain the following outside Z( f ):(\n2(z, \u03d5KM ), \u03bek( f )\n)\n2\u2212k,L = \u2212\n\u222b reg\n0\u2032\\H\n\u2329\n2(\u03c4, z, d\u03c8), f\u00af\n\u232a\nd\u00b5+ a+(0, 0)eq . (6.7)\nThe identity (6.1) now follows from the next lemma.\nLEMMA 6.9\nWe have\u222b reg\n0\u2032\\H\n\u2329\n2(\u03c4, z, d\u03c8), f\u00af\n\u232a\nd\u00b5 = d\n\u222b reg\n0\u2032\\H\n\u2329\n2(\u03c4, z, \u03c8), f\u00af\n\u232a\nd\u00b5 = d8(z, f, \u03c8).\n82 BRUINIER and FUNKE\nProof\nWe recall that because P\u03c8 (0, z) = 0, we have\u222b reg\n0\u2032\\H\n\u2329\n2(\u03c4, z, \u03c8), f\u00af\n\u232a\nd\u00b5 = lim\nt\u2192\u221e\n\u222b\nFt\n\u2329\n2(\u03c4, z, \u03c8), f\u00af\n\u232a\nd\u00b5.\nSince Ft is compact, we only have to justify the interchange of the differentiation d\nwith the limit t \u2192\u221e. Arguing as in the proof of Proposition 5.6 (using the notation\nfrom there), we find that it suffices to show that\ndh(z, 0) =\n\u2211\n\u03bb\u2208L#\na+\n(\n\u03bb,\u2212q(\u03bb)) \u222b \u221e\n1\ndP\u03c8 (\n\u221a\nv\u03bb, z) exp\n(\n4pivq(\u03bbz)\n) dv\nv\n. (6.8)\nIf U \u2282 D is any relatively compact open subset and \u03b5 > 0, we split the sum over\n\u03bb \u2208 L# into the finite sum over \u03bb \u2208 S f (U, \u03b5) and the sum over \u03bb \u2208 L#\u2212S f (U, \u03b5). An\nestimate for the latter sum, as in Proposition 5.6, shows that it converges uniformly\nabsolutely on U , justifying the interchange of differentiation and the limit. Thus it\nsuffices to show that\nd\n\u222b \u221e\n1\nP\u03c8 (\n\u221a\nv\u03bb, z) exp\n(\n4pivq(\u03bbz)\n) dv\nv\n=\n\u222b \u221e\n1\ndP\u03c8 (\n\u221a\nv\u03bb, z) exp\n(\n4pivq(\u03bbz)\n) dv\nv\nfor \u03bb \u2208 S f (U, \u03b5) and z \u2208 U \u2212 Z( f ). This follows from the exponential decay of the\nintegrands as v\u2192\u221e.\nFor (6.2), we note that in this case we have \u03c8 = \u2212dc\u03d50 (see (4.8)). Therefore we just\nneed to show that\u222b reg\n0\u2032\\H\ndc\n\u2329\n2(\u03c4, z, \u03d50), f\u00af\n\u232a\nd\u00b5 = dc\n\u222b reg\n0\u2032\\H\n\u2329\n2(\u03c4, z, \u03d50), f\u00af\n\u232a\nd\u00b5 = dc8(z, f, \u03d50). (6.9)\nThis goes through as above with one extra point: Since \u03d50(0) = 1 6= 0, the constant\nterm of \u30082(\u03c4, z, \u03d50), f\u00af \u3009 also involves the term a+(0, 0)v. One sees that the regular-\nized integral is actually given by\u222b reg\n0\u2032\\H\n\u2329\n2(\u03c4, z, \u03d50), f\u00af\n\u232a\nd\u00b5 = a+(0, 0)C+ lim\nt\u2192\u221e\n\u222b\nFt\n(\u30082(\u03c4, z, \u03d50), f\u00af \u3009\u2212a+(0, 0)v) d\u00b5,\n(6.10)\nwhere C is a constant not depending on z (namely, the constant term in the Laurent\nexpansion at s = 0 of limt\u2192\u221e\n\u222b\nFt\nv1\u2212s d\u00b5). Applying dc to the right-hand side, one\ncan now interchange differentiation and the limit as above. One obtains (6.9), which\nimplies (6.2).\nThis completes the proof of Theorem 6.1.\nON TWO GEOMETRIC THETA LIFTS 83\n7. The singular theta lift as a current\nIn this section we consider the current that is induced by the singular theta lift8( f, \u03c8)\ndefined in (5.9).\nConsider a top degree form \u03c6 \u2208 Apq(0\\D). We then have\u222b\n0\\D\n\u03c6(z) =\n( \u222b\n0\\G\n\u03c6(g)] dg\n)\n(1p),\nwhere \u03c6 on the right-hand side is considered as an element in [C\u221e(0\\G)\u2297\u2227pq p\u2217]K .\n(We frequently use this identification without further comment.) Here 1p is a properly\noriented basis vector for\n\u2227pq p ' R of length one with respect to the Killing form.\nMoreover, dg = dz dk, where dz is the measure on D coming from the Killing form\nand vol(K , dk) = 1.\nWe now pick appropriate coordinates for D. We set H = Gv1 , the stabilizer in G\nof the first basis vector v1 of V . Then H is the fixed-point set of an involution \u03c4 on G.\nOn the Lie algebra level, we obtain a decomposition g = h + q into \u00b11 eigenspaces\nof \u03c4 . Then L = H \u2229 K is a maximal compact subgroup of H . We write 0H = 0v1 .\nThere is a diffeomorphism (see [KM2, Sec. 4], [F, Sec. 2])\n9 : H \u00d7L (p \u2229 q) \u2212\u2192 D = G\/K ,\n(h, Y ) 7\u2192 h exp(Y )K .\nLet at = exp(t X1p+q) for t \u2208 R, and let A = {at ; t \u2208 R} ' R be the one-parameter\nsubgroup of G associated to the maximal abelian subspace of p \u2229 q generated by\nX1p+q . We write A\u03b5 = {at ; t \u2265 \u03b5}. We have a decomposition G = H AK and, with\na positive constant C depending on the normalizations of the invariant measures, the\nintegral formula (see [F, Sec. 2])\u222b\nG\n\u03c6(g) dg = C\n\u222b\nK\n\u222b\nA0\n\u222b\nH\n\u03c6(hatk)| sinh(t)|q\u22121 cosh(t)p\u22121 dh dt dk.\n(If q = 1, one has to replace A0 by A, corresponding to the fact that, in this case, Dv1\nsplits D into two components.)\nPROPOSITION 7.1\nThe (q \u2212 1)-form 8( f, \u03c8) is locally integrable; that is,\u222b\nX\n\u03b7 \u22278( f, \u03c8) <\u221e\nfor \u03b7 \u2208 A(p\u22121)q+1c (X).\n84 BRUINIER and FUNKE\nProof\nFor q = 1, the statement is clear since, in that case, 8( f, \u03c8) is locally bounded (see\nProp. 5.6, Exam. 5.7). For q 6= 1, we need to show that\u222b\n0\\G\n\u03b7(g) \u22278( f, \u03c8)(g) dg <\u221e.\nWe can replace 8( f, \u03c8)(g) by the part that gives rise to its singularities\u2211\nh\n\u2211\nn\u2208Q<0\na+(h, n)\n\u2211\n\u03bb\u2208Lh,\u2212n\n\u03c8\u02dc(g\u22121\u03bb)\nwith \u03c8\u02dc(\u03bb) := \u03c8\u02dc(\u03bb, z0, 0) given by setting s = 0 in (5.11). Now\u2211\n\u03bb\u2208Lh,\u2212n\n\u03c8\u02dc(g\u22121\u03bb) =\n\u2211\n\u03bb\u22080\\Lh,\u2212n\n\u2211\n\u03b3\u22080\u03bb\\0\n\u03c8\u02dc(\u03b3\u22121g\u22121\u03bb),\nand therefore, by unfolding,\u222b\n0\\G\n\u2211\nh\n\u2211\nn\u2208Q<0\na+(h, n)\n\u2211\n\u03bb\u2208Lh,\u2212n\n\u03b7(g) \u2227 \u03c8\u02dc(g\u22121\u03bb) dg\n=\n\u2211\nh\n\u2211\nn\u2208Q<0\na+(h, n)\n\u2211\n\u03bb\u22080\\Lh,\u2212n\n\u222b\n0\u03bb\\G\n\u03b7(g) \u2227 \u03c8\u02dc(g\u22121\u03bb) dg.\nThis is a finite sum (since a+(h, n) = 0 for n \u001c 0), so we only have to show the\nexistence of the integral for a given \u03bb of positive length. We can assume \u03bb = \u221amv1\nfor some m > 0. We have\u222b\n0H \\G\n\u03b7(g) \u2227 \u03c8\u02dc(g\u22121\u221amv1) dg\n= C \u2032\n\u222b\n0H \\H\n\u222b \u221e\n0\n\u03b7(hat ) \u2227 \u03c8\u02dc(a\u22121t h\u22121\n\u221a\nmv1) sinh(t)q\u22121 cosh(t)p\u22121 dt dh\n(7.1)\nwith a positive constant C \u2032. But now h\u22121v1 = v1 and\na\u22121t\n\u221a\nmv1 = cosh(t)\n\u221a\nmv1 \u2212 sinh(t)\n\u221a\nmvp+q .\nHence\n(a\u22121t\n\u221a\nmv1)z0 = \u2212 sinh(t)\n\u221a\nmvp+q , (7.2a)\n(a\u22121t\n\u221a\nmv1)z\u22a50 = cosh(t)\n\u221a\nmv1, (7.2b)\nON TWO GEOMETRIC THETA LIFTS 85\nso (see (5.11))\n\u03c8\u02dc(a\u22121t\n\u221a\nmv1) = \u22121\u221a\n2pi\n\u2211\n\u03b1\nR\u03b1(vp+q)\nq\u22121\u2211\n`=0\nQ\u03b1,`\n(\u221a\nm cosh(t)v1\n)\n\u00d7 (2pim sinh2(t))\u2212`\/20(`+ 1\n2\n, 2pim sinh2(t)\n)\n. (7.3)\nTherefore the integrand in (7.1) is bounded as t \u2192 0. On the other hand,\n\u03c8\u02dc(a\u22121t h\u22121v1) is exponentially decreasing in et (uniformly in h). Since \u03b7 has com-\npact support and 0H\\H has finite volume, we conclude that (7.1) converges. Hence\nthe above unfolding is valid and the proposition is proved.\nRecall that a locally integrable `-form \u03c9 on X defines a current [\u03c9] on X , that is, a\nlinear functional on A pq\u2212`c (X), via\n[\u03c9](\u03b7) :=\n\u222b\nX\n\u03b7 \u2227 \u03c9\nfor \u03b7 \u2208 A pq\u2212`c (X). For a current T , we define its exterior derivative by\n(dT )(\u03b7) = (\u22121)deg(\u03b7)+1T (d\u03b7).\nTHEOREM 7.2\nLet \u03b4Z( f ) be the delta current for the special cycle Z( f ); and for a locally integrable\ndifferential form \u03c9, we denote the associated current by [\u03c9]. Then\nd[8( f, \u03c8)] + \u03b4Z( f ) = [3\u03c8 ( f )]. (7.4)\nProof\nLet \u03b7 \u2208 A (p\u22121)qc (X). Then\nd[8( f, \u03c8)](\u03b7) = (\u22121)(p\u22121)q+1\n\u222b\nX\nd\u03b7 \u22278( f, \u03c8)\n= (\u22121)(p\u22121)q+1\n\u222b\nX\nd\n(\n\u03b7 \u22278( f, \u03c8))+ \u222b\nX\n\u03b7 \u2227 d8( f, \u03c8).\nTo obtain the theorem, we therefore only need to show that\n(\u22121)(p\u22121)q+1\n\u222b\nX\nd\n(\n\u03b7 \u22278( f, \u03c8)) = \u222b\nZ( f )\n\u03b7.\nBy Stokes\u2019s theorem, we can modify the differential form 8( f, \u03c8) by a smooth form\nwithout changing the integral. Hence we can replace it by its singular part, as in\n86 BRUINIER and FUNKE\nProposition 7.1. By unfolding, we see that\u222b\nX\nd\n(\n\u03b7 \u22278( f, \u03c8)) =\u2211\nh\n\u2211\nn\u2208Q<0\na+(h, n)\n\u2211\n\u03bb\u22080\\Lh,\u2212n\n\u222b\n0\u03bb\\D\nd\n(\n\u03b7 \u2227 \u03c8\u02dc(\u03bb, z, 0)).\nAgain, this is a finite sum, so it suffices to consider the integral on the right-hand side\nfor \u03bb = \u221amv1.\nFor \u03b5 > 0,\nU\u03b5 := D \u22129\n(\nH \u00d7 {t X1p+q; t \u2265 \u03b5}\n)\ndefines an open neighborhood of the cycle Dv1 . (For q = 1, replace the condition\nt \u2265 \u03b5 by |t | \u2265 \u03b5.) Then, by Stokes\u2019s theorem, we obtain\u222b\n0H \\D\nd\n(\n\u03b7 \u2227 \u03c8\u02dc(\u221amv1, z, 0)\n) = lim\n\u03b5\u21920\n\u222b\n\u2202(0H \\(D\u2212U\u03b5))\n\u03b7 \u2227 \u03c8\u02dc(\u221amv1, z, 0). (7.5)\nBy the analogue for (7.1) (which follows from the considerations in [F, Sec. 2]), we\nsee that (7.5) is equal to\nC lim\n\u03b5\u21920\n\u222b\n0H \\H\n\u03b7(ha\u03b5) \u2227 \u03c8\u02dc(a\u2212\u03b5\n\u221a\nmv1) sinh(\u03b5)q\u22121 cosh(\u03b5)p\u22121 dh(1p\/RX1p+q ) (7.6)\nfor some universal constant C 6= 0.\nWe consider (7.2) and (7.3) (with t = \u03b5). For (7.6), only the terms with ` = q \u2212 1\ncan contribute. But\nQ\u03b1,q\u22121\n(\u221a\nm cosh(\u03b5)v1, z0\n) = {(\u221a2m cosh(\u03b5))q\u22121, \u03b1 = (1, 1, . . . , 1),\n0 otherwise.\nWe obtain\nC lim\n\u03b5\u21920\n\u222b\n0H \\H\n\u03b7(ha\u03b5)\u2227 \u03c8\u02dc(a\u2212\u03b5\u221amv1) sinh(\u03b5)q\u22121 cosh(\u03b5)p\u22121 dh = C \u2032\n\u222b\n0H \\H\n\u03b7(h) dh\nwith a constantC and \u03c8\u02dc(\u03bb) = \u03c8\u02dc(\u03bb, z0, 0) as before. Therefore the theorem holds with\n\u03b4Z( f ) replaced by C \u2032\u2032\u03b4Z( f ) with a certain constant C \u2032\u2032 independent of \u03b7. We conclude\nthat the constant is equal to 1 by noting that this is the case for \u03b7 closed: In (7.4),\nd[8( f, \u03c8)](\u03b7) = 0, while [3\u03c8 ( f )](\u03b7) = (\u03b7,3\u03c8 ( f ))X =\n\u222b\nZ( f ) \u03b7 by Corollary 6.5.\nTheorem 7.2 can be reformulated by saying that the pair (Z( f ),8(z, f, \u03c8)) defines\na class in the group of differential characters introduced by Cheeger and Simons (see\n[C], [CS]). Note that we can consider the group of differential characters as the ana-\nlogue for real manifolds of the arithmetic Chow group (see [GS]).\nON TWO GEOMETRIC THETA LIFTS 87\nTHEOREM 7.3\nIn the Hermitian case of q = 2, the Borcherds lift 8(z, f ) defines a Green\u2019s current\nfor the divisor Z( f ); that is,\nddc[8(z, f )] + \u03b4Z( f ) = [3B(z, f )].\nProof\nUsing \u2212dc8(z, f ) = 8(z, f, \u03c8), one easily obtains\n(ddc\u03b7)8(z, f ) = \u03b7 \u2227 ddc8(z, f )+ d((dc\u03b7)8(z, f )+ \u03b7 \u22278(z, f, \u03c8)).\nThe theorem now follows from Theorem 7.2 and the logarithmic growth of 8(z, f )\nalong Z( f ).\nThis result also follows from the splitting (see (5.4)) of8(z, f ), obtained in [Br2] via\nthe Fourier expansion, and from the Poincare\u00b4-Lelong formula.\nObserve that in the generic case the space X is noncompact. Thus, to study inter-\nsection theory, one has to consider a smooth compactification X\u02dc of X . In particular,\nin the arithmetic intersection theory of special divisors at the Archimedean place, one\nhas to study8(z, f ) as a current on X\u02dc . This requires a detailed analysis of the growth\nof 8(z, f ) at the boundary, which turns out to be of log and log-log type (for the\ncase of Hilbert modular surfaces, see [BBK]). One has to work with the extension of\narithmetic intersection theory provided in [BKK].\nOda and Tsuzuki [OT] constructed Green\u2019s functions for the special divisors\nby means of Poincare\u00b4 series involving the secondary spherical function. By [BK,\nTh. 4.7],8(z, f ) can be written as a linear combination of Green\u2019s functions of [OT]\nin an explicit way.\nWe also compare 8(z, f ) with Green\u2019s functions constructed by Kudla [K2],\n[K1]. He has introduced for x \u2208 V (R), x 6= 0, and z \u2208 D, the function\n\u03be0(x, z) = \u2212Ei (2pi(xz, xz)),\nwhich for (x, x) > 0 turns out to be a Green\u2019s function for the cycle Dx on the\nHermitian domain D and is smooth otherwise. Here, forw \u2208 C, Ei(w) = \u222b w\u2212\u221e et\/t dt\nis the exponential integral. While \u03be0 is not a Schwartz function on V (R), we can still\ndefine \u03be(x, \u03c4, z) = \u03be0(\u221avx, z)epi i\u03c4(x,x) for \u03c4 \u2208 H, and we then have (see [K2], [K1])\nddc\u03be(x, \u03c4, z) = \u03d5KM (x, \u03c4, z)\nfor x 6= 0. On the other hand, we can apply the lowering operator L\u03ba on H to \u03be and\neasily check that\nL\u03ba\u03be(x, \u03c4, z) = \u2212\u03d50(x, \u03c4, z).\n88 BRUINIER and FUNKE\nThis provides a different proof of Theorem 4.4, that is, \u03c6 := L\u03ba\u03d5KM = \u2212ddc\u03d50, and\nin summary, we obtain the following commutative diagram:\n\u03be(x, \u03c4, z) \u001f\nL\u03ba \/\/\n_\nddc\n\u000f\u000f\n\u2212\u03d50(x, \u03c4, z)_\nddc\n\u000f\u000f\n\u03d5KM (x, \u03c4, z)\n\u001f L\u03ba \/\/ \u03c6(x, \u03c4, z)\nOne can then use the ideas of the proof of Theorem 6.1 (together with (6.10) to account\nfor the problem that \u03be is not defined for x = 0) to express 8(z, f ) in terms of \u03be .\nFinally, we mention that one can use the ideas of this paper to give a somewhat\ndifferent proof of the results in [K2] and [BK] relating the geometric degrees (and\nthe Archimedean contribution to the arithmetic degrees) of the special cycles to the\ncoefficients of certain Eisenstein series and their derivatives (see also [K1], [KRY]).\nAcknowledgments. This project was first conceived and developed during three visits\nfrom 1999 to 2002 of Funke in Heidelberg. He thanks the Forschergruppe Arithmetik\nat Heidelberg and E. Freitag, in particular, for their support of these visits. He is also\nindebted to J. Burgos and J. Naranjo at the University of Barcelona for their patient\nhospitality in the summer of 2002, where major work on this paper was done. We also\nthank J. Burgos, E. Freitag, W. Kohnen, S. Kudla, and J. Millson for useful discussions\nand comments on this project. Finally, we thank the referees for their detailed and very\nhelpful suggestions.\nReferences\n[AS] M. ABRAMOWITZ and I. STEGUN, eds., Pocketbook of Mathematical Functions, Harri\nDeutsch, Thun, Switzerland, 1984. MR 0768931\n[B1] R. E. BORCHERDS, Automorphic forms with singularities on Grassmannians, Invent.\nMath. 132 (1998), 491 \u2013 562. MR 1625724\n[B2] , The Gross-Kohnen-Zagier theorem in higher dimensions, Duke Math. J. 97\n(1999), 219 \u2013 233. MR 1682249\n[BT] R. BOTT and L. W. TU, Differential Forms in Algebraic Topology, Grad. Texts in Math.\n82, Springer, New York, 1982. MR 0658304\n[Br1] J. H. BRUINIER, Borcherds products and Chern classes of Hirzebruch-Zagier divisors,\nInvent. Math. 138 (1999), 51 \u2013 83. MR 1714336\n[Br2] , Borcherds Products on O(2, l) and Chern Classes of Heegner Divisors,\nLecture Notes in Math. 1780, Springer, Berlin, 2002. MR 1903920\n[BBK] J. H. BRUINIER, J. I. BURGOS GIL, and U. KU\u00a8HN, Borcherds products and arithmetic\nintersection theory on Hilbert modular surfaces, preprint,\narXiv:math.NT\/0310201\nON TWO GEOMETRIC THETA LIFTS 89\n[BK] J. H. BRUINIER and U. KU\u00a8HN, Integrals of automorphic Green\u2019s functions associated to\nHeegner divisors, Int. Math. Res. Not. 2003, no. 31, 1687 \u2013 1729. MR 1981482\n[BKK] J. I. BURGOS GIL, J. KRAMER, and U. KU\u00a8HN, Cohomological arithmetic Chow rings,\npreprint, 2003, http:\/\/www.institut.math.jussieu.fr\/Arakelov\/0012\/\n[C] J. CHEEGER, \u201cMultiplication of differential characters\u201d in Symposia Mathematica, Vol.\nXI (Rome, 1972), Academic Press, London, 1973, 441 \u2013 445. MR 0488077\n[CS] J. CHEEGER and J. SIMONS, \u201cDifferential characters and geometric invariants\u201d in\nGeometry and Topology (College Park, Md., 1983\/84), Lecture Notes in Math.\n1167, Springer, Berlin, 1985, 50 \u2013 80. MR 0827262\n[F] M. FLENSTED-JENSEN, Discrete series for semisimple symmetric spaces, Ann. of\nMath. (2) 111 (1980), 253 \u2013 311. MR 0569073\n[Fr] E. FREITAG, Siegelsche Modulfunktionen, Grundlehren Math. Wiss. 254, Springer,\nBerlin, 1983. MR 0871067\n[Fu] J. FUNKE, Heegner divisors and nonholomorphic modular forms, Compositio Math.\n133 (2002), 289 \u2013 321. MR 1930980\n[FM1] J. FUNKE and J. MILLSON, Cycles with local coefficients for orthogonal groups and\nvector-valued Siegel modular forms, preprint, arXiv:math.NT\/0408050\n[FM2] , in preparation.\n[GS] H. GILLET and C. SOULE\u00b4, \u201cArithmetic Chow groups and differential characters\u201d in\nAlgebraic K -Theory: Connections with Geometry and Topology (Lake Louise,\nCanada, 1987), NATO Adv. Sci. Inst. Ser. C Math. Phys. Sci. 279, Kluwer,\nDordrecht, 1989, 29 \u2013 68. MR 1045844\n[HM] J. A. HARVEY and G. MOORE, Algebras, BPS states, and strings, Nuclear Phys. B 463\n(1996), 315 \u2013 368. MR 1393643\n[H] D. A. HEJHAL, The Selberg Trace Formula for PSL(2,R), Vol. 2, Lecture Notes in\nMath. 1001, Springer, Berlin, 1983. MR 0711197\n[KN] S. KOBAYASHI and K. NOMIZU, Foundations of Differential Geometry, Vol. 2,\nInterscience Tracts in Pure Appl. Math. 15, Wiley, New York, 1969. MR 0238225\n[K1] S. S. KUDLA, Central derivatives of Eisenstein series and height pairings, Ann. of\nMath. (2) 146 (1997), 545 \u2013 646. MR 1491448\n[K2] , Integrals of Borcherds forms, Compositio Math. 137 (2003), 293 \u2013 349.\nMR 1988501\n[KM1] S. S. KUDLA and J. J. MILLSON, The theta correspondence and harmonic forms, I,\nMath. Ann. 274 (1986), 353 \u2013 378. MR 0842618\n[KM2] , The theta correspondence and harmonic forms, II, Math. Ann. 277 (1987),\n267 \u2013 314. MR 0886423\n[KM3] , Tubes, cohomology with growth conditions and an application to the theta\ncorrespondence, Canad. J. Math. 40 (1988), 1 \u2013 37. MR 0928212\n[KM4] , Intersection numbers of cycles on locally symmetric spaces and Fourier\ncoefficients of holomorphic modular forms in several complex variables, Inst.\nHautes E\u00b4tudes Sci. Publ. Math. 71 (1990), 121 \u2013 172. MR 1079646\n[KRY] S. S. KUDLA, M. RAPOPORT, and T. YANG, Derivatives of Eisenstein series and Faltings\nheights, Compos. Math. 140 (2004), 887 \u2013 951. MR 2059224\n90 BRUINIER and FUNKE\n[N] D. NIEBUR, A class of nonanalytic automorphic functions, Nagoya Math. J. 52 (1973),\n133 \u2013 145. MR 0337788\n[O] T. ODA, On modular forms associated with indefinite quadratic forms of signature\n(2, n \u2212 2), Math. Ann. 231 (1977), 97 \u2013 144. MR 0466026\n[OT] T. ODA and M. TSUZUKI, Automorphic Green functions associated with the secondary\nspherical functions, Publ. Res. Inst. Math. Sci. 39 (2003), 451 \u2013 533. MR 2001185\n[RS] S. RALLIS and G. SCHIFFMANN, On a relation between S\u02dcL2 cusp forms and cusp forms\non tube domains associated to orthogonal groups, Trans. Amer. Math. Soc. 263\n(1981), 1 \u2013 58. MR 0590410\n[S] T. SHINTANI, On construction of holomorphic cusp forms of half integral weight,\nNagoya Math. J. 58 (1975), 83 \u2013 126. MR 0389772\n[TW] Y. L. TONG and S. P. WANG, Harmonic forms dual to geodesic cycles in quotients of\nSU(p, 1), Math. Ann. 258 (1981), 298 \u2013 318. MR 0649201\n[W] S. P. WANG, Correspondence of modular forms to cycles associated to O(p, q), J.\nDifferential Geom. 22 (1985), 151 \u2013 223. MR 0834276\n[We] R. O. WELLS, JR., Differential Analysis on Complex Manifolds, 2nd ed., Grad. Texts in\nMath. 65, Springer, New York, 1980. MR 0608414\nBruinier\nMathematisches Institut, Universita\u00a8t zu Ko\u00a8ln, Weyertal 86\u201390, D-50931 Ko\u00a8ln, Germany;\nbruinier@math.uni-koeln.de\nFunke\nDepartment of Mathematical Sciences, New Mexico State University, Post Office Box 30001,\nDepartment 3MB, Las Cruces, New Mexico 88001, USA; jfunke@nmsu.edu\n"}