{"doi":"10.1109\/TPWRD.2005.858785","coreId":"66742","oai":"oai:dro.dur.ac.uk.OAI2:239","identifiers":["oai:dro.dur.ac.uk.OAI2:239","10.1109\/TPWRD.2005.858785"],"title":"Coordinated control of an HVDC link and doubly fed induction generators in a large offshore wind farm.","authors":["Xiang,  D. W.","Ran,  L.","Bumby,  J. R.","Tavner,  P. J.","Yang,  S. C."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2006-01","abstract":"Doubly fed induction generators (DFIGs) are an economic variable-speed solution for large wind turbines while high-voltage dc (HVdc) transmission is being considered for the grid connection of some offshore wind farms. This paper analyzes the need for coordinating the control of the DFIGs and the HVdc link so that the two topologies can work together, giving system designers and operators a choice that may be useful in some applications. It is desired that individual generators be controlled for power tracking in a way similar to that used when they are connected directly to an ac grid, although a grid voltage reference for the DFIG control is no longer available as an independent source in this case. The study shows that machine control should explicitly maintain the flux level, which then allows the HVdc link to regulate the local system frequency and, indirectly, voltage amplitude. Interactions between DFIGs and the HVdc link are investigated and simulations performed to verify the proposed control strategy","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/66742.pdf","fullTextIdentifier":"http:\/\/dro.dur.ac.uk\/239\/1\/239.pdf","pdfHashValue":"2b84e7ce70fe2c7c70b9166a2500a767cc6a58af","publisher":"IEEE","rawRecordXml":"<record><header><identifier>\n  \n    \n      oai:dro.dur.ac.uk.OAI2:239<\/identifier><datestamp>\n      2011-05-24T08:24:20Z<\/datestamp><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        Coordinated control of an HVDC link and doubly fed induction generators in a large offshore wind farm.<\/dc:title><dc:creator>\n        Xiang,  D. W.<\/dc:creator><dc:creator>\n        Ran,  L.<\/dc:creator><dc:creator>\n        Bumby,  J. R.<\/dc:creator><dc:creator>\n        Tavner,  P. J.<\/dc:creator><dc:creator>\n        Yang,  S. C.<\/dc:creator><dc:description>\n        Doubly fed induction generators (DFIGs) are an economic variable-speed solution for large wind turbines while high-voltage dc (HVdc) transmission is being considered for the grid connection of some offshore wind farms. This paper analyzes the need for coordinating the control of the DFIGs and the HVdc link so that the two topologies can work together, giving system designers and operators a choice that may be useful in some applications. It is desired that individual generators be controlled for power tracking in a way similar to that used when they are connected directly to an ac grid, although a grid voltage reference for the DFIG control is no longer available as an independent source in this case. The study shows that machine control should explicitly maintain the flux level, which then allows the HVdc link to regulate the local system frequency and, indirectly, voltage amplitude. Interactions between DFIGs and the HVdc link are investigated and simulations performed to verify the proposed control strategy. <\/dc:description><dc:subject>\n        Doubly fed induction generator<\/dc:subject><dc:subject>\n         Frequency<\/dc:subject><dc:subject>\n         High-voltage dc (HVdc) transmission<\/dc:subject><dc:subject>\n         Real and reactive power<\/dc:subject><dc:subject>\n         Voltage<\/dc:subject><dc:subject>\n         Wind energy<\/dc:subject><dc:subject>\n         Back PWM converters<\/dc:subject><dc:subject>\n         Turbines.<\/dc:subject><dc:publisher>\n        IEEE<\/dc:publisher><dc:source>\n        IEEE transactions on power delivery, 2006, Vol.21(1), pp.463-471 [Peer Reviewed Journal]<\/dc:source><dc:date>\n        2006-01<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:identifier>\n        dro:239<\/dc:identifier><dc:identifier>\n        issn:0885-8977<\/dc:identifier><dc:identifier>\n        doi:10.1109\/TPWRD.2005.858785<\/dc:identifier><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/239\/<\/dc:identifier><dc:identifier>\n        http:\/\/dx.doi.org\/10.1109\/TPWRD.2005.858785<\/dc:identifier><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/239\/1\/239.pdf<\/dc:identifier><dc:rights>\n        \u00a92006 IEEE. Personal use of this material is permitted. However, permission to reprint\/republish this material for advertising or promotional purposes or for creating new collective works for resale or redistribution to servers or lists, or to reuse any copyrighted component of this work in other works must be obtained from the IEEE.\\ud\n<\/dc:rights><dc:accessRights>\n        info:en-repo\/semantics\/openAccess<\/dc:accessRights><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["0885-8977","issn:0885-8977"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2006,"topics":["Doubly fed induction generator","Frequency","High-voltage dc (HVdc) transmission","Real and reactive power","Voltage","Wind energy","Back PWM converters","Turbines."],"subject":["Article","PeerReviewed"],"fullText":"Durham Research Online\nDeposited in DRO:\n27 May 2008\nVersion of attached file:\nPublished Version\nPeer-review status of attached file:\nPeer-reviewed\nCitation for published item:\nXiang, D. W. and Ran, L. and Bumby, J. R. and Tavner, P. J. and Yang, S. C. (2006) \u2019Coordinated control of\nan HVDC link and doubly fed induction generators in a large offshore wind farm.\u2019, IEEE transactions on\npower delivery., 21 (1). pp. 463-471.\nFurther information on publisher\u2019s website:\nhttp:\/\/dx.doi.org\/10.1109\/TPWRD.2005.858785\nPublisher\u2019s copyright statement:\n2006 IEEE. Personal use of this material is permitted. However, permission to reprint\/republish this material for\nadvertising or promotional purposes or for creating new collective works for resale or redistribution to servers or lists,\nor to reuse any copyrighted component of this work in other works must be obtained from the IEEE.\nAdditional information:\nUse policy\nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without prior permission or charge, for\npersonal research or study, educational, or not-for-profit purposes provided that:\n\u2022 a full bibliographic reference is made to the original source\n\u2022 a link is made to the metadata record in DRO\n\u2022 the full-text is not changed in any way\nThe full-text must not be sold in any format or medium without the formal permission of the copyright holders.\nPlease consult the full DRO policy for further details.\nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom\nTel : +44 (0)191 334 3042 \u2014 Fax : +44 (0)191 334 2971\nhttp:\/\/dro.dur.ac.uk\nIEEE TRANSACTIONS ON POWER DELIVERY, VOL. 21, NO. 1, JANUARY 2006 463\nCoordinated Control of an HVDC Link\nand Doubly Fed Induction Generators\nin a Large Offshore Wind Farm\nDawei Xiang, Li Ran, Member, IEEE, Jim R. Bumby, Peter J. Tavner, and Shunchang Yang\nAbstract\u2014Doubly fed induction generators (DFIGs) are an eco-\nnomic variable-speed solution for large wind turbines while high-\nvoltage dc (HVdc) transmission is being considered for the grid\nconnection of some offshore wind farms. This paper analyzes the\nneed for coordinating the control of the DFIGs and the HVdc link\nso that the two topologies can work together, giving system de-\nsigners and operators a choice that may be useful in some appli-\ncations. It is desired that individual generators be controlled for\npower tracking in a way similar to that used when they are con-\nnected directly to an ac grid, although a grid voltage reference for\nthe DFIG control is no longer available as an independent source\nin this case. The study shows that machine control should explicitly\nmaintain the flux level, which then allows the HVdc link to regulate\nthe local system frequency and, indirectly, voltage amplitude. In-\nteractions between DFIGs and the HVdc link are investigated and\nsimulations performed to verify the proposed control strategy.\nIndex Terms\u2014Doubly fed induction generator, frequency, high-\nvoltage dc (HVdc) transmission, real and reactive power, voltage,\nwind energy.\nI. INTRODUCTION\nWIND TURBINES are arguably the most developedsource of renewable electrical energy with ratings of\ncommercial wind turbines now exceeding 4 MW. Attractive\nlocations for future large turbines would be remote, such as\noffshore, where wind conditions are improved and planning\nrestrictions are reduced. Variable speed is essential for large tur-\nbines partially because this attenuates the mechanical stresses\nthat the turbine blades and towers are subject to [1]. There have\nbeen active studies regarding the topologies of variable-speed\nturbines including those using cage induction [2] and slow\nrotating, direct-drive machines [3]. Such topologies usually\nrequire 100% rated, four-quadrant power-electronic converters.\nAs the converter cost decreases, such topologies will no doubt\nbecome increasingly more popular. In contrast, a traditional\nsolution has been the doubly fed induction generator (DFIG)\nwhich typically requires a 25% rated, 4-quadrant converter\nbetween the rotor and grid for the speed range needed. As a\nManuscript received October 27, 2004; revised March 15, 2005. This work\nwas supported by the New and Renewable Energy Centre (NaREC), Blyth, U.K.\nPaper no. TPWRD-00505-2004.\nD. Xiang and S. Yang are with the Department of Electrical Engineering,\nChongqing University, Chongqing 400044, China.\nL. Ran, J. R. Bumby, and P. J. Tavner are with the School of Engineering,\nScience Laboratories, University of Durham, Durham DH1 3LE, U.K. (e-mail:\nli.ran@durham.ac.uk).\nDigital Object Identifier 10.1109\/TPWRD.2005.858785\nresult, the DFIG has been an economic solution for large, vari-\nable-speed wind turbines despite its disadvantages of having a\nwound rotor and a brush-slip ring arrangement.\nDFIGs are usually connected to the ac mains on the stator\nside. Existing DFIG wind turbines are all located with ac mains\neasily available. As the wind industry develops, there is interest\nin building larger wind farms further offshore (e.g., off north-\nwest Great Britain). Several wind farms are planned to be built\nbeyond offshore islands and are expected to have registered ca-\npacities around 1000 MW with distances of more than 100 km\nto the nearest grid connection point. If high-voltage subsea ca-\nbles are to be used for ac interconnection, the charging reactive\npower associated with the cable capacitance will be significant.\nFor instance, the total charging power of a three-phase, 400-kV\ncable will be above 1500 MVAr, assuming a distance of 100 km\n[4], which cannot be easily handled by the DFIGs using the\nrotor side control. Therefore, it may be necessary to use dc inter-\nconnection. Previous studies have considered the advantages of\nusing voltage-source converter (VSC)-based dc links when the\ntransmitted power and transmission distance justify the choice\n[2], [5], [6]. Regarding the power level concerned in the present\nstudy, this paper will focus on the thyristor-based HVdc link\nwhich, given the present conditions of technology, could achieve\nthe desired high voltage at relatively low cost. DFIGs are still\nconsidered a valid option for large turbines as the speed of each\nturbine can be independently varied.\nIt seems that some redundancy has been caused between the\npower-electronic conversion stages in the DFIGs and the HVdc\nlink. However, the DFIG pulse-width-modulated (PWM) con-\nverter is used to adjust the turbine speed and for power tracking\nwhile thyristor bridges in the HVdc link are for ac-dc conversion\nand for the power transmission purpose. If cage induction ma-\nchines are used instead of DFIGs, the turbines will not be able to\nvary the power capture as the wind speed changes and turbines\nwill all run at virtually the same speed. Furthermore, compen-\nsators, such as STATCOM, are needed to provide the reactive\npower. Similarly, wind turbines using synchronous machines\nwill also prevent the speed of individual turbines being indepen-\ndently controlled. Machine-side power-electronic conversion is\nalways necessary for variable-speed turbines. Although some\nproposed topologies, such as that described in [2], can inte-\ngrate the power conversion stages for machine control and high-\nvoltage dc transmission, issues including machine-to-ground in-\nsulation and\/or large scale dc-dc voltage transformation, need to\nbe further addressed. It is in this circumstance that the DFIG plus\nHVdc topology is considered a candidate in several anticipated\n0885-8977\/$20.00 \u00a9 2006 IEEE\n464 IEEE TRANSACTIONS ON POWER DELIVERY, VOL. 21, NO. 1, JANUARY 2006\nFig. 1. System configuration.\napplications in the near future. Further discussion on possible\ntopologies in similar cases can be found in [7].\nGiven speed, rotor voltage, and frequency of a DFIG, we\ncan specify the voltage and frequency on the stator side. This\nis, however, not the case in DFIGs for wind turbines in which\na torque-speed characteristic should be defined for maximum\npower tracking [8]. Operating an HVdc link with a wind farm of\nDFIGs is thus challenging and no previous knowledge is avail-\nable for the topology. The HVdc link cannot define an indepen-\ndent ac voltage reference for the DFIG to control its power. This\nis also a new situation from the HVdc system point of view. For\nthe reasons to be expanded later, the HVdc link is responsible for\nmaintaining the local system frequency. But this is not achieved\nby affecting the balance of mechanical and electrical power on\nthe machines as the electrical power would already be subject\nto individual DFIG control for power tracking. The success of\nan integrated DFIG and HVDC system will rely on an in-depth\nunderstanding of the interactions between the two technologies.\nThis study investigates such complex interactions and proposes\na control strategy based on the knowledge obtained. It is hoped\nthat the study will broaden the choices of system designers and\nfuture operators when considering a link for a large, offshore\nwind farm to the grid requiring long subsea cables.\nII. CONTROL PRINCIPLES\nFig. 1 shows the configuration of the studied system. An off-\nshore wind farm is connected to the mainland grid using an\nHVdc link. An island provides space for the rectifier station;\nsome local loads on the island need to be supplied from the wind\nfarm. Parameters of such a system, used to illustrate the inter-\nactions involved, will be described later in the paper.\nAccording to the operating principle of a DFIG in the wind\nturbine context, it is generally possible to set its output real and\nreactive power at a practical stator frequency and rotor speed.\nThis is achieved by vector control implemented in the rotor-side\nconverter [9], [10]. The output real power is varied to follow the\nvariation of wind speed. A preset cubic relationship between the\ngenerator output power and the rotor speed is embedded in the\ncontrol algorithm. In the steady-state, the total real power gen-\nerated by all DFIGs must balance the power taken away by the\nHVdc link plus the local loads and losses. Similarly, the bal-\nance of reactive power must also be maintained. Unbalance of\nreal and reactive power during a transient may cause variations\nof the frequency and voltage in the local ac system. This is to\nbe investigated to allow the HVdc link to regulate the frequency\nand voltage.\nFig. 2. Controller of a grid-connected DFIG.\nThis section describes the control principles of the DFIGs and\nHVdc link and considers from a theoretical point of view, the\ninteraction between the two parts of the system.\nA. Control of DFIG\nThe basic idea of vector control for a DFIG is to specify the\nreactive power and air-gap torque of the machine through two\northogonal components of the rotor current in a defined refer-\nence frame. This is similar to the vector control of induction\nmotor drives. Usually, the -axis of the reference frame is de-\nfined in the direction of the stator flux space vector which can\nbe estimated from the measured stator voltage and current. The\n-axis leads the -axis by 90 . Given the amplitude of the stator\nflux linkage, the rotor current component in the -axis is ap-\nproximately proportional to the air-gap torque developed in the\nmachine while the -axis current component determines the re-\nactive power measured on the stator side. By means of the - and\n-axis voltages, which can be provided by the rotor side PWM\nconverter, decoupled control of the torque and reactive power\ncan practically be achieved. The controller of a grid-connected\nDFIG is shown in Fig. 2. For a DFIG connected to the grid, as\nits torque and reactive power are related to real power and ter-\nminal voltage, other combinations of control variables exist to\nfulfill the requirements of power system dispatching [11].\nAt the front end of the controller shown in Fig. 2, the -axis\ncurrent demand is obtained from a quadratic relationship be-\ntween the desired torque and the rotor speed, which is used\nas an input signal. This is consistent with the cubic relation-\nship between the power and speed for optimal power tracking\nas mentioned earlier. The current demand in the -axis is usu-\nally determined by an outer control loop attempting to regulate\nthe terminal voltage of or the reactive power produced by the\nmachine. Proportional and integral (PI) control is used in both\naxes to derive the reference voltage for the converter. The rotor\ncurrent components (i.e., the feedback in the control loops) are\ncalculated using the measured phase quantities projected\nto the - and -axes taking into account the rotor angle . The\ncompensation terms for the voltages on the - and -axes are\nto decouple the current response in the two axes, and details of\nthese terms can be found in [9] and [12].\nXIANG et al.: COORDINATED CONTROL OF AN HVDC LINK 465\nFig. 3. DFIG in islanded operating mode.\nIn the above controller, the stator flux linkage is decided to a\nlarge extent by the stator voltage which, in many cases, is almost\nfixed by the relatively strong grid. If DFIGs are connected to an\nHVdc rectifier station without a stiff ac voltage source, this is\nsimilar to the case of a DFIG supplying a purely passive load, as\nillustrated in Fig. 3. The four-quadrant (4Q) converter consists\nof two PWM VSCs connected back to back and the coupling\ntransformer as shown previously in Fig. 2. Although the grid-\nside converter could define an ac voltage source, it is normally\nrequired to follow the change of system frequency instead using,\nfor example, a phase-locked loop (PLL).\nThe terminal voltage and frequency are both variables. They\nare, however, dependent on each other as approximated below\n(1)\nwhere represents the root-mean-square (rms) value of the\nline-line voltage and is the rms flux linkage per stator phase.\nis the angular frequency. The stator resistive voltage drop has\nbeen ignored.\nFrom the machine point of view, it is important to keep its\nflux at an appropriate level irrespective of the mode of opera-\ntion. Since the frequency is variable and it affects the voltage\nin the islanded mode, it is now necessary to specify the refer-\nence stator flux linkage explicitly in the controller. The machine\ntorque can then be controlled through the -axis current. For a\ngiven stator flux linkage, the terminal voltage will be determined\naccording to the frequency achieved during operation. As to be\nshown next, the frequency also depends on the load character-\nistic. With frequency at the nominal value, the voltage will also\nbe roughly acceptable as long as the stator flux linkage refer-\nence given is appropriate. The modified controller, which speci-\nfies the stator flux linkage, is shown in Fig. 4. At a certain speed,\nthe control targets are stator flux linkage and torque\u2014the same\nas that shown in Fig. 2.\nAssuming zero steady-state error in the above controller, the\nair-gap torque and the amplitude of the stator flux linkage of\nthe generator will both be at their reference values. The output\nreal power of the generator is then approximately equal to the\nproduct of the machine air-gap torque and the rotor speed ig-\nnoring the losses. Further, assume that the wind speed is known\nat a particular moment. According to the relationship\nfor optimal power tracking, the output real power of the DFIG\nshould also be known. This value is denoted as . With the\nFig. 4. Modified controller for a DFIG in islanded operation.\nconstraints of and , the stator voltage and frequency can\nbe decided jointly with the load characteristics which are ex-\npressed in the following equations for a series and static\nload.\nThe real and reactive power of the load can be written in terms\nof the voltage and frequency, and are equal to the real and reac-\ntive power of the generator\n(2)\n(3)\nwhere represents the generator reactive power.\nConsidering again the relationship between stator voltage and\nflux linkage [i.e., (1)], the frequency and voltage in the steady-\nstate operation can be derived as below\n(4)\n(5)\nIt can therefore be concluded that the control characteristic\nof the DFIG and the power-voltage\/frequency characteristic of\nthe load will jointly determine the frequency and voltage of the\nsystem. The approach taken above can be directly applied to sce-\nnarios having multiple DFIGs in the islanded system because\nthe frequency and voltage are common variables to all genera-\ntors in parallel, taking into account their transformers, and the\nvariables are still governed by (1). It is assumed that all ma-\nchines are controlled in the same way to maintain the stator flux\nlinkage constant. The effect of deviations of the flux reference\nbetween generators will be discussed later.\nAs the wind speed fluctuates, the output real power of the\nDFIG changes following the optimal power tracking control.\nAs a consequence, the frequency and voltage will also change\nif the load condition remains the same. Fortunately, an HVdc\nlink can quickly change the power extracted from the DFIGs.\nIt is expected that this can be utilized and will contribute to the\nfrequency and voltage control for the local system.\n466 IEEE TRANSACTIONS ON POWER DELIVERY, VOL. 21, NO. 1, JANUARY 2006\nFig. 5. Sending end model of an HVdc link.\nB. Control of HVdc Link\nConsistent with the configuration of Figs. 1 and 5, the focus\nis now on the sending end of the HVdc link connecting the wind\nfarm represented by a DFIG to the grid. In order to find the\nfrequency and voltage at the local system busbar, it is useful to\nexamine how the real and reactive power taken by the rectifier\nand depends on the voltage and frequency. It is assumed\nthat the ac filters are perfect so that the voltage waveform at the\nrectifier busbar is sinusoidal.\nReferring to a typical monopole, 12-pulse arrangement for\nan HVdc link with metallic return, the quasi-steady-state equa-\ntions relating to the ac- and dc-side variables are shown below\nin (6) [13], where is the per phase leakage inductance of the\nconverter transformer and is the equivalent commutation re-\nsistance. is the total resistance of the dc transmission cable.\nThe firing delay angle of the rectifier is denoted as and the\npower factor angle as . It is assumed that the inverter of the\nHVdc link works on constant dc voltage control and that the\nvoltage harmonics are ignored. This will simplify the analysis\nbut the analysis and the derivation of the HVdc link control algo-\nrithm can be extended to other situations of the inverter system\nif required\n(6)\nAt any moment, the real power to be taken away by the HVdc\nlink is the difference between the output real power of the gen-\nerators and the local loads plus losses. For a given , a relation-\nship can be established between the firing delay angle, the local\nsystem frequency, and voltage. The relationship is expressed\nbelow in (7), which is derived by substituting (1) into (6) fol-\nlowed by algebraic manipulation. It could be used to determine\nthe firing delay angle needed to maintain the system frequency\nat the desired value\n(7)\nThe left-hand side of (7), , is dominated by the second\nterm on the right-hand side, which implies that if the frequency\nis to be reduced, the firing delay angle should decrease; the\nFig. 6. Frequency control loop.\nfiring instant would then advance. This can be understood from\nthe operating characteristics of the generators and HVdc link.\nWhen the firing delay angle decreases, for the same dc voltage\nrequired at the sending end to maintain the power delivery, the\nac-side voltage will be reduced. According to (1), the generator\nfrequency will also reduce provided that the stator flux linkage\nis kept constant.\nIt should be pointed out that the above analysis did not in-\nvolve generator speed information at all. Therefore, the result\nis generally valid for a wind farm of multiple DFIGs running at\ndifferent speeds.\nEquation (7) includes system and operational parameters\nwhich change during operation and are difficult to measure\nor estimate. It is therefore not practical to use the equation\ndirectly to determine the firing delay angle of the HVdc rec-\ntifier. Instead, based on the relationship illustrated by (7), it\nis possible to devise a negative feedback control loop for the\nsystem frequency as shown in Fig. 6 where is the reference\nangular frequency at the system busbar.\nAs an example, if the system frequency is too high, the con-\ntroller will then decrease the firing delay angle. This seems to be\nsimilar to an HVdc link connecting a hydropower plant of syn-\nchronous generators to the grid, where a decreased firing angle\nmeans that more power is extracted by the HVdc link, slowing\ndown the generators [14]. The present case is indeed concep-\ntually different from any previously studied situations and the\nkey of HVdc control is (1). The HVdc link is not controlling\nthe real power. Instead, the real power is always determined\nby the DFIG power tracking algorithm and, of course, also the\nwind condition, which is independent of the system frequency\nand voltage to be regulated. Without energy storage in the sense\nof steady-state, the HVdc link must instantaneously deliver the\ngenerated power to the grid provided that the local loads are\nsupplied. For a given firing delay angle of the HVdc rectifier,\nthe system voltage and frequency will automatically be set to\nensure the power balance. Therefore, no mechanical transient\nis involved in the frequency regulation process by changing the\nfiring delay angle. This implies that the response of the regu-\nlation can be made very fast so that the frequency and voltage\nviewed by the local loads are almost constant. It is possible to\nadd or switch off some DFIGs during operation. Starting of the\nwind farm and HVdc link can also be easily coordinated.\nThe reference for the stator flux linkage was assumed to be\nthe same for all DFIGs in deriving (7). If it is appropriately set,\nthe system voltage will be close to what is desired. In principle,\na closed-loop controller can be designed to regulate the voltage\nby changing the reference of the stator flux linkage. In this study,\nXIANG et al.: COORDINATED CONTROL OF AN HVDC LINK 467\nFig. 7. Torque-speed characteristic.\nthe reference flux is set and varied in discrete steps in order to\napproach the desired voltage amplitude. This is similar to setting\nthe tap position in a transformer with an onload tap changer.\nWhile other strategies are also possible, the major advantage of\nthe strategy adopted in the present study is to avoid the strong\ncross coupling between the frequency and voltage response of\nthe DFIGs, which is likely to cause system instability.\nIn practice, the reference stator flux linkage can also be set\ndifferently for different machines. This will affect the reactive\npower from each generator. The difference between the refer-\nence values will eventually be absorbed by the leakage reac-\ntance of the step-up transformer associated with each DFIG\nunit. Although the DFIGs in an offshore wind farm are likely\nto be within a relatively small area, say 7 7 km [15], where\nthe difference of wind speeds would be limited, it might be\nuseful in some cases that some generators provide more reactive\npower during a specific period of time. This can be achieved by\nchanging the stator flux linkage reference. From a practical point\nof view, it is desirable that all generators be controlled individu-\nally in an autonomous manner although some control demands\nmay be issued to groups of generators collectively [16], [17].\nIII. SIMULATION RESULTS\nSimulations were performed in MATLAB\/SIMULINK. The\nobjective of simulation is to illustrate interacting phenomena\nwhich have not been understood before and verify the control\nstrategy [i.e., (1) and Fig. 6] proposed in this study. In line with\nthe above analyses, simulations were first performed on a DFIG\nin the islanded operating mode before being extended to include\nthe HVdc link. Variation of the stator flux linkage reference of\nthe DFIGs was also demonstrated with the HVdc link included.\nA. DFIG in Islanded Operation\nThe system simulated is the same as shown previously in\nFig. 3. A 2-MW DFIG supplies an RL load. Parameters of the\ngenerator are given in Appendix A. Simulations are carried\nout for two cases with changes of the wind input and load\nimpedance, respectively.\nThe torque-speed characteristics of the wind turbine and gen-\nerator are shown in Fig. 7. It is assumed that the turbine has been\nFig. 8. Simulated response of DFIG in islanded operation-wind speed change.\nFig. 9. Simulated response of DFIG in an islanded operation-load disturbance.\ndesigned for a nominal wind speed of 12 m\/s. The bold line rep-\nresents the control trajectory of the DFIG which will normally\noperate in the speed range from 0.7 to 1.3 p.u. [4]. At a wind\nspeed of 12 m\/s, the input torque achieved is 1 p.u. All per-unit\nvalues are based on the generator (stator for power) ratings as\ngiven in Appendix A. The characteristic of the turbine is repre-\nsented in Heier approximation [18], [19].\nSuppose that the wind speed suddenly drops from 12 to 11\nm\/s. Following the change, the mechanical torque of the tur-\nbine will step from 1 p.u. down to about 0.77 p.u. because of\nthe relatively high inertia the rotor tends to hold its speed. The\nunbalance between the mechanical torque and air-gap torque of\nDFIG leads to deceleration of the turbine. With effect of the\nDFIG air-gap torque control along the curve shown in Fig. 7,\nthe wind turbine operation will eventually transit from point A\nto point B. As the exported real power declines, the stator fre-\nquency will reduce and so will the voltage amplitude. The simu-\nlation results are shown below in Fig. 8. Although the electrical\ntransient is fast, it takes about 10 s for the whole system to enter\na new steady-state due to the relatively long mechanical time\nconstant.\nThe second case simulated is for a sudden change of load\nand the simulation results are shown in Fig. 9. The initial ap-\nparent load power is 1 p.u. with a lagging power factor of 0.98.\n468 IEEE TRANSACTIONS ON POWER DELIVERY, VOL. 21, NO. 1, JANUARY 2006\nHalf of the load is suddenly lost\/shed with doubled and\nvalues in the load representation. The purpose of the simulation\nis to investigate the interaction between the DFIG and the iso-\nlated load, assuming an unrealistic scenario in which the gener-\nator controller is totally ignorant of the change of load. In this\ncase, the real power generated by the DFIG remains the same\nand so does the machine stator flux linkage reference. The new\nsteady-state values of the frequency and voltage amplitude can\nbe determined using (4) and (5) based on the new and\nvalues of the load. It is clear that both frequency and voltage\nincrease causing a load regulation effect which helps to re-es-\ntablish power balance in the new steady-state. It is obvious that\nthe transient process in this case is much faster than in the first\ncase. This is because it is dominated by the electrical interaction\nin the system.\nThe HVdc link can be controlled to some extent to emulate\nthe effects of load change on the DFIG in order to gain the con-\ntrol over the frequency and voltage of the local ac system. This\nis demonstrated next.\nB. Wind Farm With HVdc Link\nThe system configuration is the same as previously shown in\nFig. 1. The wind farm is simplified as an equivalent DFIG which\nrepresents the dynamics of 350 DFIGs, each rated at 2-MW\nstator power. The DFIG is assumed to be the same as that used\nabove. The peak power extracted from the wind will be approx-\nimately 910 MW: 700 MW being produced from the stator side\nwith the remaining 210 MW (i.e., 30%) of the stator power,\nbeing generated from the rotor side of the DFIGs at the max-\nimum supersynchronous speed. Two stages of 50-Hz ac voltage\ntransformation are used in the local ac system. There are 0.69\nkV\/30 kV and 30 kV\/145 kV. The stepped-up voltage is then\nfed to the converter transformer which is specified for a 400-kV\nmonopole 12-pulse HVdc link. The total reactive power rating\nof the ac filters is 240 MVAr (at 50 Hz) and the maximum power\nto be carried by the HVdc link is designed to be 770 MW, taking\ninto account the local loads which are represented using resis-\ntance in series with inductance. At the nominal frequency and\nvoltage, the local load has an apparent power of 150 MVA with\na power factor of 0.9 lagging. Parameters of the HVdc link are\ndetailed in Appendix B.\nAlthough an aggregated model is used for the DFIGs in the\nwind farm, the controllers of the DFIGs and the HVdc link are\nindependent in simulation and the later controller only measures\nthe system bus frequency and voltage which are common to all\nDFIGs. This is therefore adequate to represent a wind farm of\nmany DFIGs operating at different speeds.\nSimulated scenarios are for sudden changes of wind speed\nand local loads. Supposing the wind speed is step increased from\n11 to 12 m\/s, the response is shown in three groups in Fig. 10.\nNo local load is connected. The generator speed and air-gap\ntorque both increase while the stator flux linkage is constant\n[Fig. 10(a)]. The real and reactive power from the generator\nincreases as the changes of system frequency and voltage are\nlargely constrained [Fig. 10(b)]. The constant local frequency\nand voltage are predominantly due to the control effect of the\nHVdc link, which adjusts the firing delay angle at the recti-\nfier end according to the measured change of system frequency.\nFig. 10. Response of wind farm with an HVdc link\u2014wind speed change.\nWhile the increase of real power is caused by the increase of\nwind speed, the reactive power is increased because the HVdc\nconverter station now needs more reactive power. From the gen-\nerator point of view, the increased reactive power is provided by\nincreasing the stator current component in the -axis. This is fur-\nther caused by the change of rotor current using the rotor-side\nconverter in order to keep the stator flux linkage constant. The\nresponse of the HVdc link is shown in [Fig. 10(c)]. Reduction\nof the firing delay angle causes the rectifier dc-side voltage and,\nhence, the dc current to increase; therefore, more power is de-\nlivered.\nThe inverter side of the HVdc link is represented by a dc\nvoltage source without harmonics. The harmonic signatures\nshown in the simulation results are therefore unrealistic. How-\never, for the DFIG controller at the sending end, the harmonics\npresent in the system voltage and current due to the HVdc link\nare modeled with reasonable accuracy and the purpose of the\nwork is to examine interaction effects at the DFIG sending end,\nnot the HVdc receiving end.\nXIANG et al.: COORDINATED CONTROL OF AN HVDC LINK 469\nFig. 11. Response of the wind farm with an HVdc link\u2014local load\ndisturbance.\nFig. 11 shows the response of the integrated system to a load\ndisturbance. Again, the wind farm initially operates at a partial\noutput corresponding to a wind speed of 11 m\/s. The local loads\nare then applied. A fast electrical transient is excited, subject\nto the control actions of the DFIG and HVdc link. The oper-\nating state of the aggregated machine is eventually unchanged\nbecause the wind speed has not changed. The local loads ini-\ntially cause a dip of system frequency and voltage which acti-\nvates the HVdc controller. The firing delay angle at the rectifier\nend ramps up so that less power is delivered to the grid by the\nHVdc link while some of the generated power provides the local\nloads. In the new steady-state, which is reached in about 300 ms,\nthe system frequency returns to its value prior to the load distur-\nbance and the voltage returns to its prior value.\nThe main purpose of the simulations is to demonstrate the\ninteractions between the different parts of the integrated system\nand the effects of the HVdc control. If, for example, the transient\nresponse of the system frequency and voltage is not acceptable\nfrom the local load point of view in practice, it is possible to tune\nthe control gains of the HVdc link to improve the performance.\nFurthermore, a more sophisticated control algorithm can also\nbe used instead of the PI algorithm to adjust the firing delay\nangle. This, along with more details of the interactions between\nmultiple DFIGs with difference reference stator flux linkage, is\nbeyond the scope of the present paper and will be addressed in\nthe future.\nC. Flexibility of Control\nThe main objective of this study is to investigate a control\nstrategy that coordinates the control of the DFIGs and the\nHVdc link. In the proposed strategy, the DFIGs are controlled\nin almost the same way as if they were connected directly to\nan ac network. The only significant modification is to change\nthe terminal voltage or reactive-power control into stator flux\nlinkage control. As the stator flux linkage of the machine is\nestimated in standard DFIG vector control, the change can be\nreadily implemented. The firing delay angle, not the power, of\nthe HVdc link is adjusted according to the local system fre-\nquency. Although this may appear quite similar to the practice\nwith HVdc links connected to synchronous generators, the\nunderlining mechanism is very different. In the present case,\nthe change of the firing delay angle does not necessarily mean\na change in the power delivered by the HVdc link. The only\npurpose of changing the firing delay angle of the rectifier here\nis to control the frequency and, consequently, the voltage.\nControl of the HVdc link can change the stator frequency and\nindirectly the terminal voltage which also depends on the stator\nflux linkage. Fig. 12 shows the simulation results as the stator\nflux linkage reference undergoes a step change. At s, the\nreference changes from 1.02 to 1.1 p.u. Correspondingly, the\nsystem voltage increases while the frequency remains the same.\nThe dc current decreases slightly, implying that the power deliv-\nered by the HVdc link is reduced. This is because the increase of\nthe ac system bus voltage causes the local loads to absorb more\npower generated by the DFIGs. The simulation clearly shows\nthat the stator flux linkage can be controlled as an independent\nvariable to further adjust the voltage.\nIt is advisable that the stator flux linkage reference be changed\nin a discrete manner since the firing delay control of the rectifier\nin the HVdc link also affects the local system voltage. This helps\nto avoid control instability.\nIV. CONCLUSION\nThis paper has investigated the control requirements when a\nwind farm of DFIGs is connected to the grid using a conven-\ntional thyristor-based HVdc link. A strategy of coordinated con-\ntrol for DFIGs and an HVdc link is proposed based on the under-\nstanding of the interactions between them. From the DFIG point\nof view, such control is achieved by providing a reference for the\nstator flux linkage instead of the terminal voltage or output re-\nactive power. With this modification, the capability of optimal\npower tracking is retained with the DFIG. The firing delay angle\nof the rectifier at the sending end of the HVdc link can be used\nto regulate the frequency of the local ac system frequency and,\nhence, the voltage indirectly. The voltage can be further adjusted\nby the generator stator flux linkage reference.\n470 IEEE TRANSACTIONS ON POWER DELIVERY, VOL. 21, NO. 1, JANUARY 2006\nFig. 12. Response of the wind farm with an HVdc link\u2014change of reference\nstator flux linkage.\nIt is expected that the study will help wind turbine and HVdc\nsystem manufacturers, as well as wind farm developers, to rec-\nognize the control requirements and devise appropriate control\nstrategies for some potential applications.\nAPPENDIX A\nPARAMETERS OF DFIG\nPer-unit system of DFIG\nbase capacity 2 MW;\nbase frequency: 50 Hz;\nbase stator voltage (phase, peak value) 563.4 V;\nbase stator current (peak value) 2.3667 kA;\nbase impedance on stator side 0.2381 ;\nbase rotor voltage (phase, peak value) 897.18 V;\nbase rotor current (peak value) 1.5218 kA;\nbase impedance on rotor side 0.5758 ;\nbase stator flux linkage 1.553 V-s;\nbase torque 12.732 kNm;\nbase speed 1500 r\/min.\nParameters of DFIG (star equivalent circuit):\nMW, Hz, 690 V (line\u2013line,\nrms);\nwinding connection (stator\/rotor): star\/star;\nnumber of pole pair ;\nturn ratio 0.643;\nstator resistance 0.098 41 p.u.;\nstator leakage inductance 0.1248 p.u.;\nrotor resistance 0.005 49 p.u.;\nrotor leakage inductance: 0.099 55 p.u.;\nmagnetizing inductance: 3.9527 p.u.\nAPPENDIX B\nPARAMETERS OF HVdc LINK\nPer-unit system of HVdc\nbase dc voltage 400 kV;\nbase dc current 1925 A;\nbase capacity 770 MW.\nParameters of ac filters\nFour single-tuned filters for 11th, 13th, 23rd, and 25th\nharmonics each with 60-MVAr-rated capacitive reac-\ntive power at 50 Hz.\nParameters of converter transformers\ntwo converter transformers in - and - ;\nrating 450 MVA;\ntransformer ratio 145\/160 kV;\nshort-circuit impedance p.u.\nParameters of 150-km dc transmission line\nresistance of per kilometer 0.0217 km;\ninductance of per kilometer 0.792 km.\nInductance of smoothing reactor 0.3438 H.\nACKNOWLEDGMENT\nDr. L. Ran would like to thank Prof. K. Abbott of AREVA\nT&D, Stafford, U.K., for advice and helpful discussions.\nREFERENCES\n[1] S. Muller, M. Deicke, and R. W. De Doncker, \u201cDoubly fed induction\ngenerator systems for wind turbine,\u201d IEEE Ind. Appl. Mag., vol. 8, no.\n3, pp. 26\u201333, May\/Jun. 2002.\n[2] W. Lu and B. T. Ooi, \u201cOptimal acquisition and aggregation of offshore\nwind power by multiterminal voltage-source HVDC,\u201d IEEE Trans.\nPower Del., vol. 18, no. 1, pp. 201\u2013206, Jan. 2003.\n[3] E. Spooner, P. Gordon, J. R. Bumby, and C. D. French, \u201cLightweight\nironless-stator PM generators for direct drive wind turbines,\u201d Proc. Inst.\nElect. Eng., Electr. Power Appl., vol. 152, no. 1, pp. 17\u201326, 2005.\n[4] B. M. Weedy and B. J. Cory, Electric Power Systems, 4th ed. New\nYork: Wiley, 1998, pp. 141\u2013141.\nXIANG et al.: COORDINATED CONTROL OF AN HVDC LINK 471\n[5] L. Tang and B. T. Ooi, \u201cProtection of VSC-multi-terminal HVDC\nagainst dc faults,\u201d in Proc. IEEE Power Electronics Specialists Conf.,\nvol. 2, Cairns, Australia, Jun. 2002, pp. 719\u2013724.\n[6] U. Axelsson, A. Holm, C. Liljegren, K. Eriksson, and L. Weimers, \u201cGot-\nland HVDC light transmission\u2014world\u2019s first commercial small scale dc\ntransmission,\u201d in CIRED Conf., Nice, France, May 1999.\n[7] T. Thiringer, \u201cIntegration of large sea-based wind parks-how much\npower electronic devices are needed in order to avoid power quality\nproblems on the grid?,\u201d in Proc. IEEE Power Engineering Soc. Summer\nMeeting, vol. 2, Chicago, IL, Jul. 2002, pp. 1277\u20131279.\n[8] J. B. Ekanayake, L. Holdsworth, X. G. Wu, and N. Jenkins, \u201cDynamic\nmodeling of doubly fed induction generator wind turbines,\u201d IEEE Trans.\nPower Syst., vol. 18, no. 2, pp. 803\u2013809, Apr. 2003.\n[9] R. Pena, J. Clare, and G. Asher, \u201cDoubly fed induction generator using\nback-to-back converters and its application to variable-speed wind-en-\nergy generation,\u201d Proc. Inst. Elect. Eng., Electr. Power Appl., vol. 143,\nno. 3, pp. 231\u2013241, 1996.\n[10] B. Hopfensperger, D. J. Atkinson, and R. A. Lakin, \u201cStator-flux-oriented\ncontrol of a doubly-fed induction machine with and without position\nencoder,\u201d Proc. Inst. Elect. Eng., Electr. Power Appl., vol. 147, no. 4,\npp. 241\u2013250, 2000.\n[11] Z. Krzeminski, \u201cControl systems of doubly fed induction machine based\non multi-scalar model,\u201d in Proc. 11th World Congress International Fed-\neration Automatic Control. New York, 1991, pp. 521\u2013526.\n[12] R. Pena, J. Clare, and G. Asher, \u201cA doubly fed induction generator using\nback-to-back PWM converters supplying an isolated load from a vari-\nable speed wind turbine,\u201d Proc. Inst. Elect. Eng., Electr. Power Appl.,\nvol. 143, no. 5, pp. 380\u2013387, 1996.\n[13] J. Arrillaga, High Voltage Direct Current Transmission, ser. IEE Power\nand Energy Series 29. London, U.K.: IEE, 1998, pp. 10\u201355.\n[14] P. Kundur, Power System Stability and Control. New York: McGraw-\nHill, 1994, pp. 500\u2013524.\n[15] N. M. Kirby, L. Xu, M. Luckett, and W. Siepmann, \u201cHVDC transmission\nfor large offshore wind farms,\u201d Inst. Elect. Eng. Power Eng. J., vol. 16,\nno. 3, pp. 135\u2013141, 2002.\n[16] J. L. Dallachy and I. Tait, \u201cGuidance note for the connection of wind\nfarms,\u201d in SP Transmission and Distribution. Perth, U.K.: Scottish\nHydro-Electric, 2002.\n[17] D. Xiang, L. Ran, P. J. Tavner, and J. R. Bumby, \u201cControl of a doubly\nfed induction generator to ride through a grid fault,\u201d in Proc. Int. Conf.\nElectric Machines (ICEM), Cracow, Poland, 2004.\n[18] J. G. Slootweg, H. Polinder, and W. L. Kling, \u201cDynamic modeling of a\nwind turbine with doubly fed induction generator,\u201d in Proc. IEEE Power\nEng. Soc. Summer Meeting, Vancouver, BC, Canada, 2001, pp. 644\u2013649.\n[19] L. Ran, J. R. Bumby, and P. J. Tavner, \u201cUse of turbine inertia for power\nsmoothing of wind turbines with a DFIG,\u201d in Proc. IEEE Int. Conf. Har-\nmonics Quality Power (ICHQP), Lake Placid, NY, 2004.\nDawei Xiang was born in Sichuan, China. He\nreceived the B.Eng. and M.Sc. degrees in elec-\ntrical machinery and apparatus from the School\nof Electrical Engineering, Chongqing University,\nChongqing, China, in 1999 and 2000, respectively.\nCurrently, he is a Lecturer of Electrical Machinery\nand Apparatus with Chongqing University. In 2004,\nhe was a Visiting Scholar with Durham University,\nDurham, U.K. From 1999 to 2000, he was an ex-\nchange M.Sc. student with the University of Electro-\nCommunications, Tokyo, Japan. His research inter-\nests include the control of doubly fed electrical machines as used in renewable\nenergy systems.\nLi Ran (M\u201998) received the Ph.D. degree in power\nsystems engineering from Chongqing University,\nChongqing, China, in 1989.\nCurrently, he is a Lecturer in Electrical Power and\nControl in the School of Engineering, University\nof Durham, Durham, U.K. He participated in the\ncommissioning of the Gezhouba-Shanghai HVdc\nsystem in China in 1989. His research interests\ninclude the application of power electronics in power\nsystems and renewable energy systems, such as wave\nand wind energy converters.\nDr. Ran received the Stanley Gray Award-Offshore Technology in 1999 from\nthe Institute of Marine Engineers, London, U.K., for his study on the intercon-\nnection of offshore oil rigs.\nJim R. Bumby received the M.Eng. and Ph.D. de-\ngrees in engineering from the University of Durham,\nDurham, U.K., in 1970 and 1974, respectively.\nCurrently, he is a Reader in the Electrical Engi-\nneering Department in the School of Engineering,\nUniversity of Durham, Durham, U.K. His research\ninterests are in electrical power and control and novel\ngenerator topologies for new and renewable energy\nsystems. He is also interested in hybrid electric\nvehicles.\nDr. Bumby received an IEE Power Division Pre-\nmium in 1997 for work on direct drive permanent magnet generators for wind\nturbines.\nPeter J. Tavner received the M.A. degree in en-\ngineering sciences from Cambridge University,\nCambridge, U.K. in 1969 and the Ph.D. degree from\nSouthampton University, Southampton, U.K., in\n1978.\nCurrently, he is Professor of New and Renewable\nEnergy in the School of Engineering, University\nof Durham, Durham, U.K. He has held a number\nof research and technical positions in industry\nincluding Technical Director of Laurence, Scott\n& Electromotors Ltd., Norfolk, U.K. and Brush\nElectrical Machines Ltd., Loughborough, U.K. Most recently, he has been\nGroup Technical Director of FKI Energy Technology, Loughborough. His\nresearch interests include electrical machines for the extraction of energy from\nrenewable sources and their connection to electricity systems. He retains a\nparticular interest in electromagnetic analysis, the application of condition\nmonitoring to electrical systems, and the use of converters with electrical\nmachines.\nDr. Tavner is a winner of the Institution Premium of the IEE.\nShunchang Yang was born in Shanghai, China. He\ngraduated from the Electrical Engineering Depart-\nment of Chongqing University, Chongqing, China,\nin 1960.\nCurrently, he is a Professor in the School of Elec-\ntrical Engineering, Chongqing University. He was\nan Assistant Lecturer with Chongqing University, in\n1960. From 1985 to 1986, he was a Visiting Scholar\nwith the University of Tennessee, Knoxville. In\n1991, he was with the Kiev Institute of Technology,\nKiev, Ukraine, and the All Soviet Union Institute\nof Electrical Engineering and Sciences, Moscow, Russia, in an international\nproject Asynchronized Synchronous Machines and their Applications in Power\nSystems. His research interests include the design and control of electrical\nmachines of new topologies.\n"}