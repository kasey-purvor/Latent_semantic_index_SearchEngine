{"doi":"10.1109\/IEMBS.2008.4649647","coreId":"55435","oai":"oai:eprints.lincoln.ac.uk:2077","identifiers":["oai:eprints.lincoln.ac.uk:2077","10.1109\/IEMBS.2008.4649647"],"title":"REVIEW - A reference data set for retinal vessel profiles","authors":["Al-Diri, Bashir","Hunter, Andrew","Habib, Maged","Steel, David","Hudaib, Taghread","Berry, Simon"],"enrichments":{"references":[{"id":18436492,"title":"A Model Based Dual Active Contour.","authors":[],"date":"1994","doi":"10.5244\/c.8.30","raw":"Gunn, S. R. and Nixon, M. S. 1994. A Model Based Dual Active Contour. In Proceedings of Proc. British Machine Vision Conference, pages pp. 305-314. Hancock, E., Eds.","cites":null},{"id":18436490,"title":"Adaptive object tracking and video compression with dynamic contours,","authors":[],"date":"1998","doi":"10.1109\/nrsc.1998.711444","raw":"Feng Y and Gelenbe E 1998. Adaptive object tracking and video compression with dynamic contours, IEEE Proceedings of the Fifteenth National Radio Science Conf.,NRSC, 1, INV3\/1 -INV326.","cites":null},{"id":18436493,"title":"Application of an Active Contour Model for Extraction of Fuzzy and Broken Image Edges,","authors":[],"date":"1996","doi":null,"raw":"P. Szczypinski, P. Strumillo, Application of an Active Contour Model for Extraction of Fuzzy and Broken Image Edges, Machine GRAPHICS and VISION, Vol.5, No.4, 1996, pp. 579-594","cites":null},{"id":18436498,"title":"Automated Grading of Venous Beading,","authors":[],"date":"2000","doi":"10.1006\/cbmr.1995.1020","raw":"Gregson, P.H; et al, Automated Grading of Venous Beading, Computers and Biomedical Research, 28, 2000, 291-304.","cites":null},{"id":18436496,"title":"Automatic extraction of roads from aerial images based on scale space and snakes,","authors":[],"date":"2000","doi":"10.1007\/s001380050121","raw":"Laptev, I., Mayer, H., Lindeberg, T., Eckstein, W., Steger, C.T.[Carsten T.], Baumgartner, A. 2000. Automatic extraction of roads from aerial images based on scale space and snakes, MVA(12), No. 1, pp. 23-31.","cites":null},{"id":18436488,"title":"Comparison of gradient, gradient vector \ufb02ow and pressure force for image segmentation using active contours.","authors":[],"date":"2002","doi":null,"raw":"Hatamzadeh-Tabrizi J and Funnell WRJ 2002. Comparison of gradient, gradient vector \ufb02ow and pressure force for image segmentation using active contours. Proc 27th Ann Conf Can Med Biol Eng Soc (CD-ROM), 4 pp.","cites":null},{"id":18436486,"title":"Finite-element methods for active contour models and balloons for 2-D and 3-D images,","authors":[],"date":"1993","doi":"10.1109\/34.244675","raw":"Cohen LD and Cohen I. 1993. Finite-element methods for active contour models and balloons for 2-D and 3-D images, IEEE Trans. on PAMI, 15 (11), 1131-1147.","cites":null},{"id":18436491,"title":"On active contour models and ballons.CVGIP:ImageUnderstanding,","authors":[],"date":"1991","doi":null,"raw":"Cohen LD, 1991. On active contour models and ballons.CVGIP:ImageUnderstanding, 53(2):211-218.","cites":null},{"id":18436499,"title":"Quantitative measurement of retinal vessel widths from fundus images based on 2d modelling,\u201d","authors":[],"date":"2002","doi":"10.1109\/tmi.2004.830524","raw":"J.A. Lowell, A. Hunter, and D. Steel, \u201dQuantitative measurement of retinal vessel widths from fundus images based on 2d modelling,\u201d Tech. Rep. 06\/02, Department of Computer Science, University of Durham, Science Labs., South Rd., Durham, UK, 2002, http:\/\/www.dur.ac.uk\/computer.science\/technicalreports\/technicalreports.html.","cites":null},{"id":18436495,"title":"Robust parametric active contours: the Sandwich Snakes,","authors":[],"date":"2000","doi":"10.1117\/12.323175","raw":"Velasco, Fernando A. and Jose L. Marroqu\u2019n, Robust parametric active contours: the Sandwich Snakes, pp. 238-242.[12] KERSCHNER M. 2000. Twin Snakes for Determining Seam Lines in Orthoimage Mosaicking. InternationalArchivesofPhotogrammetryandRemote Sensing, Vol. 33, Part B4, Amsterdam, pp. 454-461.","cites":null},{"id":18436494,"title":"Sandwich Snakes a robust parametric active contour.","authors":[],"date":"1998","doi":null,"raw":"F. Velasco and JL. Marroqun, 1998. Sandwich Snakes a robust parametric active contour. Proceedings of SPIE, San Diego Ca. USA, Image Analysis, Vol 3460, pp 226-236","cites":null},{"id":18436485,"title":"Snakes, Shapes, and Gradient Vector Flow,\u201d","authors":[],"date":"1998","doi":"10.1109\/83.661186","raw":"C. Xu and J. L. Prince, 1998. Snakes, Shapes, and Gradient Vector Flow,\u201d IEEE Transactions on Image Processing, 7(3): 359-369.","cites":null},{"id":18436484,"title":"Snakes: active contour models.","authors":[],"date":"1988","doi":"10.1007\/bf00133570","raw":"Kass, M., Witkin, A., Terzopoulos, D., 1988. Snakes: active contour models. International Journal of Computer Vision, 1(4), pp. 321-331","cites":null},{"id":18436497,"title":"Theoretical relationships between light streak characteristics and optical properties of retinal vessels,","authors":[],"date":"1986","doi":"10.1111\/j.1755-3768.1986.tb00701.x","raw":"Brinchmann-Hansen, 0; Heier, H, Theoretical relationships between light streak characteristics and optical properties of retinal vessels, Acta Ophthalmolog. Suppl. 1986, 179, 33-37.","cites":null},{"id":18436487,"title":"Using active contours for segmentation of middle-ear images,","authors":[],"date":"2003","doi":null,"raw":"Hatamzadeh-Tabrizi J, 2003. Using active contours for segmentation of middle-ear images, M. Eng. Thesis, McGill University, Montral, Qubec.","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2008-08-20","abstract":"This paper describes REVIEW, a new retinal vessel reference dataset. This dataset includes 16 images with 193 vessel segments, demonstrating a variety of pathologies and vessel types. The vessel edges are marked by three observers using a special drawing tool. The paper also describes the algorithm used to process these segments to produce vessel profiles, against which vessel width measurement algorithms can be assessed. Recommendations are given for use of the dataset in performance assessment. REVIEW can be downloaded from http:\/\/ReviewDB.lincoln.ac.uk","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/55435.pdf","fullTextIdentifier":"http:\/\/eprints.lincoln.ac.uk\/2077\/1\/AlDiri2005IFMBEARibbonOfTwins.pdf","pdfHashValue":"87950f3ce0d39708762092fb2b0ec51d37d5cfa8","publisher":"IEEE","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lincoln.ac.uk:2077<\/identifier><datestamp>\n      2013-11-18T12:16:52Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D6A6163735F47:6A6163735F47373430<\/setSpec><setSpec>\n      74797065733D636F6E666572656E63655F6974656D<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/eprints.lincoln.ac.uk\/2077\/<\/dc:relation><dc:title>\n        REVIEW - A reference data set for retinal vessel profiles<\/dc:title><dc:creator>\n        Al-Diri, Bashir<\/dc:creator><dc:creator>\n        Hunter, Andrew<\/dc:creator><dc:creator>\n        Habib, Maged<\/dc:creator><dc:creator>\n        Steel, David<\/dc:creator><dc:creator>\n        Hudaib, Taghread<\/dc:creator><dc:creator>\n        Berry, Simon<\/dc:creator><dc:subject>\n        G740 Computer Vision<\/dc:subject><dc:description>\n        This paper describes REVIEW, a new retinal vessel reference dataset. This dataset includes 16 images with 193 vessel segments, demonstrating a variety of pathologies and vessel types. The vessel edges are marked by three observers using a special drawing tool. The paper also describes the algorithm used to process these segments to produce vessel profiles, against which vessel width measurement algorithms can be assessed. Recommendations are given for use of the dataset in performance assessment. REVIEW can be downloaded from http:\/\/ReviewDB.lincoln.ac.uk.<\/dc:description><dc:publisher>\n        IEEE<\/dc:publisher><dc:date>\n        2008-08-20<\/dc:date><dc:type>\n        Conference or Workshop contribution<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/eprints.lincoln.ac.uk\/2077\/1\/AlDiri2005IFMBEARibbonOfTwins.pdf<\/dc:identifier><dc:identifier>\n          Al-Diri, Bashir and Hunter, Andrew and Habib, Maged and Steel, David and Hudaib, Taghread and Berry, Simon  (2008) REVIEW - A reference data set for retinal vessel profiles.  In: The 30th Annual International Conference of the IEEE Engineering in Medicine and Biology Society, 20-24 August 2008, Vancouver, British Columbia, Canada.  <\/dc:identifier><dc:relation>\n        http:\/\/dx.doi.org\/10.1109\/IEMBS.2008.4649647<\/dc:relation><dc:relation>\n        10.1109\/IEMBS.2008.4649647<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/eprints.lincoln.ac.uk\/2077\/","http:\/\/dx.doi.org\/10.1109\/IEMBS.2008.4649647","10.1109\/IEMBS.2008.4649647"],"year":2008,"topics":["G740 Computer Vision"],"subject":["Conference or Workshop contribution","PeerReviewed"],"fullText":"[table]position=top\nA RIBBON OF TWINS FOR EXTRACTING VESSEL BOUNDARIES\nB. Al-Diri\u2217 and A. Hunter\u2217\n\u2217 The University of Lincoln\nbaldiri@lincoln.ac.uk\nAbstract:\nThis paper presents an efficient model for automatic\ndetection and extraction of blood vessels in ocular fun-\ndus images. The model is formed using a combina-\ntion of the concept of ribbon snakes and twin snakes.\nOn each edge, the twin concept is introduced by us-\ning two snakes, one inside one outside the boundary.\nThe ribbon concept integrates the pair of twins on the\ntwo vessel edges into a single ribbon. The twins main-\ntain the consistency of the vessel width, particulary\non very blurred, thin and noisy vessels. The model ex-\nhibits excellent performance in extracting the bound-\naries of vessels, with improved robustness compared\nto alternative models in the presence of occlusion,\npoor contrast or noise. Results are presented which\ndemonstrate the performance of the discussed edge\nextraction method, and show a significant improve-\nment compared to classical snake formulations.\nIntroduction\nVessel segmentation algorithms are a critical compo-\nnent of blood vessel analysis systems. The segmentation\nof vascular structures plays an important role in diagno-\nsis, surgery and research, in many important systematic\ndiseases such as diabetes and hypertension. Furthermore,\nthe vascular tree seems to be the most appropriate repre-\nsentation for image registration applications.\nA number of authors have investigated the use of\nactive contour models in retinal vascular segmentation.\nHowever, none have reached the level of performance re-\nquired for robust automatic detection of the entire net-\nwork of blood vessels, which is needed for measurement\ntechniques used for identifying and grading the sever-\nity of diabetic retinopathy. We have thus introduced a\nnew parametric active contour model called a ribbon of\ntwins. our model uses the Gradient Vector Flow method\n\u2013 which provides good performance through concavi-\nties and noise features; the \u201ctwin\u201d method \u2013 which uses\ntwo contours coupled by spring models to overcome ini-\ntialization and localized feature problems; and the \u201crib-\nbon\u201d method, which couples two snakes with a consis-\ntent width parameter. Our model integrates these differ-\nent features to produce a novel hybrid model.\nParametric contours\nIn the parametric approach, an active contour [1] is\nrepresented as a curve or spline, v(s) = (x(s),y(s), where\nv is a \u201cvertex\u201d and x and y represent the coordinates of\nthe vertices and are functions of the normalised arc length\n0 \u2264 s \u2265 1. The active contour has a dynamic behaviour\nthat deforms from an initial position and hopefully con-\nverges to the boundary of the object. The energy func-\ntional E\u2217snake composed of energy terms defines this be-\nhaviour:\nE\u2217snake =\n\u222b 1\n0\nEsnake(v(s))ds (1)\n=\n\u222b 1\n0\n(\nEint(v(s))+Epho(v(s))+Eext(v(s))\n)\nds (2)\n\u2013 where Eint is the internal energy term that is based\non the curve itself, which is designed to keep the model\nsmooth during deformation; Epho is the photometric en-\nergy term that arise from the image information, which is\ndefined to move the model toward an object boundary or\nother desired feature within an image; Eext is the external\nenergy term that is proposed to improve the capture range\nof the photometric force.\nInternal energy\nThe internal energy consists of a first order term and\na second order term [1].\nEint =\n\u03b1(s)|v\u2032(s)|2+\u03b2 (s)|v\u2032\u2032(s)|2\n2\n(3)\nwhere v\u2032(s) and v\u2032\u2032(s) denote the first and second deriva-\ntive respectively, and parameters \u03b1 and \u03b2 are the coeffi-\ncients of the internal energy term and represent tension\nand rigidity, respectively.\nPhotometric energy\nThe photometric energy is derived from the image to\nattract the snake toward desired objects such as bound-\naries. Given a gray-level image I(x,y),the photometric\nenergy leading an active contour towards edges is defined\nby [1]:\nE(1)pho =\u2212|\u2207I(x,y)|2 (4)\nE(2)pho =\u2212|\u2207(G\u03c3 (x,y)\u2217 I(x,y))|2 (5)\nwhere G\u03c3 (x,y) is a two-dimensional gaussian filter with\nstandard deviation \u03c3 ,\u2207 is the gradient operator, and \u2217 is\nthe 2D image convolution operator. The blurred gradi-\nent based approach has a number of limitations. First,\nin boundary concavities the gradient vectors point in op-\nposite directions and may cancel under smoothing [2].\nSecond, the algorithm has a limited capture range as\nthe magnitude of the photometric force dies out quite\nrapidly away from the object boundary. Increasing \u03c3 ,\nthe smoothing filter size, increases this range but at the\ncost of less accurate and distinct boundary localization,\nultimately obliterating concavities when \u03c3 becomes too\nlarge [2].\nAlternative formulations have been suggested to over-\ncome the limitations of the basic gradient formation.\nDistance potential forces [3] were proposed to im-\nprove the capture range of the photometric force. In this\napproach, a thresholded edge map (a binary image) is\ngenerated. A potential function is computed using a Eu-\nclidean (or chamfer) distance map, which is based on the\nimage information, and the negative gradient of this is\nused.\nFext =\u2212\u2207P(v) (6)\nThe Euclidean distance map can be computed in different\nways, for example [3]:\nP(v) =\u2212ed(v)2 (7)\nwhere d(v) is the distance between a point v on the im-\nage and the nearest image edge pixel that is detected by\nan edge detector. The attraction potential force does not\nchange the direction of the forces, only their magnitudes.\nTherefore, the problem of convergence to boundary con-\ncavities is not solved [2].\nA more sophisticated approach is the Gradient Vec-\ntor Flow (GVF)[2] algorithm. Which provides a large\ncapture range for the boundary, so the active contour\ndoes not have to be initialized close to the boundary.\nIt also improves active convergence in concavities [4].\nThe GVF field is defined to be the vector field V(x,y) =\n[u(x,y),v(x,y)] that minimises the energy functional (\u03b5):\n\u03b5 =\n\u222b \u222b\n\u00b5(u2x +u2y + v2x + v2y)+ |\u2207 f |2|V\u2212\u2207f|2dxdy.\n(8)\nwhere\nf (x,y) =\u2212Epho(x,y) (9)\n\u2013 where f (x,y) is the photometric energy term that can\nbe the gradient of the image, and \u00b5 is a weighting pa-\nrameter, also called a regularisation [2] factor. This is\nused to manage the trade off between the two terms of\nthe integrand. When |\u2207 f | is small (e.g. in homogeneous\nregions), the energy functional is dominated by the first\nterm (smoothing term) yielding a slowly varying field.\nHowever, if |\u2207 f | is large, the second term dominates the\nintegrand, and the term is minimised when V = \u2207f. The\nchoice of \u00b5 depends on the amount of noise in the image\n\u2013 the more noise in the image, the larger \u00b5 should be,\nsince in the presence of noise the gradient increases and\n\u00b5 should increase to control the trade off between the first\nand second terms in 8. However, GVF sometimes led to\nedge delocalisation for boundary regions with low con-\ntrast and for boundary regions between nearby structure\n[5]. The \u00b5 should be as small as possible because as it\nincreases edge delocalization gets worse.\nExternal energy\nThe External energy is used to provide high-level\nguidance to the active contour, to expedite convergence\nto the boundary and improve the capture range of the im-\nage force [6], and to compensate for problems such as a\nclose-up of the Photometric force field within the bound-\nary concavity. The most popular external energy terms\nwill be discussed here:\nSprings and volcanos were introduced by [1] as user-\ndefined constraints that can be applied to an iterating ac-\ntive contour. The spring pulls the vertex toward itself with\na force proportional to the distance between the spring\npoint and the vertex:\nEspring =\u2212k(p\u2212 vi)2 (10)\nwhere p and v are positions of the spring and the ver-\ntex, respectively, and k is a weighting factor. A volcano\ncreates an expansive force that is applied to all vertices\nfrom a point c inside the region of interest. At each ver-\ntex this force is inversely proportional to the distance be-\ntween point c and the vertex. A volcano is defined as:\nEvolcano =\n1\nr2\n(11)\nwhere r is the distance between point c and the vertex.\nA pressure force or balloon model [7] was proposed\nas a external force to improve the capture range of the\ngradient. The pressure force is independent of the image\ninformation and defines the direction of the active con-\ntour deformation by inflating or deflating it. Using this\ntechnique, the external force is composed of the Photo-\nmetric and the pressure forces:\nFext = kpressuren(s)\u2212k Fphot||Fphot|| (12)\nwhere kpressure is the pressure weighting and its positive\nor negative sign leads the active contour to inflate and de-\nflate, respectively; n(s) represents the unit vectors normal\nto vertices; k is the photometric force weighting where\nthe photometric force is the gradient of the image.\nThe Dual Active Contour algorithm[8] was proposed\nas an external force (spring force) to overcome the pri-\nmary problems of sensitivity to initialisation and unde-\nsirable convergence to insignificant localised or region-\nalised features [8]. An interior contour lies within the\nregion of the desired feature and an exterior contour out-\nside it. The two contours are coupled using springs which\ncause them to be attracted to each other as well as to suit-\nable image features. The spring force is controlled by \u03bb ,\nEext(v(s)) = \u03bb\n1\n2\n(v(s)\u2212mean(s))2 (13)\nwhere mean(s) is the mean contour of the interior and\nexterior contours.\nmean(s) =\n1\n2 (inner(s)+outer(s)) (14)\nThe Dual snake includes a shape factor that forces the\nsnake to adjust to a specific form (e.g., a circle).\nThe Central contour model and pressure contour\nmodel [9] were proposed to simplify the computational\nprocedure. The central point model relies on the idea that\nmotion of the contour points takes place along a predeter-\nmined number of fixed radial lines which originate from\nan arbitrarily chosen contour center point. These radial\nlines have equal angular spacing through 2pi radians. The\nmodel tries to control forces on vertices with respect to\nthe radial distance of snakels from the central point. Spa-\ntial co-ordinates of each contour snaxel can be computed\nfrom the following relationship:\nx(s) = x0+ r(s)sin\n2pis\nSm\ny(s) = y0+ r(s)cos\n2pis\nSm\n(15)\nwhere x0, y0 are the co-ordinates of the arbitrarily chosen\ncontour central point, Sm is the number of contour snax-\nels, s is the snakel number, i.e. s = 0,1, ...,Sm\u22121 and r(s)\nis the radial distance of snaxel s from the central point.\nThe pressure contour model aimed to extend active con-\ntour capabilities when edges of complex shapes need to\nbe extracted. The directions of the pressure forces have\nto computed with high accuracy and the adjacent snaxels\nshould not be too close to each other so that the computa-\ntion of the perpendicular direction to the contour is based\non a large contour fragment [9].\nSandwich snakes [10] [11] are two snakes looking for\nthe same contour; for closed contours one snake has an\ninitial position inside of the contour, and the other outside\nof the contour of the object; both snakes have equal num-\nber of particles, the corresponding particles are connected\nwith a spring with an equilibrium length equal to zero, so,\nthe energy function for sandwich snakes includes a new\nterm in the internal energy; furthermore, the coefficient \u03b1\nis equal to zero to prevent the snake from minimizing its\nlength [10]. The energy function of the sandwich snakes\nis:\nE(p,q) = \u03b2 \u2211\ni\n|\u2212 pi\u22121+2pi\u2212 pi+1|2\n+\u03b2 \u2211\ni\n|\u2212qi\u22121+2qi\u2212qi+1|2\n+ \u03b3 \u2211\ni\n|pi\u2212qi|\u2212\u03bb [|\u2207M(pi)|+ |\u2207M(qi)|] (16)\nwhere pi denotes the position of the i particle for the inter-\nnal snake, and qi the position of the i particle for external\nsnake. M(pi) is the M image evaluated at the pi position.\nThe twin snake algorithm [12] is an extension to the\ntraditional snake, designed to detect two parallel contours\nsimultaneously, and is useful for line extraction in high\nresolution imagery. Lines in the image have two bound-\nary contours close to each other; traditional snakes cannot\nguarantee to detect exactly one of the two, and in fact the\nextracted curve will jump between the two contours [12].\nTherefore the twin snakes used to find the two parallel\ncontours simultaneously. The external attraction force is\nintroduced as\nEext(vi) = \u03b4i(di\u2212d0)2 (17)\nwhere \u03b4i is a weight factor,di is the actual distance to the\ntwin partner at point i and d0 the desired distance. The\nmethod often fails when using snakes for line extraction\nin high-resolution images [12]; unless the lines to be ex-\ntracted can be defined as homogeneous, elongated areas\nwith two parallel contours; also the depicted lines must\nhave a width of at least three pixels, which guarantees\nthat the two contours of the line can be detected inde-\npendently [12]; this condition is not met in fine retinal\nvessels.\nRibbon snakes [13] [14], used for road extraction, ex-\ntend the original snakes with a width component, defined\nas\n~v(s, t) = (x(s, t),y(s, t),w(s, t)),(0\u2264 s\u2265 1) (18)\nwhere s is proportional to the length of the ribbon, t is\nthe current time, x and y are the coordinates of the cen-\nterline of the ribbon, and w is the half width of the rib-\nbon measured perpendicular to the centerline. For each\nslice of the ribbon~v(s0, t0) there exist two points~vL(s0, t0)\nand ~vR(s0, t0) corresponding to the ribbons left and right\nsides. The position of these points composing the ribbons\nboundaries which can be expressed as:\n~vR(s, t) =w(s, t)~(n)(s, t)~vL(s, t) =\u2212w(s, t)~(n)(s, t) (19)\nwhere~n(s, t) is the unit normal vector of the ribbon\u2019s cen-\nterline. The photometric term will be:\np(~v(s, t) = |\u2207I(~vR(s, t))|+ |\u2207I(~vL(s, t))| (20)\nThe function can be redefined [13] [14] as\np(~v(s, t) = (\u2207I(~vL(s, t))\u2212 (\u2207I(~vR(s, t))).~v(s, t) (21)\nRibbon of Twins for Vascular Segmentation\nWe introduce a new parametric active contour model\nsuitable for segmentation of retinal vessels and other fine,\nnoisy, linear structures. Two twins of contours represent\na ribbon along a vessel, with one twin on each edge of\nthe vessel. Each twin consists of two contours, one inside\nand one outside the vessel. Each contour consists of a\nnumber of nodes. Corresponding nodes on the four con-\ntours are connected together to form a single integrated\nmodel. The two outside contours are connected by pull\nforces to the inside contours, while the inside contours are\nconnected by push forces with each other; see Figure 1.\nThe model is suitable for extracting vessels, roads or\nany tunnel shape. This model was tested on retinal ves-\nsels; we assumed that a segment of vessel has approx-\nimately parallel straight boundaries. We used the four\nFigure 1: A Ribbon of Twin Diagram\ncontours to extract a segment-vessel boundary, The en-\nergy of four contours are defined as:\nE poscontour =\n\u222b 1\n0\n(\nE posint (v(s))+E\npos\npho(v(s))+E\npos\next (v(s))\n)\nds\n(22)\n\u2013 where the pos \u2208 re,ri, le, li which refers to the posi-\ntion of the contours \u201d\u2018right external contour, right internal\ncontour, left external contour and left internal contour\u201d\u2019\nThe internal energy is described in equation 3. The pho-\ntometric energy is modified to\nEpho =\u2212|GV F( f (x,y)|2 (23)\nwhere f (x,y) a photometric energy which is defined as\nf (x,y) = G\u03c3 (x,y)\u2217 I(x,y) (24)\nThe external energy includes two different terms: the\n\u201cpush\u201d and \u201cpull\u201d energies. The push energy is used in-\nside the vessel to push contours toward interior boundary\nof the vessel and to maintain it\u2019s width consistency, as\ndescribed below:\nEpush =\u2212|VW \u2212|v\nr(n)\u2212 vl(n)||2\n2\n(25)\nwhere VW is the vessel width, vr(n) is the right contour,\nvl(n) is the left contour, and n is the index of nodes. The\nvessel\u2019s approximate width is calculated using one of the\nsimple and traditional methods (e.g. [15],[16]).\nThe pull energy is used outside vessel to pull outside\ncontours toward the inside contours, the pull energy is\ndescribed as:\nEpull =\u2212|v\ni(n)\u2212 ve(n)|2\n2\n(26)\nwhere i is internal contour and e is external contour.\nThe model converges when the maximum distance\nbetween both contours inside twin are less than a thresh-\nold (Twin-Threshold); the threshold is a sub-pixel value\n(e.g. 0.3 pixels). Edges of vessel are captured from both\nsides by inside and outside contours. The distance be-\ntween the inside contours gives the vessel width, and is\nvery accurate.\nResults\nThe ribbon snake has been previously used to extract\nroads and blood vessels. However, the performance on\nvessels is not as good as on roads. This is due to the con-\ntrasting characteristics of roads and vessels. Roads have\ntwo parallel edges with a fixed width, in contrast to retina\nvessels. In addition, there are a lot of diseases that af-\nfect the vessels of the retina; that effect changes in width,\ncolour and the path of vessel. Adding to those difficulties,\nnoise in retinal images often makes the vessel\u2019s boundary\nblurred and fuzzy, particularly for vessels near the edge\nof the image.\nWe illustrate the performance of the new model on a\nnumber of typical problem cases found in retinal segmen-\ntation; the model parameters are GVF (iteration=90 and\n\u00b5 = 0.02), \u03c3 = 1.8, Twin-Threshold = 0.3; \u03b2 = distance\nbetween two nodes which is equal 0.3 where \u03b1 is equal\n\u03b2 \/4.\nThe first case is performed on a noisy vessel segment,\nas shown in Figure 2.\nFigure 2: Convergence of the ribbon of twins on a single\nvessel with high noise around the vessel edges.\nThe second case shows the performance on very close\nvessels; their edges could be very blurred and the strong\nappearance edge of one vessel may affect the appearance\nedge of the other, particularly as the outside contours may\ninitially be situated inside it\u2019s neighbour vessel as in Fig-\nure 3. The outside contours will be pulled towards the\ninside contours; if the outside contours are stuck at any\nlocal minima where the local gradient force is greater or\nequal to the pull force and the maximum deformable dis-\ntance of the outside contours is approximately zero, then\nthe weight of the photometric term set to zero for next\niteration, allowing the outside contour to escape the local\nminimum.\nThe third case illustrates performance on a vessel\nwhich has a light reflex phenomenon; this causes sig-\nnificant problems for most vessel segmentation methods,\nmaking it difficult to calculate the width [17]. The pro-\nposed model is not affected by this phenomenon because\nthe two inside contours are initiated far from the ves-\nsel centre, and the push-force push them outside toward\nFigure 3: Two close vessel segments, where the contour\nconverges correctly despite poor initializations.\nedge, which has the opposite sense to any gradient forces\nrelated to the light reflex phenomenon, as in Figure 4.\nFigure 4: The model converges successfully on a vessel\nwith a central light reflex.\nThe fourth case illustrates performance on very fine\nvessels. The majority of previously published methods\nfail to extract small vessels, which are important in diag-\nnostic systems; the new model can extract and measure\nvery tiny vessels, as shown in Figure 5.\nFigure 5: Convergence on very fine vessels.\nThe pull and push forces are normalized to keep the\nmodel balanced. Consequently the external forces are\nstrongest at the initial stage, and weakest at the desired\nedge; these forces do not allow the contours to jump to\nthe other side, as occurs in some snake formulations, be-\ncause they pull the contours back.\nConclusion\nWe have presented a new kind of snake called \u201da\nribbon of twins\u201d. This consists of four contours to ex-\ntract segments of vessel boundaries, a ribbon joining two\ntwins. The model exhibits robust behaviour, even with\nhigh levels of noise, and can accurately locate contours\nunder difficult conditions, including: noisy blurred edges,\nclosely parallel vessels, light reflex phenomenon, and\nvery fine vessels. The model is more computationally ex-\npensive than the ribbon model, but the measurements are\nmore accurate. The trade off between more computation\nand more accurate measurements and the previous mod-\nels is governed by the purpose and usage of the model.\nReferences\n[1] Kass, M., Witkin, A., Terzopoulos, D., 1988.\nSnakes: active contour models. International Jour-\nnal of Computer Vision, 1(4), pp. 321-331\n[2] C. Xu and J. L. Prince, 1998. Snakes, Shapes, and\nGradient Vector Flow,\u201d IEEE Transactions on Im-\nage Processing, 7(3): 359-369.\n[3] Cohen LD and Cohen I. 1993. Finite-element\nmethods for active contour models and balloons\nfor 2-D and 3-D images, IEEE Trans. on PAMI,\n15 (11), 1131-1147.\n[4] Hatamzadeh-Tabrizi J, 2003. Using active con-\ntours for segmentation of middle-ear images, M.\nEng. Thesis, McGill University, Montral, Qubec.\n[5] Hatamzadeh-Tabrizi J and Funnell WRJ 2002.\nComparison of gradient, gradient vector flow and\npressure force for image segmentation using active\ncontours. Proc 27th Ann Conf Can Med Biol Eng\nSoc (CD-ROM), 4 pp.\n[6] Feng Y and Gelenbe E 1998. Adaptive object\ntracking and video compression with dynamic\ncontours, IEEE Proceedings of the Fifteenth Na-\ntional Radio Science Conf.,NRSC, 1, INV3\/1 -\nINV326.\n[7] Cohen LD, 1991. On active contour models and\nballons. CVGIP: Image Understanding, 53(2):211-\n218.\n[8] Gunn, S. R. and Nixon, M. S. 1994. A Model\nBased Dual Active Contour. In Proceedings of\nProc. British Machine Vision Conference, pages\npp. 305-314. Hancock, E., Eds.\n[9] P. Szczypinski, P. Strumillo, Application of an Ac-\ntive Contour Model for Extraction of Fuzzy and\nBroken Image Edges, Machine GRAPHICS and\nVISION, Vol.5, No.4, 1996, pp. 579-594\n[10] F. Velasco and JL. Marroqun, 1998. Sandwich\nSnakes a robust parametric active contour. Pro-\nceedings of SPIE, San Diego Ca. USA, Image\nAnalysis, Vol 3460, pp 226-236\n[11] Velasco, Fernando A. and Jose L. Marroqu\u2019n, Ro-\nbust parametric active contours: the Sandwich\nSnakes, pp. 238-242.\n[12] KERSCHNER M. 2000. Twin Snakes for Deter-\nmining Seam Lines in Orthoimage Mosaicking.\nInternational Archives of Photogrammetry and Re-\nmote Sensing, Vol. 33, Part B4, Amsterdam, pp.\n454-461.\n[13] Baumgartner, A., Steger, C., Mayer, H., Eckstein,\nW., Ebner, H. 1999. Automatic Road Extraction\nBased on Multi-Scale, Grouping, and Context.\nPhotogrammetric Engineering and Remote Sens-\ning (65) 7, 777-786.\n[14] Laptev, I., Mayer, H., Lindeberg, T., Eckstein, W.,\nSteger, C.T.[Carsten T.], Baumgartner, A. 2000.\nAutomatic extraction of roads from aerial images\nbased on scale space and snakes, MVA(12), No. 1,\npp. 23-31.\n[15] Brinchmann-Hansen, 0; Heier, H, Theoretical re-\nlationships between light streak characteristics and\noptical properties of retinal vessels, Acta Ophthal-\nmolog. Suppl. 1986, 179, 33-37.\n[16] Gregson, P.H; et al, Automated Grading of Venous\nBeading, Computers and Biomedical Research,\n28, 2000, 291-304.\n[17] J.A. Lowell, A. Hunter, and D. Steel, \u201dQuan-\ntitative measurement of retinal vessel widths\nfrom fundus images based on 2d mod-\nelling,\u201d Tech. Rep. 06\/02, Department of\nComputer Science, University of Durham,\nScience Labs., South Rd., Durham, UK, 2002,\nhttp:\/\/www.dur.ac.uk\/computer.science\/technicalreports\/technical-\nreports.html.\n"}