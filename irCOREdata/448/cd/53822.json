{"doi":"10.1109\/TVT.2009.2028348","coreId":"53822","oai":"oai:eprints.lincoln.ac.uk:2867","identifiers":["oai:eprints.lincoln.ac.uk:2867","10.1109\/TVT.2009.2028348"],"title":"New battery model and state-of-health determination through subspace parameter estimation and state-observer techniques","authors":["Gould, C.","Bingham, Chris","Stone, D. A.","Bentley, P."],"enrichments":{"references":[{"id":852071,"title":"A new approach to linear \ufb01ltering and prediction problems,\u201d Trans.","authors":[],"date":null,"doi":"10.1115\/1.3662552","raw":"[11] R. E. Kalman, \u201cA new approach to linear \ufb01ltering and prediction problems,\u201d Trans. ASME\u2014J. Basic Eng., Ser. D,v o l .8 2 ,n o .1 ,p p .3 5 \u2013 4 5 , 1982. [12] L. Ljung, System Identi\ufb01cation\u2014Theory for the User,2 n de d .","cites":null},{"id":851328,"title":"Aging effects in valveregulated lead\u2013acid batteries,\u201d in","authors":[],"date":"1993","doi":"10.1109\/intlec.1993.388583","raw":null,"cites":null},{"id":851554,"title":"Aging mechanisms and service life of lead\u2013acid batteries,\u201d","authors":[],"date":"2004","doi":"10.1016\/j.jpowsour.2003.09.052","raw":null,"cites":null},{"id":850321,"title":"An adaptive battery monitoring system for an electric vehicle,\u201d in","authors":[],"date":"1998","doi":"10.1109\/pedes.1998.1330701","raw":null,"cites":null},{"id":849875,"title":"Avalable: http:\/\/www.atsltd.co.uk [2] A. Jossen, \u201cFundamentals of battery dynamics,\u201d","authors":[],"date":"2006","doi":null,"raw":null,"cites":null},{"id":850791,"title":"Battery state of health estimation through coup de fouet,\u201d in","authors":[],"date":"2000","doi":"10.1109\/intlec.2000.884309","raw":null,"cites":null},{"id":852555,"title":"Bingham (M\u201900) received the B.Eng. degree in electronic systems and control engineering from Shef\ufb01eld City Polytechnic,","authors":[],"date":"1989","doi":null,"raw":"C. M. Bingham (M\u201900) received the B.Eng. degree in electronic systems and control engineering from Shef\ufb01eld City Polytechnic, Shef\ufb01eld, U.K., in 1989, the M.Sc. (Eng.) degree in control systems engineering from the University of Shef\ufb01eld in 1990, and the Ph.D. degreefromCran\ufb01eldUniversity, Shrivenham, U.K., in 1994, for research on control systems to accommodate nonlinear dynamic effects in aerospace \ufb02ight-surface actuators.","cites":null},{"id":851802,"title":"Elecktrochemische Kinetik.","authors":[],"date":"1961","doi":"10.1007\/978-3-642-86547-3","raw":"[10] K. J. Vetter, Elecktrochemische Kinetik. Berlin, Germany: SpringerVerlag, 1961, p. 268.","cites":null},{"id":18449665,"title":"Fundamentals of battery dynamics,\u201d","authors":[],"date":"2006","doi":null,"raw":"[1] [Online]. Avalable: http:\/\/www.atsltd.co.uk [2] A. Jossen, \u201cFundamentals of battery dynamics,\u201d J. Power Sources, vol. 154, no. 2, pp. 530\u2013538, Mar. 2006. [3] A. Kawamura and T. Yanagihara, \u201cState of charge estimation of sealed lead\u2013acid batteries used for electric vehicles,\u201d in Proc. 29th Annu. IEEE Power Electron. Spec. Conf.,M a y1 9 9 8 ,v o l .1 ,p p .5 8 3 \u2013 5 8 7 . [4] P. Sinclair, R. Duke, and S. Round, \u201cAn adaptive battery monitoring system for an electric vehicle,\u201d in Proc. Int. Conf. Power Electron. Drives Energy Syst. Ind. Growth,D e c .1 9 9 8 ,v o l .2 ,p p .7 8 6 \u2013 7 9 1 . [5] P.-S. Kim, \u201cNew estimation \ufb01ltering for battery management systems of lead\u2013acid cells in hybrid electric vehicles,\u201d Int. J. Comput. Sci. Netw. Security,v o l .7 ,n o .2 ,p p .1 3 6 \u2013 1 4 1 ,F e b .2 0 0 7 . [6] C. S. C. Bose and F. C. Laman, \u201cBattery state of health estimation through coup de fouet,\u201d in Proc. 22nd INTELEC,2 0 0 0 ,p p .5 9 7 \u2013 6 0 1 . [7] B. S. Bhangu, P. Bentley, D. A. Stone, and C. M. Bingham, \u201cObserver techniques for estimating the state-of-charge and state-of-health of VRLABs for hybrid-electric vehicles,\u201d in Proc. IEEE Conf. Veh. Power Propuls.,S e p .2 0 0 5 ,p p .7 8 0 \u2013 7 8 9 . [8] D. Berndt, E. Meissner, and R. Rusch, \u201cAging effects in valveregulated lead\u2013acid batteries,\u201d in Proc. 15th INTELEC,S e p .1 9 9 3 ,v o l .2 , pp. 139\u2013145. [9] P. Ruetschi, \u201cAging mechanisms and service life of lead\u2013acid batteries,\u201d J. Power Sources,v o l .1 2 7 ,n o .1 \/ 2 ,p p .3 3 \u2013 4 4 ,M a r .2 0 0 4 .","cites":null},{"id":852325,"title":"Gould received the M.Eng. degree in electronic and electrical engineering with communications and the Ph.D. degree from the University of Shef\ufb01eld,","authors":[],"date":"2002","doi":null,"raw":"C. R. Gould received the M.Eng. degree in electronic and electrical engineering with communications and the Ph.D. degree from the University of Shef\ufb01eld, Shef\ufb01eld, U.K, in 2002 and 2006, respectively.","cites":null},{"id":853320,"title":"He has been a Research Associate with the Electrical Machines and","authors":[],"date":"2001","doi":null,"raw":"He has been a Research Associate with the Electrical Machines and Drives Group, Department of Electronic and Electrical Engineering, University of Shef\ufb01eld, since 2001. His research interests include energy storage components for hybrid and electric vehicle drive trains and energy-scavenging devices.","cites":null},{"id":852834,"title":"He was a Postdoctoral Researcher with Cran\ufb01eld University until taking a research position with the University of Shef\ufb01eld. He was appointed Lecturer with the Department of Electronic and Electrical Engineering, University of Shef\ufb01eld, in","authors":[],"date":"1998","doi":null,"raw":"He was a Postdoctoral Researcher with Cran\ufb01eld University until taking a research position with the University of Shef\ufb01eld. He was appointed Lecturer with the Department of Electronic and Electrical Engineering, University of Shef\ufb01eld, in 1998 and Senior Lecturer in 2003. His current research interests include traction control\/ antilock braking systems for electric vehicles, electromechanical actuation of \ufb02ight control surfaces, control of active magnetic bearings for high-speed machines, sensorless control of brushless machines, and the high-speed modeling, analysis, and design of resonant power converters.3916 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 58, NO. 8, OCTOBER 2009 D. A. Stone received the B.Eng. degree in electronic engineering from the University of Shef\ufb01eld, Shef\ufb01eld, U.K., in 1984 and the Ph.D. degree from Liverpool University, Liverpool, U.K., in 1989. He is currently with the University of Shef\ufb01eld as aM e m b e ro fA c a d e m i cS t a f f ,s p e c i a l i z i n gi np o w e r electronics and machine drive systems. His current research interests include hybrid-electric vehicles,batterycharging,electromagneticcompatibility, and novel lamp ballast for low-pressure \ufb02uorescent lamps.","cites":null},{"id":851035,"title":"Observer techniques for estimating the state-of-charge and state-of-health of VRLABs for hybrid-electric vehicles,\u201d in","authors":[],"date":"2005","doi":"10.1109\/vppc.2005.1554646","raw":null,"cites":null},{"id":853050,"title":"received the B.Sc. degree in engineering physics from Shef\ufb01eld Hallam University,","authors":[],"date":"1998","doi":null,"raw":"P. Bentley received the B.Sc. degree in engineering physics from Shef\ufb01eld Hallam University, Shef\ufb01eld, U.K., in 1998 and the Ph.D. degree for the dynamic characterization and modeling of battery technologiesforall\/moreelectricvehiclesfromtheUniversity of Shef\ufb01eld in 2004.","cites":null},{"id":850080,"title":"State of charge estimation of sealed lead\u2013acid batteries used for electric vehicles,\u201d in","authors":[],"date":"1998","doi":"10.1109\/pesc.1998.701957","raw":null,"cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2009","abstract":"This paper describes a novel adaptive battery model based on a remapped variant of the well-known Randles' lead-acid model. Remapping of the model is shown to allow improved modeling capabilities and accurate estimates of dynamic circuit parameters when used with subspace parameter-estimation techniques. The performance of the proposed methodology is demonstrated by application to batteries for an all-electric personal rapid transit vehicle from the urban light transport (ULTRA) program, which is designated for use at Heathrow Airport, U.K. The advantages of the proposed model over the Randles' circuit are demonstrated by comparisons with alternative observer\/estimator techniques, such as the basic Utkin observer and the Kalman estimator. These techniques correctly identify and converge on voltages associated with the battery state-of-charge (SoC), despite erroneous initial conditions, thereby overcoming problems attributed to SoC drift (incurred by Coulomb-counting methods due to overcharging or ambient temperature fluctuations). Observation of these voltages, as well as online monitoring of the degradation of the estimated dynamic model parameters, allows battery aging (state-of-health) to also be assessed and, thereby, cell failure to be predicted. Due to the adaptive nature of the proposed algorithms, the techniques are suitable for applications over a wide range of operating environments, including large ambient temperature variations. Moreover, alternative battery topologies may also be accommodated by the automatic adjustment of the underlying state-space models used in both the parameter-estimation and observer\/estimator stages","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/53822.pdf","fullTextIdentifier":"http:\/\/eprints.lincoln.ac.uk\/2867\/1\/gould_bingham_2009.pdf","pdfHashValue":"483cb40722379de20d87d0a2344634da3c7a3f17","publisher":"Institution of Electronic and Electrical Engineers","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lincoln.ac.uk:2867<\/identifier><datestamp>\n      2014-08-28T09:24:51Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D6A6163735F48:6A6163735F48363030<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/eprints.lincoln.ac.uk\/2867\/<\/dc:relation><dc:title>\n        New battery model and state-of-health determination through subspace parameter estimation and state-observer techniques<\/dc:title><dc:creator>\n        Gould, C.<\/dc:creator><dc:creator>\n        Bingham, Chris<\/dc:creator><dc:creator>\n        Stone, D. A.<\/dc:creator><dc:creator>\n        Bentley, P.<\/dc:creator><dc:subject>\n        H600 Electronic and Electrical Engineering<\/dc:subject><dc:description>\n        This paper describes a novel adaptive battery model based on a remapped variant of the well-known Randles' lead-acid model. Remapping of the model is shown to allow improved modeling capabilities and accurate estimates of dynamic circuit parameters when used with subspace parameter-estimation techniques. The performance of the proposed methodology is demonstrated by application to batteries for an all-electric personal rapid transit vehicle from the urban light transport (ULTRA) program, which is designated for use at Heathrow Airport, U.K. The advantages of the proposed model over the Randles' circuit are demonstrated by comparisons with alternative observer\/estimator techniques, such as the basic Utkin observer and the Kalman estimator. These techniques correctly identify and converge on voltages associated with the battery state-of-charge (SoC), despite erroneous initial conditions, thereby overcoming problems attributed to SoC drift (incurred by Coulomb-counting methods due to overcharging or ambient temperature fluctuations). Observation of these voltages, as well as online monitoring of the degradation of the estimated dynamic model parameters, allows battery aging (state-of-health) to also be assessed and, thereby, cell failure to be predicted. Due to the adaptive nature of the proposed algorithms, the techniques are suitable for applications over a wide range of operating environments, including large ambient temperature variations. Moreover, alternative battery topologies may also be accommodated by the automatic adjustment of the underlying state-space models used in both the parameter-estimation and observer\/estimator stages.<\/dc:description><dc:publisher>\n        Institution of Electronic and Electrical Engineers<\/dc:publisher><dc:date>\n        2009<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/eprints.lincoln.ac.uk\/2867\/1\/gould_bingham_2009.pdf<\/dc:identifier><dc:identifier>\n          Gould, C. and Bingham, Chris and Stone, D. A. and Bentley, P.  (2009) New battery model and state-of-health determination through subspace parameter estimation and state-observer techniques.  Vehicular Technology, IEEE Transactions on, 58  (8).   pp. 3905-3916.  ISSN 0018-9545  <\/dc:identifier><dc:relation>\n        http:\/\/dx.doi.org\/10.1109\/TVT.2009.2028348<\/dc:relation><dc:relation>\n        10.1109\/TVT.2009.2028348<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/eprints.lincoln.ac.uk\/2867\/","http:\/\/dx.doi.org\/10.1109\/TVT.2009.2028348","10.1109\/TVT.2009.2028348"],"year":2009,"topics":["H600 Electronic and Electrical Engineering"],"subject":["Article","PeerReviewed"],"fullText":"IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 58, NO. 8, OCTOBER 2009 3905\nNew Battery Model and State-of-Health\nDetermination Through Subspace Parameter\nEstimation and State-Observer Techniques\nC. R. Gould, C. M. Bingham, Member, IEEE, D. A. Stone, and P. Bentley\nAbstract\u2014This paper describes a novel adaptive battery model\nbased on a remapped variant of the well-known Randles\u2019 lead\u2013\nacid model. Remapping of the model is shown to allow improved\nmodeling capabilities and accurate estimates of dynamic circuit\nparameters when used with subspace parameter-estimation tech-\nniques. The performance of the proposed methodology is demon-\nstrated by application to batteries for an all-electric personal rapid\ntransit vehicle from the Urban Light TRAnsport (ULTRA) pro-\ngram, which is designated for use at Heathrow Airport, U.K. The\nadvantages of the proposed model over the Randles\u2019 circuit are\ndemonstrated by comparisons with alternative observer\/estimator\ntechniques, such as the basic Utkin observer and the Kalman\nestimator. These techniques correctly identify and converge on\nvoltages associated with the battery state-of-charge (SoC), de-\nspite erroneous initial conditions, thereby overcoming problems\nattributed to SoC drift (incurred by Coulomb-counting methods\ndue to overcharging or ambient temperature fluctuations). Ob-\nservation of these voltages, as well as online monitoring of the\ndegradation of the estimated dynamic model parameters, allows\nbattery aging (state-of-health) to also be assessed and, thereby, cell\nfailure to be predicted. Due to the adaptive nature of the proposed\nalgorithms, the techniques are suitable for applications over a\nwide range of operating environments, including large ambient\ntemperature variations. Moreover, alternative battery topologies\nmay also be accommodated by the automatic adjustment of the un-\nderlying state-space models used in both the parameter-estimation\nand observer\/estimator stages.\nIndex Terms\u2014Battery-management systems, energy storage,\nparameter estimation, system identification.\nI. INTRODUCTION\nURBAN Light TRAnsport (ULTRA; see Fig. 1) is a per-sonal rapid transit (PRT) vehicle developed by Advanced\nTransport Systems Ltd. [1]. It is an unmanned steer-by-wire\nelectric vehicle capable of carrying a 500-kg payload at speeds\nup to 40 km\/h. ULTRA aims to improve the transportation\nneeds of a busy city or other public space (e.g., Heathrow\nAirport Terminal 5 in this case) with minimal environmental\nimpact while providing a comfortable flexible travel solution\nfor up to four passengers with luggage.\nWith the increasing drive toward use of X-by-wire control\nsystems and the desire for passenger comfort (i.e., in-vehicle\nManuscript received November 1, 2008; revised May 1, 2009. Current\nversion published October 2, 2009. This work was supported by the Engi-\nneering and Physical Sciences Research Council. The review of this paper was\ncoordinated by Prof. A. Miraoui.\nThe authors are with the Electrical Machines and Drives Group, Department\nof Electronic and Electrical Engineering, University of Sheffield, Sheffield S10\n2TN, U.K. (e-mail: c.gould@shef.ac.uk).\nDigital Object Identifier 10.1109\/TVT.2009.2028348\nFig. 1. ULTRA PRT vehicle [1].\nFig. 2. Example of an ULTRA driving cycle current profile.\nentertainment systems\/air-conditioning), the large transient\npower demands (see Fig. 2) that are characteristic of such\nvehicles are becoming of utmost importance to the operational\nsafety and reliability of the primary battery source, thereby\nnecessitating the use of advanced battery state-of-function\n(SoF) prediction techniques. Considering the many dynamic\nmechanisms occurring inside a battery to enable charge to be\naccepted and supplied [2], it is now necessary to assess the\nstate-of-charge (SoC\u2014amount of charge available in the battery\nat any time to sink\/source excessive transients) and state-of-\nhealth (SoH\u2014ability of that battery to repeatedly provide its\nrated capacity over time) of the battery in real time so that SoF\n0018-9545\/$26.00 \u00a9 2009 IEEE\n3906 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 58, NO. 8, OCTOBER 2009\nFig. 3. Randles\u2019 lead\u2013acid battery model.\ncan be assessed to avoid inconvenience to passengers and\/or\ncatastrophic failure of the safety\u2013critical battery pack.\nWhereas various SoC characterization techniques have been\nreported for lead\u2013acid battery technologies [3]\u2013[7], techniques\nfor SoH determination are much less prevalent, primarily be-\ncause SoH is a qualitative rather than a quantitative measure\nof battery aging or degradation [8], [9]. In most cases, SoH\nis estimated by monitoring the degradation of specific battery\nmodel parameters, as suggested in [7], where SoH deterioration\nis demonstrated using the well-known Randles\u2019 battery circuit\nmodel [10] using static parameters and a closed-loop extended\nKalman filter [11]. However, for highly dynamic operational\nduties (e.g., Fig. 2), static parameter values are not sufficient to\nobtain accurate descriptions of battery behavior.\nThis paper therefore initially focuses on deriving an accu-\nrate dynamic model of battery systems when operating under\nhigh stress, large bipolar current transients (and for occasional\nopportunist-charging scenarios). It is shown that the Randles\u2019\nmodel can be mapped to an alternative equivalent circuit, allow-\ning subspace parameter-estimation algorithms to be applied on-\nline and in combination with both Utkin observer and Kalman\nestimator (KE) predictor\/corrector techniques. The proposed\nmodel is demonstrated to be more appropriate than the Randles\u2019\ncircuit for use with the estimation algorithms, allowing adaptive\nidentification and convergence of the model voltages associated\nwith SoC and SoH monitoring. The resulting dynamic parame-\nter estimates will also be shown to be useful for fault prediction\nand battery end-of-life determination.\nII. BATTERY MODELING\nThe ULTRA vehicle relies on 4 \u00d7 12-V valve-regulated\nlead\u2013acid (VRLA) batteries, nominally rated at 45\u201350 Ah. Each\nbattery is individually monitored for SoF. Fig. 3 shows the\nRandles\u2019 circuit description of a cell, where Rd represents\nthe self-discharge resistance (approximately 5 k\u2126), and Cb is\nconsidered the main charge store (equivalent to \u223c1\u00d7 105 F\nfor a fully charged healthy 12-V battery). The voltage across\nCb is considered to be a suitable indicator of SoC, whereas\nSoH is inferred by observing a significant change in Cb over\ntime due to aging effects such as active mass degradation [9]\nand crystallization of the active mass, which will effectively\nreduce the surface area of the parallel plates\/grids. Ri models\nthe resistance of the battery\u2019s terminals and intercell connec-\ntions (between 5\u2013100 m\u2126), whereas Rt (10\u2013500 m\u2126) and\nCs (1000\u201320 000 F) describe transient effects resulting from\nshifting ion concentrations and plate current densities.\nFig. 4. Proposed remapped equivalent circuit.\nUsing a star\u2013delta transform, the Randles\u2019 model can be\nmapped to the equivalent circuit shown in Fig. 4, where the\nstar points of Fig. 3 are labeled 1, 2, and 3 with center C. Note\nthat points 2 and 3 are shorted, and therefore, the resulting delta\npoints will also require a short in parallel with the impedance\nusually expected.\nThe remaining two delta impedances are modeled by a\ncapacitor and a resistor in series (Cn andRn) and an impedance\nconsisting of a capacitor and a resistor in parallel (Cp and Rp).\nThe component and SoC voltage mappings are given in (1) and\n(2), respectively, and state equations are given in (3) and (4),\nrespectively, for the Randles\u2019 and mapped circuits, i.e.,\nCn =C2b \/(Cb + Cs), Cp = CbCs\/(Cb + Cs)\nRn =Rt(Cb + Cs)2\/C2b , Rp = Rd +Rt (1)\nVCb =\n(\nVCnCn + VCpCp\n)\n\/(Cn + Cp) (2)\nV\u02d9Cb = (IinRd \u2212 VCb) \/CbRd\nV\u02d9Cs = (IinRt \u2212 VCs) \/CsRt\nVo =VCs + VCb + IinRi (3)\nV\u02d9Cp =\nVCn\nRnCp\n\u2212 VCp(Rn +Rp)\nCpRnRp\n+\nIin\nCp\nV\u02d9Cn = \u2212\nVCn\nRnCn\n+\nVCp\nCnRn\n, Vo = VCp + IinRi. (4)\nThe validity of the mapping and advantages of the technique\nwill be demonstrated in the next section using subspace param-\neter estimation, initially on a system of known parameters for\nmodel comparison, and finally on experimental data captured\nfrom tests on a battery.\nIII. SUBSPACE PARAMETER ESTIMATION\nA. Theory\nThe input\u2013output and state relationships of a discrete-time\nsystem modeled using Ad, Bd, Cd, and Dd and white noise\ninputsw(t) and v(t) (5) can be transformed using any invertible\nmatrix T (6). It can be shown (Ljung 10.80\u201310.129 [12]) that\nparameters of the system matrices Ad, Bd, Cd, and Dd and\ninitial conditions x\u02dc(0) can be estimated by applying subspace\nparameter-estimation techniques if sufficient (and appropriate)\ndata are available.\nFor brevity, the process of solving the subspace algo-\nrithms and choosing the correct weighting factors for a least-\nsquares solution is omitted here; see the extensive treatment\ngiven by Ljung [12] for details. In essence, the subspace\nGOULD et al.: PARAMETER ESTIMATION AND STATE-OBSERVER TECHNIQUES 3907\nparameter-estimation algorithm allows static battery model pa-\nrameters to be estimated for a \u201cwindow\u201d of input\u2013output data\n(Iin and Vo). By using a \u201crolling\u201d window as data are captured,\nan approximation of the dynamic battery model parameters\ncan be obtained that accommodates transient electrochemical\nand thermal effects. In practice, this is achieved by storing the\ncollected input\u2013output data in a first-in\u2013first-out (FIFO) buffer\nof suitable size and is updated at each sample step. Parameter\nestimation is then performed on the contents of the buffer at a\nlower rate than that of data sampling to decrease computational\ncomplexity. Due to the large time constants involved with typ-\nical combinations of Cb and Rd (or Cn and Rp), it is not prac-\ntical to acquire sufficient buffered data for accurate estimation\nof the exact values of these large components without neglect-\ning other more transient parameter variations (i.e., occasional\ncharging periods), and thus, a structured subspace estimation\nmodel is used in which the time constant associated with the\nproduct CbRd (or CnRn) is assumed to be large (compared\nwith the time constant associated with CsRt or CpRn) and,\ntherefore, subject to a negligible change over a small buffer\nof data (100 s in this case). Likewise, Rd is assumed to be\nsufficiently large (5 k\u2126) so that a negligible current is drawn by\nthe discharge resistance, thereby also leading to the assumption\nthat (Rn +Rp)\/Rp \u2192 1 in (4).\nThis results in the modified state-space models for the\nRandles\u2019 and remapped circuits shown in (7) and (8), respec-\ntively. The aforementioned equations are given as follows:\nx(t+ 1) =Adx(t) +Bdu(t) + w(t)\ny(t) =Cdx(t) +Ddu(t) + v(t) (5)\nx\u02dc(t+ 1) =T\u22121AdT x\u02dc(t) + T\u22121Bdu(t) + w\u02dc(t)\ny(t) =CdT x\u02dc(t) +Ddu(t) + v(t) (6)\nV\u02d9Cb =\nIin\nCb\n, V\u02d9Cs = \u2212\nVCs\nCsRt\n+\nIin\nCs\nVo =VCs + VCb + IinRi (7)\nV\u02d9Cn = \u2212\nVCn\nRnCn\n+\nVCp\nCnRn\nV\u02d9Cp =\nVCn\nRnCp\n\u2212 VCp\nCpRn\n+\nIin\nCp\nVo =VCp + IinRi. (8)\nB. Comparison of Simulated Subspace Estimation Using\nRandles\u2019 and Mapped Circuit Models\nTo investigate the performance of subspace parameter esti-\nmation for each model, equivalent static parameters are initially\nassigned to each model [using (1)] so that a current demand\n(see Fig. 5) consisting of a series of the cycles shown in Fig. 2\ncan be applied to each battery model. Due to the one-to-one\nmapping, the battery terminal voltages of each model will be\nthe same. The current demand and resulting terminal voltages\nare then applied to the subspace parameter-estimation scheme\nto estimate the parameters of each model.\nFig. 5. Typical ULTRA current demand to fully discharge a single 48-Ah\nVRLA battery.\nTABLE I\nINITIAL MODEL PARAMETERS\nFollowing the determination of initial model parameters (see\nTable I), the identification algorithms are subsequently applied\nusing the data shown in Fig. 5, which gives a typical ULTRA\ncurrent demand profile applied to a single 12-V\u223c 48-Ah VRLA\nbattery at 100% SoC (approximately 13.2 V open-circuit (cct)\nterminal voltage), to take it to almost full discharge at an\naverage rate of C\/5.\nParameter estimates from the data and the resulting terminal\nvoltage from the models are obtained by sampling the data at\n1 Hz and storing it in a two-channel 100-s FIFO buffer. To\nreduce computational complexity, the contents of the buffer\nundergo parameter estimation every 10 s. Consequently, each\ntime the parameter estimation algorithm is performed, the static\nparameters obtained from 100 s of data are applied to the\nbattery model for a period of 10 s prior to the next parameter-\nestimation cycle. This allows the model parameters associated\nwith larger time constants of the systems to be assumed static\nover each successive 100-s period of data, since the capacitance\nassociated with the main charge store will negligibly vary over\nthis period.\nSince it is difficult to predict the variation in model param-\neters over time, fixed initial parameters are used for each buffer\n(see Table II), whereas the initial conditions of the states (i.e.,\nthe voltages associated with each capacitor) can be estimated\nby integrating the current flowing into the main charge store\nand calculating the voltage across the (provisionally estimated)\ncapacitance. Initial states\/conditions used for the first buffer are\ntaken from steady-state open-cct terminal voltage readings.\n3908 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 58, NO. 8, OCTOBER 2009\nTABLE II\nFIXED INITIAL PARAMETERS\nFig. 6. Mapped model subspace parameter estimate of \u223c80 m\u2126 Ri.\nFig. 7. Mapped model subspace parameter estimate of \u223c5000 F Cs.\nFigs. 6\u20138 show the resulting estimates of the static pa-\nrameters when using the remapped equivalent circuit model\nand (1) to postprocess the results for comparison with the\nparameters from Fig. 3 (i.e., the Randles\u2019 static parameters from\nTable I). Application of the parameter-estimation technique to\nboth models can be seen to correctly identify the average static\nparameters for each buffer of data, given the initial conditions\nrecorded in Table II.\nFor a direct comparison between the two modeling ap-\nproaches and the predefined static parameters, Table III demon-\nstrates the relative accuracy of each model, including the\nFig. 8. Mapped model subspace parameter estimate of \u223c30 m\u2126 Rt.\nstandard deviation of the percentage error in each parameter\nfrom the two models. Initially, it seems that the two models\nare equally as accurate, particularly for estimating the terminal\nresistance Ri. However, advantages can be seen when using\nthe mapped circuit model for the estimation of the components\nassociated with the electrochemical transient effects within\nthe battery, due to the mapped model having two states in\nparallel as opposed to the series circuit combination of states\nseen in the Randles\u2019 model. This will further be highlighted\nwhen the parameter-estimation techniques are combined with\npredictor\/corrector algorithms to monitor the models\u2019 circuit\nvoltages associated with SoF.\nThe subspace parameter estimation algorithm is now ap-\nplied to experimental data collected from application of the\ncurrent demand of Fig. 5 (via a personal computer-based\nLabVIEW hardware development platform) to a fully charged\nwell-conditioned 12-V 48-Ah (nominal) Monobloc battery,\nresulting in the measured terminal voltage waveform shown in\nFig. 9. The battery under test is housed in an environmentally\ncontrolled test chamber (see Fig. 10), whereas the terminal volt-\nage, current demand, and terminal temperature are monitored\nby a dSPACE system, which implements the online estimator\nalgorithms.\nIn parallel with the estimator algorithms, dSPACE also cal-\nculates the cell-discharge characteristic to calculate the ampere-\nhours being drawn from the battery (see Fig. 11). Typically, this\ncharacteristic is normalized to the nominal total capacity of the\nbattery to monitor SoC. However, it will be shown that this type\nof \u201cCoulomb-counting\u201d method proves inaccurate as the total\ncapacity of the battery varies with SoH.\nExamination of the experimental waveform in Fig. 9 clearly\ndemonstrates the variation in battery parameters that must be\noccurring due to SoF of the battery. Of particular interest are\nportions of the waveform showing excessive transient activity\nnear to full-charge and deep-discharge areas of operation. In-\ntuitively, these periods mark situations where either an almost\nfully charged battery is subject to charging periods in excess of\nits maximum capacity, thereby provoking \u201cgassing\u201d reactions\nwithin the battery or, alternatively, an almost discharged battery\nbeing forced to source transient power that it no longer has the\nGOULD et al.: PARAMETER ESTIMATION AND STATE-OBSERVER TECHNIQUES 3909\nTABLE III\nACCURACY OF THE RANDLES\u2019 AND THE PROPOSED MODEL RELATIVE TO THE FIXED INITIAL PARAMETERS OF TABLE III\nFig. 9. Experimental terminal voltage waveform from 12-V 48-Ah (nominal)\nbattery subjected to the current demand of Fig. 5.\nFig. 10. Environmentally controlled test chamber.\ncapacity to provide. Both situations should be avoided to ensure\ngood SoF and extended lifetime of a battery.\nUsually, the battery is only operated between 80% and 40%\nSoC (i.e., Time = 2000 s\u2212 Time = 12 000 s in Fig. 9) to\nameliorate problems associated with these situations. However,\nfrom an efficiency perspective, it would be desirable to identify\nthe widest operating region for each battery, and this can\nbe achieved by monitoring the variation in parameters that\nFig. 11. Resulting cell discharge characteristic.\nTABLE IV\nSUBSPACE PARAMETER INITIAL CONDITIONS\nresult from application of the proposed parameter-estimation\ntechnique.\nC. Experimental Results for Subspace Parameter Estimation\nUsing Randles\u2019 and Remapped Models\nApplication of the parameter estimation algorithm (with\ninitial conditions given in Table IV) to the input\u2013output data\nshown in Figs. 5 and 9 provides the estimates of battery param-\neters shown in Figs. 12\u201314.\nFrom the results, areas of operation that may degrade battery\nperformance (such as overcharge\/excessive discharge situa-\ntions) can readily be identified.\nTo determine variations in SoC and SoH, it is necessary to\nestimate the voltage across the main charge store Cb. Although\nthe use of dynamic parameter estimates allows more accurate\n\u201copen-loop\u201d estimation of this voltage than with the use of\nstatic parameters, it is evident from Figs. 12\u201314 that some\nof the parameter combinations or initial state conditions can\n3910 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 58, NO. 8, OCTOBER 2009\nFig. 12. Online battery parameter Ri (a) from the Randles\u2019 model and (b) from the mapped circuit model.\nFig. 13. Online battery parameter (a) Cs from the Randles\u2019 model and (b) Cp from the mapped circuit model.\nFig. 14. Online battery parameter (a) Rt from the Randles\u2019 model and (b) Rn from the mapped circuit model.\nGOULD et al.: PARAMETER ESTIMATION AND STATE-OBSERVER TECHNIQUES 3911\nproduce unuseful results, which could introduce SoC \u201cdrift\u201d\nsimilar to that incurred by traditional current integration or\nCoulomb-counting techniques. To correctly identify and con-\nverge onto the correct circuit voltages, therefore, it is proposed\nto use a state-space observer technique [7], [11], where \u201cbest\ndecisions\u201d are recursively made to account for previous- and\ncurrent-model parameters, associated errors, input\u2013output data,\nand system noise. Candidate observers often make use of\npredictor\/corrector-type mechanisms, whereby an initial solu-\ntion to the problem is calculated using some or no previous\ninformation and then recursively corrected over time using\nweighted gain terms applied to different states until a \u201cbest\nsolution\u201d is reached.\nTwo examples of such observer\/estimator techniques are now\ninvestigated for their suitability for this application.\nIV. SLIDING-MODE OBSERVER THEORY\nA. Underlying Theory\nAn uncertain dynamical system description (9) may be \u201cob-\nserved\u201d using a discontinuous observer of the form of (10)\nproposed by Utkin in 1981, where x\u02c61 and y\u02c6 are estimates of x1\nand y, whereas L \u2208 & and M \u2208 +& are feedback gains. This\nresults in the discontinuous observer form given in (11) for the\nRandles\u2019 model and in (12) for the remapped circuit model.\nStarting from a known initial condition (usually determined\nfrom the open-cct terminal voltage), at each sampling instant,\n(11) and (12) are applied to each model using parameters that\nare updated every 10 s (supplied from the subspace parameter\nestimation scheme). The aforementioned equations are given as\nfollows:\nx\u02d9(t) =Ax(t) +Bu(t) + f(x, u, t), y(t) = Cx(t) (9)\n\u02d9\u02c6x1 =A11x\u02c61 +A12y\u02c6 +B1u+ Lv1\n\u02d9\u02c6y =A21x\u02c61 +A22y\u02c6 +B2u\u2212 v2\nvi =M sgn(y\u02c6 \u2212 y) (10)\uf8ee\uf8f0 V\u02d9CbV\u02d9Cs\nV\u02d9eq\n\uf8f9\uf8fb =\n\uf8ee\uf8f0\u22121\/CbRd 0 00 \u22121\/CsRt 0\n\u22121\/CbRd \u22121\/CsRt 0\n\uf8f9\uf8fb\uf8ee\uf8f0VCbVCs\nVeq\n\uf8f9\uf8fb\n+\n\uf8ee\uf8f0 1\/Cb1\/Cs\n(Cb + Cs)\/CbCs\n\uf8f9\uf8fb Iin\n+\n\uf8ee\uf8f0L1M sgn(y\u02c6 \u2212 Veq \u2212 IinRi)L2M sgn(y\u02c6 \u2212 Veq \u2212 IinRi)\n\u2212M1 sgn(y\u02c6 \u2212 Veq \u2212 IinRi)\n\uf8f9\uf8fb\nVo =Veq + IinRi (11)[\nV\u02d9Cn\nV\u02d9Cp\n]\n=\n[\u22121\/RnCn 1\/RnCn\n1\/RnCp \u2212(Rn +Rp)\/RnCpRp\n] [\nVCn\nVCp\n]\n+\n[\n0\n1\/Cp\n]\nIin +\n[\nL3M sgn\n(\ny\u02c6 \u2212 VCp \u2212 IinRi\n)\n\u2212M2 sgn\n(\ny\u02c6 \u2212 VCp \u2212 IinRi\n) ]\nVo =VCp + IinRi. (12)\nB. Results for Utkin Observer Estimation of SoC for Both\nRandles\u2019 and Remapped Models\nBoth the parameter estimation and observer schemes are ini-\ntialized with L1 = \u22121, L2 = \u22120.002, L3 = \u22121, M1 = 0.02,\nM2 = 0.02, Ri = 6 m\u2126, Rt = 10 m\u2126, Rd = 5 k\u2126, Cs =\n2000 F, Cb = 100 000 F, VCs(0) = 0 V, Rn = 10 m\u2126, Rp =\n5 k\u2126, Cp = 2000 F, Cn = 100 000 F, and arbitrary initial\nvoltages VCb(0) = 11 V, VCn(0) = 11 V, and VCp(0) = 11 V.\nThe observer algorithms detailed in (11) and (12) are then used\nby the dSPACE system to monitor the effect that the current de-\nmand of Fig. 5 has on a fully charged well-conditioned battery.\nAgain, after 100 s, and at regular subsequent intervals (10 s in\nthis case), the parameter estimation algorithm is used to supply\nnew battery model parameters.\nThe resulting observer estimates of VCn are postprocessed\nusing (2) to provide a direct comparison to VCb (indicating\nthe variation of SoC), which is then filtered with a low-pass\nfilter (cutoff frequency \u03c9c = 0.00628 rad\u22121). The results of\nthis process are shown in Fig. 15 and clearly demonstrate the\nability of the observer to correct for erroneous initial conditions.\nSpecifically, Fig. 15(a) and (b) shows SoC voltages commen-\nsurate with those expected from a fully charged battery (i.e.,\n\u223c13.3 V terminal voltage) discharging at an almost constant\nrate until deep discharge is encountered, and the battery health\ndeclines more rapidly.\nFor comparison, the cell-discharge characteristic of Fig. 11\nis used to provide an estimate of the SoC voltage using more\ntraditional current integration methods, where it can be seen\nthat initial voltage conversion of the mapped model shows im-\nprovements over that of Randles\u2019 model, and greater Randles\u2019\nmodel instability can only be seen [also evident in the estimated\nparameters of Figs. 12(a) and 14(a)] as the battery enters the\ndeep-discharge zone. However, this may be attributed to the\nsimple sliding-mode correction action of the Utkin observer.\nIn the next section, the more complicated KE is investigated,\nwhose correction mechanism is itself adaptive in nature, allow-\ning the discrepancies between modeling techniques to be more\nreadily identified.\nV. KALMAN ESTIMATOR THEORY\nA. Underlying Theory\nThe KE [11] is considered particularly useful for this appli-\ncation since it optimally estimates states affected by broadband\nnoise within the system bandwidth. More generally, the use of\nrecursive predictor\/corrector type algorithms is also of benefit\nhere, since it allows for updated parameter estimates to be\nreadily inserted to \u201cassist\u201d the KE to converge to the correct\nvoltage.\nThe realization of the KE follows the treatment given in\n[7], whereby a discrete-time equivalent model (as used in the\nsubspace parameter estimation) of a system\u2019s state-variable\ndescription (13) is generated using a first-order Taylor series\nexpansion, resulting in (14). Thus\nx\u02d9(t) =Ax(t) +Bu(t), y(t) = Cx(t) (13)\nxk+1 =Adxk +Bduk, yk+1 = Cdxk+1 (14)\n3912 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 58, NO. 8, OCTOBER 2009\nFig. 15. Estimated VCb showing convergence of the Utkin observer to the correct initial condition for (a) Randles\u2019 and (b) mapped models.\nwhere\nAd \u2248 I +ATc Bd \u2248 BTc Cd \u2248 C (15)\nusing the sampling period Tc.\nThis system is assumed to be corrupted by stationary\nGaussian white noise consisting of a system disturbance addi-\ntive vector \u03c3k and a model disturbance additive vector \u00b5k, both\nof which are considered to have a zero mean value for all k and\nhave the following respective covariance matrices:\nE\n[\n\u03c3k\u03c3\nT\nk\n]\n= Q E\n[\n\u00b5k\u00b5\nT\nk\n]\n= R (for all k) (16)\nwhere E is the expectation operator. This allows the physical\nsystem to be modeled by\nxk+1 = Adxk +Bduk + \u0393\u03c3k, zk+1 = Cdxk+1 + \u00b5k+1\n(17)\nwhere z is used to describe the measured outputs (e.g., Vo in-\ncorporating the Gaussian noise), and \u0393 represents the coupling\nbetween the model disturbances on each state.\nThe KE is implemented using the state-space equations of (3)\nand (4), the prediction\/correction algorithms detailed in Fig. 16,\nand initial conditions and the covariance matrices of (18). The\nsample time is chosen to be Tc = 1 s. Thus\nP0 =\n[\n10 0\n0 10\n]\n, Q =\n[\n0.01 0\n0 0.1\n]\nR =10, x0\/0 =\n[\n13.3\n13.3\n]\n. (18)\nB. Results for KE SoC Estimation Using Randles\u2019 and\nRemapped Models\nResults from the KE are initially preprocessed to remove the\neffects of the voltage dropped acrossRi (known from parameter\nestimation), allowing one of the states for the mapped circuit\nmodel (VCp) to be immediately calculated, giving greater pre-\ndiction accuracy over the Randles\u2019 model.\nFig. 16. Recursive implementation of the KE.\nThe KE is initialized with Ri = 6 m\u2126, Rt = 10 m\u2126, Rd =\n5 k\u2126, Cs = 2000 F, Cb = 100 000 F, VCs(0) = 0 V, Rn =\n10 m\u2126, Rp = 5 k\u2126, Cp = 2000 F, Cn = 100 000 F, and ar-\nbitrary initial voltages VCb(0) = 11 V, VCn(0) = 11 V, and\nGOULD et al.: PARAMETER ESTIMATION AND STATE-OBSERVER TECHNIQUES 3913\nFig. 17. Estimated VCb showing convergence of the KE to the correct initial condition using (a) Randles\u2019 and (b) mapped models.\nVCp(0) = 11 V and again used to monitor the effect that the\ncurrent demand (see Fig. 5) has on a fully charged well-\nconditioned battery with the parameters being updated online\nevery 10 s.\nThe KE results for VCn and VCp are again converted using (2)\nto be compared with VCb after being passed through the same\nlow-pass filter (\u03c9c = 0.00628 rad\u22121) as before. The results are\nshown in Fig. 17, where it can again be seen that the KE output\nconverges to the correct SoC voltages (in this case compared\nwith a current integration technique, which required a priori\nknowledge of Cb and VCb(0)).\nIt has therefore been shown that both models exhibit ex-\ncellent initial convergence; yet, it is evident that the Randles\u2019\nmodel shows incorrect convergence due to erroneous parameter\nestimation for operation at low SoC (i.e., after 12 000 s). Con-\nversely, the advantageous feature of the remapped equivalent\ncircuits readily identifiable parallel state (VCb(0)) has allowed\nimproved parameter estimation accuracy and, consequently,\nbetter voltage-convergence performance.\nVI. STATE-OF-HEALTH MONITORING\nTo monitor the SoH of the battery, it will be shown that Cb\nmay be estimated by applying a linear curve fit to buffered\nestimates of VCb and considering the integrated current through\nCb over the buffer periods (typically 1800 s to provide stable\nresults). Due to the convergence benefits and parameter stability\nafforded by the mapped circuit model (explored in Section V),\nit can be used to estimate the variation of Cb (see Fig. 18)\nin the data presented in Fig. 17(b)\u2014note that the data are\nfiltered with a low-pass filter (designed with a cutoff frequency\n\u03c9c = 0.0044 rad\u22121).\nIt can be seen from Fig. 18 that, after the initial convergence\nof the parameter estimation and KE algorithms, the value of\nCb settles to an almost constant average value over the period\n3000\u201310 000 s (i.e., the typical region of operation between\n\u223c80% and\u223c30% SoC), facilitating the real-time monitoring of\nthe SoH indicator. A relationship between the indicator and the\nFig. 18. Variation of Cb from gradient of observed VCb of Fig. 17(b).\navailable capacity can be obtained by making linear approxi-\nmations over typical operating regions during accelerated aging\ntests, whereby the battery is charged with a constant 10 A and\nthen discharged by the current profile shown in Fig. 5.\nThe resulting degradation of the SoH indicator (Cb) can then\nbe seen over time [for instance, see Fig. 19(a)], and a linear\nrelationship is applied. Similarly, as each test is conducted, the\ntotal current demand can be integrated, allowing an estimate\nof the total available capacity of the battery during each test.\nThe reduction in the available capacity of the battery under test\nis shown in Fig. 19(b). These relationships are approximately\nmodeled by the following linear expressions, where N is the\ntest number:\nCb = \u2212248N + 93 000\nAh = \u22120.0625N + 48.8. (19)\nBy manipulating (19), (20) relates the total available capacity\nof a battery under test to the estimated average value of Cb\n3914 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 58, NO. 8, OCTOBER 2009\nFig. 19. (a) Decline in estimated Cb and (b) reduction of available capacity with \u201cage\u201d of the battery and (c) relationship between Cb and available capacity.\nFig. 20. (a) Estimated VCb , (b) variation of Cb, (c) variation in parameter Ri, and (d) battery terminal temperature for an \u201caged\u201d battery with reduced capacity.\n[see Fig. 19(c)] so that not only the relative SoH can be\nestimated but the total capacity of the battery at that particular\ntime as well, i.e.,\nAh = 0.00025Cb + 25.4. (20)\nThis, in turn, allows more accurate current-integration SoC\ntechniques to be employed (now that the necessary a priori\nknowledge can be estimated) and corrected using the conver-\ngence features of the KE algorithms to ensure that correct VCb\nand SoC estimates are obtained.\nGOULD et al.: PARAMETER ESTIMATION AND STATE-OBSERVER TECHNIQUES 3915\nAgain, by way of example, for the case of a battery with\nSoC and SoH shown in Figs. 17(b) and 18, respectively, the\nestimated Cb of 88 500 F from Fig. 18 maps to an available\ncapacity of 47.5 Ah, as compared with that of 47.4 Ah achieved\nby integrating the total current demand. The battery is therefore\nshown to be in good health.\nIn a similar manner to that used to generate the results of\nFig. 17, Fig. 20 now shows the estimated variation of VCb and\nCb for the same battery after months of continuous repetitive\ncycling. A linear approximation to the variation in Cb indicates\nthat the capacitance of the main charge store has degraded from\n88 500 F (see Fig. 18) to 80 200 F [see Fig. 20(b)]. Conse-\nquently, the available capacity can be determined from (20) to\nhave decreased from 47.5 to 45.4 Ah, whereas integration of the\ncurrent demand over the length of this particular cycle results\nin a net removal of 45.8 Ah of charge.\nThis therefore shows that the SoH of this battery is deterio-\nrating with use (since a decrease in the value of Cb indicates a\ndiminished plate\/grid surface area [9] or a loss of electrolyte),\nand careful monitoring of any rapid change in the estimated\nparameter values [see Fig. 20(c)] is advisable to preempt a\nrapid increase in battery temperature [see Fig. 20(d)], which\ncould indicate thermal runaway (leading to excessive hydrogen\nproduction), short-circuits or plate\/anodic deterioration (hence\nincreased internal resistance Ri), and, ultimately, catastrophic\nfailure of the battery.\nVII. CONCLUSION\nA novel battery-modeling methodology for an all-electric\nPRT vehicle has been proposed for the purpose of battery\nSoH\/SoC estimation. The methodology consists of the use of a\nnovel battery circuit model, a predictor\/corrector observer, and\nonline subspace parameter estimation, allowing the observer to\nadaptively estimate and converge on voltages associated with\nbattery functionality indicators. The adaptive nature of the algo-\nrithms allows the effects of ambient temperature variations and\nbattery self-discharge issues to be inherently accommodated.\nMoreover, the resulting parameter estimates are used to identify\nfault conditions and areas of unsafe operation. Experimental\nresults show improved voltage predictions compared with al-\ngorithms based on the traditional Randles\u2019 model and facilitate\ndecisions based on SoC and SoH to be made. A relationship\nbetween a battery\u2019s available capacity and the estimated capaci-\ntance of the main charge store has also been found and shows\nexcellent agreement with experimental results.\nACKNOWLEDGMENT\nThe authors would like to thank Advanced Transport Sys-\ntems Ltd. for their cooperation, particularly N. Zurlinden,\nfor providing the ULTRA driving cycle data and press\nshots.\nREFERENCES\n[1] [Online]. Avalable: http:\/\/www.atsltd.co.uk\n[2] A. Jossen, \u201cFundamentals of battery dynamics,\u201d J. Power Sources,\nvol. 154, no. 2, pp. 530\u2013538, Mar. 2006.\n[3] A. Kawamura and T. Yanagihara, \u201cState of charge estimation of sealed\nlead\u2013acid batteries used for electric vehicles,\u201d in Proc. 29th Annu. IEEE\nPower Electron. Spec. Conf., May 1998, vol. 1, pp. 583\u2013587.\n[4] P. Sinclair, R. Duke, and S. Round, \u201cAn adaptive battery monitoring\nsystem for an electric vehicle,\u201d in Proc. Int. Conf. Power Electron. Drives\nEnergy Syst. Ind. Growth, Dec. 1998, vol. 2, pp. 786\u2013791.\n[5] P.-S. Kim, \u201cNew estimation filtering for battery management systems of\nlead\u2013acid cells in hybrid electric vehicles,\u201d Int. J. Comput. Sci. Netw.\nSecurity, vol. 7, no. 2, pp. 136\u2013141, Feb. 2007.\n[6] C. S. C. Bose and F. C. Laman, \u201cBattery state of health estimation through\ncoup de fouet,\u201d in Proc. 22nd INTELEC, 2000, pp. 597\u2013601.\n[7] B. S. Bhangu, P. Bentley, D. A. Stone, and C. M. Bingham, \u201cOb-\nserver techniques for estimating the state-of-charge and state-of-health of\nVRLABs for hybrid-electric vehicles,\u201d in Proc. IEEE Conf. Veh. Power\nPropuls., Sep. 2005, pp. 780\u2013789.\n[8] D. Berndt, E. Meissner, and R. Rusch, \u201cAging effects in valve-\nregulated lead\u2013acid batteries,\u201d in Proc. 15th INTELEC, Sep. 1993, vol. 2,\npp. 139\u2013145.\n[9] P. Ruetschi, \u201cAging mechanisms and service life of lead\u2013acid batteries,\u201d\nJ. Power Sources, vol. 127, no. 1\/2, pp. 33\u201344, Mar. 2004.\n[10] K. J. Vetter, Elecktrochemische Kinetik. Berlin, Germany: Springer-\nVerlag, 1961, p. 268.\n[11] R. E. Kalman, \u201cA new approach to linear filtering and prediction prob-\nlems,\u201d Trans. ASME\u2014J. Basic Eng., Ser. D, vol. 82, no. 1, pp. 35\u201345,\n1982.\n[12] L. Ljung, System Identification\u2014Theory for the User, 2nd ed.\nEnglewood Cliffs, NJ: Prentice-Hall, 1999, pp. 317\u2013353.\nC. R. Gould received the M.Eng. degree in elec-\ntronic and electrical engineering with communica-\ntions and the Ph.D. degree from the University\nof Sheffield, Sheffield, U.K, in 2002 and 2006,\nrespectively.\nSince 2005, he has been a Research Associate\nwith the Electrical Machines and Drives Group, De-\npartment of Electronic and Electrical Engineering,\nUniversity of Sheffield. His current research interests\ninclude the modeling and control of resonant power\nsupplies, battery-management systems and battery\nstate-of-charge\/health modeling for all-electric steer-by wire vehicles, and the\ndesign of efficient brushless ac motor for sensorless control of electric mobility\nvehicles.\nC. M. Bingham (M\u201900) received the B.Eng. degree\nin electronic systems and control engineering from\nSheffield City Polytechnic, Sheffield, U.K., in 1989,\nthe M.Sc. (Eng.) degree in control systems engineer-\ning from the University of Sheffield in 1990, and the\nPh.D. degree from Cranfield University, Shrivenham,\nU.K., in 1994, for research on control systems to ac-\ncommodate nonlinear dynamic effects in aerospace\nflight-surface actuators.\nHe was a Postdoctoral Researcher with Cranfield\nUniversity until taking a research position with the\nUniversity of Sheffield. He was appointed Lecturer with the Department of\nElectronic and Electrical Engineering, University of Sheffield, in 1998 and\nSenior Lecturer in 2003. His current research interests include traction control\/\nantilock braking systems for electric vehicles, electromechanical actuation of\nflight control surfaces, control of active magnetic bearings for high-speed ma-\nchines, sensorless control of brushless machines, and the high-speed modeling,\nanalysis, and design of resonant power converters.\n3916 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 58, NO. 8, OCTOBER 2009\nD. A. Stone received the B.Eng. degree in elec-\ntronic engineering from the University of Sheffield,\nSheffield, U.K., in 1984 and the Ph.D. degree from\nLiverpool University, Liverpool, U.K., in 1989.\nHe is currently with the University of Sheffield as\na Member of Academic Staff, specializing in power\nelectronics and machine drive systems. His cur-\nrent research interests include hybrid-electric vehi-\ncles, battery charging, electromagnetic compatibility,\nand novel lamp ballast for low-pressure fluorescent\nlamps.\nP. Bentley received the B.Sc. degree in engineering\nphysics from Sheffield Hallam University, Sheffield,\nU.K., in 1998 and the Ph.D. degree for the dynamic\ncharacterization and modeling of battery technolo-\ngies for all\/more electric vehicles from the University\nof Sheffield in 2004.\nHe has been a Research Associate with the Elec-\ntrical Machines and Drives Group, Department of\nElectronic and Electrical Engineering, University of\nSheffield, since 2001. His research interests include\nenergy storage components for hybrid and electric\nvehicle drive trains and energy-scavenging devices.\n"}