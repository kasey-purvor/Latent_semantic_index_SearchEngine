{"doi":"10.1109\/07IAS.2007.356","coreId":"54699","oai":"oai:eprints.lincoln.ac.uk:2461","identifiers":["oai:eprints.lincoln.ac.uk:2461","10.1109\/07IAS.2007.356"],"title":"Improved rotor position estimation by signal injection in brushless AC motors, accounting for cross-coupling magnetic saturation","authors":["Li, Y","Zhu, Z Q","Howe, D","Bingham, Chris","Stone, D"],"enrichments":{"references":[{"id":1012935,"title":"A novel method for initial rotor position estimation for IPM synchronous machine drives,\u201d","authors":[],"date":"2004","doi":"10.1109\/tia.2004.834091","raw":"H. Kim, K.K. Huh, and R.D. Lorenz, \u201cA novel method for initial rotor position estimation for IPM synchronous machine drives,\u201d IEEE Trans. Industry Applications, vol. 40, no. 5, pp. 1369-1378, 2004.","cites":null},{"id":1011618,"title":"An extended electromotive force model for sensorless control of interior permanent2363 magnet synchronous motors,\u201d","authors":[],"date":"2003","doi":"10.1109\/tie.2003.809391","raw":null,"cites":null},{"id":18443247,"title":"An extended electromotive force model for sensorless control of interior permanent2363magnet synchronous motors,\u201d","authors":[],"date":"2003","doi":"10.1109\/tie.2003.809391","raw":"Z. Chen, M. Tomita, S. Koki, and S. Okuma, \u201cAn extended electromotive force model for sensorless control of interior permanent2363magnet synchronous motors,\u201d IEEE Trans. Industrial Electronics, vol.50, no.2, pp. 288-295, 2003.","cites":null},{"id":1014005,"title":"Calculation of d- and q- axis inductances of PM brushless ac machines accounting for skew,\u201d","authors":[],"date":"2005","doi":"10.1109\/TMAG.2005.854976","raw":"Y.S. Chen, Z.Q. Zhu, and D. Howe, \u201cCalculation of d- and q- axis inductances of PM brushless ac machines accounting for skew,\u201d IEEE Trans. Magnetics, vol. 41, no. 10, pp. 3940-3942, 2005.","cites":null},{"id":1014529,"title":"Compensation for rotor position estimation error due to cross-coupling magnetic saturation in signal injection based sensorless control","authors":[],"date":"2007","doi":"10.1109\/TMAG.2007.892319","raw":"Z.Q. Zhu, Y. Li, D. Howe, and C.M. Bingham, \u201cCompensation for rotor position estimation error due to cross-coupling magnetic saturation in signal injection based sensorless control of PM brushless AC motors,\u201d Proc. Int. Electric Machines and Drives Conference, 3-5 May 2007, Antalya, Turkey,  pp.208-213.","cites":null},{"id":1013401,"title":"Cross saturation effects in IPM motors and related impact on zero-speed sensorless control,\u201d","authors":[],"date":"2005","doi":"10.1109\/ias.2005.1518818","raw":"P. Guglielmi, M. Pastorelli, and A. Vagati, \u201cCross saturation effects in IPM motors and related impact on zero-speed sensorless control,\u201d Conf. Rec. IEEE-IAS Annu. Meeting, vol. 4, pp. 2546-2552, 2005.","cites":null},{"id":1013812,"title":"Envaluation of saturation and cross-magnetization effects in interior permanent-magnet synchronous motor,\u201d","authors":[],"date":"2003","doi":"10.1109\/TIA.2003.816538","raw":"B. Stumberger, G. Stumberger, D. Dolinar, A. Hamler, and M. Trlep, \u201cEnvaluation of saturation and cross-magnetization effects in interior permanent-magnet synchronous motor,\u201d IEEE Trans. Industry Applications, vol. 39, no. 5, 2003.","cites":null},{"id":1011925,"title":"Implementation and position control performance of a position-sensorless IPM motor drive system based on magnetic saliency,\u201d","authors":[],"date":"1998","doi":"10.1109\/28.703980","raw":"S. Ogasawara, and H. Akagi, \u201cImplementation and position control performance of a position-sensorless IPM motor drive system based on magnetic saliency,\u201d IEEE Trans. Industry Applications, vol.34, no. 4, pp. 806\u2013812, 1998.","cites":null},{"id":1013641,"title":"Influence of rotor geometry of an interior PM motor on sensorless control feasibility,\u201d","authors":[],"date":"2005","doi":"10.1109\/TIA.2006.887317","raw":"N. Bianchi, and S. Bolognani, \u201cInfluence of rotor geometry of an interior PM motor on sensorless control feasibility,\u201d Conf. Rec. IEEE-IAS Annu. Meeting, vol. 4, pp. 2553-2560, 2005","cites":null},{"id":1014261,"title":"Inverter-driven synchronous motors for constant power,\u201d","authors":[],"date":"1996","doi":"10.1109\/2943.541242","raw":"S. Morimoto, M. Sanada, and Y. Takeda, \u201cInverter-driven synchronous motors for constant power,\u201d IEEE Trans. Industry Applications, vol. 2, pp. 18-24, 1996.","cites":null},{"id":1012184,"title":"Rotor position and velocity estimation for a salient-pole permanent magnet synchronous machine at standstill and high speed,\u201d","authors":[],"date":"1998","doi":"10.1109\/28.703973","raw":"M. J. Corley, and R. D. Lorenz, \u201cRotor position and velocity estimation for a salient-pole permanent magnet synchronous machine at standstill and high speed,\u201d IEEE Trans. Industry Applications, vol.34, no. 4, pp. 784-789, 1998.","cites":null},{"id":1011386,"title":"Sensorless control strategy for salient-pole PMSM based on extended EMF in rotating reference frame,\u201d","authors":[],"date":"2002","doi":"10.1109\/tia.2002.800777","raw":"S. Morimoto, K. Kawamoto, M. Sanada, and Y. Takeda, \u201cSensorless control strategy for salient-pole PMSM based on extended EMF in rotating reference frame,\u201d IEEE Trans. Industry Applications, vol.38, no.4, pp. 1054\u20131061, 2002.","cites":null},{"id":1013158,"title":"Sensorless drive of surface-mounted permanent-magnet motor by high-frequency signal injection based on magnetic saliency,\u201d","authors":[],"date":"2003","doi":"10.1109\/tia.2003.813734","raw":"J.H. Jang, S.K. Sul, J.I. Ha, K. Ide, and M. Sawamura, \u201cSensorless drive of surface-mounted permanent-magnet motor by high-frequency signal injection based on magnetic saliency,\u201d IEEE Trans. Industry Applications, vol. 39, no. 4, pp. 1031\u20131039, 2003.","cites":null},{"id":1012657,"title":"Sensorless rotor position estimation of an interior permanent-magnet motor from initial states\u201d,","authors":[],"date":"2003","doi":"10.1109\/tia.2003.811781","raw":"J.I. Ha, K. Ide, T. Sawa, and S.K. Sul, \u201cSensorless rotor position estimation of an interior permanent-magnet motor from initial states\u201d, IEEE Trans. Industry Applications, vol. 39, no. 3, pp.761-767, 2003.","cites":null},{"id":1012391,"title":"Sensorless torque control of salient-pole synchronous motor at zero-speed operation,\u201d","authors":[],"date":"1999","doi":"10.1109\/63.737609","raw":"T. Aihara, A. Toba, T. Yanase, A. Mashimo, and K. Endo, \u201cSensorless torque control of salient-pole synchronous motor at zero-speed operation,\u201d IEEE Trans. Power Electronics, vol. 14, no. 1, pp.202-208, 1999.","cites":null},{"id":1011112,"title":"Sensorless velocity control of permanent-magnet synchronous motors,\u201d","authors":[],"date":"1998","doi":"10.1109\/87.668033","raw":"K. R. Shouse, and D. G. Taylor, \u201cSensorless velocity control of permanent-magnet synchronous motors,\u201d IEEE Trans. Control System Technology, vol. 6, no. 3, pp. 313-324, 1998.","cites":null},{"id":1014420,"title":"Speed control of interior permanent magnet synchronous motor drive for the flux weakening operation,\u201d","authors":[],"date":"1997","doi":"10.1109\/28.567075","raw":"J.M. Kim, and S.K. Sul, \u201cSpeed control of interior permanent magnet synchronous motor drive for the flux weakening operation,\u201d IEEE Trans. Industry Applications, vol. 33, pp. 43-48, 1997.","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2007-09","abstract":"The paper presents an improved signal injection- based sensorless control method for permanent magnet brushless AC (BLAC) motors, accounting for the influence of cross-coupling magnetic saturation between the d- and q-axes. The d- and q-axis incremental self-inductances, the incremental mutual-inductance between the (d-axis and q-axis, and the cross-coupling factor are determined by finite element analysis. A method is also proposed for measuring the cross-coupling factor which can be used directly in the sensorless control scheme. Both measurements and predictions show that a significant improvement in the accuracy of the rotor position estimation can be achieved under both dynamic and steady-state operation, compared with that which is obtained with the conventional signal injection method","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/54699.pdf","fullTextIdentifier":"http:\/\/eprints.lincoln.ac.uk\/2461\/1\/li_1.pdf","pdfHashValue":"75cf69f8ea08cfb19dff9e844ed02465dce9943b","publisher":"Institute of Electronic and Electrical Engineering","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lincoln.ac.uk:2461<\/identifier><datestamp>\n      2014-08-28T09:24:53Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D6A6163735F48:6A6163735F48363030<\/setSpec><setSpec>\n      74797065733D636F6E666572656E63655F6974656D<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/eprints.lincoln.ac.uk\/2461\/<\/dc:relation><dc:title>\n        Improved rotor position estimation by signal injection in brushless AC motors, accounting for cross-coupling magnetic saturation<\/dc:title><dc:creator>\n        Li, Y<\/dc:creator><dc:creator>\n        Zhu, Z Q<\/dc:creator><dc:creator>\n        Howe, D<\/dc:creator><dc:creator>\n        Bingham, Chris<\/dc:creator><dc:creator>\n        Stone, D<\/dc:creator><dc:subject>\n        H600 Electronic and Electrical Engineering<\/dc:subject><dc:description>\n        The paper presents an improved signal injection- based sensorless control method for permanent magnet brushless AC (BLAC) motors, accounting for the influence of cross-coupling magnetic saturation between the d- and q-axes. The d- and q-axis incremental self-inductances, the incremental mutual-inductance between the (d-axis and q-axis, and the cross-coupling factor are determined by finite element analysis. A method is also proposed for measuring the cross-coupling factor which can be used directly in the sensorless control scheme. Both measurements and predictions show that a significant improvement in the accuracy of the rotor position estimation can be achieved under both dynamic and steady-state operation, compared with that which is obtained with the conventional signal injection method.<\/dc:description><dc:publisher>\n        Institute of Electronic and Electrical Engineering<\/dc:publisher><dc:date>\n        2007-09<\/dc:date><dc:type>\n        Conference or Workshop contribution<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/eprints.lincoln.ac.uk\/2461\/1\/li_1.pdf<\/dc:identifier><dc:identifier>\n          Li, Y and Zhu, Z Q and Howe, D and Bingham, Chris and Stone, D  (2007) Improved rotor position estimation by signal injection in brushless AC motors, accounting for cross-coupling magnetic saturation.  In: Industry Applications Conference, 2007. 42nd IAS Annual Meeting., 23-27 Sept 2007, New Orleans, USA.  <\/dc:identifier><dc:relation>\n        http:\/\/dx.doi.org\/10.1109\/07IAS.2007.356<\/dc:relation><dc:relation>\n        10.1109\/07IAS.2007.356<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/eprints.lincoln.ac.uk\/2461\/","http:\/\/dx.doi.org\/10.1109\/07IAS.2007.356","10.1109\/07IAS.2007.356"],"year":2007,"topics":["H600 Electronic and Electrical Engineering"],"subject":["Conference or Workshop contribution","PeerReviewed"],"fullText":"Improved Rotor Position Estimation by Signal \nInjection in Brushless AC Motors, Accounting for \nCross-Coupling Magnetic Saturation  \nY. Li, Z. Q. Zhu, D. Howe, C. M. Bingham, and D. Stone \nDepartment of Electronic and Electrical Engineering, University of Sheffield, Mappin Street, Sheffield S1 3JD, UK \nAbstract\u2014 The paper presents an improved signal injection- \nbased sensorless control method for permanent magnet \nbrushless AC (BLAC) motors, accounting for the influence \nof cross-coupling magnetic saturation between the d- and q-\naxes. The d- and q-axis incremental self-inductances, the \nincremental mutual-inductance between the d-axis and q-\naxis, and the cross-coupling factor are determined by finite \nelement analysis. A method is also proposed for measuring \nthe cross-coupling factor which can be used directly in the \nsensorless control scheme. Both measurements and \npredictions show that a significant improvement in the \naccuracy of the rotor position estimation can be achieved \nunder both dynamic and steady-state operation, compared \nwith that which is obtained with the conventional signal \ninjection method. \nKeywords- brushless AC motor, cross-coupling effect, \nsensorless, signal injection. \nI. INTRODUCTION\nAccurate rotor position information is an essential \nrequirement for permanent magnet (PM) brushless AC \n(BLAC) drives. Thus, either an encoder or a resolver is \nusually employed. However, this increases the cost and \ncomplexity, and may compromise the reliability. Hence, \nthere has been a significant development effort on \nsensorless techniques, which estimate the rotor position \nindirectly from the phase voltages and currents.  \nVarious back-emf-based rotor position estimation \nmethods have been developed for PM BLAC motors [1-\n3], which all estimate the rotor position from the \ngoverning voltage equation, their difference being in the \nway that the rotor position and speed estimation are \ndeduced. However, they require accurate stator winding \ninductances and resistances, may be problematic at low \nspeed and cannot be used for starting.    \nHence, the most popular sensorless control method for \nstarting and low speed operation is based on injecting a \nhigh frequency voltage signal into the phase windings and \nmeasuring the resultant high frequency current. Such a \nmethod was originally developed for induction motors, \nand was subsequently extended to PM BLAC motors with \nsaliency [4-6]. The identification of the initial rotor \npolarity, which was not reported in [4-6], was achieved in \n[7] [8] by comparing sine and cosine terms of the 2nd \nharmonic component in the d-axis current. In all the \nforegoing papers, the signal injection technique was \napplied to BLAC motors, which have geometric rotor \nsaliency. In [9], it was extended to a BLAC motor with a \nsurface-mounted PM rotor by utilizing the saliency which \nresulted from magnetic saturation.  \nHowever, it was found experimentally [5] that the \nerror in the estimated rotor position increased with the \nload current, although the problem was not specifically \naddressed. More recently, it was shown in [10] [11] that \nthe rotor position estimation error was caused by dq axis \ncross-coupling, i.e. Ldqh\u008f0, and was dependent on the \nmachine design, although no measures were taken to \nreduce the error. It is well-known that the mutual \ninductance between the d- and q-axes (Ldqh) of a BLAC \nmotor results from cross-coupling due to magnetic \nsaturation, as shown in [12] by both measurement and \nfinite element analysis. However, for simplicity, the \ninfluence of cross-coupling magnetic saturation is usually \nneglected in the electromagnetic modeling [13] [14], \nvector control [15] [16], and sensorless position control \n[5-9] of BLAC motors.  \nThis paper improves the accuracy of the rotor position \nestimation by accounting for the influence of cross-\ncoupling magnetic saturation in the signal injection based \nsensorless method. Section II presents the underlying \ntheory and analyzes the rotor position estimation error \nwhich results when the influence of cross-coupling is \nneglected. Section III proposes a simple way of \naccounting for the cross-coupling based on data which can \nbe obtained either by finite element analysis or from \nmeasurements. Finally, predicted and measured results are \ncompared in section IV to validate the proposed improved \nsignal injection sensorless control method.  \nII. ANALYSIS OF ROTOR POSITION ESTIMATION \nERROR CAUSED BY CROSS-COUPLING\nWhen cross-coupling between the d- and q-axes is \nconsidered, the voltage equations of a BLAC motor, in the \nrotor dq-axis reference frame, are given by [12]:  \n\u00bb\n\u00bc\n\u00ba\n\u00ab\n\u00ac\n\u00aa\n+\u00bb\n\u00bc\n\u00ba\n\u00ab\n\u00ac\n\u00aa\n\u00bb\n\u00bc\n\u00ba\n\u00ab\n\u00ac\n\u00aa\n++\n+\u2212+\n=\u00bb\n\u00bc\n\u00ba\n\u00ab\n\u00ac\n\u00aa\nmrq\nd\nqhsqdhdr\ndqhqrdhs\nq\nd\ni\ni\npLRpLL\npLLpLR\nv\nv\n\u03c8\u03c9\u03c9\n\u03c9 0\n      (1) \n0197-2618\/07\/$25.00 \u00a9 2007 IEEE 2357\nwhere Rs is the stator winding phase resistance and \u0225m is \nthe flux-linkage per phase due to the permanent magnets,\n\u0226r is the angular rotational speed, p=d\/dt. vd, vq and id, iq\nare the d- and q-axis voltages and currents, Ld and Lq are \nthe apparent d-q axis self-inductances, respectively, and \nLdh, Lqh, Ldqh and Lqdh are the d- and q-axis incremental \nself- and mutual-inductances, defined by:  \n\u00b0\n\u00b0\n\u00af\n\u00b0\n\u00b0\n\u00ae\n\u00ad\n\u0394\u03a6\u2212\u03a6\u0394+=\n\u0394\u03a6\u2212\u03a6\u0394+=\n\u0394\u03a6\u2212\u03a6\u0394+=\n\u0394\u03a6\u2212\u03a6\u0394+=\ndmqdqmqddqqdh\nqmqddmqqdddqh\nqmqdqmqqdqqh\ndmqddmqddddh\niiiiiiL\niiiiiiL\niiiiiiL\niiiiiiL\n\/)],,(),,([\n\/)],,(),,([\n\/)],,(),,([\n\/)],,(),,([\n\u03c8\u03c8\n\u03c8\u03c8\n\u03c8\u03c8\n\u03c8\u03c8\n    (2) \nwhere \u012dm is the permanent magnet flux.  \nDue to magnetic saturation, Ldh, Lqh, Ldqh and Lqdh vary \nwith both id and iq. By way of example, Fig. 1 shows the \nfinite element calculated incremental winding inductances \nfor the interior-magnet brushless AC motor whose \nparameters are given in Table I. As can be seen, Ldh and \nLqh reduce as id and iq are increased.  \nTABLE I. PARAMETERS OF BLAC MOTOR \nRated voltage (peak) 158V \nRated current (peak) 4.0A \nRated power 0.6kW \nRated speed  1000rpm \nRated torque 4.0Nm \nPole number  6 \nStator resistance (Rs) 6.0\u03a9\n\u0013\n\u0014\u0013\n\u0015\u0013\n\u0016\u0013\n\u0017\u0013\n\u0018\u0013\n\u0019\u0013\n\u0010\u0017 \u0010\u0016 \u0010\u0015 \u0010\u0014 \u0013 \u0014 \u0015 \u0016 \u0017\nq -axis current (A)\nIn\ncr\ne\nm\ne\nnt\nal\n \nin\ndu\nct\nan\nce\n \n(m\nH)\n,G \u0016$\n,G \u0015$\n,G \u0014$\n,G \u0013$\n,G \u0010\u0014$\n,G \u0010\u0015$\n,G \u0010\u0016$\n(a) d-axis incremental self-inductance, Ldh\n\u0013\n\u0014\u0013\n\u0015\u0013\n\u0016\u0013\n\u0017\u0013\n\u0018\u0013\n\u0019\u0013\n\u0010\u0017 \u0010\u0016 \u0010\u0015 \u0010\u0014 \u0013 \u0014 \u0015 \u0016 \u0017\nq -axis current (A)\nIn\ncr\ne\nm\ne\nnt\nal\n \nin\ndu\nct\nan\nce\n \n(m\nH)\n,G \u0016$\n,G \u0015$\n,G \u0014$\n,G \u0013$\n,G \u0010\u0014$\n,G \u0010\u0015$\n,G \u0010\u0016$\n(b) q-axis incremental self-inductance, Lqh\n\u0010\u0014\u0018\n\u0010\u0014\u0013\n\u0010\u0018\n\u0013\n\u0018\n\u0014\u0013\n\u0014\u0018\n\u0010\u0017 \u0010\u0016 \u0010\u0015 \u0010\u0014 \u0013 \u0014 \u0015 \u0016 \u0017\nq -axis current (A)\nIn\ncr\ne\nm\ne\nnt\nal\n \nin\ndu\nct\nan\nce\n \n(m\nH)\n,G \u0016$\n,G \u0015$\n,G \u0014$\n,G \u0013$\n,G \u0010\u0014$\n,G \u0010\u0015$\n,G \u0010\u0016$\n(c) dq-axis incremental mutual-inductances, Ldqh and Lqdh\nFig. 1.  Finite element predicted incremental self- and mutual-\ninductances. \nWhen only the high frequency signal injection \ncomponents are considered, (1) can be approximated by:  \n\u00bb\n\u00bc\n\u00ba\n\u00ab\n\u00ac\n\u00aa\n\u00bb\n\u00bc\n\u00ba\n\u00ab\n\u00ac\n\u00aa\n=\u00bb\n\u00bc\n\u00ba\n\u00ab\n\u00ac\n\u00aa\nqh\ndh\nqhdqh\ndqhdh\nqh\ndh\ni\ni\np\nLL\nLL\nv\nv\n                                        (3) \n(3) can be transformed from the rotor position \nreference frame (\u0219r) to the estimated rotor position \nreference frame (\u0219re) by the transformation matrix, T(\u01fb\u0219), \nviz.: \n( ) ( ) ( )( ) ( )\u00bb\u00bc\n\u00ba\n\u00ab\n\u00ac\n\u00aa\n\u0394\u0394\u2212\n\u0394\u0394\n=\u0394\n\u03b8\u03b8\n\u03b8\u03b8\u03b8\ncossin\nsincos\nT                                      (4) \nwhere \u01fb\u0219 is the error in the estimated rotor position, i.e. \n\u01fb\u0219=\u0219re-\u0219r is the difference between the estimated rotor \nposition and the actual rotor position.  Hence,    \n\u00bb\n\u00bc\n\u00ba\n\u00ab\n\u00ac\n\u00aa\n\u00bb\n\u00bb\n\u00bc\n\u00ba\n\u00ab\n\u00ab\n\u00ac\n\u00aa\n+\u0394++\u0394\n+\u0394+\u0394\u2212\n=\n\u00bb\n\u00bc\n\u00ba\n\u00ab\n\u00ac\n\u00aa\n\u22c5\u0394\u00bb\n\u00bc\n\u00ba\n\u00ab\n\u00ac\n\u00aa\n\u0394=\u00bb\n\u00bc\n\u00ba\n\u00ab\n\u00ac\n\u00aa\n\u0394=\u00bb\n\u00bc\n\u00ba\n\u00ab\n\u00ac\n\u00aa\n\u2212\ne\nqh\ne\ndh\nmdifavgmdif\nmdifmdifavg\ne\nqh\ne\ndh\nqhdqh\ndqhdh\nqh\ndh\ne\nqh\ne\ndh\ni\ni\np\nLLL\nLLL\ni\ni\npT\nLL\nLL\nT\nv\nv\nT\nv\nv\n)2cos()2sin(\n)2sin()2cos(\u02c6\n)()()( 1\n\u03b8\u03b8\u03b8\u03b8\n\u03b8\u03b8\u03b8\u03b8\n\u03b8\u03b8\u03b8\n\u0007\u0007\n\u0007  (5) \nwhere  \n\u00b0\u00af\n\u00b0\n\u00ae\n\u00ad\n\u2212=\n+=\n2\/)(\n2\/)(\ndhqhdif\ndhqhavg\nLLL\nLLL\n                                                    (6) \n\u00b0\u00af\n\u00b0\n\u00ae\n\u00ad\n+=\n\u2212==\n22\n)]\/(2arctan[)\/arctan(\ndqhdifdif\ndhqhdqhdifdqhm\nLLL\nLLLLL\n\u0007\n\u03b8\n         (7) \nSince the high frequency voltage signal, \nvsig=Vinjsin(2\u028cfHFt), is applied to the d-axis, (5) becomes:  \n\u00bb\n\u00bb\n\u00bc\n\u00ba\n\u00ab\n\u00ab\n\u00ac\n\u00aa\n\u00bb\n\u00bb\n\u00bc\n\u00ba\n\u00ab\n\u00ab\n\u00ac\n\u00aa\n+\u0394++\u0394\n+\u0394+\u0394\u2212\n=\u00bb\n\u00bc\n\u00ba\n\u00ab\n\u00ac\n\u00aa\ne\nqh\ne\ndh\nmdifavgmdif\nmdifmdifavgsig\ni\ni\np\nLLL\nLLLv\n)2(soc)2sin(\n)2sin()2(soc\n0 \u03b8\u03b8\u03b8\u03b8\n\u03b8\u03b8\u03b8\u03b8\n\u0007\u0007\n\u0007\u0007\n(8) \n2358\nThe high frequency d- and q-axis currents in the \nestimated rotor position reference frame are obtained as:   \n( )[ ]\n( )\u00b0\u00b0\n\u00af\n\u00b0\n\u00b0\n\u00ae\n\u00ad\n+\u0394\n\u2212\n\u2212=\n+\u0394+\n\u2212\n=\nmdif\ndifavg\nsige\nqh\nmdifavg\ndifavg\nsige\ndh\nL\nLLp\nv\ni\nLL\nLLp\nv\ni\n\u03b8\u03b8\n\u03b8\u03b8\n2sin\n)(\n2cos\n)(\n22\n22\n\u0007\n\u0007\n\u0007\n\u0007\n                  (9) \nIn the conventional signal injection based sensorless \nmethod, cross-coupling between the d- and q-axes is \nneglected, and the high frequency component in the q-axis \ncurrent is forced to be zero [9], i.e.:  \n( ) 02sin\n)( 22\n=+\u0394\n\u2212\n\u2212= mdif\ndifavg\nsige\nqh LLLp\nv\ni \u03b8\u03b8\n\u0007\n\u0007               (10) \nIn this case, an error exists in the estimated rotor \nposition as a result of the incremental mutual inductance \nbetween the d- and q-axes, Ldqh. The error is given by: \n\u00b8\n\u00b8\n\u00b9\n\u00b7\n\u00a8\n\u00a8\n\u00a9\n\u00a7\n\u2212\n\u2248\u2212=\u2212=\u0394\nqhdh\ndqh\nmr\ne\nr LL\nL2\narctan\n2\n12\/\u03b8\u03b8\u03b8\u03b8        (11) \nwhere \u0219re and \u0219r are the estimated and actual rotor \npositions, respectively.  \nClearly, the rotor position error will be zero only when \nLdqh=0, while the stronger the cross-coupling between the \nd- and q-axes, the larger will be the error, as will be shown \nlater.   \nIII. IMPROVED SIGNAL INJECTION SENSORLESS \nMETHOD\nIn [17], the error in the estimated rotor position due to \nthe neglect of the incremental mutual inductance between \nthe d- and q-axes, Ldqh, was analyzed by finite element \nanalysis and experimentally, and a method was proposed \nto directly compensate for the error by employing (11) \nbased on either the finite element predicted incremental \ninductances, Ldh, Lqh, Ldqh,  which are shown in Fig.1, or \nusing pre-measured errors. However, this improved \nmethod was still essentially based on the conventional \nsensorless method which forces the high frequency \ncomponent in the q-axis current to be zero, together with \nthe error compensation.  \nIn this section, an alternative method of improving the \nsignal injection based sensorless method is proposed to \neliminate the potentially large error in the estimated rotor \nposition caused by the influence of d- and q-axis cross-\ncoupling, i.e. Ldqh\u008f0. Rather than forcing the high \nfrequency component in the q-axis current to be zero, as in \nthe conventional sensorless method, an optimal \nrelationship between the high frequency components of \nthe d- and q-axis currents is established from the analysis \npresented in section II.  \nWhen the rotor position estimation error \u01fb\u0219 is \nsufficiently small, (9) can be approximated by: \n)2(\n)( 22\n\u03b8\u0394\u22c5\u2212\n\u2212\n\u2248 dqhqh\ndifavg\nsige\ndh LLLLp\nv\ni \u0007                       (12a) \n)2(\n)( 22\n\u03b8\u0394\u22c5\u2212\u2212\n\u2212\n\u2248 difdqh\ndifavg\nsige\nqh LLLLp\nv\ni \u0007                    (12b) \nBoth sides of (12a) are multiplied by Ldqh\/Lqh, and \nadded to (12b), to give:  \n\u03b8\u03bb\u03bb \u0394\u22c5\u2212\u2212\n\u2212\n=+ )22(\n)( 22 dqhdifdifavg\nsige\ndh\ne\nqh LLLLp\nv\nii \u0007        (13) \nwhere \u021c=Ldqh\/Lqh is defined as the coupling factor, which \ncan either be calculated from a knowledge of the machine \nparameters or deduced experimentally, as shown below.  \nThus, when the effect of cross-coupling is considered, \nthe rotor position estimation error \u01fb\u0219 can be calculated as:  \n)(\u02c6\n)(2\n)()( 22 e\ndh\ne\nqhHF\ndqhdifsig\ne\ndh\ne\nqhdifavg iik\nLLv\niipLL \u03bb\u03bb\n\u03bb\u03b8 \u03b8 +\u22c5=\n+\u2212\n+\u2212\n=\u0394 \u0394\n\u0007\n     (14) \nwhere \n)(2\n)(\u02c6\n22\ndqhdifsig\ndifavg\nHF LLv\npLL\nk \u03bb\n\u03b8\n+\u2212\n\u2212\n=\n\u0394\n\u0007\n is a coefficient which \nenables the rotor position estimation error to be \ndetermined from (iqhe+\u021cidhe). In equations (13) and (14), it \nis noted that the rotor position estimation error \u01fb\u0219 is \nproportional to (iqhe+\u021cidhe). Therefore, by forcing (iqhe+\u021cidhe)\nto be zero, \u01fb\u0219 can be controlled to be zero. Hence, the \ndetermination of \u021c is the key to realising the proposed \nimproved sensorless control method. \nBy definition, the value of the coupling factor \u021c for \nvarious combinations of d- and q-axis currents can be \npredicted from the finite element calculated values of Lqh\nand Ldqh, Fig. 1(b) and Fig. 1(c), as shown in Fig. 2(a).  \nClearly, the accuracy of \u021c, and, consequently, the accuracy \nof the rotor position estimation, depends on the ratio of \nLdqh\/Lqh, both Ldqh and Lqh varying with d- and q-axis \ncurrents. \nThe coupling factor \u021c can also be measured directly by \ndriving the BLAC motor by the actual rotor position with \nan encoder for example. In this way, by injecting the high \nfrequency signal vsig on the actual d-axis, (3) becomes: \n\u00bb\n\u00bc\n\u00ba\n\u00ab\n\u00ac\n\u00aa\n\u00bb\n\u00bc\n\u00ba\n\u00ab\n\u00ac\n\u00aa\n=\u00bb\n\u00bc\n\u00ba\n\u00ab\n\u00ac\n\u00aa\nqh\ndh\nqhdqh\ndqhdhsig\ni\ni\np\nLL\nLLv\n0\n                                     (15) \nThe corresponding high frequency d- and q-axis \ncurrent components are obtained from (15) as:   \n2359\nqh\ndifavg\nsig\ndh LLLp\nv\ni\n)( 22\n\u0007\n\u2212\n=\n                                              (16a) \ndqh\ndifavg\nsig\nqh LLLp\nv\ni\n)( 22\n\u0007\n\u2212\n\u2212=                                           (16b) \nTherefore, it can be seen, from equations (16a) and \n(16b), that the coupling factor \u021c can be obtained from the \nmeasured values of idh and iqh, viz.: \ndh\nqh\nqh\ndqh\ni\ni\nL\nL\n\u2212==\u03bb\n                                                (17) \nThe measured coupling factor \u021c for various d- q-axis \ncurrents are shown in Fig. 2(b).  It can be seen that there is \nan excellent agreement between the finite element \npredicted and measured coupling factors. \nWhile the value of \u021c to be used in the improved signal \ninjection based sensorless method can be determined by \ninterpolating the data shown in Fig. 2, in order to \nimplement the method on a DSP, the calculation of \u021c is \nsimplified by representing the data in Fig. 2 by a simple \nfunction, viz.:   \n( )\u00b0\u00af\n\u00b0\n\u00ae\n\u00ad\n<\u22c5\u22c5+\u2212\n\u2265\u22c5\u2212\n=\n0,\n0,\n21\n1\ne\nd\ne\nq\ne\nd\ne\nd\ne\nq\niiikk\niik\n\u03bb                              (18) \nwhere k1 and k2 are coefficients. For the BLAC motor \nunder consideration, k1=0.05A-1, k2=0.011A-2 from the \nfinite element calculated value of \u021c, Fig. 2(a), and \nk1=0.06A-1, k2=0.011A-2 from the measured values of \u021c,\nFig. 2(b).  \n-0.4\n-0.3\n-0.2\n-0.1\n0\n0.1\n0.2\n0.3\n0.4\n-4 -3 -2 -1 0 1 2 3 4\nq -axis current (A)\nCr\nos\ns-\nco\nu\npl\nin\ng \nfa\nct\no\nr,\n \n\u021c\nId=-3A\nId=-2A\nId=-1A\nId=0A\nId=1A\nId=2A\nId=3A\n(a) Finite element calculated \n-0.4\n-0.3\n-0.2\n-0.1\n0\n0.1\n0.2\n0.3\n0.4\n-4 -3 -2 -1 0 1 2 3 4\nq -axis current (A)\nCr\nos\ns-\nco\nu\npl\nin\ng \nfa\nct\no\nr,\n \n\u021c\nId=-3A\nId=-2A\nId=-1A\nId=0A\nId=1A\nId=2A\nId=3A\n(b) Measured \nFig. 2.  Comparison of predicted and measured coupling factor (\u021c). \nIn practice, multipliers and low-pass filters are used to \nobtain the high frequency d- and q-axis current \ncomponents, idhe and iqhe, [9], for use in (14) to calculate \nthe error, \u01fb\u0219, in the estimated rotor position. \u01fb\u0219 is then \ninput to a PI regulator to correct the estimated rotor \nposition \u0219re and speed \u0226re. Hence, since the cross-coupling \nis now accounted for in the rotor position estimation, the \naccuracy is improved significantly.  \nClearly, when the cross-coupling is sufficiently small \ncompared with Lqh, i.e. Ldqh\u00a70 and, hence, \u021c\u00a70, the \nproposed sensorless control strategy results in iqhe=0, and \nis identical to the conventional signal injection based \nsensorless method. \nIV. SIMULATED AND MEASURED RESULTS\nIn order to demonstrate the utility of the improved \nsignal injection method, both simulated results and \nmeasurements have been obtained for the BLAC motor, \nwhose parameters are given in Table I.   \nThe sensorless controller was implemented on a \nTMS320C31 DSP, while a 1024 pulse\/rev encoder was \nused to measure the actual rotor position \u0219r. The A\/D \nsampling and PWM switching frequency were both 5kHz, \nwhile the injected sinusoidal signal was 35V, 330Hz. The \ncontrol loop cycle was 200\u03bcS, and the measured coupling \nfactor \u021c, shown in Fig. 2(b) and represented by (18), was \nused, Fig.3, for which a flow-chart is shown in Fig. 4.  \n2360\nFig. 3.  Sensorless BLAC motor drive system. \nFig. 4.  Flow-chart of signal injection based position estimation. \nFig. 5 shows the estimated and actual rotor position \nwhen the demanded rotor speed is changed from -10Hz to \n+10Hz, i.e., -200rpm to 200rpm. As will be evident from \nFig. 5(a), when the conventional signal injection based \nsensorless method is employed, good agreement is only \nachieved when the current is relatively small, the error in \nthe estimated rotor position increasing significantly with \nthe current, e.g. the error is 25\u00ba elec. when iq=4A. \nHowever, when the improved signal injection method is \nemployed, this error reduces to 5\u00ba elec., Fig. 5(b).  This \nimprovement is also confirmed by the simulated results \nshown in Fig.6. \nFig. 7 shows the measured steady-state error in the \nestimated rotor position for various d- and q-axis currents, \nide and iqe, when the estimated rotor position is used for \nposition feedback. With the conventional signal injection \nmethod, Fig. 7(a), the error increases as both the absolute \nvalue of iq and the positive value of id are increased, due to \nincreased saturation and the consequent increase in the \ninfluence of cross-coupling. For example, the error \nbecomes 45\u00ba elec. at id=3A, iq=4A, the RMS error, from \nFig. 7(a), being 21.1\u00ba elec. From Fig. 7(b), when the \nimproved signal injection method is employed, the RMS \nerror is reduced to 2.2\u00ba elec. This improvement is \nconfirmed by the simulated results shown in Fig. 8, for \nwhich the corresponding RMS errors in the estimated \nrotor position are 17.9\u00baelec. and 1.0\u00baelec., respectively.  \n2361\n(a) Conventional signal injection method \n(b) Improved signal injection method \nFig. 5.  Measured step speed responses (speed command:  \u00b110Hz). \n(a) Conventional signal injection method \n2362\n(b) Improved signal injection method \nFig. 6.  Simulated step speed responses (speed command:  \u00b110Hz). \n-60\n-45\n-30\n-15\n0\n15\n30\n45\n60\n-4 -3 -2 -1 0 1 2 3 4\nq -axis current (A)\nR\not\nor\n p\nos\niti\non\n e\nst\nim\nat\nio\nn \ner\nro\nr\n(e\nle\nc.\n D\neg\n.)\nId=-3A\nId=-2A\nId=-1A\nId=0A\nId=1A\nId=2A\nId=3A\n(a) Conventional method, RMS(\u0219re-\u0219r)=21.1\u00ba \n-60\n-45\n-30\n-15\n0\n15\n30\n45\n60\n-4 -3 -2 -1 0 1 2 3 4\nq - axis current (A)\nR\not\nor\n p\nos\niti\non\n e\nst\nim\nat\nio\nn \ner\nro\nr\n(e\nle\nc.\n D\neg\n.)\nId=-3A\nId=-2A\nId=-1A\nId=0A\nId=1A\nId=2A\nId=3A\n(a) Improved method, RMS(\u0219re-\u0219r)=2.2\u00ba \nFig. 7.  Measured rotor position estimation error. \n-60\n-45\n-30\n-15\n0\n15\n30\n45\n60\n-4 -3 -2 -1 0 1 2 3 4\nq - axis current (A)\nR\not\nor\n p\nos\niti\non\n e\nst\nim\nat\nio\nn \ner\nro\nr\n(e\nle\nc.\n D\neg\n.)\nId=-3A\nId=-2A\nId=-1A\nId=0A\nId=1A\nId=2A\nId=3A\n(a) Conventional method, RMS(\u0219re-\u0219r)=17.9\u00ba \n-60\n-45\n-30\n-15\n0\n15\n30\n45\n60\n-4 -3 -2 -1 0 1 2 3 4\nq - axis current (A)\nR\not\nor\n p\nos\niti\non\n e\nst\nim\nat\nio\nn \ner\nro\nr\n(e\nle\nc.\n D\neg\n.)\nId=-3A\nId=-2A\nId=-1A\nId=0A\nId=1A\nId=2A\nId=3A\n(a) Improved method, RMS(\u0219re-\u0219r)=1.0\u00ba \nFig. 8.  Simulated rotor position estimation error. \nV. CONCLUSIONS\nCross-coupling magnetic saturation between the d- and q-\naxes of a permanent magnet brushless AC motor can \nsignificantly influence the accuracy of rotor position estimation \nby signal injection based methods. The paper has presented an \nimproved signal injection method which accounts for the cross-\ncoupling effect. The d- and q-axis incremental self-inductances \nand the incremental mutual-inductance between the d- and q-\naxes have been calculated by finite element analysis, and a \ncross-coupling factor determined. An experimental method has \nalso been proposed to determine the cross-coupling factor \ndirectly for subsequent use in the proposed sensorless control \nscheme. Both measurements and simulations show that a \nsignificant improvement in the accuracy of the rotor position \nestimation can be achieved, in both dynamic and steady-state \nmodes of operation, compared with the conventional signal \ninjection sensorless method.  \nVI. REFERENCES\n[1] K. R. Shouse, and D. G. Taylor, \u201cSensorless velocity control of \npermanent-magnet synchronous motors,\u201d IEEE Trans. Control System \nTechnology, vol. 6, no. 3, pp. 313-324, 1998. \n[2] S. Morimoto, K. Kawamoto, M. Sanada, and Y. Takeda, \u201cSensorless \ncontrol strategy for salient-pole PMSM based on extended EMF in \nrotating reference frame,\u201d IEEE Trans. Industry Applications, vol.38, \nno.4, pp. 1054\u20131061, 2002.  \n[3] Z. Chen, M. Tomita, S. Koki, and S. Okuma, \u201cAn extended \nelectromotive force model for sensorless control of interior permanent-\n2363\nmagnet synchronous motors,\u201d IEEE Trans. Industrial Electronics,\nvol.50, no.2, pp. 288-295, 2003. \n[4] S. Ogasawara, and H. Akagi, \u201cImplementation and position control \nperformance of a position-sensorless IPM motor drive system based on \nmagnetic saliency,\u201d IEEE Trans. Industry Applications, vol.34, no. 4, \npp. 806\u2013812, 1998. \n[5]  M. J. Corley, and R. D. Lorenz, \u201cRotor position and velocity estimation \nfor a salient-pole permanent magnet synchronous machine at standstill \nand high speed,\u201d IEEE Trans. Industry Applications, vol.34, no. 4, pp. \n784-789, 1998. \n[6] T. Aihara, A. Toba, T. Yanase, A. Mashimo, and K. Endo, \u201cSensorless \ntorque control of salient-pole synchronous motor at zero-speed \noperation,\u201d IEEE Trans. Power Electronics, vol. 14, no. 1, pp.202-208, \n1999. \n[7] J.I. Ha, K. Ide, T. Sawa, and S.K. Sul, \u201cSensorless rotor position \nestimation of an interior permanent-magnet motor from initial states\u201d, \nIEEE Trans. Industry Applications, vol. 39, no. 3, pp.761-767, 2003. \n[8] H. Kim, K.K. Huh, and R.D. Lorenz, \u201cA novel method for initial rotor \nposition estimation for IPM synchronous machine drives,\u201d IEEE Trans. \nIndustry Applications, vol. 40, no. 5, pp. 1369-1378, 2004. \n[9] J.H. Jang, S.K. Sul, J.I. Ha, K. Ide, and M. Sawamura, \u201cSensorless drive \nof surface-mounted permanent-magnet motor by high-frequency signal \ninjection based on magnetic saliency,\u201d IEEE Trans. Industry \nApplications, vol. 39, no. 4, pp. 1031\u20131039, 2003.  \n[10]  P. Guglielmi, M. Pastorelli, and A. Vagati, \u201cCross saturation effects in \nIPM motors and related impact on zero-speed sensorless control,\u201d Conf. \nRec. IEEE-IAS Annu. Meeting, vol. 4, pp. 2546-2552, 2005. \n[11] N. Bianchi, and S. Bolognani, \u201cInfluence of rotor geometry of an interior \nPM motor on sensorless control feasibility,\u201d Conf. Rec. IEEE-IAS Annu. \nMeeting, vol. 4, pp. 2553-2560, 2005 \n[12] B. Stumberger, G. Stumberger, D. Dolinar, A. Hamler, and M. Trlep, \n\u201cEnvaluation of saturation and cross-magnetization effects in interior \npermanent-magnet synchronous motor,\u201d IEEE Trans. Industry \nApplications, vol. 39, no. 5, 2003. \n[13] A. E. Fitzgerald, C. Kingsley, Jr., and S. D. Umans, \u201cElectric \nMachinery\u201d, 5th Edition, McGraw-Hill Book, 1992. \n[14] Y.S. Chen, Z.Q. Zhu, and D. Howe, \u201cCalculation of d- and q- axis \ninductances of PM brushless ac machines accounting for skew,\u201d IEEE \nTrans. Magnetics, vol. 41, no. 10, pp. 3940-3942, 2005.  \n[15] S. Morimoto, M. Sanada, and Y. Takeda, \u201cInverter-driven synchronous \nmotors for constant power,\u201d IEEE Trans. Industry Applications, vol. 2, \npp. 18-24, 1996. \n[16] J.M. Kim, and S.K. Sul, \u201cSpeed control of interior permanent magnet \nsynchronous motor drive for the flux weakening operation,\u201d IEEE \nTrans. Industry Applications, vol. 33, pp. 43-48, 1997. \n[17] Z.Q. Zhu, Y. Li, D. Howe, and C.M. Bingham, \u201cCompensation for rotor \nposition estimation error due to cross-coupling magnetic saturation in \nsignal injection based sensorless control of PM brushless AC motors,\u201d \nProc. Int. Electric Machines and Drives Conference, 3-5 May 2007, \nAntalya, Turkey,  pp.208-213. \n2364\n"}