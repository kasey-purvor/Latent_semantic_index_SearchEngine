{"doi":"10.5194\/tc-3-265-2009","coreId":"97783","oai":"oai:nora.nerc.ac.uk:10618","identifiers":["oai:nora.nerc.ac.uk:10618","10.5194\/tc-3-265-2009"],"title":"Estimating basal properties of ice streams from surface measurements: a non-linear Bayesian inverse approach applied to synthetic data","authors":["Raymond, M.J.","Gudmundsson, G.H."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2009","abstract":"We propose a new approach to indirectly estimate basal properties of ice streams, i.e. bedrock topography and basal slipperiness, from observations of surface topography and surface velocities. We demonstrate how a maximum a posteriori estimate of basal conditions can be determined using a Bayesian inference approach in a combination with an analytical linearisation of the forward model. Using synthetic data we show that for non-linear media and non-linear sliding law only a few forward-step model evaluations are needed for convergence. The forward step is solved with a numerical finite-element model using the full Stokes equations. The Frechet derivative of the forward function is approximated through analytical small-perturbation solutions. This approximation is a key feature of the method and the effects of this approximation on model performance are analyzed. The number of iterations needed for convergence increases with the amplitude of the basal perturbations, but generally less than ten iterations are needed","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/97783.pdf","fullTextIdentifier":"http:\/\/nora.nerc.ac.uk\/10618\/1\/tc-3-265-2009.pdf","pdfHashValue":"496be3f12d4fd3eb98c0479c8ad12639b65f8744","publisher":"Copernicus Publications","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:nora.nerc.ac.uk:10618<\/identifier><datestamp>\n      2013-05-15T12:54:29Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D533135<\/setSpec><setSpec>\n      7375626A656374733D533130<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/nora.nerc.ac.uk\/id\/eprint\/10618\/<\/dc:relation><dc:title>\n        Estimating basal properties of ice streams from surface measurements: a non-linear Bayesian inverse approach applied to synthetic data<\/dc:title><dc:creator>\n        Raymond, M.J.<\/dc:creator><dc:creator>\n        Gudmundsson, G.H.<\/dc:creator><dc:subject>\n        Glaciology<\/dc:subject><dc:subject>\n        Earth Sciences<\/dc:subject><dc:description>\n        We propose a new approach to indirectly estimate basal properties of ice streams, i.e. bedrock topography and basal slipperiness, from observations of surface topography and surface velocities. We demonstrate how a maximum a posteriori estimate of basal conditions can be determined using a Bayesian inference approach in a combination with an analytical linearisation of the forward model. Using synthetic data we show that for non-linear media and non-linear sliding law only a few forward-step model evaluations are needed for convergence. The forward step is solved with a numerical finite-element model using the full Stokes equations. The Frechet derivative of the forward function is approximated through analytical small-perturbation solutions. This approximation is a key feature of the method and the effects of this approximation on model performance are analyzed. The number of iterations needed for convergence increases with the amplitude of the basal perturbations, but generally less than ten iterations are needed.<\/dc:description><dc:publisher>\n        Copernicus Publications<\/dc:publisher><dc:date>\n        2009<\/dc:date><dc:type>\n        Publication - Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/nora.nerc.ac.uk\/id\/eprint\/10618\/1\/tc-3-265-2009.pdf<\/dc:identifier><dc:identifier>\n         \n\n  Raymond, M.J.; Gudmundsson, G.H..  2009  Estimating basal properties of ice streams from surface measurements: a non-linear Bayesian inverse approach applied to synthetic data.   Cryosphere, 3 (2). 265-278.  https:\/\/doi.org\/10.5194\/tc-3-265-2009 <https:\/\/doi.org\/10.5194\/tc-3-265-2009>     \n <\/dc:identifier><dc:relation>\n        10.5194\/tc-3-265-2009<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":null,"relations":["http:\/\/nora.nerc.ac.uk\/id\/eprint\/10618\/","10.5194\/tc-3-265-2009"],"year":2009,"topics":["Glaciology","Earth Sciences"],"subject":["Publication - Article","PeerReviewed"],"fullText":"The Cryosphere, 3, 265\u2013278, 2009\nwww.the-cryosphere.net\/3\/265\/2009\/\n\u00a9 Author(s) 2009. This work is distributed under\nthe Creative Commons Attribution 3.0 License.\nThe Cryosphere\nEstimating basal properties of ice streams from surface\nmeasurements: a non-linear Bayesian inverse approach applied to\nsynthetic data\nM. J. Raymond1 and G. H. Gudmundsson2\n1Versuchsanstalt fu\u00a8r Wasserbau, Hydrologie und Glaziologie (VAW), ETH-Zu\u00a8rich, 8092 Zu\u00a8rich, Switzerland\n2British Antarctic Survey, High Cross, Madingley Rd., Cambridge CB3 0ET, UK\nReceived: 17 November 2008 \u2013 Published in The Cryosphere Discuss.: 5 February 2009\nRevised: 14 October 2009 \u2013 Accepted: 18 November 2009 \u2013 Published: 23 December 2009\nAbstract. We propose a new approach to indirectly estimate\nbasal properties of ice streams, i.e. bedrock topography and\nbasal slipperiness, from observations of surface topography\nand surface velocities. We demonstrate how a maximum\na posteriori estimate of basal conditions can be determined\nusing a Bayesian inference approach in a combination with\nan analytical linearisation of the forward model. Using syn-\nthetic data we show that for non-linear media and non-linear\nsliding law only a few forward-step model evaluations are\nneeded for convergence. The forward step is solved with a\nnumerical finite-element model using the full Stokes equa-\ntions. The Fre\u00b4chet derivative of the forward function is ap-\nproximated through analytical small-perturbation solutions.\nThis approximation is a key feature of the method and the\neffects of this approximation on model performance are an-\nalyzed. The number of iterations needed for convergence\nincreases with the amplitude of the basal perturbations, but\ngenerally less than ten iterations are needed.\n1 Introduction\nThe goal of geophysical inverse methods is to make quan-\ntitative inferences about Earth characteristics from indirect\nobservations (e.g., Gouveia and Scales, 1998). Estimating\nbasal properties of glaciers from surface measurements is an\nexample of such an inverse problem. In this paper, we in-\ntroduce and test the suitability of a non-linear probabilistic\nBayesian inference approach (e.g., Rodgers, 2000; Tarantola,\nCorrespondence to:\nG. H. Gudmundsson\n(ghg@bas.ac.uk)\n2005) to estimate bedrock topography and basal slipperiness\nunder ice streams from surface velocities and surface geom-\netry. An identical Bayesian inference approach, but for lin-\near media and small amplitudes of the basal perturbations,\nhas been presented in Gudmundsson and Raymond (2008).\nIn Bayesian inference, a priori information about the basal\nproperties is expressed as a probability density function and\ncombined with the surface measurements to give a posteri-\nori probability distribution describing the final uncertainty of\nthe estimate. The solution of the inverse problem, i.e. the a\nposteriori probability distribution, provides an ensemble of\nsolutions from which we single out the most likely one cor-\nresponding to the maximum of the a posteriori probability\n(MAP estimate).\nThe forward function describing the relationship between\nbasal conditions (bedrock topography and basal slipperi-\nness), and the observations (surface topography, surface\nvelocities, rates of elevation change), is solved numeri-\ncally with a two-dimensional non-linear plane-strain finite-\nelement model. We restrict the observations to noise-\ndegraded synthetic surface data generated with the forward\nmodel. A posteriori probability distribution for the system\nstate is optimized via a non-linear Gauss-Newton procedure\nto find the maximum a posteriori probability.\nA key issue in the derivation of the solution involves de-\ntermining the sensitivity of surface fields to perturbation in\nbasal quantities. The Fre\u00b4chet derivative of the forward model\ncan, in principle, be evaluated numerically. However, as\nthe computational times involved in doing so are typically\nlong in comparison to one forward model computation, it is,\nwhenever possible, preferable to evaluate the derivatives of\nthe forward function algebraically (Rodgers, 2000). Here we\napproximate the forward model derivatives using analytical\nPublished by Copernicus Publications on behalf of the European Geosciences Union.\n266 M. J. Raymond and G. H. Gudmundsson: Non-linear inversion of synthetic data\ntransfer functions (Gudmundsson, 2003). These transfer\nfunctions describe the effects of small-amplitude perturba-\ntions in basal properties (bedrock profile and slipperiness) on\nsurface fields in the case of Newtonian rheology and linear\nsliding law. The numerical forward model solves for non-\nlinear rheology, non-linear sliding law, and finite-amplitude\nbasal perturbations. The transfer functions are, thus, only ap-\nproximations to the actual Fre\u00b4chet derivative of the forward\nmodel. It is far from clear that using the analytical transfer\nfunctions in this context will result in a usable inverse model.\nWhat is clear, however, is that if this does work, the result-\ning improvements in computational efficiency are large. The\nmain focus of this paper is to determine whether this approx-\nimation is adequate in situations commonly encountered in\nglaciology. We do so by systematically constructing syn-\nthetic data sets where, to a varying degree, assumptions of\nthe analytical theory are not fullfilled. Thus, we start by us-\ning linear rheology and small basal perturbations, and then in\na step-wise fashion introduce finite-amplitude effects of basal\nperturbations and non-linear rheology. The influence of non-\nuniform englacial temperature and non-linear sliding law on\nretrieval are also examined. The case studies presented allow\nus to explore the performance of the proposed inverse pro-\ncedure and in particular to assess the practicality of approx-\nimating the Fre\u00b4chet derivative of the forward function using\nanalytical small-amplitude solutions. We determine to what\nextent the inverse procedure converges to the true solution\nand how many iterations are needed.\nThe method proposed here differs in a number of ways\nfrom previous inverse methods developed and applied to\nice streams. Thorsteinsson et al. (2003) used the analyti-\ncal small-amplitude solutions by Gudmundsson (2003) as a\nforward model for least-squares inversion of data from Ice\nStream E, West Antarctica. In doing so the assumption was\nmade that non-linear effects were not strong. A novel aspect\nof the method used by Thorsteinsson et al. (2003) was the\nsimultaneous inversion for both basal topography and basal\nslipperiness. Gudmundsson (2006) suggested using a formal\nBayesian inverse method instead of the least-square approach\nused by Thorsteinsson et al. (2003).\nMacAyeal (1992) and MacAyeal et al. (1995) applied con-\ntrol theory to determine the basal shear stress under ice\nstreams using surface velocity data, ice thickness and surface\nelevation. Joughin et al. (2004) used a similar method to ar-\nrive at estimates of basal stress for ice streams flowing over\na perfectly plastic bed. These inverse procedures use for-\nward models that solve a reduced set of the Stokes equations.\nAnother interesting approach to surface-to-bed inversion can\nbe found in Truffer (2004) who inverted a linearized one-\ndimensional forward model to calculate the basal velocity of\na valley glacier. Further examples of inversion of surface ob-\nservations to determining basal conditions under glaciers can\nbe found in e.g. Van der Veen and Whillans (1989) and Vieli\nand Payne (2003). Recently, Maxwell et al. (2008) proposed\nan itertive scheme for determining basal conditions by solv-\ning a sequence of well-posed forward problems to arrive at\nsolution to the (ill-posed) inverse problem.\nThe structure of the paper is as follows. We start by de-\nscribing in Sect. 3 the numerical forward model. We then in-\ntroduce the non-linear Bayesian inference method in Sect. 4.\nThe results of the proposed inverse method are presented in\nSect. 5, where the suitability of the method is discussed.\n2 Notation\nVectors will be denoted by boldface italic letters (e.g. d) and\nmatrices by bold uppercase letters (e.g. C). Surface measure-\nments are available at discrete points, and we denote the set\nof all available surface quantities as the measurement vector\nd. The measurement vector d = (s,u,w)T consists of sur-\nface topography s, horizontal velocity u and vertical velocity\nw. The basal properties to be estimated are assembled into\none system state vector m. The vector m= (b,c)T contains\nthe basal topography b and basal slipperiness c. The super-\nscript T means transposition, here to column vectors. The\nsubscript prior denotes a prior estimate, while a hat (e.g. m\u02c6)\nindicates a maximum a posteriori estimate.\n3 Forward model\nThe relation between basal properties and surface data can\nbe written as\nd =g(m). (1)\nWe refer to the function g as the forward model but we also\nuse the term \u201cforward function\u201d when referring to g. The\nforward model gives the surface quantities (surface veloc-\nity and surface topography) as a function of basal properties\n(bedrock topography and basal slipperiness). The model is\nnon-linear because the ice rheology is non-linear, the sliding\nlaw is non-linear, and because the surface reacts in a non-\nlinear fashion to finite amplitude basal perturbations.\nWe use as a forward function a numerical flow model that\nallows us to deal with all the types of nonlinearities men-\ntioned above. The numerical model is a two-dimensional\nfinite element model that uses four-node isoparametric and\nquadrilateral Hermann elements. A mixed Lagrangian-\nEulerian approach is employed in determining the position\nof the steady-state surface (Leysinger Vieli and Gudmunds-\nson, 2004). The numerical model solves the full equilibrium\nequations, together with the mass-conservation equation for\nincompressible ice. These equations read \u03c3ij,j =\u2212\u03c1fi and\nvi,i = 0, respectively, where \u03c3ij are the components of the\nCauchy-stress tensor, \u03c1 is the ice density, f the acceleration\ndue to gravity and vi are the components of the velocity vec-\ntor v = (u,w). The glacier geometry corresponds to a uni-\nformly inclined plane slab of constant thickness on which\nperturbations in bed and surface topography are superim-\nposed. Figure 1 illustrates the problem geometry.\nThe Cryosphere, 3, 265\u2013278, 2009 www.the-cryosphere.net\/3\/265\/2009\/\nM. J. Raymond and G. H. Gudmundsson: Non-linear inversion of synthetic data 267\nThe coordinates are (x,z), where x is parallel and z per-\npendicular to the mean slope. The equation z= s(x,t) de-\nfines the surface and z= b(x) the base of the glacier. The\nconstitutive law is Glen\u2019s flow law, extended, following Hut-\nter (1983), with a linear term to avoid the singularity in vis-\ncosity as the deviatoric stress goes to zero\n\u000f\u02d9ij =A(\u03c4n\u22121+\u03c40n\u22121)\u03c3 (d)ij . (2)\nIn this equation, A is the rate factor, n the stress exponent,\n\u000f\u02d9ij , \u03c3\n(d)\nij and \u03c4 are the strain rate, the deviatoric stress tensors\nand the effective shear stress, respectively. The parameter \u03c40\nis the crossover stress at which the linear and power terms\ncontribute equally to the total strain rate. This parameter has\nbeen introduced only in model runs where the model geom-\netry did not give rise to a sufficiently big mean longitudinal\nstrain rate to avoid a large effective viscosity at the surface.\nValues for the rate factor for temperate ice are taken from\nPaterson (1994), and the dependency on temperature follows\nSmith and Morland (1981).\nBoundary conditions along the bed are specified by a slid-\ning relation of the form\nub= c(x)\u03c4mb , (3)\nwhere ub is the sliding velocity tangential to the bed, c(x)\nthe sliding coefficient, \u03c4b the bed parallel shear stress and m\nthe basal sliding exponent. Basal sliding is introduced in the\nfinite-element model by adding a uniform thin layer of differ-\nent viscosity to the base of the glacier such that relation (3)\nis fulfilled.\nThe ice surface (z= s(x,t)) is stress-free and evolves with\ntime according to the kinematic boundary condition until\nsteady-state is reached. The kinematic boundary condition\nreads\n\u2202s\n\u2202t\n+u \u2202s\n\u2202x\n=w, (4)\nwhere s(x,t) describes the surface elevation, t is the time,\nand u and w are the horizontal and vertical velocity com-\nponents, respectively. In model runs accumulation and ab-\nlation are not taken into account, but doing so represents a\nstraightforward modification. The kinematic boundary con-\ndition (Eq. 4) is integrated forward in time with an semi-\nimplicit Crank-Nicholson scheme. To speed up the evolu-\ntion of the free surface towards steady-state, we initialize the\ncomputations with the analytical steady-state surface profile\nfrom (Gudmundsson, 2003). Periodic displacement bound-\nary conditions are imposed along the upstream and down-\nstream glacier model boundaries.\nThe size of the mesh in the x-direction follows a Gaussian\nrepartition centered around the middle of the prescribed per-\nturbations where we expect the largest deformations. This\nallows to reduce the total amount of elements and computa-\ntional time. The results of the numerical model have been\nvalidated by comparison with relevant perturbation theories\n(Raymond and Gudmundsson, 2005).\nz\nx\nh(0)\nFig. 1. Illustration of the problem geometry and coordinate sys-\ntem. Gaussian-shape bedrock perturbation and corresponding sur-\nface reaction are shown as a black line. The dashed lines show the\nundisturbed glacier geometry.\n3.1 Perturbed fields\nWe define perturbations in boundary data and all field vari-\nables as the difference between the value of the variable in\nquestion at some given point and its spatial averaged mean\nvalue. For the basal topography, for example, we write\nb(x)= b\u00af+1b(x), (5)\nwhere b(x) is the bedrock profile, b\u00af the mean bedrock eleva-\ntion, and 1b(x)= b(x)\u2212 b\u00af the bedrock perturbation. Sim-\nilarly, the function describing the basal slipperiness c(x) is\nwritten as\nc(x)= c\u00af(1+1c(x)), (6)\nwhere c\u00af is the mean basal slipperiness, and c\u00af1c(x) is the\nbasal slipperiness perturbation. Perturbations in bedrock to-\npography are referred to in the following as b perturbations,\nand perturbations in basal slipperiness as c perturbations.\nSimilarly to the basal perturbations, the steady-state sur-\nface topography (s), surface horizontal velocity (u), and\nsurface vertical velocity (w) are partitioned as s(x)= s\u00af+\n1s(x),u(x)= u\u00af+1u(x),w(x)= w\u00af+1w(x), respectively.\nCollectively 1u, 1w and 1s are the surface perturbations\nand 1b and 1c the basal perturbations. For reasons of nota-\ntional compactness we will sometimes refer to s, u and w as\nthe surface perturbations and to b and c as the basal pertur-\nbations.\n4 Non-linear Bayesian inverse approach\nWe perform a Bayesian inverse calculation to determine both\nbedrock topography and basal slipperiness from surface to-\npography and surface velocities data. In Bayesian infer-\nence, the notion of knowledge and uncertainty about data\nand system state is expressed in terms of probability density\nfunctions (pdfs). The solution of the inverse problem is a\nposterior probability distribution P(m|d,mprior) for the sys-\ntem state m, conditional on the surface measurements d and\nprior information mprior. Using Bayes theorem this posterior\nwww.the-cryosphere.net\/3\/265\/2009\/ The Cryosphere, 3, 265\u2013278, 2009\n268 M. J. Raymond and G. H. Gudmundsson: Non-linear inversion of synthetic data\nprobability can be written as the combination of prior infor-\nmation mprior and the data d\nP(m|d,mprior)= P(m|mprior)P (d|m)\nP (d)\n. (7)\nThe denominator of Eq. (7) is independent of the system state\nand does not affect the position of the maximum of the con-\nditional probability on the left hand side of Eq. (7). Hence,\nthe a posteriori distribution reduces to the product of two\nterms, i.e. the a priori distribution P(m|mprior) for the sys-\ntem state m and the likelihood function P(d|m). The likeli-\nhood function measures the probability of observing the data\nd if the system state was m, while the prior distribution in-\ncorporates prior information that is known independently of\nthe measurements. As an example, the bed topography could\nbe known independently from radio-echo sounding measure-\nments. The a priori information may also arise from the-\noretical considerations (e.g., bedrock perturbation must be\nsmaller than ice thickness), or some expectations (e.g., basal\nslipperiness not negative).\nEquation (7) is general. In this study, we assume that both\ndata and modeling uncertainties can be described by Gaus-\nsian distributions. The a priori probability density function is\ntherefore of the form\nP(m|mprior)= (8)\nexp\n[\n\u22121\n2\n(m\u2212mprior)T C\u22121M (m\u2212mprior)\n]\n,\nwhere CM is the a priori covariance matrix describing the un-\ncertainties in the prior system state. The likelihood function\nis given by\nP(d|m)= exp\n[\n\u22121\n2\n(d\u2212g(m))T C\u22121D (d\u2212g(m))\n]\n. (9)\nHere, CD is the covariance matrix of the noise in the data\nand g(m) is the forward modeling operator encapsulating the\nrelevant physics in the relation between surface data d and\nsystem state m as described in more detail in Sect. 3.\nDefining the cost function by\nJ (m)=\u22122lnP(m|d,mprior)\nand substituting Eqs. (8) and (9) into Eq. (7) we obtain\nJ (m) = [(d\u2212g(m))T C\u22121D (d\u2212g(m)) (10)\n+ (m\u2212mprior)T C\u22121D (m\u2212mprior)].\nWe solve Eq. (10) for the minimum of J (m) correspond-\ning to the maximum of the posterior probability distribution\nP(m|d,mprior), that is, we single out the most likely sys-\ntem state m\u02c6 from the ensemble described by the pdf. This\nsolution is referred to as the maximum a posteriori solution\n(Rodgers, 2000, p. 66,84). Because the forward modeling\noperator g(m) is non-linear, there is no explicit solution to\nEq. (10). We therefore perform a non-linear optimization to\nfind the maximum a posteriori solution m\u02c6 that maximizes\nP(m|d,mprior). To find the minimum of J (m) we equate the\nderivative in respect to m of Eq. (10) to zero.\nDefining\n\u03c6(m)=\u2207mJ (m)= (11)\n\u2212KT (m)CD\u22121[d\u2212g(m)]+C\u22121M (m\u2212mprior),\nwhere K(m)=\u2207mg(m) is the Jacobian matrix, the solution\nof the optimization problem is given by \u03c6(m\u02c6)= 0.\nThe value of m\u02c6 is found using Newton\u2019s method for sys-\ntems of equations via the iteration\nmi+1 =mi\u2212[\u2207m\u03c6(mi)]\u22121\u03c6(mi), (12)\nwhere the subscript i denotes the i-th iteration, and\n\u2207m\u03c6(m) = C\u22121M +KT (m)C\u22121D K(m) (13)\n\u2212 [\u2207mKT (m)]C\u22121M [d\u2212g(m)].\nThe term \u2207mK(m) is the second derivative of the cost func-\ntion, also called its Hessian. Equation (13) involves both the\nfirst derivative K(m) and the second derivative \u2207mK(m) of\nthe forward model. As the product of \u2207mK(m) with the vec-\ntor C\u22121D [d\u2212g(m)] is small in the moderately non-linear case\nand becomes smaller as the solution proceeds, this term can\nbe ignored. Substituting Eqs. (11) and (13) into the Newto-\nnian iteration Eq. (12) gives the mi+1 iteration according to\nthe Gauss-Newton method, namely\nmi+1 =mi+(C\u22121M +KTi C\u22121D Ki)\u22121 (14)\n[KTi C\u22121D (d\u2212g(mi))\u2212C\u22121M (mi\u2212mprior)],\nwhere Ki = K(mi). The Fre\u00b4chet derivative of the forward\nmodel Ki , is approximated using linear transfer functions,\ni.e\nKi =\n\uf8eb\uf8ec\uf8ed\n\u2202gs (m)\n\u2202b\n\u2202gs (m)\n\u2202c\n\u2202gu(m)\n\u2202b\n\u2202gu(m)\n\u2202c\n\u2202gw(m)\n\u2202b\n\u2202gw(m)\n\u2202c\n\uf8f6\uf8f7\uf8f8\u2248\n\uf8eb\uf8ed Tsb TscTub Tuc\nTwb Twc\n\uf8f6\uf8f8. (15)\nThe transfer functions T are analytical solutions for linear\nrheology describing the effects of small-amplitude variations\nin bed topography and basal slipperiness on surface fields\n(Gudmundsson, 2003, 2008). The transfer functions T have\na two letter suffix. The first suffix denotes the effect and\nthe second one the cause. Tsb describes a change in surface\ntopography caused by a perturbation in bedrock topography,\nwhereas Tuc describes a change in surface-parallel velocity\ncaused by a spatial variation in basal slipperiness. Figure 2\nshows examples of analytical transfer functions as functions\nof the wavelength for both b and c perturbations.\nWhen using the transfer function formulation for Ki ,\nEq. (14) is most easily solved in Fourier space. In Eq. (14) all\nvector components, i.e., surface fields, a priori and basal per-\nturbations are therefore transformed to frequency space by\nThe Cryosphere, 3, 265\u2013278, 2009 www.the-cryosphere.net\/3\/265\/2009\/\nM. J. Raymond and G. H. Gudmundsson: Non-linear inversion of synthetic data 269\nthe relation Fs where F is the unitary discrete Fourier trans-\nform matrix and s the vector to be transformed. The covari-\nance matrices for the data and model parameters CD and CM\nare transformed to the Fourier space by the relation FCFH\nwhere C is the matrix to be transformed and H the Hermitian\ntranspose. The transpose T in Eq. (14) is substituted with the\nHermitian transpose H .\nThe covariance matrix of the maximum a posteriori solu-\ntion m\u02c6 is given by\nC\u02c6= (K\u02c6T C\u22121D K\u02c6+C\u22121M )\u22121. (16)\n4.1 Quantifying uncertainties\n4.1.1 Data uncertainties\nThe covariance matrix for the noise in the data CD is defined\nas\nCD =\n\uf8eb\uf8edCs 0 00 Cu 0\n0 0 Cw\n\uf8f6\uf8f8. (17)\nThe matrix CD is a block diagonal matrix consisting of\nthe matrices describing the uncertainties in the surface to-\npography Cs , horizontal velocity Cu and vertical velocity\nCw along the main diagonal. The off-diagonal blocks are\nzero matrices, since no cross-correlation between errors in\nsurface topography, horizontal and vertical velocity is con-\nsidered. The covariance matrix for the noise in surface to-\npography Cs takes the form\nCs =\n\uf8eb\uf8ec\uf8ec\uf8ec\uf8ed\n\u03c3 2s1s1 \u03c3\n2\ns1s2 \u00b7\u00b7\u00b7 \u03c3 2s1sN\n\u03c3 2s2s1 \u03c3\n2\ns2s2 \u00b7\u00b7\u00b7 \u03c3 2s2sN\n...\n...\n. . .\n...\n\u03c3 2sN s1 \u03c3\n2\nsN s2 \u00b7\u00b7\u00b7 \u03c3 2sN sN\n\uf8f6\uf8f7\uf8f7\uf8f7\uf8f8,\nwhere N is the number of discretization points. The matrix\nelement \u03c3 sisj is the covariance of surface data si and sj with\n1\u2264 i,j \u2264N . If the noise in the data is uncorrelated, the cor-\nresponding covariance matrix is of diagonal form. Cu and\nCw are of the same form but with the indices s replaced by u\nand w, respectively.\nThe covariance matrix for mprior is defined as\nCM =\n(\nCb 0\n0 Cc\n)\n, (18)\nwhere Cb and Cc have the same structure as Cs . No a pri-\nori cross-correlation between the a priori estimates of basal\ntopography and basal slipperiness is considered.\nThe correlation between off-diagonal elements is assumed\nto follow a Gaussian distribution and the elements of Cb are\ntherefore given by\n[Cb]ij = \u03c3bexp\n(\n\u2212 (xi\u2212xj )\n2\nl2b\n)\n. (19)\n1 10 100 1000\n \n0\n50\n100\n150\n200\nTr\nan\nsf\ner\n a\nm\npl\nitu\nde\nb\nT_UB\nT_UC\n1 10 100 1000\nwavelength\n\u2212150\n\u2212100\n\u221250\n0\n50\nPh\nas\ne \nsh\nift\n (d\neg\n.)\n1 10 100 1000\n \n0.0\n0.2\n0.4\n0.6\n0.8\n1.0\nTr\nan\nsf\ner\n a\nm\npl\nitu\nde\na\nT_SB\nT_SC\n1 10 100 1000\nwavelength\n\u221250\n0\n50\n100\n150\nPh\nas\ne \nsh\nift\n (d\neg\n.)\nFig. 2. (a) Steady-state amplitude ratios and phase shifts for\nboth bedrock (Tsb) and basal slipperiness perturbations (Tsc). (b)\nSteady-state amplitude ratios and phase shifts of surface-parallel\nvelocities for a bedrock (Tub) and basal slipperiness perturbation\n(Tuc). The medium is Newtonian. The mean surface slope is 0.5\u25e6\nand the mean non-dimensional basal slipperiness is C\u00af= 200.\n\u03c3b describes the variance of the fluctuation about the mean\nmprior of the Gaussian probability density that characterizes\nthe uncertainty of the a priori estimate, lb is the correlation\nlength and x the position. A corresponding expression is\nused for basal slipperiness a priori covariance matrix (Cc)\nwith lc denoting the correlation length.\n4.2 First guess\nTo start the iteration we need an initial guess for mi=0 in\nEq. (14). The initial guess generally corresponds to the a\nwww.the-cryosphere.net\/3\/265\/2009\/ The Cryosphere, 3, 265\u2013278, 2009\n270 M. J. Raymond and G. H. Gudmundsson: Non-linear inversion of synthetic data\npriori values for the model parameters mprior. Here, to de-\nfine mi=0, we assume that the relationship between basal and\nsurface properties is linear (i.e. the ice rheology is linear and\nthe amplitude of the basal perturbation is small) and can be\ncompletely described using the perturbation theory of Gud-\nmundsson (2003). Thus, the forward relation Eq. (1) simpli-\nfies to d =Km+\u000f, where K is a matrix of transfer functions.\nAs all pdfs are still Gaussian, the cost function is of same\nform as Eq. (10) but with g(m) replaced by K. Taking the\nnegative logarithm of this new expression and maximizing\nwith respect to d, the maximum a posteriori solution is given\nby\nm\u02c6linear =mprior+(C\u22121M +KT C\u22121D K)\u22121 (20)\nKT C\u22121D (d\u2212Kmprior).\nHence, we start the inverse procedure by setting mi=0 =\nm\u02c6linear.\n4.3 Convergence\nThe iteration is continued until either the convergence test\nJ (mi)\u2212J (mi\u22121)\u001c (3\u00d7N) (21)\nis fulfilled, or a maximum number of iterations has been\nexceeded. The above criterion is based on the fact that\n3\u00d7N corresponds theoretically to the expected value of\nJ (m\u02c6) (Tarantola, 2005).\n4.4 Inverse procedure\nIn summary, the different steps involved in the iterative opti-\nmization by which the objective function J (m) is minimized,\nare:\ni Initialization step: define a first guess for mi=0 assum-\ning everything can be described perfectly by the ana-\nlytical transfer functions valid for small-amplitudes and\nNewtonian rheology.\nii Forward step: calculate the steady-state surface re-\nsponse g(mi) for the given bedrock and the distribu-\ntion of the basal slipperiness with the non-linear forward\nfinite-element model\niii Convergence test: test for convergence using Eq. (21).\nOnce the stopping criterion is satisfied, stop the iteration\nprocedure, else\niv Inverse step: determine incremental corrections to the\nbedrock profile and the distribution of the basal slipper-\niness using Eq. (14). Return to step (ii)\nNote that the analytical transfer functions are used not only\nin the initialization step (i) but also in step (iv).\n5 Model experiments\nThe main focus of this paper is to evaluate the performance\nof the inverse method described above in situations typi-\ncally encountered on active ice streams. The key novel as-\npect of the method is the use of the analytical transfer func-\ntions in approximating the Fre\u00b4chet derivative of the forward\nmodel. This approximation renders the method tractable on\ncurrent generation of computers. On the other hand, because\nthe transfer functions are based on small-amplitude perturba-\ntions theory, this aspect of the method is also the one which\nmight most severely restrict its applicability.\nWe start by inverting for basal properties for cases where\nwe expect the method to work, i.e. for linear rheology, linear\nsliding law, and small perturbation amplitudes. Subsequently\nwe introduce large perturbation amplitudes, non-linear ice\nrheology, and non-linear sliding. Only a subset of the ex-\nperiments performed are presented here. A more detailed\ndescription can be found in Raymond (2007).\nSynthetic data\nAll synthetic surface data sets (i.e. surface topography, hor-\nizontal and vertical velocity) were generated with the finite-\nelement forward model described in Sect. 3. The perturba-\ntions in bedrock and basal slipperiness correspond either to\nGaussian peak distributions\n1b(x)= abexp\n(\n\u2212 (x\u2212xb)\n2\n\u03c3 2b\n)\n(22)\nor to a step-shaped sigmoidal function\n1b(x)= ab tanh(x), (23)\nwith a corresponding expressions for the c perturbations.\nHere ab is the basal amplitude, xb the center of the pertur-\nbation and the standard deviation \u03c3b defines the width of the\nbasal perturbation.\nThe synthetic surface data set was corrupted by uncorre-\nlated Gaussian noise. The forward relation Eq. (1) hence\nmodifies to\nd =g(m)+\u000f, (24)\nwhere \u000f are uncorrelated measurement errors.\nThe surface data was assumed to be available at equally\nspaced location along the profile. The surface data was in-\nterpolated to the nodes of the non-equidistant finite-element\nmesh. This interpolation introduces errors that, in general,\nare spatially correlated, and the covariance matrix describ-\ning the surface data errors is therefore no longer of diagonal\nform. Data were interpolated using the Best Linear Unbi-\nased Estimate (BLUE) (e.g. Kitanidis, 1997). The method\nmakes use of the experimental variogram to describe the spa-\ntial variability of the measurements. The variogram was ap-\nproximated with an isotropic Gaussian model. Key aspect\nThe Cryosphere, 3, 265\u2013278, 2009 www.the-cryosphere.net\/3\/265\/2009\/\nM. J. Raymond and G. H. Gudmundsson: Non-linear inversion of synthetic data 271\nof this interpolation method is that it delivers full covariance\nmatrices Cs , Cu, and Cw, describing the combined effects of\nnoise in the original surface data and the errors and correla-\ntions introduced by the interpolation.\nNon-dimensionalisation\nAll results are presented in non-dimensional form. The\ndimensional variables entering the problem are substituted\nthrough scalings by non-dimensional variables (Raymond\nand Gudmundsson, 2005). The spatial variables (x and z) are\nscaled with the mean ice thickness h\u00af and the velocity compo-\nnents (u and w) with the mean surface-parallel deformational\nvelocity u\u00afd . The stresses and the pressure are scaled by the\nmean basal shear stress \u03c4\u00afb. For a given mean surface slope,\nmean ice thickness, and stress-law exponent, the rate factor\nis scaled so that the mean forward deformational velocity is\nequal to unity. It follows that in non-dimensional form, the\nrate factor A equals to A= (n+ 1)\/2. When inserted into\nthe sliding law these scalings give a non-dimensional basal\nslipperiness C(x)= c(x)\u03c4 (0)m\/u\u00afd where as before c(x) is\nthe dimensional slipperiness and C(x) is its non-dimensional\ncounterpart. It further follows that C\u00af= u\u00afb\/u\u00afd , where C\u00af is the\nmean non-dimensional slipperiness (C(x)= C\u00af(1+1C)) and\nu\u00afb and u\u00afd are the mean basal and deformational velocities,\nrespectively. C\u00af is therefore equal to the slip ratio which is\ndefined as the ratio u\u00afb\/u\u00afd .\n5.1 Experiments with constant rate factor\n5.1.1 Linear rheology, linear sliding law, and small-\namplitude perturbations\nFigure 3 illustrates a synthetic surface data set generated with\nthe numerical forward model. The data represents surface\nresponse to a combined perturbation in both bedrock profile\nand basal slipperiness. The amplitudes of both basal distur-\nbances are small (5% of their respective mean values) and the\nperturbations are Gaussian shaped with a standard deviation\nof 12 mean ice thicknesses. Mean surface slope was 0.5\u25e6 and\nmean slip ratio equal to 200. Further information on basal\nparameters is given in Table 1 and in the figure caption.\nThe non-dimensionalized surface data were corrupted by\nuncorrelated Gaussian noise with zero mean and standard de-\nviation equal to 5\u00d710\u22124 for the surface topography, 10\u22123\nand 3\u00d710\u22123 for the horizontal and vertical velocity compo-\nnents, respectively. This level of noise is realistic for situa-\ntions where surface measurements are done using GPS tech-\nnology. Synthetic measurements were equally spaced with\nan interval equal to two ice thicknesses. The interpolation of\nsurface data on the surface nodal points of the finite-element\nmesh was done with the method of best linear unbiased es-\ntimator (BLUE). The surface data covariance matrix used in\nthe inversion is the corresponding BLUE estimate of interpo-\nlation errors.\n\u221260 \u221240 \u221220 0 20 40 60\n\u22120.01\n0\n0.01\n0.02\n0.03\n0.04\nx\n \n \ns\nu\nw\nFig. 3. Steady-state surface topography s, horizontal u and verti-\ncal w velocity components generated for Gaussian peak distribu-\ntions for b and C as shown in Fig. 4 (black lines with circles). The\nmedium is Newtonian. The mean surface slope \u03b1= 0.5\u25e6 and mean\nbasal slipperiness C\u00af = 200. Note that for this illustration, the sur-\nface velocities are normalized with the slip ratio C\u00af.\nTable 1. Values of the model parameters for all Gaussian perturba-\ntion experiments. Here n is the stress exponent in Glen\u2019s flow law,\nm the basal sliding exponent, ab and ac are the amplitudes of the\nbedrock and basal slipperiness perturbations, respectively, \u03b1 is the\nmean surface slope and h the mean ice thickness. In all Gaussian\nexperiments, the center of the bedrock and basal slipperiness per-\nturbations are located at xb = 10 and xc =\u221210, respectively. The\nwidths of the basal perturbations are described by the standard de-\nviation \u03c3b = \u03c3c = 12 mean ice thicknesses. The mean basal slipper-\niness is C\u00af= 200 and the rate factor is constant.\nexperiment n, m ab, ac \u03b1 h(m)\n5.1.1 n= 1, m= 1 0.05 0.5\u25e6 \u2013\n5.1.2 0.2 0.5\u25e6 \u2013\n5.1.3 n= 3, m= 1 0.05 0.2\u25e6 1000\n5.1.4 0.2 0.2\u25e6 \u2013\n5.1.5 n= 3, m= 3 0.05 0.2\u25e6 1000\n5.1.6 0.2 0.2\u25e6 1000\nThe a priori estimate was no perturbation in either basal\ntopography or basal slipperiness with large unknowns. The\na priori covariance matrix was a Gaussian with diagonal el-\nements corresponding to a 25% error in the respective mean\nvalues of basal slipperiness and ice thickness. The a priori\ncorrelations lengths for both the c and the b perturbation were\nequal to 10 mean ice thicknesses.\nFigure 4 shows the inferred bed topography and basal slip-\nperiness distribution using the data shown in Fig. 3. The first\nguess and the maximum a posteriori solution obtained after\ntwo iterations are shown. For comparison the true basal dis-\nturbances are depicted using solid lines with circles. As can\nbe seen in Fig. 4, the first guess (blue lines), obtained by as-\nsuming a linear relationship between basal and surface prop-\nerties, already resolves both basal perturbations quite accu-\nrately. This is to be expected since the ice rheology is linear\nwww.the-cryosphere.net\/3\/265\/2009\/ The Cryosphere, 3, 265\u2013278, 2009\n272 M. J. Raymond and G. H. Gudmundsson: Non-linear inversion of synthetic data\n\u221260 \u221240 \u221220 0 20 40 60\n\u22120.02\n0\n0.02\n0.04\n0.06\nx\nC \n(u d\n\/\u03c4 bm\n)\n \n \ntrue C\na priori\n0.\n2. (MAP)\nretrieval error\n\u221260 \u221240 \u221220 0 20 40 60\n\u22120.02\n0\n0.02\n0.04\n0.06\nx\nb\n \n \ntrue B\na priori\n0.\n2. (MAP)\nretrieval error\nb\na\nFig. 4. Inferred, (a) bed topography and, (b) basal slipperiness dis-\ntributions estimated from the surface data set shown in Fig. 3. The\ntrue basal perturbations are the black lines with circle, and the it-\nerations are labeled with iteration number. The maximum a pos-\nteriori solution is the red line. Both a priori estimates of bedrock\ntopography and basal slipperiness were set to zero. The medium is\nNewtonian, mean surface slope is 0.5\u25e6 and mean basal slipperiness\nC\u00af= 200. Note that the 0th iteration and the MAP virtually coincide\nwith the true bedrock perturbation in panel (a). Lines in cyan show\nthe retrieval error estimate defined as the square root of the diagonal\nelements of the a posteriori error covariance matrix C\u02c6 (Eq. 16).\nand perturbation amplitudes fairly small (5%). Nevertheless,\nthe subsequent iterative optimization significantly improves\non the initial estimate, and the final maximum a posteriori so-\nlution (m\u02c6) obtained after only two iterations is almost identi-\ncal to the true value of the basal disturbances (m). In Fig. 4\nlines in cyan show the retrieval error estimate as given by\nEq. (16).\nFigure 5 shows the residuals between observations and\nFE-model predictions for, (a) the surface topography 1s, (b)\nthe horizontal velocity 1u and, (c) the vertical velocity 1w\nfor iteration number 0 and 2. The residuals are defined as\n1d i = d\u2212g(mi) where 1d i is the vector of residuals and\ng(mi) the forward finite-element model prediction for the\nsystem state mi at iteration numbers i= 0,2. As can be seen,\nonly the horizontal velocity is poorly predicted by the FE-\nmodel in the first guess. This is almost definitely because the\nslipperiness perturbation, which has a much larger effect on\nhorizontal velocity component than the vertical one and neg-\nligible effect on surface topography, is not resolved in full\n\u221260 \u221240 \u221220 0 20 40 60\n\u22120.06\n\u22120.04\n\u22120.02\n0\n0.02\n0.04\nx\n\u2206w\n \n \n0.\n2.\n\u221260 \u221240 \u221220 0 20 40 60\n\u22120.2\n0\n0.2\n0.4\n0.6\nx\n\u2206u\n \n \n0.\n2.\n\u221260 \u221240 \u221220 0 20 40 60\n\u22122\n\u22121\n0\n1\n2 x 10\n\u22123\nx\n\u2206s\n \n \n0.\n2.\nc\nb\na\nFig. 5. Residuals between observations and FE-model predictions\nfor (a) surface topography, (b) horizontal and (c) vertical velocity.\nThe residuals are defined as 1di = d\u2212g(mi) with i the iteration\nnumber. The dotted lines correspond to the square-roots of the main\ndiagonal of the data covariance matrix CD determined with the op-\ntimal interpolation method BLUE.\ndetail in this initial step. Note that even in the final MAP\nestimate the b perturbation is better resolved than the c per-\nturbation. As we will see below, this is generally the case.\n5.1.2 Linear rheology, linear sliding law, and large am-\nplitude Gaussian perturbations\nFigure 6 shows the inferred bedrock and basal slipperiness\nperturbations for the Gaussian peak distributions as used in\nthe example above, but now for perturbation amplitudes of\n20% instead of 5%. All other parameters are the same as in\nprevious 5% amplitude example.\nThe Cryosphere, 3, 265\u2013278, 2009 www.the-cryosphere.net\/3\/265\/2009\/\nM. J. Raymond and G. H. Gudmundsson: Non-linear inversion of synthetic data 273\n\u221260 \u221240 \u221220 0 20 40 60\n\u22120.2\n\u22120.1\n0\n0.1\n0.2\nx\nC \n(u d\n\/\u03c4 bm\n)\n \n \ntrue C\na priori\n0.\n1.\n2.\n4. (MAP)\n\u221260 \u221240 \u221220 0 20 40 60\n\u22120.1\n0\n0.1\n0.2\n0.3\nx\nb\n \n \ntrue B\na priori\n0.\n1.\n2.\n4. (MAP)\nb\na\nFig. 6. Same as Fig. 4 but for basal perturbation amplitudes of 0.2.\nNote extensive superimposing of different lines with true bedrock\ntopography for iterations\u2265 1 in panel (a).\nWhereas for 5% amplitude perturbation it would have\nbeen surprising had the method not converged in a few itera-\ntions, we now have basal amplitudes that can be expected to\nbe too large to be well retrieved in the first initialization step\n(step (i)). In addition, the Fre\u00b4chet derivative of the forward\nmodel used in step (iv) is now considerably less accurate.\nAs expected on the basis of this, the first guess retrieval is\npoorer than it was in the 5% amplitude case. The initializa-\ntion step creates a peak in the basal slipperiness at the right\nposition (x =\u221210). However, it also produces a negative\npeak at x = 10 with a considerable amplitude of more than\n\u22120.1.\nEncouragingly, a positive perturbation of smaller ampli-\ntude appears at the same location in the next iteration step\n(Fig. 7). In the following iterations the retrieval converges\nquickly to the true solution. Only two more iterations are\nneeded as compared to the 5% amplitude case, and only a to-\ntal of four iterations is needed to compute the MAP estimate.\n5.1.3 Non-linear ice rheology, linear sliding law, and\nsmall-amplitude Gaussian perturbations\nIn the following experiment, we introduce a non-linear ice\nrheology, i.e. n= 3 rather than n= 1 in Eq. (2). The 5%\namplitude experiment with the two Gaussian shaped bedrock\nand slipperiness perturbations described above was repeated.\nDespite the introduction of non-linear ice rheology the inver-\n\u221260 \u221240 \u221220 0 20 40 60\n\u22120.2\n0\n0.2\n0.4\n0.6\n0.8\nx\n\u2206w\n \n \n0.\n1.\n2.\n4.\n\u221260 \u221240 \u221220 0 20 40 60\n\u22122\n\u22121\n0\n1\n2\n3\nx\n\u2206u\n \n \n0.\n1.\n2.\n4.\n\u221260 \u221240 \u221220 0 20 40 60\n\u22120.02\n\u22120.015\n\u22120.01\n\u22120.005\n0\n0.005\n0.01\nx\n\u2206s\n \n \n0.\n1.\n2.\n4.\nc\nb\na\nFig. 7. Residuals 1di between observations and FE-model predic-\ntions for (a) surface topography, (b) horizontal and (c) vertical ve-\nlocity. The dotted lines correspond to the square-roots of the main\ndiagonal of the data covariance matrix CD determined with the op-\ntimal interpolation method BLUE.\nsion algorithm not only converged but did so in only 7 iter-\nations. Further details of this experiment and other small-\namplitude experiments using bump-shaped sigmoidal func-\ntions can be found in Raymond (2007).\n5.1.4 Non-linear ice rheology, linear sliding law, and\nlarge-amplitude Gaussian perturbations\nWe now consider non-linear rheology and relative large am-\nplitudes of the basal perturbations of 20%. Both rheological\nand finite-amplitude nonlinearities are thus present and affect\nthe surface response. The cross-over stress was \u03c40 = 0.3\u03c4\u00afb.\nThe mean surface slope is now \u03b1= 0.2\u25e6 instead of \u03b1= 0.5\u25e6.\nNote that the results are not dependent on the exact value of\nthe surface slope.\nThe maximum a posteriori solution, computed using 11\niterations, is shown in Fig. 8 along with the true basal\nwww.the-cryosphere.net\/3\/265\/2009\/ The Cryosphere, 3, 265\u2013278, 2009\n274 M. J. Raymond and G. H. Gudmundsson: Non-linear inversion of synthetic data\n\u221260 \u221240 \u221220 0 20 40 60\n\u22120.4\n\u22120.2\n0\n0.2\n0.4\n0.6\nx\nC \n(u d\n\/\u03c4 bm\n)\n \n \ntrue C\na priori\n0.\n1.\n2.\n5.\n11. (MAP)\n\u221260 \u221240 \u221220 0 20 40 60\n\u22120.1\n0\n0.1\n0.2\n0.3\nx\nb\n \n \ntrue B\na priori\n0.\n1.\n11. (MAP)\nb\na\nFig. 8. Inferred (a) bed topography and (b) basal slipperiness distri-\nbutions for non-linear rheology and perturbation amplitudes of 0.2.\n\u03b1 = 0.2\u25e6, C\u00af = 200, n= 3 and \u03c40 = 0.3. Note superimposing of\nMAP line with true bedrock topography in panel (a).\ndisturbances (black lines with circles). As can be seen, the\ninverse procedure converged to the correct solution and the\nMAP reproduces quite accurately the prescribed basal distur-\nbances. The initialization step is somewhat inaccurate (see\nFig. 8) and the amplitudes of the initial guess for the b and\nthe c perturbations had to be forced to remain smaller than\n30% of the respective mean values. In comparison to the\nlinear-rheology case (experiment 5.1.2) twice as many itera-\ntions are needed for convergence.\nLooking at the residual (Fig. 9) shows that the iteration is\nin the form of a damped oscillation towards the final solution.\nThis is seen in both the b and the c perturbation fields. After\niteration 3, the oscillating behavior disappears.\n5.1.5 Non-linear rheology, non-linear sliding law, and\nsmall-amplitude Gaussian perturbations\nIn all previous experiments the sliding law was linear (i.e.\nm= 1). In the following, we will consider the inversion\nof synthetic data generated for non-linear ice rheology and\nnon-linear sliding law, i.e. m= 3 in Eq. (3). The ampli-\ntude of the basal perturbations is 5%. In this experiment, the\nmean ice thickness h\u00af= 1000 m, \u03c40 = 10 kPa, and the defor-\nmational surface velocity ud = 4.03 m a\u22121. The optimization\nprocedure converged to the correct solution in 10 iterations.\nFurther details of this experiment can be found in Raymond\n(2007).\n\u221260 \u221240 \u221220 0 20 40 60\n\u22121\n\u22120.5\n0\n0.5\n1\nx\n\u2206w\n \n \n0.\n1.\n2.\n5.\n11.\n\u221260 \u221240 \u221220 0 20 40 60\n\u221210\n\u22125\n0\n5\n10\nx\n\u2206u\n \n \n0.\n1.\n2.\n5.\n11.\n\u221260 \u221240 \u221220 0 20 40 60\n\u22120.015\n\u22120.01\n\u22120.005\n0\n0.005\n0.01\n0.015\nx\n\u2206s\n \n \n0.\n1.\n2.\n5.\n11.\nc\nb\na\nFig. 9. Residuals between observations and FE-model predictions\nfor (a) surface topography, (b) horizontal and (c) vertical velocity.\nThe dotted lines correspond to the square-roots of the main diagonal\nof the data covariance matrix CD.\n5.1.6 Non-linear rheology, non-linear sliding law, and\nlarge-amplitude Gaussian perturbations\nThe following experiment considers amplitudes of the basal\nperturbations of 20%. All other parameters are the same as\nin the previous experiment. Figure 10 shows the inferred\nbedrock and basal slipperiness distributions (red lines). As\nfor non-linear ice rheology, linear sliding law and large-\namplitude perturbations (Sect. 5.1.3, see also Fig. 8), the am-\nplitudes of the initial guess for the basal slipperiness had to\nbe forced to remain smaller than 50% of the respective mean\nvalues (blue lines in Fig. 10) by imposing a corresponding\nconstrain on the first guess. Interestingly, the form of the\ninitial basal slipperiness distribution is similar to the corre-\nsponding linear-sliding case (Sect. 5.1.3), but with a larger\namplitude. The MAP solution is obtained in 14 iterations\nand reproduces quite accurately the prescribed perturbations.\nAs compared to the corresponding linear-sliding case, only\nThe Cryosphere, 3, 265\u2013278, 2009 www.the-cryosphere.net\/3\/265\/2009\/\nM. J. Raymond and G. H. Gudmundsson: Non-linear inversion of synthetic data 275\n\u221260 \u221240 \u221220 0 20 40 60\n\u22120.4\n\u22120.2\n0\n0.2\n0.4\n0.6\nx\nC \n(u d\n\/\u03c4 bm\n)\n \n \ntrue C\na priori\n0.\n2.\n14. (MAP)\nretrieval error\n\u221260 \u221240 \u221220 0 20 40 60\n\u22120.1\n0\n0.1\n0.2\n0.3\nx\nb\n \n \ntrue B\na priori\n0.\n14. (MAP)\nretrieval error\nb\na\nFig. 10. Inferred (a) bed topography and (b) basal slipperiness dis-\ntributions for non-linear ice rheology and non-linear sliding law\nwith basal sliding exponent m= 3 and basal perturbation ampli-\ntudes of 0.2. Lines in cyan show the retrieval error estimate.\n3 more iterations are needed for convergence. Figure 11\nshows the residuals between observations and FE-model pre-\ndictions.\n5.2 Temperature-dependent non-linear ice rheology\nWe now introduce two modifications to the experimental\nsetup, 1) the rate factor is no more constant across the thick-\nness, and 2) we use basal perturbations corresponding to\nbump-shaped sigmoidal functions instead of the Gaussian\nused above. The vertical variation in rate factor corresponds\nto a linear variation in ice temperature from \u221225\u25e6 at the sur-\nface to 0\u25e6 at the base. The rate factor A is then determined us-\ning the double exponential fit between A and temperature de-\nrived by Smith and Morland (1981). The surface-parallel de-\nformational velocity amounts in this case to ud = 1.27 m a\u22121.\nThe basal disturbances are shown in Fig. 12. The parame-\nters are: mean ice thickness h\u00af= 300 m, surface slope \u03b1= 1\u25e6,\nslip ratio C\u00af= 40, cross over stress \u03c40 = 0 kPa, and 5% bump-\nshaped perturbations in b and c (see also Table 2). Surface\ndata errors and a priori estimates are the same as in all previ-\nous experiments.\nAs can be seen in Fig. 12 the (linear) initialization step\n(blue lines) already gives a good approximation to the true\nbump-shaped perturbations in b and c. In comparison to the\nretrieval of the b perturbation, the c initial estimate is, how-\never, less accurate and the rate of convergence slower (see\n\u221260 \u221240 \u221220 0 20 40 60\n\u22120.3\n\u22120.2\n\u22120.1\n0\n0.1\n0.2\nx\n\u2206w\n \n \n0.\n2.\n6.\n14.\n\u221260 \u221240 \u221220 0 20 40 60\n\u22126\n\u22124\n\u22122\n0\n2\nx\n\u2206u\n \n \n0.\n2.\n6.\n14.\n\u221260 \u221240 \u221220 0 20 40 60\n\u22124\n\u22122\n0\n2\n4 x 10\n\u22123\nx\n\u2206s\n \n \n0.\n2.\n6.\n14.\nc\nb\na\nFig. 11. Residuals between observations and FE-model predictions\nfor (a) surface topography, (b) horizontal and (c) vertical velocity\nfor selected iterations. The dotted lines correspond to the square-\nroots of the main diagonal of the data covariance matrix CD.\nTable 2. Values of the model parameters for the bump-shaped sig-\nmoidal perturbation experiments. Here ab and ac are the amplitudes\nof the bedrock and basal slipperiness perturbations, respectively, \u03b1\nis the mean surface slope and h the mean ice thickness. In both\nexperiments, the stress exponent in Glen\u2019s flow n= 3 , the basal\nsliding exponent m= 1 and the mean basal slipperiness C\u00af= 40.\nexperiment ab, ac \u03b1 h (m)\n5.2 0.05 1\u25e6 300\n5.3 0.05 1\u25e6 300\nFig. 12b) and a total of 14 iterations is needed for conver-\ngence. In contrast to Fig. 8, the estimates converge towards\nthe solution without oscillations and the residuals (Fig. 13)\ndiminish continuously towards the noise-level.\nwww.the-cryosphere.net\/3\/265\/2009\/ The Cryosphere, 3, 265\u2013278, 2009\n276 M. J. Raymond and G. H. Gudmundsson: Non-linear inversion of synthetic data\n\u221215 \u221210 \u22125 0 5 10 15\n\u22120.1\n\u22120.05\n0\n0.05\n0.1\n0.15\nx\nC \n(u d\n\/\u03c4 bm\n)\n \n \ntrue C\na priori\n0.\n1.\n5.\n14. (MAP)\n\u221215 \u221210 \u22125 0 5 10 15\n\u22120.06\n\u22120.04\n\u22120.02\n0\n0.02\n0.04\n0.06\nx\nb\n \n \ntrue B\na priori\n0.\n14. (MAP)\nb\na\nFig. 12. Inferred (a) bed topography and (b) basal slipperiness dis-\ntributions for a temperature dependent ice rheology (n= 3, \u03c40 = 0).\nThe temperature varies linearly across the ice depth from \u221225\u25e6 at\nthe surface to 0\u25e6 at the bottom.\nIn Raymond (2007) a corresponding experiment using\nisothermal conditions is described. Comparisons reveals that\nabout four times as many iterations are needed than for the\nisothermal case to fit the observed data down to the noise\nlevel. The final MAP model estimates are, however, equally\ngood showing that only the rate of convergence but not the\nquality of the solution suffers when the rate factor varies\nacross the depth.\n5.3 Forward model parameter error\nThe output of the forward model depends not only on the\nbasal boundary conditions, that is on the form of the c and\nthe b perturbations, but also on a number of forward model\nparameters. There are a total of six such forward model pa-\nrameters: the stress exponents n and m, mean ice thickness h\u00af,\nand mean surface slope \u03b1, the mean slipperiness C\u00af, and the\nrate factor A. In all experiments described above it has been\nassumed that the values of these model parameters are known\nwith perfect accuracy, whereas in a real situation these pa-\nrameters are always only known within some error bounds.\nThe general approach to this problem would be to include\nthe forward model parameters as elements of the system state\nand formally invert for these parameters in a manner identical\nto the inversion for b and c. Here we limit the discussion to\nthe case where the forward model uses an incorrect estimate\nof englacial temperature.\n\u221215 \u221210 \u22125 0 5 10 15\n\u22120.08\n\u22120.06\n\u22120.04\n\u22120.02\n0\n0.02\nx\n\u2206w\n \n \n0.\n1.\n5.\n14.\n\u221215 \u221210 \u22125 0 5 10 15\n\u22120.4\n\u22120.2\n0\n0.2\n0.4\nx\n\u2206u\n \n \n0.\n1.\n5.\n14.\n\u221215 \u221210 \u22125 0 5 10 15\n\u22120.01\n\u22120.005\n0\n0.005\n0.01\nx\n\u2206s\n \n \n0.\n1.\n5.\n14.\nc\nb\na\nFig. 13. Residuals between observations and FE-model predictions\nfor (a) surface topography, (b) horizontal and (c) vertical velocity\nfor selected iterations. The dotted lines correspond to the square-\nroots of the main diagonal of the data covariance matrix CD.\nLet us consider the synthetic surface data generated for\nbump-shaped perturbations with linear temperature profile\nincreasing from \u221225\u25e6 at the surface to 0\u25e6 at the bottom (see\nthe case for temperature-dependent ice rheology in Sect. 5.2).\nThe true deformational velocity amounts to 1.27 m a\u22121 and\nthe corresponding slip ratio is C\u00af = 40. As the temperature\nprofile is not known, we start by estimating a linear tempera-\nture profile with surface temperature \u221220\u25e6 and bottom tem-\nperature 0\u25e6. The mean surface deformational velocity ud is\nestimated to be 1.45 m a\u22121 using the standard temperature-\ndependent flow law for ice. The slip ratio is then estimated\nfrom the mean longitudinal surface speed to C\u00af = 35. These\nestimated values of the forward model characteristics are\nsubsequently introduced in the inverse calculations as well\nas in the forward finite-element model.\nThe Cryosphere, 3, 265\u2013278, 2009 www.the-cryosphere.net\/3\/265\/2009\/\nM. J. Raymond and G. H. Gudmundsson: Non-linear inversion of synthetic data 277\n\u221230 \u221220 \u221210 0 10 20 30\n\u22120.06\n\u22120.04\n\u22120.02\n0\n0.02\n0.04\n0.06\nx\nC \n(u d\n\/\u03c4 bm\n)\n \n \ntrue C\nMAP for C(0)=40\nMAP for C(0)=35\n\u221230 \u221220 \u221210 0 10 20 30\n\u22120.06\n\u22120.04\n\u22120.02\n0\n0.02\n0.04\n0.06\nx\nb\n \n \ntrue B\nMAP for C(0)=40\nMAP for C(0)=35\nb\na\nFig. 14. Comparison between MAP (a) bed topography and (b)\nbasal slipperiness as obtained with the true model characteristics\n(ud = 1.27 m a\u22121, C\u00af= 40; red lines) and with the wrong estimated\nmodel characteristics (ud = 1.45 m a\u22121, C\u00af = 35; blue lines). The\ntrue basal perturbations are also shown for comparison (black lines\nwith circles).\nFigure 14 shows a comparison of the maximum a posteri-\nori model as obtained with the true model characteristics and\nwith the modeling errors. The true basal properties are also\nshown for comparison. In both cases, the basal topography\nperturbation is completely recovered. The basal slipperiness\nperturbation is, on the other hand, resolved less accurately\nfor the case with the wrong estimated model characteristics\nthan with the true ones. The optimization procedure has been\nstopped after 7 iterations for the wrong model and after 14\niterations for the true one. The value of the maximum a pos-\nteriori solution J (m\u02c6) for the case with the wrong model char-\nacteristics is 8 times larger than for the true model and also\nabout 8 times bigger than the theoretically expected value of\nJ (m\u02c6)= 3\u00d7N . Hence, the MAP solution for the model with\na wrong estimate of englacial temperatures would obviously\nbe rejected as valid solution of the inverse problem.\n6 Summary\nWe have shown how a non-linear Bayesian inference ap-\nproach can be used to simultaneously determine both basal\ntopography and basal slipperiness from surface measure-\nments of velocity and topography. We emphasize the fact that\nwe do not produce one single solution to the inverse problem\nconsidered. Rather, we determine the maximum a posteriori\nsolution together with the a posteriori error covariance ma-\ntrix. The availability of such an error estimate greatly facili-\nties any quantitative analysis of the results. Furthermore, the\nmethod does not require any prior smoothing of input data.\nWe have shown that the Fre\u00b4chet derivative of the forward\nmodel can be adequately approximated by small-amplitude\nanalytical solutions (Gudmundsson, 2003) for the method to\nconverge. Our key result is that this remains the case even\nwhen the problem is strongly non-linear. This result is of\nconsiderable practical value as this approximation greatly en-\nhances the numerical efficiency of the method by sparing the\ntime-consuming numerical evaluation of model derivatives.\nThe proposed method is capable of dealing with both non-\nlinear finite-amplitude effects and rheological nonlinearities.\nIn all case studied, the inverse procedure converged quickly\nand to the correct solution and in only a few iterations, with\nthe exact number of iterations needed being dependent on the\ntype and magnitude of non-linear effects.\nAcknowledgements. We would like to thank O. Eisen and\nM. Morlighem for their careful reviews that we found very helpful.\nK. Hutter, M. Funk and A. Pralong all provided critical reviews and\nvaluable comments during the preparation of the manuscript.\nEdited by: S. Marshall\nReferences\nGouveia, W. P. and Scales, J. A.: Bayesian seismic waveform inver-\nsion: Parameter estimation and uncertainty analysis, J. Geophys.\nRes., 103, 2759\u20132780, doi:10.1029\/97JB02933, 1998.\nGudmundsson, G. H.: Transmission of basal variability to a glacier\nsurface, J. Geophys. Res., 108, 2253, doi:10.129\/2002JB002107,\n2003.\nGudmundsson, G. H.: Glacier Science and Environmental Change,\nchap. Estimating basal properties of glaciers from surface mea-\nsurements, Blackwell Publishing, Oxford, p. 415, 2006.\nGudmundsson, G. H.: Analytical solutions for the surface response\nto small amplitude perturbations in boundary data in the shallow-\nice-stream approximation, The Cryosphere, 2, 77\u201393, 2008,\nhttp:\/\/www.the-cryosphere-discuss.net\/2\/77\/2008\/.\nGudmundsson, G. H. and Raymond, M.: On the limit to resolution\nand information on basal properties obtainable from surface data\non ice streams, The Cryosphere, 2, 167\u2013178, 2008,\nhttp:\/\/www.the-cryosphere-discuss.net\/2\/167\/2008\/.\nHutter, K.: Theoretical glaciology; material science of ice and the\nmechanics of glaciers and ice sheets, D. Reidel Publishing Com-\npany\/Tokyo, Terra Scientific Publishing Company, 1983.\nJoughin, I., MacAyeal, D. R., and Tulaczyk, S.: Basal shear stress of\nthe Ross ice streams from control method inversions, J. Geophys.\nRes., 109, B09405, doi:10.1029\/2003JB002960, 2004.\nKitanidis, A. K.: Introduction to geostatistics: applications to hy-\ndrogeology, Cambridge University Press, 1997.\nLeysinger Vieli, G. J.-M. C. and Gudmundsson, G. H.:\nOn estimating length fluctuations of glaciers caused by\nchanges in climatic forcing, J. Geophys. Res., 109, F01007,\ndoi:10.1029\/2003JF000027, 2004.\nwww.the-cryosphere.net\/3\/265\/2009\/ The Cryosphere, 3, 265\u2013278, 2009\n278 M. J. Raymond and G. H. Gudmundsson: Non-linear inversion of synthetic data\nMacAyeal, D. R.: The Basal Stress Distribution of Ice Stream E,\nAntarctica, inferred by control methods, J. Geophys. Res., 97,\n596\u2013603, 1992.\nMacAyeal, D. R., Bindschadler, R. A., and Scambos, T. A.: Basal\nfriction of Ice Stream E, West Antartica, J. Glaciol., 41, 247\u2013262,\n1995.\nMaxwell, D., Truffer, M., Avdonin, S., and Stuefer, M.: An it-\nerative scheme for determining glacier velocities and stresses,\nJ. Glaciol., 54, 888\u2013898, doi:10.3189\/002214308787779889,\n2008.\nPaterson, W. S. B.: The physics of glaciers, Butterworth-\nHeinemann, Oxford, third edn., 1994.\nRaymond, M. J.: Estimating basal properties of glaciers and\nice streams from surface measurements, Mitteilung 202, VAW,\n152 pp., 2007.\nRaymond, M. J. and Gudmundsson, G. H.: On the relation-\nship between surface and basal properties on glaciers, ice\nsheets, and ice streams, J. Geophys. Res., 110, B08411,\ndoi:10.1029\/2005JB003681, 2005.\nRodgers, C. D.: Inverse Methods for Atmospheric Sounding. The-\nory and Practice, World Scientific Publishing Co. Pte. Ltd., Sin-\ngapore, 2000.\nSmith, G. D. and Morland, L. W.: Viscous relations for the steady\ncreep of polycrystalline ice, Cold Regions Science and Technol-\nogy, 5, 141\u2013150, 1981.\nTarantola, A.: Inverse Problem Theory and Methods for Model Pa-\nrameter Estimation, Society for Industrial and Applied Mathe-\nmatics, 2005.\nThorsteinsson, T., Raymond, C. F., Gudmundsson, G. H., Bind-\nschadler, R. B., Vornberger, P., and Joughin, I.: Bed topography\nand lubrication inferred from surface measurements on fast flow-\ning ice streams, J. Glaciol., 49, 481\u2013490, 2003.\nTruffer, M.: The basal speed of valley glaciers: an inverse approach,\nJ. Glaciol., 50, 236\u2013242, 2004.\nVan der Veen, C. J. and Whillans, I. M.: Force Budget: I. Theory\nand Numerical Methods, J. Glaciol., 35, 53\u201360, 1989.\nVieli, A. and Payne, A. J.: Application of control methods for mod-\nelling the flow of Pine Island Glacier, West Antarctica, Ann.\nGlaciol., 36, 197\u2013204, 2003.\nThe Cryosphere, 3, 265\u2013278, 2009 www.the-cryosphere.net\/3\/265\/2009\/\n"}