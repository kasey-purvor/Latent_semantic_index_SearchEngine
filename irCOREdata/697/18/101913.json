{"doi":"10.1007\/s00211-003-0488-3","coreId":"101913","oai":"oai:epubs.surrey.ac.uk:1360","identifiers":["oai:epubs.surrey.ac.uk:1360","10.1007\/s00211-003-0488-3"],"title":"Approximate momentum conservation for spatial semidiscretizations of semilinear wave equations","authors":["Oliver, M","West, M","Wulff, C"],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2004-05-01","abstract":null,"downloadUrl":"","fullTextIdentifier":null,"pdfHashValue":null,"publisher":"SPRINGER","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:epubs.surrey.ac.uk:1360<\/identifier><datestamp>\n      2017-10-31T14:01:36Z<\/datestamp><setSpec>\n      74797065733D61727469636C65<\/setSpec><setSpec>\n      6469766973696F6E733D656E67616E64706879736963616C736369656E636573:6D617468737075626C<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/epubs.surrey.ac.uk\/1360\/<\/dc:relation><dc:title>\n        Approximate momentum conservation for spatial semidiscretizations of semilinear wave equations<\/dc:title><dc:creator>\n        Oliver, M<\/dc:creator><dc:creator>\n        West, M<\/dc:creator><dc:creator>\n        Wulff, C<\/dc:creator><dc:publisher>\n        SPRINGER<\/dc:publisher><dc:date>\n        2004-05-01<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        NonPeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/epubs.surrey.ac.uk\/1360\/1\/fulltext.pdf<\/dc:identifier><dc:identifier>\n          Oliver, M, West, M and Wulff, C  (2004) Approximate momentum conservation for spatial semidiscretizations of semilinear wave equations   NUMERISCHE MATHEMATIK, 97 (3).  pp. 493-535.      <\/dc:identifier><dc:relation>\n        10.1007\/s00211-003-0488-3<\/dc:relation><dc:language>\n        English<\/dc:language><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/epubs.surrey.ac.uk\/1360\/","10.1007\/s00211-003-0488-3"],"year":2004,"topics":[],"subject":["Article","NonPeerReviewed"],"fullText":"Approximate Momentum Conservation for Spatial\nSemidiscretizations of Semilinear Wave Equations\nMarcel Oliver\nSchool of Engineering and Science\nInternational University Bremen\n28759 Bremen, Germany\nemail: oliver@member.ams.org\nMatthew West\nDepartment of Mathematics\nUniversity of California at Davis\nCA 95616, USA\nemail: west@math.ucdavis.edu\nClaudia Wulff\nDepartment of Mathematics & Statistics\nUniversity of Surrey\nGuildford GU2 7XH, UK\nc.wulff@eim.surrey.ac.uk\nMay 28, 2003\nAbstract\nWe prove that a standard second order finite difference uniform space discretization of\nthe semilinear wave equation with periodic boundary conditions, analytic nonlinearity,\nand analytic initial data conserves momentum up to an error which is exponentially\nsmall in the stepsize. Our estimates are valid for as long as the trajectories of the full\nsemilinear wave equation remain real analytic.\nThe method of proof is that of backward error analysis, whereby we construct a\nmodified equation which is itself Lagrangian and translation invariant, and therefore\nalso conserves momentum. This modified equation interpolates the semidiscrete system\nfor all time, and we prove that it remains exponentially close to the trigonometric\ninterpolation of the semidiscrete system. These properties directly imply approximate\nmomentum conservation for the semidiscrete system.\nWe also consider discretizations that are not variational as well as discretizations\non non-uniform grids. Through numerical example as well as arguments from geomet-\nric mechanics and perturbation theory we show that such methods generically do not\napproximately preserve momentum.\nContents\n1 Introduction 2\n2 Variational Framework 4\n1\n3 Spatial Semidiscretizations 6\n3.1 Variational semidiscretizations . . . . . . . . . . . . . . . . . . . . . . . . . . 6\n3.2 Non-variational semidiscretizations . . . . . . . . . . . . . . . . . . . . . . . . 7\n3.3 Interpolated momentum . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8\n4 Numerical Results 10\n5 Modified Equations 12\n6 Spatial discretizations and momentum maps 17\n6.1 Exact conservation of interpolated momenta . . . . . . . . . . . . . . . . . . . 17\n6.2 Finite difference momenta . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20\n6.3 Nonuniform space discretizations for linear waves . . . . . . . . . . . . . . . . 22\n7 Momentum error bounds 25\n7.1 Spaces of analytic functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . 25\n7.2 Functional setting for the wave equation . . . . . . . . . . . . . . . . . . . . . 27\n7.3 Functional setting for the modified system . . . . . . . . . . . . . . . . . . . . 29\n7.4 Difference between wave equation and modified system . . . . . . . . . . . . . 30\n7.5 Difference between discrete and modified system . . . . . . . . . . . . . . . . 32\n7.6 Approximate momentum conservation . . . . . . . . . . . . . . . . . . . . . . 34\n8 Concluding Remarks 36\n1 Introduction\nWhen differential equations possess special structure or symmetries, it is often desirable that\nnumerical methods for such problems either preserve these structures or possess appropriate\ndiscrete analogs.\nThe theory of structure preserving discretizations is well-developed for ordinary differen-\ntial equations. In particular, Hamiltonian ordinary differential equations can be solved by\nso-called symplectic or variational integrators [10, 18, 29]. In addition to exactly preserving\nthe symplectic form, these integrators have been shown to conserve energy over exponentially\nlong times [1, 8, 9, 27]. Such conservation properties are of crucial importance in celestial\nmechanics, molecular dynamics, and other application areas.\nAs a continuous system and its discretization will generally diverge arbitrarily far from\neach other as time advances, results on approximate energy conservation for symplectic meth-\nods usually rely on backward error analysis. To analyze the discrete system another contin-\nuous system is constructed, known as the modified equation, that can be proved to remain\nclose to the discrete system for very long times. Then the properties of the modified system\ncan be used to infer properties of the discrete system. The process of constructing the mod-\nified equation for time discretizations of ordinary differential equations can be seen as the\naveraging of a rapidly forced ordinary differential equation using a result of Neisthadt [22].\nHe was the first to prove exponentially small error estimates for the embedding of a close to\nidentity diffeomorphism (e.g., a one-step numerical method) into the flow of an autonomous\ndifferential equation.\n2\nRecently, similar ideas have been applied to construct and analyze structure preserving\ndiscretizations of partial differential equations. So-called multisymplectic integrators have\nbeen developed for Lagrangian systems by Marsden, Patrick, and Shkoller [17], and for Hamil-\ntonian systems by Bridges and Reich [2, 28]. These have led to exciting new developments\nin methods for solid mechanics [14] and fluid systems [25]. In the case of vortex methods for\nfluids the numerical method itself has an interpretation as the \u201cmodified\u201d pseudo partial dif-\nferential equation [3] or even partial differential equation [23]. De Frutos and Sanz-Serna [4]\nstudied energy and momentum conserving discretizations of KdV solitons, and found them\nto be much more accurate than non-conservative ones.\nMost of the work in the context of partial differential equations focuses on exact preserva-\ntion of conservation laws or their discrete analogs. Much less has been done for cases where\none can obtain approximate conservation of some property under discretization, and there\nthere are few rigorous results with, as far as we are aware, the following exceptions. Matthies\n[19] proves that a fully discrete reaction-diffusion system on a torus can be embedded into an\nautonomous ordinary differential equation with exponentially small error under a restrictive\ncoupling assumption between spatial and temporal stepsize. In [31] we analyze approxi-\nmate energy conservation of temporal semidiscretizations of semilinear wave equations\u2014for\na related result on averaging of rapidly forced Hamiltonian evolution equations see [20].\nMoore and Reich [21] made a first step towards a formal backward error analysis for\nmultisymplectic discretizations of semilinear wave equations and their corresponding energy\nand momentum conservation laws. They derive a modified higher order multisymplectic\npartial differential equation which is satisfied by the numerical solution with higher accuracy\nthan the discretization error.\nAs shown in [17], variational multisymplectic discretizations can preserve vertical sym-\nmetries, i.e., symmetries which are not discretized. But horizontal symmetries, such as\ntranslations in space, are discretized by finite-difference type methods, so the question arises\nwhether and how well a variational discretization will conserve the momentum corresponding\nto the discretized symmetry. In this paper we give an affirmative answer in a simple, yet\nprototypical situation: Conservation of momentum by the semilinear wave equation under a\nvariational spatial semidiscretization on a uniform grid.\nWe study the semilinear 1 + 1 wave equation on the circle S1 = R\/2piZ,\n\u2202ttu = \u2202xxu+ f(u) . (1.1)\nIn addition to possessing a Lagrangian and Hamiltonian structure, the evolution preserves\nthe momentum\nJ [u](t) =\n\u222b\nS1\n\u2202tu \u2202xudx . (1.2)\nWe find numerically that, among four different spatial semi-discretizations, only the vari-\national spatial semi-discretization on a uniform grid preserves an interpolated momentum\nwithin computational accuracy, while all other schemes display significant momentum drift.\nThis behavior is explained by the following theorem, an extended version of which is proved\nin Section 7, Theorem 7.9.\nTheorem 1.1. Assume that f is entire, and that the exact solution u = u(t, x) to the\nsemilinear wave equation is real analytic with uniform spatial radius of analyticity larger\nthan some r > 0 on [0, T ] \u00d7 S1. Further, let uh(t) denote the approximate solution that\n3\ncorresponds to the standard symmetric space-semidiscretization with uniform grid size h,\nand let ih(uh) denote the trigonometric interpolant of uh. Then there exists a constant\n\u03ba = \u03ba(u, T ) independent of h such that\n|J [u](t)\u2212 J [ih(uh)](t)| \u2264 \u03ba e\u2212pir\/h (1.3)\nuniformly on [0, T ].\nNote that if the nonlinearity is entire, the initial value problem for the semilinear wave\nequation is well-posed in certain spaces of space-analytic functions on some interval [0, T ],\nfor details see [26, 6] and Section 7.2.\nOur proof is based on a modified functional equation which is not a partial differential\nequation, but which interpolates the discrete system and so remains close to the discrete\nsystem for as long as the true solution of the wave equation remains sufficiently regular.\nTo our knowledge, this is the first rigorous backward error analysis result for spatial semi-\ndiscretizations. We also show that the interpolated momentum for the linear wave equation\nis exactly conserved for the same variational uniform discretization (Theorem 6.2), but gener-\nically drifts on sufficiently long time scales when the grid is non-uniform (Theorem 6.4).\nWe believe that our result extends to higher order methods as well as to other equations\nand full space-time discretizations. Leaving these generalizations for future work, we restrict\nourselves to a simple prototype model in this paper.\nWe begin the analysis of this model problem in Section 2 by recalling the variational struc-\nture of the wave equation. The spatial semidiscretizations are then defined in Section 3 and\nare studied numerically in Section 4. The behavior of these semidiscretizations is described\nby defining appropriate modified equations in Section 5.\nThe final two sections of the paper contain detailed proofs of the observations and claims\nin the earlier parts. In particular, Section 6 establishes why the discrete analogue of the\nmomentum map is defined as it is, and why one cannot hope to prove a stronger result\nthan Theorem 1.1. Finally, Section 7 contains a more general formulation and proof of this\ntheorem.\n2 Variational Framework\nThe semilinear wave equation (1.1) has a Lagrangian formulation, where the configuration\nspace Q is some space of sufficiently smooth functions, and the Lagrangian L : Q\u00d7Q\u2192 R is\ngiven by\nL(u, v) =\n\u222b\nS1\n[\n1\n2\nv2 \u2212 1\n2\n(\u2202xu)\n2 + F (u)\n]\ndx , (2.1)\nwhere for most of the paper we assume that f = F \u2032 is entire, i.e., is an analytic function on\nall of C. We also consider analytic functions f which are not defined on the whole of C as\nwell as Ck nonlinearities, but will focus on the case where f is entire.\nSince v is the velocity of u, the corresponding Euler-Lagrange equations read\n\u2202tu = v , (2.2a)\n\u2202tv = \u2202xxu+ f(u) . (2.2b)\n4\nThe semilinear wave equation is also Hamiltonian with\nH(u, v) =\n\u222b\nS1\n[\n1\n2\nv2 +\n1\n2\n(\u2202xu)\n2 \u2212 F (u)\n]\ndx . (2.3)\nObserve that the Lagrangian does not depend explicitly upon x. This means that it is\ninvariant with respect to the group action\n\u03c4y : (u, v)(x) 7\u2192 (u, v)(x+ y) (2.4)\nof R on Q. The infinitesimal generator of this action on Q is \u03beQ : u 7\u2192 \u2202xu, and so the\ncorresponding momentum map is\nJ(u, v) \u00b7 \u03be = \u2202L\n\u2202v\n(u, v) \u00b7 \u03beQ(u) = \u03be\n\u222b\nS1\nv \u2202xudx . (2.5)\nThus, J : Q\u00d7Q\u2192 R is given by\nJ(u, v) =\n\u222b\nS1\nv \u2202xudx . (2.6)\nWe know from Noether\u2019s theorem [16] that this quantity is an invariant of the motion, so\nthat J(U(t)) = J(U(0)) for all t and U(t) = (u(t), v(t)) \u2208 Q\u00d7Q.\nMomentum conservation can also be checked by direct calculation,\nd\ndt\n\u222b\nS1\nv \u2202xudx =\n\u222b\nS1\n[\n\u2202tv \u2202xu+ v \u2202xtu\n]\ndx\n=\n\u222b\nS1\n[\n\u2202xxu \u2202xu+ f(u) \u2202xu+ \u2202tu \u2202xtu\n]\ndx\n=\n\u222b\nS1\n\u2202x\n[\n1\n2 (\u2202xu)\n2 + F (u) + 12 (\u2202tu)\n2\n]\ndx\n= 0 , (2.7)\nwhere we have used integration by parts and the fact that S1 has no boundary. In Section 7.2\nwe review results on the existence of a flow of the semilinear wave equation on appropriate\nfunction spaces.\nFor our subsequent analysis we need to re-express the momentum in Fourier variables,\nwhere we adopt the following convention. The Fourier coefficients of a function u \u2208 L2(S1)\nare denoted\nu\u02c6k =\n1\u221a\n2pi\n\u222b\nS1\ne\u2212ikx u(x) dx = \u3008ek, u\u3009L2 , (2.8)\nwhere\nek(x) =\neikx\u221a\n2pi\n(2.9)\nare the normalized eigenfunctions of the Laplacian on L2(S1). The inverse transform then\nreads\nu(x) =\n\u2211\nk\u2208Z\nu\u02c6k ek(x) . (2.10)\n5\nIn Section 6.3 we discuss the effects of grid distortion and will need to define the trigonometric\ninterpolant of a real function on a non-uniform mesh. For this purpose it is more natural to\nwrite the Fourier transform in terms of the normalized sine and cosine functions\nck(x) =\ncos(kx)\u221a\npi\nand sk(x) =\nsin(kx)\u221a\npi\n, (2.11)\nso that the inverse Fourier transform reads\nu(x) = u\u02c60 e0 +\n\u221e\u2211\nk=1\nu\u02c6ck ck(x) +\n\u221e\u2211\nk=1\nu\u02c6sk sk(x) (2.12)\nwhere u\u02c6ck =\n\u221a\n2 Re u\u02c6k and u\u02c6\ns\nk = \u2212\n\u221a\n2 Im u\u02c6k. Finally, by direct computation,\nJ(u, v) =\n\u2211\nk\u2208Z\nik v\u02c6k u\u02c6k =\n\u221e\u2211\nk=1\nk (v\u02c6ck u\u02c6\ns\nk \u2212 v\u02c6sk u\u02c6ck) . (2.13)\n3 Spatial Semidiscretizations\nThroughout this paper, we take N nodes in S1 at positions xi, where i = 0, . . . , N \u2212 1, and\ndenote approximations to u(xi) and v(xi) by uh,i and vh,i, respectively. Let h = 2pi\/N be the\naverage grid spacing. When the grid is not uniform, the ith grid cell has width hi = xi\u2212xi\u22121\nfor i = 1, . . . , N , and hi \u2261 h only in the special case of a uniform grid. It is understood that\nall indices are in ZN \u2261 Z modN , so that i = \u22121 is equivalent to i = N \u2212 1 and, similarly,\ni = N is equivalent to i = 0. The discrete configuration manifold is Qh = RN .\n3.1 Variational semidiscretizations\nWe replace the x-derivative in the Lagrangian (2.1) by a simple finite difference and approx-\nimate the integral in a way that will lead to a consistent finite difference scheme even when\nthe grid is nonuniform. We obtain a semidiscrete Lagrangian Lh : Qh \u00d7Qh \u2192 R, defined by\nLh(uh, vh) =\nN\u22121\u2211\ni=0\nhi + hi+1\n2\n(\n1\n2\nv2h,i + F (uh,i)\n)\n\u2212 hi+1\n2\n(\nuh,i+1 \u2212 uh,i\nhi+1\n)2\n. (3.1)\nNoting that \u2202tuh = vh, we compute the semi-discrete Euler\u2013Lagrange equations,\n\u2202tuh,i = vh,i (3.2a)\n\u2202tvh,i =\n2\nhi+1 + hi\n(\nuh,i+1 \u2212 uh,i\nhi+1\n\u2212 uh,i \u2212 uh,i\u22121\nhi\n)\n+ f(uh,i) . (3.2b)\nWriting \u3008 \u00b7 , \u00b7 \u3009 to denote the standard Euclidean inner product on RN or CN , we now endow\nQh with the scalar product\n\u3008uh, wh\u3009Qh = \u3008uh, wh\u3009h =\nN\u22121\u2211\ni=0\nhi + hi+1\n2\nuh,i wh,i , (3.3)\n6\nand use this inner product on Qh \u00d7Qh. This new scalar product corresponds to the metric\nwhich is generated by the kinetic energy of the discrete system and converges to the L2-\nscalar product on the continuous configuration space Q when h1, . . . , hN \u2192 0. Then the\nsemidiscrete system is also Hamiltonian with energy\nHh(uh, ph) =\nN\u22121\u2211\ni=0\nhi + hi+1\n2\n(\n1\n2\np2h,i \u2212 F (uh,i)\n)\n+\nhi+1\n2\n(\nuh,i+1 \u2212 uh,i\nhi+1\n)2\n. (3.4)\nand with symplectic form \u3008 \u00b7 , J \u00b7 \u3009h \u2261 \u3008 \u00b7 , Jh \u00b7 \u3009 on Qh \u00d7Qh, where\nJ =\n(\n0 id\n\u2212 id 0\n)\n. (3.5)\nWe can then write\nU\u02d9h = J\u22121h \u2207Hh(Uh) = AhUh +Bh(Uh) , (3.6)\nwhere Uh = (uh, vh) \u2208 Qh \u00d7 Qh and \u2207 denotes the gradient, i.e., \u2207Hh is a column vector.\nMoreover\nAh =\n(\n0 id\n\u2206h 0\n)\n, Bh(Uh) =\n(\n0\nfh(uh)\n)\n, (3.7)\n(fh(uh))i \u2261 f(uh,i), where the discrete Laplacian \u2206h is given by\n(\u2206huh)i =\n2\nhi+1 + hi\n(\nuh,i+1 \u2212 uh,i\nhi+1\n\u2212 uh,i \u2212 uh,i\u22121\nhi\n)\n. (3.8)\nOn a uniform grid, system (3.2) reduces to\n(uh,i),t = vh,i (3.9a)\n(vh,i),t =\nuh,i+1 \u2212 2uh,i + uh,i\u22121\nh2\n+ f(uh,i). (3.9b)\nThis system is ZN -equivariant, so that the vector field on the right of (3.9) commutes with\nthe shift operator \u03c4h : Qh \u00d7Qh \u2192 Qh \u00d7Qh given by\n(\u03c4huh)i = uh,i+1 . (3.10)\nWe think of the grid symmetry on ZN as the remnant of the continuous translation symmetry\non S1.\n3.2 Non-variational semidiscretizations\nWe are also interested in non-variational schemes, and introduce the family of semi-discrete\nwave equations\n\u2202tuh,i = vh,i (3.11a)\n\u2202tvh,i =\n2\nhi+1 + hi\n(\nuh,i+1 \u2212 uh,i\nhi+1\n\u2212 uh,i \u2212 uh,i\u22121\nhi\n)\n+ \u03b1 f(uh,i+1) + (1\u2212 \u03b1) f(uh,i) (3.11b)\n7\nwith \u03b1 \u2208 [0, 1]. This is a first order discretization in general, and it is second order when the\ngrid is uniform and \u03b1 = 0. For \u03b1 = 0 the system reduces to (3.2).\nWe call the discretization (3.11) variational if it is an Euler\u2013Lagrange equation of a simple\nmechanical system. That is, we require that it possess a discrete Lagrangian Lh of the form\nLh(uh, vh) = T (vh)\u2212V (uh) with a kinetic energy T (vh) and a potential energy V (uh) where\nthe kinetic energy reduces to T (vh) =\n1\n2 \u3008vh, vh\u3009h in the case of a uniform grid. We then have\nthe following.\nLemma 3.1. The discretization (3.11) is variational for arbitrary nonlinearities f and grid\npoints x0, . . . , xN\u22121 if and only if \u03b1 = 0.\nProof. When \u03b1 = 0, (3.11) is variational with Lagrangian (3.1). When \u03b1 6= 0, consider\nthe linear uniform case where f(u) = u and xi = hi. Since T (vh) =\n1\n2 \u3008vh, vh\u3009h, the Euler\u2013\nLagrange equation can be written as a Hamiltonian vector field with structure matrix Jh = hJ\non Qh\u00d7Qh. It is thus sufficient to show that the vector field in (3.11) is not variational with\nrespect to the standard structure matrix J, i.e., does not satisfy JB = \u2212BT J.\nIndeed, Bh(Uh) = BUh is linear with B given by\n(Buh)i = 0, (Bvh)i = \u03b1uh,i+1 , (3.12)\nand therefore\nJB = \u03b1\n(\n\u03c4h 0\n0 0\n)\nand \u2212BT J = \u03b1\n(\n\u03c4Th 0\n0 0\n)\n, (3.13)\nwhere \u03c4h is the grid translation defined in (3.10), and \u03c4\nT\nh = \u03c4\u2212h. Therefore, B is not\ninfinitesimally symplectic with respect to the symplectic form Jh. We conclude that (3.11)\ncannot be written as an Euler\u2013Lagrange equation, and thus cannot be variational.\nRemark 3.1. This lemma does not guarantee that the system is not symplectic, and hence\nvariational, with respect to some non-canonical symplectic form. However, the numerically\nobserved energy drift for \u03b1 6= 0 strongly suggests that the corresponding scheme is nonvari-\national with respect to any symplectic form\u2014see Section 4.\n3.3 Interpolated momentum\nTo study the conservation of the momentum J under discretization we must define a discrete\nanalog of the momentum map. In principle, any consistent approximation to J will do\u2014\nhere we choose to first compute a trigonometric interpolant of the solution on the grid, and\nthen apply the momentum J to the interpolated function. Later, when in Section 6 we\nestablish the connection between the interpolated momentum and interpolations of discrete\ngrid symmetries, this construction will turn out to be the natural choice.\nWe proceed as follows. Define a grid projection operator pih : Q\u2192 Qh by\npih(u) = (u(x0), . . . , u(xN\u22121)) (3.14)\nand a trigonometric interpolation operator ih : Qh \u2192 Q by\nih(uh)(x) =\nu\u02c6h,0\u221a\n2pi\n+\n[N\/2]\u2211\nk=1\nu\u02c6ch,k ck(x) +\n[(N\u22121)\/2]\u2211\nk=1\nu\u02c6sh,k sk(x) , (3.15)\n8\nwhere [a] denotes the greatest integer less than or equal to a, and the basis functions are the\nnormalized sines and cosines\nck(x) =\ncos(kx)\u221a\npi\nand sk(x) =\nsin(kx)\u221a\npi\n. (3.16)\nThe coefficients of the interpolation formula are real and can be chosen uniquely so that\npih\u25e6ih = id. We will also write pih : Q\u00d7Q\u2192 Qh\u00d7Qh for the map (uh, vh)\u2192 (pih(uh), pih(vh)),\nand similarly we write ih : Qh \u00d7Qh \u2192 Q\u00d7Q.\nDefining the interpolated momentum map Jh \u2261 J \u25e6 ih : Qh \u00d7Qh \u2192 R, we see that it can\nbe computed as a finite truncation of the Fourier expression for the continuous momentum\nmap, equation (2.13),\nJh(uh, vh) =\n[(N\u22121)\/2]\u2211\nk=1\nk (u\u02c6sh,k v\u02c6\nc\nh,k \u2212 u\u02c6ch,k v\u02c6sh,k) . (3.17)\nWhen the grid is uniform, the interpolation coefficients u\u02c6h,0, u\u02c6\nc\nh,k, and u\u02c6\ns\nh,k are determined\nthrough the discrete Fourier transform [5, Section 7.2.2]. Namely,\nu\u02c6h,k =\nh\u221a\n2pi\nN\u22121\u2211\nj=0\ne\u2212ikxj uh,j \u2261 \u3008eh,k, uh\u3009Qh (3.18)\nfor k = \u2212[(N \u2212 1)\/2], . . . , [N\/2], where xj = jh and\neh,k = pih \u25e6 ek = (ek(x0), . . . , ek(xN\u22121)) (3.19)\nare the eigenfunctions of the discrete Laplacian \u2206h, orthonormal with respect to the Qh inner\nproduct. The inverse transform is given by\nuh,j =\n1\u221a\n2pi\n[N\/2]\u2211\nk=\u2212[(N\u22121)\/2]\neikxj u\u02c6h,k . (3.20)\nBy changing to normalized discrete sine and cosine functions\nch,k = pih \u25e6 ck and sh,k = pih \u25e6 sk , (3.21)\nthe grid projection of the trigonometric interpolation formula coincides with the Fourier\ninversion formula\nuh = u\u02c6h,0 eh,0 +\n[N\/2]\u2211\nk=1\nu\u02c6ch,k ch,k +\n[(N\u22121)\/2]\u2211\nk=1\nu\u02c6sh,k sh,k (3.22)\nprovided u\u02c6ch,k =\n\u221a\n2 Re u\u02c6h,k and u\u02c6\ns\nh,k = \u2212\n\u221a\n2 Im u\u02c6h,k.\nFinally, notice that the discrete Fourier transform is an orthogonal map (or isometry)\nfrom Qh to `\n2(ZN ), i.e.\n\u3008uh, wh\u3009h = \u3008u\u02c6h, w\u02c6h\u3009 . (3.23)\n9\nRemark 3.2. Note that trigonometric interpolation is also used in von Neumann spectral\nanalysis of uniform finite difference schemes. The reason behind this choice of interpola-\ntion is that the grid projection eh,k of each Fourier mode e\nikx is an eigenfunction of the\ndiscrete Laplacian. Moreover, the one-dimensional space spanned by eikx is invariant under\ntranslations\u2014it is a one-dimensional representation of the translation group. This distin-\nguishes trigonometric interpolation from any other interpolation.\n4 Numerical Results\nWe now investigate numerically how well semidiscrete wave equations preserve the inter-\npolated momentum. We compare four special cases of (3.11) with N = 21 grid points on\nS1.\n(a) Lagrangian, uniform: The Lagrangian discretization (3.2) on a uniform grid specified\nby\nxi = hi for i = 0, . . . , N \u2212 1 . (4.1)\n(b) Lagrangian, non-uniform: The Lagrangian discretization (3.2) on a non-uniform\ngrid (see Figure 1) specified by\nxi = hi\u2212 0.4 sin(hi) for i = 0, . . . , N \u2212 1 . (4.2)\n(c) Non-Lagrangian, uniform: The non-Lagrangian discretization (3.11) with \u03b1 = 0.01\non the uniform grid (4.1). Note that this is a second order discretization of \u22022xu, but\nonly a first order discretization of the nonlinear term.\n(d) Non-Lagrangian, non-uniform: The non-Lagrangian discretization (3.11) with \u03b1 =\n0.01 on the non-uniform grid (4.2).\nIn our example we take nonlinearity F (u) = 0.1u4, so that the semilinear wave equation\nreads\n\u2202ttu = \u2202xxu+ 0.4u\n3 . (4.3)\nThe initial conditions for all numerical simulations are taken to be the projection by pih of\nthe continuous functions\nu0(x) =\n5\n2\nexp\n(\ncos(x)\n5\n)\n\u2212 5\n2\n(4.4a)\nv0(x) = exp\n(\nsin(x)\n5\n)\n\u2212 1 (4.4b)\nonto the appropriate grids. These initial conditions are clearly analytic, which is reflected in\nthe exponential decay in their power spectra, as shown in Figure 5.\nWe simulate the four semidiscrete systems with a very accurate symplectic time integra-\ntion scheme, so that there is very little error introduced by time discretization. The absolute\nerror between the semidiscrete trajectories and the projection of the true solution to the\nsemilinear wave equation is shown in Figure 2. From this figure it would appear that the\nfour different semi-discretizations are behaving quite similarly.\n10\n0 6.28\nuniform \nnon\u2212uniform \nFigure 1: Grids used for numerical examples. Both grids have N = 21 points (x0 is identified\nwith x21), and are specified by equations (4.1) and (4.2).\n0 20 40 60 80 100\n0\n0.2\n0.4\n0.6\n0.8\n1\ntime\ntra\njec\ntor\ny e\nrro\nr\nLagrangian, uniform\nLagrangian, non\u2212uniform\nNon\u2212Lagrangian, uniform\nNon\u2212Lagrangian, non\u2212uniform\nFigure 2: Absolute trajectory error. All four semidiscretizations behave similarly. Due to the\nsmall value of \u03b1, there is almost no difference between the Lagrangian and non-Lagrangian\nerrors and consequently the corresponding error curves coincide. There is only a moderate\ndifference between the errors of the solutions on uniform and non-uniform grids.\n11\n0 20 40 60 80 100\n\u22120.34\n\u22120.32\ntime\nin\nte\nrp\nol\nat\ned\n m\nom\nen\ntu\nm\nLagrangian, uniform\nLagrangian, non\u2212uniform\nNon\u2212Lagrangian, uniform\nNon\u2212Lagrangian, non\u2212uniform\nFigure 3: Interpolated momentum as defined in (3.17). Only the Lagrangian semidiscretiza-\ntion on a uniform grid has a nearly constant discrete momentum. All other semidiscretizations\nhave significant momentum drift.\nIf we now consider the evolution of the discrete momentum, however, as shown in Fig-\nure 3, then we see quite a different story. Here the Lagrangian semidiscretization on the\nuniform grid conserves the discrete momentum almost without error, while all of the other\nsemidiscretizations experience substantial momentum drift.\nThe energy evolution of the various discretizations is shown in Figure 4. The situation\nhere is different to that for momentum, as the Lagrangian semidiscretizations have exactly\nconserved energy functions, while the non-Lagrangian semidiscretizations do not have any\nconserved energies. This is purely a product of the variational nature of the systems, and\nunrelated to uniformity of the grids.\nFinally, the power spectra of the true solutions of the semilinear wave equation are shown\nin Figure 5. Note that the spectra decay exponentially, which will be important later when\nthe regularity of solutions is considered.\n5 Modified Equations\nTo give a theoretical explanation for the numerical results of Section 4, we construct conti-\nnuous equations which are closer to the semidiscrete systems than the original wave equation\nis\u2014indeed, they interpolate the discrete solution. In Section 7 we analyze these modified\nequations to infer properties of the semi-discrete system.\nLet Q\u02dc be a space of sufficiently smooth real valued functions over the circle S1\u2014for the\nprecise functional setting see Section 7\u2014and let T Q\u02dc be its tangent space.\nOur grid is defined through a smooth, monotonic diffeomorphism g of S1 which leaves\n12\n0 20 40 60 80 100\n\u22121\n0\n1\n2\n3\n4\n5\nx 10\u22123\ntime\ne\nn\ne\nrg\ny \ner\nro\nr\nLagrangian, uniform\nLagrangian, non\u2212uniform\nNon\u2212Lagrangian, uniform\nNon\u2212Lagrangian, non\u2212uniform\nFigure 4: Energy error. The Lagrangian semidiscretizations conserve energy, whereas the\nnon-Lagrangian semidiscretizations do not.\n0 10 20 30 40 50\n10\u221220\n10\u221215\n10\u221210\n10\u22125\n100\nwave number\npo\nwe\nr\nu(0)\nv(0)\nu(100)\nv(100)\nFigure 5: Power spectrum of exact solution (to numerical precision) of the semilinear wave\nequation with initial conditions (4.4) at t = 100. The exponential decay of the modes\nindicates that the exact solution is still in an appropriate Gevrey space. The power spectrum\nof uh is given by (|uch,k|2 + |ush,k|2)1\/2 for k \u2265 1 and |uh,0|, with corresponding expressions\nfor vh.\n13\nx = 0 invariant. We set\nxi = g(hi) (5.1)\nfor 0 = 1, . . . , N \u2212 1 and h = 2pi\/N , and define the smooth, positive and 2pi-periodic grid\nincrement function h+ via\nh+(g(z)) = g(z + h)\u2212 g(z) (5.2)\nfor z \u2208 S1. It is convenient to also define the grid decrement h\u2212 through\nh\u2212(x+ h+(x)) = h+(x) (5.3)\nfor every x \u2208 S1. Finally, note that\nN\u2211\ni=1\nh+(yi) = 2pi , (5.4)\nwhere yi = xi or, more generally, y0 = y \u2208 S1 and yi = yi\u22121 + h+(yi\u22121) for i = 1, . . . , N \u2212 1.\nA natural grid interpolation corresponding to our numerical non-uniform grid function is the\nchoice where h+(x) and h\u2212(x) are computed from g(x) = x\u2212 \u03b2 sin(x).\nNow define the modified Lagrangian L\u02dch : Q\u02dc\u00d7 Q\u02dc\u2192 R to be\nL\u02dch(u\u02dch, v\u02dch) =\n1\nh\n\u222b\nS1\nh+(x) + h\u2212(x)\n2\n(\n1\n2\nv\u02dc2h(x) + F (u\u02dch(x))\n)\ndg\u22121(x)\n\u2212 1\nh\n\u222b\nS1\nh+(x)\n2\n(\nu\u02dch(x+ h\n+(x))\u2212 u\u02dch(x)\nh+(x)\n)2\ndg\u22121(x) , (5.5)\nwhich is consistent with the true Lagrangian (2.1). In the special case a uniform grid, this\nsimplifies to\nL\u02dch(u\u02dch, v\u02dch) =\n\u222b\nS1\n[\n1\n2\nv\u02dc2h(x)\u2212\n1\n2\n(\nu\u02dch(x+ h)\u2212 u\u02dch(x)\nh\n)2\n+ F (u\u02dch(x))\n]\ndx . (5.6)\nWhen taking variations of the general modified Lagrangian, we need to make the change\nof variables y = x + h+(x) in one of the terms. Note, therefore, that (5.2) implies that\nx+ h+(x) = g(g\u22121(x) + h), so that g\u22121(y) = g\u22121(x) + h and dg\u22121(y) = dg\u22121(x). It is then\nstraightforward to check that the Euler\u2013Lagrange equations are\n\u2202tu\u02dch(x) = v\u02dch(x) (5.7a)\n\u2202tv\u02dch(x) =\n2\nh+(x) + h\u2212(x)\n(\nu\u02dch(x+ h\n+(x))\u2212 u\u02dch(x)\nh+(x)\n\u2212 u\u02dch(x)\u2212 u\u02dch(x\u2212 h\n\u2212(x))\nh\u2212(x)\n)\n+ f(u\u02dch(x)) . (5.7b)\nFor uniform grids, system (5.7) simplifies to\n\u2202tu\u02dch(x) = v\u02dch(x) (5.8a)\n\u2202tv\u02dch(x) =\nu\u02dch(x+ h)\u2212 2u\u02dch(x) + u\u02dch(x\u2212 h)\nh2\n+ f(u\u02dch(x)). (5.8b)\n14\nThese equations are just an uncountable number of uncoupled ordinary differential equations\nof dimension N , which we regard as an ordinary differential equation on the function space\nQ\u02dc\u00d7 Q\u02dc.\nThe general modified equation corresponding to (3.11) is\n\u2202tu\u02dch(x) = v\u02dch(x) (5.9a)\n\u2202tv\u02dch(x) =\n2\nh+(x) + h\u2212(x)\n(\nu\u02dch(x+ h\n+(x))\u2212 u\u02dch(x)\nh+(x)\n\u2212 u\u02dch(x)\u2212 u\u02dch(x\u2212 h\n\u2212(x))\nh\u2212(x)\n)\n+ \u03b1 f(u\u02dch(x+ h\n+(x))) + (1\u2212 \u03b1) f(u\u02dch(x)) . (5.9b)\nLike the discrete system (3.11) in Lemma 3.1, the general modified equation (5.7) is varia-\ntional if and only if \u03b1 = 0. Observe that the modified equations have the special property\nthat they exactly coincide with the corresponding spatial semidiscretization on grid points.\nWe are interested in when the modified equation has the same spatial translation symme-\ntry as the original wave equation. Recall that the group action has the infinitesimal generator\n\u03beQ\u02dc : u\u02dc 7\u2192 \u2202xu\u02dc, which lifts to the generator \u03beQ\u02dc\u00d7Q\u02dc : (u\u02dc, v\u02dc) 7\u2192 (\u2202xu\u02dc, \u2202xv\u02dc). The corresponding mo-\nmentum map is thus the same as that for the original wave equation. We will also write that\nJ : Q\u02dc\u00d7 Q\u02dc\u2192 R is given by\nJ(u\u02dch, v\u02dch) =\n\u222b\nS1\nv\u02dch \u2202xu\u02dcdx . (5.10)\nIn the special case of a uniform grid, the general modified equation (5.7) is translation\ninvariant. For general grids, however, this is not the case as the following lemma shows.\nLemma 5.1. System (5.7) is equivariant under arbitrary space-shifts if and only h\u00b1(x) \u2261 h,\ni.e., the discretization is uniform.\nProof. We have already argued that (5.7) is S1-equivariant on a uniform grid. To prove the\nconverse, assume (5.7) is S1-equivariant under translations, i.e., the right hand side of (5.7b)\ncommutes with the shift operator \u03c4y, where (\u03c4yu)(x) = u(x + y). Fix z \u2208 S1 and choose a\nsmooth test function u\u02dc(x) whose support is contained in a small neighborhood of z so that,\nin particular, u\u02dc(z + h+(z)) = u\u02dc(z \u2212 h\u2212(z)) = 0. Then equivariance of (5.7b) implies that\nq(x) \u2261 2\nh+(x) + h\u2212(x)\n( \u22121\nh+(x)\n\u2212 1\nh\u2212(x)\n)\n=\n\u22122\nh+(x)h\u2212(x)\n(5.11)\nis independent of x = z + y for y small. As the circle can be uniformly covered with such\nneighborhoods, q(x) is constant on all of S1, and therefore\nh+(x)h\u2212(x) = C . (5.12)\nFrom (5.3) we see that [x, x+2pi] is divided into N intervals such that each of length h\u2212(x) is\nfollowed by one of length h+(x), followed again by one of length h\u2212(x). So h+(x)+ h\u2212(x) =\n2h. As a consequence,\n(h+(x)\u2212 h\u2212(x))2 = (h+(x) + h\u2212(x))2 \u2212 4h+(x)h\u2212(x) = 4h2 \u2212 4C \u2261 C22 , (5.13)\nso that h+(x)\u2212 h\u2212(x) = \u00b1C2. The sign, however, cannot depend on x as h+(x) and h\u2212(x)\nare smooth functions. Noting that h+(x) \u2212 h\u2212(x) = h+(x) \u2212 h+(x \u2212 h\u2212(x)) while h+ is\nperiodic, we see that the constant C2 must vanish.\n15\nBy Noether\u2019s theorem, the modified equation corresponding to the Lagrangian semidis-\ncretization on a uniform grid exactly preserves the momentum map. That is, for any solution\nU\u02dch(t) = (u\u02dch(t), v\u02dch(t)) of (5.9) we have J(U\u02dch(t)) = J(U\u02dch(0)) for all t. We can also check this\nby direct calculation:\nd\ndt\n\u222b\nS1\nv\u02dch \u2202xu\u02dch dx =\n\u222b\nS1\n(\n\u2202tv\u02dch \u2202xu\u02dch + v\u02dch \u2202txu\u02dch\n)\ndx\n=\n\u222b\nS1\n[\nu\u02dch(x+ h)\u2212 2u\u02dch(x) + u\u02dch(x\u2212 h)\nh2\n\u2202xu\u02dch(x)\n+ f(u\u02dch(x)) \u2202xu\u02dch(x) + \u2202tu\u02dch(x) \u2202xtu\u02dch(x)\n]\ndx\n=\n\u222b\nS1\n[\n1\nh2\nu\u02dch(x+ h) \u2202xu\u02dch(x)\u2212 1\nh2\n\u2202xu\u02dch(x\u2212 h) u\u02dch(x)\n\u2212 1\nh2\n\u2202xu\u02dc\n2\nh(x) + \u2202xF (u\u02dch(x)) +\n1\n2\n\u2202x(\u2202tu\u02dch(x))\n2\n]\ndx\n=\n\u222b\nS1\n[\n1\nh2\nu\u02dch(x+ h) \u2202xu\u02dch(x)\u2212 1\nh2\n\u2202xu\u02dch(x) u\u02dch(x+ h)\n]\ndx\n= 0 , (5.14)\nwhere we have used integration by parts and the change of coordinates x 7\u2192 x + h in one\nterm.\nObserve that although the non-Lagrangian modified equation\u2014(5.9) with \u03b1 6= 0\u2014on a\nuniform grid has the spatial translation symmetry, its non-Lagrangian nature means that it\ndoes not have the momentum map as a conserved quantity. This can be explicitly checked\nby computing the time derivative as above,\nd\ndt\n\u222b\nS1\nv\u02dch \u2202xu\u02dch dx = \u03b1\n\u222b\nS1\nf(u\u02dch(x+ h)) \u2202xu\u02dch dx , (5.15)\nwhich generally does not vanish.\nIn summary, the modified equations for the various spatial semidiscretizations are all\nexact at grid points, and their conservation properties are as follows.\n(a) Lagrangian, uniform: The modified equation is a Lagrangian system, which retains\nthe spatial translation symmetry. The modified system thus preserves the continuous\nmomentum function for all time. Note that this does not immediately provide any\nconstraint on the evolution of the discrete momentum Jh, as the way in which the\nmodified solution interpolates between the values at grid points will change over time,\nand the conserved quantity depends on this interpolation.\n(b) Lagrangian, non-uniform: The modified equation is a Lagrangian system, but it\ndoes not have the spatial translation symmetry. The momentum function is thus not\nconserved.\n(c) Non-Lagrangian, uniform: The modified equation does have the spatial translation\nsymmetry, but it is not a Lagrangian system. The momentum is thus not conserved.\n16\n(d) Non-Lagrangian, non-uniform: The modified equation is neither a Lagrangian sys-\ntem, nor does it have the spatial translation symmetry. The momentum function is\nthus not conserved.\nWe interpret the above properties as explaining the behavior which was numerically ob-\nserved in Figure 3. Of course, this relies on the rigorous results of Section 7 to establish that\nproperties of the modified equation do indeed imply properties of the semidiscrete system.\nRemark 5.1. A Taylor expansion of the modified system (5.8) in h gives higher order Hamil-\ntonian PDEs with translation symmetry, as have previously been derived by Moore and Reich\n[21].\nRemark 5.2. Other choices for the modified system are conceivable, so long as they possess\ntranslation symmetry and accurately interpolate the discrete system. We have chosen a\nparticularly simple modified equation for which the interpolation of the discrete system is\nexact.\n6 Spatial discretizations and momentum maps\nWhen space is discrete, there is no obvious sense in which the semidiscrete system (3.11) can\nhave a continuous spatial translation symmetry with a corresponding conservation law. On\nthe other hand, we have seen that there are numerical schemes\u2014variational discretizations\non an equispaced grid\u2014for which the interpolated momentum Jh = J \u25e6 ih is conserved with\nvery high accuracy. We show in Section 6.1 that on a uniform grid Jh is distinguished from\nother discrete momentum maps by generating a symmetry that interpolates the discrete\ngrid shift, and where the interpolation coincides with the continuous S1 translation group\nfor wavenumbers that are resolved on the grid. Moreover, we show that Jh belongs to a\nspecial class of interpolated momenta that are exactly conserved when the wave equation is\nlinear. From Figure 3 it may appear that the momentum is also conserved in the semilinear\ncase. While this turns out to be false, we shall see in Section 7 that even in the presence of\nnonlinearities momentum is approximately conserved.\nSection 6.2 discusses finite difference momenta. We shall see that naive finite difference\napproximations to J are not conserved in any case, but will only oscillate with amplitude of\nO(h) about the interpolated momentum.\nWhen the grid is non-uniform, the situation is radically different. In Section 6.3 we show\nthat even for the linear wave equation any discrete momentum generically drifts by an O(1)\namount within a sufficiently long interval of time.\n6.1 Exact conservation of interpolated momenta\nWe now turn to the question of defining interpolated momenta that in the linear case are\nexactly conserved. Throughout this section we consider the Lagrangian semidiscretization\non a uniform grid. For simplicity, we also assume that N is odd, and comment on necessary\nmodifications for even N where appropriate.\nWe can interpolate the discrete symmetry group ZN of the grid which acts linearly on Qh,\ni.e., the group of discrete shifts, to a linear S1-action on Qh such that for angles 2pij\/N we\n17\nrecover the grid group element which shifts the grid by j points. We will see that the contin-\nuous symmetry generated by the interpolated momentum Jh = J \u25e6 ih is such an interpolation\nthat, moreover, corresponds to a translation of the trigonometric interpolant.\nLemma 6.1. Let N be odd and the grid be uniform. Then the infinitesimal generator \u03beh =\nJh\u2207Jh(Uh) on Qh \u00d7Qh corresponding to the interpolated momentum Jh is given by\n\u03beh = pih \u25e6 \u2202x(ih \u25e6 Uh) . (6.1)\nRemark 6.1. Since \u2202x = \u03beQ is the infinitesimal generator of the translation on Q, the sym-\nmetry corresponding to the interpolated momentum acts identically to the continuous trans-\nlation symmetry restricted to eigenmodes pih \u25e6 ek with wave numbers |k| \u2264 [(N \u2212 1)\/2].\nProof. Using the antisymmetry of the discrete symplectic structure, the chain rule, the lin-\nearity of ih, and the observations that ih \u25e6 J = Jih and Jh = hJ, we can write\n\u3008\u03beh(Uh),Wh\u3009h \u2261 JDJh(Uh)Wh = \u2212DJh(Uh) JWh\n= \u2212DJ(ih \u25e6 Uh) ih \u25e6 JWh\n= \u2212DJ(ih \u25e6 Uh) Jih \u25e6Wh . (6.2)\nSince \u2202x is the infinitesimal generator corresponding to the momentum J , we know that\n\u2202xU = J\u2207J(U). Alternatively, we could compute the Fre\u00b4chet derivative of J by direct\ncomputation and integrate by parts in one of the terms. Substituting either result into the\nlast expression of (6.2), we obtain\n\u3008\u03beh(Uh),Wh\u3009Qh\u00d7Qh = \u3008J\u2202x(ih \u25e6 Uh), Jih \u25e6Wh\u3009L2\n= \u3008\u2202x(ih \u25e6 Uh), ih \u25e6Wh\u3009L2\n= \u3008pih \u25e6 \u2202x(ih \u25e6 Uh), pih \u25e6 ih \u25e6Wh\u3009h . (6.3)\nThe last equality is based on a key property of trigonometric interpolation: the L2 in-\nner product can be expressed as a finite Fourier series involving only wavenumbers with\n|k| \u2264 [N\/2]. On this subspace, however, the discrete Fourier transform coincides with the\ncontinuous Fourier transform for S1 functions and, moreover, it is orthogonal by (3.23). We\ncan thus use the discrete inverse Fourier transform to obtain the last expression in (6.3).\nSince pih \u25e6 ih = id, the claim follows.\nRemark 6.2. For N even, Lemma 6.1 remains true if we replace (6.1) by\n\u03beh = pih \u25e6 Pn\u22121\u2202x(ih \u25e6 Uh) , (6.4)\nwhere n = N\/2 and Pn denotes the projection onto the Fourier modes \u2212n, . . . , n. Remark 6.1\nalso remains valid.\nAs an immediate consequence from Lemma 6.1 we see that \u03beh is diagonal with respect\nto the discrete Fourier basis eh,k = pih \u25e6 ek where k = \u2212[N\/2], . . . , [N\/2]. The corresponding\neigenvalues are ik, so that\n(et\u03behuh)\u02c6 k = e\nikt u\u02c6h,k . (6.5)\n18\nIn particular, for t = h we recover the eigenvalues and eigenvectors of the discrete shift\noperator \u03c4h = exp(\u03behh).\nVice versa, we can define a linear interpolation of the discrete shift, exp(t\u03be\u02dch), by requiring\nthat \u03c4h = exp(\u03be\u02dchh). Thus, \u03be\u02dch is also diagonal with respect to the discrete Fourier basis and\nhas eigenvalues \u03bdk = i(k modN). If we further require that the group action is real, then\n\u03bd\u2212k = \u03bdk and \u03bd0 = 0. We can now ask whether the generalized interpolated momentum J\u02dch\ncorresponding to \u03be\u02dch is conserved. This is the content of the following theorem.\nTheorem 6.2. Consider the variational spatial semidiscretization (3.9) on an equispaced\ngrid with N odd. Further, let \u03be\u02dch \u2208 gl(N) denote the infinitesimal generator of an arbitrary\nlinear real interpolation of the discrete shift symmetry. Then the corresponding momentum\nJ\u02dch is a constant of motion if and only if the wave equation is affine, i.e., if f(u) = c1 u+ c2\nfor constants c1 and c2.\nProof. The proof is based on elementary facts from geometric mechanics. A function J : M \u2192\nR on a symplectic space M with structure matrix J is conserved by the flow of a Hamiltonian\nvector field XH = JDH(x) on M if and only if 0 = J\u02d9 = DJJ\u2207H. Since DJJ\u2207H =\n\u2212DH(x)\u03be(x) where \u03be(x) \u2261 J\u2207J(x) = XJ(x) is the Hamiltonian vector field generated by\nJ , conservation of J implies invariance of the Hamiltonian H(x) under the group exp(t\u03be)\ngenerated by \u03be. It follows that the Hamiltonian vector field is equivariant under the group\naction; in other words, that XH commutes with exp(t\u03be).\nIf the wave equation is linear, then the Hamiltonian vector field of its discretization\u2014the\nright side of (3.9)\u2014is a linear affine combination of shifts. We can therefore use the Fourier\nrepresentation of the interpolation \u03be\u02dch of the shift symmetry \u03c4h and check by direct calculation\nthat DHh(Uh)\u03be\u02dchUh \u2261 0, where the semidiscrete Hamiltonian Hh is given by (3.4).\nTo prove the converse, assume that the Hamiltonian vector field commutes with exp(t\u03be\u02dch).\nThis implies, in particular, that\nfh(e\nt\u03be\u02dchuh) = e\nt\u03be\u02dchfh(uh) , (6.6)\nfor every uh \u2208 Qh. Now choose uh,j = \u03b3 \u03b40j , so that u\u02c6h,k = const = \u03b3\n\u221a\n2pi\/N and\n(et\u03be\u02dchuh)0 =\n1\u221a\n2pi\n[N\/2]\u2211\nk=\u2212[N\/2]\ne\u03bdkt u\u02c6h,k \u2261 \u03b3 \u03c6(t) , (6.7)\nwhere\n\u03c6(t) =\n1\nN\n[N\/2]\u2211\nk=\u2212[N\/2]\ne\u03bdkt . (6.8)\nOn the one hand, we conclude that\n(\nfh(e\nt\u03be\u02dchuh)\n)\n0\n= f(\u03b3 \u03c6(t)) . (6.9)\nOn the other hand, we write exp(t\u03be\u02dch)fh(uh) = exp(t\u03be\u02dch)(fh(uh) \u2212 fh(0)) + exp(t\u03be\u02dch)fh(0).\nNoting that the constant vector (1, . . . , 1) is the zero eigenvector of \u03be\u02dch, and thus eigenvector\n19\nwith eigenvalue 1 for exp(t\u03be\u02dch), we can immediately turn to the first term. Repeating the\ncomputation leading up to (6.7) with fh(uh)\u2212 fh(0) in place of uh, we find that\n(\net\u03be\u02dchfh(uh)\n)\n0\n= (f(\u03b3)\u2212 f(0))\u03c6(t) + f(0) . (6.10)\nEquivariance implies that the right sides of (6.9) and (6.10) coincide. In other words,\nf(\u03b3 \u03c6(t))\u2212 f(0) = \u03c6(t) (f(\u03b3)\u2212 f(0)) . (6.11)\nSince \u03c6 is a continuous non-constant function and \u03b3 is arbitrary, we conclude that g(x) =\nf(x)\u2212 f(0) is linear, hence f is affine.\nRemark 6.3. If N is even, the discrete shift \u03c4h cannot be interpolated to an S\n1-action on\nQh by real-valued matrices because \u22121 is a simple eigenvalue of \u03c4h and its eigenvector is the\nhighest discrete Fourier mode (1,\u22121, . . . , 1,\u22121). But it is still true that the momentum Jh\nis a conserved quantity of the discretization (3.9) if and only if the wave equation is affine.\nThe proof is analogous to the proof of Theorem 6.2, but now \u03bdN\/2 = 0 and the summations\nin (6.7) and (6.8) run from \u2212[(N \u2212 1\/)2] to [N\/2].\n6.2 Finite difference momenta\nAs a simpler way of computing an approximate momentum map, we could take finite dif-\nference approximations to the continuous momentum J . It will turn out, however, that low\norder finite difference momenta are neither conserved for equispaced discretizations of the\nlinear wave equation, nor do they generate an S1 symmetry.\nWe define the first order finite difference momentum\nJ fd,1h (uh, vh) =\nN\u22121\u2211\ni=0\n(xi+1 \u2212 xi) uh,i+1 \u2212 uh,i\nxi+1 \u2212 xi vh,i =\nN\u22121\u2211\ni=0\n(uh,i+1 \u2212 uh,i) vh,i , (6.12)\nand the symmetric finite difference momentum which is second order on a uniform grid by\nJ fd,2h (uh, vh) =\nN\u22121\u2211\ni=0\nxi+1 \u2212 xi\u22121\n2\nuh,i+1 \u2212 uh,i\u22121\nxi+1 \u2212 xi\u22121 vh,i =\n1\n2\nN\u22121\u2211\ni=0\n(uh,i+1 \u2212 uh,i\u22121) vh,i . (6.13)\nFigures 6 and 7 show that the first order finite difference momentum oscillates about, but\ndoes not drift from the interpolated momentum. The latter feature is a consequence of the\nconsistency of the finite difference momentum as h\u2192 0. Moreover, when the grid is uniform\nand f = 0, it is easy to verify the following.\n(a) Neither J fd,1h nor J\nfd,2\nh are conserved by our variational semidiscretization on the uni-\nform grid.\n(b) The group action exp(t\u03befd,1h ) on Qh \u00d7 Qh which is generated by \u03befd,1h = J\u2207J fd,1h is\nnot an orthogonal action for any scalar product, while the group action exp(t\u03be fd,2h )\ncorresponding to J fd,2h is orthogonal.\n20\n0 20 40 60 80 100\n\u22120.4\n\u22120.3\n\u22120.2\ntime\nm\no\nm\ne\nn\ntu\nm\nFinite difference momentum\nInterpolated momentum\nFigure 6: First order finite difference momentum (6.12) for the Lagrangian discretization on\nan non-uniform grid, together with the interpolated momentum for comparison. The finite\ndifference momentum oscillates about the value of the interpolated momentum, but tracks\nit as it drifts. The plots for the non-Lagrangian discretizations and for the symmetric finite\ndifference momentum are similar.\n0 20 40 60 80 100\n\u22120.4\n\u22120.3\n\u22120.2\ntime\nm\no\nm\ne\nn\ntu\nm\nFinite difference momentum\nInterpolated momentum\nFigure 7: First order finite difference momentum for the Lagrangian discretization on a\nuniform grid, with the interpolated momentum for reference. The plot for the symmetric\nfinite difference momentum is similar. The finite different momentum does not drift, but\nmerely oscillates about the true momentum value.\n21\n(c) The group Gfd,1h \u2261 {exp(t\u03befd,1h ) : t \u2208 R} generated by \u03befd,1h is isomorphic to R, not to\nS1. The group Gfd,2h generated by \u03be\nfd,2\nh is a torus group for N > 4; i.e., it is isomorphic\nto S1 \u00d7 \u00b7 \u00b7 \u00b7 \u00d7 S1, not to S1.\nTo verify claim (a), it suffices, as in the proof of Theorem 6.2, to show that the Hamiltonian\nvector field \u03befd,1h generated by J\nfd,1\nh is not an infinitesimal symmetry of Hh, i.e., that\nDHh(x)\u03be\nfd,1\nh (x) 6= 0 . (6.14)\nWe compute\n\u03befd,1h\n(\nuh\nph\n)\n= Jh\u2207J fd,1h (uh, ph) = h\u22121\n(\n\u03c4huh \u2212 uh\nph \u2212 \u03c4\u2212hph\n)\n. (6.15)\nCondition (6.14) can now be checked by direct computation.\nTo prove (b) and (c), note that the eigenvalues of \u03c4h are e\nikh, where k = \u2212[(N \u2212\n1)\/2], . . . , [N\/2]. Hence, the eigenvalues of \u03befd,1h are given by \u03bb\nfd,1\nh,k,\u00b1 = \u00b1(eikh \u2212 1)\/h, and\nthere is some k for which the real part of \u03bbfd,1h,k,\u00b1 does not vanish. This implies that the group\ngenerated by \u03befd,1h is noncompact and, since it is a one-parameter group, is isomorphic to\nR. In particular, \u03befd,1h is not a skew symmetric matrix and therefore the group action is not\northogonal.\nFor J fd,2h we compute that \u03be\nfd,2\nh =\n1\n2h (\u03c4h\u2212 \u03c4\u2212h), and so, since \u03c4Th = \u03c4\u2212h we find that \u03befd,2h\nis skew-symmetric. The eigenvalues of \u03befd,2h are \u03bb\nfd,2\nh,k = \u00b1i sin(kh)\/h for k = 0, . . . , [N\/2].\nSince they are rationally independent for N > 4, \u03befd,2h generates a torus group. Still, \u03be\nfd,2\nh\nis not an infinitesimal symmetry of Hh, and therefore the corresponding momentum map is\nnot a conserved quantity of (3.2).\n6.3 Nonuniform space discretizations for linear waves\nIn this section consider only the linear wave equation. We show that non-uniformity of the\ngrid generically breaks conservation of any consistent approximate momentum.\nWhen the grid is uniform and k \u2265 1, the grid projections ch,k = pih \u25e6 ck and sh,k = pih \u25e6sk\nspan a two-dimensional eigenspace Eh,k of the discrete Laplacian \u2206h with identical respective\neigenvalues\n\u03bbh,k = \u2212\u03b32h,k = \u2212\u03c32h,k = 2\ncos(hk)\u2212 1\nh2\n. (6.16)\nIn fact, when N is odd all eigenspaces of \u2206h where the shift symmetry ZN acts nontrivially\nare necessarily two-dimensional, and these 1:1 resonances are essential for momentum con-\nservation. If the discrete Laplacian \u2206h is perturbed to a non-selfadjoint matrix which still\ncommutes with ZN , then the 1:1 resonance between the real parts of the eigenvalues persists.\nWhen the shift symmetry is broken then generically the 1:1 resonances are destroyed, which\nimplies momentum drift. This follows from the general theory of symmetric differential equa-\ntions [7]. Figure 8 shows that the 1:1 resonances are indeed destroyed by a non-uniform grid\ndistortion, and we will now derive an asymptotic formula for the resulting momentum drift,\nwhich can be seen in Figure 9.\n22\n\u2212120 \u2212100 \u221280 \u221260 \u221240 \u221220 0\n0\n0.2\n0.4\nreal axis\n\u03b2\nFigure 8: Splitting of the eigenvalues of the discrete Laplacian (3.8) induced by the non-\nuniform grid xi = hi\u2212 \u03b2 sin(hi).\n0 20 40 60 80 100\n\u22120.3175\n\u22120.317\n\u22120.3165\n\u22120.316\ntime\nin\nte\nrp\nol\nat\ned\n m\nom\nen\ntu\nm\nUniform\nNon\u2212uniform\nFigure 9: Error of the interpolated momentum of the discretized linear wave equation using\na uniform grid and the non-uniform grid (4.2).\n23\nFirst, note that for the uniform variational semidiscrete linear wave equation not only the\nactions\nIch,k \u2261 |v\u02c6ch,k|2 + \u03b32h,k |u\u02c6ch,k|2 (6.17)\nIsh,k \u2261 |v\u02c6sh,k|2 + \u03c32h,k |u\u02c6sh,k|2 , (6.18)\nbut also the momenta\nJh,k = k (u\u02c6\ns\nh,k v\u02c6\nc\nh,k \u2212 u\u02c6ch,k v\u02c6sh,k) (6.19)\nare conserved. (In other words, the linear wave equation is super-integrable\u2014there are more\nindependent integrals than degrees of freedom.) It is therefore sufficient to study the mo-\nmentum on only a single Ah-invariant subspace Eh,k \u00d7 Eh,k.\nLet g\u03b5 be a smooth family of diffeomorphisms on S1 with g0 = id, and let x\u03b5i = g\n\u03b5(hi)\ndenote the nodes of a distorted grid. For the family of corresponding discrete Laplacians \u2206\u03b5h\nthere are smoothly varying \u2206\u03b5h-invariant two-dimensional subspaces E\n\u03b5\nh,k, k = 1, . . . , [\nN\u22121\n2 ],\nwith E0h,k = Eh,k. Let c\n\u03b5\nh,k and s\n\u03b5\nh,k denote an orthonormal basis of E\n\u03b5\nh,k which is smooth in\n\u03b5 such that c0h,k = ch,k, s\n0\nh,k = sh,k. The 2\u00d7 2 matrix \u2206\u03b5h,k = \u2206\u03b5h|E\u03b5h,k is then also smooth in\n\u03b5. The pseudo-momenta\nJ\u03b5h,k = k (u\ns,\u03b5\nh,k v\nc,\u03b5\nh,k \u2212 uc,\u03b5h,k vs,\u03b5h,k) , (6.20)\ndefined in terms of the expansion coefficients with respect to the distorted basis functions\nwill generally be different from, but O(\u03b5)-close to, the interpolated momentum Jh|E\u03b5\nh,k\n\u00d7E\u03b5\nh,k\nfor each distorted \u2206\u03b5h,k-invariant subspace E\n\u03b5\nh,k = span{c\u03b5h,k, s\u03b5h,k}.\nThe semi-discrete linear wave equation (3.2) is simply a collection of uncoupled harmonic\noscillators for k \u2265 1 together with a subsystem for the constant eigenvector corresponding\nto k = 0, as is the original linear wave equation itself. Thus, restricting ourselves to Eh,k we\nhave, for \u03b5 = 0, \u03b3h,k = |\u03bbh,k|1\/2,\nuch,k(t) = u\nc\nh,k(0) cos(\u03b3h,kt) +\nvch,k(0)\n\u03b3h,k\nsin(\u03b3h,kt) (6.21)\nvch,k(t) = v\nc\nh,k(0) cos(\u03b3h,kt)\u2212 uch,k(0) \u03b3h,k sin(\u03b3h,kt) , (6.22)\nand corresponding solution formulas for ush,k and v\ns\nh,k. Let \u03c3\n\u03b5\nh,k and \u03b3\n\u03b5\nh,k be the eigenvalues\nof \u2206\u03b5h,k and let \u03bb\n\u03b5\nh,k =\n1\n2 (\u03c3\n\u03b5\nh,k + \u03b3\n\u03b5\nh,k). We write\n\u2206\u03b5h,k =\n(\n\u03bb\u03b5h,k + \u03b4\ncc\nh,k \u03b4\ncs\nh,k\n\u03b4sch,k \u03bb\n\u03b5\nh,k + \u03b4\nss\nh,k\n)\n, (6.23)\nso that the trace of \u03b4h,k \u2261 \u2206\u03b5h,k \u2212 \u03bbh,k vanishes, i.e., \u03b4cch,k + \u03b4ssh,k = 0. We compute that\n1\nk\nd\ndt\nJ\u03b5h,k(t) = (\u03b4\ncc\nh,k \u2212 \u03b4ssh,k)us,\u03b5h,k(t)uc,\u03b5h,k(t) + \u03b4csh,k us,\u03b5h,k(t)2 \u2212 \u03b4sch,k uc,\u03b5h,k(t)2 . (6.24)\nChoosing the parameterization of the grid projection such that |Re(\u03b3\u03b5h,k \u2212 \u03c3\u03b5h,k)| = \u03b5 and\nusing that \u03b4cch,k+\u03b4\nss\nh,k = 0, we see that at least one of the coefficients \u03b4\ncs\nh,k, \u03b4\nsc\nh,k, or (\u03b4\ncc\nh,k\u2212\u03b4ssh,k)\nis of order \u03b5. Choosing ush,k(0) = v\ns\nh,k(0) = v\nc\nh,k(0) = 0 we have u\nc\nh,k(t) = u\nc\nh,k(0) cos(\u03b3h,kt)\nat \u03b5 = 0, and inserting this initial condition into (6.24) we find\n1\nk\nd\ndt\nJ\u03b5h,k(t) = \u2212\u03b4cs\n(\nuch,k(0) cos(\u03b3h,kt)\n)2\n+O(\u03b52) . (6.25)\n24\nHence, J\u03b5h,k(t)\u2212J\u03b5h,k(0) = O(1) after time O(1\/\u03b5). We proceed similarly if \u03b4cs grows quadrat-\nically in \u03b5, but \u03b4sc or (\u03b4cc\u2212\u03b4ss) grow linearly in \u03b5. In summary, we have proved the following.\nLemma 6.3. Assume that the 1:1 resonance on E\u03b5h,k is destroyed, let \u03b3\n\u03b5\nh,k and \u03c3\n\u03b5\nh,k be the\neigenvalues of \u2206\u03b5h,k and |Re(\u03b3\u03b5h,k \u2212 \u03c3\u03b5h,k)| = \u03b5. Then the momentum J\u03b5h,k drifts by O(k) on\na time scale of O(1\/\u03b5) for generic O(1) initial data in E\u03b5h,k.\nRemark 6.4. Assume that the grid consists of M equal blocks of N\/M grid points for some\nM dividing N . Then the discrete Laplacian \u2206h is ZM -equivariant where the ZM -symmetry\nis generated by the shift uh,j 7\u2192 uh,j+N\/M . By representation theory [7], all eigenspaces of\n\u2206h with a faithful Z`-action for some ` \u2265 3 (where ` divides M) are two-dimensional. This\nZ`-action enforces an interpolating S1-symmetry and corresponding conserved momentum\nmaps on these eigenspaces. Since the shift uh,j 7\u2192 uh,j+N\/M generates a faithful Z`-action\nwith ` \u2265 3 on the first M non-constant eigenmodes of \u2206h (for N odd) the momentum\nmaps Jh,k from (6.19), k = 1, . . . ,M , are conserved. The form (3.17) of Jh then implies\nthe conservation of the interpolated momentum Jh on the first M eigenmodes of \u2206h. If the\ninitial value of the continuous system is smooth so that its Fourier modes decay fast, then\nthis implies approximate momentum conservation of the discretization.\nLet J\u03b5h : Qh \u00d7 Qh \u2192 R be defined by J\u03b5h|E\u03b5h,k\u00d7E\u03b5h,k = J\u03b5h,k. Applying Lemma 6.3 and\nnoting that any consistent momentum is O(h + \u03b5)-close to J \u03b5h, we obtain the following (see\nalso Figure 9).\nTheorem 6.4. Consider a non-uniform discretization of the linear wave equation and let\nthe stepsizes be selected such that the discrete Laplacian \u2206\u03b5h has at least one pair of simple\neigenvalues \u03b3\u03b5h,k 6= \u03c3\u03b5h,k, \u03b3\u03b5h,k, \u03c3\u03b5h,k \u2248 \u03bbh,k 6= 0, and choose the grid distortion parameter \u03b5\nproportional to the eigenvalue splitting, i.e., such that \u03b5 = |\u03b3\u03b5h,k \u2212 \u03c3\u03b5h,k|. Then for generic\nO(1) initial data, any consistent discrete momentum drifts by O(1) on a time scale of O(1\/\u03b5).\n7 Momentum error bounds\nIn this section we provide rigorous upper bounds on the momentum drift for the semilinear\nwave equation under the variational semidiscretization (3.9) on a uniform grid and thereby\nprove Theorem 1.1. To this end, we first establish well-posedness of both the semilinear wave\nequation (2.2) and the modified system (5.8) in appropriate spaces of analytic functions. We\nthen estimate the difference between the semidiscrete system and its modified equation. Since\nthe modified system conserves momentum exactly, it follows that the discrete momentum is\npreserved up to exponentially small error. In this section we need only consider uniform\ngrids, because we have shown in Theorem 6.4 that on non-uniform grids momentum is not\neven approximately conserved for linear systems.\n7.1 Spaces of analytic functions\nWe work in spaces of functions that are analytic on the open strip of radius r in the complex\nplane about the real (mod 2pi) axis. Such functions are characterized by the exponential\ndecay of their Fourier coefficients (see, for example, the review in [13]). For real numbers\n25\nm \u2265 0 and r \u2265 0, let Gr,m(S1,Rn) denote the space of functions for which the norm\n\u2016u\u20162Gr,m = |u\u02c60|2 +\n\u2211\nk\u2208Z\\{0}\n|k|2m e2r|k| |u\u02c6k|2 (7.1)\nis finite. It is a Hilbert space with respect to the inner product\n\u3008u, v\u3009Gr,m = u\u02c60 v\u02c60 +\n\u2211\nk\u2208Z\\{0}\n|k|2m e2r|k| u\u02c6k v\u02c6k . (7.2)\nIn the main text we assume that the nonlinearity f is an entire function, and will remark on\nnecessary modifications for non-analytic nonlinearities where appropriate. Let\nf(z) =\n\u221e\u2211\nn=0\nan z\nn (7.3)\nbe the power series representation of f and let \u03c6 : R \u2192 R be its majorization\n\u03c6(z) =\n\u221e\u2211\nn=1\n|an| zn . (7.4)\nAs f is entire, so must be \u03c6. Moreover, \u03c6 is monotonically increasing on the positive real\naxis. We quote two results from Ferrari and Titi [6].\nLemma 7.1. The space Gr,m(S1) is a topological algebra for every r \u2265 0 and m > 1\/2.\nSpecifically, there exists a constant c = c(m) such that for every u, v \u2208 Gr,m(S1) the product\nuv \u2208 Gr,m(S1) with\n\u2016uv\u2016Gr,m \u2264 c \u2016u\u2016Gr,m \u2016v\u2016Gr,m . (7.5)\nApplying the algebra inequality to each term of the power series expansion of f , one\nimmediately obtains the following.\nLemma 7.2. Let f be entire, and let \u03c6 majorize f in the sense of (7.4). Assume further\nthat u \u2208 Gr,m(S1) for r \u2265 0 and m > 1\/2. Then f(u) \u2208 Gr,m(S1), and\n\u2016f(u)\u2016Gr,m \u2264 \u03c6\n(\nc \u2016u\u2016Gr,m\n)\n, (7.6)\nwhere c = c(m) is as in Lemma 7.1.\nWe prove the following extension of this lemma.\nLemma 7.3. Under the assumptions of Lemma 7.2, let u, v \u2208 Gr,m(S1). Then\n\u2016f(u)\u2212 f(v)\u2016Gr,m \u2264 12\n(\n\u03c6\u2032\n(\nc \u2016u\u2016Gr,m\n)\n+ \u03c6\u2032\n(\nc \u2016v\u2016Gr,m\n)) \u2016u\u2212 v\u2016Gr,m , (7.7)\nwhere c = c(m) is as in Lemma 7.1.\nRemark 7.1. We use the letter c for universal constants, and K for constants which may\ndepend on the initial data, but are independent of h and t at least for an interval of time\non which a bounded analytic solution to the semilinear wave equations exists. Numbered\nconstants are unique throughout the paper.\n26\nProof. Observe that\nun \u2212 vn = (u\u2212 v)\nn\u22121\u2211\nk=0\nuk vn\u22121\u2212k . (7.8)\nTherefore,\nf(u)\u2212 f(v) = (u\u2212 v)\n\u221e\u2211\nn=1\nan\nn\u22121\u2211\nk=0\nuk vn\u22121\u2212k , (7.9)\nso that\n\u2016f(u)\u2212 f(v)\u2016Gr,m \u2264 \u2016u\u2212 v\u2016Gr,m\n\u221e\u2211\nn=1\n|an| cn\u22121\nn\u22121\u2211\nk=0\n\u2016u\u2016kGr,m \u2016v\u2016n\u22121\u2212kGr,m\n\u2264 \u2016u\u2212 v\u2016Gr,m\n\u221e\u2211\nn=1\n|an| cn\u22121\nn\u22121\u2211\nk=0\n(\nk\nn\u2212 1 \u2016u\u2016\nn\u22121\nGr,m +\nn\u2212 1\u2212 k\nn\u2212 1 \u2016v\u2016\nn\u22121\nGr,m\n)\n= \u2016u\u2212 v\u2016Gr,m\n\u221e\u2211\nn=1\n|an| cn\u22121 n\n2\n(\u2016u\u2016n\u22121Gr,m + \u2016v\u2016n\u22121Gr,m) , (7.10)\nwhere, in the second step, we have used the Young inequality\nx\u03bb y1\u2212\u03bb \u2264 \u03bbx+ (1\u2212 \u03bb) y (7.11)\nfor any \u03bb \u2208 [0, 1]. Comparing the last expression in (7.10) with the definition of \u03c6, we find\n(7.7).\n7.2 Functional setting for the wave equation\nWe rewrite the semilinear wave equation (2.2) in vector notation,\n\u2202tU = AU +B(U) , (7.12)\nwhere U = (u, v),\nA =\n(\n0 id\n\u2206 0\n)\n, B(U) =\n(\n0\nf(u)\n)\n. (7.13)\nWe first collect some elementary facts about the linear operator A. Since \u2206 is diagonal\nwith respect to the Fourier basis eikx and has respective eigenvalues \u03bbk = \u2212k2, the restriction\nof A to the kth eigenspace, denoted Ak, has the Fourier representation\nA\u02c6k =\n(\n0 1\n\u03bbk 0\n)\n. (7.14)\nWhen \u03bbk 6= 0, Ak has a pair of distinct complex conjugate eigenvalues \u00b1i\u00b5k where \u00b5k =\u221a\n|\u03bbk| = |k|, and exp(Akt) has the Fourier representation\neA\u02c6kt =\n(\ncos\u00b5kt \u00b5\n\u22121\nk sin\u00b5kt\n\u2212\u00b5k sin\u00b5kt cos\u00b5kt\n)\n. (7.15)\n27\nFor k = 0 we have \u00b5k = 0, so that the Fourier representation of A0 is a Jordan block, and\neA\u02c60t =\n(\n1 t\n0 1\n)\n. (7.16)\nWe introduce the Hilbert space\nY r,m = Gr,m+1 \u00d7Gr,m , (7.17)\nwhere both components are endowed with the standard inner product (7.2). In particular,\nY 0,0 = H1 \u00d7L2. As we will provide a mirror functional setting for the modified equation, it\nis useful to note that\nGr,m+1 = {u \u2208 Gr,m : (\u2212\u2206)1\/2u \u2208 Gr,m} , (7.18)\nwhere the projection of (\u2212\u2206)1\/2 onto the kth eigenspace has Fourier multiplier \u00b5k = |k|. We\nthen write the inner product as\n\u3008u, v\u3009Gr,m+1 = \u3008u, P 0v\u3009Gr,m \u2212 \u3008u,\u2206v\u3009Gr,m . (7.19)\nwhere P 0 denotes the orthogonal projector onto the generalized eigenspace corresponding to\nthe zero eigenvalue of \u2206. We set Q0 = 1\u2212 P 0.\nThe crucial observation is that the group generated by Q0A is unitary on any Y r,m:\n\u2016eQ0AtU\u2016Y r,m = \u2016U\u2016Y r,m . (7.20)\nNote that the full group eAt is not unitary because of the secular term from the Jordan block\n(7.16).\nTo make sense of the full semilinear wave equation (7.12), we introduce its mild formula-\ntion\nU(t) = etAU0 +\n\u222b t\n0\ne(t\u2212s)AB(U(s)) ds . (7.21)\nSince our nonlinearity is Lipshitz in Gr,m by Lemma 7.3, we obtain by direct application of\nthe contraction mapping theorem [24, 11] that the semilinear wave equation is locally well\nposed.\nTheorem 7.4. Let U0 \u2208 Y r,m with r,m \u2265 0. Then there exists a time T which depends\nonly on the Y r,m norm of the initial data and a solution U \u2208 C([0, T ];Y r,m) to the mild\nformulation (7.21).\nRemark 7.2. This theorem provides the functional setting in which the formal statements\nabout momentum conservation in Section 2 can be justified. Specifically, if U0 \u2208 Y 0,0 \u2261\nH1 \u00d7 L2, the momentum J is well-defined. We can thus approximate U0 by a sequence\nof smooth functions for which the manipulations in (2.7) can be carried out on a uniform\ninterval of time, and finally pass to the limit.\nRemark 7.3. The statement remains true if f : S \u2192 R is analytic on some open convex subset\nS \u2286 R provided the u-component of the initial data lies in S. Then f maps Sr,m to Gr,m,\nwhere\nSr,m = {u \u2208 Gr,m(S1) : u(x) \u2208 S} , (7.22)\n28\nas can be seen by Taylor expanding f . Moreover f is still a Lipshitz map, since\n\u2016f(u)\u2212 f(v)\u2016Gr,m \u2264\n\u222b 1\n0\n\u2016f \u2032(u+ t(v \u2212 u)) (u\u2212 v)\u2016Gr,m dt\n\u2264 c(m) sup\nt\u2208[0,1]\n\u2016f \u2032(u+ t(v \u2212 u))\u2016Gr,m \u2016u\u2212 v\u2016Gr,m , (7.23)\nwhere we used the algebra inequality (7.5). Note that pointwise evaluation of u makes sense\nbecause under the assumptions of Theorem 7.4 u is at least H1 and therefore, by the Sobolev\nembedding theorem, continuous.\nRemark 7.4. If f is only of class Cm+1, all of the above holds with r = 0, and we find that\nthe semilinear wave equation is locally well posed on Y 0,m. In particular, for r = m = 0 we\nrecover the well known existence of local weak solutions to the semilinear wave equation in\nY 0,0 = H1 \u00d7 L2, see [24].\n7.3 Functional setting for the modified system\nThe above construction can be adapted to the modified equation by literally replacing all\nquantities by their discrete-interpolated counterparts. We write the general modified equation\non an equispaced grid as\n\u2202tU\u02dc = A\u02dchU\u02dc +Bh(U\u02dc) , (7.24)\nwhere U\u02dc = (u\u02dc, v\u02dc),\nA\u02dch =\n(\n0 id\n\u2206\u02dch 0\n)\n, Bh(U) =\n(\n0\n(1\u2212 \u03b1) f(u) + \u03b1f(\u03c4hu)\n)\n, (7.25)\nand \u2206\u02dch denotes the discrete Laplacian\n\u2206\u02dchu(x) =\nu(x\u2212 h)\u2212 2u(x) + u(x+ h)\nh2\n. (7.26)\nIt is clear that \u2206\u02dch maps G\nr,m(S1) into itself because the translation operator \u03c4h does. More-\nover, \u2212\u2206\u02dch is a non-negative, self-adjoint operator with respect to the L2 inner product and\nhas a complete orthonormal set of eigenfunctions\u2014the Fourier modes eikx. Indeed, since\n(\u03c4hu)\u02c6 k = e\nihku\u02c6k, we have\n(\u0302\u2206\u02dchu)k =\ne\u2212ikh \u2212 2 + eikh\nh2\nu\u02c6k =\n2\nh2\n(cos(hk)\u2212 1) u\u02c6k . (7.27)\nFollowing the construction in Section 7.2, we write P\u02dc 0h to denote the spectral projector\nonto the\u2014now infinite dimensional\u2014generalized zero-eigenspace of A\u02dch, set Q\u02dc\n0\nh = 1\u2212 P\u02dc 0h , and\nintroduce the Hilbert space\nGr,mh = {u \u2208 Gr,m : (\u2212\u2206\u02dch)1\/2u \u2208 Gr,m} (7.28)\nendowed with inner product\n\u3008u, v\u3009Gr,m\nh\n= \u3008u, P\u02dc 0hv\u3009Gr,m \u2212 \u3008u, \u2206\u02dchv\u3009Gr,m . (7.29)\nWhen restricted to the grid, Gr,mh is called the discrete Gevrey space [15].\n29\nRemark 7.5. Since the spectrum of \u2206\u02dch is bounded, G\nr,m\nh = G\nr,m and the corresponding\nnorms are equivalent, though not uniformly in h. In fact, it is easy to check that\n\u2016u\u2016Gr,m \u2264 \u2016u\u2016Gr,m\nh\n\u2264\n\u221a\n2\nh\n\u2016u\u2016Gr,m . (7.30)\nWe now set Y r,mh = G\nr,m\nh \u00d7Gr,m and note that, as in the fully continuous case, the group\ngenerated by Q\u02dc0hA\u02dch is unitary on this space:\n\u2016eQ\u02dc0hA\u02dchtU\u2016Y r,m\nh\n= \u2016U\u2016Y r,m\nh\n. (7.31)\nWe immediately obtain the analog of Theorem 7.4.\nTheorem 7.5. Let U\u02dc0 \u2208 Y r,mh with r \u2265 0 and m > 1\/2. Then there exists a time T which\ndepends only on the Y r,mh -norm of the initial data and a solution U\u02dc \u2208 C([0, T ];Y r,mh ) to the\nmild formulation of the modified equation (7.24).\nRemark 7.6. As a consequence of the above, the semilinear wave equation and the modified\nsystems are well posed on different spaces, a necessary complication we need to overcome\nwhen estimating differences between exact and modified solutions.\nRemark 7.7. As for the semilinear wave equation (see Remarks 7.3 and 7.4), Theorem 7.5\nremains true if f is only defined on an open subset S of R, or if f is only Cm+1 and r = 0.\n7.4 Difference between wave equation and modified system\nWe first estimate the Gr,m-difference between the true solution of the semilinear wave equa-\ntion and the solution of the modified equation starting from the same initial data.\nLemma 7.6. Let m > 1\/2 and r \u2265 0. Let U(t) be a solution of the semilinear wave equation\n(7.12) and U\u02dc(t) be a solution of the modified system (7.24) with U\u02dc(0) = U(0). Assume that\n\u2016U(t)\u2016Gr,m+4 \u2264 K for t \u2208 [0, T ]. Then there exist constants K1 = K1(K), K2 = K2(K) and\nh0(K,T ) > 0 such that\n\u2016U(t)\u2212 U\u02dc(t)\u2016Gr,m \u2264 K1 (h2 + \u03b1h) (eK2t \u2212 1) (7.32)\nfor 0 \u2264 t \u2264 T and h \u2264 h0(K,T ).\nProof. Let E(t) = U(t) \u2212 U\u02dc(t) denote the \u201cmodification error\u201d, and subtract (7.24) from\n(7.12) to find\n\u2202tE = AU \u2212 A\u02dchU\u02dc +B(U)\u2212Bh(U\u02dc)\n= (A\u2212 A\u02dch)U + A\u02dchE +B(U)\u2212Bh(U\u02dc) , (7.33)\nand therefore\n\u2202t(e\n\u2212tQ\u02dc0hA\u02dchE) = e\u2212tQ\u02dc\n0\nhA\u02dch(A\u2212 A\u02dch)U + P\u02dc 0h A\u02dchE + e\u2212tQ\u02dc\n0\nhA\u02dch(B(U)\u2212Bh(U\u02dc)) . (7.34)\n30\nTaking the Y r,mh inner product with exp(\u2212tQ\u02dc0hA\u02dch)E, we find\n1\n2\nd\ndt\n\u2016e\u2212tQ\u02dc0hA\u02dchE\u20162Y r,m\nh\n= \u3008e\u2212tQ\u02dc0hA\u02dchE, e\u2212tQ\u02dc0hA\u02dch(A\u2212 A\u02dch)U\u3009Y r,m\nh\n+ \u3008e\u2212tQ\u02dc0hA\u02dchE, e\u2212tQ\u02dc0hA\u02dch(B(U)\u2212Bh(U\u02dc) + P\u02dc 0h A\u02dchE)\u3009Y r,mh . (7.35)\nAccording to (7.31), exp(\u2212tQ\u02dc0hA\u02dch) preserves the Y r,mh norm. We thus estimate\n1\n2\nd\ndt\n\u2016E\u20162Y r,m\nh\n\u2264 \u2016E\u2016Y r,m\nh\n\u2016(A\u2212 A\u02dch)U\u2016Y r,m\nh\n+ \u2016E\u2016Y r,m\nh\n\u2016(B(U)\u2212Bh(U\u02dc))\u2016Y r,m\nh\n+ \u2016E\u2016Y r,m\nh\n\u2016P\u02dc 0h A\u02dchE\u2016Y r,m\nh\n. (7.36)\nSince \u2016P\u02dc 0h A\u02dchE\u2016Y r,m\nh\n\u2264 \u2016E\u2016\nY r,m\nh\n, we obtain\nd\ndt\n\u2016E\u2016Y r,m\nh\n\u2264 \u2016(A\u2212 A\u02dch)U\u2016Y r,m\nh\n+ \u2016B(U)\u2212Bh(U\u02dc)\u2016Y r,m\nh\n+ \u2016E\u2016Y r,m\nh\n. (7.37)\nThe first term on the right is the local discretization error. It can be estimated straightfor-\nwardly by writing out a Taylor expansion with integral remainder for\n\u2206\u02dchu(x)\u2212\u2206u(x) = 1\nh2\n1\n3!\n\u222b h\n0\nu(4)(x+ \u03be) (h\u2212 \u03be)3 d\u03be\n+\n1\nh2\n1\n3!\n\u222b \u2212h\n0\nu(4)(x+ \u03be) (h+ \u03be)3 d\u03be , (7.38)\nand taking its Gr,m norm, so that\n\u2016(A\u2212 A\u02dch)U\u2016Y r,m\nh\n= \u2016\u2206\u02dchu\u2212\u2206u\u2016Gr,m \u2264\n2\n4!\nh2 \u2016u(4)\u2016Gr,m \u2264 h2 K3 , (7.39)\nwhere K3 = 2K\/4!. The last term on the right of (7.37) is estimated using Lemma 7.3 and\nthe monotonicity of \u03c6: We have\n\u2016f(u)\u2212 f(u\u02dc)\u2016Gr,m \u2264 12\n(\n\u03c6(c \u2016u\u2016Gr,m) + \u03c6(c \u2016u\u02dc\u2016Gr,m)\n) \u2016u\u2212 u\u02dc\u2016Gr,m\n\u2264 12\n(\n\u03c6(c \u2016U\u2016Gr,m) + \u03c6(c \u2016U\u2016Gr,m + c \u2016E\u2016Gr,m)\n) \u2016E\u2016Gr,m\n\u2264 \u03c6(2cK) \u2016E\u2016Gr,m (7.40)\nfor as long as \u2016E\u2016Gr,m \u2264 K. Thus,\n\u2016B(U)\u2212Bh(U\u02dc)\u2016Gr,m \u2264 (1\u2212 \u03b1) \u2016f(u)\u2212 f(u\u02dc)\u2016Gr,m + \u03b1 \u2016f(u)\u2212 f(\u03c4hu\u02dc)\u2016Gr,m\n\u2264 \u2016f(u)\u2212 f(u\u02dc)\u2016Gr,m + \u03b1 \u2016f(u\u02dc)\u2212 f(\u03c4hu\u02dc)\u2016Gr,m\n\u2264 \u03c6(2cK) \u2016E\u2016Gr,m + \u03b1\u03c6(2cK)h \u2016u(1)\u2016Gr,m\n\u2264 \u03c6(2cK) \u2016E\u2016Y r,m\nh\n+ \u03b1\u03c6(2cK)K h . (7.41)\nAltogether, the differential inequality (7.37) reads\nd\ndt\n\u2016E\u2016Y r,m\nh\n\u2264 K3 h2 +K4 \u03b1h+K2 \u2016E\u2016Y r,m\nh\n, (7.42)\n31\nwhere K2 = 1 + \u03c6(2cK) and K4 = K \u03c6(2cK). Since E(0) = 0, integration in time yields\n\u2016E\u2016Y r,m\nh\n\u2264 K3h\n2 + \u03b1K4h\nK2\n(eK2t \u2212 1) \u2264 K1 (h2 + \u03b1h) (eK2t \u2212 1) (7.43)\nwith some appropriately chosen constant K1. Provided we choose h small enough that\nK1 (h\n2 + \u03b1h) (eK2T \u2212 1) \u2264 K , (7.44)\nthe estimate remains consistent with our a priori requirement \u2016E\u2016Gr,m \u2264 K. This completes\nthe proof.\nRemark 7.8. An estimate similar to Lemma 7.6 holds for the difference between exact and\nnumerical solution\u2014they are O(h) close when \u03b1 6= 0 and O(h2) close when \u03b1 = 0: Taking\nr = 0 and m = 1 in (7.32) and using the Sobolev embedding theorem \u2016u\u2016C0 \u2264 c \u2016u\u2016H1 , we\nestimate the discretization error\n\u2016pihU(t)\u2212 Uh(t)\u2016R2N \u2264 cK1 (h2 + \u03b1h) (eK2t \u2212 1) (7.45)\nfor 0 \u2264 t \u2264 T and h \u2264 h0(K,T ). On the other hand, the difference between modified equation\nand numerical solution is much smaller\u2014in fact exponentially small in the H1 norm for as\nlong as the exact solution remains analytic. This will be proved in the following.\nRemark 7.9. Estimate (7.45) by no means implies that every invariant set of the discrete\nsystem has a continuous counterpart. For example, in [12] discrete traveling waves of the\nspace-discretization are constructed which do not exist for the continuous system.\nRemark 7.10. Lemma 7.6 also holds if f is only defined on some open convex subset S of R.\nThe proof has to be modified as follows: (7.40) has to be replaced by\n\u2016f(u)\u2212 f(u\u02dc)\u2016Gr,m \u2264 K(r,m) \u2016E\u2016Gr,m (7.46)\nwhere we use an estimate similar to (7.23) and\nK(r,m) = c(m) sup\n(u,v)\u2208Kr,m\n\u2016f \u2032(u)\u2016Gr,m . (7.47)\nHere Kr,m is a bounded closed subset of Sr,m, with Sr,m the same as in (7.22), containing\na tube of radius KS > 0 around {U(t) : 0 \u2264 t \u2264 T}. Such a set exists, because KS satisfies\ndist(U(t), \u2202Sr,m) \u2265 KS , and, since {U(t) : 0 \u2264 t \u2264 T} is closed and Sr,m is an open subset\nof Gr,m, by the openness of S in R we can always find such KS > 0 and consequently also a\nset Kr,m with the required properties. Moreover the constant K with \u2016E(t)\u2016Gr,m \u2264 K which\nfirst appears in (7.40) has to be replaced by KS and the constant \u03c6(2cK) appearing in (7.41)\nby K(r,m). In this case we have K2 = 1 +K(r,m) and K4 = KK(r,m) in (7.42).\nLikewise, Lemma 7.6 holds with r = 0 if f is only Cm+1, m \u2208 N.\n7.5 Difference between discrete and modified system\nWe need the following version of the Shannon Sampling Theorem.\n32\nLemma 7.7. Let u \u2208 Gr,m with r \u2265 0 and m > 1\/2. Then\n\u2016(1\u2212 ih \u25e6 pih)u\u2016H1 \u2264 c1(m)hm\u22123\/2 \u2016u\u2016Hm . (7.48)\nMoreover, if r > 0, then\n\u2016(1\u2212 ih \u25e6 pih)u\u2016H1 \u2264 c2(r,m)hm\u22121 e\u2212pir\/h \u2016u\u2016Gr,m , (7.49)\nfor appropriate constants c1(m) and c2(r,m).\nProof. By definition, the Fourier coefficients of the trigonometric interpolant of the grid\nprojection ih \u25e6 pih(u) are (ih \u25e6 pihu)\u02c6 k = u\u02c6h,k. Recall the aliasing formula\nu\u02c6k \u2212 u\u02c6h,k =\n\u2211\n`\u2208Z\n`6=0\nu\u02c6k+`N (7.50)\nwhich follows from\nu\u02c6h,k =\nh\u221a\n2pi\nN\u22121\u2211\nj=0\ne\u2212ikxj u(xj) =\n1\nN\nN\u22121\u2211\nj=0\ne\u2212ihjk\n\u2211\n`\u2208Z\nu\u02c6` e\nihj`\n=\n\u2211\n`\u2208Z\nu\u02c6`\n1\nN\nN\u22121\u2211\nj=0\ne2pii(`\u2212k)j\/N =\n\u2211\n`\u2208Z\nu\u02c6k+`N . (7.51)\nNoting that\n\u2211\na2i \u2264 (\n\u2211\nai)\n2\nwhen all the coefficients ai are positive, we write\n\u2016u\u2212 (ih \u25e6 pih)u\u20162H1 \u2264\n[N\/2]\u2211\nk=\u2212[(N\u22121)\/2]\n(1 + |k|2) |u\u02c6h,k \u2212 u\u02c6k|2\n+\n\uf8eb\n\uf8ed \u2211\nk<\u2212[(N\u22121)\/2]\n+\n\u2211\nk\u2265[N\/2]\n\uf8f6\n\uf8f8 (1 + |k|2) |u\u02c6k|2\n\u2264\n[N\/2]\u2211\nk=\u2212[(N\u22121)\/2]\n(1 + |k|2)\n\uf8eb\n\uf8ec\uf8ed\u2211\n`\u2208Z\n`6=0\n|u\u02c6k+`N |\n\uf8f6\n\uf8f7\uf8f8\n2\n+\n\u2211\n|k|\u2265[(N\u22121)\/2]\n(1 + |k|2) |u\u02c6k|2\n\u2264\n(\n1 +\nN2\n4\n) \uf8eb\uf8ed \u2211\n|k|\u2265n\n|u\u02c6k|\n\uf8f6\n\uf8f8\n2\n+\n\u2211\n|k|\u2265n\n(1 + |k|2) |u\u02c6k|2 , (7.52)\nwhere n = [(N \u2212 1)\/2]. The second term on the right is the projection error, which has the\nstraightforward upper bound\n\u2211\n|k|\u2265n\n(1 + |k|2) |u\u02c6k|2 \u2264 n\u22122(m\u22121) e\u22122rn\n\u2211\n|k|\u2265n\n|k|2(m\u22121) (1 + |k|2) e2r|k| |u\u02c6k|2 . (7.53)\nNoting that h = 2pi\/N , we obtain a term of the form which can be estimated by the term on\nthe right of (7.48) or (7.49) for r = 0 and r > 0, respectively.\n33\nThe first term on the right of (7.52) is the aliasing error. When r = 0, we estimate\n\uf8eb\n\uf8ed \u2211\n|k|\u2265n\n|u\u02c6k|\n\uf8f6\n\uf8f8\n2\n=\n\uf8eb\n\uf8ed \u2211\n|k|\u2265n\n|k|\u2212m |k|m |u\u02c6k|\n\uf8f6\n\uf8f8\n2\n\u2264\n\u2211\n|k|\u2265n\n|k|\u22122m\n\u2211\n|k|\u2265n\n|k|2m |u\u02c6k|2\n\u2264 2\n2m\u2212 1 (n\u2212 1)\n1\u22122m \u2016u\u20162Hm , (7.54)\nthereby obtaining the second term on the right of (7.48). The first inequality in (7.54) is a\ndirect application of the Cauchy\u2013Schwarz inequality, and the second inequality follows from\nan integral upper bound on the left sum. When r > 0, a similar argument yields\n\uf8eb\n\uf8ed \u2211\n|k|\u2265n\n|u\u02c6k|\n\uf8f6\n\uf8f8\n2\n\u2264\n\u2211\n|k|\u2265n\n|k|\u22122m e\u22122r|k|\n\u2211\n|k|\u2265n\n|k|2m e2r|k| |u\u02c6k|2\n\u2264 2n\u22122m\n\u222b \u221e\nn\u22121\ne\u22122r\u03ba d\u03ba \u2016u\u20162Gr,m\n\u2264 n\u22122m e\n2r(1\u2212n)\nr\n\u2016u\u20162Gr,m . (7.55)\nSubstituting this expression back into (7.52), we obtain (7.49).\nLemma 7.8. Let r > 0 and let U\u02dc denote the solution to the modified equation with initial\ndata U\u02dc(0), and Uh the numerical solution with initial data Uh(0) = pih \u25e6 U\u02dc(0). Assume that\n\u2016U\u02dc(t)\u2016Gr,m \u2264 K\u02dc for t \u2208 [0, T ]. Then there exists a constant K5 = K5(K\u02dc, r) such that\n\u2016U\u02dc(t)\u2212 ih \u25e6 Uh(t)\u2016H1 \u2264 K5 hm\u22121 e\u2212pir\/h , (7.56)\nfor t \u2208 [0, T ].\nProof. The modified solution is identical to the numerical solution on grid points. Hence,\nU\u02dc \u2212 ih \u25e6 Uh = (1\u2212 ih \u25e6 pih)U\u02dc + ih \u25e6 (pih \u25e6 U\u02dc \u2212 Uh) = (1\u2212 ih \u25e6 pih)U\u02dc . (7.57)\nWe use (7.49) to bound this expression, noting that \u2016U\u02dc(t)\u2016Gr,m \u2264 K\u02dc.\nNote that there is no accumulation of error with time for as long as the modified solution\nremains in some bounded set of Gr,m. The only source of error in (7.56) is the exponentially\nsmall local interpolation error.\n7.6 Approximate momentum conservation\nWe now use the bound on the distance between the semidiscrete and modified system to prove\nthat the semidiscrete momentum will also remain close to the momentum of the modified\nsystem. Since the latter is constant in the variational case, i.e., when \u03b1 = 0, the corresponding\nsemidiscrete system has exponentially small momentum drift.\n34\nTheorem 7.9. Let U\u02dc denote the solution to the modified equation with initial data U\u02dc(0), and\nUh denote the numerical solution with corresponding discrete initial data Uh(0) = pih \u25e6 U\u02dc(0).\nAssume that \u2016U\u02dc(t)\u2016Gr,m \u2264 K\u02dc with m > 1\/2 and r > 0 on some time interval [0, T ]. Then\n|J \u25e6 ih \u25e6 Uh(t)\u2212 J \u25e6 U\u02dc(t)| \u2264 K6 hm\u22121 e\u2212pir\/h , (7.58)\nfor t \u2208 [0, T ] and K6 = K6(K\u02dc). When \u03b1 = 0, i.e., when then method is variational, this\nimplies\n|J \u25e6 ih \u25e6 Uh(t)\u2212 J \u25e6 U(0)| \u2264 K6 hm\u22121 e\u2212pir\/h . (7.59)\nProof. Recall that Jh = J \u25e6 ih and use the mean value theorem to estimate\n|J \u25e6 U\u02dc \u2212 J \u25e6 (ih \u25e6 Uh)| \u2264 sup\n\u2016V \u2016\nH1\u22642K\u02dc\n\u2016DJ(V )\u2016L(H1,R) \u2016U\u02dc \u2212 ih \u25e6 Uh\u2016H1\n\u2264 K6 hm\u22121 e\u2212pir\/h , (7.60)\nwhere the exponential error term comes from Lemma 7.8, DJ denotes the Fre\u00b4chet derivative\nof J , h is chosen small enough that \u2016U\u02dc \u2212 ih \u25e6 Uh\u2016H1 \u2264 K\u02dc, and\n|DJ(U)U\u00af | =\n\u2223\u2223\u2223\u2223\n\u222b\nS1\n(v \u2202xu\u00af+ v\u00af \u2202xu) dx\n\u2223\u2223\u2223\u2223 \u2264 \u2016U\u2016H1 \u2016U\u00af\u2016H1 , (7.61)\nwith U = (u, v) and U\u00af = (u\u00af, v\u00af). Since the momentum is conserved by the modified system\nfor \u03b1 = 0, J \u25e6 U\u02dc(t) = J \u25e6 U(0), and we obtain (7.59).\nProof of Theorem 1.1. The conclusions of Lemma 7.8 and Theorem 7.9 remain valid so\nlong as U(t) has a Gr,m+4 bound of the form \u2016U(t)\u2016Gr,m+4 \u2264 K, say. Then we know by\nLemma 7.6 that U and U\u02dc remain Gr,m close for some interval of time on which, in particular,\n\u2016U\u02dc(t)\u2016Gr,m \u2264 K\u02dc. We have thus proved Theorem 1.1 with \u03ba(u) = K6.\nRemark 7.11. We have seen in (5.15) that the modified system for the non-Lagrangian dis-\ncretization on the uniform grid does not conserve momentum. The general momentum error\nestimate (7.58) thus implies that the non-Lagrangian semidiscrete system cannot approxi-\nmately conserve momentum.\nRemark 7.12. Note that the closeness of the continuous solution and the solution of the\nmodified system can only be guaranteed on finite time intervals with errors that grow expo-\nnentially in T , see Lemma 7.6. Consequently, if the norm of the continuous solution is used\nto establish the required bound on the solution of the modified system in Theorem 7.9 then\nthe stepsizes h \u2264 h0(K,T ) must decrease exponentially with T according to (7.44).\nRemark 7.13. When r = 0, we need to estimate the sampling error using inequality (7.48).\nThe statements of Lemma 7.8 and Theorem 7.9 remain true\u2014with different constants\u2014\nprovided we replace hm\u22121 by hm\u22123\/2. Likewise Theorem 1.1 remains true with e\u2212pir\/h re-\nplaced by hm\u22123\/2. Moreover Theorems 7.9 and 1.1 also apply if f is only defined on an open\nconvex subset of R or if f is only Cm+1, m \u2208 N, and r = 0, see Remarks 7.3, 7.4, 7.7 and 7.10.\nRemark 7.14. The estimate in Theorem 7.9 can be re-written as\n|Jh(Uh(t))\u2212 Jh(Uh(0))| \u2264 K6 hm\u22121 e\u2212pir\/h, , (7.62)\n35\nprovided the solution U(t) of the semilinear wave equation with U(0) = ih \u25e6 Uh(0) satisfies\n\u2016U(t)\u2016Gr,m+4 \u2264 K. Now let J\u02dch be another momentum discretization, consistent in the sense\nthat\n|J(U)\u2212 J\u02dch(pihU)| \u2264 c h \u2016U\u2016Hm (7.63)\nfor some m \u2208 N. When m = 3 so that u \u2208 H3 \u2286 C2 we could, for example, take the first\norder or symmetric finite difference momenta from Section 6.2. Then J\u02dch will remain within\nsome bounded distance of the interpolated momentum Jh so long as \u2016U(t)\u2016Gr,m+4 \u2264 K, and\nwill therefore be approximately conserved over that time interval. More specifically, by the\ntriangle inequality, we have the estimate\n|J\u02dch(Uh(t))\u2212 Jh(Uh(0))| \u2264 K6 hm\u22121 e\u2212pir\/h + 2chK\u02dc , (7.64)\nwith \u2016U\u02dc(t)\u2016Hm \u2264 K\u02dc.\n8 Concluding Remarks\nWe have proved that for analytic initial values and Lagrangian uniform space discretizations\nof semilinear wave equations momentum is conserved up to an exponentially small error for as\nlong as the modified solution remains reasonably bounded, a condition which can be verified\nfor small stepsizes over finite time intervals if bounds on the continuous solution are given.\nMoreover, we have shown that for non-Lagrangian or non-uniform discretizations there is no\napproximate momentum conservation.\nAs mentioned in the introduction, our results are similar in spirit to the approximate\nconservation of energy of uniform stepsize Lagrangian integrators of ordinary differential\nequations. Here the approximate energy conservation is also destroyed by non-uniform step-\nsize selection [30] or non-symplectic integrators [29]. Both results, these and those in this\npaper, hold for uniform Lagrangian discretizations as long as the modified solution remains\nreasonably bounded. In both cases the norm of the modified solution can be estimated over\nfinite time intervals via the norm of the exact solution. If this boundedness assumption is sat-\nisfied, however, then the approximate momentum conservation holds for all times, not only on\nexponentially long time scales as does the approximate energy conservation for Hamiltonian\nODEs.\nIndeed, let \u03a8h be a one-step method for an analytic autonomous Hamiltonian ODE and\nlet \u03a6\u02dcht be the flow of an h-dependent autonomous Hamiltonian vector field with Hamiltonian\nHh approximating the dynamics of the one-step method. Then we have \u2016\u03a6\u02dchh(U0)\u2212\u03a8h(U0)\u2016 \u2264\nK1 exp(\u2212K2\/h) for U0 in some bounded domain S of phase space [22, 1, 9]. For the Hamilto-\nnianHh of the Hamiltonian flow \u03a6\u02dc\nh\nt we obtain |Hh(\u03a8h(U0))\u2212Hh(\u03a6\u02dchh(U0))| = K3 exp(\u2212K2\/h)\nfor U0 \u2208 S. Thus Hh is conserved over exponentially long times provided the iterates of\n\u03a8h(U0) and the modified solution \u03a6\u02dc\nh\nh(U0) stay in S.\nWe expect that the results in this paper can be extended to general semilinear Hamil-\ntonian partial differential equations in arbitrary space dimensions, general finite-difference\ndiscretizations, time-semidiscretizations (see [31]), and full space-time discretizations. More-\nover, similar methods should be applicable to multisymplectic conservation laws for energy\nand momentum, as have been formally derived in [21]. However, note that our modified sys-\ntem (5.8) does not satisfy a local conservation law for the momentum density j(u, v) = uxv\n36\nof the conserved momentum J . Moreover, the interpolated momentum Jh = J \u25e6 ih is non-\nlocal in the grid variables. In future work we will construct discrete momentum maps with\nlocal densities for which approximate local momentum conservation laws hold on finite time\nintervals.\nAcknowledgments\nWe thank Christian Lubich, Brian Moore, Sebastian Reich, Mark Roberts, and Steve Shkoller\nfor interesting and helpful discussions, Mark Roberts in particular for inviting us to the War-\nwick Symposium on Geometric Mechanics and Symmetry during which this project was\nstarted. CW was employed by the University of Warwick and on leave from the Freie Uni-\nversita\u00a8t Berlin during the time when this paper was written and acknowledges support and\nhospitality from both those institutions. The research of CW was supported by a Euro-\npean Union Marie Curie fellowship under contract number HPMF-CT-2000-00542, and MO\nacknowledges partial funding through SFB 386 at Tu\u00a8bingen University.\nReferences\n[1] G. Benettin and A. Giorgilli. On the Hamiltonian interpolation of near-to-the-\nidentity symplectic mappings with application to symplectic integration algorithms.\nJ. Statist. Phys. 74: 1117\u20131143, 1994.\n[2] T. Bridges and S. Reich. Multi-symplectic intergrators: numerical schemes for Hamil-\ntonian PDEs that conserve symplecticity. Phys. Lett. A 284: 184\u2013193, 2001.\n[3] G.H. Cottet. A new approach for the analysis of vortex methods in two and three\ndimensions. Ann. Analysis Nonlineaire Henri Poinc. 5: 227-285, 1988.\n[4] J. de Frutos and J.M. Sanz-Serna. Accuracy and conservation properties in numerical\nintegration: the case of the Korteweg-de Vries equation. Numerische Mathematik 75:\n421\u2013445, 1997.\n[5] P. Deuflhard and A. Hohmann. Numerical Analysis in Modern Scientific Computing:\nAn Introduction. Text in Applied Mathematics, Vol. 43, 2nd edition, Springer 2003.\n[6] A.B. Ferrari and E.S. Titi. Gevrey regularity for nonlinear analytic parabolic equations.\nCommun. Partial Differntial Equations 23: 1\u201316, 1998.\n[7] M. Golubitsky, D. Schaeffer, and I. Stewart. Singularities and Groups in Bifurcation\nTheory: Vol. II , Applied Mathematical Sciences 69, Springer, New York, 1988.\n[8] E. Hairer. Backward analysis of numerical integrators and symplectic methods. Annals\nof Numerical Mathematics 1:107\u2013132, 1994.\n[9] E. Hairer and C. Lubich. The life-span of backward error analysis for numerical inte-\ngrators. Numerische Mathematik 76(4):441\u2013462, 1997.\n[10] E. Hairer, C. Lubich and G. Wanner. Geometric numerical integration. Structure-\npreserving algorithms for ordinary differential equations. Springer, Berlin, 2002.\n37\n[11] D. Henry. Geometric Theory of Semilinear Parabolic Equations. Lecture Notes in Math-\nematics 840. Springer, New York, 1983.\n[12] G. Iooss and K. Kirchga\u00a8ssner. Travelling waves in a chain of coupled nonlinear oscillators.\nCommun. Math. Phys. 211: 439\u2013464, 2000.\n[13] C.D. Levermore and M. Oliver. The Complex Ginzburg-Landau Equation as a Model\nProblem. In Lectures in Applied Mathematics 31:141\u2013190, AMS, Providence, Rhode\nIsland, 1996.\n[14] A. Lew, J.E. Marsden, M. Ortiz and M. West. Asynchronous variational integrators.\nArch. Rat. Mech. Anal. (to appear), 2002.\n[15] G.J. Lord and A.M. Stuart. Discrete Gevrey regularity, attractors and upper-\nsemicontinuity for a finite difference approximation to the Ginzburg-Landau equation.\nNumer. Funct. Anal. and Optimiz. 16: 1003\u20131047, 1995.\n[16] J.E. Marsden and T.S. Ratiu. Introduction to Mechanics and Symmetry. Springer, New\nYork, Berlin, Heidelberg, 1994.\n[17] J.E. Marsden, G. Patrick and S. Shkoller. Multisymplectic geometry, variational inte-\ngrators, and nonlinear PDEs. Commun. Math. Physics 199: 351\u2013395, 1998.\n[18] J.E. Marsden and M. West. Discrete mechanics and variational integrators. Acta Num.\n10: 357\u2013514, 2001.\n[19] K. Matthies. Backward error analysis of a full discretisation scheme for a class of\nparabolic partial differential equations. Nonlinear Anal. Theory Methods Appl., 52:\n805\u2013826, 2003.\n[20] K. Matthies and A. Scheel. Exponential averaging of Hamiltonian evolution equations.\nTrans. AMS, to appear.\n[21] B. Moore and S. Reich. Backward error analysis for Hamiltonian PDEs with applications\nto nonlinear wave equations. Numer. Math., to appear.\n[22] A.I. Neishtadt. On the separation of motions in systems with rapidly rotating phase.\nJ. Appl. Math. Mech. 48: 134\u2013139, 1984.\n[23] M. Oliver and S. Shkoller. The vortex blob method as a second-grade non-Newtonian\nfluid. Commun. Partial Differential Equations 26: 295\u2013314, 2001.\n[24] A. Pazy. Semigroups of Linear Operators and Applications to Partial Differential Equa-\ntions. Applied Mathematical Sciences 44. Springer, New York, 1983.\n[25] S. Pekarsky and M. West. Discrete multisymplectic reduction and discrete Kelvin\u2019s\ntheorem for ideal fluids. In preparation.\n[26] M.C. Reed. Higher order estimates and smoothness of nonlinear wave equations.\nProc. Amer. Math. Soc. 51:79\u201385, 1975.\n38\n[27] S. Reich. Backward error analysis for numerical integrators. SIAM Journal on Numerical\nAnalysis, 36(5):1549\u20131570, 1999.\n[28] S. Reich. Multi-symplectic Runge-Kutta collocation methods for Hamiltonian wave\nequations. Journal of Computational Physics 156: 1-27, 1999.\n[29] J. Sanz-Serna. Symplectic integrators for Hamiltonian problems: An overview. Acta\nNumerica 1: 243\u2013286, 1992.\n[30] R.D. Skeel and C.W. Gear. Does variable step size ruin a symplectic integrator? Physica\nD 60: 311-313, 1992.\n[31] C. Wulff. Approximate energy conservation for time semidiscretizations of semilinear\nwave equations. In preparation.\n39\n"}