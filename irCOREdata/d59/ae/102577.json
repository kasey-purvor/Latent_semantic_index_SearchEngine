{"doi":"10.1109\/ISCE.2008.4559478","coreId":"102577","oai":"oai:epubs.surrey.ac.uk:2062","identifiers":["oai:epubs.surrey.ac.uk:2062","10.1109\/ISCE.2008.4559478"],"title":"An unequal error protection scheme for object based video communications","authors":["Nasir, S","Worrall, S","Mrak, M","Kondoz, AM"],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":null,"abstract":"This paper presents a novel adaptation technique for optimisation of the source and error protection rates in response to varying channel conditions in wireless networks. The optimisation methodology is based on accurate modelling of video frame distortion at the encoder. An optimal value for the quantisation parameter is calculated for video frames based on these estimates, and then video packets are mapped to one of a number of different priority radio bearers, according to their expected distortion. The algorithm performance is demonstrated for object based MPEG-4 video transmission over a UMTS\/FDD system. The results demonstrate that a significant performance gain is achieved with the proposed scheme, compared with the equal error protection scheme for video transmission over a fixed bandwidth channel","downloadUrl":"","fullTextIdentifier":null,"pdfHashValue":null,"publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:epubs.surrey.ac.uk:2062<\/identifier><datestamp>\n      2017-10-31T14:04:07Z<\/datestamp><setSpec>\n      74797065733D61727469636C65<\/setSpec><setSpec>\n      6469766973696F6E733D656E67616E64706879736963616C736369656E636573:656C656374726F6E6963656E67696E656572696E67:63637372<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/epubs.surrey.ac.uk\/2062\/<\/dc:relation><dc:title>\n        An unequal error protection scheme for object based video communications<\/dc:title><dc:creator>\n        Nasir, S<\/dc:creator><dc:creator>\n        Worrall, S<\/dc:creator><dc:creator>\n        Mrak, M<\/dc:creator><dc:creator>\n        Kondoz, AM<\/dc:creator><dc:description>\n        This paper presents a novel adaptation technique for optimisation of the source and error protection rates in response to varying channel conditions in wireless networks. The optimisation methodology is based on accurate modelling of video frame distortion at the encoder. An optimal value for the quantisation parameter is calculated for video frames based on these estimates, and then video packets are mapped to one of a number of different priority radio bearers, according to their expected distortion. The algorithm performance is demonstrated for object based MPEG-4 video transmission over a UMTS\/FDD system. The results demonstrate that a significant performance gain is achieved with the proposed scheme, compared with the equal error protection scheme for video transmission over a fixed bandwidth channel.<\/dc:description><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/epubs.surrey.ac.uk\/2062\/1\/SRF002196.pdf<\/dc:identifier><dc:identifier>\n          Nasir, S, Worrall, S, Mrak, M and Kondoz, AM   An unequal error protection scheme for object based video communications   Consumer Electronics, 2008. ISCE 2008. IEEE International Symposium on.  1 -4 - 1 -4.      <\/dc:identifier><dc:relation>\n        http:\/\/ieeexplore.ieee.org\/search\/srchabstract.jsp?tp=&arnumber=4559478&queryText%3DAn+Unequal+Error+Protection+Scheme+for+Object+Based+Video+Communications%26openedRefinements%3D*%26searchField%3DSearch+All<\/dc:relation><dc:relation>\n        10.1109\/ISCE.2008.4559478<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/epubs.surrey.ac.uk\/2062\/","http:\/\/ieeexplore.ieee.org\/search\/srchabstract.jsp?tp=&arnumber=4559478&queryText%3DAn+Unequal+Error+Protection+Scheme+for+Object+Based+Video+Communications%26openedRefinements%3D*%26searchField%3DSearch+All","10.1109\/ISCE.2008.4559478"],"year":null,"topics":[],"subject":["Article","PeerReviewed"],"fullText":"AN UNEQUAL ERROR PROTECTION SCHEME FOR OBJECT BASED VIDEO \nCOMMUNICATIONS \n \nS. Nasir, S. Worrall, M. Mrak and A.M. Kondoz \nCentre for Communication Systems Research, University of Surrey, \nGuildford, Surrey, GU2 7XH, U.K. \n{s.nasir, s.worrall, m.mrak, a.kondoz}@surrey.ac.uk \n \nABSTRACT \n \nThis paper presents a novel adaptation technique for \noptimisation of the source and error protection rates in \nresponse to varying channel conditions in wireless networks. \nThe optimisation methodology is based on accurate \nmodelling of video frame distortion at the encoder. An \noptimal value for the quantisation parameter is calculated for \nvideo frames based on these estimates, and then video \npackets are mapped to one of a number of different priority \nradio bearers, according to their expected distortion. The \nalgorithm performance is demonstrated for object based \nMPEG-4 video transmission over a UMTS\/FDD system. \nThe results demonstrate that a significant performance gain \nis achieved with the proposed scheme, compared with the \nequal error protection scheme for video transmission over a \nfixed bandwidth channel. \n \nIndex Terms\u2014 joint source channel rate allocation, unequal \nerror protection, distortion modelling  \n \n1. INTRODUCTION \n \nHigh quality video communication applications over \nwireless networks still pose a challenging problem due to the \nhostile and highly variable nature of the radio channels. \nCarefully designed error resilience techniques and channel \nprotection can make the video data more resilient to channel \ndegradations. However, as they are separately optimised, \nthey are still insufficiently effective for application over \nmobile channels. Joint source-channel coding approaches \nhave been proven to provide optimal performances for video \napplication over practical systems [1]. In such an approach, \neither source coding is optimised for fixed channel coding or \nan optimal channel coding is derived for a fixed source \ncode. However, adaptive source-channel code optimisation \nhas been proven to provide better perceptual video quality \n[2].  \nThe provision of object based video coding in video \ncoding standards has generated a significant research interest \nin prioritising the transmission of segmented video objects \nand ultimately to achieve robust region of interest coding [3-\n5]. In object based video coding a video sequence is \nseparated into a number of objects, each of which is encoded \nin a separate compressed bit-stream.  \nChannel coding is usually performed at the physical link \nlayer to overcome the effect of propagation errors. When the \nchannel protection mechanisms are coupled with the video \ncompression formatting at the application layer as in [6], this \nrequires modification of all underlying network protocol \nlayers in order to avoid redundancy for efficient resource \nutilisation. This problem can be solved by prioritisation of \ndifferent parts of the video bit stream by sending them using \nmultiple bearers with different characteristics such as \ndifferent channel coding, modulation, etc. In order to ensure \ngood performance of this method, it is necessary to separate \nthe encoded bit-stream optimally into a number of sub-\nstreams. \nThis paper addresses the prioritisation of different parts \nof the video bit-stream to provide maximum error robustness \nto the most vulnerable video packets, for transmission over \nwireless networks. The proposed scheme applies a packet \nlevel Unequal Error Protection (UEP) scheme to obtain \noptimal video quality over a wide range of channel \nconditions. The proposed scheme is compatible with the \ncodec standard and is also transparent to the underlying \nnetwork allowing video services over heterogeneous (fourth \ngeneration) wireless networks. \n \n2. FORMULATION OF THE PROPOSED \nOPTIMISATION SCHEME \n \nIn this section, a novel UEP scheme is introduced with a \ngoal to optimise the transmission of multiple video objects \nover a wireless communication system like UMTS that \nsupports multiple radio bearers (sub-channels) with different \nchannel coding schemes. \n \n2.1 Transmission Channel Resource Optimisation \n \nThe underlying idea in this work is to optimise the use of \navailable transmission channel resources for enhancing the \noutput video quality. A transmission channel is characterised \nby channel bandwidth Rch, The bandwidth is shared amongst \navailable sub-channels. For sub-channels with indices \nc = 0,..., C - 1, where C is the number of sub-channels, the \nAuthorized licensed use limited to: University of Surrey. Downloaded on May 12,2010 at 14:43:28 UTC from IEEE Xplore.  Restrictions apply. \nFigure1: Object based channel resource allocation \n \n \n \nStream 0            Stream m            Stream M-1 \n \n \nChannel multiplexing \nDistortion estimation and packets \ndistribution to separate streams after \noptimal encoding \n \nB\nea\nre\nr \n0\n \n\u2026                      \u2026 \n\u2026                       \u2026 \nB\nea\nre\nr \nK\n-1\n \n \n \nVideo frame segmented into objects \n \u2026                       \u2026 \nObject 0              Object m           Object M-1 \nPhysical Channel \nB\nea\nre\nr \nk\n \ncorresponding bandwidth is R(c), where \n1\n0\n( )\nC\nch c\nR R c\n\u2212\n=\n=\u0001 , \nand for each sub-channel a probability of channel bit errors \nis known. Additionally, for each sub-channel a channel \ncoding rate \u0001(c) is also defined. The combination of \nspreading gain, channel coding and modulation schemes \nprovide different radio bearer configurations offering \nflexibility in the degree of protection, coding complexity and \ntraffic capacity, which has been used in this work to \nprioritise objects of the video content on the basis of their \nimportance.   \n \n2.2 Object Based Prioritisation \n \nIn an object-based video coding scenario, a video frame \nis separated into sub-streams at the bit-stream level. In our \napproach the number of these sub-streams is fixed over a \nvideo sequence. However, their rate and related contribution \nto the overall distortion varies. The sub-streams are \nassociated with the available bearers. For given channel \nconfiguration and given content, the optimisation process \ndetermines the allocation of different sub-streams to video \npackets of different objects. The goal set here is to find the \noptimal sub-stream separation and mapping of video packets \nonto multiple bearers in such a way as to maximise the \nreceived video quality for video transmission over a \nbandwidth limited error prone channel.  \nReceived visual quality is determined by the amount of \ndistortion incurred during transmission. Let the input video \nsequence consists of M video frames. Each video frame is \nseparated into Lm number of objects. Each object is coded \nseparately using its own segmentation mask. Every object is \ndivided into Nm,l number of video packets. If expected \ndistortion due to the corruption of the n\nth\n packet of the  m\nth\n \nframe of the l\nth\n video object is \u0002(l, m ,n), then the total \nexpected distortion E(D) of the sequence becomes \n \n \u0001 \u0001\u0001 \u0001\n\u2212\n=\n\u2212\n=\n\u2212\n=\n\u2212\n=\n==\n1\n0\n1\n0\n1\n0\n1\n0\n,\n),,()()(\nL\nl\nM\nm\nL\nl\nN\nn\nl\nm lm\nnmlDEDE \u03b1\n.\n (1) \n \n \n \nThus the goal of the optimisation process is to minimise \nE(D). \nNow the optimisation problem can be formulated as \noptimal allocation of bits within each packet of K sub-\nstreams, subject to the bandwidth limitations of the available \ncommunication channel. This is achieved by estimating the \nexpected distortion for each packet of the current frame and \nthen mapping them to the available sub-channels so that the \nhighly protected sub-channel can carry most of the packets \nwith the highest expected distortion.  \nA further level of optimisation is achieved by \nincrementing the value of the QP for each of the objects and \nrecalculating the total cost in terms of expected distortion for \nthe combination of packets of each of the sub-channels. The \nprocess is repeated until the distortion cost is reduced to a \nminimum. The video frame is then coded with that optimal \nvalue of QP and packets are separated into sub-streams \naccordingly. Figure 1 outlines the proposed idea.  \n \n3. DISTORTION MODELLING \n \nThe sub-stream distribution algorithm described in the \nprevious section relies on accurate distortion estimation at \nthe video packet level. This section describes the estimation \nof the distortion due to the corruption of data in a video \npacket. \nIn wireless networks, the video quality is affected by the \nquantisation distortion E(Q\nD\n) and channel distortion [7]. \nChannel distortion is composed of concealment distortion \nand distortion caused from error propagation over frames \ncoded using temporal prediction. Concealment distortion \ndepends on the concealment techniques applied at the \ndecoder. If errors in the video data are concealed with \nconcealment data from the previous frames, then it is called \ntemporal concealment and distortion caused by such a \nscheme is called as temporal concealment distortion E(D\nT\n). \nErrors can propagate in two ways, either in the temporal \ndirection or in the spatial direction. Frame to frame error \npropagation through motion prediction and temporal \nconcealment is called temporal domain error propagation f\ntp\n. \nThe distortion estimation model used in this work has \nAuthorized licensed use limited to: University of Surrey. Downloaded on May 12,2010 at 14:43:28 UTC from IEEE Xplore.  Restrictions apply. \nsimilarities with the methods proposed in [7, 8]. However, \nthe distortion induced due to error propagation is calculated \ndifferently and adaptive intra refresh technique is used to \nminimise the error propagation factor, even though the same \nassumption, namely the uniform distribution of the video \nreconstruction error, is made. Previous research has \nsuggested that spatial error concealment is less important \nthan the temporal error concealment [9] so in this work only \ntemporal concealment is considered.  \nTaking video packet as the base unit, the expected frame \nquality can be written as: \n \n \n( )\u0002\n\u0003\n\u0004\n\u0005\n\u0006\n\u0007\n\u22c5= \u0001\n\u2212\n=\n1\n0\n,,, \/log10)(\nN\nn\nnmlml DEgQE\n (2) \n \nwhere E(Ql,m) is the expected quality of m\nth\n frame of the l\nth\n \nobject, E(Dl,m,n) is the expected distortion of n\nth\n video packet \nand N is the total number of video packets. g is a constant \ndefined by the colour depth and by the size of given \ncomposite video frame, g = cd\n2\n \u22c5 w \u22c5 h, where cd is the \ncolour depth factor, w and h are the width and height of the \nvideo frame, respectively. E(Dl,m,n)\n \ncan be written as: \n \n ( ) ( ) ( ) ( ), , , , , ,, , ( , , )\nQ e T tp\nl m n l m n l m nE D E D l m n E D f l m n\u03c1= + \u22c5 + .\n(3) \nCalculation of each term shown in (3) depends on the \nimplemented concealment techniques, and the applied video \ncoding scheme and its parameters.  \nQuantisation distortion is computed from the squared \ndifference of original and reconstructed luminance values \nfor every macroblock in the particular video packet.  \nProbability \u03c1e(l, m, n) of receiving a video packet with \nerrors depends on the channel\u2019s Bit Error Rate (BER) and \nsize of the video packet. If \u03c1b is the BER of the transmission \nchannel then \u03c1e(l, m, n) is given as:  \n \n \n( ) ( )nmlpbe bnml ,,)1(1,, \u03c1\u03c1 \u2212\u2212=  (4) \nwhere pb(l, m, n) represents the size of the packet in bits.  \nThe extent of temporal concealment distortion depends \non the algorithm used for the temporal concealment. Here a \nsimple concealment approach is followed that macroblocks \nin the corrupted video packet are replaced by data of the \ncorresponding macroblocks of the previous frame. In \nestimation it is assumed that the neighbouring video packets \nand reference frames are received correctly. Therefore, the \nconcealment distortion is given as: \n \n nmlnml\nT\nnml YYDE ,1,,,,, )( \u2212\u2032\u2212=  (5) \n \n \nwhich is the squared difference of the luminance \ncomponents of macroblocks of reconstructed part of current \nframe Ym, n and the same spatial area in the previous frame \nY\u2019m - 1, n. \nThe temporal error propagation due to MB mismatch \nbetween adjacent video frames is quantified by the term \nf\ntp\n(l, m, n) in (3), which is computed as: \n \n( ) ( )( )\n( ) ( )[ ] ( )( )\u0001\n\u2212\n=\n\u2212\u2212\n\u2212\n\u22c5\u2212\u2212+\u22c5\u2212\n\u22c5\u22c5\u2212=\n1\n0\n2,,1,,\n1,\n,,11,1,\n,,1,,\nK\nk\ntp\nml\neT\nnmlk\ne\ntp\nml\netp\nplnmDEnml\npnmlnmlf\n\u03c1\u03c1\n\u03c1\n (6) \n \nwhere K is the total number of macroblocks in the frame. \nThe summation in (6) represents the error propagation \nthrough MBs. mF\nb\ntp\nmp )1(1 \u03c1\u2212\u2212=  \nquantifies the fraction of \ndistortion of the m\nth\n reference video frame, which should be \nconsidered in the propagation loss calculation and Fm is the \nsize of the frame area contained in the observed packet.  \nPackets are then distributed on the basis of the estimated \ndistortion to respective bit-streams. Packets with higher \nexpected distortion are put on the sub-channel with higher \nprotection. \n \n3. EXPERIMENTAL RESULTS \n \nThe proposed scheme has been tested for performance over \na simulated link level UMTS channel. A detailed \nexplanation of the developed link level simulator can be \nfound in [10].  \nExperiments have been performed with two video \nsequences, \u2018Singer\u2019 and \u2018Dancer\u2019. Each sequence is \nsegmented into two objects, where packets of each object \nare distributed to either of the sub bit-streams following the \nproposed optimisation scheme. The \u2018Singer\u2019 is a QCIF \nresolution (176 \u00d7 144) sequence that has moving clouds in \nits background while the \u2018Dancer\u2019 object is used with the \n\u2018Highway\u2019 sequence in background at CIF resolution \n(352 \u00d7 288). Two channel bearers are used to transmit one \nsub bit-stream over each of them. A spreading factor of 16 is \nused in the physical channel configuration with 1\/2 rate and \n1\/3 rate convolutional coding over the two sub-channels. \nThese channels permit a maximum of 208 kbps and \n138 kbps respectively. Therefore, 90 frames of the QCIF \nresolution \u2018Singer\u2019 sequence are encoded at 30 frames per \nsecond (fps) while 180 frames of the CIF resolution \n\u2018Dancer\u2019 sequence are encoded at 15 fps. Experiments have \nbeen conducted for a range of channel conditions for the \nproposed optimisation scheme and a comparison is made \nwith standard MPEG-4 object based coding.  \nThe video performances are shown in terms of average \nframe PSNR vs Eb\/No in Figure 2. Each point of the graph \nhas been taken as the average of 40 runs of the decoder for \neach of the 90 frames long test sequences. The figure \nillustrates the performance of the proposed method \ncompared to standard MPEG-4 encoding with traditional \nequal error protection (EEP). The main strength of the \nproposed scheme is efficient packet prioritisation, which is \nmost effective in bad channel conditions. For test points at \nlower Eb\/No the gain is significant and reaches up to 2 dB.  \nThe computational overhead for the distortion \ncalculation in the proposed scheme does not add any \nAuthorized licensed use limited to: University of Surrey. Downloaded on May 12,2010 at 14:43:28 UTC from IEEE Xplore.  Restrictions apply. \nsignificant complexity during video coding.  However, it is \nassumed that the encoder will have some pre-computed \ninformation about the distortion cost for different QP values \nto minimise the computational complexity. \nThe scheme has been tested for a set of three QP values. \n12, 16 and 20 for the background object and 12, 14, and 16 \nfor the foreground object in all the tests. The optimal value \nof QP for each object is used to encode that particular frame. \nThe QP values used for standard MPEG-4 that is used in \ncomparison are 10 for I frames and 12 for P frames. \n \n20\n22\n24\n26\n28\n30\n32\n4 6 8 10 12\nP\nS\nN\nR\n [\nd\nB\n]\nEb\/ No[dB]\nStandard EEP based MPEG-4 Proposed Scheme\na) \n28\n30\n32\n34\n36\n38\n40\n4 6 8 10 12\nP\nS\nN\nR\n [\nd\nB\n]\nEb\/ No[dB]\nStandard EEP based MPEG-4 Proposed Scheme\nb) \nFigure 2: Performance Comparison for the test \nsequences a) 'Dancer' b) 'Singer' \n \n4. CONCLUSIONS \n \nAn optimum channel resource allocation scheme is proposed \nfor video communications over wireless networks. The rate \nallocation is based on accurate modelling of the expected \ndistortion at the video packet level. A novel UEP scheme is \nincorporated into the rate allocation scheme to achieve \noptimum video quality. The video data is prioritised \naccording to the relative perceived importance, which is \nestimated using the developed distortion model at the \nencoder. Prioritised streams are transmitted over the air \ninterface by using multiple radio bearers with different error \nprotection capabilities. The experiments that are carried out \nover the simulated UMTS systems show that significant \nperformance improvements can be achieved with the \nproposed scheme compared to traditional EEP schemes.  \n  \n5.  ACKNOWLEDGMENTS \nThe work presented was developed within VISNET II, a \nEuropean Network of Excellence, funded under the \nEuropean Commission IST FP6 programme. \n \n6. REFERENCES \n \n[1] Bystrom M., Stockhammer T., \u201cDependent source and \nchannel rate allocation for video transmission\u201d, IEEE \nTrans. Wireless Comm., Vol.3, Iss. 1, pp. 258 \u2013 268, \nJan. 2004. \n[2] Dyck. R.E.,Miller. D.J., \u201cTransport of wireless video \nusing separate, concatenated, and joint source-channel \ncoding\u201d, Proceedings of the IEEE , Vol. 87 Iss. 10, pp. \n1734 -1750, Oct. 1999. \n[3] Chen, O.T.-C., Chih-Chang Chen, \"Automatically-\nDetermined Region of Interest in JPEG 2000,\" IEEE \nTrans. Multimedia., Vol. 9, Iss. 7, pp. 1333 - 1345, \nNov. 2007. \n[4] Sanchez V., Basu A., Mandal M. K., \"Prioritized \nregion of interest coding in JPEG2000,\" IEEE Trans. \nCircuits and Sys. for Video Tech., Vol. 14, Iss. 9, pp. \n1149 - 1155, Sept. 2004. \n[5] Lee S.-H., Moon J., Lee M., \"A Region of Interest \nBased Image Segmentation Method using a \nBiologically Motivated Selective Attention Model\", \nInt. Joint Conf. Neural Networks, pp. 1413-1420, July \n2006  \n[6] Gharavi H., Alamouti S.M., \u201cVideo transmission for \nthird generation wireless communication systems\u201d, \nJournal of research of the national institute of \nstandards and technology, Vol. 106, pp. 455 - 469, \nMarch-April, 2001. \n[7] Katsaggelos A.K., Eisenberg Y., Zhai F., Berry R., \nPappas T. N., \u201cAdvances in Efficient Resource \nAllocation for Packet-Based Real-Time Video \nTransmission\u201d, Proceedings of the IEEE, Vol. 93, Iss. \n1, pp. 135-147, Jan 2005. \n[8] Kim I.-M., Kim H.-M., \u201cAn optimum power \nmanagement scheme for wireless video service in \nCDMA systems\u201d, IEEE Trans. Wireless Comm., Vol. \n2, Iss. 1, pp. 81 \u2013 91, Jan. 2003. \n[9] Wang Y., Wenger S., Wen J., Katsaggelos A.K., \"Error \nresilient video coding techniques,\" IEEE Signal \nProcessing Magazine, Vol. 17, No. 4, pp. 61 - 82, Jul \n2000. \n[10] Kodikara, C., Worrall, S., Fabri, S., Kondoz, A., \n\u201cPerformance evaluation of MPEG-4 video telephony \nover UMTS\u201d, 3G2003, pp. 73-77, June 2003. \nAuthorized licensed use limited to: University of Surrey. Downloaded on May 12,2010 at 14:43:28 UTC from IEEE Xplore.  Restrictions apply. \n"}