{"doi":"10.1109\/TITB.2005.847500","coreId":"102262","oai":"oai:epubs.surrey.ac.uk:1717","identifiers":["oai:epubs.surrey.ac.uk:1717","10.1109\/TITB.2005.847500"],"title":"MRI fuzzy segmentation of brain tissue using neighborhood attraction with neural-network optimization","authors":["Shen, Shan","Sandham, William","Granat, Malcolm","Sterr, Annette"],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2005-09-01","abstract":"<p>Image segmentation is an indispensable process in the visualization of human tissues, particularly during clinical analysis of magnetic resonance (MR) images. Unfortunately, MR images always contain a significant amount of noise caused by operator performance, equipment, and the environment, which can lead to serious inaccuracies with segmentation. A robust segmentation technique based on an extension to the traditional fuzzy c-means (FCM) clustering algorithm is proposed in this paper. A neighborhood attraction, which is dependent on the relative location and features of neighboring pixels, is shown to improve the segmentation performance dramatically. The degree of attraction is optimized by a neural-network model. Simulated and real brain MR images with different noise levels are segmented to demonstrate the superiority of the proposed technique compared to other FCM-based methods. This segmentation method is a key component of an MR image-based classification system for brain tumors, currently being developed.<\/p","downloadUrl":"","fullTextIdentifier":null,"pdfHashValue":null,"publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:epubs.surrey.ac.uk:1717<\/identifier><datestamp>\n      2017-10-31T14:02:51Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><setSpec>\n      6469766973696F6E733D6865616C7468616E646D65646963616C:50737963686F6C6F6779<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/epubs.surrey.ac.uk\/1717\/<\/dc:relation><dc:title>\n        MRI fuzzy segmentation of brain tissue using neighborhood attraction with neural-network optimization<\/dc:title><dc:creator>\n        Shen, Shan<\/dc:creator><dc:creator>\n        Sandham, William<\/dc:creator><dc:creator>\n        Granat, Malcolm<\/dc:creator><dc:creator>\n        Sterr, Annette<\/dc:creator><dc:description>\n        <p>Image segmentation is an indispensable process in the visualization of human tissues, particularly during clinical analysis of magnetic resonance (MR) images. Unfortunately, MR images always contain a significant amount of noise caused by operator performance, equipment, and the environment, which can lead to serious inaccuracies with segmentation. A robust segmentation technique based on an extension to the traditional fuzzy c-means (FCM) clustering algorithm is proposed in this paper. A neighborhood attraction, which is dependent on the relative location and features of neighboring pixels, is shown to improve the segmentation performance dramatically. The degree of attraction is optimized by a neural-network model. Simulated and real brain MR images with different noise levels are segmented to demonstrate the superiority of the proposed technique compared to other FCM-based methods. This segmentation method is a key component of an MR image-based classification system for brain tumors, currently being developed.<\/p><\/dc:description><dc:date>\n        2005-09-01<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/epubs.surrey.ac.uk\/1717\/1\/fulltext.pdf<\/dc:identifier><dc:identifier>\n          Shen, Shan, Sandham, William, Granat, Malcolm and Sterr, Annette  (2005) MRI fuzzy segmentation of brain tissue using neighborhood attraction with neural-network optimization   IEEE Transactions on Information Technology in Biomedicine, 9 (3).  pp. 459-467.      <\/dc:identifier><dc:relation>\n        10.1109\/TITB.2005.847500<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/epubs.surrey.ac.uk\/1717\/","10.1109\/TITB.2005.847500"],"year":2005,"topics":[],"subject":["Article","PeerReviewed"],"fullText":"IEEE TRANSACTIONS ON INFORMATION TECHNOLOGY IN BIOMEDICINE, VOL. 9, NO. 3, SEPTEMBER 2005 459\nMRI Fuzzy Segmentation of Brain Tissue\nUsing Neighborhood Attraction With\nNeural-Network Optimization\nShan Shen, William Sandham, Member, IEEE, Malcolm Granat, and Annette Sterr\nAbstract\u2014Image segmentation is an indispensable process in\nthe visualization of human tissues, particularly during clinical\nanalysis of magnetic resonance (MR) images. Unfortunately, MR\nimages always contain a significant amount of noise caused by\noperator performance, equipment, and the environment, which\ncan lead to serious inaccuracies with segmentation. A robust seg-\nmentation technique based on an extension to the traditional fuzzy\nc-means (FCM) clustering algorithm is proposed in this paper.\nA neighborhood attraction, which is dependent on the relative\nlocation and features of neighboring pixels, is shown to improve\nthe segmentation performance dramatically. The degree of at-\ntraction is optimized by a neural-network model. Simulated and\nreal brain MR images with different noise levels are segmented to\ndemonstrate the superiority of the proposed technique compared\nto other FCM-based methods. This segmentation method is a key\ncomponent of an MR image-based classification system for brain\ntumors, currently being developed.\nIndex Terms\u2014Improved fuzzy c-means clustering (IFCM),\nmagnetic resonance imaging (MRI), neighborhood attraction,\nsegmentation.\nI. INTRODUCTION\nI N THE analysis of medical images for computer-aided di-agnosis and therapy, segmentation is often required as a pre-\nliminary stage. Medical image segmentation is a complex and\nchallenging task due to the intrinsic nature of the images. The\nbrain has a particularly complicated structure and its precise\nsegmentation is very important for detecting tumors, edema,\nand necrotic tissues, in order to prescribe appropriate therapy.\nMagnetic resonance imaging (MRI) is an important diagnostic\nimaging technique for the early detection of abnormal changes\nin tissues and organs. It possesses good contrast resolution for\ndifferent tissues and has advantages over computerized tomog-\nraphy (CT) for brain studies due to its superior contrast prop-\nerties. Therefore, the majority of research in medical image\nsegmentation concerns MR images.\nMany image processing techniques have been proposed\nfor brain MRI segmentation, most notably thresholding, re-\ngion-growing, and clustering. Since the distribution of tissue\nManuscript received June 29, 2004; revised November 29, 2004 and January\n14, 2005.\nS. Shen and A. Sterr are with the Department of Psychology, University of\nSurrey, Guildford GU2 7XH, U.K. (e-mail: shan.shen@surrey.ac.uk; a.sterr@\nsurrey.ac.uk).\nW. Sandham is with Scotsig, Glasgow G12 9PF, U.K. (e-mail: w.sandham\n@scotsig.co.uk).\nM. Granat is with the School of Health and Social Care, Glasgow Caledonian\nUniversity, Glasgow G4 0BA, U.K. (e-mail: malcolm.granat@gcal.ac.uk).\nDigital Object Identifier 10.1109\/TITB.2005.847500\nintensities in brain images is very complex, it leads to dif-\nficulties of threshold determination. Therefore, thresholding\nmethods are generally restrictive and have to be combined\nwith other methods [1], [2]. Region growing extends thresh-\nolding by combining it with connectivity conditions or region\nhomogeneity criteria. Successful methods require precise\nanatomical information to locate single or multiple seed pixels\nfor each region and together with their associated homogeneity\n[3]\u2013[5]. Clustering is the most popular method for medical\nimage segmentation, with fuzzy c-means (FCM) clustering and\nexpectation\u2013maximization (EM) algorithms being the typical\nmethods. The applications of the EM algorithm to brain MR\nimage segmentation were reported by Wells et al. [6] and\nLeemput et al. [7]. A common disadvantage of EM algorithms\nis that the intensity distribution of brain images is modeled\nas a normal distribution, which is untrue, especially for noisy\nimages.\nThe FCM algorithm has also been employed by many re-\nsearchers. Li et al. [8] presented a knowledge-based classifi-\ncation and tissue labeling approach to initially segment MR\nbrain images using the FCM algorithm, and introduced an expert\nsystem to locate a landmark tissue by matching it with a prior\nmodel. Hall et al. [9] segmented brain MR images using an ar-\ntificial neural network (ANN), and compared the performance\nwith FCM. FCM was shown to be superior on normal brains,\nbut worse on abnormal brains with edema, tumor, etc. Pham and\nPrince [10] extended the traditional FCM algorithm to deal with\nMR images corrupted by intensity inhomogeneities. Unfortu-\nnately, the greatest shortcoming of FCM is its over-sensitivity\nto noise, which is also a flaw of many other intensity-based seg-\nmentation methods. Since medical images always include con-\nsiderable uncertainty and unknown noise, this generally leads to\nfurther degradation with segmentation.\nAn MR image-based brain tumor classification system\nis being developed by the authors, and this was the initial\nmotivation to develop a robust segmentation method, since\naccurate and robust segmentation is a key stage in successful\nclassification. Many extensions of the FCM algorithm have\nbeen reported in the literature to overcome the effects of noise,\nbut most of them still have major drawbacks.\nIn this paper, new extensions to FCM are described which\nconsider two influential factors in segmentation, both of which\naddress issues of neighborhood attraction. One is the feature dif-\nference between neighboring pixels in the image; the other is the\nrelative locations of neighboring pixels. Segmentation is there-\nfore decided not only by the pixel intensities themselves, but\n1089-7771\/$20.00 \u00a9 2005 IEEE\n460 IEEE TRANSACTIONS ON INFORMATION TECHNOLOGY IN BIOMEDICINE, VOL. 9, NO. 3, SEPTEMBER 2005\nalso by the neighboring pixel intensities and locations. Consid-\neration of these neighboring pixels greatly restrains the influ-\nence of noise. The parameters referring to the degree of neigh-\nborhood attraction are determined using a simple ANN model.\nThe organization of the paper is as follows. In Section II, the\ntraditional FCM algorithm and related extensions are briefly\nreviewed. Section III presents our improved fuzzy clustering\nalgorithm, and Section IV compares our method with other\npublished techniques. Section V contains conclusions and\naddresses future work.\nII. FUZZY -MEANS CLUSTERING ALGORITHM\nAND RELATED EXTENSIONS\nA. Fuzzy C-Means Clustering (FCM) Algorithm\nHistorically, the FCM clustering algorithm introduced by\nBezdek is an improvement of earlier clustering methods [11].\nIt is based on minimizing an objective function, with respect to\nfuzzy membership , and set of cluster centroids\n(1)\nIn the above equation, is a\ndata matrix, where represents the dimension of each\n\u201cfeature\u201d vector, and represents the number of feature vectors\n(pixel numbers in the image). is the number of clusters.\nis the membership function of vector to the\nth cluster, which satisfies and , (\n). The membership function is expressed as follows:\n(2)\n, which is a matrix and\ndenotes the cluster feature center\n(3)\nis a weighting exponent on each fuzzy mem-\nbership, which controls the degree of fuzziness. is a\nmeasurement of similarity between and\n(4)\ncan be defined as either a straightforward Euclidean dis-\ntance or its generalization such as the Mahalanobis distance.\nThe feature vector in MR images represents the pixel\nintensities, so . The FCM algorithm iteratively opti-\nmizes with the continuous update of and , until\n, where is the number of iterations.\nThe drawback of FCM for image segmentation is obvious.\nFirst, it is clear from (1) that the objective function of FCM does\nnot take into consideration any spatial dependence among ,\nbut deals with images the same as separate points. Secondly, the\nmembership function in (2) is mostly decided by ,\nwhich measures the similarity between the pixel intensity and\nthe cluster center. Higher membership depends on closer inten-\nsity values to the cluster center. It therefore increases the sensi-\ntivity of the membership function to noise. If an MR image con-\ntains noise or is affected by artefacts, their presence can change\nthe pixel intensities, which will result in an incorrect member-\nship and improper segmentation. These problems must be prop-\nerly addressed to improve the robustness of the FCM algorithm.\nB. FCM-Related Extensions\nThe most direct way to compensate for the drawback of FCM\nis to smooth the image before segmentation. However, standard\nsmoothing filters can lead to a loss of important image details.\nVarious extensions of the FCM algorithm which attempt to ac-\ncommodate noise have been presented by many researchers.\nTilias and Panas post-processed the membership function to\nsmooth the effect of noise [12]. Acton and Mukherjee incorpo-\nrated multiscale information to enforce spatial constraints [13].\nThe most popular approach for increasing the robustness of\nFCM to noise is to modify the objective function directly. D\u00e1ve\nproposed the idea of a noise cluster to deal with noisy clustering\ndata in the approach known as NC [14]. Noise is effectively clus-\ntered into a separate cluster which is unique from signal clusters.\nHowever, it is not suitable for image segmentation, since noisy\npixels should not be separated from other pixels, but assigned\nto the most appropriate clusters in order to reduce the effect of\nnoise.\nAnother similar method, developed by Krishnapuram and\nKeller [15], is called possibilistic c-means (PCM), which in-\nterprets clustering as a possibilistic partition. Instead of having\none term in the objective function, a second term is included,\nforcing the membership to be as high as possible without a\nmaximum limit constraint of one. However, it caused clustering\nbeing stuck in one or two clusters.\nPham presented a new approach of FCM, named the robust\nfuzzy c-means algorithm (RFCM) [16]. A modified objective\nfunction was proposed for incorporating spatial context into\nFCM. A parameter controls the tradeoff between the conven-\ntional FCM objective function and the smooth membership\nfunctions. However, the modification of the objective function\nresults in the complex variation of the membership function.\nOther improved versions of FCM by the modification of the\nobjective function were introduced by Ahmed et al. [17] and\nby Zhang and Chen [18]. The former proposed a modification\nof the objective function by introducing a term that allows the\nlabeling of a pixel to be influenced by the labels in its imme-\ndiate neighborhood. The latter (spatially constrained kernelized\nFCM-SKFCM) used a different penalty term containing spatial\nneighborhood information in the objective function, and simul-\ntaneously the similarity measurement in the FCM, was replaced\nby a kernel-induced distance. All these methods inevitably in-\ntroduce computation issues, by modifying most equations along\nwith the modification of the objective function, and have to lose\nthe continuity from FCM, which is well-realized with many\ntypes of software, such as MATLAB.\nSHEN et al.: MRI FUZZY SEGMENTATION OF BRAIN TISSUE 461\nIII. IMPROVED FUZZY -MEANS CLUSTERING ALGORITHM\nA. Description of Methodology\nA new algorithm is proposed here in order to circumvent the\ndrawbacks of other methods described above. We have coined\nit improved fuzzy c-means clustering (IFCM). From the above\ndescription, the membership value of FCM decides the segmen-\ntation results, and the membership value is determined by the\nsimilarity measurement in (4). It may be deduced that\nthis measurement is the key to segmentation success. In FCM,\nis a measure of the difference between the intensity\nof a pixel and the cluster center, and has no resistance to noise.\nIn our proposed algorithm, an attraction entitled neighborhood\nattraction is considered to exist between neighboring pixels.\nDuring clustering, each pixel attempts to attract its neighboring\npixels toward its own cluster. This neighborhood attraction de-\npends on two factors; the pixel intensities or feature attraction,\nand the spatial position of the neighbors or distance attraction,\nwhich also depends on the neighborhood structure.\nIFCM considers the neighborhood attraction in\ndirectly\n(5)\nwhere represents the feature attraction and represents\nthe distance attraction. The two parameters and in (5), of\nmagnitude between 0 to 1, adjust the degree of the two neigh-\nborhood attractions\n(6)\nwhere is the intensity difference between the study pixel\nand its neighbor pixel\nis the membership of neighboring pixel to the th cluster,\nand is the number of neighboring pixels\n(7)\nwhere is the relative location between pixel and its neigh-\nborhood pixel .\nThe neighborhood structure is of the form\n(8)\nwhere , denote the coordinates of pixel , .\nis a constant, equal to , and is the level of the neigh-\nborhood. Fig. 1 shows the neighborhood structure for different\nlevels.\nin (7) can be described as follows:\n(9)\nFig. 1. Neighborhood structure definitions. (A higher level includes pixels\nlabeled as the number of the level and pixels in all lower levels).\nThe mechanics of the IFCM algorithm are similar to the tra-\nditional FCM. Besides modifying , the initialization\nof the membership is not created randomly but inherited from\nFCM. The individual stages of IFCM are as follows.\n1. Determine the number of clusters C(2 \u0014 C \u0014\nN) and the degree of fuzziness m.\n2. Execute FCM completely.\n3. Utilize the final membership of FCM as the\ninitial membership u(0)ij of IFCM.\n4. At the lth iteration (l = 0; 1; 2; . . .), calculate\nthe cluster center v(l)i (i = 1; 2 . . . ; C) using the\nmembership u(l)ij .\n5. Calculate the improved similarity measure-\nment d2(xj ;v\n(l)\ni ).\n6. Update u(l)ij with d\n2(xj ;v\n(l)\ni ).\n7. Compare u(l)ij and u\n(l\u00001)\nij , If u\n(l)\nij \u0000 u\n(l\u00001)\nij < \",\nthen stop, otherwise, l = l + 1, go to step 4 and\nrepeat.\nB. Parameter Optimization Using Neural Network\nAs indicated above, two parameters and are selected to\nadjust the degree of feature attraction and distance attraction, re-\nspectively, in (5). A simple ANN model is therefore designed to\nsearch for the optimal values of these parameters. Fig. 2 shows\nthe architecture of the model, where ( ,1,2) denotes the\ninterconnection weights of the network\nThe cost function of the neural network is described as\nfollows:\nDoRate\n(10)\nwhere\n(11)\n462 IEEE TRANSACTIONS ON INFORMATION TECHNOLOGY IN BIOMEDICINE, VOL. 9, NO. 3, SEPTEMBER 2005\nFig. 2. Architecture of ANN model.\nis the objective function in (1), which requires to be min-\nimized. It gradually converges during IFCM iteration. Hence,\ndescribes the degree of the convergence. A lower\nrepresents a better convergence of\nDoRate (12)\nDoRate is defined as the abbreviation of \u201cDominating Rate.\u201d\nstands for the highest membership of each pixel to all\nclusters, thus DoRate represents the average dominating rate in\nsegmentation. Higher DoRate indicates a more pronounced seg-\nmentation result.\nIn the cost function , the numerator is proposed to be\nminimized and the denominator DoRate is meant to be max-\nimized; hence must converge to a global minimum in the\nANN model. in (10) denotes an average minimum\nachieved in the whole image.\nThe increasing rate of the weights is defined as\n(13)\nwhere , is the learning\nrate.\nThe update of is then presented as\n(14)\nwhere is the number of iteration times.\nThe process of parameter optimization includes the following\nsteps.\n1. Initialize w(0), where \u0015 = 0 and \u0018 = 0.\n2. Obtain the initial membership function and\nthe cluster centers.\n3. Compute the similarity measurement using\nthe present w(l).\n4. Update the membership function and the\ncluster centers and compute the cost function\nE.\n5. Update w(l) to w(l+1) using (14).\nIf w(l+1)r \u0015 1, Then w(l+1)r = w(l+1)r \u00001, where r = 1; 2.\n6. Stop if both wl+11;2 reached 1 once, otherwise\ngo to step 3.\nFig. 3. Segmentation results on a synthetic square image with (0,120) noise.\n(a) FCM. (b) PCM. (c) RFCM. (d) IFCM.\nThe termination criteria are defined as both parameters are\nsearched completely from 0 to 1. This helps to ensure a global\nminimum of the cost function is achieved rather than a local\nminimum.\nIV. RESULTS\nIn this section, experimental results are described to compare\nthe segmentation performance of IFCM to other FCM exten-\nsions. Three types of images were employed: 1) a synthetic\nsquare image; 2) simulated brain images downloaded from\nBrainweb [19] (http:\/\/www.bic.mni.mcgill.ca\/brainweb); and\n3) real MR images from two sources, IBSR [20] (http:\/\/www.\ncma.mgh.harvard.edu\/ibsr\/) and the Southern General Hos-\npital, Glasgow, U.K.\nUnless otherwise stated, a value of 2 was employed for the\nweighting exponent in all fuzzy clustering methods in this\npaper, since this value yielded the best results in most images.\nThe second level of the neighborhood was always used in\nthe IFCM algorithm. Optimized parameters in RFCM were\nobtained by means of a cross-validation method presented in\n[16]. This allowed a fair comparison between all methods.\nA. Square Image\nA synthetic square image (256 256 pixels) consisting of 16\nsquares is generated. It contains uniformly distributed noise in\nthe interval (0, 120). The intensity values of the four classes\nare 0, 100, 200, and 300, respectively. Fig. 3(a)\u2013(d) shows the\nsegmentation results of FCM, PCM, RFCM, and IFCM.\nand in IFCM were chosen by the ANN\nmodel within 21 iterations, where the learning rate was\n(This value of applied to all images in this paper). Fig. 4 shows\nSHEN et al.: MRI FUZZY SEGMENTATION OF BRAIN TISSUE 463\nFig. 4. Parameter selection of IFCM.\nTABLE I\nSEGMENTATION EVALUATION ON SYNTHETIC SQUARE IMAGE\nthe trends of the cost function as a function of and during\nANN selection in IFCM. Since the minimum and maximum\nlimits of and are 0 and 1, respectively, using the ANN model\nreduces the number of combination possibilities. As shown in\nFig. 3(a) and (c), neither FCM nor RFCM can overcome the\ndegradation caused by noise in the segmentation performance.\nFig. 3(b) illustrates the drawback of PCM since the segmenta-\ntion is trapped in two clusters. Only IFCM completely succeeds\nin segmenting the four classes as shown in Fig. 3(d).\nIn order to evaluate the segmentation performance quantita-\ntively, some definitions are required. is the number of pixels\nthat do not belong to a cluster and are segmented into the cluster.\nis the number of pixels that belong to a cluster and are not\nsegmented into the cluster. is the number of all pixels that\nbelong to a cluster, and is the total number of pixels that do\nnot belong to a cluster. Three evaluation parameters may now\nbe defined as follows.\n1) Under segmentation (UnS): , repre-\nsenting the percentage of negative false segmentation.\n2) Over segmentation (OvS): , representing\nthe percentage of positive false segmentation.\n3) Incorrect segmentation (InC): ,\nrepresenting the total percentage of false segmentation.\nTable I lists the above parameters of the four tested methods.\nIt clearly demonstrates that despite the failure of PCM, RFCM\nhad a better performance than FCM, and that IFCM greatly re-\nduces the incorrect segmentation rate to 0.026%.\nB. Simulated MR Images\nSince the ground truth of segmentation for real MR images is\nnot usually available, it is impossible to evaluate the segmenta-\ntion performance quantitatively, but only visually.\nHowever, Brainweb provides a simulated brain database\n(SBD) including a set of realistic MRI data volumes produced\nby an MRI simulator. These data enable us to evaluate the\nFig. 5. Simulated T -weighted MR image. (a) Discrete anatomical model\n(from left to right) white matter, gray matter, CSF, and original image with 7%\nnoise. (b) Segmentation result of RFCM. (c) Segmentation result of IFCM.\nFig. 6. Parameter optimization in IFCM.\nperformance of various image analysis methods in a setting\nwhere the truth is known [19], [21]\u2013[24].\nA simulated -weighted MR (181 217 181) image was\ndownloaded from Brainweb. The discrete anatomical model of\nthe simulated image consisting of cerebral spinal fluid (CSF),\nwhite matter, and gray matter is shown in Fig. 5(a). 7% noise\nwas applied to each slice of the simulated image. The noisy\n100th brain region only slice is shown in Fig. 5(a). This noisy\nslice was segmented into four clusters: background, CSF, white\nmatter, and gray matter using FCM, IFCM, PCM, and RFCM;\nhowever, the background was neglected from the viewing re-\nsults. The segmentation results after applying RFCM and IFCM\nare shown in Fig. 5(b) and (c). Fig. 6 plots the tendency of the\ncost function in IFCM based on the various values of and .\nThe optimized values in the segmentation were\nand , determined over 23 iterations of ANN. A\nnoisy segmentation result was obtained from RFCM, and a clear\nsegmentation result was achieved by IFCM. The performance\nevaluation parameters of FCM, RFCM, PCM, and IFCM are\ncompiled in Table II.\n464 IEEE TRANSACTIONS ON INFORMATION TECHNOLOGY IN BIOMEDICINE, VOL. 9, NO. 3, SEPTEMBER 2005\nTABLE II\nSEGMENTATION EVALUATION ON SIMULATED T -WEIGHTED MR IMAGE\nFig. 7. Variation of (top) cost function E, and (bottom) InC with different\nnoise levels.\nTo further demonstrate the superior capabilities of IFCM at\ndealing with noise, different levels (0%\u201318%) of noise were se-\nquentially applied to the simulated -weighted MR image.\nThe noisy images were segmented using all methods. Fig. 7\nshows the cost functions and InC obtained from FCM,\nRFCM, and IFCM. An increase in the level of noise led to\nan increase of and InC for all methods. Below a 3% noise\nlevel, all three methods had a similar performance described\nby and InC. Above 3% noise, IFCM exhibited the most\nrobustness to noise, and reduced InC significantly within the\nnoise levels 7%\u201315%. Even with other noise levels, it achieves\na much lower , reflecting a more convincing segmentation.\nThe results for RFCM and FCM were close; however, RFCM\nhad a lower InC and was less convincing in segmentation.\nThis also indicates that the cost function may be regarded\nas an approximate measure to InC for evaluating segmentation\nFig. 8. Simulated PD-weighted MR image. (a) From left to right: noisy 80th\nslice, segmentation results of FCM and IFCM. (b) From left to right: noisy 100th\nslices, segmentation results of FCM and IFCM.\nperformance, especially when InC is not obtainable in real\nimages.\nA simulated proton density (PD)-weighted image was also\nused to validate the segmentation advantages of IFCM. 3% noise\nwas applied to the image (Fig. 8) which was then segmented\nusing both FCM and IFCM (to simplify the comparison, only\nFCM was compared to IFCM since other methods require an\noptimization process). Fig. 8(a) and (b) shows the segmentation\nresults. These indicate that whereas FCM is unable to segment\nthe slice correctly, and noise still remains present, IFCM pro-\nduced the better result with negligible residual noise.\nC. Real MR Images\nThe superiority of IFCM was also demonstrated on real\nMR images. A real MR image was downloaded from IBSR\nby the Center for Morphometric Analysis at Massachusetts\nGeneral Hospital. The web provides manually guided expert\nsegmentation results along with brain MRI data to encourage\nthe evaluation and development of segmentation methods. It is\nabrain only coronal -weighted image with a matrix size as\n256 256. The segmentation results of gray and white matter\nprovided were obtained for the spatially normalized scan by\ntrained investigators, using a semi-automated intensity contour\nmapping algorithm and also using signal intensity histograms\n[25], [26]. Fig. 9(a) shows the original 25th slice of the image\nwith 3% Gaussian noise and Fig. 9(b) shows the manual seg-\nmentation result provided by the web. For comparison with\nthe manual segmentation result, which included four classes,\nCSF, gray matter, white matter, and others, the cluster number\nwas set to 4. The segmentation results of FCM and IFCM are\nshown in Fig. 9(c) and (d) ( and within\n21 iterations of ANN). Table III lists the evaluation parameters\nfor both methods. IFCM showed a significant improvement\nover FCM parametrically, and eliminated the effect of noise\ncompletely.\nA further example of real MR images was chosen from our\nin-house image database. It is a real -weighted image with\n11% additive noise (unsigned 16-bit format). The preprocessing\nSHEN et al.: MRI FUZZY SEGMENTATION OF BRAIN TISSUE 465\nFig. 9. T -weighted image from IBSR. (a) Original image with 3%\nnoise. (b) Manual segmentation result. (c) Segmentation result of FCM.\n(d) Segmentation result of IFCM.\nTABLE III\nSEGMENTATION EVALUATION ON T -WEIGHTED MR IMAGE\nsteps including standardization, nonbrain region removal, and\ncontrast enhancement were applied to this image before seg-\nmentation. Nonstandard MRI intensity scales for same tissue\ntypes in different images leads to impossible intensity-based\nclassification. The traditional standardization method scales\neach MR image into the same maximum and minimum intensity\nvalues [27]. However, this is inappropriate to the classification\napproaches where the intensities may indicate the pathologic\ninformation. We proposed a method which standardizes MR\nimages into a prespecified standard deviation and mean; there-\nfore each standardized image had a similar histogram but also\nretained its original intensity features [28]. Nonbrain regions\nwere also removed using morphological operations and the\nintensity contrast between white matter and gray matter was\nenhanced using histogram equalization [29].\nThe preprocessed image was then segmented using the FCM\nand IFCM algorithms. The parameters and in IFCM were\nobtained as 0.5303 and 0.5707, using the ANN model within\n19 iterations. The cluster number was 4. The segmentation\nresults along with the preprocessing demonstration are shown\nin Fig. 10. Clearly, IFCM shows a superior performance than\nFCM. Both algorithms were also applied to the image with\nFig. 10. T -weighted MR image with 11% noise. (a) From left to right:\noriginal standardized image, brain only, and enhanced image. (b) From left to\nright: segmentation results of FCM and IFCM.\nFig. 11. Variation of E with noise levels.\ndifferent noise levels. As no ground truth was available, the\ncost function was employed as a performance evaluation\nparameter. Fig. 11 shows how the value of increases with\nthe noise level. A lower value of reflects the superior perfor-\nmance of IFCM compared to FCM.\nFinally, the segmentation performance of IFCM was com-\npared with the most recent published algorithm, SKFCM [18],\nand also other methods whose segmentation results were re-\nported at IBSR [20]. A comparison score (also called overlap\nmetric) used in both is introduced by the following equation:\n(15)\nwhere represents the pixels belong to the th class and\nrepresent the th reference class as the ground truth. In [18],\na simulated -weighted image with 3% noise was segmented\nby four methods. The highest score obtained among all clusters\nwas 0.88. The IFCM algorithm was tested on the same image\nand scored as 0.88 (CSF), 0.85 (gray matter), and 0.92 (white\nmatter).\nIBSR reported average scores of various methods such\nas FCM, maximum aposteriori probability (MAP), biased\nMAP, adaptive MAP, maximum likelihood, and tree-struc-\nture k-means, applied to a dataset including 20 normal brain\n-weighted MR images [20]. The highest score for gray\n466 IEEE TRANSACTIONS ON INFORMATION TECHNOLOGY IN BIOMEDICINE, VOL. 9, NO. 3, SEPTEMBER 2005\nmatter is 0.56 (adaptive MAP) and for white matter is 0.57\n(tree-structure k-means). IFCM was applied to the same dataset,\nand the average scores obtained were 0.53 (gray matter) and\n0.64 (white matter).\nAs tested on simulated MR images, IFCM reduced InC\ngreatly within the noise levels 7%\u201315%. Therefore, a more\nsignificant improvement over other methods can be expected\nfrom IFCM at higher noise levels.\nV. CONCLUSION\nMedical images generally contain unknown noise and consid-\nerable uncertainty, and therefore clinically acceptable segmen-\ntation performance is difficult to achieve. Traditional FCM is a\npopular segmentation method for medical images. However, it\nis an intensity-based clustering algorithm which is not robust\nto noisy images. Although many extended algorithms based on\nFCM have been developed to overcome this shortcoming, none\nof them are flawless. Usually, one pixel is too small to represent\npart of an image. Assuming a pixel has a completely different in-\ntensity from its surrounding pixels, it is reasonable to conclude\nthat this pixel must be affected by noise. Its real intensity should\nbe identical to its neighboring pixels. Therefore, it is assumed\nthat an attraction exists between neighboring pixels, which we\ncoin \u201cneighborhood attraction\u201d in this paper. With our proposed\nIFCM algorithm, during clustering, each pixel attempts to at-\ntract its neighboring pixels toward its own cluster.\nIf a pixel has a very similar intensity to one of its neighbors,\nthe attraction between them should be stronger than the attrac-\ntion between the pixel and another neighbor with rather different\nintensities. A spatially closer neighboring pixel should also have\na stronger attraction than a neighbor which is spatially distant.\nThe components of the neighborhood can also influence the at-\ntraction. Including neighborhood attraction, segmentation using\nIFCM is not only decided by the pixel itself but also by its neigh-\nboring pixels.\nIn MR images, the presence of noise or artefacts can change\nthe intensities of some pixels; these may be segmented more ap-\npropriately with the help of their neighboring pixels. Instead of\nmodifying the objective function, the measurement of similarity\nwas extended by considering neighborhood attraction. This in-\ncluded feature attraction and distance attraction, which account\nfor feature differences and relative spatial locations between\nneighboring pixels in the image. Compared to RFCM and other\nFCM-based methods, which modified the objective function and\nresulted in complex membership functions, IFCM conserved all\nformulas in FCM except for . Therefore, IFCM offers\nbetter continuity compared to the traditional FCM algorithm,\nand simpler computation. Additionally, the fundamental basis\nof IFCM is more straightforward and easier to understand.\nTwo parameters and control the degree of two factors in\nthe neighborhood attraction. A higher leads to a stronger fea-\nture attraction and a higher leads to a stronger distance attrac-\ntion. Optimized values of these parameters enable the best seg-\nmentation results to be achieved. However, inappropriate values\ncan be detrimental. An ANN model was developed to search\nfor optimum values of and , using a cost function decided\nby the objective function of segmentation and the dominating\nrate. The model generally finds the optimized parameter within\n30 iterations. It reduces the test validation times to 0.2%\u20130.3%\nof initial estimates. Images with the same MR modality can use\nthe same values of and , especially after standardization. The\ncost function of ANN can either validate the optimization of the\nparameters or even evaluate the segmentation performance.\nFCM, IFCM, and other FCM-based algorithms were tested on\na synthetic square image, simulated and real MR images, with\ndifferent noise levels. Three evaluation parameters were defined\nand measured the segmentation performance quantitatively on\nsimulated images and real images from IBSR due to the avail-\nability of ground truth. The cost function in the ANN model\nwas used to validate the results on real images where no ground\ntruth was available. Both quantitative performance and subjec-\ntive visual comparisons clearly demonstrated the superiority of\nthe proposed IFCM algorithm. A comparison score was intro-\nduced to compare the results of IFCM to the newly published\nFCM based method and also other methods reported by IBSR.\nIFCM scored higher than most other methods.\nFuture work will focus on developing the automatic image\nbased classification system for brain tumor using data mining.\nPreprocessing techniques will be enhanced that brain model fit-\nting may be considered to do the nonbrain region removal. More\ncomprehensive comparison of IFCM and the generalization of\nthe ANN model will be addressed.\nACKNOWLEDGMENT\nThe authors would like to thank Dr. M. F. Dempsey and\nDr. J. Patterson of the Southern General Hospital, Glasgow,\nU.K., for providing MR images and clinical advice. The au-\nthors would also like to express their sincere appreciation to the\nreviewers for their careful and thorough critical appraisement\nof an earlier draft of the paper.\nREFERENCES\n[1] H. Suzuki and J. Toriwaki, \u201cAutomatic segmentation of head MRI im-\nages by knowledge guided thresholding,\u201d Comput. Med. Imag. Graph.,\nvol. 15, no. 4, pp. 233\u2013240, 1991.\n[2] L. Lemieux, G. Hagemann, K. Krakow, and F. G. Woermann, \u201cFast,\naccurate, and reproducible automatic segmentation of the brain in\nT1-weighted volume MRI data,\u201d Magn. Reson. Med., vol. 42, pp.\n127\u2013135, 1999.\n[3] A. R. Robb, Biomedical Imaging, Visualization, and Analysis. New\nYork: Wiley, 2000.\n[4] R. Pohle and K. D. Toennies, \u201cSegmentation of medical images using\nadaptive region growing,\u201d Proc. SPIE\u2014 Med. Imag., vol. 4322, pp.\n1337\u20131346, 2001.\n[5] T. Y. Law and P. A. Heng, \u201cAutomated extraction of bronchus from 3D\nCT images of lung based on genetic algorithm and 3D region growing,\u201d\nProc. SPIE\u2014 Med. Imag., vol. 3979, pp. 906\u2013916, 2000.\n[6] W. M. Wells III, W. E. L. Grimson, R. Kikinis, and F. A. Jolesz, \u201cAdap-\ntive segmentation of MRI data,\u201d IEEE Trans. Med. Imag., vol. 15, no. 4,\npp. 429\u2013442, Aug. 1996.\n[7] K. V. Leemput, F. Maes, D. Vandermeulen, and P. Suetens, \u201cAutomated\nmodel-based tissue classification of MR images of the brain,\u201d IEEE\nTrans. Med. Imag., vol. 18, no. 10, pp. 897\u2013908, Oct. 1999.\n[8] C. L. Li, D. B. Goldgof, and L. O. Hall, \u201cKnowledge-based classification\nand tissue labeling of MR images of human brain,\u201d IEEE Trans. Med.\nImag., vol. 12, no. 4, pp. 740\u2013750, Apr. 1993.\n[9] L. O. Hall, A. M. Bensaid, L. P. Clarke, R. P. Velthuizen, M. S. Sil-\nbiger, and J. C. Bezdek, \u201cA comparison of neural network and fuzzy\nclustering techniques in segmenting magnetic resonance images of the\nbrain,\u201d IEEE Trans. Neural Netw., vol. 3, no. 5, pp. 672\u2013682, Sep. 1992.\n[10] D. L. Pham and J. L. Prince, \u201cAdaptive fuzzy segmentation of magnetic\nresonance images,\u201d IEEE Trans. Med. Imag., vol. 18, no. 9, pp. 737\u2013752,\nSep. 1999.\nSHEN et al.: MRI FUZZY SEGMENTATION OF BRAIN TISSUE 467\n[11] J. C. Bezek, Pattern Recognition with Fuzzy Object Function Algo-\nrithms. New York: Plenum, 1981.\n[12] Y. A. Tolias and S. M. Panas, \u201cOn applying spatial constraints in\nfuzzy image clustering using a fuzzy rule-based system,\u201d IEEE Signal.\nProcess. Lett., vol. 5, no. 10, pp. 245\u2013247, Oct. 1998.\n[13] S. T. Acton and D. P. Mukherjee, \u201cScale space classification using area\nmorphology,\u201d IEEE Trans. Image Process., vol. 9, no. 4, pp. 623\u2013635,\nApr. 2000.\n[14] R. N. R. N. Dave, \u201cCharacterization and detection of noise in clustering,\u201d\nPattern Recognit. Lett., vol. 12, pp. 657\u2013664, 1991.\n[15] R. R. Krishnapuram and J. M. Keller, \u201cA possibilistic approach to clus-\ntering,\u201d IEEE Trans. Fuzzy Syst., vol. 1, no. 2, pp. 98\u2013110, May 1993.\n[16] D. L. Pham, \u201cSpatial models for fuzzy clustering,\u201d Comput. Vis. Imag.\nUnderstand., vol. 84, pp. 285\u2013297, 2001.\n[17] M. N. Ahmed, S. M. Yamany, N. Mohamed, A. A. Farag, and T. Mori-\narty, \u201cA modified fuzzy c-means algorithm for bias field estimation and\nsegmentation of MRI data,\u201d IEEE Trans. Med. Imag., vol. 21, no. 3, pp.\n193\u2013199, Mar. 2002.\n[18] D. Q. Zhang and S. C. Chen, \u201cA novel kernelized fuzzy c-means al-\ngorithm with application in medical image segmentation,\u201d Artif. Intell.\nMed., vol. 32, pp. 37\u201352, 2004.\n[19] BrainWeb [Online]. Available: www.bic.mni.mcgill.ca\/brainweb\/\n[20] IBSR [Online]. Available: http:\/\/www.cma.mgh.harvard.edu\/ibsr\/\n[21] C. A. Cocosco, V. Kollokian, R. K. -S. Kwan, and A. C. Evans,\n\u201cBrainWeb: Online interface to a 3D MRI simulated brain database,\u201d\nNeuroImage, pt. 2\/4, vol. 5, no. 4, p. S425, 1997.\n[22] R. K. S. Kwan, A. C. Evans, and G. B. Pike, \u201cAn extensible MRI sim-\nulator for post-processing evaluation,\u201d in Visualization in Biomedical\nComputing (VBC\u201996). New York: Springer-Verlag, 1996, vol. 1131,\nLecture Notes in Computer Science, pp. 135\u2013140.\n[23] , \u201cMRI simulation-based evaluation of image-processing and\nclassification methods,\u201d IEEE Trans. Med. Imag., vol. 18, no. 11, pp.\n1085\u20131097, Nov. 1999.\n[24] D. L. Collins, A. P. Zijdenbos, V. Kollokian, J. G. Sled, N. J. Kabani, C. J.\nHolmes, and A. C. Evans, \u201cDesign and construction of a realistic digital\nbrain phantom,\u201d IEEE Trans. Med. Imag., vol. 17, no. 3, pp. 463\u2013468,\nJun. 1998.\n[25] D. N. Kennedy, P. A. Filipek, and V. S. Caviness, \u201cAnatomic seg-\nmentation and volumetric calculations in nuclear magnetic resonance\nimaging,\u201d IEEE Trans Med. Imag., vol. 8, no. 1, pp. 1\u20137, Mar. 1989.\n[26] P. A. Filipek, C. Richelme, D. N. Kennedy, and V. S. Caviness, \u201cThe\nyoung adult human brain: An MRI-based morphometric analysis,\u201d\nCereb. Cortex, vol. 4, no. 4, pp. 344\u2013360, 1994.\n[27] L. G. Ny\u00fal and J. K. Udupa, \u201cOn standardizing the MR image intensity\nscales,\u201d Magn. Reson. Imag., vol. 42, pp. 1072\u20131081, 1999.\n[28] S. Shen, W. A. Sandham, and M. H. Granat, \u201cPreprocessing and seg-\nmentation of magnetic resonance imaging,\u201d in Proc. 4th IEEE Annu.\nInt. Conf. Inform. Technol. Appl. Biomed., ITAB\u201903, U.K., 2003, pp.\n149\u2013152.\n[29] S. Shen, W. A. Sandham, M. H. Grant, J. Patterson, and M. F. Dempsey,\n\u201cFuzzy clustering based applications to medical image processing,\u201d in\nProc. IEEE EMBS 25th Annu. Int. Conf., 2003, pp. 747\u2013750.\nShan Shen received the B.S. and M.S. degrees in\ncommunication engineering and biomedical engi-\nneering from the University of Chongqing, China, in\n1997 and 2000, and the Ph.D. degree in electronic\nengineering and bioengineering from the University\nof Strathclyde, U.K., in 2004.\nIn 2003, she joined the Department of Psychology,\nUniversity of Surrey, Guildford, U.K., where she is\ncurrently a Research Fellow. Her research interests\ninclude structural and functional MR image analysis,\nmedical imaging, genetic programming, and neural\nnetworks.\nWilliam Sandham (M\u201986) received the B.Sc.(Hons.)\ndegree from the University of Glasgow, Glasgow,\nU.K., in 1974 and the Ph.D. degree from the Univer-\nsity of Birmingham, Birmingham, U.K., in 1981.\nHe was a Medical Physicist in the Department\nof Clinical Physics and Bioengineering, Glasgow,\nfrom 1974 to 1976, and was a Geophysicist with\nthe British National Oil Corporation and Britoil\nfrom 1980 to 1986. From 1986 to 2003, he was a\nLecturer\/Senior Lecturer\/Reader at the University\nof Strathclyde, Glasgow. He is currently Managing\nDirector of Scotsig, Glasgow, a signal processing consultancy\/training\/research\ncompany. His current biosignal research interests include MRI segmentation,\nECG data analysis and compression, blood glucose prediction for diabetics,\nsleep apneoa detection, prosthetic limb fitting, and medical ultrasound. He has\npublished over 130 technical papers and five books.\nDr. Sandham has served on the editorial boards of the IEEE TRANSACTIONS\nON CIRCUITS AND SYSTEMS PART II\u2014ANALOG AND DIGITAL SIGNAL\nPROCESSING (TCAS-II), and the EURASIP Journal on Applied Signal Pro-\ncessing. He has been an invited lecturer at a number of research institutions\nacross the U.K., Europe, and South America, and has acted as a consultant for\nBritish Gas, BP, Shell EXPRO, Appleton Laboratory, and C-CORE (Newfound-\nland), among others. He has served on the conference organizing committees of\nICASSP (Glasgow, 1989), TA-91 (Glasgow, 1991), and EUSIPCO (Edinburgh,\n1994).\nMalcolm Granat received the B.Sc. degree in\nmedical biochemistry from the University of Birm-\ningham, Birmingham, U.K., in 1980 and the Ph.D.\ndegree in bioengineering from the University of\nStrathclyde, Glasgow, U.K., in 1990. The subject of\nhis Ph.D. was the application of functional electrical\nstimulation to restore walking in incomplete spinal\ncord injured people.\nHe was a secondary school teacher for six years.\nHe is currently Chair of Research in the School of\nHealth and Social Care, Glasgow Caledonian Univer-\nsity, Glasgow, U.K. His major areas of interest are the development of functional\nelectrical stimulation (FES) based systems for the restoration of movement in\nneurological conditions, the clinical evaluation of novel therapies, and the de-\nvelopment of ambulatory monitoring systems. He has published extensively in\nthese areas.\nAnnette Sterr received degrees in psychology and\nbiology in 1995 and the Ph.D. degree in 1998 from\nthe University of Konstanz, Germany.\nShe was a Research Fellow at the University of\nCalifornia, San Diego, from 1995 to 1996. From\n2000 to 2003, she was a Lecturer\/Reader at the\nUniversity of Liverpool, U.K., where she established\nthe Luria Laboratory for Clinical Neuroscience. She\nis currently the Chair in Cognitive Neuroscience &\nNeuropsychology, University of Surrey, Guildford,\nU.K. She has published in high-ranking journals\nsuch as Nature, Journal of Neuroscience and Neurology. Her research interests\ninclude constraint-induced movement therapy, motor rehabilitation, neuropsy-\nchology of acquired brain injury, cognition, and functional brain organization.\nDr. Sterr received Young Scientist awards in Japan and Germany in 1997 and\n1998. She was chosen by the MRC as one of their Career Development Fellows\nin 2002.\n"}