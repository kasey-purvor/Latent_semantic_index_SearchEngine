{"doi":"10.1214\/aoap","coreId":"66136","oai":"oai:dro.dur.ac.uk.OAI2:3005","identifiers":["oai:dro.dur.ac.uk.OAI2:3005","10.1214\/aoap"],"title":"Critical random walks on two-dimensional complexes with applications to polling systems.","authors":["MacPhee,  I. M.","Menshikov,  M. V."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2003-11-01","abstract":"We consider a time-homogeneous random walk Xi = {xi (t)} on a two-dimensional complex. All of our results here are formulated in a constructive way. By this we mean that for any given random walk we can, with an expression using only the first and second moments of the jumps and the return probabilities for some transient one-dimensional random walks, conclude whether the process is ergodic, null-recurrent or transient. Further we can determine when pth moments of passage times tau(K) to sets S-K = {x: parallel toxparallel to less than or equal to K} are finite (p > 0, real). Our main interest is in a new critical case where we will show the long-term behavior of the random walk is very similar to that found for walks with zero mean drift inside the quadrants. Recently a partial case of a polling system model in the critical regime was investigated by Menshikov and Zuyev who give explicit results in terms of the parameters of the queueing model. This model and some others can be interpreted as random walks on two-dimensional complexes","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/66136.pdf","fullTextIdentifier":"http:\/\/dro.dur.ac.uk\/3005\/1\/3005.pdf","pdfHashValue":"eb37c610785dc21b6d63c2d0ecb16dcead84fd2d","publisher":"Institute of Mathematical Statistics","rawRecordXml":"<record><header><identifier>\n  \n    \n      oai:dro.dur.ac.uk.OAI2:3005<\/identifier><datestamp>\n      2016-09-22T13:02:27Z<\/datestamp><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        Critical random walks on two-dimensional complexes with applications to polling systems.<\/dc:title><dc:creator>\n        MacPhee,  I. M.<\/dc:creator><dc:creator>\n        Menshikov,  M. V.<\/dc:creator><dc:description>\n        We consider a time-homogeneous random walk Xi = {xi (t)} on a two-dimensional complex. All of our results here are formulated in a constructive way. By this we mean that for any given random walk we can, with an expression using only the first and second moments of the jumps and the return probabilities for some transient one-dimensional random walks, conclude whether the process is ergodic, null-recurrent or transient. Further we can determine when pth moments of passage times tau(K) to sets S-K = {x: parallel toxparallel to less than or equal to K} are finite (p > 0, real). Our main interest is in a new critical case where we will show the long-term behavior of the random walk is very similar to that found for walks with zero mean drift inside the quadrants. Recently a partial case of a polling system model in the critical regime was investigated by Menshikov and Zuyev who give explicit results in terms of the parameters of the queueing model. This model and some others can be interpreted as random walks on two-dimensional complexes. <\/dc:description><dc:subject>\n        Random walk<\/dc:subject><dc:subject>\n         Two-dimensional complex<\/dc:subject><dc:subject>\n         Transience<\/dc:subject><dc:subject>\n         Recurrence<\/dc:subject><dc:subject>\n         Passage time moments<\/dc:subject><dc:subject>\n         Polling systems.<\/dc:subject><dc:publisher>\n        Institute of Mathematical Statistics<\/dc:publisher><dc:source>\n        Annals of applied probability, 2003, Vol.13(4), pp.1399-1422 [Peer Reviewed Journal]<\/dc:source><dc:date>\n        2003-11-01<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:identifier>\n        dro:3005<\/dc:identifier><dc:identifier>\n        issn:1050-5164<\/dc:identifier><dc:identifier>\n        doi:10.1214\/aoap\/1069786503<\/dc:identifier><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/3005\/<\/dc:identifier><dc:identifier>\n        http:\/\/dx.doi.org\/10.1214\/aoap\/1069786503<\/dc:identifier><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/3005\/1\/3005.pdf<\/dc:identifier><dc:accessRights>\n        info:en-repo\/semantics\/openAccess<\/dc:accessRights><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["issn:1050-5164","1050-5164"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2003,"topics":["Random walk","Two-dimensional complex","Transience","Recurrence","Passage time moments","Polling systems."],"subject":["Article","PeerReviewed"],"fullText":"Durham Research Online\nDeposited in DRO:\n17 May 2010\nVersion of attached file:\nPublished Version\nPeer-review status of attached file:\nPeer-reviewed\nCitation for published item:\nMacPhee, I. M. and Menshikov, M. V. (2003) \u2019Critical random walks on two-dimensional complexes with\napplications to polling systems.\u2019, Annals of applied probability., 13 (4). pp. 1399-1422.\nFurther information on publisher\u2019s website:\nhttp:\/\/dx.doi.org\/10.1214\/aoap\/1069786503\nPublisher\u2019s copyright statement:\nAdditional information:\nUse policy\nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without prior permission or charge, for\npersonal research or study, educational, or not-for-profit purposes provided that:\n\u2022 a full bibliographic reference is made to the original source\n\u2022 a link is made to the metadata record in DRO\n\u2022 the full-text is not changed in any way\nThe full-text must not be sold in any format or medium without the formal permission of the copyright holders.\nPlease consult the full DRO policy for further details.\nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom\nTel : +44 (0)191 334 3042 \u2014 Fax : +44 (0)191 334 2971\nhttp:\/\/dro.dur.ac.uk\nThe Annals of Applied Probability\n2003, Vol. 13, No. 4, 1399\u20131422\n\u00a9 Institute of Mathematical Statistics, 2003\nCRITICAL RANDOM WALKS ON TWO-DIMENSIONAL\nCOMPLEXES WITH APPLICATIONS TO\nPOLLING SYSTEMS\nBY I. M. MACPHEE AND M. V. MENSHIKOV\nUniversity of Durham\nWe consider a time-homogeneous random walk \u0001 = {\u03be(t)} on a two-\ndimensional complex. All of our results here are formulated in a constructive\nway. By this we mean that for any given random walk we can, with an\nexpression using only the first and second moments of the jumps and\nthe return probabilities for some transient one-dimensional random walks,\nconclude whether the process is ergodic, null-recurrent or transient. Further\nwe can determine when pth moments of passage times \u03c4K to sets SK =\n{x :\u2016x\u2016 \u2264 K} are finite (p > 0, real). Our main interest is in a new critical\ncase where we will show the long-term behavior of the random walk is very\nsimilar to that found for walks with zero mean drift inside the quadrants.\nRecently a partial case of a polling system model in the critical regime was\ninvestigated by Menshikov and Zuyev who give explicit results in terms of\nthe parameters of the queueing model. This model and some others can be\ninterpreted as random walks on two-dimensional complexes.\n1. Introduction. This paper has two distinct parts. In the first and much the\nlarger part we consider a time-homogeneous random walk \u0001 = {\u03be(t)} on a two-\ndimensional complex. A two-dimensional complex is a union of a finite number\nof quarter plane lattices Z2+ connected at boundaries where one component on\neach of a specified set of quadrants takes value 0. We are going to consider the\nspecific case where each boundary belongs to only two quarter planes and the\ndrifts combine to take the walk around a cycle. An easy case to picture is the union\nof the four quarter planes on Z2, see Figure 1, though for notational convenience\nwe will actually embed a complex with n quarter planes in Rn. Many features of\nthe general case are discussed in [4] and [6] but our case is not treated there as\nadditional techniques and ideas are needed. We will not discuss the general case\nhere.\nAll of our results here are formulated in a constructive way. By this we mean\nthat for any given random walk we can, with an expression using only the first\nand second moments of the jumps and the return probabilities for some transient\none-dimensional random walks, conclude whether the process is ergodic, null-\nrecurrent or transient. Further we can determine when pth moments of passage\ntimes \u03c4K to sets SK = {x :\u2016x\u2016 \u2264 K} are finite (p > 0, real). To do this we use the\nReceived July 2001; revised July 2002.\nAMS 2000 subject classifications. Primary 60G42, 60J10; secondary 90B22.\nKey words and phrases. Random walk, two-dimensional complex, transience, recurrence, pas-\nsage time moments, polling systems.\n1399\n1400 I. M. MACPHEE AND M. V. MENSHIKOV\nLyapunov function method, that is, we demonstrate that a well chosen function\nof the underlying random walk is a sub(super)martingale and then use the results\nof [9] and [2] for one-dimensional discrete time stochastic processes. We have\nrestricted ourselves to the two-dimensional case as it is only here that we can\ngive precise necessary and sufficient conditions for recurrence or transience of the\nrandom walk and the finiteness or otherwise of the pth moments of the passage\ntimes.\nOur main interest is in a new critical case where we will show the long-term\nbehavior of the random walk is very similar to that found for walks with zero mean\ndrift inside the quadrants in [5, 6, 3, 2] and for zero drift Brownian motion with\nreflections in [14] and [12]. In our problem the mean drifts are not zero so the local\nbehavior of this process is quite different from that of the walk with zero mean drift\ninside the quadrants. Nevertheless, the global behavior of the system is similar\nto the zero mean drift case in that the tail of the stationary measure will decay\npolynomially, not exponentially, over the state space in the ergodic case. Further in\nthis case the distribution of the process will converge over time polynomially, not\nexponentially, to the stationary measure. We do not show this explicitly here but\nit follows directly from our calculations of passage time moments via the results\nof [11]. It seems to us that this process is interesting as it exhibits this behavior\nwithout any regions of zero drift or heavy tailed jumps.\nIt is clear that the Lyapunov function method can be applied in more than\ntwo dimensions. For example, [10] contains an almost complete classification of\nrandom walks on Z3+. The main result of that paper also appears as Theorem 4.4.5\nof [6]. In the notation of that book the case which was not considered\nK\u02dc \u2261\n\u2223\u2223\u2223\u2223\u2223v\n{2,3}\n2\nv\n{2,3}\n3\nv\n{1,3}\n3\nv\n{1,3}\n1\nv\n{1,2}\n1\nv\n{1,2}\n2\n\u2223\u2223\u2223\u2223\u2223= 1\nis very similar to the main subject of this paper. The completion of the classification\nand even finding sufficient conditions for ergodicity of walks on Z3+ when K\u02dc = 1\nis still an open problem.\nThe ideas in [2] for discrete processes were used in [12] to obtain criteria\nfor finiteness of passage time moments for continuous nonnegative stochastic\nprocesses and Brownian motion with zero drift in a wedge. It seems to us that\nthe ideas of our paper can be modified to treat reflected Brownian motion on two-\ndimensional complexes with internal skew reflections when the drift is nonzero.\nIn the second part of the paper we use the results of the first part to investigate\nthe properties of polling and similar systems in the critical regime\u2014in a polling\nsystem customers arrive at various nodes where they queue for service from\na single server which visits the nodes, serving all tasks queueing at a node\nbefore moving on to another; see [7]. Recently a partial case of the polling\nsystem model was investigated in [13] which gives explicit results in terms of\nthe parameters of the queueing model. This part of the present paper can be\nCRITICAL RANDOM WALKS ON COMPLEXES 1401\nregarded as a generalization of the results of [13]. It is not our goal here to study a\nspecific queueing model but just to show how such problems can be recast in the\nterminology of random walks on two-dimensional complexes. We only consider\nsystems where there are two service nodes but we permit a variety of regimes,\ncorresponding to the quarter planes of the complex, in which the behavior of the\nserver and system are different. Each regime has its own set of system parameters,\nfor example, arrival rates, service time distributions. These are restricted by the\nrequirement that we can find an embedded point process which is a random walk\non a two-dimensional complex. This allows for regimes where both nodes receive\nservice simultaneously with service times being independent and exponentially\ndistributed, as well as regimes where service times are nonexponential but one\nnode receives all of the service. There may well be other possibilities.\n2. Preliminaries and notation. We start by specifying the way in which the\nplanes are connected and need to assume some regularity properties of the one-step\ntransition probabilities.\nFaces and their connections.\n1. For any set of integers 1 \u2264 i1 < \u00b7 \u00b7 \u00b7 < ik \u2264 n, k \u2265 1, a face of Rn+ is the set\nB\u2227 \u2261 \u2227(i1, . . . , ik) = {x \u2208 Rn :xi > 0, i \u2208 {i1, . . . , ik}; xi = 0 otherwise}.\n2. \u0001 lives on the collection L= C \u2229 Zn+ where\nC =\u22c3\n\u2227\nB\u2227 with \u2227 \u2208 {{i}, i = 1, . . . , n; {i, i + 1}, i = 1, . . . , n\u2212 1; {n,1}}.\nWe will use the notation Ai \u2261 B\u2227 \u2229 Zn+ where \u2227 = {i}, i = 1, . . . , n, and\nBi \u2261 B\u2227 \u2229Zn+ where \u2227 = {i, i+1}, i = 1, . . . , n\u22121, with \u2227 = {n,1} for i = n.\nNote that we are interested in L as an essentially two-dimensional object and\nconsider it as embedded in Rn for notational convenience only. When we refer\nto coefficients xi of x \u2208 L with i = n + 1 or i = 0 we will interpret this as\nreferring to x1 or xn, respectively.\n3. The one-step transition probabilities pxy \u2261 P (\u03be(t + 1) = y|\u03be(t) = x) = 0\nunless one of the following conditions holds:\n\u2022 x \u2208 Bi , y \u2208 Ai \u222aBi \u222aAi+1 (which means An \u222aBn \u222aA1 when i = n);\n\u2022 x \u2208 Ai , y \u2208 Bi\u22121 \u222aAi \u222aBi (meaning Bn \u222aAn \u222aB1 when i = n).\nWhen n = 4, C sits very nicely in the plane as is depicted in Figure 1.\nIrreducibility and aperiodicity. We will assume throughout that \u0001 is irre-\nducible and aperiodic. This is not necessary for our arguments but no interesting\nphenomena are lost and it simplifies exposition.\n1402 I. M. MACPHEE AND M. V. MENSHIKOV\nFIG. 1. The space C when n = 4.\nHomogeneity of jumps. We assume homogeneity of jumps outside some finite\nset B0 containing the origin. If x, x\u02c6 \/\u2208 B0 belong to the same face (Ai or Bi) and\ny\u02c6 \u2212 x\u02c6 = y \u2212 x then we assume px\u02c6y\u02c6 = pxy .\nJumps are bounded below. We require pxy = 0 when, for any i, x \u2208 Bi \\B0\nand y\u2212x has any component less than \u22121 or when x \u2208 Ai \\B0 and (y\u2212x)i < \u2212\u03ba\nfor some finite \u03ba \u2208 Z+.\nThe assumption that jumps from Bi are bounded below by \u22121 is forced if\nwe wish to maintain both homogeneity and restrict the chain to jumps between\nadjacent planes only by passing through their shared axis Ai .\nNotation for expected jump sizes. It is necessary to assume the existence of\ncertain moments of the jump distributions within the faces and on the boundaries\nconnecting them. Let\nM(x) = \u2211\ny\u2208L\n(y \u2212 x)pxy for every x \u2208L\nso M(x) is formally an n-vector and when x \u2208 Bi , M(x) is the drift vector of\nthe process \u0001. M(x) does not have any interpretation as a vector when x \u2208 Ai\nbut its three potentially nonzero components M(x)i\u22121, M(x)i and M(x)i+1 are\nimportant in the critical case K = 1 to be defined below [our notational convention\nis that M(x)i+1 refers to M(x)1 when i = n]. By the homogeneity assumption,\nM(x) = M(y) when x and y are in the same plane Bi or the same axis Ai and\noutside B0. For p > 1 let\nM(p)(x) = \u2211\ny\u2208L\n\u2016y \u2212 x\u2016ppxy for every x \u2208L(1)\ndenote the pth moment of the jump length. Here \u2016z\u2016 denotes the standard\nEuclidean distance.\nCRITICAL RANDOM WALKS ON COMPLEXES 1403\nFIG. 2. Drift vectors for the random walk.\nWe need the following notation:\nMi0 = M(x)i and Mi1 = M(x)i+1, x \u2208 Bi \\B0,\nare the components of the drift vector M(x) in the face Bi while for x \u2208 Ai \\B0\nM+i 0 =\n\u2211\ny\u2208Bi\n(y \u2212 x)ipxy, M+i 1 =\n\u2211\ny\u2208Bi\n(y \u2212 x)i+1pxy (jumps into Bi),\nM\u2212i0 =\n\u2211\ny\u2208Bi\u22121\n(y \u2212 x)ipxy, M\u2212i1 =\n\u2211\ny\u2208Bi\u22121\n(y \u2212 x)i\u22121pxy (jumps into Bi\u22121)\nand finally,\nM0i =\n\u2211\ny\u2208Ai\n(y \u2212 x)ipxy (jumps along Ai)\nare the various expected jump sizes into the faces of L which are accessible\nfrom Ai . They are depicted in Figure 2.\nMoment assumptions.\n1. M(\u03b3 )(x) is finite for some \u03b3 > 2 for every x \u2208 L [in particular M(x) is finite\nfor every x]. For x \u2208 Bi \\B0 we will use the notation\n\u03bbi0 =\n\u2211\ny\u2208L\n(\n(y \u2212 x)i)2pxy, Ri = \u2211\ny\u2208L\n(\n(y \u2212 x)i(y \u2212 x)i+1)pxy,\n\u03bbi1 =\n\u2211\ny\u2208L\n(\n(y \u2212 x)i+1)2pxy\nfor second moments of the jumps within Ai \u222aBi \u222aAi+1.\n1404 I. M. MACPHEE AND M. V. MENSHIKOV\nK < 1 K > 1 K = 1\nFIG. 3.\n2. Mi0 < 0, Mi1 > 0 for every i. We define the angles \u03b1i \u2261 arctanMi1\/|Mi0| and\nfrom these\nK \u2261\nn\u220f\ni=1\nMi1\n|Mi0| =\nn\u220f\ni=1\ntan\u03b1i.(2)\nWe will give a complete classification of the long-term behavior of \u0001 in the\nthree cases K < 1 (ergodicity), K > 1 (transience) and K = 1. The main new\nresults are for this critical case K = 1. Figure 3 shows geometrically that in this\ncase, following a connected series of drift vectors through the faces Bi , ignoring\nwhat happens at the crossing of the axes Ai , we return to our starting point. It is\nthis that makes \u0001 critical.\n3. The cases K < 1 and K > 1. We will make extensive use of a result\nof Lamperti [8] and its generalization by Aspandiiarov, Iasnogorodski and\nMenshikov in [2] to deal with the critical case. The noncritical cases with K \t= 1\ncan be resolved with some general Foster-type results from the book by Fayolle,\nMalyshev and Menshikov. To apply them we must first investigate the behavior of\ncertain induced chains as defined in \u00a74 of [6].\nThe Markov chain Xi induced on Ai is the one-dimensional Markov chain on Z\nwith transition probabilities defined as follows. Let Lim(j) = {y \u2208 Bi :yi+m = j}\nfor m = 0, 1. Next for x \u2208 Bi \\B0 and k \u2265 \u22121, define\nq+i (k) = P\n(\n\u03bei+1(t + 1) = xi+1 + k|\u03be(t) = x)= \u2211\ny\u2208Li1(xi+1+k)\npxy .(3)\nFor x \u2208 Ai \\B0 define q0i (0) =\n\u2211\ny\u2208Ai pxy and\nq0i (k) =\n\uf8f1\uf8f4\uf8f4\uf8f4\uf8f2\n\uf8f4\uf8f4\uf8f4\uf8f3\nP\n(\n\u03bei+1(t + 1)= k|\u03be(t) = x)= \u2211\ny\u2208Li1(k)\npxy, k > 0,\nP\n(\n\u03bei\u22121(t + 1)= \u2212k|\u03be(t) = x)= \u2211\ny\u2208Li\u22121,0(\u2212k)\npxy, k < 0,\nCRITICAL RANDOM WALKS ON COMPLEXES 1405\nwhile for x \u2208 Bi\u22121 \\B0 and k \u2264 1, define\nq\u2212i (k) = P\n(\n\u03bei\u22121(t + 1)= xi\u22121 \u2212 k|\u03be(t) = x)= \u2211\ny\u2208Li\u22121,0(xi\u22121\u2212k)\npxy,\nwhere homogeneity within the faces Ai and Bi ensures that these are all well\ndefined. Now we define\nP\n(\nXi(t + 1)= j + k|Xi(t) = j)=\n\uf8f1\uf8f4\uf8f4\uf8f2\n\uf8f4\uf8f4\uf8f3\nq+i (k), j > 0, k \u2265 \u22121,\nq0i (k), j = 0,\nq\u2212i (k), j < 0, k \u2264 1,\n(4)\nso that Xi captures the behavior of \u0001 orthogonal to Ai on the collection of faces\nBi\u22121 \u222aAi \u222aBi .\nOur assumptions on the moments of \u0001 immediately imply that\u2211\nk\nkq+i (k) = Mi1 > 0 and\n\u2211\nk\nkq\u2212i (k) = \u2212Mi\u22121,0 > 0\nand as the state 0 cannot be absorbing it follows from homogeniety that 0 is a\ntransient state for Xi . Hence the expected number of visits to 0 by Xi is finite and\nin the terminology of [6], each of the axes Ai are transient faces while the Bi are\nergodic faces.\nThe following Theorem 1 states Theorems 2.1.2 and 2.1.10 of [6] which\ndescribe how the drifts of a process can be used to determine its transience or\nergodicity.\nLet {Si, i \u2265 0} be a sequence of nonnegative random variables with S0 constant\nand Sn measurable with respect to Fn = \u03c3(\u03be0, . . . , \u03ben) for n \u2265 1. Let {Ni, i \u2265\n0} be an increasing sequence of stopping times adapted to {Fn} with N0 = 0\nand let Y0 = S0 and Yi = SNi for i \u2265 1. Also, for constant D > 0, let \u03c4 =\nmin{n \u2265 1 :Sn \u2264 D} and \u03c3 = min{i \u2265 1 :Yi \u2264 D}. Finally, let {Xi\u2227\u03c3 } denote\na sequence {Xi} stopped at \u03c3 and IE be the indicator function of an event E.\nTHEOREM 1. (i) If S0 >D and for some \u03b5 > 0 and all n \u2265 0,\nE\n(\nY(n+1)\u2227\u03c3 |FNn\u2227\u03c3\n)\u2264 Yn\u2227\u03c3 \u2212 \u03b5E(N(n+1)\u2227\u03c3 \u2212Nn\u2227\u03c3 |FNn\u2227\u03c3 ) a.s.,\nthen E(\u03c4 )\u2264 S0\/\u03b5 < \u221e.\n(ii) If S0 > D, the jumps Sn+1 \u2212 Sn are uniformly bounded below and there\nexists \u03b5 > 0 and a positive constant b such that for every n \u2265 0,\nE\n(\n(Sn+1 \u2212 Sn)I{Sn+1\u2212Sn<b}|Fn\n)\u2265 \u03b5 a.s.,\nthen P(\u03c4 = \u221e) > 0.\nNow we will use Theorem 1 to prove the main result of this section.\n1406 I. M. MACPHEE AND M. V. MENSHIKOV\nTHEOREM 2. If K < 1, then \u0001 is ergodic while if K > 1 then \u0001 is transient.\nPROOF. We will use Theorem 1 with Sn = f (\u03ben) for a suitable Lyapunov\nfunction f . Let \u03c0i = \u220fi\u22121j=1 tan\u03b1j and consider the function f , where for x \u2208\nAi \u222aBi , 1 \u2264 i \u2264 n \u2212 1,\nf (x) = xi\n\u03c0iu\ni\u22121 +\nxi+1\n\u03c0i+1ui\n(5)\nwith f (x) = uxn + x1 for x \u2208 An \u222a Bn where u = K\u22121\/n. This function is\nnonnegative, piecewise linear and for x \u2208 Bi \\ B0 and v = M(x) we calculate\nfor each i\n\u03b4i \u2261 E(f (\u03be(t + 1))\u2212 f (\u03be(t))|\u03be(t) = x)\n= f (x + v)\u2212 f (x) = 1\n\u03c0i+1ui\n(uMi0 tan\u03b1i +Mi1).\nHence for all i, if K < 1 then u > 1 and so \u03b4i < 0 while for K > 1 we have u < 1\nand so \u03b4i > 0. Figure 4 shows how the contours of f relate to the drift vectors\nM(x), x \u2208 Bi \\B0 for each i in the case K < 1.\nLet \ftf = f (\u03be(t + 1)) \u2212 f (\u03be(t)) and ai = E(\ftf |\u03be(t) = x) for x \u2208 Ai \\B0.\nIn the case K < 1, for any integer k > 0 and x \u2208 Ai with \u2016x\u2016 large enough that\n\u03be(t + j) \/\u2208B0 a.s. for 0 \u2264 j \u2264 k \u2212 1,\nE\n(\n\ft+j f |\u03be(t) = x)\n= E(\ft+j f (I{\u03be(t+j)\u2208Ai} + I{\u03be(t+j)\u2208Bi\u22121\u222aBi })|\u03be(t) = x)\n\u2264 aiE(I{\u03be(t+j)\u2208Ai}|\u03be(t) = x)+ \u03b4(1 \u2212 E(I{\u03be(t+j)\u2208Ai}|\u03be(t) = x))\nby the tower property of conditional expectation, where \u03b4 = max1\u2264i\u2264n \u03b4i < 0.\nTelescoping these together we have\nE\n(\nf (\u03be(t + k))\u2212 f (\u03be(t))|\u03be(t) = x)\n=\nk\u22121\u2211\nj=0\nE\n(\n\ft+j f |\u03be(t) = x)\n\u2264 k\u03b4 + (ai \u2212 \u03b4)E(Vi(k)|\u03be(t) = x),\nwhere Vi(k) denotes the number of times \u0001 visits Ai between times t and t+k\u22121.\nAs Ai is transient, E(Vi(k)|\u03be(t) = x) is uniformly bounded for every k and so for\nsome large enough ki and \u03b5 = \u2212\u03b4\/2, we have\nE\n(\nf (\u03be(t + ki))\u2212 f (\u03be(t))|\u03be(t) = x)\u2264 \u2212\u03b5ki\nfor x \u2208 Ai \\B0 with \u2016x\u2016 large enough. Hence, by choosing\nk(x) =\n{1, x \u2208 Bi , i = 1, . . . , n,\nki, x \u2208 Ai , i = 1, . . . , n,\nCRITICAL RANDOM WALKS ON COMPLEXES 1407\nFIG. 4. Drift vectors relative to contour of f in the case K < 1.\nand setting St = f (\u03be(t)) and Ni+1 = Ni + k(\u03be(Ni)), i \u2265 1, the conditions of the\nfirst part of Theorem 1 are satisfied. As f satisfies c1\u2016x\u2016 \u2264 |f (x)| \u2264 c2\u2016x\u2016 for\nsome constants c2 > c1 > 0, it follows that the expected hitting time of \u0001 to\n{x \u2208 L :\u2016x\u2016 \u2264 D} (with D suitably large) is finite and so by irreducibility and\naperiodicity \u0001 is ergodic.\nIn the case K > 1 we can, by integrability and homogeneity, choose a truncation\nlevel b so that for x \u2208 Bi \\B0,\n\u03b4\u02dci = E(\ftf I{\ftf<b}\u2223\u2223\u03be(t) = x)> \u03b4i\/2 > 0\nfor i = 1, . . . , n. Now take \u03b5 = min1\u2264i\u2264n \u03b4\u02dci > 0 and as above, choose k(x) = 1 for\nx \u2208 Bi while for x \u2208 Ai for each i, choose k(x) = ki large enough that\nE\n(\nf (\u03be(t + ki))\u2212 f (\u03be(t))|\u03be(t) = x)\u2265 ki \u03b4\u02dc + (ai \u2212 \u03b4\u02dc)E(Vi(ki)|\u03be(t) = x)\u2265 \u03b5.\nDefining the stopping times Ni as in the ergodic case but this time setting\nSi = f (\u03be(Ni)), we see by the second part of Theorem 1 that the hitting time to\n{x \u2208 L :\u2016x\u2016 \u2264 D} from x0 with \u2016x0\u2016 > D for the imbedded process \u03be(Ni) is\ninfinite with positive probability. By lower boundedness of the jumps and uniform\nboundedness of the Ni+1 \u2212Ni it follows from standard results that \u0001 is transient.\n\u0001\nREMARK. Only the existence of a first moment, that is, M(x) is required\nfor this result. The theorem shows that (under the moment condition) the jump\nbehavior from the faces Ai does not affect the transience\/ergodicity of the process.\nOur \u03b3 > 2 moment condition is required to deal with the critical case K = 1 of the\nnext section. In this critical case the jump behavior on the Ai is crucially important\nas no f allowing us to use Theorem 1 exists.\n1408 I. M. MACPHEE AND M. V. MENSHIKOV\n4. Transience and recurrence in the critical case. When K = 1 there are\nvarious possibilities for the behavior of the process \u0001. We will find conditions\nwhich ensure the transience, null-recurrence or ergodicity respectively of \u0001.\nOur method is to produce a Lyapunov function f of the states x such that the\nprocess f (\u0001) satisfies exactly the right Lamperti conditions on its mean drifts\nas specified in the following result of Menshikov and Zuyev (see [13]) which is\nin turn a variant of Theorem 3.2 in [8]. No function satisfying the conditions of\nTheorem 1 exists in this critical case.\nTHEOREM 3. Let X be a time-homogeneous Markov chain on a countable\nstate space A = {\u03b1n}. Assume that there exists a positive function f :A \u2192 R+\nwith the following properties:\nlim\nn\u2192\u221ef (\u03b1n) = +\u221e(6)\nand there exist constants C0, \u03b4 > 0 such that\nE\n(|f (X(t + 1))\u2212 f (X(t))|2+\u03b4 \u2223\u2223X(t) = \u03b1n)\u2264 C0 for all n.(7)\nLet\nan = f (\u03b1n) \u00b7 E(f (X(t + 1))\u2212 f (X(t))|X(t) = \u03b1n),\nbn = E((f (X(t + 1))\u2212 f (X(t)))2\u2223\u2223X(t) = \u03b1n).\nThen X is recurrent if lim sup(2an \u2212 bn) < 0, and X is transient if lim inf(2an \u2212\nbn) > 0.\nPROOF. See Theorem 1 in [13]. The proof uses the well-known Foster\u2019s\ncriteria which can be found in [1] or [6]. \u0001\nTo exhibit our Lyapunov function we need to calculate a couple of properties of\nthe one-dimensional walk induced from \u0001 onto Ai as introduced in the previous\nsection.\nLEMMA 1. Let Xi denote the one-dimensional random walk on Z induced\nfrom \u0001 onto Ai with one-step transition probabilities as defined in (4). Then Xi is\ntransient and there is a unique constant si \u2208 [0,1) such that\nP\n(\nXi ever hits 0|Xi(0) = j)= sji , j > 0.\nFurther, the process sXi(t)i satisfies E(sXi(t+1)i |Xi(t)) = sXi(t)i on {Xi(t) > 0} and\nui \u2261 P (Xi exits 0 and never returns) =\n\u221e\u2211\nj=1\nq0i (j)(1 \u2212 sji ) > 0.(8)\nCRITICAL RANDOM WALKS ON COMPLEXES 1409\nPROOF. These are routine calculations. When \u0001 cannot make jumps to-\nward Ai from within Bi , that is, q+i (\u22121) = 0 we will set si = 0. Otherwise\nsi is calculated as the unique root in (0,1) of the equation Gi(z) = 1 where\nGi(z) =\u2211\u221ex=\u22121 q+i (x)zx is the one-step transition probability generating function\nof Xi from states j > 0. Our moment assumptions ensure that Gi is a smooth\nfunction of z with G\u2032i(si) < 0 when si > 0 so for z \u2208 (si,1) we have the in-\nequality E(zXi(t+1)|Xi(t)) < zXi(t) on {Xi(t) > 0}, while for z \u2208 (0, si) we have\nE(zXi(t+1)|Xi(t)) > zXi(t).\nNote that Xi , when started from state j < 0, is certain to visit state 0 eventually\nso transitions to such states make no contribution to ui . As the number of upward\nexcursions from 0, including the eventual infinite excursion, is geometrically\ndistributed we can interpret 1\/ui as the expected number of such excursions from 0\nfor the process Xi . The analogue of these for \u0001 are excursions from Ai into Bi .\n\u0001\nIn order to state the main theorem of this section we need to define two sets of\nconstants that express the crucial properties of the underlying random walk \u0001. Let\n\u03c0i =\u220fi\u22121j=1 tan\u03b1j with \u03c00 = 1\/ tan\u03b1n, \u03c0n+1 = \u03c01 = 1 and define Ci , i = 1, . . . , n,\nto be the unique constants satisfying[\nM\u2212i 1\n\u03c0i\u22121\n+ M\n\u2212\ni 0 +M0i +M+i 0\n\u03c0i\n+ M\n+\ni 1\n\u03c0i+1\n]\n+Ciui = 0.(9)\nFurther for any constant p \u2208 [0,1] define for each i = 1, . . . , n,\nhi(p) =\n(\np \u2212 1\n2\n)(\n\u03bbi0 tan\u03b1i + 2Ri + \u03bbi1\/ tan\u03b1i\n\u03c0i\u03c1i sin\u03b1i\n)\n,(10)\nwhere \u03c1i = \u2016M(x)\u2016 for x \u2208 Bi \\B0.\nTHEOREM 4. If \u2211ni=1(Ci \u2212 hi(0)) > 0 then the process \u0001 is recurrent while\nif \u2211ni=1(Ci \u2212 hi(0)) < 0 then \u0001 is transient.\nREMARKS. The presence of the \u03c0i in the formulas for Ci and hi(p) gives\nthe impression that this result somehow depends upon where we choose to start\nnumbering the faces. In fact the choice of starting axis only affects\n\u2211\nCi \u2212 hi by\na positive multiplicative scaling which has no influence on our result. A detailed\ninvestigation of the recurrent case is the subject of Section 5. From this point on we\nwill neglect to mention B0 as all our calculations depend on \u2016x\u2016 being sufficiently\nlarge.\nPROOF OF THEOREM 4. We will treat the transient case in detail and only\nindicate the minor changes needed for the recurrent case.\nThe piecewise linear Lyapunov function used in the cases K \t= 1 is not adequate\nfor this task. There are two important modifications required of which the most\n1410 I. M. MACPHEE AND M. V. MENSHIKOV\ninvolved is the replacement of the linear martingale term with a nearly linear\ntransformation which we describe now. For any constants h (positive or negative)\ndefine, for i = 1, . . . , n,\nFi(x,h) = xi\n\u03c0i\n+ xi+1\n\u03c0i+1\n\u2212 h xi+1\/\u03c0i+1\nxi\/\u03c0i + xi+1\/\u03c0i+1\n= xi\n\u03c0i\n+ xi+1\n\u03c0i+1\n\u2212 h xi+1\nxi tan\u03b1i + xi+1\n(11)\nfor x \u2208 Ai \u222a Bi \u222a Ai+1, i \u2264 n \u2212 1, with the obvious replacement of xn+1\nwith x1 for x \u2208 An \u222a Bn \u222a A1. For any positive constant v we see that \u2212h \u2264\nFi(x,h) \u2212 v \u2264 0 along the line xi tan\u03b1i + xi+1 = v\u03c0i+1 and similarly on the\nlevel curve {x :Fi(x,h) = v}, 0 \u2264 xi\u03c0i +\nxi+1\n\u03c0i+1 \u2212 v \u2264 h so the Fi are \u201calmost\nlinear\u201d functions. They do not fit together smoothly on the Ai where we see that\nFi(x,hi) = Fi\u22121(x,hi\u22121)+ hi\u22121 and we need to remember this at a later point in\nour calculation.\nExpanding Fi using Taylor\u2019s formula to second order we find that for x,\nx + y \u2208 Ai \u222aBi \u222aAi+1\nFi(x + y,h)\u2212 Fi(x,h)\n=\n(\nyi\n\u03c0i\n+ yi+1\n\u03c0i+1\n)\n\u2212 h tan\u03b1i xiyi+1 \u2212 xi+1yi\n(xi tan\u03b1i + xi+1)2\n+ h tan\u03b1i (xiyi+1 \u2212 xi+1yi)(yi tan\u03b1i + yi+1)\n(xi tan\u03b1i + xi+1 + \u03b8(yi tan\u03b1i + yi+1))3 ,\n(12)\nwhere \u03b8 \u2208 [0,1] depends upon x and y. As y will represent possible jumps from\nx \u2208 Bi , we can assume its components are bounded below by \u22121 and so the\nresidual term\u2019s denominator (xi tan\u03b1i + xi+1 + \u03b8(yi tan\u03b1i + yi+1))3 is bounded\nbelow by (\n(xi \u2212 1) tan\u03b1i + xi+1 \u2212 1)3 = \u03c03i+1Fi(x,h)3 +O(Fi(x,h)2).\nTaking expectations and noting the relations Mi0 = \u2212\u03c1i cos\u03b1i and Mi1 = \u03c1i sin\u03b1i\nwe see that when x \u2208 Bi (so jumps end inside Ai \u222aBi \u222aAi+1) and Fi(x,h) is large\nE\n(\nFi\n(\n\u03be(t + 1), h)\u2212 Fi(\u03be(t), h)|\u03be(t) = x)\n= 0 \u2212 h tan\u03b1i xi\u03c1i sin\u03b1i + xi+1\u03c1i cos\u03b1i\n(xi tan\u03b1i + xi+1)2 +O\n(\u2016x\u2016 \u00b7M(2)(x)\nFi(x,h)3\n)\n= \u2212 h\u03c1i sin\u03b1i\nxi tan\u03b1i + xi+1 +O\n(\nFi(x,h)\n\u22122)\n= \u2212 h\u03c1i cos\u03b1i\n\u03c0iFi(x,h)\n+O(Fi(x,h)\u22122),\n(13)\nCRITICAL RANDOM WALKS ON COMPLEXES 1411\nwhere in obtaining the final expression we have used the binomial theorem to write\n1\nxi tan\u03b1i + xi+1 =\n1\n\u03c0i tan\u03b1iFi(x,h)\n+O(Fi(x,h)\u22122).\nUsing a very similar argument but with Taylor\u2019s formula only to first order we\ncalculate\nE\n([\nFi\n(\n\u03be(t + 1), h)\u2212 Fi(\u03be(t), h)]2\u2223\u2223\u03be(t) = x)\n= 1\n\u03c02i\n(\n\u03bbi0 + 2Ritan\u03b1i +\n\u03bbi1\ntan2 \u03b1i\n)\n+O(Fi(x,h)\u22121).(14)\nFurther modifications to the Lyapunov function of Theorem 2 are needed to\ndeal with the behavior of \u0001 at the axes Ai . Let q\u2212i =\n\u2211\ny\u2208Bi\u22121 pxy , where x \u2208 Ai ,\ni = 1, . . . , n, and let\n\u03b4 \u2261\n\u2211n\ni=1(Ci \u2212 hi(0))\n2n+ 2\u2211ni=1 q\u2212i \/ui ,\nwhere ui was defined in (8). Note that we have \u03b4 < 0 in the transient case but \u03b4 > 0\nin the recurrent case. Next define for each i\nC\u2032i = Ci \u2212 2\u03b4\nq\u2212i\nui\n, C\u02dci = C\u2032i \u2212 \u03b4 and h\u02dci = hi(0)+ \u03b4(15)\nwith hi(0) as in (10) so that\n\u2211n\ni=1(C\u02dci \u2212 h\u02dci) = 0. For each i we now use the\nfunctions Ti(x) = \u03b2xi+1i for x \u2208 Ai \u222a Bi , where the \u03b2i are constants to be chosen,\nto construct the process T (\u0001) satisfying\nT (\u03be(t)) = Ti(x) when \u03be(t) = x \u2208 Ai \u222aBi.(16)\nTo establish transience of \u0001 it turns out that we will require\nC\u2032iE\n(\n1 \u2212 T (\u03be(t + 1))|\u03be(t) = x)>C\u2032i(1 \u2212 Ti(x)) when x \u2208 Bi.\nThe results of Lemma 1 imply that when C\u2032i > 0 we must choose \u03b2i \u2208 (0, si) and\nwhen C\u2032i < 0 we require \u03b2i \u2208 (si,1). For any such choice of the \u03b2i we define now\nfor later use\n\u0010i \u2261 \u0010i(\u03b2i) = \u2212C\u2032iE\n(\nT (\u03be(t + 1))\u2212 T (\u03be(t))|\u03be(t) = x)\/Ti(x)\nfor any x \u2208 Bi with xi > 1 and note that \u0010i > 0. Further for x \u2208 Ai with xi > 1\nand ui as defined in (8), we define\n\fi \u2261 \f(\u03b2i) = C\u2032iE\n(\nIBi (t + 1)\n[\n1 \u2212 T (\u03be(t + 1))]\u2223\u2223\u03be(t) = x)\u2212C\u2032iui,\nwhere the notation IE(t) denotes the indicator function of the event {\u03be(t) \u2208 E}\nfor any time t . The results of Lemma 1 imply that \fi < 0. When considering the\nrecurrence problem we choose \u03b2i to ensure that \u0010i < 0 which then makes \fi > 0.\n1412 I. M. MACPHEE AND M. V. MENSHIKOV\nWith these preliminary calculations in place we now proceed to exhibit a\nfunction f on L such that the jump moments\n\u00b51(f |x) = E(f (\u03be(t + 1))\u2212 f (\u03be(t))|\u03be(t) = x)\nand\n\u00b52(f |x) = E([f (\u03be(t + 1))\u2212 f (\u03be(t))]2\u2223\u2223\u03be(t) = x)\nof f (\u03be(t)) satisfy the transience conditions of Theorem 3. Specifically we will\nshow that when\n\u2211\ni Ci \u2212 hi(0) < 0 there is a function f and an \u03b5 > 0 such that\n2f (x)\u00b51(f |x) \u2212 \u00b52(f |x) \u2265 \u03b5 for all x outside some finite set near the origin.\nThe conditions for recurrence when\n\u2211\ni Ci \u2212 hi(0) > 0 are established in a nearly\nidentical fashion.\nOur Lyapunov function f is defined by\nf (x) = Fi(x, h\u02dci)+\ni\u22121\u2211\nj=1\n(C\u02dcj \u2212 h\u02dcj )+C\u2032i\n(\n1 \u2212 Ti(x)), x \u2208 Ai \u222aBi,(17)\nfor i = 1, . . . , n (with the usual replacement of xn+1 by x1 when this is necessary)\nand Fi is defined in (11). The \u03b2i are as yet not specified but we will show later\nhow they should be chosen.\nWe start with \u00b52(f |x). Our assumptions of homogeneity within faces and\nM(\u03b3 )(x) < \u221e for some \u03b3 > 2 and all x \u2208 L imply that \u00b52 is uniformly bounded\non L. We now show that within Bi , for each i, \u00b52 converges to a constant we can\ncalculate as xi+1 becomes large. For all x \u2208 Bi we have\n\u00b52(f |x) = 1\n\u03c02i\n(\n\u03bbi0 + 2Ritan\u03b1i +\n\u03bbi1\ntan2 \u03b1i\n)\n+O(Fi(x, h\u02dci)\u22121)+Wai (x)+Wbi (x),\nwhere\nWai (x) = (C\u2032i)2E\n([\nTi(x)\u2212 Ti(\u03be(t + 1))]2\u2223\u2223\u03be(t) = x)\nand\nWbi (x)\n= 2C\u2032iE\n([\nFi\n(\n\u03be(t + 1), h\u02dci)\u2212 Fi(\u03be(t), h\u02dci)] \u00b7 [Ti(x)\u2212 Ti(\u03be(t + 1))]\u2223\u2223\u03be(t) = x).\nAs Ti(x) = \u03b2xi+1i and jumps are bounded below we have the relation Ti(x) \u2212\nTi(y) = O(Ti(x)) for x \u2208 Bi and y such that pxy > 0. Further Ti(x) \u2192 0 as\nxi+1 \u2192 \u221e so we see that for x \u2208 Bi with xi+1 not too small, we have\nWai (x) = O\n(\nTi(x)\n2) and Wbi (x) = O(Ti(x)).\nCRITICAL RANDOM WALKS ON COMPLEXES 1413\nAt this point note that f (x) = Fi(x,hi) + O(1) so that when considering\nasymptotics Fi(x,hi)\u22121 = f (x)\u22121 + O(f (x)\u22122). Combining these estimates we\nhave\n\u00b52(f |x) = 1\n\u03c02i\n(\n\u03bbi0 + 2Ritan\u03b1i +\n\u03bbi1\ntan2 \u03b1i\n)\n+O(f (x)\u22121)+O(Ti(x))\n= \u22122\u03c1i cos\u03b1i\n\u03c0i\nhi(0)+O(f (x)\u22121)+O(Ti(x)).\n(18)\nIt remains to compute \u00b51 and show that under the condition\n\u2211\ni (Ci \u2212hi(0)) < 0\nwe have lim inf 2f (x)\u00b51(f |x) \u2212 \u00b52(f |x) > 0. To establish the required inequal-\nities we consider each Ai \u222a Bi in four pieces: Ai ; a strip of Bi adjacent to Ai ;\n{x \u2208 Bi :xi = 1}; the rest of Bi . We now consider these in the reverse of the order\nlisted.\nUsing the expansion (12) and the consequent estimate (13) above we have for\nx \u2208 Bi such that xi > 1 (so all jumps end in Ai \u222aBi ),\n\u00b51(f |x) = \u2212 h\u02dci\u03c1i cos\u03b1i\n\u03c0iFi(x, h\u02dci)\n+O(F\u22122i (x, h\u02dci))\n+C\u2032i\n[\nE\n(\n1 \u2212 Ti(\u03be(t + 1))|\u03be(t) = x)\u2212 (1 \u2212 Ti(x))](19)\n= \u2212(hi(0)+ \u03b4)\u03c1i cos\u03b1i\n\u03c0if (x)\n+O(f (x)\u22122)+ \u0010iTi(x).\nFrom (19) and (18) it follows that for x \u2208 Bi such that xi > 1,\n2f (x) \u00b7 \u00b51(f |x)\u2212\u00b52(f |x)\n= \u22122(hi(0)+ \u03b4)\u03c1i cos\u03b1i\n\u03c0i\n+ 2\u0010iTi(x)f (x)+ 2hi(0)\u03c1i cos\u03b1i\n\u03c0i\n+O(f (x)\u22121)\n= \u22122\u03b4 \u03c1i cos\u03b1i\n\u03c0i\n+ 2\u0010iTi(x)f (x)\u2212O(Ti(x))+O(f (x)\u22121)\nso that, since \u03b4 < 0 and \u0010i > 0, there exists ji such that for some \u03b5 > 0,\n2f\u00b51 \u2212\u00b52 \u2265 \u03b5 for x with xi+1 \u2265 ji .\nNext when x \u2208 Bi with xi = 1 (so it is possible to reach Ai+1 in a single\njump) the same expansion holds except that Fi(x, h\u02dci) is replaced by Fi+1(x, h\u02dci+1)\non Ai+1. We simply substitute Fi+1(x, h\u02dci+1) = Fi(x, h\u02dci) + h\u02dciIAi+1(t + 1) and\nproceed as before [as before IE(t) denotes the indicator function of the event\n1414 I. M. MACPHEE AND M. V. MENSHIKOV\n{\u03be(t) \u2208 E}]. This time\n\u00b51(f |x) = \u2212 h\u02dci\u03c1i cos\u03b1i\n\u03c0iFi(x, h\u02dci)\n+O(F\u22122i (x, h\u02dci))\n+C\u2032iE\n(\nIBi (t + 1)\n[\n1 \u2212 Ti(\u03be(t + 1))]\u2223\u2223\u03be(t) = x)\n+ (h\u02dci + C\u02dci \u2212 h\u02dci )E(IAi+1(t + 1)|\u03be(t) = x)\u2212C\u2032i[1 \u2212 Ti(x)](20)\n= \u2212 h\u02dci\u03c1i cos\u03b1i\n\u03c0if (x)\n+O(f (x)\u22122)\u2212 \u03b4E(IAi+1(t + 1)|\u03be(t) = x)\n+C\u2032i\n[\nTi(x)\u2212 E(IBi (t + 1)Ti(\u03be(t + 1))|\u03be(t) = x)]\n= \u2212\u03b4E(IAi+1(t + 1)|\u03be(t) = x)+O(f (x)\u22121)+O(Ti(x))\nand now (20) and the uniform boundedness of \u00b52 imply\n2f (x) \u00b7\u00b51(f |x)\u2212\u00b52(f |x)\n= \u22122f (x) \u00b7 \u03b4E(IAi+1(t + 1)|\u03be(t) = x)+O(f (x)Ti(x))+O(1)\nso that again, since \u03b4 < 0, there exists \u03b5 > 0 such that 2f (x)\u00b51(f |x)\u2212\u00b52(x) \u2265 \u03b5\nwhen xi+1 and hence f (x) are large.\nWhen x \u2208 Bi with xi+1 = j for values j = 1, . . . , ji we know that \u00b52 is\nuniformly bounded while (19) for each such j says\n\u00b51(f |x) = \u2212 h\u02dci\u03c1i cos\u03b1i\n\u03c0if (x)\n+ \u0010i\u03b2ji +O\n(\nf (x)\u22122\n)\nso that as \u0010i > 0, \u03b2i > 0 and f (x) \u2192 \u221e as xi \u2192 \u221e there exist constants Nj and\n\u03b5 > 0 such that 2f\u00b51 \u2212\u00b52 \u2265 \u03b5 when xi \u2265 Nj . Hence for x with xi \u2265 maxj\u2264ji Nj\nwe can be sure that 2f (x)\u00b51(f |x)\u2212\u00b52(f |x) \u2265 \u03b5.\nThis only leaves the axes Ai . We again employ the argument that leads to the\nTaylor expansions in (13) and (14), but as \u0001 can jump into either Bi\u22121 or Bi\nfrom Ai we must consider both Fi and Fi\u22121, combining them with appropriate\nindicator functions. The sum to be considered is quite long so temporarily we will\nabreviate our notation writing Ex for expectation conditioned on {\u03be(t) = x} and\nsometimes \u03bei for \u03bei(t + 1), IBi\u22121 for IBi\u22121(t + 1) and so on. Considering just the\nlinear components of f we see that for x \u2208 Ai we have\nEx\n(\nIBi\u22121\n\u03bei\u22121\n\u03c0i\u22121\n+ \u03bei\n\u03c0i\n+ IBi\n\u03bei+1\n\u03c0i+1\n)\n\u2212 xi\n\u03c0i\n= M\n\u2212\ni1\n\u03c0i\u22121\n+ M\n\u2212\ni0 +M0i +M+i0\n\u03c0i\n+ M\n+\ni1\n\u03c0i+1\n,\nwhich we saw before in (9). For the nonlinear terms in Fi , Fi\u22121 note that, for\nexample,\nEx\n(\n\u03bei+1(t + 1)\n\u03bei(t + 1) tan\u03b1i + \u03bei+1(t + 1)\n)\n= O(f (x)\u22121)\nCRITICAL RANDOM WALKS ON COMPLEXES 1415\nby the Taylor argument leading to (13) as \u03bei+1(t + 1) \u2265 0 and \u03bei(t + 1) \u2265 xi \u2212\n\u03ba > 0 (recall the assumption that jumps are bounded below). Further for x \u2208 Ai ,\n1 \u2212 Ti(x) = 0 and we defined \fi such that\nC\u2032iEx\n(\nIBi [1 \u2212 Ti(\u03be)]\n)= C\u2032iui +\fi\nwith ui as in (8). Taking care to include the constant terms as well, we have, for\ni = 2, . . . , n,\n\u00b51(f |x) = Ex(f (\u03be(t + 1)))\u2212 f (x)\n= Ex(IAi\u222aBiFi + IBi\u22121Fi\u22121)\u2212 Fi(x, h\u02dci)\u2212 (C\u02dci\u22121 \u2212 h\u02dci\u22121)Ex(IBi\u22121)\n+C\u2032iEx\n(\nIBi [1 \u2212 Ti(\u03be)]\n)+C\u2032i\u22121Ex(IBi\u22121[1 \u2212 Ti\u22121(\u03be)])\n=\n[\nM\u2212i1\n\u03c0i\u22121\n+ M\n\u2212\ni0 +M0i +M+i0\n\u03c0i\n+ M\n+\ni1\n\u03c0i+1\n]\n+C\u2032iEx\n(\nIBi (1 \u2212 Ti)\n)\n\u2212 h\u02dciEx\n(\nIBi\n\u03bei+1\n\u03bei tan\u03b1i + \u03bei+1\n)\n+C\u2032i\u22121Ex\n(\nIBi\u22121(1 \u2212 Ti\u22121)\n)\u2212 (C\u02dci\u22121 \u2212 h\u02dci\u22121)Ex(IBi\u22121)(21)\n\u2212 h\u02dci\u22121Ex\n(\nIBi\u22121\n\u03bei\n\u03bei\u22121 tan\u03b1i\u22121 + \u03bei\n)\n= (C\u2032i \u2212Ci)ui +\fi +O\n(\nf (x)\u22121\n)+ (C\u2032i\u22121 \u2212 C\u02dci\u22121)Ex(IBi\u22121)\n\u2212C\u2032i\u22121Ex\n(\nIBi\u22121Ti\u22121\n)+ h\u02dci\u22121Ex\n(\nIBi\u22121\n\u03bei\u22121 tan\u03b1i\u22121\n\u03bei\u22121 tan\u03b1i\u22121 + \u03bei\n)\n= \u22122\u03b4q\u2212i +\fi + \u03b4q\u2212i +O(Ti\u22121(x))+O\n(\nf (x)\u22121\n)\n= \u2212\u03b4q\u2212i +\fi +O(Ti\u22121(x))+O\n(\nf (x)\u22121\n)\n,\nwhere (C\u2032i \u2212Ci)ui = \u22122\u03b4q\u2212i from (15). We know that \u2212\u03b4 > 0 but \fi = \f(\u03b2i) < 0.\nBy choosing \u03b2i close enough to si so that\n\u2212\u03b4q\u2212i +\fi > 0\nwe can guarantee that \u00b51(f |x) is bounded away from 0 for large enough x \u2208 Ai .\nExamining the results of Lemma 1 we see that this choice of \u03b2i is possible under\nthe assumption that M+i1 < \u221e, that is, the jumps in direction xi+1 from Ai have\nfinite mean. On the axis A1 exactly the same argument applies with i \u2212 1 replaced\nby n throughout as crucially\n\u2211n\ni=1(C\u02dci \u2212 h\u02dci ) = 0. Finally, \u00b52(f |x) is uniformly\nbounded everywhere so that since f (x) \u2192 \u221e as x increases we have shown that\n2f\u00b51 \u2212\u00b52 \u2265 \u03b5 > 0 for large enough x \u2208 Ai .\nAs our process \u0001 lives on a countable state space any sensible labelling {\u03b1n}\nallows us to apply Theorem 3 directly as we have shown that the function f defined\n1416 I. M. MACPHEE AND M. V. MENSHIKOV\nin (17) satisfies the condition 2f \u00b7 \u00b51 \u2212 \u00b52 \u2265 \u03b5 everywhere outside some finite\nregion around the origin and hence lim infn 2f \u00b7\u00b51 \u2212\u00b52 > 0.\nTo modify the proof to establish recurrence when\n\u2211\ni Ci \u2212 hi > 0 we observe\nthat now \u03b4 > 0 and we simply select the \u03b2i so that \u0010i < 0, \fi > 0 for each i\nand proceed exactly as above to show that 2f\u00b51 \u2212 \u00b52 is bounded below 0 for all\nsuitably large x. \u0001\n5. Existence of return time moments. It is possible to give a more refined\ndescription of the possibilities in the critical case by considering the finiteness of\nmoments of the first-hitting time of finite subsets for our random walk \u0001. Given a\nfinite set SK = {x \u2208L :\u2016x\u2016 \u2264 K} for some constant K , the first-hitting time of SK\nfrom x0 \/\u2208 SK is\n\u03c4K(x0) = inf{t : \u03be(0) = x0, \u03be(t) \u2208 SK}.\nGeneral results showing when moments of hitting times are finite and when infinite\nwere established in [2] for the critical process with asymptotically zero drifts. We\nstart with a technical lemma based on the results there, which is important in this\nsection as it will enable us to apply our earlier calculations concerning the sign of\n2f (x)\u00b51(f |x)\u2212\u00b52(f |x)\nto processes of the form f (\u0001)2p, which is the key to learning about the finiteness\nor otherwise of E(\u03c4K(x0)p).\nLEMMA 2. Suppose that {Xn} is a time-homogeneous Fn-adapted nonnega-\ntive stochastic process such that for some \u03b3 > 2 and some finite B ,\nE(|Xn+1 \u2212Xn|\u03b3 |Fn) < B\nuniformly in n. For k = 1,2 let \u00b5k(Fn) = E([Xn+1 \u2212 Xn]k|Fn). Then for p > 0\nsuch that 2p < \u03b3 and any \u03b50 > 0 there exists a constant K such that on {Xn > K},\u2223\u2223E(X2pn+1 \u2212X2pn |Fn)\u2212 pX2p\u22122n (2Xn\u00b51(Fn)+ (2p \u2212 1)\u00b52(Fn))\u2223\u2223< \u03b50X2p\u22122n .\nPROOF. Here {Fn} is any suitable filtration\u2014we will only need to use the\nnatural filtration Fn = \u03c3(\u03be0, . . . , \u03ben), n \u2265 0, in what follows. The term\n2Xn\u00b51(Fn)+ (2p \u2212 1)\u00b52(Fn)\nwill be central to our subsequent arguments as its sign essentially determines\nwhether X2pn is a submartingale or supermartingale. A result analogous to this\nlemma was proved in Lemma 10 of the Appendix to [2] under weaker moment\nconditions but for a Markov chain. In fact the proof there translates directly to\nour case so we refer the reader to that lemma\u2014it is written in terms of Markov\nchains there because the Appendix to [2] is concerned with showing exactly how\nthe results of that paper extend those of in [9].\nCRITICAL RANDOM WALKS ON COMPLEXES 1417\nSo far we have assumed [see (1) and following] that the jumps of our random\nwalk \u0001 satisfy the moment condition M(\u03b3 )(x) < \u221e for all x for some \u03b3 > 2. We\nare now concerned with exactly what moment conditions obtain so we introduce\n\u03b3\u02c6 = sup{\u03b3 :M(\u03b3 )(x) < \u221e for all x \u2208L} (\u03b3\u02c6 = \u221e is possible but we have no need\nto consider it separately). For our intended applications of Lemma 2 above note\nthat any function g which differs from a linear function only by uniformly bounded\nterms satisfies g(x) = O(\u2016x\u2016) and so the stochastic process g(\u0001) will satisfy\nLemma 2\u2019s moment conditions for p < 12 \u03b3\u02c6 . \u0001\nEstablishing the existence of moments of return times proceeds in basically the\nsame way as establishing recurrence and we show this first.\nTHEOREM 5. If \u2211i Ci \u2212 hi(0) > 0 then there is a unique p0 > 0 such that\u2211\ni Ci \u2212hi(p0) = 0. If 2p0 < \u03b3\u02c6 then for 0 <p < p0 we have, for sufficiently large\nsets SK and any x \/\u2208 SK\nE\n(\n\u03c4K(x)\np\n)= O(\u2016x\u20162p).\nThis is also true for p = p0 when p0 > 1.\nPROOF. The existence of p0 is evident from definitions (9) and (10) which\nimply the expression\n\u2211\ni Ci \u2212 hi(p) is linear in p and decreasing.\nIt\u2019s necessary to modify the Lyapunov function constructed in the previous\nsection. For 0 <p < p0 let\n\u03b4(p) \u2261\n\u2211n\ni=1(Ci \u2212 hi(p))\n2n+ 2\u2211ni=1 q\u2212i \/ui so \u03b4(p) > 0\nand define for each i\nC\u2032i (p) = Ci \u2212 2\u03b4(p)\nq\u2212i\nui\n,\nC\u02dci(p) = C\u2032i(p)\u2212 \u03b4(p) and h\u02dci (p) = hi(p)+ \u03b4(p).\nOur modified Lyapunov function is\nfp(x) = Fi(x, h\u02dci(p))\n+\ni\u22121\u2211\nj=1\n(\nC\u02dcj (p)\u2212 h\u02dcj (p))+C\u2032i (p)(1 \u2212 Ti(x)), x \u2208 Ai \u222aBi,\nwith Ti(x) as defined for (16). The leading terms of the expansions of \u00b52(f |x)\nand \u00b52(fp|x) are identical so (18) also holds for fp . To achieve cancellation of\nleading terms it is necessary to consider 2fp\u00b51(fp|x) + (2p \u2212 1)\u00b52(fp|x) now.\n1418 I. M. MACPHEE AND M. V. MENSHIKOV\nThe reader can readily check that the proof of Theorem 4 when applied to fp(\u0001)\ndemonstrates that\n2fp(x) \u00b7\u00b51(fp|x)+ (2p \u2212 1)\u00b52(fp|x) \u2264 \u2212\u03b5 < 0(22)\nfor some \u03b5 > 0 and all suitably large x \u2208 L. It is clear that fp can be defined for\np > p0 but as \u03b4(p) < 0 for such p, (22) will not hold.\nFor p < p0 the process fp(\u0001) satisfies the conditions of Lemma 2 and we can\nhence deduce that for some d > 0,\nE\n(\nfp(\u03be(t + 1))2p \u2212 fp(\u03be(t))2p\n\u2223\u2223\u03be(t) = x)\u2264 \u2212dfp(x)2p\u22122\nfor sufficiently large x. The result now follows from Theorem 1 of [2] which\ngives the estimate E(\u03c4pK(x)) = O(fp(x)2p) which we combine with our earlier\nobservation about essentially linear functions like fp . \u0001\nShowing which return time moments are infinite requires the introduction of a\nprocess very similar to f (\u0001) but different in a couple of important respects. This\ncompanion process need not be a submartingale so we can be rather less careful\nabout the exact sign of various terms but we must be able to get an estimate of\nhow long it takes to reach a set S from any suitably distant starting state in order\nto employ some general results from [2].\nTHEOREM 6. For p > min{p0, 12 \u03b3\u02c6 }, with p0 as defined in Theorem 5, we have\nE\n(\n\u03c4K(x)\np\n)= \u221e\nfor sufficiently large sets SK and x where \u2016x\u2016 \u2265 K(1 + \u03b4) for some \u03b4 > 0.\nPROOF. Suppose first that 2p0 < \u03b3\u02c6 . Let T\u02c6i (x) = sxi+1i for i = 1, . . . , n with\nthe si as defined in Lemma 1. Next, using the constants \u03c0i and Ci as defined in (9)\nand its preceding paragraph, define the function f\u02c6 :L\u2192 R by\nf\u02c6 (x) = xi\n\u03c0i\n+ xi+1\n\u03c0i+1\n+Ci\n(\n1 \u2212 T\u02c6i (x)\u2212 xi+1\/\u03c0i+1\nxi\/\u03c0i + xi+1\/\u03c0i+1\n)\n, x \u2208 Ai \u222aBi,\nfor i = 1, . . . , n (reading i + 1 as 1 when i = n). With this set up we consider the\nprocess f\u02c6 (\u0001).\nWe want to employ Theorem 2 of [2] but this requires we first show that the\nconditions of their Lemma 2 (which shows how long it takes to reach a set like SK\nfrom starting points sufficiently far away) are satisfied. To do this we show that\nE(f\u02c6 (\u03be(t + 1))2 \u2212 f\u02c6 (\u03be(t))2|\u03be(t) = x) is bounded below uniformly in x and that\nE(f\u02c6 (\u03be(t + 1))2r \u2212 f\u02c6 (\u03be(t))2r |\u03be(t) = x) \u2264 df\u02c6 (x)2r\u22122 for some r > 1, constant\nd > 0 and suitable x.\nReplacing \u0010i , \fi , \u03b4 with 0 and h\u02dci , C\u2032i , C\u02dci with Ci and adapting the calculations\nleading to (19) and (21) we see that\n\u00b51(f\u02c6 |x) =\n{\nO\n(\nf\u02c6 (x)\u22121\n)\n, x \u2208 Bi ,\nO\n(\nT\u02c6i\u22121(x)\n)+O(f\u02c6 (x)\u22121), x \u2208 Ai ,\nCRITICAL RANDOM WALKS ON COMPLEXES 1419\nso that, since s = maxi{si} < 1, 2f\u02c6 \u00b51(f\u02c6 |x) + (2p \u2212 1)\u00b52(f\u02c6 |x) = O(1) by our\nmoment assumptions on \u0001. By using Lemma 2 with Xt = f\u02c6 (\u03be(t)) and p = 1\nthe boundedness of E(f\u02c6 (\u03be(t + 1))2 \u2212 f\u02c6 (\u03be(t))2|\u03be(t) = x) is established. Again\napplying Lemma 2 to the process f\u02c6 (\u0001) we see that for p < 12 \u03b3\u02c6 there exists a\npositive constant d such that for sufficiently large x\nE\n(\nf\u02c6 (\u03be(t + 1))2p \u2212 f\u02c6 (\u03be(t))2p\u2223\u2223\u03be(t) = x)\u2264 df\u02c6 (x)2p\u22122.\nThis shows that f\u02c6 (\u0001) satisfies the conditions of [2] Lemma 2.\nBy repeating the argument leading to (22), but for some p \u2208 (p0, 12 \u03b3\u02c6 ), we can\nshow that\n2fp(x) \u00b7\u00b51(fp|x)+ (2p \u2212 1)\u00b52(fp|x) \u2265 \u03b5\nfor some \u03b5 > 0 and all suitably large x \u2208L and hence, via Lemma 2, that for some\nd > 0,\nE\n(\nfp(\u03be(t + 1))2p \u2212 fp(\u03be(t))2p\n\u2223\u2223\u03be(t) = x)\u2265 dfp(x)2p\u22122 > 0(23)\nfor sufficiently large x.\nWe now recall the hitting time \u03c4K(x) and introduce for D > 0 the hitting times\n\u03c3D(x) = min {t : f\u02c6 (\u03be(t)) \u2264 D,\u03be(0) = x}.\nWe have established that the process fp(\u0001)2p when stopped at a suitably large\nset S is a submartingale. As the processes fp(\u0001) and f\u02c6 (\u0001) also satisfy the\nother conditions of [2] Theorem 2 its conclusion holds, namely that for large\nenough D and starting points x sufficiently far from S\u02c6D \u2261 {x : f\u02c6 (x) \u2264 D}, we\nhave E(\u03c3D(x)p) = \u221e. As f\u02c6 is essentially a linear function we can choose D for\nany sufficiently large K so that SK \u2286 S\u02c6D which implies \u03c4K(x) \u2265 \u03c3D(x) and hence,\nE\n(\n\u03c4K(x)\np)= \u221e.\nThe nonfiniteness of higher moments in this case follows by the usual H\u00f6lder type\nargument.\nIt remains to consider p > 12 \u03b3\u02c6 when \u03b3\u02c6 is finite. By assumption \u03b3\u02c6 > 2 so the\nargument leading to (23) is valid for some r \u2208 (1, 12 \u03b3\u02c6 ) and [2], Lemma 2 implies\nthat for any q \u2208 (0,1) there exist positive \u03b5 and \u03b4 such that\nP\n(\n\u03c3D(x) > \u03b5f\u02c6 (x)\n2\u2223\u2223\u03be(t) = x)\u2265 q whenever \u2016x\u2016 \u2265 D(1 + \u03b4).\nFor p > 12 \u03b3\u02c6 let F denote the union of the faces Ai , Bi on which M\n(2p)(x) = \u221e.\nConsider starting our random walk from an x0 \u2208 F such that \u2016x0\u2016 \u2265 D(1 + \u03b4).\nClearly \u03c3D(x0)p =\u2211x(1 + \u03c3D(x))pI{x}(1) and hence\nE\n(\n\u03c3D(x0)\np\n)\u2265 q\u03b5p\u2211\nx\nf\u02c6 (x)2pP\n(\n\u03be(1) = x|\u03be(0) = x0)= \u221e\n1420 I. M. MACPHEE AND M. V. MENSHIKOV\nbecause by assumption M(2p)(x0) = \u221e for x0 \u2208 F and |f\u02c6 (x)| \u2265 C\u2016x\u2016 for some\npositive constant C when \u2016x\u2016 is large. For starting points x0 \/\u2208 F it is clear from\nour homogeneity and drift assumptions that there are no x with \u2016x\u2016 \u2265 D(1 + \u03b4)\nfrom which the random walk will with probability 1 hit S\u02c6D before reaching F so\nthat E(\u03c3D(x)p) = \u221e for all x with \u2016x\u2016 \u2265 D(1 + \u03b4). \u0001\nCOROLLARY 1. When\n\u2211n\ni=1 Ci \u2212hi(0) > 0, \u0001 is null-recurrent if p0 < 1 and\nergodic if p0 > 1, where p0 > 0 is defined in Theorem 5.\nPROOF. As p0 > 0, \u0001 is recurrent by Theorem 4. If p0 < 1 then, by\nTheorem 6, E(\u03c4K(x)) = \u221e for all x \/\u2208 SK with some large enough K and so\n\u0001 is null-recurrent. If p0 > 1, Theorem 5 implies that for x \/\u2208 SK we have\nE(\u03c4K(x)p) < \u221e for 1 \u2264 p < min(p0, 12 \u03b3\u02c6 ) and hence \u0001 is ergodic. \u0001\n6. Applications. The paper [13] considers polling systems with Poisson\narrival streams and the exhaustive service discipline in the critical case where the\nmean load on the system equals the mean arrival rate. We quickly describe their\nmodel and results. Independent homogeneous Poisson streams of customers arrive\nat a pair of nodes, each with an infinite buffer, at rates \u03bb1 and \u03bb2, respectively.\nA single server visits (polls) the nodes performing the service of the customers\nin their buffers. The service times of the customers at node i, i = 1,2, form\na sequence of i.i.d. random variables each distributed as a variable \u03c3i with the\nmean mi and independent of the system\u2019s state. The served customers leave the\nsystem. After the server has started service at node i it continues there until\nthe buffer is empty (this is the so-called exhaustive service discipline). Then the\nserver stops serving the i1th node and moves to the other node i2. The time\ntaken for this switch between nodes i1 and i2 is a random variable ri1i2 assumed\nindependent of the number of customers present in the whole system at the moment\nthe i1th node is exhausted.\nUsing essentially the same techniques as in this paper they give explicit\nconditions for null-recurrence or transience of the system in terms of mean\nswitching times, the arrival rates and the first two moments of the service times\nin the case where \u03c1 = \u03bb1m1 + \u03bb2m2 = 1. They go on to give partial results for\nsystems with three or more nodes.\nThe results of this paper apply to various generalizations of the standard polling\nsystem model as discussed in [13]. We only consider cases where there are two\nservice nodes but we permit a variety of regimes in which the behavior of the\nserver and system are different. Each regime has its own set of system parameters,\nfor example, arrival rates, service time distributions. These are restricted by the\nrequirement that we can find an embedded point process which is a random walk\non a two-dimensional complex. This allows for regimes where both nodes receive\nservice simultaneously with service times being independent and exponentially\nCRITICAL RANDOM WALKS ON COMPLEXES 1421\ndistributed, as well as regimes where service times are nonexponential but one\nnode receives all of the service. There may well be other possibilities.\nChanges of regime can occur at any time when there are no customers at one or\nother node according to the following rule. There are 2n regimes and in regime r\nthe customers are put into class types cri according to the node they are waiting\nat. If r is odd, customers at node 1 have class cr1 = 1 and those at node 2 class\ncr2 = 2, while if r is even, cr1 = 2 and cr2 = 1. Following regime r , the next\nregime is randomly chosen from regimes r , r \u2212 1 if there are no customers of\nclass cr2, while if there are no customers of type cr1 it is randomly chosen from\nregimes r , r + 1. During changes of regime we assume only that the changes to\nqueue lengths have finite mean so customers may accumulate or indeed be lost or\nserved by some other mechanism.\nThe earlier sections of this paper are relevant to this generalized polling\nsystem model only in the case where, for every r , regime r\u2019s service rate for\ncustomers of class cr1 is greater than their arrival rate, while for class cr2 the\narrival rate is greater than the service rate. Methods for deciding the transience or\nrecurrence\/ergodicity of the general case appeared in [10] and are treated at some\nlength in Chapters 4 and 5 of [6].\nA further type of generalization is possible in which completed tasks are routed\nback into the input buffers independently but with probabilities that depend on\nregime and node. This would be a multi-regime open two node Jackson network.\nREFERENCES\n[1] ASMUSSEN, S. (1987). Applied Probability and Queues. Wiley, Chichester.\n[2] ASPANDIIAROV, S., IASNOGORODSKI, R. and MENSHIKOV, M. (1996). Passage-time mo-\nments for nonnegative stochastic processes and an application to reflected random walks\nin a quadrant. Ann. Probab. 24 932\u2013960.\n[3] ASYMONT, I., FAYOLLE, G. and MENSHIKOV, M. (1995). Random walks in a quarter plane\nwith zero drifts: Transience and recurrence. J. Appl. Probab. 32 941\u2013955.\n[4] FAYOLLE, G., IGNATYUK, I. A., MALYSHEV, V. A. and MENSHIKOV, M. (1991). Random\nwalks in two-dimensional complexes. Queueing Syst. Theory Appl. 9 269\u2013300.\n[5] FAYOLLE, G., MALYSHEV, V. and MENSHIKOV, M. (1992). Random walks in a quarter plane\nwith zero drift. Ann. Inst. H. Poincar\u00e9 28 179\u2013195.\n[6] FAYOLLE, G., MALYSHEV, V. and MENSHIKOV, M. (1995). Topics in the Constructive Theory\nof Countable Markov Chains. Cambridge Univ. Press.\n[7] FOSS, S. and LAST, G. (1996). Stability of polling systems with exhaustive service policies and\nstate-dependent routing. Ann. Appl. Probab. 6 116\u2013137.\n[8] LAMPERTI, J. (1960). Criteria for the recurrence and transience of stochastic processes I.\nJ. Math. Anal. Appl. 1 314\u2013330.\n[9] LAMPERTI, J. (1963). Criteria for stochastic processes II: Passage time moments. J. Math. Anal.\nAppl. 7 127\u2013145.\n[10] MALYSHEV, V. and MENSHIKOV, M. (1981). Ergodicity, continuity and analyticity of\ncountable Markov chains. Trans. Moscow Math. Soc. 39 1\u201348.\n[11] MENSHIKOV, M. and POPOV, S. YU. (1995). Exact power estimates for countable Markov\nchains. Markov Process. Related Fields 1 57\u201378.\n1422 I. M. MACPHEE AND M. V. MENSHIKOV\n[12] MENSHIKOV, M. and WILLIAMS, R. J. (1996). Passage-time moments for continuous non-\nnegative stochastic processes and applications. Adv. in Appl. Prob. 28 747\u2013762.\n[13] MENSHIKOV, M. and ZUYEV, S. (2001). Polling systems in the critical regime. Stoch. Process.\nAppl. 92 201\u2013218.\n[14] VARADHAN, S. R. S. and WILLIAMS, R. J. (1985). Brownian motion in a wedge with oblique\nreflection. Comm. Pure Appl. Math. 38 405\u2013443.\nDEPARTMENT OF MATHEMATICAL SCIENCES\nUNIVERSITY OF DURHAM SCIENCE SITE\nDURHAM DH1 3LE\nUNITED KINGDOM\nE-MAIL: i.m.macphee@durham.ac.uk\nmikhail.menshikov@durham.ac.uk\n"}