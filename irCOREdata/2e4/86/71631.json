{"doi":"10.1002\/asl.154","coreId":"71631","oai":"oai:eprints.lancs.ac.uk:596","identifiers":["oai:eprints.lancs.ac.uk:596","10.1002\/asl.154"],"title":"Closed-form approximations to the Error and Complementary Error Functions and their applications in atmospheric science.","authors":["Ren, Chuansen","MacKenzie, Rob"],"enrichments":{"references":[{"id":16350776,"title":"A parameterization of cirrus cloud formation: Homogeneous freezing including effects of aerosol size.","authors":[],"date":"2002","doi":"10.1029\/2001jd001429","raw":"K\u00e4rcher B, Lohmann U. 2002. A parameterization of cirrus cloud formation: Homogeneous freezing including effects of aerosol size.","cites":null},{"id":16350766,"title":"Analytic study of temperature solutions due to gamma-type moving point-heat source.","authors":[],"date":"1993","doi":"10.1016\/s0017-9310(05)80072-9","raw":"Chaudhry AM, Zubair S. 1993. Analytic study of temperature solutions due to gamma-type moving point-heat source. Int. J. Heat Mass. Transf. 36: 1633-1637.","cites":null},{"id":16350791,"title":"Capillary rise of water into soil as described by a solution of Burger's equation,","authors":[],"date":"2002","doi":"10.1029\/129gm05","raw":"Swartzendruber D. 2002. Capillary rise of water into soil as described by a solution of Burger's equation, in Environmental Mechanics, Geophys. Monogr. 129: 55-63. \u22123 \u22122 \u22121 2 \u22121 x A c c u r a c y ( % o f e r r o r ) for erf(x) for erfc(x), e x erfc(x)","cites":null},{"id":16350782,"title":"Cirrus parameterisation and the role of ice nuclei.","authors":[],"date":"2005","doi":"10.1256\/qj.04.126","raw":"Ren C,  MacKenzie AR. 2005. Cirrus parameterisation and the role of ice nuclei. Q. J. R. Meteorol. Soc. 131: 1585-1605.","cites":null},{"id":16350772,"title":"Computer evaluation of the complementary error function.","authors":[],"date":"1975","doi":"10.1119\/1.9699","raw":"Decker DL. 1975. Computer evaluation of the complementary error function. Am. J. Phys. 43: 833--834.","cites":null},{"id":16350788,"title":"Near Lognormal Distribution.","authors":[],"date":"2002","doi":"10.1061\/(asce)1084-0699(2002)7:6(441)","raw":"Swamee PK. 2002. Near Lognormal Distribution. J. Hydro. Eng. 7: 411-444.","cites":null},{"id":16350770,"title":"Performance evaluation of programs for the error and complementary error functions.","authors":[],"date":"1990","doi":"10.1145\/77626.77628","raw":"Cody WJ. 1990. Performance evaluation of programs for the error and complementary error functions. ACM Trans. Math. Softw. 16: 29-37.","cites":null},{"id":16350768,"title":"Rational chebyshev approximations for the error function.","authors":[],"date":"1969","doi":"10.2307\/2004390","raw":"Cody WJ. 1969. Rational chebyshev approximations for the error function. Math. Comp. 23: 631-637.","cites":null},{"id":16350779,"title":"Sensitivity studies of cirrus clouds formed by heterogeneous freezing in the ECHAM GCM.","authors":[],"date":"2004","doi":"10.1029\/2003jd004443","raw":"Lohmann U, K\u00e4rcher B, Hendricks J. 2004. Sensitivity studies of cirrus clouds formed by heterogeneous freezing in the ECHAM GCM. J Geophys. Res. 109(D16): D16204, doi:10.1029\/2003JD004443.","cites":null},{"id":16350785,"title":"Statistical and geostatistical analysis of rainfall in central Japan.","authors":[],"date":"2006","doi":"10.1016\/j.cageo.2004.12.012","raw":"Shoji T, Kitaura H. 2006. Statistical and geostatistical analysis of rainfall in central Japan. Computers & Geosciences 32: 1007-1024.","cites":null},{"id":16350774,"title":"Theoretical research on the relationship between return period of rainfall and shallow landslides.","authors":[],"date":"2004","doi":"10.1002\/hyp.1264","raw":"Iida, T. 2004. Theoretical research on the relationship between return period of rainfall and shallow landslides. Hydrological Processes, 18: 739\u2014756.","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2007-08-31","abstract":"The Error function, and related functions, occurs in theoretical aspects of many parts of atmospheric science. This note presents a closed-form approximation for the error, complementary error, and scaled complementary error functions, with maximum relative errors within 0.8%. Unlike other approximate solutions, this single equation gives answers within the stated accuracy for x between 0 and infinity . The approximation is very useful in solving atmospheric science problems by providing analytical solutions. Examples of the utility of the approximations are: the computation of cirrus cloud physics inside a general circulation model, the cumulative distribution functions of normal and log-normal distributions, and the recurrence period for risk assessment","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/71631.pdf","fullTextIdentifier":"http:\/\/eprints.lancs.ac.uk\/596\/2\/7BF32BA0.pdf","pdfHashValue":"a2c2dd72f582d79df379420eb10127bfb61247e8","publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lancs.ac.uk:596<\/identifier><datestamp>\n      2018-01-24T03:14:08Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D47:4745<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        Closed-form approximations to the Error and Complementary Error Functions and their applications in atmospheric science.<\/dc:title><dc:creator>\n        Ren, Chuansen<\/dc:creator><dc:creator>\n        MacKenzie, Rob<\/dc:creator><dc:subject>\n        GE Environmental Sciences<\/dc:subject><dc:description>\n        The Error function, and related functions, occurs in theoretical aspects of many parts of atmospheric science. This note presents a closed-form approximation for the error, complementary error, and scaled complementary error functions, with maximum relative errors within 0.8%. Unlike other approximate solutions, this single equation gives answers within the stated accuracy for x between 0 and infinity . The approximation is very useful in solving atmospheric science problems by providing analytical solutions. Examples of the utility of the approximations are: the computation of cirrus cloud physics inside a general circulation model, the cumulative distribution functions of normal and log-normal distributions, and the recurrence period for risk assessment.<\/dc:description><dc:date>\n        2007-08-31<\/dc:date><dc:type>\n        Journal Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/eprints.lancs.ac.uk\/596\/2\/7BF32BA0.pdf<\/dc:identifier><dc:relation>\n        http:\/\/dx.doi.org\/10.1002\/asl.154<\/dc:relation><dc:identifier>\n        Ren, Chuansen and MacKenzie, Rob (2007) Closed-form approximations to the Error and Complementary Error Functions and their applications in atmospheric science. Atmospheric Science Letters, 8 (3). pp. 70-73. ISSN 1530-261X<\/dc:identifier><dc:relation>\n        http:\/\/eprints.lancs.ac.uk\/596\/<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/dx.doi.org\/10.1002\/asl.154","http:\/\/eprints.lancs.ac.uk\/596\/"],"year":2007,"topics":["GE Environmental Sciences"],"subject":["Journal Article","PeerReviewed"],"fullText":" \nTitle: \nClosed-form approximations to the Error and Complementary Error \nFunctions and their applications in atmospheric science \n \nShort title: \nClosed-form of Error and Complementary Error Functions \n \nAuthors: \nC. Ren and A. R. MacKenzie \n \nAffiliation: \nDepartment of Environmental Sciences \nLancaster University,  \nLancaster LA1 4YQ \nUnited Kingdom \n \n \nCorresponding author:  \nC. Ren  \n \nAddress:  \nDepartment of Environmental Sciences \nLancaster University,  \nLancaster LA1 4YQ \nUnited Kingdom \nE-mail: c.ren@lancaster.ac.uk.  \nTel: +44-1524-593974 \nFax: +44-1524-593985 \n \nAbstract \n \n    The Error function, and related functions, occurs in \ntheoretical aspects of many parts of atmospheric science. This \nnote presents a closed-form approximation for the error, \ncomplementary error, and scaled complementary error functions, \nwith maximum relative errors within 0.8%. Unlike other approximate \nsolutions, this single equation gives answers within the stated \naccuracy for [ )\u221e\u2208 0x . The approximation is very useful in solving \natmospheric science problems by providing analytical solutions. \nExamples of the utility of the approximations are: the computation \nof cirrus cloud physics inside a general circulation model, the \ncumulative distribution functions of normal and log-normal \ndistributions, and the recurrence period for risk assessment.  \n \nKeyword \nError function, complementary error function, scaled complementary \nerror function, normal distribution, log-normal distribution, \ncumulative distribution function, recurrence interval \n \nIntroduction \n \nError and complementary error functions are extensively used \nin the fields that employ mathematics and physics, e.g., studies \nof heat and mass transfer (e.g., Chaudhry and Zubair, 1993; \nSwartzendruber, 2002). In atmospheric science, as elsewhere, the \nerror and complementary error functions occur when normal or log-\nnormal distributions are expressed as cumulative distribution \nfunctions. This note presents a close-form approximation for the \nerror, complementary error, and scaled complementary error \nfunctions with maximum relative errors within 0.8%. The benefits \nof using an analytical approximation for error function in \natmospheric sciences are demonstrated in some examples. \n \nThe closed-form approximation of error functions \n \nThe error function is defined as \n( ) \u222b \u2212= x t dtexerf 0 22\u03c0 ,       (1) \nand the complementary error function is defined as \n  ( ) ( ) \u222b\u221e \u2212=\u2212\u2261 x t dtexerfxerfc 221 \u03c0 .      (2) \nBoth functions contain integrals. Sometimes, when one wants to \nevaluate these functions as accurately as possible, rational \nChebyshev approximations (Cody, 1969) can be used. Nowadays, \nbuilt-in functions are available in several computer languages \n(Cody, 1990). At other times, however, one may forego some \naccuracy for the sake of a speedy calculation or in order to gain \na clearer insight into the relationships between variables in a \nproblem. Decker (1975) provides and cites approximations that are \nquick to compute, but all fail to give expressions in closed form. \nThe following achieves closed-form approximations for the error, \ncomplementary error, and scaled complementary error functions with \nmaximum relative errors within 0.8%. \nThe complementary error function can be expanded as \n( ) ( )( ) cxixxexerfc\nn\ni\ni\nx <+\u22c5\u2212= \u2211=\u2212 ,1231\n221\n0\n2\n2\nL\u03c0 ,    (3) \nAnd \n  ( ) ( ) ( )( ) cxx ixexerfc\nn\ni\ni\ni\nx >\u23aa\u23ad\n\u23aa\u23ac\n\u23ab\n\u23aa\u23a9\n\u23aa\u23a8\n\u23a7 \u2212\u22c5\u22c5\u2212+= \u2211\n=\n\u2212 ,\n2\n12311111\n1\n2\n2 L\n\u03c0 ,   (4) \nwhere c is a positive real number with a value around 1. \nc increases with the increasing n , and Eq. (3) and (4) diverge \nwhen x  is near to c. However, from Eq. (3), we know \n  ( ) 1,21 22 <<\u2212\u2248 xxxerfcex \u03c0\n\u03c0 .      (5) \nSimilarly, from Eq. (4), \n( ) 1,1\n2\n2 >>\u2248 x\nx\nxerfcex \u03c0 .      (6) \nBoth Eq. (5) and (6) suggest that \n  ( ) ( ) 2221 axxa\naxf ++\u2212= \u03c0\u03c0       (7) \nmight be a good fit to the scaled complementary error function \n( )xerfcex2 , since ( ) 10 =f  and ( )\n2\n1lim\nx\nxfx \u03c0=\u221e\u2192 . Here, a  is an adjustable \nparameter for (7) to match either (5) or (6). When aax =+ 22\u03c0  is \nused for 1<<x , the simple match of Eq. (7) to Eq. (5) requires \n2\u2212= \u03c0\n\u03c0a .  \n    We derive a series of values for a  by trial-and-error. \nThese values are given in Table 1, together with their accuracies \nwhen used in Eq. (7) to calculate ( )xerfcex2 . \nThe errors introduced by using Eq. (7) to estimate ( )xerf  and \n( )xerfc  are shown in Fig. 1. One can choose a value of a  to evaluate \nthe results of the error, complementary error, and scaled \ncomplementary error functions easily with a calculator to within \nthe accuracy shown.  \n \nTable 1   Values of a , errors in ( )xerf  and ( )xerfc , and advantages of each formulation \na  2a  Error in ( )xerf  Error in ( )xerfc  Best choice for \n2\u2212\u03c0\n\u03c0  7.5732 -0.65\u20140.00%  0.00\u20140.92% errors with \nknown  sign \n2.7749 7.7000 -0.47\u20140.47% -0.01\u20140.82% ( )xerf  \n2.7889 7.7780 -0.38\u20140.75% -0.03\u20140.76% single value of a  for \nboth ( )xerf  and ( )xerfc  \n2.9110 8.4740 -0.04\u20143.11% -0.34\u20140.34% ( )xerfc  \n3 9  0.00\u20144.70% -0.65\u20140.12% simple formula \n \nExamples of applications in atmospheric science \n \nAs indicated in Table 1, using 3=a  results in the simplest \nformula: \n  ( )\n92\n3\n22\n2\n++\u2248 xxxerfce\nx\n\u03c0\u03c0       (8) \nwhich is never in error by more than 0.65% for complementary error \nand scaled complementary error functions, and which provides a \nneat closed solution that can be incorporated into analytical \nsolutions for a broad range of physical and engineering problems. \nAn example of one such problem, and the driver for the development \ndiscussed above, is the nucleation and growth of cirrus cloud \nparticles (Ren and MacKenzie, 2005). The approximation allowed us \nto describe the behaviour of cirrus clouds under all conditions, \navoiding an unwieldy and unhelpful description based on asymptotic \nexpansions to both ends when it is, in fact, the middle range that \nis most interesting (K\u00e4rcher and Lohmann, 2002; Ren and MacKenzie, \n2005). The cirrus parameterisations are designed for \nimplementation in global climate models (GCMs) (Lohmann et al., \n2004), where the error associated with the closed-form \napproximation is small compared to uncertainty in the model output \nresulting from missing processes and other simplifications. There \nare clear advantages \u23af in calculation speed and interpretation of \nresults \u23af in the use of closed-form approximations to the error \nand related functions within these very large GCM computer codes. \nOther examples relate to normal or log-normal distributions. \nThe size distributions of aerosols and clouds, and the parameters \nof turbulent processes are often log-normally distributed. Shoji \nand Kitaura (2006), for example, found that hourly, daily, and \nannual precipitation distributions were fitted well with log-\nnormal distributions. The cumulative distribution function, ( )ID  \u2014 \nwhich indicates the probability that rainfall amount, I , will not \nbe exceeded within period of time (hourly, daily, or annual), T  \u2014 \ncan, therefore, be given by \n ( ) ( ) 22212\n11\nln2\nlnln1\n2\n1\n2\naa\naeIIerfID m ++\u2212\u2212=\u239f\u239f\u23a0\n\u239e\n\u239c\u239c\u239d\n\u239b \u239f\u23a0\n\u239e\u239c\u239d\n\u239b \u2212+=\n\u2212\n\u03c0\u03bb\u03c0\u03bb\u03c3\n\u03bb\n,   (9) \nwhere mI  is the geometric mean of rainfall amount, \u03c3  is the \ngeometric standard deviation of rainfall amounts, and \u03c3\u03bb ln2\nlnln mII \u2212=  \nis a convenient measure of the position of a particular rainfall \namount in the rainfall distribution. 21=\u03bb  when mII \u03c3= , 22=\u03bb  \nwhen I=\u03c32Im, and so on. You can calculate D(I) with a given \u03bb by a \ncalculator, even by hand.  \nHaving derived an analytical expression for the cumulative \ndistribution function, the recurrence interval is then \n  ( ) ( ) ( )[ ] 2222121 \u03bb\u03c0\u03bb\u03c0\u03bb eaaaTIDTIR ++\u2212=\u2212= .   (10) \nThis relatively simple expression is much easier to \u201cread\u201d than \nthe equivalent retaining the error function. For instance, for I = \nIm, \u03bb = 0 and so ( ) TIR m 2= , which confirms that there is a 50:50 \nchance that rainfall exceeds the geometric mean, mI . For 21=\u03bb , \nR(\u03c3Im)\u22486.3T; for 22=\u03bb , R(\u03c32Im)\u224843.6T. Using Eq. (10), values of \n\u03bb for the 50-, 100-, and 200-year events are given in Table 2. \nThis time, 7889.2=a  is used, as this value of a  guarantees the \napproximation having relative errors within 0.8%. Beyond their \nintrinsic interest, log-normal rainfall statistics also propagate \ninto hydrological theory \u2014 theoretical treatments of slope \nstability for example (Iida, 2004) \u2014 and engineering design, where, \nagain, avoiding the use of error functions makes model building \nand theoretical interpretation easier (Swamee, 2002).  \n \n \nTable 2 Values of \u03bb  for calculating the rainfall amount at a given recurrence interval ( )IR         \u03bb  \n50yrs 100yrs 200yrs \nHourly 3.2417 3.3427 3.4409 \nDaily 2.7361 2.8533 2.9663 \nAnnual 1.4543 1.6468 1.8230 \n \n \nConclusion \n \n    A closed-form approximation for the error, complementary error, \nand scaled complementary error functions with maximum relative \nerrors within 0.8%. Unlike other approximate solutions, this \nclosed-form equation gives answers within the stated accuracy for [ )\u221e\u2208 0x . It is very useful when one wants to gain a clearer \ninsight into the relationships between variables in a problem \ninvolving error functions. \n \nReferences \n \nChaudhry AM, Zubair S. 1993. Analytic study of temperature \nsolutions due to gamma-type moving point-heat source. Int. J. Heat \nMass. Transf. 36: 1633-1637. \n \nCody WJ. 1969. Rational chebyshev approximations for the error \nfunction. Math. Comp. 23: 631-637. \n \nCody WJ. 1990. Performance evaluation of programs for the error \nand complementary error functions. ACM Trans. Math. Softw. 16: 29-\n37. \n \nDecker DL. 1975. Computer evaluation of the complementary error \nfunction. Am. J. Phys. 43: 833--834. \n \nIida, T. 2004. Theoretical research on the relationship between \nreturn period of rainfall and shallow landslides. Hydrological \nProcesses, 18: 739\u2014756. \n \nK\u00e4rcher B, Lohmann U. 2002. A parameterization of cirrus cloud \nformation: Homogeneous freezing including effects of aerosol size. \nJ. Geophys. Res. 107(D23): article 4698, doi:10.1029\/2001JD001429. \n \nLohmann U, K\u00e4rcher B, Hendricks J. 2004. Sensitivity studies of \ncirrus clouds formed by heterogeneous freezing in the ECHAM GCM. J \nGeophys. Res. 109(D16): D16204, doi:10.1029\/2003JD004443. \n \nRen C,  MacKenzie AR. 2005. Cirrus parameterisation and the role \nof ice nuclei. Q. J. R. Meteorol. Soc. 131: 1585-1605. \n \nShoji T, Kitaura H. 2006. Statistical and geostatistical analysis \nof rainfall in central Japan. Computers & Geosciences 32: 1007-\n1024.  \n \nSwamee PK. 2002. Near Lognormal Distribution. J. Hydro. Eng. 7: \n411-444. \n \nSwartzendruber D. 2002. Capillary rise of water into soil as \ndescribed by a solution of Burger's equation, in Environmental \nMechanics, Geophys. Monogr. 129: 55-63. \n \n \n \n \n \n \n \n \n10\u22123 10\u22122 10\u22121 100 101 102\n\u22121\n0\n1\n2\n3\n4\n5\nx\n \nAc\ncu\nra\ncy\n (%\n of\n er\nror\n)\nfor erf(x)\nfor erfc(x), ex\n2\nerfc(x)\n \nFigure 1 Relative errors of using Eq. (7) with a = ( )2\u2212\u03c0\u03c0 , 2.7749, \n2.7889, 2.9110, and 3 to calculate error functions. Each line is \nfor a single value of a . For erf, a  increases from bottom up; for \nerfc, a  increases from top down. Errors in erf(x) with a = ( )2\u2212\u03c0\u03c0  \nand in erfc(x) with a =3 are almost identical when x<1. \n"}