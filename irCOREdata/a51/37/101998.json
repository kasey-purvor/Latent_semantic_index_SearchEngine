{"doi":"10.1017\/S002211200600187X","coreId":"101998","oai":"oai:epubs.surrey.ac.uk:1445","identifiers":["oai:epubs.surrey.ac.uk:1445","10.1017\/S002211200600187X"],"title":"Secondary criticality of water waves. Part 1. Definition, bifurcation and solitary waves","authors":["Bridges, T. J.","Donaldson, N. M."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2006-09-28","abstract":"<p>A generalization of criticality \u2013 called secondary criticality \u2013 is introduced and applied to finite-amplitude Stokes waves. The theory shows that secondary criticality signals a bifurcation to a class of steady dark solitary waves which are biasymptotic to a Stokes wave with a phase jump in between, and synchronized with the Stokes wave. We find the that the bifurcation to these new solitary waves \u2013 from Stokes gravity waves in shallow water \u2013 is pervasive, even at low amplitude. The theory proceeds by generalizing concepts from hydraulics: three additional functionals are introduced which represent non-uniformity and extend the familiar mass flux, total head and flow force, the most important of which is the wave action flux. The theory works because the hydraulic quantities can be related to the governing equations in a precise way using the multi-symplectic Hamiltonian formulation of water waves. In this setting, uniform flows and Stokes waves coupled to a uniform flow are relative equilibria which have an attendant geometric theory using symmetry and conservation laws. A flow is then \u2018critical\u2019 if the relative equilibrium representation is degenerate. By characterizing successively non-uniform flows and unsteady flows as relative equilibria, a generalization of criticality is immediate. Recent results on the local nonlinear behaviour near a degenerate relative equilibrium are used to predict all the qualitative properties of the bifurcating dark solitary waves, including the phase shift. The theory of secondary criticality provides new insight into unsteady waves in shallow water as well. A new interpretation of the Benjamin\u2013Feir instability from the viewpoint of hydraulics, and the connection with the creation of unsteady dark solitary waves, is given in Part 2.<\/p","downloadUrl":"","fullTextIdentifier":null,"pdfHashValue":null,"publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:epubs.surrey.ac.uk:1445<\/identifier><datestamp>\n      2017-10-31T14:01:55Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><setSpec>\n      6469766973696F6E733D656E67616E64706879736963616C736369656E636573:6D617468737075626C<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/epubs.surrey.ac.uk\/1445\/<\/dc:relation><dc:title>\n        Secondary criticality of water waves. Part 1. Definition, bifurcation and solitary waves<\/dc:title><dc:creator>\n        Bridges, T. J.<\/dc:creator><dc:creator>\n        Donaldson, N. M.<\/dc:creator><dc:description>\n        <p>A generalization of criticality \u2013 called secondary criticality \u2013 is introduced and applied to finite-amplitude Stokes waves. The theory shows that secondary criticality signals a bifurcation to a class of steady dark solitary waves which are biasymptotic to a Stokes wave with a phase jump in between, and synchronized with the Stokes wave. We find the that the bifurcation to these new solitary waves \u2013 from Stokes gravity waves in shallow water \u2013 is pervasive, even at low amplitude. The theory proceeds by generalizing concepts from hydraulics: three additional functionals are introduced which represent non-uniformity and extend the familiar mass flux, total head and flow force, the most important of which is the wave action flux. The theory works because the hydraulic quantities can be related to the governing equations in a precise way using the multi-symplectic Hamiltonian formulation of water waves. In this setting, uniform flows and Stokes waves coupled to a uniform flow are relative equilibria which have an attendant geometric theory using symmetry and conservation laws. A flow is then \u2018critical\u2019 if the relative equilibrium representation is degenerate. By characterizing successively non-uniform flows and unsteady flows as relative equilibria, a generalization of criticality is immediate. Recent results on the local nonlinear behaviour near a degenerate relative equilibrium are used to predict all the qualitative properties of the bifurcating dark solitary waves, including the phase shift. The theory of secondary criticality provides new insight into unsteady waves in shallow water as well. A new interpretation of the Benjamin\u2013Feir instability from the viewpoint of hydraulics, and the connection with the creation of unsteady dark solitary waves, is given in Part 2.<\/p><\/dc:description><dc:date>\n        2006-09-28<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/epubs.surrey.ac.uk\/1445\/1\/fulltext.pdf<\/dc:identifier><dc:identifier>\n          Bridges, T. J. and Donaldson, N. M.  (2006) Secondary criticality of water waves. Part 1. Definition, bifurcation and solitary waves   Journal of Fluid Mechanics, 565.  pp. 381-417.      <\/dc:identifier><dc:relation>\n        10.1017\/S002211200600187X<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/epubs.surrey.ac.uk\/1445\/","10.1017\/S002211200600187X"],"year":2006,"topics":[],"subject":["Article","PeerReviewed"],"fullText":"J. Fluid Mech. (2006), vol. 565, pp. 381\u2013417. c\u00a9 2006 Cambridge University Press\ndoi:10.1017\/S002211200600187X Printed in the United Kingdom\n381\nSecondary criticality of water waves. Part 1.\nDe\ufb01nition, bifurcation and solitary waves\nBy T. J. BRIDGES AND N. M. DONALDSON\nDepartment of Mathematics, University of Surrey, Guildford, Surrey, GU2 7XH, UK\n(Received 5 November 2003 and in revised form 15 March 2006)\nA generalization of criticality \u2013 called secondary criticality \u2013 is introduced and applied\nto \ufb01nite-amplitude Stokes waves. The theory shows that secondary criticality signals\na bifurcation to a class of steady dark solitary waves which are biasymptotic to\na Stokes wave with a phase jump in between, and synchronized with the Stokes\nwave. We \ufb01nd the that the bifurcation to these new solitary waves \u2013 from Stokes\ngravity waves in shallow water \u2013 is pervasive, even at low amplitude. The theory\nproceeds by generalizing concepts from hydraulics: three additional functionals are\nintroduced which represent non-uniformity and extend the familiar mass \ufb02ux, total\nhead and \ufb02ow force, the most important of which is the wave action \ufb02ux. The theory\nworks because the hydraulic quantities can be related to the governing equations in\na precise way using the multi-symplectic Hamiltonian formulation of water waves.\nIn this setting, uniform \ufb02ows and Stokes waves coupled to a uniform \ufb02ow are\nrelative equilibria which have an attendant geometric theory using symmetry and\nconservation laws. A \ufb02ow is then \u2018critical\u2019 if the relative equilibrium representation is\ndegenerate. By characterizing successively non-uniform \ufb02ows and unsteady \ufb02ows as\nrelative equilibria, a generalization of criticality is immediate. Recent results on the\nlocal nonlinear behaviour near a degenerate relative equilibrium are used to predict\nall the qualitative properties of the bifurcating dark solitary waves, including the\nphase shift. The theory of secondary criticality provides new insight into unsteady\nwaves in shallow water as well. A new interpretation of the Benjamin\u2013Feir instability\nfrom the viewpoint of hydraulics, and the connection with the creation of unsteady\ndark solitary waves, is given in Part 2.\n1. Introduction\nCriticality, uniform \ufb02ows and bulk quantities such as mass \ufb02ux, total head and the\n\ufb02ow force are at the heart of the subject of open-channel hydraulics in one space\ndimension (Henderson 1966; Abbott 1979). The ideal theory can be deduced from\nthe shallow-water equations for a constant-density \ufb02uid\nht + (uh)x = 0, ut +\n(\ngh + 1\n2\nu2\n)\nx\n= 0, (1.1)\nwhere h(x, t) is the depth, u(x, t) is the depth-averaged horizontal velocity and g\nis the gravitational constant. Accompanying these two equations is conservation of\nmomentum,\n(uh)t +\n(\nhu2 + 1\n2\ngh2\n)\nx\n= 0. (1.2)\n382 T. J. Bridges and N. M. Donaldson\nClearly steady \ufb02ows \u2013 uniform \ufb02ows \u2013 which satisfy all three of these equations realize\nconstant values of the mass \ufb02ux (Q), the total head (R) and the \ufb02ow force (S) where\nR = gh + 1\n2\nu2, Q = uh, S = hu2 + 1\n2\ngh2. (1.3)\nMany of the fundamental properties of open channel \ufb02ows can be deduced from\nthese three equations.\nFor the shallow-water equations, there are many ways to de\ufb01ne criticality, all of\nwhich lead to the \u2018Froude number unity\u2019 condition, where the Froude number is\nde\ufb01ned by F 2 = u2\/gh. However, not all these equivalent de\ufb01nitions generalize to\nnon-trivial \ufb02ows. For example, a widely used concept of criticality is that based on\nwhether or not a \ufb02ow is faster or slower than the maximum linear wave speed, but\nthis de\ufb01nition is based on a single parameter (the \ufb02ow speed) and therefore does not\ngeneralize to non-trivial \ufb02ows.\nThe most useful de\ufb01nition of criticality for uniform \ufb02ows is the determinant\ncondition \u2223\u2223\u2223\u2223\u2202(R,Q)\u2202(h, u)\n\u2223\u2223\u2223\u2223 = 0. (1.4)\nUsing (1.3), it is clear that this condition is equivalent to F 2 = 1. This de\ufb01nition\ncombines the two most well-known de\ufb01nitions of critical uniform \ufb02ow: the \ufb02ow\nwhich maximizes Q for \ufb01xed R, equivalently minimizes R for \ufb01xed Q. The most\nimportant feature of (1.4) is that it is the form of the criticality de\ufb01nition which\nextends easily to more general \ufb02ows, including x-dependent steady states.\nMotivated by open questions in the theory of water waves, there are three issues\nwhich emerge from (1.3) and (1.4) which we would like to generalize: move from\nuniform \ufb02ows to general x-dependent steady states, generalize the concept of criticality\nof uniform \ufb02ows to non-trivial x-dependent steady states, and develop a theory for\nthe implications of criticality for both the steady and unsteady problem.\nThe only attempts to generalize criticality to x-dependent states in the literature\nrestrict attention to either a quasi-static approximation, or treat the \ufb02ow as slowly\nvarying in the x-direction (cf. Gill 1977; Killworth 1992; Johnson & Clarke 2001; and\nreferences therein.) One of our central observations is that an exact theory of criticality\nfor \ufb01nite-amplitude states is possible, when the \ufb02ow is periodic in the x-direction,\neven when the basic state has non-trivial z-dependence (where z represents the vertical\ndirection). We call this generalization secondary criticality and the secondary criticality\nof Stokes waves is our primary example.\nThe algebraic de\ufb01nition of uniform \ufb02ows (inverting (1.3) for \ufb01xed values of R and\nQ) is unsatisfactory for generalization. However, another way to characterize uniform\n\ufb02ows is to seek values of (h, u) that make the \ufb02ow force stationary while Q and R\nare held \ufb01xed. This principle is apparently well known in the hydraulics literature,\nand Benjamin (1971) gives an argument to show that this is a general principle for\nparallel (x-independent) \ufb02ows (cf. Benjamin 1971, \u00a7 3.5 and Appendix 2), and it is\nthis observation which is the starting point for our generalization of criticality to\nnon-parallel (x-dependent) \ufb02ows.\nIn the case of the uniform \ufb02ows satisfying (1.3), the principle of stationary\n\ufb02ow force is trivial and does not provide any new information: it amounts to\nsolving\n\u2207L = 0 where L(h, u, a, b) = S(h, u) \u2212 aR(h, u) \u2212 bQ(h, u), (1.5)\nSecondary criticality of water waves. Part 1 383\nwhere (a, b) are Lagrange multipliers, and this functional is subject to the side\nconditions gh + 1\n2\nu2 =R and uh=Q with R> 0 and Q given real numbers. (Script\nsymbols represent the value of the function or functional.) This variational principle,\nwhen non-degenerate, provides uniform \ufb02ows (h(R,Q), u(R,Q)). Degeneracy occurs\nwhen the determinant (1.4) vanishes (in this example, the Lagrange multipliers (a, b)\nturn out to be (h, u)): degeneracy implies criticality.\nOne of the main results of this paper is to show that this characterization of parallel\n\ufb02ows has a natural generalization to steady \ufb02ows with non-trivial x-dependence. This\nresult is applied to steady periodic water waves coupled to a uniform \ufb02ow, but the\nbasic idea should extend to a range of \ufb02uid \ufb02ows. For the water-wave problem, we\n\ufb01nd that there exists \u2013 in addition to S, Q and R \u2013 a fourth functional B such that\nthe x-dependent coupled states satisfy the variational principle\n\u2207L = 0 where L(Z, h0, u0, k) = S(Z) \u2212 h0 R(Z) \u2212 u0 Q(Z) \u2212 k B(Z), (1.6)\nwhere (h0, u0, k) are Lagrange multipliers. These Lagrange multipliers are the\nmean depth (h0), the mean velocity (u0) and the wavenumber associated with the\nperiodic x-variation (k). This variational principle is subject to the side conditions\nR(Z)=R, Q(Z)=Q and B(Z)=B, with Q,R,B given, where Z is a set of\ncoordinates representing water-wave variables. The functionals S, R, Q and B\nrepresent the physical quantities of \ufb02ow force, total head, mass \ufb02ux and a fourth\nfunctional B which can be interpreted as the wave action \ufb02ux. This constrained\nvariational principle is non-degenerate precisely when\ndet(C( p)) \u0002= 0 where C( p) = \u2202(R,Q,B)\n\u2202(h0, u0, k)\n, p = (h0, u0, k). (1.7)\nHereinafter, the matrix C( p) is called the criticality matrix. Criticality of the basic\nstate is de\ufb01ned by the vanishing of the determinant\ndet[C( p)] = 0. (1.8)\nAs far as we are aware, this is the \ufb01rst attempt to give an exact de\ufb01nition of criticality\n(and its implications) for fully x-dependent steady states.\nWhy is this generalization of criticality interesting? One of the fundamental\nimplications of criticality of uniform \ufb02ows is the bifurcation of solitary waves. In\nthe context of shallow-water \ufb02ows, this solitary wave is the Russell solitary wave. (A\n\u2018Russell solitary wave\u2019 is the classical solitary wave which decays monotonically to\nthe zero state at in\ufb01nity; also called the KdV solitary wave or Boussinesq solitary\nwave. It is to be distinguished from envelope solitary waves (familiar as solutions of\nNLS in deep water) which decay to zero at in\ufb01nity but also oscillate, and the dark\nsolitary wave which is localized and oscillatory but is asymptotic to a non-trivial\nperiodic state at in\ufb01nity.) At a point of secondary criticality, where the determinant\n(1.8) vanishes, a pair of Floquet multipliers in the linearization about the basic state\ncoalesce at +1, and generate in the nonlinear problem a \u2018homoclinic torus bifurcation\u2019.\nThe connection between (1.8) and movement of Floquet multipliers is summarized in\nAppendices A and B. The homoclinic bifurcation is in space and so represents the\nbifurcation of a family of dark solitary waves (DSWs). The implication of secondary\ncriticality for water waves is a new class of steady solitary water waves which are\nbiasymptotic as x \u2192 \u00b1\u221e to Stokes waves, and synchronized with the Stokes wave.\n384 T. J. Bridges and N. M. Donaldson\n\u20130.5\n\u20131.0\n\u20131.5\nx\n80400\u201340\u201380\n\u03b7\n1.5\n1.0\n0.5\n0\nFigure 1. Schematic of the free-surface elevation associated with a dark solitary wave.\nThese waves look like Stokes waves for large |x|, but are deformed from periodicity\nfor small |x|. An example is shown in \ufb01gure 1.\nIn order to show that the functionals SQR and B do indeed have relevance for\ncriticality there is a second crucial step to the theory: it is necessary to relate the\nhydraulic quantities SQR and B to the governing equations in a precise way.\nThis issue is resolved by using a Hamiltonian formulation for water waves.\nHowever, usual formulations for water waves such as the Lagrangian formulation of\nLuke (1967), the Zakharov Hamiltonian formulation for the time-dependent problem\n(Zakharov 1968), and the spatial dynamics formulations (e.g. Benjamin 1984; Mielke\n1991; Baesens & MacKay 1992; Bridges 1992; Groves & Toland 1997) all have\nshortcomings. The multi-symplectic Hamiltonian formulation of water waves (e.g.\nBridges 1996, 1997, 2001, 2006a) is a framework where all the hydraulic quantities\nare on the same footing and can be related to the governing equations in a precise way.\nIn addition, a new choice of coordinates for the multi-symplectic formulation of water\nwaves is introduced which provides an interpretation of the Bernoulli equation as a\nconservation law for total head. It is surprising that the importance of Bernoulli\u2019s\nequation as a conservation law in the Hamiltonian setting has not been noticed\nbefore. For example, Bernoulli\u2019s equation is not identi\ufb01ed as a conservation law in\nBenjamin & Olver (1982). More importantly, Bernoulli\u2019s equation is related to a\nsymmetry here, and it is this latter observation that makes the characterization of\nBernoulli\u2019s equation as a conservation law useful. It arises in a central way in the\ntheory of secondary criticality.\nIn the Hamiltonian setting, uniform \ufb02ows and Stokes waves turn out to have\na natural representation as relative equilibria, and it is the geometry of relative\nequilibria which leads to a new characterization of criticality for uniform \ufb02ows and\nit extends easily to non-uniform \ufb02ows and unsteady \ufb02ows. Relative equilibria are\nsolutions which travel along a symmetry group at a constant rate (cf. Marsden\n1992).\nAn outline of Part 1 of this study is as follows. Throughout this paper, a Boussinesq\nmodel for water waves is used for illustration, and its Hamiltonian formulation and the\nassociated structure for the SQR+B theory is given in \u00a7 2. A theory for characterizing\nuniform \ufb02ows as relative equilibria is given in \u00a7 3, and the connection between\nSecondary criticality of water waves. Part 1 385\ndegenerate relative equilibria, classical criticality and solitary wave bifurcation \u2013 the\nbifurcation of Russell-type solitary waves \u2013 is presented. In \u00a7 4, the Hamiltonian\nstructure and SQR + B structure for water waves are introduced.\nIn \u00a7 5, the theory of criticality for non-trivial x-dependent steady states is presented.\nThe implications of this concept of criticality, principally the homoclinic torus\nbifurcation manifested as DSWs, are applied to a Boussinesq model in \u00a7 6 and\nto the full water-wave problem in \u00a7 7. Some of the mathematical tools required\nfor development of the theory are summarized in the Appendices, namely Jordan\nchain theory for generalized eigenvectors, in a Hamiltonian context, and the relation\nbetween criticality and eigenvalues.\n2. A Boussinesq model for analysing secondary criticality\nThe simplest class of shallow-water equations with dispersion, that generalize the\nsystem (1.1) and model the water-wave problem, is the Boussinesq class (cf. Dingemans\n1997; Craig & Groves 1994). An exemplar of that class which is su\ufb03cient for the\npresent purposes is the model proposed by Zu\ufb01ria (1987),\nht + uhx + hux +\n1\n3\nuxxx +\n2\n15\nuxxxxx = 0,\nut + uux + hx = 0.\n}\n(2.1)\nSteady solutions of (2.1) satisfy\nuh + 1\n3\nuxx +\n2\n15\nuxxxx = q, qx = 0,\n1\n2\nu2 + h = r, rx = 0.\n}\n(2.2)\nIf the fourth derivative term (the \ufb01fth-order dispersion term in (2.1)) is dropped,\ngiving the usual form for a Boussinesq equation, the steady equation reduces to\na planar system which cannot have secondary bifurcations. Therefore to capture\nthe bifurcation of DSWs from the steady periodic state it is essential to retain the\nfourth-order derivative term.\nBy introducing new coordinates Z=(\u03b3, \u03c6,w1, u, r, q, v,w2) de\ufb01ned by\n\u03c6x = u, \u03b3x = r \u2212 12u2, v = ux, w1 = \u2212 215vx, w2 = \u2212 13v \u2212 215vxx,\nand a Hamiltonian function\nS(Z) = 1\n2\nr2 + qu + 15\n4\nw21 + w2v +\n1\n6\nv2 \u2212 1\n2\nru2 + 1\n8\nu4, (2.3)\nthe steady Boussinesq model (2.1) has the Hamiltonian formulation,\n\u2212rx = \u2202S\/\u2202\u03b3 = 0,\n\u2212qx = \u2202S\/\u2202\u03c6 = 0,\n\u2212vx = \u2202S\/\u2202w1 = 152 w1,\n\u2212w2x = \u2202S\/\u2202u = q \u2212 ru + 12u3,\n\u03b3x = \u2202S\/\u2202r = r \u2212 12u2,\n\u03c6x = \u2202S\/\u2202q = u,\nw1x = \u2202S\/\u2202v = w2 +\n1\n3\nv,\nux = \u2202S\/\u2202w2 = v.\n\u23ab\u23aa\u23aa\u23ac\u23aa\u23aa\u23ad (2.4)\nThis system can be written in standard form for a Hamiltonian ODE\nJZx = \u2207S(Z), Z \u2208 \u00018, (2.5)\n386 T. J. Bridges and N. M. Donaldson\nwhere\nJ =\n\u23a1\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a3\n0 0 0 0 \u22121 0 0 0\n0 0 0 0 0 \u22121 0 0\n0 0 0 0 0 0 \u22121 0\n0 0 0 0 0 0 0 \u22121\n1 0 0 0 0 0 0 0\n0 1 0 0 0 0 0 0\n0 0 1 0 0 0 0 0\n0 0 0 1 0 0 0 0\n\u23a4\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a6\n,\nand S(Z) is given by (2.3).\nNote that a potential function has been introduced for both the velocity \ufb01eld and\nthe surface elevation:\nu = \u03c6x, h = \u03b3x. (2.6)\nThe idea of using a potential for the velocity is a familiar one. Surprisingly, the use\nof a potential for the surface elevation also has a long history. According to Dooge\n(1987), Boussinesq \ufb01rst proposed the idea in pages 271\u2013274 of his 680 page paper\n(Boussinesq 1877) for the shallow-water equations (1.1). It was later followed up by\nDeymie (1935). See the historical essay of Dooge (1987, p. 221) for discussion. Our\nuse of the potential was inspired by the paper of Nutku (1983) where it was also used\nfor the shallow-water equations (1.1).\nOne way to motivate the use of a potential for the free surface is to note that it\ngenerates a symmetry. An arbitrary constant can be added to \u03b3 without a\ufb00ecting\nh(x). The conservation law generated by this symmetry is the \u2018conservation of total\nhead\u2019, which represents a conservation form of Bernoulli\u2019s equation. In other words,\nthe introduction of the potential \u03b3 gives a way to introduce the Bernoulli function\n(labelled r) explicitly into the equations. This property is reminiscent of how the\nintroduction of a velocity potential leads to a symmetry (addition of an arbitrary\nconstant to \u03c6(x)), which is then linked with the mass conservation law.\nThe symmetry associated with the potentials (2.6) provides an important link\nbetween solutions and conservation laws. To de\ufb01ne the potential symmetries in a\nprecise way for the system in the form (2.5), let g1 = e1 and g2 = e2 where ej is the\nstandard j th unit vector in \u00018. Then, the fact that S(Z) is independent of \u03b3 and \u03c6\ncan be represented by the statement\nS(Z + \u03b81g1 + \u03b82g2) = S(Z), \u2200 (\u03b81, \u03b82) \u2208 \u00012.\nMore generally, these symmetries can be characterized as a two-parameter group of\na\ufb03ne translations of the phase space \u00018. The action of this group on an element\nZ \u2208 \u00018 is\nG(\u03b8 )Z = Z + \u03b81g1 + \u03b82g2, \u2200 \u03b8 = (\u03b81, \u03b82) \u2208 \u00012. (2.7)\nIn terms of this group, the symmetry of (2.5) is represented by the requirement\nS(G(\u03b8 )Z) = S(Z), \u2200 \u03b8 \u2208 \u00012. (2.8)\nA consequence of this property is that G(\u03b8 )Z(x) is a solution for any \u03b8 \u2208 \u00012 whenever\nZ(x) is a solution.\nIn the Hamiltonian setting, symmetry is related to conservation laws. The above\ntwo-parameter group of symmetries can be related to the conservation of mass and\nBernoulli\u2019s equation as follows. Let \u3008\u00b7, \u00b7\u3009 be a standard inner product on \u00018, and\nSecondary criticality of water waves. Part 1 387\nde\ufb01ne\nR(Z) = \u3008Jg1, Z\u3009 = \u3008e5, Z\u3009 = r, Q(Z) = \u3008Jg2, Z\u3009 = \u3008e6, Z\u3009 = q. (2.9)\nThen\n\u2202\n\u2202x\nR(Z) = \u3008Jg1, Zx\u3009 = \u2212\u3008g1, JZx\u3009 = \u2212\u3008g1, \u2207S(Z)\u3009 = \u2212 \u2202\n\u2202\u03b81\nS(G(\u03b8 )Z)|\n\u03b8=0 = 0;\nresulting in Bernoulli\u2019s equation in conservation form. A geometric formulation of\nconservation of mass can be derived similarly leading to Qx =0. Conservation of\nimpulse can be derived using a similar geometric approach, but will not be explicitly\nrequired.\nThere is a fourth conservation law which arises in the later analysis of x-dependent\nstates. Let Z(x, s) be a closed curve (an ensemble) of solutions of (2.5), parameterized\nby s; that is, Z(x, s + 2\u03c0)=Z(x, s) and Z(x, s) satis\ufb01es (2.5) for each s. De\ufb01ne\nB(Z) = 1\n2\n\u222e\n\u3008JZs, Z\u3009 ds,\n\u222e\n\u00b7 ds := 1\n2\u03c0\n\u222b 2\u03c0\n0\n\u00b7 ds.\nThen it is straightforward to verify that Bx =0. This conservation law is in fact the\ngeometric formulation of the conservation of wave action (Bridges 1997b), restricted\nto one space dimension: B(Z) is the wave action \ufb02ux. Note that in this conservation\nlaw, Z(x, s) is not necessarily periodic in x. It is periodic only in the ensemble\nparameter s.\n3. Critical uniform \ufb02ows, degenerate relative equilibria and solitary waves\nIn this section it is shown how the association between critical uniform \ufb02ows and\ndegenerate relative equilibria leads to a nonlinear theory for the bifurcation of solitary\nwaves. This theory is a special case of the secondary criticality theory and shows how\nthe theory works in a simpler setting. It also shows that the mechanism for the\nbifurcation of dark solitary waves and the mechanism for bifurcation of the Russell\nsolitary wave are the same.\nTo illustrate, it is su\ufb03cient to use the steady Boussinesq model (2.2) simpli\ufb01ed\nfurther by dropping the fourth-order term,\nuh + 1\n3\nuxx = q, qx = 0,\n1\n2\nu2 + h = r, rx = 0.\nBy letting h = \u03b3x , u=\u03c6x and ux =\u22123v, a Hamiltonian formulation of this model is\n\u2212rx =0,\n\u2212qx =0,\n\u2212vx = q \u2212 ru + 12u3,\n\u03b3x = r \u2212 12u2,\n\u03c6x = u,\nux =\u22123v.\n\u23ab\u23ac\u23ad (3.1)\nThis system is of the form\nJZx = \u2207S(Z) with Z = (\u03b3, \u03c6, u, r, q, v), (3.2)\nand standard J. The system (3.1) can be completely solved explicitly. The uniform\n\ufb02ows correspond to u= u0 and r \u2212 u20\/2=h0. Perturbing about this solution and\nreducing the system leads to the planar ODE\n\u2212vx = q \u2212 u0r + 32u0u2 + \u00b7 \u00b7 \u00b7,\nux =\u22123v,\n}\n(3.3)\n388 T. J. Bridges and N. M. Donaldson\nwhich can be explicitly solved to \ufb01nd the bifurcating solitary wave solutions that\nbifurcate near criticality: h0 \u2212 u20 \u2248 0.\nThis result is recovered by the theory of relative equilibria as follows. The uniform\n\ufb02ows correspond to relative equilibria associated with the two-dimensional a\ufb03ne\ntranslation group introduced in (2.7). This relative equilibrium is degenerate precisely\nwhen the uniform \ufb02ow is critical. There is a universal nonlinear normal form near\ndegenerate relative equilibria (Bridges & Donaldson 2005; Bridges 2006b) and this\nnormal form predicts the bifurcation of solitary waves.\nRelative equilibria of (3.2) take the form\nZ(x) = G(\u03b8 (x))Z\u0302 = Z\u0302 + \u03b81(x)g1 + \u03b82(x)g2 with \u03b8\u00a81 = \u03b8\u00a8 2 = 0, (3.4)\nwhere gj = ej , j =1, 2, and Z\u0302 \u2208 \u00016 is an x-independent vector. With the above\nrequirements\n\u03b81(x) = h0x + \u03b8\n0\n1 , \u03b82(x) = u0x + \u03b8\n0\n2 , (3.5)\nwhere \u03b801 and \u03b8\n0\n2 are arbitrary (phase) constants, and h0 and u0 are constants which\nrepresent rate of change along the group orbit.\nTo determine (h0, u0, Z\u0302), substitute (3.4) into (3.2) and use the equivariance\nproperties (2.8) of the system to obtain\n\u2207S(Z\u0302) = h0\u2207R(Z\u0302) + u0\u2207Q(Z\u0302) with R(Z\u0302) = R, Q(Z\u0302) = Q. (3.6)\nThe vector Z\u0302 can be characterized as a critical point of S subject to the constraints of\nconstant R and Q, with h0 and u0 then appearing as Lagrange multipliers. It follows\nfrom standard Lagrange multiplier theory that\nh0 =\n\u2202S\n\u2202R\n, u0 =\n\u2202S\n\u2202Q\n. (3.7)\nCarrying through the calculation associated with the \ufb01rst equation of (3.6) results\nin\nZ\u0302(h0, u0) =\n(\n0, 0, u0, h0 +\n1\n2\nu20, h0u0, 0\n)\n.\nThe Lagrange multipliers are then determined by solving the two constraint equations\nin (3.6) which are solvable when\n0 \u0002=\n\u2223\u2223\u2223\u2223 \u2202(R,Q)\u2202(h0, u0)\n\u2223\u2223\u2223\u2223 = det [ 1 u0u0 h0\n]\n= h0 \u2212 u20 = h0(1 \u2212 F 2).\nThe relative equilibrium (uniform \ufb02ow) is degenerate when the determinant vanishes.\nAn important conseqence of degeneracy is that the linearization about the degenerate\nrelative equilibrium has an eigenvalue zero of algebraic multiplicity 6 but geometric\nmultiplicity two. The connection between degeneracy and eigenvalue movement is\ndemonstrated in Appendices A and B.\nTo study the nonlinear problem in the neighbourhood of a degenerate relative\nequilibrium let\nZ(x) = G(\u03b8 (x))[Z\u0302 + W (x)] := Z\u0302 + W (x) + \u03b81(x)g1 + \u03b82(x)g2, (3.8)\nthen the nonlinear problem for W (x) is\nJWx = L(h0, u0)W +\n1\n2\nD3S(Z\u0302)(W,W ) + \u00b7 \u00b7 \u00b7 (3.9)\nSecondary criticality of water waves. Part 1 389\nQ\nR\nn\nh0\nu0\n(R, Q)\nFigure 2. Geometry of the mapping from (h0, u0)-space to (R,Q)-space of the criticality\ncurve h0 \u2212 u20 = 0.\nwhere the dots indicate terms of degree three and higher in \u2016W\u2016, and D3S(Z\u0302)(W,W )\nis the third derivative of S(Z) at the point Z\u0302 and\nL(h0, u0) = D\n2S(Z\u0302) \u2212 h0D2R(Z\u0302) \u2212 u0D2Q(Z\u0302).\nThere exists a set of six constant vectors {\u03be 1, . . . , \u03be 6}, which are constructed using the\ngeneralized eigenvectors (see Appendices A and B), such that the transformation\nW (x) = \u03c6\u02dc1(x)\u03be 1 + \u03c6\u02dc2(x)\u03be 2 + u\u02dc(x)\u03be 3 \u2212 s1I\u02dc 1(x)\u03be 6 + s2I\u02dc 2(x)\u03be 4 + s1v\u02dc(x)\u03be 5 + \u00b7 \u00b7 \u00b7 (3.10)\nresults in the reduced system of nonlinear ODEs\n\u2212 \u02d9\u02dcI 1 = 0,\n\u2212 \u02d9\u02dcI 2 = 0,\n\u2212 \u02d9\u02dcv= I\u02dc 1 + \u03b4u\u02dc \u2212 12\u03bau\u02dc2 + \u00b7 \u00b7 \u00b7 ,\n\u02d9\u02dc\n\u03c61 = u\u02dc + \u00b7 \u00b7 \u00b7 ,\n\u02d9\u02dc\n\u03c62 = s2I\u02dc 2 + \u00b7 \u00b7 \u00b7 ,\n\u02d9\u02dcu= s1v\u02dc + \u00b7 \u00b7 \u00b7 .\n\u23ab\u23aa\u23ac\u23aa\u23ad (3.11)\nThis system is universal in the sense that it arises near points of degeneracy for\nany two-parameter family of relative equilibria (Bridges & Donaldson 2005; Bridges\n2006b).\nThe sign s1 is a property of the Jordan normal form structure and s1 =\u22121 in this\ncase. The sign s2 is the sign of the non-zero eigenvalue of C( p) at criticality (clearly\ns2 =+1 in this case). The parameter \u03b4 is an unfolding parameter, proportional to\nthe value of det(C( p))= h0 \u2212 u20, and is not qualitatively signi\ufb01cant. The important\nparameters are \u03ba and I\u02dc 1. The formula for \u03ba is\n\u03ba = a30 n\nTHess(P)n,\nwhere a0 is an explicitly computable constant (a0 =\n\u221a\n3, in the above example), and\nP = n1R + n2Q, with n de\ufb01ned below. It is remarkable that the coe\ufb03cient \u03ba of the\nnonlinear term in the normal form (3.11) is completely determined by properties of\nthe criticality matrix C( p).\nThe normal vector n is de\ufb01ned by\nC( p)n = 0 \u21d2 n = span\n{(\u2212u0\n1\n)}\nsince C( p) =\n[\n1 u0\nu0 h0\n]\n.\nFor de\ufb01niteness, take n =(\u2212u0, 1) (there is no need to normalize the length to unity).\nThe role of n as a normal vector can be seen as follows. Criticality is de\ufb01ned by\nthe determinant condition (1.4). Setting this determinant to zero de\ufb01nes a curve in the\n(h0, u0)-plane. For the case of uniform \ufb02ows, the curve is a parabola (\ufb01gure 2). The\n390 T. J. Bridges and N. M. Donaldson\nimage of the curve of criticality in the (R,Q)-plane is the curve with cusp as shown in\n\ufb01gure 2. (The cusp in \ufb01gure 2 is yet another view of the cusp in Benjamin & Lighthill\n(1954); but note that the Benjamin\u2013Lighthill cusp is viewed in the (R, S)-plane with\nQ \ufb01xed.) Let (h\u02d90, u\u02d90) be a tangent vector to the criticality curve in the (h0, u0)-plane.\nA tangent vector in the (R,Q)-plane then satis\ufb01es(\nR\u02d9\nQ\u02d9\n)\n=\n[\nRh0 Ru0\nQh0 Qu0\n](\nh\u02d90\nu\u02d90\n)\n.\nIf n is in the kernel of the criticality matrix then clearly\nn \u00b7\n(\nR\u02d9\nQ\u02d9\n)\n= 0,\nand hence is a normal vector as shown in \ufb01gure 2. The normal vector n shows which\ndirection in parameter space is normal to the curve of criticality. The bifurcating\nsolitary wave exists on one side of the curve of criticality only and the nonlinear\ntheory is used to predict which side of the criticality curve the solitary wave exists.\nFor the case of \ufb01gure 2, the homoclinic bifurcation exists inside the curve of criticality\nin the (R,Q)-plane; that is, given a point (R0,Q0) on the curve of criticality with\nQ0 > 0, then the homoclinic orbit exists in the region\n\u2212u0(R \u2212 R0) + (Q \u2212 Q0) < 0.\nThe bifurcation is in the direction of \u2212n on the upper branch shown in \ufb01gure 2.\nUsing the above de\ufb01nition of n,\nHess(P) = n1\n[\n0 0\n0 1\n]\n+ n2\n[\n0 1\n1 0\n]\n=\n[\n0 1\n1 \u2212u0\n]\n,\nand so\n\u03ba = \u22129\u221a3u0.\nAnother interesting feature of the normal form is that the coordinate I\u02dc 1 is a local\nnormal coordinate in parameter space near the surface of criticality. To leading order,\nI\u02dc 1 = a0(n1(R \u2212 R0) + n2(Q \u2212 Q0)) = a0(\u2212u0(R \u2212 R0) + (Q \u2212 Q0)),\nwhere (R0,Q0) is any point on the curve of criticality in \ufb01gure 2 away from the cusp\npoint. The Russell solitary wave is then determined to leading order from the solution\nof\nu\u02dcxx = I\u02dc 1 \u2212 12\u03bau\u02dc2,\nwith both I\u02dc 1 and \u03ba predicted by properties of the criticality matrix. Note that there\nis a geometric phase shift given by\n\u0007\u03c6\u02dc1 =\n\u222b +\u221e\n\u2212\u221e\n(u\u02dc \u2212 u\u221e) dx, u2\u221e = 2I\u02dc 1\u03ba .\nMathematically, this phase shift is identical to the phase jump of dark solitary waves\n(see equation (8.8) in \u00a7 8). Here the phase shift is in the potentials \u03b3 (x) and \u03c6(x).\nThe bifurcating solitary wave predicted by the normal form (3.11) agrees with that\nfound by the explicit calculation using (3.3). However, we now have a theory that will\nwork in more general settings: degenerate relative equilibrium implies solitary wave\nbifurcation.\nSecondary criticality of water waves. Part 1 391\n4. Multi-symplecticity and the SQR + B theory of water waves\nConsider the classical two-dimensional water-wave problem (inviscid, irrotational\n\ufb02uid with constant density) in \ufb01nite depth with a gravitational force \ufb01eld (with\ngravitational constant g), in the following form\nux + \u03c6zz = 0 for 0 < z < \u03b7(x, t), x \u2208 \u0001, (4.1)\nwhere \u03c6(x, z, t) is the velocity potential and u(x, z, t)=\u03c6x(x, z, t). The bottom\nboundary condition is\n\u03c6z = 0 at z = 0, x \u2208 \u0001, (4.2)\nand the conditions at the free surface are\n\u03b7t + u\u03b7x \u2212 \u03c6z = 0, rx = 0 at z = \u03b7(x, t), x \u2208 \u0001. (4.3)\nDe\ufb01ne \u03a6(x, t)=\u03c6(x, z, t)|z= \u03b7(x,t); then\nr(t) := \u03a6t + u\u03a6x + g\u03b7 \u2212 12\n(\nu2 + \u03c62z\n)\n, with u and \u03c6z evaluated at z= \u03b7. (4.4)\n4.1. Bernoulli equation and conservation of total head\nThe main non-standard feature of this formulation is the appearance of the dependent\nvariable r , and the subtle distinction between the de\ufb01nition of r (4.4) and the\nboundary condition rx =0. The variable r(t) can be \u2013 and usually is \u2013 incorporated\ninto the potential; but, retaining the Bernoulli function r(t) explicitly turns out to\nhave interesting consequences. In the Hamiltonian setting, r is the conjugate variable\nassociated with \u03b3 .\nTo see that rx =0 is the right boundary condition, use r in standard coordinates,\nr := \u03a6t + u\u03a6x + g\u03b7 \u2212 12\n(\nu2 + \u03c62z\n)\n=\n[\n\u03c6t +\n1\n2\n(\n\u03c62x + \u03c6\n2\nz\n)\n+ g\u03b7\n]\nz=\u03b7\n,\nand so\nrx = (\u03c6xt + \u03c6tz\u03b7x + \u03c6x\u03c6xx + \u03c6x\u03c6xz\u03b7x + \u03c6z\u03c6zx + \u03c6z\u03c6zz\u03b7x + g\u03b7x)|z=\u03b7\n= (ut + uux + wuz)|z=\u03b7 + \u03b7x(wt + uwx + wwz + g)|z=\u03b7\n= \u2212[px + \u03b7xpz]|z=\u03b7\n= \u2212\u221a1 + \u03b72x\u2207p \u00b7 t|z=\u03b7,\nwhere t =(1 + \u03b72x)\n\u22121\/2(1, \u03b7x) is the unit vector tangent to the free surface. Therefore,\nthe condition rx =0 is equivalent to the condition of constant pressure along the free\nsurface.\nTaking a hint from the Hamiltonian formulation of the Boussinesq model (2.5), we\nintroduce a potential function for the free surface\n\u03b7(x, t) =\n\u2202\n\u2202x\n\u03b3 (x, t).\n392 T. J. Bridges and N. M. Donaldson\nIn terms of the above coordinates, the four main functionals for steady water waves\nare\nS(Z)= 1\n2\n\u222b \u03b7\n0\n(\nu2 \u2212 \u03c62z\n)\ndz \u2212 1\n2\ng\u03b72 + r\u03b7,\nR(Z) = r,\nQ(Z)=\n\u222b \u03b7\n0\nu dz,\nB(Z) =\n\u222b \u03b7\n0\nu\u03c6x dz + r\u03b3x,\n\u23ab\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23ac\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23ad\n(4.5)\nwhere\nZ =\n\u239b\u239c\u239c\u239c\u239c\u239c\u239d\n\u03a6(x, t)\n\u03b7(x, t)\n\u03b3 (x, t)\n\u03c6(x, z, t)\nu(x, z, t)\nr(t)\n\u239e\u239f\u239f\u239f\u239f\u239f\u23a0 with\n\u23a7\u23a8\u23a9 \u03a6(x, t)=\u03c6(x, z, t)|z=\u03b7(x,t),u(x, z, t)= \u2202x\u03c6(x, z, t),\n\u03b7(x, t)= \u03b3x(x, t),\nand r(t) is de\ufb01ned in (4.4).\nThe approach in this paper to \ufb01nite-amplitude periodic waves on a uniform \ufb02ow is\nto be contrasted with the SQR theory for water waves initiated by Benjamin &\nLighthill (1954) and developed further by Keady & Norbury (1975), Doole & Norbury\n(1995), Doole (1997) and references therein. In that theory, both uniform \ufb02ows and\nthe periodic states are studied in the SQR space. Our theory shows that the non-trivial\nx-dependent steady states should be studied in the SQR + B parameter space. The\nintroduction of the function B has two consequences: without B there is no obvious\ngeneralization of criticality and its implications, and secondly, there is no obvious way\nto relate the SQR properties to the stability problem without additional functionals\n(the latter issue is considered in Part 2, Bridges & Donaldson 2006).\n4.2. SQR + B gradient structure and symmetry\nIt is in terms of the set of variables Z that the gradient of each of the functionals has\nthe right structure. An appropriate inner product is required in order to de\ufb01ne the\ngradient.\nLet \u0002 represent the set of functions of the type Z: six-component vector-valued\nfunctions where only the fourth and \ufb01fth components depend on the cross-section.\nThen a natural inner product on \u0002 is\n\u3008W,Z\u3009\u03b7 = W1Z1 + W2Z2 + W3Z3 +\n\u222b \u03b7\n0\n(W4Z4 + W5Z5) dz + W6Z6, Z,W \u2208\u0002.\n(4.6)\nUsing the above inner product, and including integration over x and t , the governing\nequations for water waves can be written in multi-symplectic form\nM(Z)Zt + J(Z)Zx = \u2207S(Z), Z \u2208\u0002. (4.7)\nThis multi-symplectic formulation is a generalization of the formulation in Bridges\n(1996, 2001). The new feature here is the introduction of \u03b3 and r as dependent\nvariables. The speci\ufb01cs of the system (4.7) are not required in the sequel, as the\nfunctionals S, R, Q and B will form the basis for the analysis.\nSecondary criticality of water waves. Part 1 393\nHowever, the symmetry of the equations is important. The analogue of the a\ufb03ne\ntranslation group (2.7) for water waves is\nG(\u03b8 )Z = Z + \u03b81g1 + \u03b82g2, \u2200 \u03b8 \u2208 \u00012, Z \u2208\u0002, (4.8)\nwith\ng1 = (0, 0, 1, 0, 0, 0), g2 = (1, 0, 0, 1, 0, 0),\n(using the same notation as in \u00a7 3, which should not cause confusion). These\nsymmetries are related to the invariants R and Q by \u2207R(Z)= J(Z)g1 and \u2207Q(Z) =\nJ(Z)g2.\n4.3. Uniform \ufb02ows for the full water-wave problem\nWe are now in a position to show that uniform \ufb02ows of the water-wave problem\ncorrespond to relative equilibria associated with the group G(\u03b8 ) in (4.8). First, note\nthat the only true equilibria \u2013 i.e. critical points of the \ufb02ow force S(Z) \u2013 are the trivial\nsolutions \u03c6 =constant and \u03b3 =constant. Consider steady solutions of the water-wave\nproblem in the form of relative equilibria (3.4),\nZ(x, z) = G(\u03b8 (x))Z\u0302(z) = Z\u0302(z) + \u03b81(x)g1 + \u03b82(x)g2,\nwith\n\u03b81(x) = h0x + \u03b8\n0\n1 , \u03b82(x) = u0x + \u03b8\n0\n2 ,\nwhere we have anticipated that the parameters h0 and u0 represent uniform \ufb02ows.\nSubstition into the governing equations leads to the familiar equation\n\u2207S(Z\u0302) = h0\u2207R(Z\u0302) + u0\u2207Q(Z\u0302),\nwhich is easily solved explicitly,\nZ\u0302 =\n(\n0, h0, 0, 0, u0, gh0 +\n1\n2\nu20\n)\n.\nNow, substituting this result into R and Q,\nR(Z\u0302) = r = gh0 +\n1\n2\nu20, Q(Z\u0302) =\n\u222b \u03b7\n0\nu dz = u0h0.\nHence the relative equilibria (uniform \ufb02ows) are non-degenerate precisely when\n0 \u0002=\n\u2223\u2223\u2223\u2223 \u2202(R,Q)\u2202(h0, u0)\n\u2223\u2223\u2223\u2223 = det [ g u0u0 h0\n]\n= gh0(1 \u2212 F 2),\nas anticipated.\nThe homoclinic bifurcation associated with criticality of uniform \ufb02ows for the full\nwater-wave problem results in the well-known Russell solitary wave.\n5. Secondary criticality\nIn this section, the concept of criticality is extended to steady periodic waves coupled\nto a uniform \ufb02ow. The theory is based on the representation of these states as relative\nequilibria associated with a three-parameter group. With this representation, waves\nof wavelength 2\u03c0\/k coupled to a uniform \ufb02ow can be characterized as solutions of a\nconstrained variational problem with\n\u2207S(Z\u0302) = h0\u2207R(Z\u0302) + u0\u2207Q(Z\u0302) + k\u2207B(Z\u0302), (5.1)\n394 T. J. Bridges and N. M. Donaldson\nand non-degeneracy condition\ndet [C( p)] \u0002= 0 where C( p) = \u2202(R,Q,B)\n\u2202(h0, u0, k)\n, (5.2)\nand the point at which this non-degeneracy condition fails corresponds to criticality.\nTo simplify the discussion, the details of the theory for the Boussinesq model (2.1)\nare presented, and then results of the theory for the full water-wave problem are\ngiven.\nTake the Hamiltonian ODE (2.5) as a starting point. A periodic wave coupled to a\nuniform \ufb02ow can be characterized by letting Z\u0302 in (3.4) depend periodically on x,\nZ(x) = G(\u03b8 (x))Z\u0302 := Z\u0302(\u03b83) + \u03b81(x)g1 + \u03b82(x)g2, (5.3)\nwhere Z\u0302(\u03b83 + 2\u03c0)= Z\u0302(\u03b83),\n\u03b81(x) = h0x + \u03b8\n0\n1 , \u03b82(x) = u0x + \u03b8\n0\n2 , \u03b83(x) = kx + \u03b8\n0\n3 , (5.4)\nand, as before, \u03b80j are arbitrary phase constants. Substitution of this form into (2.5)\nresults in\nkJ\n\u2202Z\u0302\n\u2202\u03b83\n+ h0Jg1 + u0Jg2 = \u2207S(Z\u0302),\nwhich is equivalent to (5.1) by taking\nR(Z\u0302) =\n\u222e\n\u3008Jg1, Z\u0302\u3009 d\u03b83, Q(Z\u0302) =\n\u222e\n\u3008Jg2, Z\u0302\u3009 d\u03b83, B(Z\u0302) =\n\u222e\n1\n2\n\u2329\nJ\n\u2202Z\u0302\n\u2202\u03b83\n, Z\u0302\n\u232a\nd\u03b83,\n(5.5)\nwith \u222e\nf (\u03b83) d\u03b83 =\n1\n2\u03c0\n\u222b 2\u03c0\n0\nf (\u03b83) d\u03b83.\nThe equation for Z\u0302 in (5.1) is now an ordinary di\ufb00erential equation, on a space of\nperiodic functions, rather than an algebraic equation as in (3.6), and the inner product\nincludes averaging over \u03b83.\nThe constraints associated with (5.1) are R(Z\u0302)=R, Q(Z\u0302)=Q and B(Z\u0302)=B, and\nthe non-degeneracy condition is (5.2). The generalization of the pair of derivative\nconditions (3.7) is\nh0 =\n\u2202S\n\u2202R\n, Q, B \ufb01xed,\nu0 =\n\u2202S\n\u2202Q\n, R, B \ufb01xed,\nk=\n\u2202S\n\u2202B\n, R, Q \ufb01xed.\n\u23ab\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23ac\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23ad\n(5.6)\nA given state of the form (5.3) is de\ufb01ned to be critical when the non-degeneracy\ncondition (5.2) fails. This de\ufb01nition is justi\ufb01ed in Appendix B by showing that the\nconsequences of criticality for these states is the same as the consequence for uniform\n\ufb02ows: the coalescence of a pair of eigenvalues and a (secondary) bifurcation of solitary\nwaves.\nSecondary criticality of water waves. Part 1 395\nBefore showing that this concept of criticality is indeed a generalization of uniform\n\ufb02ow criticality to non-trivial steady states, the weakly nonlinear case is developed and\napplied to the Boussinesq model and to water waves.\n5.1. Secondary criticality of weakly nonlinear periodic waves\nThere is a universal form for the criticality matrix when the periodic function Z\u0302(\u03b83)\nis expanded in a weakly nonlinear Fourier series. Let\nZ\u0302(\u03b83) = A1\u03be 1e\ni\u03b83 + A2\u03be 2e\n2i\u03b83 + c.c. + \u00b7 \u00b7 \u00b7 , (5.7)\nwhere \u03be 1 is an eigenvector of the linear problem and the \u00b7 \u00b7 \u00b7 represent terms of higher\norder in |A1|. Substituting this Fourier expansion into the functional\nF (Z\u0302, p) =\n\u222e\n[S(Z\u0302) \u2212 h0R(Z\u0302) \u2212 u0Q(Z\u0302) \u2212 kB(Z\u0302)] d\u03b83, (5.8)\nand eliminating the Fourier coe\ufb03cients A2, A3, . . . successively, leads to the reduced\nfunctional\nF\u0302 (|A1|2, p) = F0( p) + D( p)|A1|2 + 12\n( p)|A1|4 + \u00b7 \u00b7 \u00b7 (5.9)\nwhere D( p) is the dispersion relation and \n( p) is the coe\ufb03cient of the leading-order\nnonlinear term. The relation between A1 and the parameters is determined from the\nderivative of F\u0302 with respect to A1,\nD( p) + \n( p)|A1|2 + \u00b7 \u00b7 \u00b7 = 0. (5.10)\nTo determine the entries of the criticality matrix, the leading-order expressions for\nthe functionals R, Q and B are required. Comparing (5.8) with (5.9) shows that\n\u2202F\n\u2202h0\n:= \u2212R = \u2202F\u03020\n\u2202h0\n+\n\u2202D\n\u2202h0\n|A1|2 + \u00b7 \u00b7 \u00b7 := \u2202F\u0302\n\u2202h0\n.\nAnticipating the case of water waves, take\nF\u03020 = \u2212 12gh20 \u2212 h0u20, (5.11)\nand compute the derivatives of F\u0302 with respect to u0 and k,\nR= gh0 +\n1\n2\nu20 \u2212 \u2202D\u2202h0 |A1|\n2 + \u00b7 \u00b7 \u00b7 ,\nQ=h0u0 \u2212 \u2202D\n\u2202u0\n|A1|2 + \u00b7 \u00b7 \u00b7 ,\nB =\u2212\u2202D\n\u2202k\n|A1|2 + \u00b7 \u00b7 \u00b7 ,\n\u23ab\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23ac\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23ad\n(5.12)\nwith |A1|2 determined as a function of p from (5.10). The principal observation\nhere is that secondary criticality in the weakly nonlinear limit is determined from\nthe dispersion relation D( p) and the weakly nonlinear correction to the dispersion\nrelation \n( p).\nThe determinant of the Jacobian, with F\u03020 of the form (5.11), is\ndet[C( p)] =\n\u2223\u2223\u2223\u2223\u2202(R,Q,B)\u2202(h0, u0, k)\n\u2223\u2223\u2223\u2223 = D2k\n (gh0 \u2212 u20)+ C1( p)|A1|2 + \u00b7 \u00b7 \u00b7 , (5.13)\n396 T. J. Bridges and N. M. Donaldson\nAmp\n1 F\nPoint of secondary criticality\nCurve of criticality\nSW Stokes branch\nFigure 3. Typical weakly nonlinear curve of waves and curve of criticality in the Froude\nnumber versus amplitude plane.\nwhere the subscripts on u0 and h0 in the Jacobian are suppressed for brevity, and\nC1( p) = \u2212Trace(E( p)adjHess p(D)), (5.14)\nwhere\nE( p) =\n\u239b\u239c\u239c\u239c\u239c\u239c\u239c\u239d\ng +\nD2h\n\n\nu0 +\nDhDu\n\n\nDhDk\n\n\nu0 +\nDuDh\n\n\nh0 +\nD2u\n\n\nDuDk\n\n\nDkDh\n\n\nDkDu\n\n\nD2k\n\n\n\u239e\u239f\u239f\u239f\u239f\u239f\u239f\u23a0, Hess p(D) =\n\u239b\u239c\u239c\u239c\u239c\u239c\u239c\u239c\u239d\n\u22022D\n\u2202h\u2202h\n\u22022D\n\u2202h\u2202u\n\u22022D\n\u2202h\u2202k\n\u22022D\n\u2202u\u2202h\n\u22022D\n\u2202u\u2202u\n\u22022D\n\u2202u\u2202k\n\u22022D\n\u2202k\u2202h\n\u22022D\n\u2202k\u2202u\n\u22022D\n\u2202k\u2202k\n\u239e\u239f\u239f\u239f\u239f\u239f\u239f\u239f\u23a0\n.\nFor symmetric matrices, the adjugate, Eadj is the cofactor matrix, and when E is\ninvertible, Eadj = det(E)E\u22121. In the limit as |A1| \u2192 0, there are two factors in the\ncriticality determinant (5.13). It clearly vanishes when u20 = gh0, but also when Dk =0.\nThe signi\ufb01cance of the latter term is discussed in Appendix C.\nA schematic of secondary criticality curves is shown in \ufb01gure 3. The axes are the\nFroude number based on mean velocity and mean elevation, F 2 = u20\/gh0, and the ver-\ntical axis is the normalized amplitude of the wave height, denoted by Amp. The curve\nemanating from F =1 (and labelled \u2018curve of criticality\u2019 above the intersection point)\nis the new curve of secondary criticality, and the other curve is the curve along which\nthe basic wave exists. When the two curves in \ufb01gure 3 intersect, the criticality theory\npredicts that the linearization about the wave has a pair of Floquet multipliers that\ncoalesce at +1, and is the starting point for the nonlinear bifurcation of dark solitary\nwaves. Computed cases of these curves for the Boussinesq model and the water wave\nproblem are shown in \u00a7 \u00a7 6 and 7.1, respectively.\n6. Computing secondary criticality using a Boussinesq model\nThe dispersion relation for the linearized Boussinesq model is a truncated Taylor\nexpansion of the exact dispersion relation. With h0 normalized to unity, it is\nF 2 = 1 \u2212 1\n3\nk2 + 2\n15\nk4.\nThis dispersion relation is plotted in \ufb01gure 4. Boussinesq models are valid for\nsmall wavenumber, but how small the wavenumber depends on the particular\nBoussinesq model. Clearly the dispersion relation in \ufb01gure 4 becomes non-physical for\nSecondary criticality of water waves. Part 1 397\nk\nZufiria region\n5\/4\nF2\n1.0\nFigure 4. The dispersion relation for Zu\ufb01ria\u2019s Boussinesq model linearized with h0 = 1\nand F 2 = u20.\nwavenumbers greater than\n\u221a\n5\/4. The region marked \u2018Zu\ufb01ria region\u2019 will be discussed\nlater when comparing to the secondary bifurcation theory of Zu\ufb01ria.\nThe change in slope of the dispersion relation can be corrected by replacing higher\nspace derivatives by time derivatives (e.g. \u00a7 5.4 of Dingemans 1997; Gobbi, Kirby &\nWei 2000; Madsen, Bingham & Liu 2002). In addition to improved regularity, the\ndispersion relation of the linear problem becomes closer to the exact dispersion\nrelation of water waves. However, these models are not Galilean invariant. Without\nGalilean invariance, the duality between steady solutions relative to a \ufb01xed frame,\nand steady solutions in a moving frame is lost. These models will not give the correct\nphysics of travelling waves coupled to a mean \ufb02ow. See Christov (2001) for numerical\nexperiments showing how the lack of Galilean symmetry in Boussinesq models can\nalso a\ufb00ect the dynamics of solitary waves.\nTo apply the theory of secondary criticality for weakly nonlinear waves of the steady\nBoussinesq model, expand Z\u0302(\u03b83) in a Fourier series. (Note that the steady Boussinesq\nmodel (2.2) has an exact periodic solution in terms of cnoidal functions (Bridges &\nFan 2004), but this exact solution does not give any more useful information than the\nweakly nonlinear theory.) By expanding \u03b3 (\u03b83) and \u03c6(\u03b83) the other elements in Z\u0302(\u03b83)\ncan be obtained and\n\u03b3\u0302 (\u03b83)=A1e\ni\u03b83 + A2e\n2i\u03b83 + c.c. + \u00b7 \u00b7 \u00b7 ,\n\u03c6\u0302(\u03b83)=B1e\ni\u03b83 + B2e\n2i\u03b83 + c.c. + \u00b7 \u00b7 \u00b7 .\nSubstituting into (5.8) results in the reduced functional\nF\u0302 = \u2212 1\n2\nh20 \u2212 12h0u20 + D( p)|A1|2 + 12\n( p)|A1|4 + \u00b7 \u00b7 \u00b7 ,\nwith\nD( p) =\nk2(15u20 \u2212 15h0 + 5k2 \u2212 2k4)\n15h0 + 2k4 \u2212 5k2 ,\nwhere it is assumed that the denominator is non-vanishing, and\n\n( p) =\n45\n2\nk2(16k4 \u2212 20k2 + 45h0)\n(2k2 \u2212 1)(15h0 + 2k4 \u2212 5k2)2 , (6.1)\nassuming 2k2 \u2212 1 \u0002= 0. (The singularity k2 = 1\/2 is an anomaly of the dispersion\nrelation. When h0 = 1 and u\n2\n0 = 13\/15 both 2k and k are roots of the dispersion relation\n(see \ufb01gure 4). This resonance is similar to a Wilton resonance, but is anomalous here\nas the model (2.1) is derived for pure gravity waves.) Hence, the relation between |A1|\n398 T. J. Bridges and N. M. Donaldson\nA1\nu0 u0 u0\n0.2\n1.1\n0.1\n0\n1.00.9\n(a) (b) (c)\n1.11.00.9 1.11.00.9\n0.2\n0.1\n0\n0.2\n0.1\n0\nFigure 5. Plots of the curve of secondary criticality and the curve of periodic waves of the\nBoussinesq model when h0 = 1 and with (a) k=0.2; (b) k=0.3; (c) k=0.4.\nand the parameters is\nD( p) + \n( p)|A1|2 + \u00b7 \u00b7 \u00b7 = 0. (6.2)\nUsing the theory for secondary criticality of weakly nonlinear waves in \u00a7 5.1,\nR = h0 +\n1\n2\nu20 +\n(\n15k2\n15h0 + 2k4 \u2212 5k2 \u2212 15k\n2\n(\n2k4 \u2212 5k2 + 15h0 \u2212 15u20\n)\n(15h0 + 2k4 \u2212 5k2)2\n)\n|A1|2 + \u00b7 \u00b7 \u00b7 ,\nQ = h0u0 \u2212 30k\n2u0\n15h0 + 2k4 \u2212 5k2 |A1|\n2 + \u00b7 \u00b7 \u00b7 ,\nB =\n(\n2k\n(\n2k4 \u2212 5k2 + 15h0 \u2212 15u20\n)\n15h0 + 2k4 \u2212 5k2 + k\n2 8k\n3 \u2212 10k\n15h0 + 2k4 \u2212 5k2\n\u2212 k2\n(\n2k4 \u2212 5k2 + 15h0 \u2212 15u20\n)\n(8k3 \u2212 10k)\n(15h0 + 2k4 \u2212 5k2)2\n)\n|A1|2 + \u00b7 \u00b7 \u00b7 .\nThe determinant of the criticality matrix is then\ndet[C( p)] = D2k\n(\nh0 \u2212 u20\n)\n\n\n+ C1( p) |A1|2 + \u00b7 \u00b7 \u00b7 ,\nwith\nC1( p) =\n2k4\n15\nC\u02dc1\n(16k4 \u2212 20k2 + 45h0)(15h0 + 2k4 \u2212 5k2)2 ,\nand\nC\u02dc1 = 5376k\n12 \u2212 31360k10 + 90480h0k8 + 54800k8 \u2212 297300h0k6 \u2212 26000k6\n+ 156000h0k\n4 + 2500k4 + 448200h20k\n4 \u2212 5625h0k2 \u2212 317250h20k2 + 16875h20.\nA point of secondary criticality occurs when det[C( p)]= 0 along a branch of waves.\nThe solutions of (6.2) and the curves of det[C( p)]= 0 are shown plotted in \ufb01gure 5\nfor k=0.2, k=0.3 and k=0.4 with h0 = 1. With this normalization, the abscissa\nin the \ufb01gures can be interpreted as the nonlinear Froude number. The ordinate is\nthe amplitude. For all k su\ufb03ciently small (less than about 0.35) there is a point of\nsecondary criticality in the weakly nonlinear approximation.\nSecondary criticality of water waves. Part 1 399\nIt is shown in Appendix B that secondary criticality is associated with a pair of\nspatial Floquet multipliers passing through +1. In Zu\ufb01ria (1987) a branch of periodic\nwaves is followed numerically and it is found that a pair of Floquet multipliers\ncoalesces at +1 (see \ufb01gure 3 on p. 380 of Zu\ufb01ria 1987). Since Floquet multipliers can\ncoalesce at +1 if and only if there is a point of secondary criticality (generically), there\nshould be a point of secondary criticality associated with this secondary bifurcation.\nIndeed, taking h0 = 1 and k=2\u03c0\/3.8, it is con\ufb01rmed that the curve (6.2) and the curve\ndet[C( p)]= 0 have an intersection point.\nNote, however, that k=2\u03c0\/3.8\u2248 1.6 is quite large and outside the reasonable range\nof validity of the model. Hence, the secondary bifurcations in Zu\ufb01ria, in the region\nnoted in \ufb01gure 4, are of no physical signi\ufb01cance.\nHowever, the results of the theory of secondary criticality applied in the region of\nvalidity of the Boussinesq model show that secondary bifurcation is to be expected\nfor shallow-water waves. In the next section it will be con\ufb01rmed that these secondary\nbifurcations are also found by applying the theory directly to the full water-wave\nproblem.\n7. Periodic water waves coupled to a uniform \ufb02ow\nThe above formulation goes through for the full water-wave problem, leading to\nthe following coupled problem for the periodic wave coupled to a mean \ufb02ow\n\u2207S(Z\u0302)=h0 \u2207R(Z\u0302) + u0 \u2207Q(Z\u0302) + k \u2207B(Z\u0302),\nR(Z\u0302)=R,\nQ(Z\u0302)=Q,\nB(Z\u0302)=B.\n\u23ab\u23aa\u23aa\u23ac\u23aa\u23aa\u23ad (7.1)\nThese four equations are solved for (Z\u0302, h0, u0, k) as functions of R, Q and B.\nIt is not essential to solve (7.1) in the Z\u0302 coordinates. Once the structure is established,\nthe equations can be put in any coordinates that are convenient, say for numerical\ncomputation. For example, suppose we want to solve (7.1) in the standard coordinates\nof velocity potential and wave height.\nTo ease notation let \u03b83 := \u03b8 for the remainder of this subsection, and de\ufb01ne\n\u03b7\u0302(\u03b8)= h0 + \u0393\u0302 (\u03b8). Then the system (7.1) takes the form\nk2\u03c6\u0302\u03b8\u03b8 + \u03c6\u0302zz = 0 for 0 < z < h0 + \u0393\u0302 (\u03b8),\nsubject to the boundary conditions,\n\u03c6\u0302z = 0 at z = 0, \u03c6\u0302z = ku0\u0393\u0302 \u03b8 + k\n2\u03c6\u0302\u03b8 \u0393\u0302 \u03b8 at z = h0 + \u0393\u0302 (\u03b8),\nand\nku0(\u03c6\u0302\u03b8 \u2212 \u03c6\u0302\u03b8 ) + 12k2\u03c6\u03022\u03b8 + 12 \u03c6\u03022z + g\u0393\u0302 = 12 \u03c6\u03022z + 12k2\u03c6\u03022\u03b8 at z = h0 + \u0393\u0302 (\u03b8).\nThe surface elevation \u03b7\u0302(\u03b8) is split into a mean value h0 and a \ufb02uctuating part \u0393\u0302 (\u03b8).\nThe unknowns in these equations are therefore (\u03c6\u0302(\u03b8, z), \u0393\u0302 (\u03b8), h0, u0, k) where \u03c6\u0302 and\n\u0393\u0302 are 2\u03c0-periodic functions of \u03b8 and have mean value zero. The overbar denotes\nan average over \u03b8: ( \u00b7 )= (1\/2\u03c0) \u222e ( \u00b7 ) d\u03b8 . The system is completed by adding the\n400 T. J. Bridges and N. M. Donaldson\nconstraints in the coordinates \u03c6\u0302 and \u0393\u0302 ,\nR = gh0 +\n1\n2\nu20 + ku0\u03c6\u0302\u03b8 +\n1\n2\n\u03c6\u03022z +\n1\n2\nk2\u03c6\u03022\u03b8 at z = h0 + \u0393\u0302 (\u03b8),\nQ = h0u0 + k\n\u222b \u03b7\u0302\n0\n\u03c6\u0302\u03b8 dz where \u03b7\u0302(\u03b8) = h0 + \u0393\u0302 (\u03b8),\nB = u0\n\u222b \u03b7\u0302\n0\n\u03c6\u0302\u03b8 dz + k\n\u222b \u03b7\u0302\n0\n\u03c6\u03022\u03b8 dz.\nThis problem is set up for \ufb01xed (R,Q,B), but alternative choices of parameters\nare possible. The three functionals are paired with co-parameters (the Lagrange\nmultipliers)\n(h0,R), (u0,Q), (k,B),\nand in each of these three sets, any one of each pair can be \ufb01xed. For example,\n(h0, u0, k) could be \ufb01xed, and then (R,Q,B) computed. This latter ordering is\ncertainly the simplest approach (the constraints would decouple) and would also be\nnaturally conducive to computing the derivatives in C( p) numerically.\nAs far as we are aware, shallow-water periodic waves have never been considered in\nthis generality in the literature. Invariably most of the parameters are \ufb01xed, and a slice\nthrough the parameter space is studied. Representative examples are the calculations\nin Doole & Norbury (1995) where h0, Q and k are \ufb01xed with R, u0 and (in principle)\nB varying, and the calculations in \u00a7 3 of McLean (1982) where R, Q and k are\n\ufb01xed, with h0, u0 and (in principle) B varying. The only work to consider the use\nof wave action \ufb02ux in parameterizing shallow-water waves is Stiassne & Peregrine\n(1980). Indeed, they parameterize the waves in terms of wave action \ufb02ux, mass \ufb02ux\nand Bernoulli constant as here, considered as functions of mean velocity, mean depth\nand wavenumber, but ultimately set the mass \ufb02ux to zero.\nIn general, the decision about which parameters to \ufb01x depends on the physical\nproblem of interest. For example, in computation, it is customary to \ufb01x the mean\nvelocity and elevation and solve for the mass \ufb02ux and total head. However, this would\nbe near impossible in an experiment, where it is natural to input the mass \ufb02ux and\ntotal head and let them determine the mean velocity and mean elevation.\n7.1. Criticality of weakly nonlinear periodic water waves\nIn this section, the above characterization of periodic waves is illustrated by computing\nthe criticality matrix for weakly nonlinear water waves.\nAccording to (5.1), we need to construct\nZ\u0302(\u03b83) = (\u03a6\u0302(\u03b83), \u03b7\u0302(\u03b83), \u03b3\u0302 (\u03b83), \u03c6\u0302(\u03b83, z), u\u0302(\u03b83, z), r\u0302(\u03b83)),\nwith each element a 2\u03c0-periodic function of \u03b83. Let\n\u03b3\u0302 (\u03b83)=A1 e\ni\u03b83 \u2212 A1 e\u2212i\u03b83 + A2 e2i\u03b83 \u2212 A2 e\u22122i\u03b83 + \u00b7 \u00b7 \u00b7 ,\n\u03c6\u0302(\u03b83, z)= (B1e\ni\u03b83 + B1e\n\u2212i\u03b83 )\ncoshkz\ncoshkh0\n+ (B2e\n2i\u03b83 + B2e\n\u22122i\u03b83 )\ncosh2kz\ncosh2kh0\n+ \u00b7 \u00b7 \u00b7 ,\n\u23ab\u23aa\u23ac\u23aa\u23ad (7.2)\nwhere A1, A2, B1 and B2 are complex amplitudes. From these expressions, the other\nelements in Z\u0302 are determined from\n\u03b7\u0302(\u03b83) = h0 + k\n\u2202\u03b3\u0302\n\u2202\u03b83\n, u\u0302(\u03b83, z) = u0 + k\n\u2202\u03c6\u0302\n\u2202\u03b83\n,\nSecondary criticality of water waves. Part 1 401\nand the equations. Substitute these expressions into the functional (5.8), and eliminate\nthe higher-order Fourier coe\ufb03cients to obtain the reduced functional\nF\u0302 (|A1|2, p) = \u2212 12gh20 \u2212 12h0u20 + D( p)|A1|2 + 12\n( p)|A1|4 + \u00b7 \u00b7 \u00b7 ,\nwhere\nD( p) =\nk3u20\ntanh(kh0)\n\u2212 gk2, (7.3)\nand\n\n( p) = \u2212 1\n2\ngk6\n(\n9 \u2212 10 tanh2(kh0) + 9 tanh4(kh0)\ntanh4(kh0)\n)\n. (7.4)\nThe relationship between |A1| and the parameters is then found from the derivative\nof F\u0302 with respect to A1,\nD( p) + \n( p)|A1|2 + \u00b7 \u00b7 \u00b7 = 0.\nThis expression recovers a familiar result for weakly nonlinear water waves in \ufb01nite\ndepth\nu20 =\ng\nk\ntanh(kh0) +\n1\n2\ngk3\n(\n9 \u2212 10 tanh2(kh0) + 9 tanh4(kh0)\ntanh3(kh0)\n)\n|A1|2 + \u00b7 \u00b7 \u00b7 . (7.5)\nNow evaluate the criticality matrix on this solution. Substituting the weakly\nnonlinear expressions into (R,Q,B) we \ufb01nd\nR= gh0 +\n1\n2\nu20 \u2212 \u2202D\u2202h0 |A1|\n2 + \u00b7 \u00b7 \u00b7 ,\nQ=h0u0 \u2212 \u2202D\n\u2202u0\n|A1|2 + \u00b7 \u00b7 \u00b7 ,\nB =\u2212\u2202D\n\u2202k\n|A1|2 + \u00b7 \u00b7 \u00b7 ,\nS =h0u\n2\n0 +\n1\n2\ngh20 \u2212\n(\nh0\n\u2202D\n\u2202h0\n+ u0\n\u2202D\n\u2202u0\n+ k\n\u2202D\n\u2202k\n)\n|A1|2 + \u00b7 \u00b7 \u00b7 .\n\u23ab\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23ac\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23ad\n(7.6)\nExplicit expressions for the derivatives of D are easily obtained using (7.3). The\nexpressions for R, Q and B give the most general perturbation of the hydraulic\nquantities due to a periodic wave on the uniform \ufb02ow. Parts of these expressions agree\nwith special cases in the literature. The result for R in (7.6) agrees with Whitham\u2019s\ncalculation (in equation (16.81) of Whitham 1974), and the expression for Q in\n(7.6) agrees with Whitham\u2019s result (in equation (16.84) of Whitham 1974). However,\nthe weakly nonlinear R above di\ufb00ers from the weakly nonlinear R in Doole &\nNorbury (1995) because Q is held \ufb01xed there.\nThe terms proportional to |A1|2 provide the correction to the total head, mass\n\ufb02ux and action \ufb02ux due to the periodic wave. The most important quantity is the\ndeterminant of the criticality matrix. A straightforward but lengthy computation leads\nto\ndet[C( p)] =\n\u2223\u2223\u2223\u2223\u2202(R,Q,B)\u2202(h0, u0, k)\n\u2223\u2223\u2223\u2223 = D2k\n (gh0 \u2212 u20)+ C1( p)|A1|2 + \u00b7 \u00b7 \u00b7 , (7.7)\n402 T. J. Bridges and N. M. Donaldson\nC1 (p)\nkh0\nFigure 6. A plot of the wave-generated criticality function C1( p) plotted against kh0. The\nchange of sign occurs at kh0 = (kh0)\npoint 1 \u2248 0.588.\nwhere the subscripts to u0 and h0 in the Jacobian are suppressed for brevity. Using\nthe formula for C1( p) in (5.14),\nC1( p) = \u22121\n\n\n(\nC2( p) +\n(\ngh0 \u2212 u20\n)\n\nDkk\n)\n, (7.8)\nwith\nC2( p) = g\n(\nDu0Du0Dkk \u2212 2Du0DkDu0k + D2kDu0u0\n)\n+ h0Dk(DkDh0h0 \u2212 2Dh0Dh0k)\n+h0D\n2\nhDkk + 2u0\n(\nDh0DkDu0k \u2212 Dh0Du0Dkk \u2212 D2kDh0u0 + Du0DkDh0k\n)\n.\nNow expand each of these terms and use D( p) for gravity waves,\nC1( p) = \u2212g\n3k5\n\n\u03c3 6\n(\n18\u03c3 3 \u2212 34\u03c3 5 + 26\u03c3 7 + kh0(\u221245\u03c3 2 + 87\u03c3 4 \u2212 81\u03c3 6 + 23\u03c3 8)\n+ k2h20(36\u03c3 \u2212 72\u03c3 3 + 74\u03c3 5 \u2212 36\u03c3 7 \u2212 2\u03c3 9) + k3h30(\u22129 + 19\u03c3 2 \u2212 19\u03c3 4 + 9\u03c3 6)\n)\nwhere \u03c3 =tanh(kh0). This expression provides the leading-order term of the \u2018wave-\ngenerated criticality\u2019, and does not appear to have been noticed before in the literature.\nWhen |A1|=0 the determinant (7.7) is negative when gh0\u2212u20 > 0 since \n< 0 (assuming\nDk \u0002= 0). So, for |A1|2 su\ufb03ciently small, the determinant of the criticality matrix is\nstrictly negative. However, it can vanish at \ufb01nite amplitude. Setting det[C( p)]= 0\nleads to\nF 2 = 1 +\n\nh0C1( p)\ngk2D2k\n|Amp|2 + \u00b7 \u00b7 \u00b7 (7.9)\nwhere\nAmp =\nk|A1|\nh0\n, F 2 =\nu20\ngh0\n.\nThe curve (7.9) is fundamental to shallow-water Stokes waves, but does not appear\nanywhere in the literature heretofore. It is the curve of secondary criticality.\nFor gravity waves, Dk \u0002= 0 and \n< 0. Therefore the sign of the weakly nonlinear\n(wave-generated) term in (7.9) depends on the sign of C1, and a plot of C1 is shown\nin \ufb01gure 6. A signi\ufb01cant feature is the change of sign occuring at (kh0)\npoint1.\nNow, compare this with the existence branch (7.5) expressed in terms of the mean\nFroude number,\nF 2 =\nu20\ngh0\n=\ntanh(kh0)\nkh0\n+\nkh0\n2\n(\n9 \u2212 10 tanh2(kh0) + 9 tanh4(kh0)\ntanh3(kh0)\n)\n|Amp|2 + \u00b7 \u00b7 \u00b7 .\n(7.10)\nSecondary criticality of water waves. Part 1 403\n1.0\n0\n0.80.6\nAmp\nF\n1.4\n0.2\n1.2\n0.1\n(a) (b) (c)\n1.0\n0\n0.80.6\nF\n1.4\n0.2\n1.2\n0.1\n1.0\n0\n0.80.6\nF\n1.4\n0.2\n1.2\n0.1\nFigure 7. E\ufb00ect of criticality curve on shallow-water Stokes waves for di\ufb00erent values of\nkh0: (a) kh0 = 0.5< (kh0)\npoint 1; (b) (kh0)\npoint 1 <kh0 = 0.7< (kh0)\npoint 2; and (c) kh0 = 1.0 >\n(kh0)\npoint 2.\nFor any \ufb01xed kh0, secondary criticality occurs along a weakly nonlinear branch if\nthese two curves (7.10) and (7.9), considered in the (F,Amp)-plane, intersect. Setting\nthese two expressions for F 2 equal to each other leads to the following condition for\nsecondary criticality to occur in the weakly nonlinear case\n\u2212\nh0C1( p)\ngk2D2k\n+\nkh0\n2\n(\n9 \u2212 10 tanh2(kh0) + 9 tanh4(kh0)\ntanh3(kh0)\n)\n> 0.\nEvaluating this expression numerically, shows that it is satis\ufb01ed for all kh0 <\n(kh0)\npoint 2 \u2248 0.85. Therefore, there are three regions of interest and plots of the\nFroude number amplitude plane for each are shown in \ufb01gure 7. These \ufb01gures\nagree qualitatively with the weakly nonlinear secondary criticality occurring in the\nBoussinesq model in \ufb01gure 5. Note however that the values of kh0 at which secondary\ncriticality occurs are shifted to lower wavenumbers in the Boussinesq model. This is\nprobably because the nonlinear dispersion relation for the Boussinesq model has an\nanomolous singularity at k2 = 1\/2 (see equation (6.2) and the de\ufb01nition of \n in (6.1)).\nHence the shallow-water behaviour shown in \ufb01gure 7 appears to be compressed into\nlower wavenumbers in \ufb01gure 5.\nAlthough periodic Stokes waves exist in shallow water for all kh0 > 0 (see Cokelet\n1977; Stiassne & Peregrine 1980; Amick & Toland 1981 for details), the two-term\napproximation to the periodic Stokes wave will not be accurate for low values of kh0\n(high Ursell number (the Ursell number in the notation of this paper is Amp (kh0)\n\u22122),\nand so quantitative estimation of points of secondary criticality at low values of kh0\nwill require signi\ufb01cantly more terms in the expansion for the wave height, or other\nnumerical calculation. The elementary analytical calculations are, however, su\ufb03cient\nto capture the qualitative properties of secondary criticality.\nThe main conclusion from this analysis is that weakly nonlinear gravity waves in\nshallow water have a point of secondary criticality at low amplitude for all kh0 less\nthan about 0.85. It is highly likely that for kh0 > (kh0)\npoint2 there is still a point of\nsecondary criticality, but at higher amplitude.\nIf we argue in reverse: when a pair of spatial Floquet multipliers passes through\n+1 in the linearization about Stokes waves, it corresponds to a point of secondary\ncriticality, there is evidence for secondary criticality occurring at \ufb01nite amplitude for\nStokes waves in \ufb01nite depth in the numerical work of Vandenbroeck (1983) (and\nZu\ufb01ria (1987) as discussed in \u00a7 6). Vandenbroeck computes secondary bifurcations,\n404 T. J. Bridges and N. M. Donaldson\n1\u2013\n3\nkh0\nF < 1\nF > 1\nBo\nFigure 8. Curve of Froude number unity in the Bond number versus kh0-plane.\nand a necessary condition for the secondary bifurcations there is the appearance of\nFloquet multipliers on the unit circle.\nThe theory of this paper does not apply to water waves in in\ufb01nite depth, but there is\na form of criticality arising there, in the sense that spatial Floquet multipliers passing\nthrough +1 have been observed. For Stokes waves in in\ufb01nite depth, this bifurcation\nof Floquet multipliers was \ufb01rst discovered by Baesens & MacKay (1992). They used\nthe \ufb02ow force for water waves to show that a fold point occurs precisely when a pair\nof Floquet multipliers passes through +1. Remarkably, Bu\ufb00oni, Dancer & Toland\n(2000) have proved that there is an in\ufb01nite number of such fold points along a branch\nof Stokes waves in deep water. However, in deep water, these points occur at very\nlarge amplitude.\n7.2. Implications of surface tension for criticality of water waves\nWhen surface tension is included, the secondary criticality of periodic capillary\u2013\ngravity waves on shallow water is even more pervasive than for gravity waves. For\ncapillary\u2013gravity waves the existence curve (7.10) is modi\ufb01ed to\nF 2 = (1 + Bo(kh0)\n2)\ntanh(kh0)\nkh0\n+ \n\u02dc(Bo)|Amp|2 + \u00b7 \u00b7 \u00b7 , (7.11)\nwhere \n\u02dc reduces to the expression in (7.10) when the Bond number Bo is zero. The\nexpression for the criticality curve (7.9) will have the same general form when surface\ntension is present, and when Dk \u0002= 0, the leading-order part depends only on the sign\nof \nC1( p) (modi\ufb01ed by surface tension). The possibilities for sign changes are much\nricher here (and there is the additional singularity at Dk =0 discussed in Appendix\nC). But, explicit expressions are not required for any of these coe\ufb03cients, as rather\ngeneral qualitative behaviour can be deduced from the form alone.\nWhen Amp=0 and Dk \u0002= 0 the criticality curve always starts at F 2 = 1, with or\nwithout surface tension. When surface tension vanishes (Bo =0), the existence curve\n(7.10) always starts with F 2 < 1; i.e. to the left of the criticality curve. However, when\nBo> 0 the existence curve can start at F 2 < 1 or F 2 > 1, depending on the value of\nkh0.\nFor each Bo\u2208 (0, 1\/3) there is a value of kh0 at which F 2 = 1:\nBo = \u2212 1\nkh20\n+\n1\nkh0tanhkh0\nwith lim\nkh0\u21920\nBo = 1\n3\n.\nIn \ufb01gure 8, this curve of Froude number unity is shown. For any \ufb01xed Bo\u2208 (0, 1\/3),\nSecondary criticality of water waves. Part 1 405\nas kh0 is increased and the F\n2 = 1 curve is crossed, then generically (as long as the\ncoe\ufb03cient of |A1|2 remains \ufb01nite) the existence and criticality curves cross at low\namplitude. Therefore, for each Bo\u2208 (0, 1\/3), there always (generically) exist values of\nkh0 where secondary criticality occurs in the weakly nonlinear limit. These points\nof secondary criticality will then be bifurcation points for branches of steady dark\n(capillary\u2013gravity) solitary waves.\n8. Nonlinearity, secondary criticality and steady dark solitary waves\nAt points of secondary criticality, that is points on the surface de\ufb01ned by\ndet[C( p)]= 0, the theory of Bridges (2006b) can be applied to determine the properties\nof the bifurcating homoclinic orbits. In the present context, the homoclinic orbit is\nbiasymptotic to the periodic Stokes waves coupled to a mean \ufb02ow. This homoclinic\norbit in the spatial setting is a steady DSW. There is a three-parameter family of\nbifurcating DSWs. They can be parameterized by the Bernoulli constant, mass \ufb02ux\nand wave action \ufb02ux, and hence they occupy a large region of physical parameter\nspace. A sketch of how this theory applies to the Boussinesq model is given, and then\nresults for water waves will be summarized.\nConsider the steady Boussinesq equation (2.5) perturbed about a family of relative\nequilibria near a point where det[C( p)]= 0. Taking a solution of the form\nZ(x) = G(\u03b8 (x))[Z\u0302 + W (x)] := Z\u0302(\u03b83) + W (\u03b83, x) + \u03b81(x)g1 + \u03b82(x)g2, (8.1)\nthe nonlinear problem for W (\u03b83, x) is\nJWx = L( p)W + 12D\n3S(Z\u0302)(W,W ) + \u00b7 \u00b7 \u00b7 (8.2)\nwhere the dots indicate terms of degree three and higher in \u2016W\u2016, and D3S(Z\u0302)(W,W )\nis the third derivative of S(Z) at the point Z\u0302, and\nL( p) = D2S(Z\u0302) \u2212 h0 D2R(Z\u0302) \u2212 u0 D2Q(Z\u0302) \u2212 kD2B(Z\u0302).\nThere exists a set of eight vectors {\u03be 1(\u03b83), . . . , \u03be 8(\u03b83)}, which are constructed using the\ngeneralized eigenvectors (see Appendix B), such that the transformation\nW (x, \u03b83)= \u03c6\u02dc1(x)\u03be 1(\u03b83) + \u03c6\u02dc2(x)\u03be 2(\u03b83) + \u03c6\u02dc3(x)\u03be 3(\u03b83) + u\u02dc(x)\u03be 4(\u03b83)\n\u2212s1I\u02dc 1(x)\u03be 8(\u03b83) + s2I\u02dc 2(x)\u03be 5(\u03b83) + s3I\u02dc 3(x)\u03be 6(\u03b83) + s1v\u02dc(x)\u03be 7(\u03b83) + \u00b7 \u00b7 \u00b7\n}\n(8.3)\n(note the ordering of the generalized eigenvectors in this expression) results in the\nreduced system of nonlinear ODEs\n\u2212 \u02d9\u02dcI 1 = 0,\n\u2212 \u02d9\u02dcI 2 = 0,\n\u2212 \u02d9\u02dcI 3 = 0,\n\u2212 \u02d9\u02dcv= I\u02dc 1 + \u03b4u\u02dc \u2212 12\u03bau\u02dc2 + \u00b7 \u00b7 \u00b7 ,\n\u02d9\u02dc\n\u03c61 = u\u02dc + \u00b7 \u00b7 \u00b7 ,\n\u02d9\u02dc\n\u03c62 = s2I\u02dc 2 + \u00b7 \u00b7 \u00b7 ,\n\u02d9\u02dc\n\u03c63 = s3I\u02dc 3 + \u00b7 \u00b7 \u00b7 ,\n\u02d9\u02dcu= s1v\u02dc + \u00b7 \u00b7 \u00b7 .\n\u23ab\u23aa\u23aa\u23aa\u23ac\u23aa\u23aa\u23aa\u23ad (8.4)\nThe parameter \u03b4 is an unfolding parameter; it is proportional the value of det(C( p))\nand is not qualitatively signi\ufb01cant. The signs s2 =\u00b11 and s3 =\u00b11 are the signs of the\nnon-zero eigenvalues of the criticality matrix C( p). They determine information about\ndirection of drift along the phases. The sign s1 =\u00b11 is related to the Jordan structure\nand has no qualitative impact on the bifurcating solitary waves. The important\nparameters are \u03ba and I\u02dc 1.\n406 T. J. Bridges and N. M. Donaldson\n~\nI2\n~\nI1\nI3\n~\nB\nR\nQn\nFigure 9. Illustration of the local coordinates (I\u02dc 1, I\u02dc 2, I\u02dc 3) on the surface of criticality.\nThe coordinates I\u02dc j are a translation and rotation of the coordinates (R,Q,B) to\na point on the criticality surface (see \ufb01gure 9). (The surface in (R,Q,B)-space with\na cusp along an edge in \ufb01gure 9 is a generalization of the curve with a cusp in\nthe (R,Q)-plane that is central to the Benjamin\u2013Lighthill (1954) theory. It is also a\ngeneralization of the cusp for uniform \ufb02ows shown in \ufb01gure 2 in this paper.) The\ncoordinates are oriented so that I\u02dc 2 and I\u02dc 3 give local coordinates tangent to the surface\nand I\u02dc 1 is a local normal coordinate given to leading order in terms of (R,Q,B) by\nI\u02dc 1 = a0 (P( p) \u2212 P( pcrit)) + \u00b7 \u00b7 \u00b7 with P := n1R + n2Q + n3B, (8.5)\nwhere a0 is a positive constant.\nThe normal vector n =(n1, n2, n3) is de\ufb01ned by C( p)n =0, and n can be taken to\nbe a column of the adjugate matrix, for example,\nn =\n\u239b\u239dRuQk \u2212 RkQuRkQh \u2212 RhQk\nRhQu \u2212 RuQh\n\u239e\u23a0 \u21d2 C( p)n = det[C( p)]\n\u239b\u239d00\n1\n\u239e\u23a0 . (8.6)\nHence, n is an eigenvector of C( p) corresponding to the zero eigenvalue when p = pcrit.\nThe most important parameter is \u03ba , the coe\ufb03cient of the nonlinear term in the\nnormal form, and the explicit formula for it is\n\u03ba = a30 n\nTHess p(P)n, (8.7)\nwhere a0 is a positive constant (the same constant as in (8.5)) and\nHess p(P) = n1Hess p(R) + n2Hess p(Q) + n3Hess p(B) evaluated at p = pcrit.\nHess p is the matrix of second derivatives with respect to the parameters p =(h0, u0, k).\nThe formula (8.7) is remarkable. It shows that the critical coe\ufb03cient in the nonlinear\nnormal form is determined by curvature information in the parameter space (R,Q,B).\nA special case of this result was \ufb01rst announced in Bridges & Donaldson (2005a). In\nthe present context, it enables complete qualitative information about the bifurcating\nDSWs to be determined from the criticality matrix.\nThe solitary wave solutions are determined from the reduced equation\n\u2212 \u02d9\u02dcv = I\u02dc 1 + \u03b4u\u02dc \u2212 12\u03bau\u02dc2 + \u00b7 \u00b7 \u00b7 ,\n\u02d9\u02dcu = s1v\u02dc + \u00b7 \u00b7 \u00b7 .\nSecondary criticality of water waves. Part 1 407\nNote that the degree of di\ufb03culty of solving for the DSWs using this equation is\nthe same as the degree of di\ufb03culty of solving for the Russell solitary wave in \u00a7 3.\nThe simpli\ufb01cation is due to the universality of the nonlinear normal form (8.4). The\noscillation of the solitary wave is encoded in the vectors \u03be j (\u03b83), j =1, . . . , 8.\nThe side of the surface where the DSWs lie is determined by the values of I\u02dc 1 and\n\u03ba such that the reduced system has non-zero \ufb01xed points,\nI\u02dc 1 + \u03b4u\u02dc \u2212 12\u03bau\u02dc2 + \u00b7 \u00b7 \u00b7 = 0.\nFor \u03b4 small, and u\u02dc small, it is clear that \ufb01xed points exist for \u03baI\u02dc 1 > 0. Hence, if \u03ba > 0,\nthen the direction of bifurcation of DSWs is aligned with the chosen normal direction\nand vice versa.\nWhen \u03baI\u02dc 1 > 0, solitary waves exist and are given locally by\nu\u02dc(x) = \u03bd \u2212 3\n(\n\u03bd \u2212 \u03b4\n\u03ba\n)\nsech2(\u00b5x), \u00b52 = 1\n4\n(s1\u03ba\u03bd \u2212 s1\u03b4),\nwhere \u03bd is the root of the quadratic\n\u03ba\u03bd2 \u2212 2\u03b4\u03bd \u2212 2I\u02dc 1 = 0,\nchosen so that s1\u03ba\u03bd > 0. Note that such a choice is always possible when \u03b4 is su\ufb03ciently\nsmall.\nAn important property of a dark solitary wave is the geometric phase. The total\nphase is obtained by solving the equations for \u03c6\u02dc1, . . . , \u03c6\u02dc3,\n\u03c6\u02dc1(x) = \u03bdx \u2212 3\n\u00b5\n(\n\u03bd \u2212 \u03b4\n\u03ba\n)\ntanh (\u00b5x) + \u03c6\u02dc01,\n\u03c6\u02dc2(x) = s2I\u02dc 2x + \u03c6\u02dc\n0\n2,\n\u03c6\u02dc3(x) = s3I\u02dc 3x + \u03c6\u02dc\n0\n2,\nwhere \u03c6\u02dc0j , j =1, 2, 3 is an arbitrary phase shift. The interesting part of the phase shift\nis the geometric phase\n\u0007\u03c6\u02dc1 :=\u2212 3\n\u00b5\n(\n\u03bd \u2212 \u03b4\n\u03ba\n)\ntanh (\u00b5x)\n\u2223\u2223\u2223\u2223x=+\u221e\nx=\u2212\u221e\n= \u2212 6\n\u00b5\n(\n\u03bd \u2212 \u03b4\n\u03ba\n)\n. (8.8)\nThe geometric phase gives the phase jump in going from the Stokes wave at x =\u2212\u221e\nto the Stokes wave at x =+\u221e.\nSubstituting the solutions of (8.4) into W (x, \u03b83) in (8.3) brings in the \u03b83 dependence\nand the full form of the steady dark solitary wave, including the oscillatory part.\n9. Steady dark solitary waves of the water-wave problem\nThe theory of \u00a7 8 is applied to the water-wave problem to determine the properties\nof the bifurcating dark solitary waves. The mechanism for the bifurcation of these\nwaves is di\ufb00erent from other oscillatory solitary waves that have been found in the\nwater wave problem. Therefore it is useful to \ufb01rst review the literature on known\noscillatory solitary waves and dark solitary waves found in water wave models.\nThis bifurcation of steady DSWs is mathematically similar to \u2013 but physically\ndi\ufb00erent from \u2013 the DSWs that appear in the defocusing nonlinear Schro\u00a8dinger\n(NLS) equation for water waves (e.g. Peregrine 1983, 1985). The DSWs in this paper\nare steady in an absolute frame of reference, whereas the DSW solutions of the NLS\n408 T. J. Bridges and N. M. Donaldson\nequation for gravity water waves in \ufb01nite depth are unsteady in any reference frame.\nConsider the NLS model for modulation of Stokes waves in \ufb01nite depth\niA\u03c4 + \u00b5A\u03be\u03be + \u03bd\u02dc|A|2A = 0. (9.1)\nFor gravity waves \u00b5< 0 and for kh0 less than the critical value of approximately\n1.36, the coe\ufb03cient \u03bd\u02dc is positive. Unsteady DSWs exist when \u00b5\u03bd\u02dc < 0 with explicit\nexpression\nA(\u03be, \u03c4 ) = ei(k\u02dc\u03be\u2212\u03c9\u02dc\u03c4 )\n(\n2\u00b52\n|\u00b5\u03bd\u02dc|\n)1\/2\n(k\u02dc + i\u03c7 tanh(\u03c7\u03be )), \u03c72 =\n1\n2\u00b52\n(\u00b5\u03c9\u02dc \u2212 3\u00b52k\u02dc2), (9.2)\nand the requirement \u00b5\u03c9\u02dc> 3a2k\u02dc2. The full unsteadiness of these waves becomes\napparent when viewed as solutions of the water-wave problem: the leading-order\nexpression for the waveheight is\n\u03b7(x, t) = \u03b5Re\n(\nA(\u03be, \u03c4 )ei(k0x\u2212\u03c90t)\n)\n, \u03be = \u03b5(x \u2212 cgt), \u03c4 = \u03b52t.\nThere are two frame speeds: the phase speed of the Stokes wave, and the frame speed\nof the DSW which is the group velocity, and further unsteadiness due to the e\u2212i\u03c9\u02dc\u03c4\nterm. In fact, the NLS type modulation equations for Stokes waves in \ufb01nite depth\nare intrinsically unsteady (cf. Bridges 2005), and therefore cannot capture steady\nDSWs that are synchronized with the Stokes wave. Unsteady DSWs are generated by\na di\ufb00erent mechanism: the transition from Benjamin\u2013Feir unstable waves to stable\nwaves. These unsteady DSWs will come back into the story when unsteady aspects\nof criticality are considered in Bridges & Donaldson (2006).\nIn the full two-dimensional water-wave problem, steady solitary waves with\noscillatory tails have been found previously, but only when surface tension is present.\nThere are surface-tension dominated solitary waves which are biasymptotic to the\ntrivial state (or to an exponentially small state) associated with the minimum of the\ndispersion relation; see Dias & Iooss (2003) for a recent review of these waves with\nextensive references. Dias & Iooss (1994) also \ufb01nd steady DSWs at the interface\nbetween two \ufb02uids when surface tension is present. The bifurcation of DSWs is\nsimilar mathematically to the nonlinear behaviour near a transition to superharmonic\ninstability, but in that context the homoclinic orbit is in time, and not related to a\nsolitary wave (cf. Bridges 2004).\nIn three-dimensions, steady gravity-driven DSWs have been found in water-wave\nproblems when the variation is in the transverse direction. Examples are given in\nPeregrine (1983, 1985 \u00a7 8). Roberts & Peregrine (1983) compute transverse DSWs up\nto sixth order for the full water-wave problem.\nFor constant density \ufb02uids, solitary waves with oscillatory tails which represent\n\ufb01nite-amplitude DSWs, have been found previously in models for water waves\nwhen surface tension is non-zero. When the Bond number is approximately 1\/3\nand the Froude number is greater than one, the existence of these surface-tension\ndominated waves was \ufb01rst proved by Amick & Toland (1992) for a model ODE\n(see also Grimshaw & Joshi 1995). The analytical results show that these waves\nare biasymptotic to periodic states with exponentially small amplitude. However,\nnumerical continuation of these waves by Champneys & Lord (1997) show that they\nhave \ufb01nite-amplitude periodic solutions at in\ufb01nity when continued to \ufb01nite amplitude.\n9.1. Gravity-driven steady dark solitary waves\nIt was shown in \u00a7 7.1 that there exists a critical surface satisfying det[C( p)]= 0 for\ngravity waves in shallow water. The local nonlinear normal form for bifurcating\nSecondary criticality of water waves. Part 1 409\nkh0\n 0.1\n\u03ba\n1.0\nFigure 10. The curvature coe\ufb03cient \u03ba as a function of kh0.\nsolitary waves is given by (8.4). By computing \u03ba , all the local nonlinear behaviour can\nbe predicted. The formula for the coe\ufb03cient \u03ba is given in (8.7) with the formula for\nn given in (8.6). Given the entries of the criticality matrix computed in \u00a7 7 for weakly\nnonlinear water waves, \u03ba can be explicitly computed and it is plotted in \ufb01gure 10 as\na function of kh0. Since the calculation in \ufb01gure 10 is based on the two-term Stokes\nexpansion, the values for very small kh0 should be interpreted with caution.\nIn \u00a7 7.1, it was shown that secondary criticality occurs at low amplitude (weakly\nnonlinear theory) for all kh0 < (kh0)\npoint2 \u2248 0.85. According to \ufb01gure 10, \u03ba < 0 for all\nkh0 in this range (the zero-crossing of the curve in \ufb01gure 10 is greater than 0.95).\nHence the bifurcating solitary waves exist for I\u02dc 1 < 0; that is, the solitary waves exist\non the side of the criticality surface in the direction opposite to the chosen normal\nvector. To express this region in terms of the Bernoulli constant, mass \ufb02ux and wave\naction \ufb02ux, let pcrit be any point satisfying det[C( p)]= 0, and let\n(R0,Q0,B0) := (R( pcrit),Q( pcrit),B( pcrit)).\nThen dark solitary waves arise locally in parameter space with\nn1(R \u2212 R0) + n2(Q \u2212 Q0) + n3(B \u2212 B0) < 0 with |I\u02dc 1| \r 1. (9.3)\nThis is a very large region of parameter space, suggesting that steady dark solitary\nwaves are just as plentiful as Stokes periodic waves. However, whether these waves are\nstable or not is an open question. If they are stable then they should be experimentally\nveri\ufb01able.\nThe inequality (9.3) is independent of the sign of n \u2013 even though the sign of n\ncan be chosen arbitrarily. To see this, suppose n is replaced by \u2212n. It would appear\nthat the inequality in (9.3) is reversed; but the sign change also a\ufb00ects the sign of\nP( p) since it depends cubically on n. In other words, the sign of the product \u03baI\u02dc 1\nis independent of the choice of normal vector. The inequality (9.3) is unambiguous\nin the following sense: it signals whether the direction of bifurcation is aligned with\nor opposite to the direction of the chosen normal vector. In the present case, with n\nchosen using the formula (8.6) the solitary waves exist in the \u2212n direction.\nWe have computed the signs of the non-zero eigenvalues of C( p) for kh0 = 0.5 and\nkh0 = 0.7 which correspond to the \ufb01rst two graphs in \ufb01gure 7, and in both cases\nthe eigenvalues have opposite sign. Choosing an appropriate ordering we can take\ns2 =\u22121 and s3 =+1. However, the only impact of these signs is to give direction\ninformation about the drift along the phase directions \u03c6\u02dc2 and \u03c6\u02dc3. The important\nphase information is the geometric phase, and the explicit formula is given in (8.8).\n410 T. J. Bridges and N. M. Donaldson\nFor water waves the geometric phase is given to leading order by\n\u0007\u03c6\u02dc1 = \u00b1 12|\u03ba | (2\u03baI\u02dc 1)\n1\/4, I\u02dc 1 < 0.\nThe theory of \u00a7 8 assumes a \ufb01nite-dimensional phase space, whereas the water-wave\nproblem has an in\ufb01nite-dimensional phase space. However, we can reduce the in\ufb01nite\ndimensional phase space to a \ufb01nite dimensional phase space using spatial centre-\nmanifold theory (cf. Mielke 1991; Bridges & Mielke 1995). Then the theory applies as\nbefore to the \ufb01nite-dimensional system. The important point is that the existence of\nsteady dark solitary waves can be precisely justi\ufb01ed for the full water-wave problem.\nIn contrast there is no known theory for justifying the existence of unsteady DSWs\nin the full water-wave problem.\n10. Concluding remarks\nThis paper showed that there is a generalization of criticality to \ufb01nite-amplitude\nStokes waves in \ufb01nite depth, and the principal consequence of this \u2018secondary\ncriticality\u2019 is the bifurcation of steady DSWs. The theory required three principal\nsteps. The determinant condition for primary criticality (1.4) was generalized to a\ndeterminant condition for secondary criticality (1.8). The second step was to show\nthe implication of this condition for the linearization about Stokes waves coupled to\na mean \ufb02ow: a pair of spatial Floquet multipliers coalesces at +1. Although spatial\nFloquet multipliers associated with the linearization about waves have been computed\nand reported in the literature, the connection with criticality is established here for\nthe \ufb01rst time. The third step, which involved recent developments in dynamical\nsystems, is to show that the nonlinear problem near secondary criticality always has\na bifurcation of solitary waves and the physical properties of the bifurcating steady\nDSWs are dictated by the properties of the criticality matrix. By analysing Boussinesq\nmodels for shallow-water waves and the full water-wave problem, it was shown that\nsecondary criticality and the bifurcation of steady DSWs is pervasive in shallow water.\nIn Part 2, it is shown that the concepts discovered for the steady problem can be\ngeneralized to unsteady waves to give new insight into the Benjamin\u2013Feir instability\nin \ufb01nite depth.\nRelative equilibria can be extended to the time-dependent problem, and the concept\nof the degenerate relative equilibrium is well-de\ufb01ned. This leads to a naive de\ufb01nition\nof criticality for a class of unsteady \ufb02ows (time periodic in a moving frame); but what\nis the implication of this de\ufb01nition of unsteady criticality? The main result of Part 2\nof this study is to show how the hydraulic properties of the uniform \ufb02ow coupled to\na spatially periodic wave and the criticality matrix C( p) enter into the linear stability\nof the periodic wave. A sketch of the result is as follows. A periodic wave in shallow\nwater, with speci\ufb01ed total head, mass \ufb02ux and wave action \ufb02ux is linearly unstable if\nthe determinant of the deformed criticality matrix, N(\u2126), has a root \u2126 with non-zero\nimaginary part, where\nN(\u2126) =\n\u2202(R,Q,B)\n\u2202(h0, u0, k)\n+ \u2126\n\u23a1\u23a30 1 \u00011 0 \u0001\n\u0001 \u0001 \u0001\n\u23a4\u23a6+ \u21262\n\u23a1\u23a3 0 0 00 0 0\n0 0 \u0001\n\u23a4\u23a6 , (10.1)\nwhere\u0001 represents entries which are determined by the theory for unsteady criticality.\nSecondary criticality of water waves. Part 1 411\nThe instability condition based on (10.1) is new, and connects bulk quantities\nfamiliar from hydraulics to the Benjamin\u2013Feir instability: the criticality matrix is the\ncentral feature in (10.1).\nThe authors are grateful to Howell Peregrine whose probing questions and\nsuggestions led to several new dimensions in this paper.\nAppendix A. Algebraic multiplicity, Jordan chain theory and criticality\nIn this Appendix and Appendix B, it is shown how Jordan chain theory for\ngeneralized eigenvectors enters the analysis of criticality. Let K be a non-selfadjoint\nlinear operator acting on a \ufb01nite-dimensional vector space. (Comments on di\ufb00erential\noperators are at the end of this Appendix.)\nSuppose zero is an eigenvalue of K of geometric multiplicity one; that is, there exist\nan eigenvector \u03be1 and adjoint eigenvector \u03b61 such that\nK\u03be1 = 0, K\nT \u03b61 = 0.\nThe geometric multiplicity is the number of linearly independent vectors in the kernel\nof K. Now suppose zero is an eigenvalue of algebraic multiplicity of at least two. In\n\ufb01nite dimensions, the algebraic multiplicity of an eigenvalue equals the multiplicity\nof it as a root of the characteristic polynomial. For di\ufb00erential operators, where the\nconcept of a characteristic polynomial does not apply, the algebraic multiplicity is\nde\ufb01ned using Jordan chain theory (cf. Lancaster & Tismenetsky 1985, chap. 6). If\nzero is an eigenvalue of K of algebraic multiplicity greater than or equal to two, then\nthere exists a vector \u03be2 satisfying\nK\u03be2 = \u03be1,\nand the algebraic multiplicity is greater than two if and only if there exists a vector\n\u03be3 with\nK\u03be3 = \u03be2.\nBut this equation is solvable if and only if the right-hand side is in the range of K,\n\u3008\u03b61, \u03be2\u3009 = 0.\nIn summary, if \u3008\u03b61, \u03be2\u3009 \u0002= 0 then the algebraic multiplicity of the zero eigenvalue is\nexactly two, and if \u3008\u03b61, \u03be2\u3009=0 the algebraic multplicity is greater than or equal to\nthree.\nThe generalization of this result, suitable for the theory of criticality, is as follows.\nSuppose zero is an eigenvalue of geometric multiplicity m: there exist m linearly\nindependent eigenvectors \u03be1, . . . , \u03bem and m linearly independent adjoint eigenvectors\n\u03b61, . . . , \u03b6m satisfying\nK\u03bej = 0, K\nT \u03b6j = 0 for j = 1, . . . , m.\nSuppose that each of the eigenvectors is associated with a Jordan chain of length two\nK\u03bem+j = \u03bej , j = 1, . . . , m.\nIt follows from Jordan chain theory that the algebraic multiplicity of the eigenvalue\nzero is greater than or equal to 2m.\nFor the algebraic multiplicity to be strictly greater than 2m, at least one of the\nJordan chains must exceed two in length: there exists a non-zero n =(n1, . . . , nm) \u2208 \u0001m\n412 T. J. Bridges and N. M. Donaldson\nsuch that the following equation is solvable\nK\u03be2m+1 = n1\u03ben+1 + n2\u03bem+2 + \u00b7 \u00b7 \u00b7 + nn\u03be2m.\nThis equation is solvable if and only if the right-hand side is in the range of K,\u23a1\u23a2\u23a3\u3008\u03b61, \u03bem+1\u3009 \u00b7 \u00b7 \u00b7 \u3008\u03b61, \u03be2m\u3009... . . . ...\n\u3008\u03b6m, \u03bem+1\u3009 \u00b7 \u00b7 \u00b7 \u3008\u03b6m, \u03be2m\u3009\n\u23a4\u23a5\u23a6\n\u239b\u239c\u239dn1...\nnm\n\u239e\u239f\u23a0 =\n\u239b\u239c\u239d0...\n0\n\u239e\u239f\u23a0 ,\nwhich in turn has a non-trivial solution if and only if\ndet\n\u23a1\u23a2\u23a3\u3008\u03b61, \u03bem+1\u3009 \u00b7 \u00b7 \u00b7 \u3008\u03b61, \u03be2m\u3009... . . . ...\n\u3008\u03b6m, \u03bem+1\u3009 \u00b7 \u00b7 \u00b7 \u3008\u03b6m, \u03be2m\u3009\n\u23a4\u23a5\u23a6 = 0. (A 1)\nThis theory simpli\ufb01es considerably when K is a Hamiltonian operator. A\nHamiltonian operator is the product of a skew-symmetric operator and a symmetric\noperator,\nK = J\u22121L, with JT = \u2212J, LT = L.\nWhen the linear operator K is decomposed in this form the adjoint eigenvectors are\nrelated to the eigenvectors by J: suppose \u03be0 is an eigenvector associated with a zero\neigenvalue: K\u03be0 = 0. In the Hamiltonian context, this is equivalent to L\u03be0 = 0. The\nadjoint eigenvector is \u03b60 = a0J\u03be0 for some constant a0, since\nKT \u03b60 = a0(J\n\u22121L)T J\u03be0 = \u2212a0LJ\u22121J\u03be0 = \u2212a0L\u03be0 = 0.\nThe solvability condition (A 1) can now be expressed purely in terms of the vectors\n\u03be1, . . . , \u03be2m,\ndet\n\u23a1\u23a2\u23a3\u3008J\u03be1, \u03bem+1\u3009 \u00b7 \u00b7 \u00b7 \u3008J\u03be1, \u03be2m\u3009... . . . ...\n\u3008J\u03bem, \u03bem+1\u3009 \u00b7 \u00b7 \u00b7 \u3008J\u03bem, \u03be2m\u3009\n\u23a4\u23a5\u23a6 = 0. (A 2)\nIn the context of criticality, there is additional structure which relates this solvability\ncondition to hydraulic properties. Mathematically, this structure arises because there\nexists a vector Z\u0302(\u03b8, a) with \u03b8 =(\u03b81, . . . , \u03b8m) and a =(a1, . . . , am) and\n\u03bej =\n\u2202Z\u0302\n\u2202\u03b8j\n|\n\u03b8=0 = J\n\u22121\u2207Pj (Z\u0302), \u03ben+j = \u2202Z\u0302\n\u2202aj\n, j = 1, . . . , m,\nsince \u2207Pj (Z\u0302)= J\u03bej . Then the solvability condition can be expressed in terms of the\nJacobian\n0 = det\n\u23a1\u23a2\u23a3\u3008\u2207P1, \u03bem+1\u3009 \u00b7 \u00b7 \u00b7 \u3008\u2207P1, \u03be2m\u3009... . . . ...\n\u3008\u2207Pm, \u03bem+1\u3009 \u00b7 \u00b7 \u00b7 \u3008\u2207Pm, \u03be2m\u3009\n\u23a4\u23a5\u23a6 = \u2223\u2223\u2223\u2223\u2202(P1, . . . , Pm)\u2202(a1, . . . , am)\n\u2223\u2223\u2223\u2223 .\nTo summarize: when the linear operator K is associated with the linearization about\nan m-parameter family of symplectic relative equilibria and the eigenvalue zero has\ngeometric multiplicity m, then the algebraic multiplicity is greater than 2m if and\nSecondary criticality of water waves. Part 1 413\nonly if \u2223\u2223\u2223\u2223\u2202(P1, . . . , Pm)\u2202(a1, . . . , am)\n\u2223\u2223\u2223\u2223 = 0.\nThe extension to linear di\ufb00erential operators follows the same lines when the\noperators are Fredholm with index zero (dimension of the kernel of K equals the\ndimension of the kernel of the adjoint of K). Similarly, for di\ufb00erential operators with\nperiodic coe\ufb03cients there is a variant of Jordan chain theory which is combined with\nFloquet theory (cf. Iooss & Adelmeyer 1992, chap. 3). The Hamiltonian version of\nthis theory then follows the same lines as above.\nAppendix B. Criticality and eigenvalues\nThe theory of Appendix A is combined with the theory for secondary criticality,\nbased on degeneracy of the criticality matrix C( p), to show that there is an additional\npair of zero Floquet exponents at degeneracy. The details of the argument are\npresented for the Boussinesq model in the form (2.5).\nConsider the steady equation (2.5) near the family of solutions (5.3), of the form\n(8.1). Substitution into (2.5) and use of the symmetry properties of the equation leads\nto the linearized system\nJWx = L( p)W with L( p) = D2S(Z\u0302) \u2212 kD2B(Z\u0302). (B 1)\nIn contrast to the linearization about uniform \ufb02ows, this equation is a PDE \u2013 even for\nthe Boussinesq model, but with coe\ufb03cients that are periodic functions of \u03b83. Taking\na Floquet form of solutions, the spectral problem is obtained by taking\nW (\u03b83, x) = e\n\u00b5xV (\u03b83), V (\u03b83 + 2\u03c0)=V (\u03b83), leading to the ODE L( p)V = \u00b5JV.\n(B 2)\nThis spectral problem has a zero eigenvalue of (at least) geometric multiplicity\nthree and (at least) algebraic multiplicity six. If the geometric multiplicity is exactly\nthree, the algebraic multiplicity of the zero eigenvalue is greater than six if and only\nif the basic state (the uniform \ufb02ow coupled to a periodic wave) is critical.\nThese statements are con\ufb01rmed as follows. The kernel of J\u22121L( p) is spanned by the\ngenerators of the group of symmetries\nL( p)g1 = L( p)g2 = L( p)g3 = 0 with g3 =\n\u2202Z\u0302\n\u2202\u03b83\n. (B 3)\nLinear independence of {g1, g2, g3} then ensures that the geometric multiplicity is at\nleast three. Assume that the geometric multiplicity is exactly three.\nThe structure of the relative equilibria generates three generalized eigenvectors,\nL( p)\n(\n\u2202Z\u0302\n\u2202h0\n)\n=\u2207R(Z\u0302) = Jg1,\nL( p)\n(\n\u2202Z\u0302\n\u2202u0\n)\n=\u2207Q(Z\u0302) = Jg2,\nL( p)\n(\n\u2202Z\u0302\n\u2202k\n)\n=\u2207B(Z\u0302) = Jg3.\n\u23ab\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23ac\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23ad\n(B 4)\n414 T. J. Bridges and N. M. Donaldson\nFigure 11. Transition of Floquet multipliers due to secondary criticality.\nThe three pairs (g1, \u2202Z\u0302\/\u2202h0), (g2, \u2202Z\u0302\/\u2202u0) and (g3, \u2202Z\u0302\/\u2202k) each form a Jordan chain\nof length two. Applying Jordan chain theory for linear ODEs with periodic coe\ufb03cients\n(see Appendix A), zero is an eigenvalue of algebraic multiplicity at least six, and it is\ngreater than six if and only if there exists a non-zero n = (n1, n2, n3) \u2208 \u00013 such that\nthe equation\nL( p) = J\n(\nn1\n\u2202Z\u0302\n\u2202h0\n+ n2\n\u2202Z\u0302\n\u2202u0\n+ n3\n\u2202Z\u0302\n\u2202k\n)\nis solvable. However, this equation is solvable if and only if the right-hand side is in\nthe range of L, that is, if\u2329\nJgj ,\n(\nn1\n\u2202Z\u0302\n\u2202h0\n+ n2\n\u2202Z\u0302\n\u2202u0\n+ n3\n\u2202Z\u0302\n\u2202k\n)\u232a\n= 0,\nfor j =1, 2, 3, which is equivalent to det(C( p))= 0.\nTo summarize, if the geometric multiplicity of zero is exactly three, then the\nalgebraic multiplicity is greater than six if and only if the basic state \u2013 a spatially\nperiodic wave coupled to two-component mean \ufb02ow \u2013 is critical. Passing through\ncriticality is therefore a saddle-centre bifurcation of Floquet exponents, and in Floquet\nmultiplier space a pair of Floquet multipliers coalesces at +1 as shown in \ufb01gure 11.\nIn addition to the moving pair of Floquet multipliers there are six multipliers at +1\nin this scenario.\nAt criticality, the number of generalized eigenvectors increases, but the number of\neigenvectors remains the same. Therefore criticality is a su\ufb03cient \u2013 but not necessary \u2013\ncondition for the multiplicity of the zero eigenvalue to increase. The multiplicity could\nalso increase owing to an increase in geometric multiplicity (i.e. the appearance of\nan additional independent eigenvector in the kernel of K). This latter case does not\narise for parameter regions associated with water waves studied in this paper and is\ntherefore not considered.\nAppendix C. Criticality of uniform \ufb02ows and \u2018group velocity\u2019\nClassical uniform \ufb02ows are critical if and only if the Froude number is unity.\nHowever, a curiosity appears in \u00a7 7.1 in the leading-order term in the expression for\nthe determinant of the criticality matrix. In the limit as |A1| \u2192 0 in (7.7), the condition\nfor secondary criticality reduces to\nlim\n|A1|\u21920\ndet[C( p)] =\ngh0\n\n\nD2k (1 \u2212 F 2).\nTherefore if Dk \u0002= 0, the Froude number unity condition for criticality is recovered.\nBut what happens when Dk =0? Does it also signify a form of criticality?\nSecondary criticality of water waves. Part 1 415\nThe classical group velocity for a Stokes gravity wave is\ncg =\n1\n2\nu0\n(\n1 +\nkh0\n\u03c3\n(1 \u2212 \u03c3 2)\n)\n.\nIt is important to note that the association with group velocity here is by analogy.\nThere is no concept of group velocity for a steady wave without the introduction of\ntime. On the other hand, Dk = gk(1 \u2212 (kh0\/\u03c3 )(1 \u2212 \u03c3 2)) and so\nDk =\n2gk\nu0\n(u0 \u2212 cg).\nThe singularity Dk =0 corresponds to a point where u0 is equal to the \u2018group velocity\u2019.\nThis singularity does occur in the water-wave problem, but only when surface tension\nis present. It corresponds to the minimum of the dispersion relation when the phase\nspeed is plotted as a function of kh0. The point where cg = u0 is a well-known\npoint of bifurcation for solitary waves with oscillatory tails, but the tails decay to\nzero at in\ufb01nity. See Dias & Iooss (2003) for a review of results of solitary waves\nnear this point. Points where cg = u0 are also called stopping velocities (cf. Bridges,\nChristodoulides & Dias 1995).\nIn summary, the theory shows that the point Dk =0 can also be interpreted as a\npoint of criticality. However, it is found by taking the limit as the amplitude of the\nStokes wave goes to zero in the secondary criticality condition.\nREFERENCES\nAbbott, M. B. 1979 Computational Hydraulics. Pitman.\nAmick, C. J. & Toland, J. F. 1981 On periodic water waves and their convergence to solitary waves\nin the long-wave limit. Phil. Trans. R. Soc. Lond. A 303, 633\u2013669.\nAmick, C. & Toland, J. F. 1992 Solitary waves with surface tension I: trajectories homoclinic to\nperiodic orbits in four dimensions. Arch. Rat. Mech. Anal. 118, 127\u2013148.\nBaesens, C. & MacKay, R. S. 1992 Uniformly travelling water waves from a dynamical systems\nviewpoint: some insights into bifurcations from Stokes\u2019 family. J. Fluid Mech. 241, 333\u2013347.\nBenjamin, T. B. 1971 A uni\ufb01ed theory of conjugate \ufb02ows. Phil. Trans. R. Soc. Lond. A 269, 587\u2013643.\nBenjamin, T. B. 1984 Impulse, \ufb02ow force and variational principles. IMA J. Appl. Maths 32, 3\u201368.\nBenjamin, T. B. & Lighthill, M. J. 1954 On cnoidal waves and bores. Proc. R. Soc. Lond. A 224,\n448\u2013460.\nBenjamin, T. B. & Olver, P. J. 1982 Hamiltonian structure, symmetries and conservation laws for\nwater waves. J. Fluid Mech. 125, 137\u2013185.\nBoussinesq, J. 1877 Essai sur la the\u00b4orie des eaux courantes. Memoires presentes par divers savant a\nl\u2019Academie des Science de l\u2019Institut de France 23, 1\u2013680.\nBridges, T. J. 1992 Spatial Hamiltonian structure, energy \ufb02ux and the water-wave problem. Proc.\nR. Soc. Lond. A 439, 297\u2013315.\nBridges, T. J. 1996 Periodic patterns, linear instability, symplectic structure and mean-\ufb02ow dynamics\nfor three-dimensional surface waves. Phil. Trans. R. Soc. Lond. A 354, 533\u2013574.\nBridges, T. J. 1997a Multi-symplectic structures and wave propagation. Math. Proc. Camb. Phil.\nSoc. 121, 147\u2013190.\nBridges, T. J. 1997b A geometrical formulation of the conservation of wave action and its\nimplications for signature and the classi\ufb01cation of instabilities. Proc. R. Soc. Lond. A 453,\n1365\u20131395.\nBridges, T. J. 2001 Transverse instability of solitary-wave states of the water-wave problem. J. Fluid\nMech. 439, 255\u2013278.\nBridges, T. J. 2004 Superharmonic instability, homoclinic torus bifurcation and water-wave\nbreaking. J. Fluid Mech. 505, 153\u2013162.\nBridges, T. J. 2005 Steady dark solitary waves emerging from wave-generated mean\ufb02ow: the role\nof modulation equations. Chaos 15, 037113.\n416 T. J. Bridges and N. M. Donaldson\nBridges, T. J. 2006a Canonical multi-symplectic structure on the total exterior algebra bundle.\nProc. R. Soc. Lond. A 462, 1531\u20131551.\nBridges, T. J. 2006b Degenerate relative equilibria, curvature of the momentum map, and homoclinic\nbifurcation. Preprint, University of Surrey.\nBridges, T. J. & Donaldson, N. M. 2005 Degenerate periodic orbits and homoclinic torus\nbifurcation Phys. Rev. Lett. 95, 104301.\nBridges, T. J. & Donaldson, N. M. 2006 Secondary criticality of water waves. Part 2. Unsteady\ncriticality and the Benjamin\u2013Feir instability from the viewpoint of hydraulics. J. Fluid Mech.\n565, 419\u2013439.\nBridges, T. J. & Fan, E. G. 2004 Solitary waves, periodic waves, and a stability analysis for Zu\ufb01ria\u2019s\nhigher-order Boussinesq model for shallow water waves. Phys. Lett. A 326, 381\u2013390.\nBridges, T. J. & Mielke, A. 1995 A proof of the Benjamin\u2013Feir instability. Arch. Rat. Mech. Anal.\n133, 145\u2013198\nBridges, T. J., Christodoulides, P. & Dias, F. 1995 Spatial bifurcations of capillary\u2013gravity\ninterfacial waves when the phase and group velocities are nearly equal. J. Fluid Mech. 295,\n121\u2013158.\nBuffoni, B., Dancer, E. N. & Toland, J. F. 2000 The subharmonic bifurcation of Stokes waves.\nArch. Rat. Mech. Anal. 152, 241\u2013271.\nChampneys, A. R. & Lord, G. J. 1997 Computation of homoclinic solutions to periodic orbits in\na reduced water-wave problem. Physica D 102, 101\u2013124.\nChristov, C. I. 2001 An energy-consistent dispersive shallow-water model. Wave Motion 34, 161\u2013\n174.\nCokelet, E. D. 1977 Steep gravity waves in water of arbitrary uniform depth. Phil. Trans. R. Soc.\nLond. A 286, 183\u2013230.\nCraig, W. & Groves, M. D. 1994 Hamiltonian long-wave approximations to the water-wave\nproblem. Wave Motion 19, 367\u2013389.\nDeymie, P. H. 1935 Propagation d\u2019une intumescence allonge\u00b4e. Rev. Ge\u00b4n. L\u2019Hydraulique 1, 138\u2013142.\nDias, F. & Iooss, G. 1994 Ondes solitaires \u2018noires\u2019 a` l\u2019interface entre deux \ufb02uides en presence de\ntension super\ufb01cielle. C. R. Acad. Sci. Paris Se\u00b4r. I Math. 319, 89\u201393.\nDias, F. & Iooss, G. 2003 Water waves as a spatial dynamical system. Handbook of Mathematical\nFluid Dynamics, vol. 2, pp. 443\u2013499. North-Holland.\nDingemans, M. W. 1997 Water Wave Propagation over Uneven Bottoms. Part 2 \u2013 Non-linear Wave\nPropagation. World Scienti\ufb01c.\nDooge, J. C. I. 1987 Historical development of concepts in open channel \ufb02ow. In Hydraulics and\nHydraulic Research: a Historical Review (ed. G. Garbrecht, A. A. Balkema. pp. 205\u2013230.\nDoole, S. H. 1997 The bifurcation of long waves in the parameter space of pressure head and\n\ufb02owforce. Q. J. Mech. Appl. Maths 50, 17\u201334.\nDoole, S. H. & Norbury, J. 1995 The bifurcation of steady gravity water waves in (R, S) parameter\nspace. J. Fluid Mech. 302, 287\u2013305.\nGill, A. E. 1977 The hydraulics of rotating channel \ufb02ow. J. Fluid Mech. 80, 641\u2013671.\nGobbi, M. F., Kirby, J. T. & Wei, G. 2000 A fully nonlinear Boussinesq model for surface waves.\nPart 2. Extension to O(kh)4. J. Fluid Mech. 405, 181\u2013210.\nGrimshaw, R. H. J. & Joshi, N. 1995 Weakly nonlinear solitary waves in a singularly-perturbed\nKorteweg\u2013deVries equation. SIAM J. Appl. Maths 55, 124\u2013135.\nGroves, M. D. & Toland, J. F. 1997 On variational formulations for steady water waves. Arch.\nRat. Mech. Anal. 137, 203\u2013226.\nHenderson, F. M. 1966 Open Channel Flow. Macmillan.\nIooss, G. & Adelmeyer, M. 1992 Topics in Bifurcation Theory and Applications. World Scienti\ufb01c.\nJohnson, E. R. & Clarke, S. R. 2001 Rossby wave hydraulics. Annu. Rev. Fluid Mech. 33, 207\u2013230.\nKeady, G. & Norbury, J. 1975 Water waves and conjugate streams. J. Fluid Mech. 70, 663\u2013671.\nKillworth, P. D. 1992 On hydraulic control in a strati\ufb01ed \ufb02uid. J. Fluid Mech. 237, 605\u2013626.\nLancaster, P. & Tismenetsky, M. 1985 The Theory of Matrices 2nd edn., Academic.\nLuke, J. C. 1967 A variational principle for a \ufb02uid with a free surface. J. Fluid Mech. 27, 395\u2013397.\nMadsen, P. A., Bingham, H. B. & Liu, H. 2002 A new Boussinesq method for fully nonlinear waves\nfrom shallow to deep water. J. Fluid Mech. 462, 1\u201330.\nMagnus, J. R. & Neudecker, H. 1988 Matrix Di\ufb00erential Calculus. John Wiley.\nSecondary criticality of water waves. Part 1 417\nMarsden, J. E. 1992 Lectures on Mechanics. London Mathematical Society. vol. 174. Cambridge\nUniversity Press.\nMcLean, J. W. 1982 Instabilities of \ufb01nite-amplitude gravity waves on water of \ufb01nite depth. J. Fluid\nMech. 114, 331\u2013341.\nMielke, A. 1991 Hamiltonian and Lagrangian Flows on Center-Manifolds with Applications to Elliptic\nVariational Problems. Lecture Notes in Maths. vol. 1489. Springer.\nMielke, A. 1996 A spatial center-manifold approach to steady bifurcations from spatially periodic\npatterns. Pitman Res. Notes Maths 352, 209\u2013277.\nNutku, Y. 1983 Canonical formulations of shallow water \ufb02ows. J. Phys. A: Maths Gen. 16, 4195\u2013\n4201.\nPeregrine, D. H. 1983 Water waves, nonlinear Schro\u00a8dinger equations and their solutions. J. Austral.\nMath. Soc. B 25, 16\u201343.\nPeregrine, D. H. 1985 Water waves and their development in space and time. Proc. R. Soc. Lond.\nA 400, 1\u201318.\nRoberts, A. J. & Peregrine, D. H. 1983 Notes on long-crested water waves. J. Fluid Mech. 135,\n323\u2013335.\nStiassne, M. & Peregrine, D. H. 1980 Shoaling of \ufb01nite-amplitude surface waves on water of\nslowly-varying depth. J. Fluid Mech. 97, 783\u2013805.\nVandenbroeck, J.-M. 1983 Some new gravity waves in water of \ufb01nite depth. Phys. Fluids 26,\n2385\u20132387.\nWhitham, G. B. 1974 Linear and Nonlinear Waves. Wiley-Interscience.\nZakharov, V. E. 1968 Stability of periodic waves of \ufb01nite amplitude on the surface of a deep \ufb02uid.\nZh. Prikl. Mekh. Fiz. 9, 86\u201394 (English trans: J. Appl. Mech. Tech. Phys. 2, 190).\nZufiria, J. A. 1987 Weakly nonlinear non-symmetric gravity waves on water of \ufb01nite depth. J. Fluid\nMech. 180, 371\u2013385.\n"}