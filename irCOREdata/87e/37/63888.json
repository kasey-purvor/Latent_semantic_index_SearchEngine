{"doi":"10.1007\/s00382-007-0254-9","coreId":"63888","oai":"oai:nora.nerc.ac.uk:1376","identifiers":["oai:nora.nerc.ac.uk:1376","10.1007\/s00382-007-0254-9"],"title":"Effects of atmospheric dynamics and ocean resolution on bi-stability of the thermohaline circulation examined using the Grid ENabled Integrated Earth system modelling (GENIE) framework","authors":["Lenton, T.M.","Marsh, R.","Price, A.R.","Lunt, D J.","Aksenov, Y.","Annan, J.D.","Cooper-Chadwick, T.","Cox, S.J.","Edwards, N.R.","Goswami, S.","Hargreaves, J.C.","Harris, P.P.","Jiao, S.","Livina, V.N.","Payne, A.J.","Rutt, I.C.","Shepherd, J.G.","Valdes, P.J.","Williams, G.","Williamson, M.S.","Yool, A."],"enrichments":{"references":[],"documentType":{"type":0.8888888889}},"contributors":[],"datePublished":"2007-11","abstract":"We have used the Grid ENabled Integrated Earth system modelling (GENIE) framework to undertake a systematic search for bi-stability of the ocean thermohaline circulation (THC) for different surface grids and resolutions of 3-D ocean (GOLDSTEIN) under a 3-D dynamical atmosphere model (IGCM). A total of 407,000 years were simulated over a three month period using Grid computing. We find bi-stability of the THC\\ud\ndespite significant, quasi-periodic variability in its strength driven by variability in the dynamical atmosphere. The position and width of the hysteresis loop depends on the\\ud\nchoice of surface grid (longitude-latitude or equal area),\\ud\nbut is less sensitive to changes in ocean resolution. For the same ocean resolution, the region of bi-stability is broader with the IGCM than with a simple energy-moisture balance atmosphere model (EMBM). Feedbacks involving both\\ud\nocean and atmospheric dynamics are found to promote THC bi-stability. THC switch-off leads to increased import of freshwater at the southern boundary of the Atlantic associated with meridional overturning circulation. This is\\ud\ncounteracted by decreased freshwater import associated with gyre and diffusive transports. However, these are localised such that the density gradient between North and South is reduced tending to maintain the THC off state.  THC switch-off can also generate net atmospheric freshwater input to the Atlantic that tends to maintain the off state. The ocean feedbacks are present in all resolutions, across most of the bi-stable region, whereas the atmosphere feedback is strongest in the longitude\u2013latitude grid and around the transition where the THC off state is disappearing.\\ud\n\\ud\nHere the net oceanic freshwater import due to the overturning mode weakens, promoting THC switch-on, but the atmosphere counteracts this by increasing net freshwater input. This increases the extent of THC bi-stability in this version of the model","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/63888.pdf","fullTextIdentifier":"http:\/\/nora.nerc.ac.uk\/1376\/3\/LentonetalPostPrintCDynamics.pdf","pdfHashValue":"4498af723faa1ef3526823fee43d217b7135ef57","publisher":"Springer","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:nora.nerc.ac.uk:1376<\/identifier><datestamp>\n      2017-01-25T11:10:01Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D533230<\/setSpec><setSpec>\n      7375626A656374733D533233<\/setSpec><setSpec>\n      7375626A656374733D5338<\/setSpec><setSpec>\n      7375626A656374733D533130<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/nora.nerc.ac.uk\/id\/eprint\/1376\/<\/dc:relation><dc:title>\n        Effects of atmospheric dynamics and ocean resolution on bi-stability of the thermohaline circulation examined using the Grid ENabled Integrated Earth system modelling (GENIE) framework<\/dc:title><dc:creator>\n        Lenton, T.M.<\/dc:creator><dc:creator>\n        Marsh, R.<\/dc:creator><dc:creator>\n        Price, A.R.<\/dc:creator><dc:creator>\n        Lunt, D J.<\/dc:creator><dc:creator>\n        Aksenov, Y.<\/dc:creator><dc:creator>\n        Annan, J.D.<\/dc:creator><dc:creator>\n        Cooper-Chadwick, T.<\/dc:creator><dc:creator>\n        Cox, S.J.<\/dc:creator><dc:creator>\n        Edwards, N.R.<\/dc:creator><dc:creator>\n        Goswami, S.<\/dc:creator><dc:creator>\n        Hargreaves, J.C.<\/dc:creator><dc:creator>\n        Harris, P.P.<\/dc:creator><dc:creator>\n        Jiao, S.<\/dc:creator><dc:creator>\n        Livina, V.N.<\/dc:creator><dc:creator>\n        Payne, A.J.<\/dc:creator><dc:creator>\n        Rutt, I.C.<\/dc:creator><dc:creator>\n        Shepherd, J.G.<\/dc:creator><dc:creator>\n        Valdes, P.J.<\/dc:creator><dc:creator>\n        Williams, G.<\/dc:creator><dc:creator>\n        Williamson, M.S.<\/dc:creator><dc:creator>\n        Yool, A.<\/dc:creator><dc:subject>\n        Marine Sciences<\/dc:subject><dc:subject>\n        Meteorology and Climatology<\/dc:subject><dc:subject>\n        Computer Science<\/dc:subject><dc:subject>\n        Earth Sciences<\/dc:subject><dc:description>\n        We have used the Grid ENabled Integrated Earth system modelling (GENIE) framework to undertake a systematic search for bi-stability of the ocean thermohaline circulation (THC) for different surface grids and resolutions of 3-D ocean (GOLDSTEIN) under a 3-D dynamical atmosphere model (IGCM). A total of 407,000 years were simulated over a three month period using Grid computing. We find bi-stability of the THC\\ud\ndespite significant, quasi-periodic variability in its strength driven by variability in the dynamical atmosphere. The position and width of the hysteresis loop depends on the\\ud\nchoice of surface grid (longitude-latitude or equal area),\\ud\nbut is less sensitive to changes in ocean resolution. For the same ocean resolution, the region of bi-stability is broader with the IGCM than with a simple energy-moisture balance atmosphere model (EMBM). Feedbacks involving both\\ud\nocean and atmospheric dynamics are found to promote THC bi-stability. THC switch-off leads to increased import of freshwater at the southern boundary of the Atlantic associated with meridional overturning circulation. This is\\ud\ncounteracted by decreased freshwater import associated with gyre and diffusive transports. However, these are localised such that the density gradient between North and South is reduced tending to maintain the THC off state.  THC switch-off can also generate net atmospheric freshwater input to the Atlantic that tends to maintain the off state. The ocean feedbacks are present in all resolutions, across most of the bi-stable region, whereas the atmosphere feedback is strongest in the longitude\u2013latitude grid and around the transition where the THC off state is disappearing.\\ud\n\\ud\nHere the net oceanic freshwater import due to the overturning mode weakens, promoting THC switch-on, but the atmosphere counteracts this by increasing net freshwater input. This increases the extent of THC bi-stability in this version of the model.<\/dc:description><dc:publisher>\n        Springer<\/dc:publisher><dc:date>\n        2007-11<\/dc:date><dc:type>\n        Publication - Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/nora.nerc.ac.uk\/id\/eprint\/1376\/3\/LentonetalPostPrintCDynamics.pdf<\/dc:identifier><dc:identifier>\n         \n\n  Lenton, T.M.; Marsh, R.; Price, A.R.; Lunt, D J.; Aksenov, Y.; Annan, J.D.; Cooper-Chadwick, T.; Cox, S.J.; Edwards, N.R.; Goswami, S.; Hargreaves, J.C.; Harris, P.P.; Jiao, S.; Livina, V.N.; Payne, A.J.; Rutt, I.C.; Shepherd, J.G.; Valdes, P.J.; Williams, G.; Williamson, M.S.; Yool, A..  2007  Effects of atmospheric dynamics and ocean resolution on bi-stability of the thermohaline circulation examined using the Grid ENabled Integrated Earth system modelling (GENIE) framework.   Climate Dynamics, 29 (6). 591-613.  https:\/\/doi.org\/10.1007\/s00382-007-0254-9 <https:\/\/doi.org\/10.1007\/s00382-007-0254-9>     \n <\/dc:identifier><dc:relation>\n        http:\/\/dx.doi.org\/10.1007\/s00382-007-0254-9<\/dc:relation><dc:relation>\n        doi:10.1007\/s00382-007-0254-9<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/nora.nerc.ac.uk\/id\/eprint\/1376\/","http:\/\/dx.doi.org\/10.1007\/s00382-007-0254-9","doi:10.1007\/s00382-007-0254-9"],"year":2007,"topics":["Marine Sciences","Meteorology and Climatology","Computer Science","Earth Sciences"],"subject":["Publication - Article","PeerReviewed"],"fullText":" \n \n \nArticle (refereed) \n \n \n \nLenton, T. M.; Marsh, R.; Price, A. R.; Lunt, D. J.; Aksenov, Y.; Annan, \nJ. D.; Cooper-Chadwick, T.; Cox, S. J.; Edwards, N. R.; Goswami, S.; \nHargreaves, J. C.; Harris, P. P.; Jiao, S.; Livina, V. N.; Payne, A. J.; \nRutt, I. C.; Shepherd, J. G.; Valdes, P. J.; Williams, G.; Williamson, M. \nS.; Yool, A.. 2007 Effects of atmospheric dynamics and ocean \nresolution on bi-stability of the thermohaline circulation examined \nusing the Grid ENabled Integrated Earth system modelling (GENIE) \nframework. Climate Dynamics, 29 (6). 591-613. \ndoi:10.1007\/s00382-007-0254-9 \n \n \n \nCopyright \u00a9 Springer \nThis version available at http:\/\/nora.nerc.ac.uk\/1376\/  \n \n \nNERC has developed NORA to enable users to access research outputs \nwholly or partially funded by NERC. Copyright and other rights for material \non this site are retained by the authors and\/or other rights owners. Users \nshould read the terms and conditions of use of this material at \nhttp:\/\/nora.nerc.ac.uk\/policies.html#access  \n \n \nThis document is the author\u2019s final manuscript version of the \njournal article, incorporating any revisions agreed during the peer \nreview process. Some differences between this and the publisher\u2019s \nversion remain. You are advised to consult the publisher\u2019s version \nif you wish to cite from this article. \n \nwww.springer.com \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \n \nContact CEH NORA team at  \nnora@ceh.ac.uk \nEffects of atmospheric dynamics and ocean\nresolution on bi-stability of the thermohaline\ncirculation examined using the Grid ENabled\nIntegrated Earth system modelling (GENIE)\nframework\nT. M. Lenton\u2217 R. Marsh\u2020 A. R. Price\u2021 D. J. Lunt\u00a7\nY. Aksenov\u2020 J. D. Annan\u00b6 T. Cooper-Chadwick\u2021\nS. J. Cox\u2021 N. R. Edwards\u2016 S. Goswami\u2217\nJ. C. Hargreaves\u00b6 P. P. Harris\u2217\u2217 Z. Jiao\u2021 V. N. Livina\u2217\nA. J. Payne\u00a7 I. C. Rutt\u00a7 J. G. Shepherd\u2020 P. J. Valdes\u00a7\nG. Williams\u00a7 M. S. Williamson\u2020\u2020 A. Yool\u2020\nJanuary 31, 2007\nAbstract\nWe have used the Grid ENabled Integrated Earth system modelling\n(GENIE) framework to undertake a systematic search for bi-stability\nof the ocean thermohaline circulation (THC) for different surface grids\nand resolutions of 3-D ocean (GOLDSTEIN) under a 3-D dynamical at-\nmosphere model (IGCM). A total of 407,000 years were simulated over\na three month period using Grid computing. We find bi-stability of the\nTHC despite significant, quasi-periodic variability in its strength driven\nby variability in the dynamical atmosphere. The position and width of the\nhysteresis loop depends on the choice of surface grid (longitude-latitude\nor equal area), but is less sensitive to changes in ocean resolution. For the\nsame ocean resolution, the region of bi-stability is broader with the IGCM\nthan with a simple energy-moisture balance atmosphere model (EMBM).\n\u2217School of Environmental Sciences, University of East Anglia, Norwich, UK and Tyndall\nCentre, UK. E-mail: t.lenton@uea.ac.uk Tel: +44-1603-591414 Fax: +44-1603-591327\n\u2020National Oceanography Centre, University of Southampton, Southampton, UK and Tyn-\ndall Centre, UK\n\u2021Southampton e-Science Centre, University of Southampton, Southampton, UK\n\u00a7School of Geographical Sciences, University of Bristol, Bristol, UK\n\u00b6Frontier Research Centre for Global Change, Yokohama, Japan\n\u2016Centre for Earth, Planetary, Space and Astronomical Research (CEPSAR), Earth Sci-\nences, Open University, Milton Keynes, UK\n\u2217\u2217Centre for Ecology and Hydrology, Wallingford, UK\n\u2020\u2020Tyndall Centre, UK and School of Physics and Astronomy, University of Leeds, Leeds,\nUK\n1\nFeedbacks involving both ocean and atmospheric dynamics are found\nto promote THC bi-stability. THC switch-off leads to increased export of\nsalt at the S. boundary of the Atlantic that tends to maintain the off state.\nIt can also generate net atmospheric freshwater input to the Atlantic that\ntends to maintain the off state. The ocean feedback is present in all\nresolutions, across most of the bi-stable region, whereas the atmosphere\nfeedback is strongest in the longitude-latitude grid and around the tran-\nsition where the THC off state is disappearing. Here the ocean response\nreverses, promoting THC switch-on by reducing Atlantic salt export, but\nthe atmosphere counteracts this by increasing net freshwater input. This\nmaintains some bi-stability even when the THC does switch on.\n1 Introduction\nThere currently exist a spectrum of Earth system models (ESMs) and climate\nmodels (Figure 1) from the simplest box models to fully coupled atmosphere-\nocean-land general circulation models (AOL-GCMs). State-of-the-art models\nsuch as the Hadley Centre model, are computationally too demanding for long-\nterm integrations and ensembles are restricted in size, e.g. (Murphy et al., 2004).\nConversely, many existing efficient models of the coupled system, often termed\nEarth system models of intermediate complexity (EMICs) (Claussen et al.,\n2002), e.g. CLIMBER-2 (Petoukhov et al., 2000), employ highly idealized mod-\nels of the individual components, with simplified physics, reduced dimensionality\nand low spatial resolution. Examples are the 2.5-D ocean model of Wright and\nStocker (1991), the Statistical Dynamical Atmosphere model of Petoukhov et al.\n(2000), or the 2-D energy-moisture balance atmosphere model of Fanning and\nWeaver (1996). Alternatively, the Planet Simulator (Fraedrich et al., 2005a) uses\na fully dynamical 3-D atmosphere based on PUMA (Fraedrich et al., 2005b) but\nonly a 2-D mixed layer ocean. An exception is the fully 3-D ocean-atmosphere\nEMIC EcBilt\/CLIO (Opsteegh et al., 1998, Goosse and Fichefet, 1999) and its\nfurther development LOVECLIM (Roche et al., 2006), which achieve computa-\ntional efficiency by using only 3 layers in the atmosphere.\nIn developing the Grid-ENabled Integrated Earth system modelling (GE-\nNIE) framework our aim is to populate the region of \u2018model space\u2019 between\nexisting intermediate and full complexity models (Figure 1). Rather than de-\nvelop a single model we are building a modular framework that allows different\ncomplexities of Earth system model to be created, by selecting different options\nfor the various components (see Supplementary Information). The behavior\none is trying to understand or predict, and its timescale, determine the compo-\nnents that need to be included. Our scientific drivers are to better understand\nchanges in climate and the carbon cycle, on 103 \u2212 106 yr timescales, including\nthe recent glacial-interglacial cycles (especially the last deglaciation), and in re-\nsponse to human activities. Our working hypothesis is that a realistic modelling\nframework for this purpose must include, as a minimum, component models of\nthe atmosphere, ocean, sea-ice, marine biogeochemistry, marine sediments, land\nsurface, vegetation and soil, and ice sheets (Figure 2). The framework must\nhandle the exchange of energy, water, carbon and other biogeochemical trac-\ners between components, ensuring rigorous conservation. Earth system models\ncreated from the framework must be fast enough to be integrated over multi-\nmillennial time-scales, and to undertake large ensembles for sensitivity studies\n2\nand systematic model tuning. The design of the framework should allow other\ncomponents, such as atmospheric chemistry, to be added at a later stage. It\nshould also allow the continents to be reconfigured (i.e. change in the land sur-\nface mask, bathymetry and orography) in order to study events of interest in\nEarth history.\nComputer power continues to increase exponentially, as described by Moore\u2019s\nLaw; the number of transistors on an integrated circuit doubles approximately\nevery 2 years. CPU speed, network bandwidth and physical storage have also all\nwitnessed an exponential increase in capacity. Despite this, some compromise\nin model complexity is required to achieve our scientific goals now and in the\nnext 5\u201310 years. Hence we have sought to enable traceability, meaning the abil-\nity to relate the simplified process representations and\/or reduced resolutions\nused in our long-term and ensemble studies to more complete representations\nand higher resolutions used in state-of-the-art models. Support for modularity\n(i.e. interchangeable components) and scalability (i.e. variable resolution of the\ncomponents) in the GENIE framework should help achieve this. It also allows\nus to couple in more complex and\/or higher resolution component models in\nfuture as computer power increases.\nIn order to maximize access to available computer power we are developing\nsoftware to run Earth system models on a \u201cGrid\u201d of distributed, non-specialist\ncomputing resources. \u201cGrid computing\u201d (Foster et al., 2001) refers to systems\nthat bring together people, resources (compute, data, network, sensors, devices,\netc.) and services from across multiple administrative domains for a common\npurpose. The internet provides the infrastructure for such large scale computing\nacross distributed domains. Grid technology supports the creation of dynamic\n\u201cvirtual organizations\u201d to enable groups of individuals to collaborate. The work\ndescribed herein brings together such a distributed group of Earth system mod-\nellers and computational scientists with the common purpose of building new\nmodels, executing them on distributed computing resources and sharing and\nrecycling the data that they generate. Grid technology is used to ease the\nconstruction of new instances of Earth system model, automate the process of\nmodel tuning, enable large ensembles to be run, speed up the execution of long\nintegrations, and recycle data back into model development. To make this a\nreality, it is particularly important to ensure that the Grid is useable directly\nfrom the Earth system modellers\u2019 working environment.\nHere to demonstrate our modular framework and the use of Grid computing\nwe undertake a new experiment to explore the stability of the ocean thermoha-\nline circulation (THC) in different resolutions of a fully 3-D ESM. Changes in\nthe THC are thought to have played a key role in past rapid climate changes,\nand the potential for shutdown of the THC is a key uncertainty in future climate\nprojections. Theory and early models (Stommel, 1961) suggest that the THC\nexhibits bi-stability. Furthermore, all models systematically inter-compared by\nRahmstorf et al. (2005) show bi-stability. However, the models differ in the\nposition of the present climate state with respect to the region of bi-stability.\nUnder sufficient freshwater forcing of the North Atlantic, the THC will collapse\nin all models, but in those starting in the bi-stable regime the collapse will\nbe irreversible, whereas in those starting in the mono-stable regime the THC\nshould recover. In the case of reversible THC collapse there may still be some\nhysteresis i.e. the recovery may be delayed. The failure (thus far) to find irre-\nversible THC collapse in some AOGCMs suggests their initial climate state is in\n3\na mono-stable THC regime, for example, HadCM3 bounces back from a THC\ncollapse induced by freshwater hosing (Thorpe et al., 2001) as does the AOGCM\nof Yin et al. (2006). In the GFDL model, the persistent collapse of the THC\nunder a halving of pre-industrial CO2 suggests that this change in boundary\ncondition shifts the model into a region of bi-stability (Stouffer and Manabe,\n2003). In contrast, under doubling CO2 there is a reversible weakening, and\nunder quadrupling CO2 there is a collapse and later recovery indicating some\nhysteresis but not bi-stability and suggesting that these warmer model climates\nhave a mono-stable THC.\nBi-stability of the THC can occur because a positive salt-advection feed-\nback within the Atlantic acts to stabilize both the \u2018on\u2019 and \u2018off\u2019 states (Stom-\nmel, 1961). In more complex models it has been suggested that a larger scale\nsalinity-overturning feedback, which can be positive or negative, is also critical\nin determining the stability regime (de Vries and Weber, 2005). Whether the\nAtlantic meridional overturning circulation (MOC) imports or exports salt at its\nSouthern boundary is thought to determine the stability regime, the argument\nbeing that salt import (freshwater export) is required for bi-stability to occur\n(de Vries and Weber, 2005). Feedbacks from the atmosphere may also influence\nthe stability regime of the THC, although de Vries and Weber (2005) find these\nto be of secondary importance in their model (EcBilt\/CLIO). An atmospheric\nfeedback involving net evaporation from the North Atlantic, in a pattern simi-\nlar to that observed in El Nino events (Schmittner et al., 2000), stabilizes the\npresent \u2018on\u2019 state of the THC in some models (Latif et al., 2000, Schmittner\net al., 2000). This does not deny bi-stability, indeed it may enhance it if there\nare also atmosphere feedbacks stabilizing the \u2018off\u2019 state of the THC.\nIt has been argued that increased variability in the THC induced by coupling\nto a fully dynamical atmosphere model would be expected to blur the boundaries\nof any bi-stable regime, and could potentially remove it (Schlesinger et al., 2006).\nThus far, studies using full primitive equation atmosphere models coupled to 3-D\nocean models, have been restricted in their searching of model parameter space.\nHere we undertake a systematic search for THC bi-stability in a fully 3D ocean\u2013\natmosphere\u2013sea-ice model. We employ the methodology of Marsh et al. (2004),\nfollowing Wang and Birchfield (1992), of running the model to equilibrium under\ndifferent atmospheric freshwater transport boundary conditions. To understand\nwhat determines the stability regime of the THC, we undertake an analysis of\nthe freshwater budget of the Atlantic, distinguishing the atmosphere and ocean\ncomponents, as suggested by de Vries and Weber (2005).\nThe paper is laid out as follows. In section 2 we provide a description of the\nmodel. Section 3 introduces the novel software and techniques which made the\nexperiment possible. In section 4 we outline the experimental design. Section\n5 reports the results with an emphasis on the mechanisms for THC bi-stability\nin different versions of our model. In section 6 we discuss these results in the\ncontext of previous model studies.\n2 Model description\nHere we briefly introduce the component models and the different ocean grids\nand resolutions (Table 1) used in the experiments described below. In the\nSupplementary Information, for each of the major components of the Earth\n4\nsystem (Figure 2) we discuss the appropriate modelling approaches for our goals\nand introduce all the corresponding model(s) that have been included thus far\nwithin the GENIE framework.\n2.1 IGCM atmosphere\nThe Reading Intermediate General Circulation Model (IGCM3.1) has as its adi-\nabatic core the 3-D spectral primitive equation model of Hoskins and Simmons\n(1975), with a default horizontal resolution of T21. In order to speed up the\nmodel for use in multi-millennial timescale integrations, the vertical resolution\nhas been reduced from 22 levels to 7. Physical parameterizations include sim-\nplified versions of the turbulent flux scheme of Louis (1986), the convective\nadjustment scheme of Betts (1986), and the cloud scheme of Slingo (1987). The\nradiation scheme (which by default has no diurnal cycle) is based on a lookup\ntable of transmittances in the longwave, and the two-band scheme of Morcrette\n(1990) in the shortwave. An earlier version of this model is described in some\ndetail by de Forster et al. (2000); since their work, the surface scheme has been\nimproved so that different vegetation types are associated with different rough-\nness lengths and snow-covered and snow-free albedos, based on the lookup table\nused in the HadAM3 model (Pope et al., 2000). The hydrological budget has\nbeen closed, and some restructuring of the original code has been carried out to\nincrease modularity, including the integration of NetCDF input and output.\n2.2 GOLDSTEIN ocean\nThe Global Ocean Linear Drag Salt & Temperature Equation Integrator (GOLD-\nSTEIN) is a fast, intermediate complexity, 3-D frictional geostrophic model\nwith linear drag. It incorporates eddy-induced and isopycnal mixing following\nGriffies (1998) and solves correctly for the flow around islands (Edwards and\nMarsh, 2005). The linear momentum balance of GOLDSTEIN allows for a lo-\ncal inversion of the baroclinic velocity field. At baseline resolution the model\nexplicit timestep is around 3.5 days. Here we use two different grid types and\nthree resolutions of GOLDSTEIN (Table 1): (1) The initial \u201cbaseline\u201d (stan-\ndard) resolution (36x36x8), on a longitude versus sin(latitude) horizontal grid,\nwith quasi-logarithmic depth intervals (Edwards and Marsh, 2005). (2) A higher\nresolution (72x72x16) version, on the same longitude versus sin(latitude) hor-\nizontal grid. (3) An IGCM grid-matched (64x32x8) version, on a longitude\nversus latitude horizontal grid, which biases resolution towards the poles. Fig-\nure 3 shows the two grids and their realistic ocean bottom topography. In case\n(2), the higher horizontal and vertical resolution is implemented within the same\nsurface grid and topography as case (1).\n2.3 Slab sea ice\nA very simple slab sea ice model has been separated from the IGCM. This is\nequivalent to a slab ocean component (see Supplementary Information), but\nwith a slab thickness of 2m, and changes to the heat-capacity and albedo. In\naddition, there is the option to limit the implied ocean heat-flux term. For paleo\nsimulations, tuning has indicated that in order to get a reasonable (defined here\nas being similar to that predicted by the HadSM3 model) simulation of modern,\n5\npre-industrial, and LGM sea-ice area, it is necessary to limit the implied ocean\nheat flux for sea-ice to have an absolute value less than 50Wm\u22122.\n2.4 IGCM-land\nThe IGCM-land module was originally an integral part of the IGCM, as de-\nscribed in de Forster et al. (2000). In brief, it parameterises the surface energy,\nmoisture, and momentum fluxes as a function of, respectively, temperature,\nmoisture, and velocity vertical gradient. It also uses a bucket representation of\nsoil-moisture, and parameterises changes in albedo related to snow cover. Some\nminor changes to the original scheme have been made so that it rigorously con-\nserves energy and water.\n2.5 Coupling\nWe couple the components described above in a modular fashion using the\nGENIE framework (for more details see Supplementary Information). Different\nresolutions of a particular model component are treated as different instances of\nthat component. Hence the different ocean grids and resolutions can be readily\ninterchanged at compilation time. To interpolate between different atmosphere\nand surface grids, we use a simple bilinear interpolation routine. In regions\nwhere there is a mismatch in land-sea mask, we extrapolate from the nearest\nneighbor. This process is in general non-conservative, so after interpolation we\napply a correction factor in the tropics (30\u25e6S to 30\u25e6N) to ensure conservation\nof energy and moisture.\n2.6 GENIE-2\nBy coupling the IGCM and GOLDSTEIN we have created the dynamical core\nof a fully 3-D Earth System Model (ESM). We use \u201cGENIE-2\u201d to describe the\nfamily of ESMs that use the IGCM dynamical atmosphere, because the choice of\natmosphere model is the main determinant of overall model speed. The IGCM\nat T21 resolution integrates circa 10 years per CPU hour on an AMD 64 bit\nprocessor. In contrast the GENIE-1 model (Lenton et al., 2006), which uses\na single-layer Energy-Moisture Balance Model (EMBM) for the atmosphere,\nachieves over 1000 years per CPU hour at baseline resolution. Below we under-\ntake a first large ensemble experiment using different grids and resolutions of\nGENIE-2, and contrast their behaviour with that of GENIE-1.\n2.7 Parameter settings\nOur versions of the fully coupled GENIE-2 have yet to be tuned. However, the\nIGCM with fixed ocean, fixed sea-ice, and IGCM-land has been tuned using\na genetic algorithm (Price et al., 2006) and we take 28 IGCM and IGCM-\nland parameter settings, ocean albedo and sea-ice albedo from that exercise\n(Table 2). We use default, untuned settings for the other IGCM, GOLDSTEIN\nand sea-ice parameters. The key GOLDSTEIN default parameters are shown\nin Table 2. Values for both isopycnal and diapycnal diffusivity and friction are\nrelatively low compared to previous tunings of C-GOLDSTEIN (the version of\nGENIE-1 comprising GOLDSTEIN coupled to the EMBM and free-drift sea-ice)\n6\n(Hargreaves et al., 2004, Edwards and Marsh, 2005). Winds from the IGCM are\nscaled by a factor of 2 (as with prescribed winds from the EMBM) to counteract\nthe excessive surface drag in the frictional geostrophic ocean model.\n3 Grid-enabled Problem Solving Environment\nThe collaborative Grid-enabled Problem Solving Environment we use for com-\nposing our model studies, accessing distributed computing resources, archiving,\nsharing and visualizing the results is built upon products of the first phase of\nthe UK e-Science core programme (Hey and Trefethen, 2002), in particular the\nGeodise project (http:\/\/www.geodise.org). Their primary focus has been to\nprovide solutions for design search and optimisation in the domain of aerospace\nengineering, resulting in a set of generic toolboxes for the Matlab and Jython\nenvironments (Eres et al., 2005), a number of which we use.\n3.1 Compute Toolbox\nThe Geodise Compute Toolbox provides intuitive high-level functions in the\nstyle of the hosting environment to allow users to easily manage the execution of\na compute job on Grid resource. Functions are provided for three key activities:\nAuthentication In the UK e-Science community users are issued with a\nX.509 certificate by a trusted Certificate Authority. The toolbox enables the\nuser with such a certificate to create a further time limited proxy certificate\nwhich effectively provides a single sign-on to the UK Grid. All subsequent\nactivity on Grid resource (specifically resource implementing the Grid Security\nInfrastructure GSI (Welch et al., 2003)) is authorised based upon the local rights\nof the account belonging to the certificate owner. Functionality is provided to\ninstantiate, query and destroy proxy certificates.\nFile transfer The GridFTP (Allcock et al., 2002) data movement service of\nthe Globus Toolkit (2.4) (Foster and Kesselman, 1999) is exposed to the Matlab\nclient through a set of functions that wrap the Java Commodity Grid (CoG)\nkit (von Laszewski et al., 2001). Methods for transferring files to and from a\nGridFTP enabled resource are provided.\nJob submission The user is enabled to execute work on resource managed by\neither the Globus Toolkit (implementing the Grid Resource Allocation and Man-\nagement service (GRAM) (Czajkowski et al., 1998)) or Condor (Thain et al.,\n2005). By providing information describing the compute task (executable, in-\nput files, environment variables) the interface allows submission of jobs to the\nresource broker of the remote resource. Functions are provided to monitor the\nstatus of the job handles returned after submission and to kill those jobs if\nnecessary.\n3.2 Database Toolbox\nThe Geodise data management model allows local data (files, scripts, binaries,\nworkspace variables, logical data aggregations) to be archived in a shared central\n7\nrepository and for rich descriptive metadata to be associated with that data.\nThe data can be archived to, queried in, and retrieved from the repository.\nThe interface to the database is exposed using Web Services allowing users\naccess to the same repository from distributed locations using standard web\nprotocols. Files are stored on a GridFTP server hosted by the UK National\nGrid Service (http:\/\/www.ngs.ac.uk\/). The Geodise Database Server has\nbeen augmented by mapping an XML Schema into the database to restrict\nthe permissible metadata describing entities in the database. This significantly\nimproves query and retrieval performance in the underlying database. Both\nprogrammatic and GUI interfaces are provided to the data repository allowing\neasy navigation of the data and enabling the database to be an integral part of\nscripted workflows.\n3.3 OptionsMatlab\nThe GENIE client for Matlab also includes an interface to a third party design\nsearch and optimisation package, OPTIONS (Keane, 2003), that has been devel-\noped in the Computational Engineering and Design Centre at the University of\nSouthampton. This software provides a suite of sophisticated multidimensional\noptimisation algorithms developed primarily for engineering design optimisa-\ntion. The package has been made available to Matlab via the OptionsMatlab\ninterface and has been exploited in conjunction with the Geodise Toolboxes to\ntune the IGCM model parameters (Table 2) (Price et al., 2006).\n3.4 GENIE Toolbox\nA higher level abstraction of the Geodise functionality has been developed to\nprovide intuitive management of time-stepping codes on the Grid. Scripted\nworkflows wrapping the Geodise functions have been written to provide a uni-\nform interface for the execution of GENIE Earth system models on local, Globus\nand Condor resource. The configuration and execution of a simulation is enabled\nthrough a single function call which accepts as input data structures describ-\ning the model instance (parameter settings, input files, etc.), the local runtime\nenvironment and the remote resource on which to execute the model. Further\nfunctionality is provided to coordinate the execution of ensemble studies medi-\nated by the database. The toolbox methods enable users to expose models as\ntuneable functions or include the database as an integral part of a large ensemble\nstudy.\nEnsemble studies are defined by creating a data structure within the data-\nbase. This consists of a parent entity describing the experiment and contains\na set of sub-entities describing the individual simulations comprising the en-\nsemble. A simple template script is provided to aid the user in specifying the\nlogical entities in the database. The subsequent execution of the ensemble is\nperformed by autonomous client \u201cworker\u201d scripts that interrogate the database\nfor work units, submit that work to available resource and post-process com-\npleted tasks. Similar systems such as Nimrod\/G (Abramson et al., 2002) and\nGridSolve (YarKhan et al., 2006) provide bespoke definition languages for task\nfarming studies but rely on a central agent to manage the execution of the study.\nOur system devolves responsibility for task farming to the client where informed\ndecisions can be made based upon point-in-time queries on the contents of the\n8\ndatabase. This enables more flexible integration of heterogeneous resource but\nmeans that no central control can be imposed on the study. A guarantee of\nthe completion time for an ensemble study cannot be made but resource can be\ndynamically introduced or retracted by users contributing to the experiment.\n3.5 Fault tolerance\nSimulations are mediated through the database and are only progressed through\nthe successful upload of completed work units into the repository. If the config-\nuration, submission, execution, post-processing or data upload fail for a work\nunit then the client system will detect a problem and attempt corrective action.\nThis may include a repeated attempt to perform the failed stage of progres-\nsion, removal of the job from the database allowing the entire work unit to be\nattempted again or marking the simulation as failed (in cases where repeated\nfailures have been detected). The means to tag a simulation as \u2018failed\u2019 is pro-\nvided because studies may span areas of parameter space where models become\nnumerically unstable. This fault tolerance also holds for client-side problems or\nnetwork outages. If completed work units are not successfully uploaded to the\ndatabase the study is unchanged and the work can be attempted again.\n3.6 Brokering strategy\nIn the absence of a brokering service on the UK National Grid our data manage-\nment system provides a means to maximize our responsible use of the available\nresource. A user provides metadata about the resources they want to use in-\ncluding the maximum number of jobs that they would like to submit to the\njob manager (PBS, SGE, condor) for any experiment. The database maintains\na record of where a users jobs are active and the client will respect the usage\nlimits and refrain from submitting work to a resource if it has already reached\nits maximum number of allowed jobs. A user can then set up client invocations\nto automatically attempt to push work to a list of resources. Once each resource\nreaches its limit the client will move on to the next and the system therefore\nkeeps all available compute power busy (assuming sufficient work exists) without\nexceeding the users specified usage limits.\n4 Experiment design\nFor the baseline resolution (36x36x8) we find that the resulting model climate\nspins up to a stable state. However, the ocean thermohaline circulation is re-\nversed with sinking in the North Pacific and upwelling in the North Atlantic.\nThis occurs largely because of insufficient transport of freshwater from the At-\nlantic to the Pacific by the atmosphere model. We diagnose the differences be-\ntween IGCM freshwater transports and NCEP reanalysis data, and group them\ninto three latitudinal sectors that correspond to the nearest on the IGCM grid\nto those used by Marsh et al. (2004): 0.41 Sv (28.125\u201390\u25e6N), 0.30 Sv (28.125\u25e6N\u2013\n28.125\u25e6S), 0.08 Sv (28.125\u201350.625\u25e6S). We then apply flux corrections of these\nsizes in the three sectors, removing freshwater from the Atlantic and adding it to\nthe Pacific in each case. The flux corrected model spins up to a qualitatively cor-\nrect thermohaline circulation with sinking in the North Atlantic and upwelling\n9\nin the Pacific. We refer to this from hereon as the default flux correction.\nWhilst the use of an untuned model with the need for this type of flux cor-\nrection would be undesirable for predictive studies, we can make positive use of\nit for the idealized experiments conducted here. Following Marsh et al. (2004),\nwe undertook 1-parameter experiments varying the imposed Atlantic to Pacific\nfreshwater flux transported by the atmosphere. In a separate 2-parameter exper-\niment, we identified and also varied an IGCM parameter somewhat analogous\nto atmospheric moisture diffusivity in the EMBM, which primarily determines\nequator to pole moisture transport. In order to search for bi-stability of the THC\nwe used restarts from chosen end-members of the initial ensembles, and to keep\nthis computationally tractable we concentrated on restarts of the 1-parameter\nexperiments.\nThe same default Atlantic-Pacific freshwater transport was applied in all 3\nmodel resolutions, and in all the experiments it was varied by simply multiplying\nall three components of it by the same scaling factor. In initial 1-parameter\nensembles for each of the 3 model resolutions, the scaling factor was varied\nbetween 0 (no flux correction) and 2 (twice default) in 21 steps. In all three\nresolutions, the switch between THC on and reversed states was found to occur\nin the range 0-1 for the scaling factor. This helped us determine 6 ensembles\nof restart experiments. For each of the 3 resolutions we ran ensembles from 2\ndifferent restart states \u2013 the end of the zero and default flux correction runs of\nthe original ensemble. In the restart experiments, the scaling factor was varied\nbetween 0 and 1 in 21 steps, in order to better resolve switches between THC\nstates. To examine the effect of compiling for different operating systems, we\nreplicated our restart ensembles for one model resolution (72x72x16) with Linux\nand Win32 binaries.\nFor the 2-parameter experiment we used the baseline ocean resolution and\nchose as a second parameter ia enhancestable, which is a constant multiplier\nat the front of the evaporation (hence latent heat) and sensible heat terms\nin the IGCM. Increasing it is expected to increase freshwater sources to the\natmosphere, which are greatest from the equatorial oceans. The Atlantic-Pacific\nfreshwater flux correction was varied in 11-steps from 0 to 2 times default, and\nia enhancestable was varied in 11-steps on a logarithmic scale from 0.1 to 10\ntimes its default value of 0.3731 (Table 2). This gave a 121 member ensemble,\nwith each run for 2000 years in this case.\nTable 3 summarises the 12 ensemble studies conducted. These were defined\nin the database and executed across the computational Grid by distributed\nmembers of the project team (see Appendix for further details). From the\nresults of our 1-parameter experiments we selected some model versions and\nundertook 0.1 Sv and 1.0 Sv freshwater hosing experiments for 100 yr as in\nStouffer et al. (2006), to compare with their model inter-comparison.\n5 Results\nThe thermohaline circulation (THC) exhibits a fairly high degree of variability\nunder the dynamical atmosphere model, with a range in the maximum Atlantic\nMeridional Overturning Circulation (MOC) of order \u00b15 Sv. This THC vari-\nability is driven by the internal variability of the dynamical atmosphere model.\nThus if atmospherically driven variability and associated feedbacks blur the\n10\nbi-stability of the THC we expect the effect to be fairly strong in our model.\n5.1 Initial spin-ups\nFor the default flux correction, the maximum Atlantic MOC is rather strong in\nall GENIE-2 versions, being \u224842 Sv in 64x32x8, \u224835 Sv in 72x72x16 and \u224832 Sv\nin 36x36x8. In the annual average, the maximum of the Atlantic MOC is located\nat around 50\u25e6N in all resolutions (Figure 4), although in winter (not shown) it\ntends to shift to lower latitudes around 20\u25e6N. Both high and low latitude cells in\nthe North Atlantic are apparent in the annual average, especially for 72x72x16\n(Figure 4e). A strong low latitude cell in winter may be expected due to seasonal\nmeridional shifts and changes in strength of low-latitude winds driving changes\nin surface Ekman transport, compensated by deep \u201csloshing\u201d motions (Jayne\nand Marotzke, 2001). In the annual-average, these motions tend to cancel out,\nso that sinking is largely confined to higher latitudes.\nOur initial 1-parameter experiment spin-ups revealed non-linear transitions\nin the strength of the maximum Atlantic MOC strength as a function of Atlantic-\nPacific freshwater flux correction, for all three ocean resolutions (Figure 5). The\namount of flux correction required to get the Atlantic MOC \u2018on\u2019 is noticeably\nless for the longitude-latitude surface grid 64x32x8 relative to the other two.\nThe transition is in a similar place for the 36x36x8 and 72x72x16 resolutions\nbut sharper for the latter. In all resolutions, removing flux correction gives an\nAtlantic MOC \u2018off\u2019 state and default flux correction gives an Atlantic MOC \u2018on\u2019\nstate, providing start points for our restart experiments.\nIn the 2-parameter study only 88 of 121 of the defined ensemble members\ncompleted successfully. The other 33 members were found to be in unstable\nregions of parameter space and failed quickly (at both high and low values of\nia enhancestable). Maximum Atlantic MOC varies with the 2 parameters (Fig-\nure 6) in a qualitatively similar way to results with GENIE-1 presented in Marsh\net al. (2004). Increasing ia enhancestable in the IGCM destabilises the Atlantic\nMOC, just as increasing atmospheric moisture diffusivity does in the EMBM.We\ninfer that the increased evaporative flux under increased ia enhancestable has a\ndisproportionately larger effect in the tropics promoting an increased equator to\npole atmospheric moisture transport, and thus tending to destabilise the THC.\nWhen ia enhancestable is reduced to 0.15\u20130.2 of its default value, no Atlantic-\nto-Pacific freshwater flux correction is required to get the Atlantic MOC \u2018on\u2019 at\n\u224820 Sv. These results will be examined further in future work. From hereon\nwe focus on the search for bi-stability varying only the Atlantic-to-Pacific fresh-\nwater flux correction.\n5.2 Bi-stability\nFrom the restart experiments, we find bi-stability of the Atlantic MOC in all\n3 resolutions of GENIE-2 (Figure 7). The region of bi-stability is noticeably\nwider for the longitude-latitude grid 64x32x8 and shifted to lower values of flux\ncorrection. The bi-stable region is narrowest for 72x72x16 and the transitions\noccur at the largest values of flux correction. The baseline 36x36x8 model\nhas the least defined transitions and there is some indication of bi-stability\nremaining at the default flux correction (although the Atlantic MOC is \u2018on\u2019\nin both cases). Interestingly, for 64x32x8, the restarts from Atlantic MOC \u2018on\u2019\n11\nproduce a transition in a different place (f = 0.1\u20130.15 of default flux correction)\nto the original spin-up experiments (f = 0.2\u20130.3) (Figure 5). This is not the\ncase in the other two resolutions.\nFor each ocean resolution, we have examined the overturning streamfunction\nat a range of values of default flux correction that give rise to bi-stability of the\nAtlantic MOC (based on Figure 7). Illustrative cases (Figure 8) are f = 0.8 of\nthe default flux correction in resolution 36x36x8, f = 0.85 in 72x72x16, and f =\n0.55 in 64x32x8. These are chosen to be close to the transition from bi-stability\ntoward a mono-stable \u2018on\u2019 state, and the striking reversal of the Atlantic MOC is\naccompanied by a simultaneous reversal of the Pacific MOC (not shown). Thus,\nthe overall THC reverses. At the lower end of the bi-stable region, on the upper\nbranch, the positive cell of the Atlantic MOC often fails to reach the Southern\nOcean and the Pacific MOC tends to have already reversed. This tendency for\nthe Pacific circulation to reverse is partly due to the low (un-tuned) value used\nfor the diapycnal diffusivity (10\u22125 m2s\u22121).\nSurface currents (not shown) vary considerably between the different model\nresolutions and change noticeably when switching between bi-stable states. In-\nertial currents such as the Antarctic Circumpolar Current (ACC) and the Gulf\nStream are expected to be too weak due to missing dynamics in the frictional\ngeostrophic ocean. In these un-tuned model versions, surface currents are notice-\nably stronger in 72x72x16 than in either 64x32x8 or 36x36x8. The main North\nand South Pacific gyres are present in all model resolutions. The Atlantic gyres\nare less clear, but on going to higher resolution (72x72x16), the Gulf Stream be-\ncomes clearer and stronger. When the THC reverses, the Gulf Stream weakens\nand is deflected southwards and the Kuroshio current strengthens and moves\nnorthwards.\nEquivalent states of the 72x72x16 model using the Linux and Win32 binaries\ntypically have small differences in spatial patterns. Restarts from the same\nstate of the 72x72x16 model conducted with Linux and Win32 binaries diverge\nrapidly, indicating a sensitivity to initial conditions, which is to be expected with\na dynamical atmosphere model. However, the average behavior of the THC is\nsimilar \u2013 for example, in restart runs where the flux correction is such that the\nTHC will wind down and then collapse, the timing of changes in the THC is\nthe same in the Win32 and Linux binaries despite their differing inter-annual\nvariability (results not shown).\n5.3 Responsible mechanisms\nTo understand the mechanisms responsible for maintaining bi-stability and to\nelucidate the difference between different model grids and resolutions, we have\nexamined the feedbacks from the ocean and atmosphere under changes in the\nTHC state. Once again, for each resolution, we consider our illustrative exam-\nples of bi-stable states. Then we examine the responses of aggregate variables\nas a function of default flux correction. In the following sections, we use \u201cTHC\u201d\nto refer to the overall circulation and \u201cMOC\u201d to refer specifically to a mode of\ntransport diagnosed in the model.\n12\n5.3.1 Ocean feedback\nFreshwater transport by the Atlantic MOC varies significantly as a function of\nlatitude, and changes significantly when the THC switches state (Figure 9). For\nour illustrative runs, in the \u2018on\u2019 state, in all resolutions the self-sustaining nature\nof the THC can be seen in the N. Atlantic, where it transports freshwater south-\nward. In 36x36x8 and 72x72x16, there is little net import or export of freshwater\nat the Southern boundary of the Atlantic, and when the THC switches off, there\nis a pronounced import of freshwater at the Atlantic S. boundary. By contrast,\nin 64x32x8, in the \u2018on\u2019 state, the MOC is importing freshwater at the Atlantic\nsouthern boundary, and there is little change when the THC switches off. A shift\nto increased import of freshwater should tend to maintain the \u2018off\u2019 state in the\nillustrative 36x36x8 and 72x72x16 runs, but is not apparent in the illustrative\n64x32x8 run.\nExamining the net MOC import or export of freshwater at the Atlantic\nsouthern boundary as a function of default flux correction (Figure 10) indicates\nthat over much of the bi-stable region, in each resolution, changes in MOC\nfreshwater import\/export act to maintain bi-stability. In 36x36x8 for f = 0.6\u2013\n0.9, THC switch-off results in an increase in freshwater import, in 72x72x16 this\noccurs for f = 0.65\u20130.85, and in 64x32x8 for f = 0.15\u20130.5. This can go part\nway toward explaining the bi-stability of each resolution and the wider region of\nbi-stability in the 64x32x8 model (Figure 7). However, it cannot explain what\nis going on in the transition from bi-stability toward a mono-stable \u2018on\u2019 state,\nwhich also differs somewhat between resolutions. In 36x36x8 at e.g. f=0.85,\nalthough the \u2018off\u2019-initialized state has recovered to a strength of circa 17 Sv,\ngreater freshwater import is still acting to maintain bi-stability. At f = 0.95\nand above, this situation is reversed, yet there is still an indication of bi-stability\nin the overturning strength (Figure 7). In 72x72x16 at f = 0.9 and above the\n\u2018off\u2019-initialized state actually exports freshwater whilst the \u2018on\u2019 state imports it\nand yet the \u2018off\u2019-initialized state has a weaker overturning strength. In 64x32x8,\nat f = 0.6 and above, the recovering \u2018off\u2019-initialized state imports less freshwater\nthan the \u2018on\u2019-initialized state but still has a weaker overturning strength.\n5.3.2 Atmosphere feedback\nTo explain what is going on, especially in the transition from bi-stability to\na mono-stable \u2018on\u2019 state, we must also consider atmospheric feedbacks. The\nchange in net freshwater input (precipitation minus evaporation plus runoff) to\nthe Atlantic from the atmosphere when the THC switches off shows a broadly\nsimilar pattern in our illustrative runs for all three resolutions (Figure 11).\nThere is a general wetting up the storm track in the North Atlantic, a drying\nin the tropical North Atlantic, a wetting in the tropical South Atlantic, and\na drying in the Southwest Atlantic. The changes in the tropics are indicative\nof a Southward shift in the Inter-Tropical Convergence Zone (ITCZ), which is\ntypical of THC shut-down experiments in coupled models (Vellinga and Wood,\n2002, Yin et al., 2006). The amplitude of change is more pronounced in the\nhigher resolutions than in 36x36x8.\nConsidering the net freshwater flux to the Atlantic as a function of latitude\n(Figure 12), the changes due to THC switch-off are small compared to the\nabsolute flux in 36x36x8 and 72x72x16, but more pronounced in 64x32x8. A\n13\nwetting of the extra-tropical N. Atlantic is apparent in all resolutions, and a\nSouthward shift of the ITCZ is most apparent in 64x32x8.\nWhen integrating the net freshwater flux over the entire Atlantic basin, the\nillustrative cases all show an increase due to THC switch-off. However, there\nis considerable variation in this quantity across different runs as a function of\nAtlantic-Pacific flux correction (Figure 13). If there is multi-decadal variability\nin the total flux (not examined) then part of this variability may be due to aver-\naging over 10 years. The atmospheric feedback is most pronounced in 64x32x8,\nwith a substantial increase in freshwater input in going from the on-initialized\nto off-initialized states for f = 0.45\u20130.8. This corresponds with the righthand\nsection of the bi-stable region and the transition toward a mono-stable \u2018on\u2019 state\n(Figure 8) where the freshwater input will tend to inhibit recovery of the THC\n\u2018off\u2019 state. In 72x72x16 the atmosphere feedback appears substantial for f =\n0.75\u20130.9, which again corresponds with the righthand section of the bi-stable\nregion and the transition toward a mono-stable \u2018on\u2019 state, although similar vari-\nability at f = 0.4 is well within the bi-stable off regime. In 36x36x8 it is hard\nto establish any qualitative relationship.\n5.4 Freshwater hosing experiments\nThe maximum Atlantic MOC has been estimated at 18 Sv (Talley et al., 2003),\nin reasonable agreement with estimates of North Atlantic Deep Water (NADW)\nformation of 16\u00b12 Sv (at 48\u25e6N) (Ganachaud, 2003) or 17.2 Sv (Smethie and\nFine, 2001), and of the transport across 24\u25e6N as 18.5\u00b12 Sv (Ganachaud, 2003).\nIn all three of our model variants, such values are clearly within the region of\nbi-stability (Figure 7) and rather close to the minimum sustainable value for the\n\u2018on\u2019 state of maximum Atlantic MOC. Hence they are close to the \u2018cliff edge\u2019\nin the 2 parameter experiment with 36x36x8 (Figure 6). A value of \u224818 Sv\ncorresponds to f=0.65 of the default flux correction in 72x72x16, f=0.6\u20130.65\nin 36x36x8, and f=0.2 in 64x32x8. The real maximum Atlantic MOC may be\nsomewhat larger than 18 Sv with estimates up to 26 Sv at 59\u25e6N (Talley et al.,\n2003) and 23\u00b13 Sv at 30\u25e6S (Ganachaud, 2003). A value of \u224823 Sv corresponds\nto f=0.7\u20130.75 in 36x36x8, f=0.7 in 72x72x16, and f=0.25 in 64x32x8.\nThe longitude-latitude 64x32x8 grid needs the least flux correction to get\na THC \u2018on\u2019 state and has the widest region of bi-stability. Hence in order to\nexamine the effect of freshwater hosing, we selected 8 ensemble members that\nreside on the upper branch of the bistable regime (restarted from the THC \u2018on\u2019)\nfor 0.1 Sv and 1.0 Sv freshwater hosing experiments as in Stouffer et al. (2006).\nThese range over f=0.15\u20130.50 of the default flux correction in steps of 0.05 and\nhave a maximum Atlantic MOC ranging over \u224815\u201333 Sv. After 1000 years all\nhave a stable Atlantic MOC with the possible exception of f=0.15, which is\nweakening slightly. Applying 0.1 Sv freshwater hosing for 100 yrs, the Atlantic\nMOC collapses in 2 ensemble members (f=0.15, 0.20) and weakens modestly\nin the others. When the forcing is removed, the collapsed MOC runs do not\nrecover, indicating a switch to the other bi-stable state (although the run with\nf=0.20 shows brief resumptions of large-scale convection, e.g. around year 160).\nApplying 1.0 Sv freshwater hosing over 100 years causes all ensemble members\nto collapse. On removing the forcing, none have recovered after a further 140\nyrs, indicating a switch to the other bi-stable state in all cases.\n14\n6 Discussion\nWe have described a search for bi-stability of the thermohaline circulation\nwith the 3-D ocean\u2013atmosphere\u2013sea-ice core of the new GENIE-2 Earth sys-\ntem model. The study should be seen as a conceptual one because the fully\ncoupled model has yet to be tuned. Such tuning would improve the fit of our\nmodel results to observations and quantitatively alter our predictions but would\nbe unlikely to qualitatively alter the presence of bi-stability in the various con-\nfigurations. The simulations presented here are also subject to a small scaling\nerror in the ocean equation of state, which results in an under-prediction of\nocean velocities by \u224810%. Despite these limitations, the results provide one of\nthe first systematic, qualitative demonstrations of bi-stability of the thermoha-\nline circulation in a 3-D ocean\u2013atmosphere\u2013sea-ice model. Although coupling\nto a fully dynamical atmosphere model clearly increases variability in the THC,\nit does not remove bi-stability or obviously blur the boundaries of the hysteresis\nloop, in contrast to recent suggestions (Schlesinger et al., 2006, Yin et al., 2006).\nThe imposed default flux correction in GENIE-2 totals 0.79 Sv from Atlantic\nto Pacific and is about 2.5 times the 0.32 Sv used by default in GENIE-1 and C-\nGOLDSTEIN (Marsh et al., 2004). Figure 7 shows in grey a typical hysteresis\nloop for GENIE-1 obtained by varying the scaling of the Atlantic to Pacific\nfreshwater flux adjustment, which gives very similar results to the established\nmethod used in Rahmstorf et al. (2005). With the baseline ocean resolution\n36x36x8, the IGCM atmosphere demands more flux correction than the EMBM\nto get a THC \u2018on\u2019 state (Figure 7). This may be partly explained by the\nuse of prescribed, NCEP-derived wind fields in the EMBM. Furthermore, the\nIGCM resolves vertical structure, simulates cloud cover and associated radiative\nproperties, and is coupled in a more sophisticated way with the land surface.\nThese differences may substantially alter atmospheric humidity, and hence large-\nscale moisture transports. The width of the region of THC bi-stability appears\nto be somewhat larger with the IGCM atmosphere (\u22480.25 Sv) than with the\nEMBM (\u22480.15 Sv) (Marsh et al., 2004). With the 64x32x8 longitude-latitude\ngrid and the IGCM, it is wider still (up to \u22480.5 Sv). Thus, including a 3-D\ndynamical atmosphere can actually broaden the region of THC bi-stability.\nWe conjectured in the introduction that feedbacks from the atmosphere\n(Latif et al., 2000, Schmittner et al., 2000) and the ocean (de Vries and Weber,\n2005) may stabilize both the present \u2018on\u2019 state of the THC and the \u2018reversed\u2019\nstate. Our results show that both ocean and atmosphere feedbacks do indeed\ncontribute to extensive bi-stability of the THC. From the bifurcation between\nmono-stable \u2018off\u2019 state and bi-stability through much of the region of bi-stability,\nTHC switch-off leads to increased import of fresh water (export of salt) at the\nsouthern boundary of the Atlantic, which tends to maintain the \u2018off\u2019 state (Fig-\nure 10). However, the MOC imports freshwater (exports salt) in all experiments\nwith the 64x32x8 model and in most experiments with the 36x36x8 model. Only\nin experiments with the 72x72x16 model does the MOC sometimes export fresh\nwater at the southern boundary, favouring the THC \u2018on\u2019 state, while importing\nfresh water in the corresponding \u2018off\u2019 state. This behaviour is broadly consis-\ntent with findings of (de Vries and Weber, 2005), although the sign of MOC\nfreshwater transport is clearly not the single determinant of THC bi-stability in\nGENIE-2.\nThis positive ocean feedback is also evident in all resolutions where the\n15\nbi-stable state that is initialized \u2018off\u2019 starts to recover. In those cases, the\nrecovering \u2018off\u2019 state imports less fresh water (and even exports fresh water in\nexperiments with the 72x72x16 resolution) as the resuming THC tends to draw\nsalt into the Atlantic. Remarkably, less salt is exported than in those states that\nare initialized \u2018on\u2019, yet the MOC strength remains weaker in states initialised\n\u2018off\u2019. To explain this, atmosphere feedbacks must also be considered. Towards\nthe point where the bi-stable \u2018off\u2019 state starts to break down, and through the\nregion where it is recovering, positive feedback from the atmosphere tends to\nmaintain bi-stability by increasing Atlantic freshwater input to the state that\nis initialized \u2018off\u2019 relative to the state that is initialized \u2018on\u2019 (Figure 13). The\nocean and atmosphere mechanisms can be seen as counteracting one another\nin this regime, with the stronger atmospheric feedback extending the region of\nbi-stability towards higher values of Atlantic-Pacific freshwater flux correction.\nEven when the THC state that is initialized \u2018off\u2019 does switch on, it remains\nweaker than the state that is initialized \u2018on\u2019. Thus weaker and stronger THC \u2018on\u2019\nstates can be distinguished under the same boundary conditions and different\ninitializations of the model (Figure 7).\nThe differences in the position, width and sharpness of the bi-stable regimes\nas a function of Atlantic-to-Pacific freshwater flux correction can be interpreted\nin terms of the varying strengths of feedbacks in the different model resolutions.\nThe smaller flux correction required in the 64x32x8 model is related to the\ngreater northward transport of high salinity water in the North Atlantic, by the\nMOC itself (Figure 9). The 64x32x8 model has the widest region of bi-stability\nbecause it has the widest region over which the ocean provides positive feed-\nback, and where the ocean switches to negative feedback this is counteracted by\nthe strongest positive feedback from the atmosphere. The 36x36x8 model has a\nslightly wider region of bi-stability than the 72x72x16 model, corresponding to\na wider range over which the ocean provides positive feedback (where the at-\nmosphere provides positive feedback it is weaker and more overlapping with the\nregime of ocean positive feedback in these resolutions). The main effect of the\nincrease in resolution from 36x36x8 to 72x72x16 is to sharpen up the boundaries\nof the bi-stable regime, due to a stronger self-sustaining ocean feedback for the\n\u2018on\u2019 and \u2018off\u2019 states (Figure 10).\nIt is harder to pin down the deeper reasons why the resolutions differ in\nthese ways. We suggest that the absence of interpolation in the 64x32x8 model\nis the main factor reducing the required flux correction. In the other two resolu-\ntions, interpolation leads to an additional flux correction applied in the tropics\nwhich may be shifting the model away from the THC \u2018on\u2019 state. Increasing\nthe resolution from 36x36x8 to 72x72x16 within the same grid should improve\nthe resolution of zonal pressure gradients in the ocean, leading to better THC\nstructure, and improved salt transport. Surprisingly, this does not alter the\nrequired flux correction, but it may contribute to the larger changes in salt\nimport\/export with changes in the THC state in 72x72x16.\nTo put our results in the context of other studies, it is important to recognize\nthat in GENIE-2, as in all other models that have been systematically tested\n(Rahmstorf et al., 2005), there is a region of THC bi-stability, a region with a\nmono-stable \u2018on\u2019 state, and a region with a mono-stable \u2018off\u2019 state. The main\ndifference between other models is in the location of the present climate with\nrespect to the region of bi-stability \u2013 i.e. whether the present climate resides on\nthe mono-stable \u2018on\u2019 branch, or on the \u2018on\u2019 branch in the region of bi-stability.\n16\nIf the former, then a collapse of the THC caused by e.g. a temporary freshwater\nhosing perturbation, will be reversible, if the latter, then it will be irreversible.\nThis observation seems to have escaped the notice of some authors who, on the\nbasis of observing a reversible THC collapse in limited AOGCM runs, suggest\nthat there is no bi-stability in their model. In fact, all that can be inferred\nis that the initial state of their model is not in a region of bi-stability. Given\nthat our coupled model is un-tuned we do not consider that any of our model\nversions preferentially represent the present climate. Consequently, we are not\nin a position to say whether the real THC is in a mono-stable or bi-stable regime.\nEven in a region of bi-stability, the size of perturbation required to trigger\nTHC collapse depends on the position in the bi-stable regime, as is apparent\nin our hosing experiments (Figure 14). Versions of the 64x32x8 model that are\nclose to the present estimate of maximum Atlantic MOC are vulnerable to 0.1\nSv of extra freshwater addition over just 100 years. This rate is equivalent to\nthe freshwater flux expected from the Greenland ice sheet if it melts over a\ntimescale of \u22481000 yr. The decrease of 10\u201320 Sv seen in the ensemble members\nthat collapse exceeds that in any of the models inter-compared by Stouffer et al.\n(2006). However, this result should be treated with caution, as in these ensemble\nmembers the Pacific circulation is already reversed and the Atlantic MOC fails\nto reach the Southern Ocean. Our other ensemble members show a similar or\nlesser weakening than the \u22485 Sv in the ensemble mean of Stouffer et al. (2006).\nUnder an extreme 1.0 Sv freshwater hosing, the collapse of the Atlantic THC in\nall our ensemble members agrees with all the models inter-compared by Stouffer\net al. (2006). However, whereas a number of the other models recover after the\nperturbation is removed (indicating that they are in a mono-stable \u2018on\u2019 regime),\nnone of our ensemble members do, because they have switched into a different\nstable state.\nThe response of the atmosphere to THC collapse in GENIE-2 exhibits simi-\nlarities and important differences to other AOGCMs, noting that the atmospheric\nresponse in GENIE-2 is clearly a function of where the model is in parameter\nspace, so the comparison may not be a direct one. A southward shift of the\nITCZ is apparent in GENIE-2 as in other AOGCMs (Vellinga and Wood, 2002,\nYin et al., 2006). Yin et al. (2006) find a net drying of the tropical North At-\nlantic, which they argue creates a salinity anomaly near the Gulf of Mexico that\npropagates up the North Atlantic and aids THC recovery. This is somewhat\nsimilar to the anomaly observed in El Nino events (Schmittner et al., 2000)\nthat acts to stabilize the THC in global warming simulations with a different\nmodel (Latif et al., 2000). Vellinga and Wood (2002) (their figure 4c) show\nsome similar drying as well as wetting of the North Atlantic, but the changes\nassociated with the ITCZ shifting are dominant. However, given their THC\nrecovery, these models appear to be in the mono-stable \u2018on\u2019 regime. In con-\ntrast, the illustrative runs with GENIE-2 are in a bi-stable regime, and there\nis no clear Gulf of Mexico feature. Instead there is a net freshwater input to\nthe North Atlantic concentrated up the storm track, which is strongest in the\n64x32x8 model. Clearly the response of the atmosphere may be important in\ndetermining whether the THC recovers or remains collapsed, but this needs to\nbe systematically examined with reference to the model stability regime. Fur-\nthermore, our results suggest that atmospheric feedback only dominates over\nocean feedbacks in a restricted region of parameter space.\n17\nAcknowledgement The UK Natural Environment Research Council funded\nGENIE (NER\/T\/S\/2002\/00217) and funds the ongoing GENIEfy (NE\/C515904)\nproject through its e-Science programme. The development of alternative ocean\ngrids was funded by the NERC Rapid Climate Change project \u201cThe role of the\ncryosphere on modulating the THC of the North Atlantic\u201d (Ref. NER\/T\/S\/2002\n\/00462). The authors acknowledge the use of the UK National Grid Service in\ncarrying out this work.\n7 Appendix: Grid computing performance\nTo obtain the results presented here we undertook a total of 319 GENIE-2 simu-\nlations totalling 407, 000 model years and comprising 3, 736 compute tasks, tak-\ning 46, 992 CPU hours (some timings estimated). This was achieved in around\n3 months, including time spent considering the initial results and designing the\nrestart experiments. The throughput is equivalent to having about 20 model\nruns going continuously throughout the time, highlighting the power of the Grid\nto enable ensemble studies with Earth system models.\nTypically, a 1000 year simulation of GENIE-2 requires \u22484 days of continuous\ncompute time on a desktop machine (P4 3.0 GHz). To perform large ensembles\nof such runs presents a challenge in the traditional academic environment where\ncompute clusters are often configured to limit single CPU jobs to less than 4 days\nand an individual user is unlikely to be permitted exclusive use of the resource.\nFurthermore, the effort involved in configuring, managing and executing a study\nof this nature on a single cluster can present a significant overhead. The GENIE\ndata management solution provided the means for the project to harness the\nshared pool of compute resource available to individual project members and\nundertake the study with relative ease.\nTo contribute computational resource to a model study defined in the data-\nbase a user simply requires a single piece of information; the unique identifier\nof the experiment entity in the database. The identifier is typically distrib-\nuted by the experiment coordinator to interested parties although a query on\nthe database can also be performed to obtain this information. Armed with\nthe identifier, the user instantiates a time-limited proxy certificate to authen-\nticate their actions on the Grid. They then create a data structure describing\nthe computational resource(s) that they wish to submit work units to. This\ndescriptive metadata provides information including hostname, resource type\n(Globus, Condor) and the remote brokering system (Portable Batch System,\nSun Grid Engine, Condor, etc.) which the system can then use to manage job\nsubmissions. With this information defined in the workspace the user simply\ninvokes a single function call in order to contribute to the study. The scripted\nworkflows of the GENIE Toolbox then perform queries on the database to find\navailable work units and submit jobs to the specified resource. Post-processing\nscripts are also invoked on completed work units in order to archive output data\nto the database.\nIn total 5 client installations were used to progress the simulations to com-\npletion. Each client queried the shared database for work units and submitted\nthose compute tasks to resource available to the user in each case (see Figure\n15). Each client was configured by the user to exploit both local and national\nresource available to them using their X.509 e-Science certificate. The resource\n18\nused included 5 nodes of the UK National Grid Service (NGS), 3 institutional\nHigh Performance Computing (HPC) clusters and 1 large university Condor\npool. The database system enabled users to specify how much work was sub-\nmitted, for example, short 5\u201310 hour jobs were typically submitted on Condor\nas the chances of an interruption increase with time (we cannot exploit Con-\ndor\u2019s checkpointing facility because our pool consists of only Windows nodes).\nFor the NGS and HPC clusters we were able to submit jobs that run close to\nthe maximum allowable wall time of the scheduling system. Throughput is in\nprinciple only limited by the amount of available resource.\nThe daily breakdown of resource usage is shown in Figure 16. Periods of rel-\native inactivity reflect development work on the system and transitions between\nexperiments where the science team were analysing results from the first phase\nof experiments and configuring the second phase of the study. The computa-\ntional throughput was not limited by the system and the rate of progression\nwas determined by the amount of available work. The 5 clients functioning in\ntandem reached a sustained peak in excess of 90 model runs per day and each\nmade a significant contribution to the studies. The breakdown of the number\nof jobs completed by each client installation (Figure 17a) reflects the amount of\nresource available to the user on each of these clients. The client responsible for\n50% of the work was the only submission node on the large Condor pool and\nwas also used to submit jobs to the National Grid Service. The distribution of\njobs across the computational resources (Figure 17b) illustrates that the studies\nmade even use of the available platforms. The jobs were well spread across the\nNational Grid Service, the large Condor pool and the 3 dedicated clusters. The\nusage of different clusters broadly reflects the relative numbers of jobs a user\ncould reasonably hope to run concurrently on each of these systems.\nReferences\nAbramson, D., Buyya, R., and Giddy, J. (2002). A computational economy for\nGrid computing and its implementation in the Nimrod-G resource broker.\nFuture Generation Computer Systems, 18(8), 1061\u20131074.\nAllcock, B., Bester, J., Bresnahan, J., Chervenak, A. L., Foster, I., Kesselman,\nC., Meder, S., Nefedova, V., Quesnal, D., and Tuecke, S. (2002). Data man-\nagement and transfer in high performance computational Grid environments.\nParallel Computing Journal, 28(5), 749\u2013771.\nBetts, A. (1986). A new convective adjustment scheme. 1. observational and\ntheoretical basis. Q J R Meteorol Soc, 112, 667\u2013691.\nClaussen, M., Mysak, L., Weaver, A., Crucifix, M., Fichefet, T., Loutre, M.,\nWeber, S., Alcamo, J., Alexeev, V., Berger, A., Calov, R., Ganopolski,\nA., Goosse, H., Lohmann, G., Lunkeit, F., Mokhov, I., Petoukhov, V.,\nStone, P., and Wang, Z. (2002). Earth system models of intermediate\ncomplexity: Closing the gap in the spectrum of climate system models.\nClimate Dynamics, 18, 579\u2013586.\nCzajkowski, K., Foster, I., Karonis, N., Kesselman, C., Martin, S., Smith,\n19\nW., and Tuecke, S. (1998). A resource management architecture for meta-\ncomputing systems. In Proc. IPPS\/SPDP \u201998 Workshop on Job Scheduling\nStrategies for Parallel Processing, pages 62\u201382.\nde Forster, P. M., Blackburn, M., Glover, R., and Shine, K. P. (2000). An\nexaminatation of climate sensitivity for idealised climate change experiments\nin an intermediate general circulation model. Climate Dynamics, 16, 833\u2013849.\nde Vries, P. and Weber, S. L. (2005). The atlantic freshwater budget as a\ndianostic for the existence of a stable shut-down of the meridional overturning\ncirculation. Geophysical Research Letters, 32, L09606.\nEdwards, N. R. and Marsh, R. (2005). Uncertainities due to transport-\nparameter sensitivity in an efficient 3-D ocean-climate model. Climate\nDynamics, 24, 415\u2013433.\nEres, M. H., Pound, G. E., Jiao, Z., Wason, J. L., Xu, F., Keane, A. J., and\nCox, S. J. (2005). Implementation and utilisation of a Grid-enabled problem\nsolving environment in Matlab. Future Generation Computer Systems,\n21(6), 920\u2013929.\nFanning, A. G. and Weaver, A. J. (1996). An atmospheric energy-moisture\nmodel: Climatology, interpentadal climate change and coupling to an\nocean general circulation model. Journal of Geophysical Research, 101,\n15111\u201315128.\nFoster, I. and Kesselman, C. (1999). Globus: A toolkit-based Grid architecture.\nIn I. Foster and C. Kesselman, editors, The Grid: Blueprint for a New\nComputing Infrastructure, pages 259\u2013278. Morgan Kaufman Publishers, Inc.,\nSan Francisco, USA.\nFoster, I., Kesselman, C., and Tuecke, S. (2001). The anatomy of the Grid:\nEnabling scalable virtual organizations. International Journal of High\nPerformance Computing Applications, 15(3), 200\u2013222.\nFraedrich, K., Jansen, H., Kirk, E., Luksch, U., and Lunkeit, F. (2005a). The\nplanet simulator: Towards a user friendly model. Meteorologische Zeitschrift,\n14(3), 299\u2013304.\nFraedrich, K., Kirk, E., Luksch, U., and Lunkeit, F. (2005b). The portable\nuniversity model of the atmosphere (puma): Storm track dynamics and\nlow-frequency variability. Meteorologische Zeitschrift, 14(6), 735\u2013745.\nGanachaud, A. (2003). Large-scale mass transports, water mass formation,\nand diffusivities estimated from world ocean circulation experiment (WOCE)\nhydrographic data. Journal of Geophysical Research (Oceans), 108(C7),\n3213.\nGoosse, H. and Fichefet, T. (1999). Importance of ice-ocean interactions for\nthe global ocean circulation: a model study. Journal of Geophysical Research\n20\n(Oceans), 104(C10), 23337\u201323355.\nGriffies, S. M. (1998). The Gent-McWilliams skew flux. Journal of Physical\nOceanography, 28, 831\u2013841.\nHargreaves, J. C., Annan, J. D., Edwards, N. R., and Marsh, R. (2004). An\nefficient climate forecasting method using an intermediate complexity Earth\nSystem Model and the ensemble Kalman filter. Climate Dynamics, 23,\n745\u2013760.\nHey, T. and Trefethen, A. E. (2002). The UK e-Science core programme and\nthe Grid. Future Generation Computing Systems, 18(8), 1017\u20131031.\nHoskins, B. J. and Simmons, A. J. (1975). A multi-layer spectral model and\nthe semi-implicit method. Quarterly Journal of the Royal Meteorological\nSociety, 101, 637\u2013655.\nJayne, S. R. and Marotzke, J. (2001). The dynamics of ocean heat transport\nvariability. Reviews of Geophysics, 39, 385\u2013411.\nKeane, A. J. (2003). The OPTIONS design exploration system: reference\nmanual and user guide. http:\/\/www.soton.ac.uk\/\u223cajk\/options.ps.\nLatif, M., Roeckner, E., Mikolajewicz, U., and Voss, R. (2000). Tropical stabi-\nlization of the thermohaline circulation in a greenhouse warming simulation.\nJournal of Climate, 13, 1809\u20131813.\nLenton, T. M., Williamson, M. S., Edwards, N. R., Marsh, R., Ridgwell, A. J.,\nPrice, A. R., Shepherd, J. G., Cox, S. J., and The GENIE team (2006).\nMillennial timescale carbon cycle and climate change in an efficient Earth\nsystem model. Climate Dynamics, 26, 687\u2013711.\nLouis, J.-F. (1986). Forecast model research manual 3: physical parameterisa-\ntion. European Centre for Medium Range Weather Forecasts.\nMarsh, R., Yool, A., Lenton, T. M., Gulamali, M. Y., Edwards, N. R., Shep-\nherd, J. G., Krznaric, M., Newhouse, S., and Cox, S. J. (2004). Bistability of\nthe thermohaline circulation identified through comprehensive 2-parameter\nsweeps of an efficient climate model. Climate Dynamics, 23, 761\u2013777.\nMorcrette, J. (1990). Impact of changes to the radiative transfer paramterisa-\ntions plus cloud optical properties in the ECMWF model. Monthly Weather\nReview, 118, 847\u2013873.\nMurphy, J. M., Sexton, D. M. H., Barnett, D. N., Jones, G. S., Webb, M. J.,\nCollins, M., and Stainforth, D. A. (2004). Quantification of modelling\nuncertainties in a large ensemble of climate change simulations. Nature, 430,\n768\u2013772.\nOpsteegh, J. D., Haarsma, R. J., Selten, F. M., and Kattenberg, A. (1998).\n21\nECBILT a dynamic alternative to mixed boundary conditions in ocean\nmodels. Tellus A, 50, 348\u2013367.\nPetoukhov, V., Ganopolski, A., Brovkin, V., Claussen, M., Eliseev, A., Ku-\nbatzki, C., and Rahmstorf, S. (2000). CLIMBER-2: A climate system model\nof intermediate complexity. Part I: Model description and performance for\npresent climate. Climate Dynamics, 16, 1\u201317.\nPope, V., Gallani, M., Rowntree, P., and Stratton, R. (2000). The impact\nof new physical paramterisations in the Hadley Centre climate model:\nHadAM3. Climate Dynamics, 16, 123\u2013146.\nPrice, A. R., Xue, G., Yool, A., Lunt, D. J., Valdes, P. J., Lenton, T. M., Wason,\nJ. L., Pound, G. E., Cox, S. J., and the GENIE team (2006). Optimisation\nof integrated Earth System Model components using Grid-enabled data\nmanagement and computation. Concurrency and Computation: Practice\nand Experience, page in press.\nRahmstorf, S., Crucifix, M., Ganopolski, A., Goosse, H., Kamenkovich, I.,\nKnutti, R., Lohmann, G., Marsh, R., Mysak, L. A., Wang, Z., and Weaver,\nA. J. (2005). Thermohaline circulation hysteresis: A model intercomparison.\nGeophysical Research Letters, 32, L23605.\nRoche, D. M., Dokken, T. M., Goosse, H., Renssen, H., and Weber, S. L.\n(2006). Climate of the last glacial maximum: sensitivity studies and\nmodel-data comparison with the loveclim coupled model. Climate of the\nPast Discussions, 2, 1105\u20131153.\nSchlesinger, M. E., Yin, J., Yohe, G. W., Andronova, N. G., Malyshev, S., and\nLi, B. (2006). Assessing the risk of a collapse of the Atlantic thermohaline\ncirculation. In H. J. Schellnhuber, W. Cramer, N. Nakicenovic, T. Wigley,\nand G. Yohe, editors, Avoiding Dangerous Climate Change, pages 37\u201347.\nCambridge University Press, Cambridge.\nSchmittner, A., Appenzeller, C., and Stocker, T. F. (2000). Enhanced Atlantic\nfreshwater export during El Nino. Geophysical Research Letters, 27, 1163\u2013\n1166.\nSlingo, J. (1987). The development and verification of a cloud prediction\nscheme for the ECMWF model. Q J R Meteorolo Soc, 113, 899\u2013927.\nSmethie, W. M. and Fine, R. A. (2001). Rates of North Atlantic Deep Water\nformation calculated from chlorofluorocarbon inventories. Deep Sea Research\nI, 48, 189\u2013215.\nStommel, H. (1961). Thermohaline convection with two stable regimes of flow.\nTellus, 13, 224\u2013230.\nStouffer, R. J. and Manabe, S. (2003). Equilibrium response of thermohaline\ncirculation to large changes in atmospheric CO2 concentration. Climate\n22\nDynamics, 20, 759\u2013773.\nStouffer, R. J., Yin, J., Gregory, J. M., Dixon, K. W., Spelman, M. J., Hurlin,\nW., Weaver, A. J., Eby, M., Flato, G. M., Hasumi, H., Hu, A., Jungclaus,\nJ. H., Kamenkovich, I. V., Levermann, A., Montoya, M., Murakami, S.,\nNawrath, S., Oka, A., Peltier, W. R., Robitaille, D. Y., Sokolov, A.,\nVettoretti, G., and Weber, S. L. (2006). Investigating the causes of the\nresponse of the thermohaline circulation to past and future climate changes.\nJournal of Climate, 19, 1365\u20131387.\nTalley, L. D., Reid, J. L., and Robbins, P. E. (2003). Data-based meridional\noverturning streamfunctions for the global ocean. Journal of Climate, 16,\n3213\u20133226.\nThain, D., Tannenbaum, T., and Livny, M. (2005). Distributed computing in\npractice: the Condor experience. Concurrency and Computation: Practice\nand Experience, 17(2\u20134), 323\u2013356.\nThorpe, R. B., Gregory, J. M., Johns, T. C., Wood, R. A., and Mitchell, J.\nF. B. (2001). Mechanisms determinging the Atlantic thermohaline circulation\nresponse to greenhouse gas forcing in a non-flux-adjusted coupled climate\nmodel. Journal of Climate, 14, 3102\u20133116.\nVellinga, M. and Wood, R. A. (2002). Global climatic impacts of a collapse of\nthe atlantic thermohaline circulation. Climatic Change, 54, 251\u2013267.\nvon Laszewski, G., Foster, I., Gawor, J., and Lane, P. (2001). A Java Com-\nmodity Grid kit. Concurrency and Computation: Practice and Experience,\n13(8\u20139), 643\u2013662.\nWang, H. and Birchfield, G. E. (1992). An energy-salinity balance climate\nmodel: Water vapor transport as a cause of changes in the global thermoha-\nline circulation. Journal of Geophysical Research, 97(C2), 2335\u20132346.\nWelch, V., Siebenlist, F., Foster, I., Bresnahan, J., Czajkowski, K., Gawor, J.,\nKesselman, C., Meder, S., Pearlman, L., and Tuecke, S. (2003). Security for\nGrid services. In Proceedings of the 12th IEEE International Symposium on\nHigh Performance Distributed Computing, pages 48\u201357, Seattle, Washington,\nUSA. The Institute of Electrical and Electronics Engineers, Inc.\nWright, D. G. and Stocker, T. F. (1991). A zonally averaged ocean model for\nthe thermohaline circulation. Part 1: Model development and flow dynamics.\nJournal of Physical Oceanography, 21, 1713\u20131724.\nYarKhan, A., Seymour, K., Sagi, K., Shi, Z., and Dongarra, J. (2006). Recent\ndevelopments in Gridsolve. International Journal of High Performance\nComputing Applications, 20(1), 131\u2013141.\nYin, J., Schlesinger, M. E., Andronova, N. G., Malyshev, S., and Li, B. (2006).\nIs a shutdown of the thermohaline circulation irreversible? Journal of\n23\nGeophysical Research (Oceans), 111, D12104.\n24\nTable 1: Components, models, grids and resolutions used in the GENIE-2 ex-\nperiments described herein (many others are available in the GENIE framework\n\u2013 see Supplementary Information).\nComponent Model Resolution\nVariant\nLongitude Latitude Vertical\nCells Res. Cells Res. Levels Topog.\nOcean GOLDSTEIN Baseline 36 10\u25e6 36 sin(pi\/36) 8 Yes\nHigh 72 5\u25e6 72 sin(pi\/72) 16 Yes\nIGCM res. 64 5.625\u25e6 32 5.625\u25e6 8 Yes\nAtmosphere 3-D IGCM Baseline T21 64 5.625\u25e6 32 5.625\u25e6 7 Yes\nSea-ice Slab Baseline 64 5.625\u25e6 32 5.625\u25e6 1 \u2013\nLand IGCM-land Baseline 64 5.625\u25e6 32 5.625\u25e6 \u2013 \u2013\n25\nTable 2: Parameter settings used in the new experiments. Ocean albedo, sea-\nice albedo and all IGCM and IGCM-land parameters listed are from genetic\nalgorithm tuning of the IGCM with fixed ocean, fixed sea-ice, and IGCM-land\n(genie ia fo fs il) \u2013 they are the member of the final population with the lowest\nrms error. Other GOLDSTEIN parameters listed are un-tuned default values.\nParameter Label Value Units\nIGCM\nroughness length over ocean ia rough ocean 3.711 \u00d7 10\u22124 m\nboundary layer gustiness ia blvad 1.132 ms\u22121\nenhancement in the stable case ia enhancestable 0.3731 \u2013\nfactor limit for increases in speed due to gusts ia enhancelim 2.011 \u2013\nboundary layer relative humidity ia blrh 1.198 \u00d7 102 \u2013\nincrease in flux ia fluxfactor 1.327 \u2013\ndiffusion increase of u\/v at 2nd lowest level ia increaseu 7.332 \u2013\ndiffusion increase of t at 2nd lowest level ia increaset 0.6678 \u2013\ndiffusion increase of q at 2nd lowest level ia increaseq 0.8888 \u2013\nvertical diffusion coefficient for q ia akqv 1.128 m2s\u22121\nconvection or not? ia lcr true \u2013\ntimescale for convective adjustment ia cbadjt 4.911 hr\nminimum precipitation for which there is cloud ia pcloudmin 3.013 mm d\u22121\nprecipitation factor ia pcloudfact 0.09859 \u2013\ncloud fraction when there is shallow convection ia cloudshallow 0.2642 \u2013\ntimescale for non-precipitation convection ia cubmt 1.371 hr\nminimum RH for cloud fraction = 0 ia humcloudmin 0.7263 \u2013\nmaximum RH for cloud fraction = 1 ia humcloudmax 0.9085 \u2013\npower for variation between min and max ia powercloud 1.002 \u2013\ncloud supersaturation for liquid water path ia supersatconv 0.01273 \u2013\nas above but for large-scale clouds ia supersatlarg 0.03299 \u2013\ncloud factor ia cloudconvnorm 0.4409 \u2013\ncloud factor at the base of the cloud ia cloudconvbase 0.8018 \u2013\nemissivity as f(liquid water path) constant a ia emissconsta 1.152 \u2013\nemissivity as f(liquid water path) constant b ia emissconstb 1.278 \u00d7 102 \u2013\ndroplet radius ia zradef 3.092 microns\nIGCM-land\nglobal albedo fix ia albedo fix -0.03963 \u2013\nheight of snow for intermediate snow\/veg albedo ia shsstar 0.1294 m\nGOLDSTEIN\nisopycnal diffusivity \u03bah, go 14 2000 m2s\u22121\ndiapycnal diffusivity \u03bav, go 15 1 \u00d7 10\u22125 m2s\u22121\nfriction \u03bb, go 16 2.5 days\u22121\nwind-scale W , go 13 2 \u2013\nocean albedo go albedo 0.07422 \u2013\nSlab sea-ice\nsea-ice albedo ss albedo seaice 0.4652 \u2013\n26\nTable 3: Ensemble studies of GENIE-2 performed on the Grid. The key para-\nmeter varied is the scaling factor of the default Atlantic-to-Pacific freshwater\nflux correction (f).\nExperiment Run dura-\ntion (yr)\nResolution\n[binary]\nParameter Range Members Restart\nstate\nSpin-ups 1000 36x36x8 f 0\u20132 21 \u2013\n1000 64x32x8 f 0\u20132 21 \u2013\n1000 72x72x16 f 0\u20132 21 \u2013\nRestarts 1000 36x36x8 f 0\u20131 21 f=0\n21 f=1\n1000 64x32x8 f 0\u20131 21 f=0\n21 f=1\n1000 72x72x16 f 0\u20131 21 f=0\n[Win32] 21 f=1\n1000 72x72x16 f 0\u20131 21 f=0\n[Linux] 21 f=1\n2- 2000 36x36x8 f 0\u20132 11*11\nparameter log(ia enhancestable) -1\u20131 = 121 \u2013\n27\n12\n3\n4\n5\n6\n7\n8\n1 2 3 4 5 6\n1\n2\n3\n4\n5\n6\nNumber of\nInteracting\ncomponents\nI\nG\nD\nCumulative \nDimension \n[Atmosphere \n+ Ocean]\nLog10(Grid cells) [Atmosphere + Ocean]\nInitial\nFull\nBox\nmodel\nGENIE\nAOL-GCM\nBern 2.5D\nCLIMBER-2\nC-GOLDSTEIN\nEcBilt\/CLIO\nPUMA\nFigure 1: The spectrum of Earth system models, after Claussen et al. (2002),\ndefined in terms of number of grid cells (G), cumulative dimension (D), and\nnumber of interacting components (I). The positions of some well known and\ngeneric models are indicated, including a typical atmosphere-ocean-land (AOL)\nGCM. The GENIE framework spans a volume of model space in terms of resolu-\ntion (G), dimensionality (D) and comprehensiveness (I), indicated by the black\nbars along the axes and the corresponding box.\n28\nAtmosphere\nOcean\nSea ice\nAtmospheric\nchemistry\nLand surface\nLand \nbiogeochemistry\nOcean \nbiogeochemistry\nOcean sediments\nIce sheets\nFigure 2: Major components of an Earth system model. The GENIE frame-\nwork currently offers at least one option for each of these components, except\natmospheric chemistry, which is currently just an atmospheric tracer module\nwithout chemical reactions.\n29\n 175\n411\n729\n 1158\n 1738\n 2520\n 3576\n 5000\nDepth (m)\n0 30 60 90 120 150 180 210 240 270 300 330 360\n-90\n-60\n-30\n0\n30\n60\n90\n-90\n-60\n-30\n0\n30\n60\n90\n(a) 36x36x8\n(a)\n \n175\n411\n729\n 1158\n 1738\n 2520\n 3576\n 5000\nDepth (m)\n0 30 60 90 120 150 180 210 240 270 300 330 360\n-90\n-60\n-30\n0\n30\n60\n90\n-90\n-60\n-30\n0\n30\n60\n90\n(b) 64x32x8\n(b)\nFigure 3: Alternative surface grids and corresponding bathymetry in the GENIE\nframework: (a) 36x36x8 longitude-sine(latitude) i.e. equal area, (b) 64x32x8\nlongitude-latitude. Note that the 72x72x16 model used herein shares the\n36x36x8 surface grid and bathymetry, in order to isolate the effects of simply\nincreasing the number of grid cells.\n30\nLatitude [\u00b0N]\nD\nep\nth\n [k\nm]\nAtlantic\n\u221290 \u221260 \u221230 0 30 60 90\n\u22125\n\u22124\n\u22123\n\u22122\n\u22121\n0\n\u221230\n\u221220\n\u221210\n0\n10\n20\n30\n(a)\nLatitude [\u00b0N]\nD\nep\nth\n [k\nm]\nPacific\n\u221290 \u221260 \u221230 0 30 60 90\n\u22125\n\u22124\n\u22123\n\u22122\n\u22121\n0\n\u221230\n\u221220\n\u221210\n0\n10\n20\n30\n(b)\nLatitude [\u00b0N]\nD\nep\nth\n [k\nm]\nAtlantic\n\u221290 \u221260 \u221230 0 30 60 90\n\u22125\n\u22124\n\u22123\n\u22122\n\u22121\n0\n\u221230\n\u221220\n\u221210\n0\n10\n20\n30\n(c)\nLatitude [\u00b0N]\nD\nep\nth\n [k\nm]\nPacific\n\u221290 \u221260 \u221230 0 30 60 90\n\u22125\n\u22124\n\u22123\n\u22122\n\u22121\n0\n\u221230\n\u221220\n\u221210\n0\n10\n20\n30\n(d)\nLatitude [\u00b0N]\nD\nep\nth\n [k\nm]\nAtlantic\n\u221290 \u221260 \u221230 0 30 60 90\n\u22125\n\u22124\n\u22123\n\u22122\n\u22121\n0\n\u221230\n\u221220\n\u221210\n0\n10\n20\n30\n(e)\nLatitude [\u00b0N]\nD\nep\nth\n [k\nm]\nPacific\n\u221290 \u221260 \u221230 0 30 60 90\n\u22125\n\u22124\n\u22123\n\u22122\n\u22121\n0\n\u221230\n\u221220\n\u221210\n0\n10\n20\n30\n(f)\nFigure 4: End-of-run annual average (a, c, e) Atlantic MOC and (b, d, f)\nPacific MOC (both in Sv) after 2000 years at the default flux correction, for (a,\nb) 36x36x8 (c, d) 72x72x16 (Linux binary) (e, f) 64x32x8.\n31\n010\n20\n30\n40\n50\n60\n0 0.2 0.4 0.6 0.8 1 1.2 1.4 1.6 1.8 2\nFlux correction (scaling factor)\nM\na\nx\n. \nA\ntl\na\nn\nti\nc\n M\nO\nC\n (\nS\nv\n)\nFigure 5: Initial spin-up ensembles of maximum Atlantic Meridional Overturn-\ning Circulation (MOC) as a function of Atlantic to Pacific freshwater flux cor-\nrection (expressed as multiple of default 0.79 Sv) in different ocean resolutions of\nthe 3-D Earth system model GENIE-2: (solid line) \u201cbaseline\u201d 36x36x8, (dotted\nline) higher resolution 72x72x16, (dashed line) IGCM-grid matched 64x32x8.\nThe IGCM atmosphere resolution (T21) is the same in all cases. Points are av-\nerages over the last 50 years of 1000 year runs because in these initial ensembles\noutput was restricted to 50 of each 100 years.\n32\nia_enhancestable log10(scaling factor)\nFl\nux\n c\nor\nre\nct\nio\nn \nsc\nal\nin\ng \nfa\nct\nor\n\u22121 \u22120.8 \u22120.6 \u22120.4 \u22120.2 0 0.2 0.4 0.6 0.8 1\n0\n0.2\n0.4\n0.6\n0.8\n1\n1.2\n1.4\n1.6\n1.8\n2\n5\n10\n15\n20\n25\n30\n35\n40\n45\n50\nFigure 6: Maximum Atlantic Meridional Overturning Circulation (MOC)\nstrength (Sv) in the 36x36x8 ocean resolution version of GENIE-2, as a func-\ntion of the IGCM parameter ia enhancestable (which scales the latent heat and\nfreshwater flux to the atmosphere) and Atlantic to Pacific freshwater flux cor-\nrection (expressed as multiple of default 0.79 Sv). Results are after 2000 years\nof spin-up. 88 out of 121 runs completed, the white areas indicate runs that\nfailed due to instability. Contour interval is 2.5 Sv.\n33\n05\n10\n15\n20\n25\n30\n35\n40\n45\n0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1\nFlux correction (scaling factor)\nM\na\nx\n. \nA\ntl\na\nn\nti\nc\n M\nO\nC\n (\nS\nv\n)\nFigure 7: Bi-stability of the maximum Atlantic Meridional Overturning Cir-\nculation (MOC) as a function of Atlantic to Pacific freshwater flux correction\n(expressed as multiple of default 0.79 Sv) in different ocean resolutions of the 3-\nD Earth system model GENIE-2: (solid line) \u201cbaseline\u201d 36x36x8, (dotted line)\nhigher resolution 72x72x16, (dashed line) IGCM-grid matched 64x32x8. The\nIGCM atmosphere resolution (T21) is the same in all cases. For each resolu-\ntion, ensembles were restarted from spin-ups with the default flux correction\n(upper branch, squares) or no flux correction (lower branch, circles). Points are\naverages of the last 100 years of a 1000 year run. Also shown in grey are the\nresults of a hysteresis experiment with GENIE-1, which uses the 2-D EMBM\natmosphere instead of the 3-D IGCM and has ocean resolution 36x36x8.\n34\nLatitude [\u00b0N]\nD\nep\nth\n [k\nm]\nAtlantic\n\u221290 \u221260 \u221230 0 30 60 90\n\u22125\n\u22124\n\u22123\n\u22122\n\u22121\n0\n\u221230\n\u221220\n\u221210\n0\n10\n20\n30\n(a)\nLatitude [\u00b0N]\nD\nep\nth\n [k\nm]\nAtlantic\n\u221290 \u221260 \u221230 0 30 60 90\n\u22125\n\u22124\n\u22123\n\u22122\n\u22121\n0\n\u221230\n\u221220\n\u221210\n0\n10\n20\n30\n(b)\nLatitude [\u00b0N]\nD\nep\nth\n [k\nm]\nAtlantic\n\u221290 \u221260 \u221230 0 30 60 90\n\u22125\n\u22124\n\u22123\n\u22122\n\u22121\n0\n\u221230\n\u221220\n\u221210\n0\n10\n20\n30\n(c)\nLatitude [\u00b0N]\nD\nep\nth\n [k\nm]\nAtlantic\n\u221290 \u221260 \u221230 0 30 60 90\n\u22125\n\u22124\n\u22123\n\u22122\n\u22121\n0\n\u221230\n\u221220\n\u221210\n0\n10\n20\n30\n(d)\nLatitude [\u00b0N]\nD\nep\nth\n [k\nm]\nAtlantic\n\u221290 \u221260 \u221230 0 30 60 90\n\u22125\n\u22124\n\u22123\n\u22122\n\u22121\n0\n\u221230\n\u221220\n\u221210\n0\n10\n20\n30\n(e)\nLatitude [\u00b0N]\nD\nep\nth\n [k\nm]\nAtlantic\n\u221290 \u221260 \u221230 0 30 60 90\n\u22125\n\u22124\n\u22123\n\u22122\n\u22121\n0\n\u221230\n\u221220\n\u221210\n0\n10\n20\n30\n(f)\nFigure 8: Bi-stability of the annual average Atlantic MOC for different ocean\ngrids and resolutions, revealed by restarting from (a, c, e) THC on, or (b, d,\nf) THC reversed, for (a, b) 36x36x8 at f = 0.8 of default flux correction (c, d)\n72x72x16 (Linux binary) at f = 0.85 (e, f) 64x32x8 at f = 0.55.\n35\n-90 -60 -30 0 30 60 90\nlatitude\n-0.4\n-0.3\n-0.2\n-0.1\n0.0\n0.1\n0.2\n0.3\n0.4\nS\nv\n-0.4\n-0.3\n-0.2\n-0.1\n0.0\n0.1\n0.2\n0.3\n0.4\nfrom On state\nfrom Off state\nDifference\n(Off - On)\n(a)\n-90 -60 -30 0 30 60 90\nlatitude\n-0.4\n-0.3\n-0.2\n-0.1\n0.0\n0.1\n0.2\n0.3\n0.4\nS\nv\n-0.4\n-0.3\n-0.2\n-0.1\n0.0\n0.1\n0.2\n0.3\n0.4\nfrom On state\nfrom Off state\nDifference\n(Off - On)\n(b)\n-90 -60 -30 0 30 60 90\nlatitude\n-0.4\n-0.3\n-0.2\n-0.1\n0.0\n0.1\n0.2\n0.3\n0.4\nS\nv\n-0.4\n-0.3\n-0.2\n-0.1\n0.0\n0.1\n0.2\n0.3\n0.4\nfrom On state\nfrom Off state\nDifference\n(Off - On)\n(c)\nFigure 9: Meridional profiles of MOC freshwater transport versus latitude (pos-\nitive northwards) for THC on and THC off restarts, and difference (off - on)\n(a) 36x36x8 at f = 0.8 of default flux correction (b) 72x72x16 at f = 0.85 (c)\n64x32x8 at f = 0.55. Individual annual averages are shown for a decade at the\nend of the restarted simulations.\n36\n0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0\nFlux correction (fraction of default)\n-0.3\n-0.2\n-0.1\n0.0\n0.1\n0.2\n0.3\n0.4\n0.5\n0.6\nS\nv\n (\np\no\ns\nit\niv\ne\n n\no\nrt\nh\nw\na\nrd\ns\n)\n-0.3\n-0.2\n-0.1\n0.0\n0.1\n0.2\n0.3\n0.4\n0.5\n0.6\n(a)\n0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0\nFlux correction (fraction of default)\n-0.3\n-0.2\n-0.1\n0.0\n0.1\n0.2\n0.3\n0.4\n0.5\n0.6\nS\nv\n (\np\no\ns\nit\niv\ne\n n\no\nrt\nh\nw\na\nrd\ns\n)\n-0.3\n-0.2\n-0.1\n0.0\n0.1\n0.2\n0.3\n0.4\n0.5\n0.6\n(b)\n0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0\nFlux correction (fraction of default)\n-0.3\n-0.2\n-0.1\n0.0\n0.1\n0.2\n0.3\n0.4\n0.5\n0.6\nS\nv\n (\np\no\ns\nit\niv\ne\n n\no\nrt\nh\nw\na\nrd\ns\n)\n-0.3\n-0.2\n-0.1\n0.0\n0.1\n0.2\n0.3\n0.4\n0.5\n0.6\n(c)\nFigure 10: Freshwater transport at the Southern boundary of the Atlantic (32\u25e6S)\nas a function of default flux correction, for restarts from THC on (squares) and\nTHC off (circles) states, in different resolutions: (a) 36x36x8 (b) 72x72x16 (c)\n64x32x8. Calculated as a decadal average at the end of the restarted simulations.\n37\n0 30 60 90 120 150 180 210 240 270 300 330 360\n-90\n-60\n-30\n0\n30\n60\n90\n-90\n-60\n-30\n0\n30\n60\n90\nbelow -0.5\n-0.5 - -0.4\n-0.4 - -0.3\n-0.3 - -0.2\n-0.2 - -0.1\n-0.1 - 0.0\n0.0 - 0.1\n0.1 - 0.2\n0.2 - 0.3\n0.3 - 0.4\n0.4 - 0.5\nabove 0.5\n(a)\nbelow -0.5\n-0.5 - -0.4\n-0.4 - -0.3\n-0.3 - -0.2\n-0.2 - -0.1\n-0.1 - 0.0\n0.0 - 0.1\n0.1 - 0.2\n0.2 - 0.3\n0.3 - 0.4\n0.4 - 0.5\nabove 0.5\n0 30 60 90 120 150 180 210 240 270 300 330 360\n-90\n-60\n-30\n0\n30\n60\n90\n-90\n-60\n-30\n0\n30\n60\n90\n(b)\n0 30 60 90 120 150 180 210 240 270 300 330 360\n-90\n-60\n-30\n0\n30\n60\n90\n-90\n-60\n-30\n0\n30\n60\n90\nbelow -0.5\n-0.5 - -0.4\n-0.4 - -0.3\n-0.3 - -0.2\n-0.2 - -0.1\n-0.1 - 0.0\n0.0 - 0.1\n0.1 - 0.2\n0.2 - 0.3\n0.3 - 0.4\n0.4 - 0.5\nabove 0.5\n(c)\nFigure 11: Maps of net surface freshwater flux difference due to THC switch off\n(off - on) in m\/yr: (a) 36x36x8 at f = 0.8 of default flux correction (b) 72x72x16\nat f = 0.85 (c) 64x32x8 at f = 0.55. Calculated as a decadal average at the\nend of the restarted simulations.\n38\n-90 -60 -30 0 30 60 90\nlatitude\n-3.0\n-1.5\n0.0\n1.5\n3.0\nm\n\/y\ne\na\nr\n-3.0\n-1.5\n0.0\n1.5\n3.0\nfrom On state\nfrom Off state\nDifference\n(Off-On)\n(a)\n-90 -60 -30 0 30 60 90\nlatitude\n-3.0\n-1.5\n0.0\n1.5\n3.0\nm\n\/y\ne\na\nr\n-3.0\n-1.5\n0.0\n1.5\n3.0\nfrom On state\nfrom Off state\nDifference\n(Off-On)\n(b)\n-90 -60 -30 0 30 60 90\nlatitude\n-3.0\n-1.5\n0.0\n1.5\n3.0\nm\n\/y\ne\na\nr\n-3.0\n-1.5\n0.0\n1.5\n3.0\nfrom On state\nfrom Off state\nDifference\n(Off-On)\n(c)\nFigure 12: Meridional profiles of Atlantic surface freshwater flux per latitude\nstrip in m\/yr, for THC on and THC off restarts and difference (off - on) (a)\n36x36x8 at f = 0.8 of default flux correction (b) 72x72x16 at f = 0.85 (c)\n64x32x8 at f = 0.55. Calculated as a decadal average at the end of the restarted\nsimulations.\n39\n0.0 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1.0\nFlux correction (fraction of default)\n-0.1\n-0.08\n-0.06\n-0.04\n-0.02\n0.0\n0.02\n0.04\n0.06\n0.08\n0.1\nS\nv\n (\np\no\ns\nit\niv\ne\n i\nn\nto\n o\nc\ne\na\nn\n)\n-0.1\n-0.08\n-0.06\n-0.04\n-0.02\n0.0\n0.02\n0.04\n0.06\n0.08\n0.1\n36x36x8\n72x72x16\n64x32x8\nFigure 13: Net Atlantic surface freshwater flux difference (off - on) due to THC\nswitch off, in different resolutions, as a function of default flux correction. Cal-\nculated as a decadal average at the end of the restarted simulations.\n40\nyear\n0 40 80 120 160 200 240\n0\n10\n20\n30\n40\nM\na\nx\nim\nu\nm\n A\ntl\na\nn\nti\nc\n M\nO\nC\n (\nS\nv\n)\n0\n10\n20\n30\n40\n(a)\n0 40 80 120 160 200 240\nyear\n0\n10\n20\n30\n40\nM\na\nx\nim\nu\nm\n A\ntl\na\nn\nti\nc\n M\nO\nC\n (\nS\nv\n)\n0\n10\n20\n30\n40\nScaling factor on\nFW flux correction\n0.15\n0.20\n0.25\n0.30\n0.35\n0.40\n0.45\n0.50\n(b)\nFigure 14: Freshwater hosing experiments (a) 0.1 Sv for 100 yr (b) 1.0 Sv for\n100 yr, for variants of GENIE-2 with the 64x32x8 grid and differing fractions\nof the default flux correction. All ensemble members are within the bi-stable\nregion for the THC.\n41\nFigure 15: Collaborative study mediated by the GENIE database. Client in-\nstallations at member institutions contribute to an ensemble study by retrieving\nwork from the database and either submitting it to a resource within the insti-\ntutional administrative domain or to a resource on the computational Grid\n42\n14\u2212Dec\u22122005 03\u2212Jan\u22122006 23\u2212Jan\u22122006 12\u2212Feb\u22122006 04\u2212Mar\u22122006 24\u2212Mar\u22122006\n0\n10\n20\n30\n40\n50\n60\n70\n80\n90\n100\nDate\nCP\nU \nTi\nm\ne \n(da\nys\n)\nResource usage per day\nCluster1, UEA\nNGS Leeds\nNGS Manchester\nNGS Oxford\nNGS RAL\nNGS Bristol\nPacifica, Southampton\nSouthampton University Condor Pool\nIridis2, Southampton\nFigure 16: Daily resource usage for the twelve ensemble studies\n43\nBristol\nUEA1\nUEA2Soton1\nSoton2\na) Total timesteps submitted per client\nCluster1, UEA\nNGS Leeds\nNGS Manchester\nNGS Oxford NGS RAL\nNGS Bristol\nPacifica, Southampton\nSouthampton University Condor Pool\nIridis2, Southampton\nb) Total walltime per resource\nFigure 17: Distributions of a) client job submissions and b) resource usage\nmeasured as total number of timesteps performed\n44\nSupplementary Information: The Grid ENabled\nIntegrated Earth system modelling (GENIE)\nframework\nT. M. Lenton\u2217 R. Marsh\u2020 A. R. Price\u2021 D. J. Lunt\u00a7\nY. Aksenov\u2020 J. D. Annan\u00b6 T. Cooper-Chadwick\u2021\nS. J. Cox\u2021 N. R. Edwards\u2016 S. Goswami\u2217\nJ. C. Hargreaves\u00b6 P. P. Harris\u2217\u2217 Z. Jiao\u2021 V. N. Livina\u2217\nA. J. Payne\u00a7 I. C. Rutt\u00a7 J. G. Shepherd\u2020 P. J. Valdes\u00a7\nG. Williams\u00a7 M. S. Williamson\u2020\u2020 A. Yool\u2020\nJanuary 31, 2007\nAbstract\nThe Grid ENabled Integrated Earth system modelling (GENIE) frame-\nwork supports modularity (i.e. interchangeable components) and scala-\nbility (i.e. variable resolution of the components), which aids traceability,\nmeaning the ability to relate the process representation and results for\ndifferent module choices and\/or resolutions to one another. Here for each\nof the main components of the Earth system, we discuss the appropriate\nmodelling approaches for our goals and introduce the component models\nadopted thus far. We describe their coupling to produce a range of com-\nputationally efficient Earth system models (ESMs) that span a spectrum\nfrom intermediate toward full complexity, and summarise the experiments\nundertaken with them thus far.\n\u2217School of Environmental Sciences, University of East Anglia, Norwich, UK and Tyndall\nCentre, UK. E-mail: t.lenton@uea.ac.uk Tel: +44-1603-591414 Fax: +44-1603-591327\n\u2020National Oceanography Centre, University of Southampton, Southampton, UK and Tyn-\ndall Centre, UK\n\u2021Southampton e-Science Centre, University of Southampton, Southampton, UK\n\u00a7School of Geographical Sciences, University of Bristol, Bristol, UK\n\u00b6Frontier Research Centre for Global Change, Yokohama, Japan\n\u2016Centre for Earth, Planetary, Space and Astronomical Research (CEPSAR), Earth Sci-\nences, Open University, Milton Keynes, UK\n\u2217\u2217Centre for Ecology and Hydrology, Wallingford, UK\n\u2020\u2020Tyndall Centre, UK and School of Physics and Astronomy, University of Leeds, Leeds,\nUK\n1\n1 Components and models\nHere, for each of the major components of the Earth system we discuss the ap-\npropriate modelling approaches for our goals and introduce the corresponding\nmodel(s) that have been included thus far within the GENIE framework. The\ncomponents, models, and their notation are summarized in Table 1. As a rule,\nwe have taken component models that already exist in the published literature\nand have developed them as necessary. Each of the physical components in-\nterfacing at the Earth\u2019s surface \u2013 atmosphere, ocean, sea-ice, land, ice-sheets \u2013\ncan be substituted by a fixed boundary condition (static or time-varying). For\ncompleteness we introduce all currently available components here, thus there\nis some overlap with the main article.\n1.1 Atmosphere\nThe atmosphere is the component of the Earth system with the shortest intrinsic\ntimescale. Therefore, if the full primitive equations are to be solved, a relatively\nshort time-step is required (about half an hour to an hour, depending on the\nmodel resolution). Hence fast Earth system models have traditionally made\nsimplifications to these primitive equations, for example the quasi-geostrophic\napproximation employed in the EcBilt model (Opsteegh et al., 1998). Alterna-\ntively they have done away with a dynamical atmosphere altogether in favour\nof an energy-moisture balance approach, as in the UVic model (Weaver et al.,\n2001), or a statistical-dynamical approach as in CLIMBER-2 (Petoukhov et al.,\n2000). Simplifications such as these mean that model predictions, for example\nof heat transport by eddies, may be inaccurate. Furthermore, aspects of the\natmosphere\u2019s structure have to be prescribed, including winds in the energy-\nmoisture balance model. However, to achieve large ensemble integrations over\nmulti-millennial timescales, the only practical approach is still to use a reduced-\ncomplexity atmosphere. Therefore, we currently have two different atmospheric\nmodels available in the GENIE framework \u2013 a primitive-equation model, and a\nfast energy-moisture-balance model. Even the more complex, fully dynamical\nmodel is capable of simulating 1,000 years in under a week on a single CPU, but\nthe simpler model is two orders of magnitude faster. In the future we envisage\nusing the two models in combination, with the dynamical atmosphere generating\nthe wind field that is prescribed in the energy-moisture balance model.\n1.1.1 IGCM\nThe Reading Intermediate General Circulation Model (IGCM3.1) has as its adi-\nabatic core the 3-D spectral primitive equation model of Hoskins and Simmons\n(1975). We use a default horizontal resolution of T21 with 7 vertical levels. It\nis easy to change the model resolution, and we have begun exploring T10 and\nT42 horizontal resolutions and 5 and 22 vertical levels. The convection scheme\nof Tiedke (1993) has been included as an option, because of poor modeled\nconvective precipitation in the original convective adjustment scheme of Betts\n(1986). For more details see the main article.\n2\n1.1.2 Energy-Moisture-Balance Model (EMBM)\nThe EMBM is a single-layer, 2-D model, comprising diffusive-advective trans-\nports of heat and moisture in the atmospheric boundary layer, similar to Weaver\net al. (2001). Climatological annual-mean (Edwards and Marsh, 2005) or monthly-\nmean (Lenton et al., 2006) wind fields are prescribed. Latitudinal profiles of heat\ndiffusivity and moisture diffusivity are specified as external inputs. Albedo is\ntreated as a zonal planetary mean (Edwards and Marsh, 2005) or separated\ninto surface and atmosphere\/cloud components, the latter treated as monthly\nmeans (Lenton et al., 2006). Typically, the EMBM is implemented at an iden-\ntical horizontal resolution to the underlying ocean and land surface and it takes\nfive implicit timesteps per ocean timestep. See Edwards and Marsh (2005)\nand Lenton et al. (2006) for further details.\n1.2 Atmospheric tracers\nAtmospheric tracers are effectively a sub-component of the atmosphere. In\nfuture we plan to include an atmospheric chemistry module.\n1.2.1 ATCHEM\nA simple module \u2018ATCHEM\u2019 is currently used for storing the concentration of\natmospheric gases \u2013 CO2, CH4, N2, N2O, O2, H2S, CFC-11 and CFC-12 as well\nas the relevant isotopic properties (\u03b413C, \u03b414C, \u03b415N, \u03b418O, \u03b434S). The storage\narray has the same resolution as the EMBM including a single vertical level.\nCurrently, ATCHEM assumes the atmosphere is well mixed and homogenizes\nthe chemical composition at each time-step. Future extensions will allow the\natmosphere to modify the distribution of concentrations.\n1.3 Ocean\nOcean models used for Earth system modelling should ideally be integrated long\nenough to reach an equilibrium state of the large-scale thermohaline circulation\n(THC). The THC is strongly affected by diapycnal mixing in the deep ocean,\nat low latitudes in the Indo-Pacific and at mid\/high latitudes in the Southern\nOcean. Diapycnal diffusivity in many parts of the deep ocean is small, and\nthis mixing process occurs on a millennial timescale. In \u201ctraditional\u201d general\ncirculation models (GCMs) of the global ocean, based on the primitive equa-\ntions, time-steps of typically 1 day at low resolution (3-4\u25e6) lead to integration\ntimes of around 100 years per day - e.g., the CLIO model (Opsteegh et al.,\n1998). Hence several weeks of computing are required to reach THC equilib-\nrium. Consequently, equilibrium studies of the THC are limited to just a few\nexperiments in each instance and the sensitivity of simulated THC to model\nboundary conditions and\/or key parameters cannot be easily established.\nAlternative, faster approaches have been developed. For some time, a leading\nexample has been the Hamburg \u201cLarge Scale Geostrophic\u201d (LSG) model (Maier-\nReimer et al., 1993), which has longer but more computational expensive time-\nsteps of 1 month at 3.5\u25e6 horizontal resolution (with 11 vertical levels). The\nLSG model was initially used for tracer studies (Maier-Reimer, 1993), but has\nsince been coupled with atmospheric GCMs of varying complexity (ECHAM,\nPUMA) Prange et al. (2003).\n3\nSomewhat simpler, but several orders of magnitude more efficient, is a\nzonally-averaged 2.5-D ocean model (Wright and Stocker, 1991) which repre-\nsents the dynamics of the THC in three basins (Pacific, Atlantic, Indian) inter-\nconnected by a circumpolar Southern Ocean. Crucially, the east-west pressure\ngradient (which supports a meridional overturning circulation) is parameterized\nin terms of the meridional pressure gradient. This invokes implicit assump-\ntions regarding the circulation state which may be questioned if appropriate\n3-D simulations are not available for calibration purposes. Despite this struc-\ntural simplification, THC states are obtained which compare well with those\nsimulated by 3-D models and large ensembles of multi-millennial integrations\nare feasible (Knutti et al., 2002). The 2.5-D ocean model is used in the Bern\n2.5-D model (Joos et al., 1999) and in CLIMBER-2 (Petoukhov et al., 2000).\n1.3.1 GOLDSTEIN\nA fast, intermediate complexity, 3-D frictional geostrophic model with linear\ndrag, GOLDSTEIN (Global Ocean Linear Drag Salt & Temperature Equation\nIntegrator) is used in GENIE. A coarse (18x18x8) resolution global version with\nidealised geometry (rectangular ocean basins), was first used for exploratory\nstudies (Edwards and Shepherd, 2002) and for model development and testing\n(e.g. incorporation of marine biogeochemistry). This was extended to incorpo-\nrate eddy-induced and isopycnal mixing following Griffies (1998) and to solve\ncorrectly for the flow around islands by Edwards and Marsh (2005). The linear\nmomentum balance of GOLDSTEIN is marginally simpler than that of the LSG\nmodel, allowing for a local inversion of the baroclinic velocity field. Both models\nare very similar to GCMs in their nonlinear treatment of tracer dynamics.\nWithin the GENIE framework, two different grid types and a range of hori-\nzontal and vertical resolutions of GOLDSTEIN are currently available (Table 2).\nAs well as the grids and resolutions used in the main paper, an \u201cequal latitude\u201d\n(36x60x8) version has been developed, on the longitude versus latitude horizon-\ntal grid, which retains similar equatorial resolution to the \u201cbaseline\u201d resolution,\nand is intended for studies using more realistic sea-ice. It is easy to vary the\nnumber and spacing of depth intervals and the horizontal grid can be readily al-\ntered using Matlab-based tools that allow users to generate arbitrary resolution\ngrids, and non-modern continental configurations. A suite of ocean topogra-\nphy files to represent changing continental and basin configurations through the\nPhanerozoic (based on PALEOMAP project reconstructions) is in preparation.\nAt baseline resolution the model explicit timestep is around 3.5 days. A version\nwith implicit timestep also exists.\n1.3.2 Slab ocean\nThe IGCM3.1 originally included a thermodynamics-only ocean, which has been\nseparated out as a \u201cslab\u201d ocean component. The default thickness of the slab\nis 25m. The temperature evolution of the surface is determined by the net la-\ntent, sensible, short-wave, and long-wave surface fluxes, and an implied ocean\nheat-flux term. The ocean heat-flux term is calculated in a prior calibration\nintegration, as being that flux which results in SSTs equivalent to a given cli-\nmatology.\n4\n1.4 Sea-ice\nMany Earth system models in current use feature the simple sea-ice thermody-\nnamics of Semtner (1976), following Hibler (1979), e.g. EcBilt\/CLIO (Opsteegh\net al., 1998), CLIMBER-2 (Petoukhov et al., 2000), and the McGill Paleocli-\nmate Model (Wang and Mysak, 2000). An exception is the UVic Earth System\nClimate Model (ESCM), which includes several options for more sophisticated\nrepresentation of sea ice thermodynamics and thickness distribution, includ-\ning full rheology, ice thickness distribution and multi-layer thermodynamics\n(Weaver et al., 2001). The computational expense of any 2-D sea ice scheme is\nsmall compared to 3-D ocean and atmosphere models, although the degree of\ncomplexity has implications for the realism of simulated sea ice distributions,\nespecially in the Arctic where sea ice prevails throughout the year under present\nclimate and rheology is important. The GENIE framework includes a recently\nmodularised sea ice model allowing different levels of complexity in both the\ndynamics and thermodynamics, and an alternative slab sea-ice model.\n1.4.1 Dynamics: EVP \/ Free drift \/ Ocean advection\nThere are three options for sea-ice dynamics. The most advanced is a model\nwith Elastic-Viscous-Plastic (EVP) rheology (Hunke and Dukowicz, 1997) and\na sub-cycling procedure for ice dynamics (Hunke, 2001). EVP dynamics is only\nappropriate if using higher resolution at high latitudes. A more computation-\nally efficient alternative is the free-drift mode with the internal ice stress in\nthe ice momentum balance equation set up to zero, as used in C-GOLDSTEIN\n(Edwards and Marsh, 2005). For both these options, the dynamical coupling be-\ntween the ice and ocean occurs through the interfacial drag stress with McPhee\u2019s\nquadratic dependence on the shear velocity (Hunke and Zhang, 2001). Ice trans-\nport is calculated using either explicit or implicit advection schemes. The third\nand simplest option advects ice by the surface ocean currents with some hori-\nzontal ice diffusion. Here the wind stress is applied directly to the ocean surface.\nFor all options, ice thickness and ice fractional coverage of each ocean cell are\nprognostic variables. If there is snow on the ice it is included in the momentum\nbalance and transport calculations producing snow depth and snow fraction\nprognostic fields. There is also a simple scheme to account for land-fast ice\nappearance; if ice is thicker than the ocean depth available it is grounded. This\nshould be useful in snowball Earth simulations.\n1.4.2 Thermodynamics: Snow-ice \/ Ice-only\nThermal evolution of sea ice is simulated using either snow-ice thermodynamics\nor a simple ice-only thermal balance model. The former follows Semtner (1976),\nwhereas the latter was used in C-GOLDSTEIN (Edwards and Marsh, 2005). In\nboth models, ice slab grows vertically and can be formed in the open ocean. In\nthe ice-only model, all precipitation is added directly to the ocean as freshwater.\nIn the snow-ice model, snow cover is accumulated on top of the ice as the surplus\nof precipitation over evaporation. It melts if the surface temperature is above\nthe melting point, or if the sea-ice is flooded by water above the melting point.\nIf snow is too thick and ice is submerged under the snow load, then to reach\nhydrostatic balance the excess snow is converted into ice. During the conversion\nno salt or heat exchange between sea-ice and ocean occur. In both models sea ice\n5\nalbedo is taken as a function of surface air temperature (Holland et al., 1993).\nIn the snow-ice model, the snow albedo has two different values for freezing and\nmelting conditions at the surface. Neither snow nor ice has any thermal inertia\nand they are assumed to be fresh. The salt or fresh water is added to the upper\nlayer of the ocean when ice volume increases or decreases or snow melts.\n1.4.3 Slab sea ice\nA very simple slab sea ice model has been separated from the IGCM. This\nis equivalent to the slab ocean component (see section 1.3.2), but with a slab\nthickness of 2m, and changes to the heat-capacity and albedo. In addition, there\nis the option to limit the implied ocean heat-flux term. For paleo simulations,\ntuning has indicated that in order to get a reasonable (defined here as being\nsimilar to that predicted by the HadSM3 model) simulation of modern, pre-\nindustrial, and LGM sea-ice area, it is necessary to limit the implied ocean heat\nflux for sea-ice to have an absolute value less than 50Wm\u22122.\n1.5 Ocean biogeochemistry\nOcean biogeochemistry is effectively a sub-component of the ocean, because the\ndissolved chemical compounds created and transformed by marine organisms\nare subject to advection by ocean physics. A minimal set of tracers; dissolved\ninorganic carbon (DIC), alkalinity (Alk), plus one major nutrient - phosphate\n(PO4) or nitrate (NO3) - is required to capture the carbon cycle to a first ap-\nproximation. EMICs that include marine biogeochemistry generally have this\nbasic set of tracers, with the generic nutrient (usually PO4) subject to Michaelis-\nMenten uptake in the surface ocean or restoration toward observations. Excep-\ntions include the UVic model and CLIMBER-2, which now have more complex\nNutrient Phytoplankton Zooplankton Detritus (NPZD) schemes, following Six\nand Maier-Reimer (1996). The GENIE framework has yet to include explicit\nmarine biology, however we do include a very broad range of marine biogeo-\nchemical tracers. At run time the user can select a subset of these (without the\nneed to recompile), with un-selected tracers excluded from calculation in order\nto limit the computational burden. The selection is automatically checked for\nself-consistency at run time.\n1.5.1 BIOGEM\nA marine biogeochemical model \u201cBIOGEM\u201d has been developed based on the\nscheme from an existing 2.5-D model (Ridgwell, 2001). BIOGEM handles the\nbiological and chemical transformation (and physical sinking of solid materials)\nof a wide range of chemical species (tracers), whilst the ocean circulation model\ntransports them in 3 dimensions by advection, diffusion, and convection, in the\nsame way as temperature and salinity. The pre-defined and selectable tracers in\nBIOGEM include: DIC, PO4, Alk, O2, NO3, H4SiO4 (silicic acid), Fe, DOM C\n(carbon in dissolved organic matter), DOM N, DOM P, and DOM O2. For ad-\ndressing the biogeochemistry of low oxygen environments, CH4, NH3, N2O, and\nN2 are defined as additional tracer options, while transformations between SO4,\nH2S are already explicitly included (Ridgwell et al., 2006a). Other selectable\n6\ntracers include; Ca, B, and F (for more explicit carbonate chemistry represen-\ntations), an iron-binding ligand, trace metals of relevance to paleoceanography\n(e.g. Cd, Ge), and diagnostic tracers of ocean mixing (SF6, CFC-11, CFC-12)\nand particulate fluxes (230Th, 231Pa). The isotopes of various tracer species are\ntracked enabling the calculation of: \u03b413C, \u03b414C, \u03b415N, \u03b418O, \u03b430Si, and \u03b434S iso-\ntopic properties. Associated with many of the dissolved tracers are particulate\n(solid) ones, for instance; particulate organic carbon (POC) which is associated\nwith DIC, or calcium carbonate (CaCO3) which is associated with both DIC\nand ALK.\nBiological uptake in the surface layer of the ocean has thus far been based\naround a single nutrient (PO4) limitation of biological production, although we\nnow have the scope to incorporate co-limitation by a range of nutrients. Both\na phosphate restoring scheme (either towards observations or zero) (Cameron\net al., 2005) and Michaelis-Menten type kinetics (Ridgwell et al., 2006a) have\nbeen used. Air-sea gas exchange fluxes are calculated as explicit functions of\nwind speed using gas solubility coefficients and gas transfer velocities that de-\npend on environmental conditions, following Wanninkhof (1992).\nBIOGEM calculates the redistribution of tracer concentrations due to bio-\nlogical uptake of dissolved species in the surface ocean, sinking of particulate\nspecies, and their remineralisation (due to metabolic and dissolution processes)\nback to dissolved species at depth. This sequence of processes occurs rapidly\nrelative to transport by the large-scale circulation of the ocean. An array stores\nthe concentration of suspended and settling solids throughout the ocean. This\nallows the option of either parameterizing instantaneous redistribution of dis-\nsolved tracers due to prescribed remineralisation profiles (the default), or explic-\nitly calculating sinking speeds and the transfer of solids between depth layers.\nThe fractionation between carbon and nutrients and between different isotopes\nas particles sink through the water column can be represented (although by de-\nfault we assume no fractionation during remineralisation). The residual flux of\nparticulate matter that escapes remineralisation and reaches the sea floor either\nprovides input to the sediment module, or if that is not selected, is completely\nremineralised and dissolved constituents returned to the overlying ocean.\n1.6 Marine sediments\nThe circa 10,000 year adjustment time of marine sediment composition is too\nlong for ocean-sediment processes to be included in most 3-D ocean carbon cycle\nmodels. Hence the majority simply return all settling material that reaches the\nocean floor instantaneously back to the ocean. Some groups have undertaken\noff-line studies in which a pre-calculated, fixed ocean circulation field provides\ninput to a sediment model, e.g. (Archer et al., 2000). However, this does not\nallow feedbacks via atmospheric CO2 and climate to be accounted for. A sed-\niment model (Archer, 1991) has recently been coupled to the zonally-averaged\n(2.5D) ocean of CLIMBER-2. However, testing such a model against data is\nproblematic because the substantial zonal heterogeneity in the observed sedi-\nment composition cannot be captured (Ridgwell, 2001). This problem is even\nmore acute in box models. The GENIE framework interactively couples ma-\nrine sediments to a 3-D ocean and marine biogeochemistry. The sediments are\ntreated as an optional module, which resides under the ocean and exchanges\nmatter of various types with the ocean biogeochemistry module (Ridgwell and\n7\nHargreaves, 2006). A separate sediment module is assigned to each ocean grid\npoint.\n1.6.1 SEDGEM\nThe sediment module, SEDGEM (for; SEDimentGEochemical Model), is based\non the scheme of Ridgwell (2001). Sediments comprise of a single surface layer\nunderlain by a stack of storage layers. The surface layer represents the zone in\nwhich bioturbation effectively homogenizes solid composition with depth and\nwhere the primary diagenetic processes (such as carbonate dissolution) take\nplace. The storage layers provide a synthetic proxy record of biogeochemical\nand climate changes occurring in the ocean and can be contrasted directly to\npaleoceanographic cores (Ridgwell, 2001). A diffusive-like transfer is prescribed\nto represent the vertical mixing of solids due to biological activity at depths\nbelow the surface layer.\nCurrently, we consider the preservation of calcium carbonate (CaCO3) (fol-\nlowing Archer (1991)) and opal (following Ridgwell et al. (2002)) as well as a\nrefractory (detrital phase). However, only the preservation of CaCO3 in GENIE\nhas been formally described and characterized to date (Ridgwell and Hargreaves,\n2006). Work is underway incorporating as a user-selectable option the diagenetic\nmodel of Archer et al. (2002) (MUDS), which will allow the explicit prediction\nof organic carbon preservation (and burial). A variety of properties of solids\nare also tracked in the sediment module \u2013 currently, \u03b413C and \u03b414C as well as a\nnumerical age of sedimenting carbonate (Ridgwell, 2001).\n1.7 Land surface physics and biogeochemistry\nIn principle, schemes for land-surface physics (dealing with energy and water)\nand biogeochemistry (dealing with carbon, nutrients and potentially vegetation\ndynamics) can be considered as separate components. In reality, however, they\nare intertwined because the fluxes of water, associated latent heat and carbon\nfrom the vegetated land-surface occur through the same plant-leaf stomata.\nOpening and closing of stomata is tied to photosynthesis with vegetation acting\nto maximize carbon uptake while minimizing water loss. A separation can be\nmaintained by treating photosynthesis and stomatal behavior as part of the land\nsurface physics and treating the corresponding photosynthetic carbon flux as an\ninput to land surface biogeochemistry and vegetation dynamics. In practice\nthis means treating the biogeochemistry and any vegetation dynamics as a sub-\ncomponent of the land surface physics. This is the approach taken by e.g. the\nHadley Centre in the separation of the MOSES land surface physics scheme\nand TRIFFID dynamic global vegetation model (DGVM). We follow this with\na simplified version of MOSES, plus TRIFFID as a sub-component. We have\nalso developed an Efficient Numerical Terrestrial Scheme (ENTS) in which land-\nsurface physics and biogeochemistry are combined. Finally, we have separated\nthe land surface physics scheme from the IGCM. Other EMICs typically have\nland surface physics based on simple bucket models, or the biosphere-atmosphere\ntransfer scheme (Dickinson et al., 1986). To this they often add VECODE\n(Brovkin et al., 1997).\n8\n1.7.1 GENIE-land \/ Fast MOSES\nThe GENIE-land surface scheme is based on a simplified version of the MOSES\nland-surface scheme (Cox et al., 1999) similar to that being used by the UVic\ngroup (Meissner et al., 2003, Matthews et al., 2004). It allows a longer time step\nthan full MOSES (typically the same as the atmospheric time step, i.e. around\n6 hours rather than 30 minutes), by excluding fast processes (e.g. canopy inter-\nception, separation of fast and slow runoff) and correcting for the local sunlit\nday length rather than resolving the diurnal cycle. Leaf-level photosynthesis is\ncalculated for 5 plant functional types (PFTs; broadleaf and needle-leaf trees,\nC3 and C4 grasses, and shrubs) as a function of near-surface climate and vegeta-\ntion state (Collatz et al., 1991, Collatz et al., 1992). Like MOSES, GENIE-land\nis a tiled scheme in which the surface energy budget is calculated separately\nfor 7 tile types (5 PFTs, bare soil, and land-ice). The grid-box representative\noutput fields required by other GENIE components are derived internally by\nGENIE-land from the tiled values. Land-surface hydrology, including snow-\nmelt, soil moisture change and runoff, are calculated at the grid-box rather\nthan the tile level. An energy conserving parameterisation of snow is based\naround the sub-surface temperature, with precipitation falling as snow below\na threshold temperature, and snow-melt occurring when the ground heat flux\nwould raise the sub-surface temperature above a threshold of 0\u0089. This provides\na delay to the spring warming of high-latitudes by accounting for the energy\nused in water phase change. Tile albedos are a function of snow depth and\naccount for masking of snow by tall vegetation. Runoff is routed to the ocean\nusing pre-defined destinations, which are currently based on the TRIP routing\ndata (Oki and Sud, 1998).\n1.7.2 TRIFFID\nThe full TRIFFID model from the Hadley Centre (Cox, 1998) captures vege-\ntation dynamics and carbon storage in vegetation and soil. It allows 5 PFTs\nto grow and compete for the available space based on the accumulated carbon\nfluxes calculated by GENIE-land and a Lotka-Volterra approach to competition\nbetween the PFT populations.\n1.7.3 ENTS\nThe Efficient Numerical Terrestrial Scheme (ENTS) is a minimal representation\nof land surface physics, hydrology and carbon cycling for use in a spatial con-\ntext (Williamson et al., 2006). The model does not distinguish between plant\nfunctional types. Instead ENTS has a single pool of vegetation carbon at each\nland grid point which feeds a single pool of soil carbon through carbon fluxes\nof leaf litter. These land carbon pools are connected to atmospheric carbon\ndioxide through photosynthesis, plant respiration and soil respiration.\nA simple bucket model is used to represent hydrology. In each grid cell the\nbucket is filled by precipitation and emptied by evaporation. If the bucket is\nfilled beyond its capacity the excess is transported to the ocean as runoff. The\nphysical properties in the model such as soil water and land temperature are\ntightly linked to the state of the biosphere and vice-versa. For example moisture\nand heat fluxes are determined by the roughness of the surface which is in turn\ndetermined by the amount of vegetation. Land surface albedo, affecting the\n9\nabsorption of solar radiation, is a function of the vegetation and soil carbon\ndensities, denser vegetation causing more radiation to be absorbed. The field\ncapacity of the water buckets is controlled by the amount of soil carbon. Greater\ndensities of soil carbon act like a sponge enabling the land to hold more water.\nENTS also has a very simple snow scheme to capture the dominant albedo\neffect. A grid cell is set to snow albedo (taking into account vegetation) when\nprecipitation falls and the air and land temperatures are below critical values.\nThe snow persists until one of the temperatures rises above the critical value.\nIn the GENIE framework solar insolation is prescribed as a diurnal average.\nThis enables an efficient solution to the land radiation balance by calculating\nfor the steady state. With this approximation ENTS can be coupled to the\natmosphere at the same frequency as the ocean.\n1.7.4 IGCM-land\nThe IGCM-land module was originally an integral part of the IGCM, as de-\nscribed in de Forster et al. (2000). In brief, it parameterises the surface energy,\nmoisture, and momentum fluxes as a function of, respectively, temperature,\nmoisture, and velocity vertical gradient. It also uses a bucket representation of\nsoil-moisture, and parameterises changes in albedo related to snow cover. Some\nminor changes to the original scheme have been made so that it rigorously con-\nserves energy and water.\n1.8 Ice sheets\nIce sheet modelling poses a horizontal resolution challenge for Earth system\nmodelling. Important physical processes that determine the evolution of the\nice sheet tend to occur in small regions \u2014 examples of this are the melting\nof ice in a narrow margin at the edge of an ice sheet, and the formation of\nmountain glaciers, which can potentially lead to large-scale glacial inception.\nIn both cases, the scales involved are in the tens of km. Traditionally, ice\nsheet modelling in an Earth system context has been done on a global latitude-\nlongitude grid. However, with this approach, it is hard to generate the required\nresolution, as well as being potentially inefficient (since only limited regions are\ngenerally ice-covered), especially if a uniform resolution is used. To address\nthis issue, we have coupled a regional ice model (GLIMMER) into the GENIE\nframework. Other ice sheet models have been coupled to EMICs, ranging from\nzonally-averaged models (Gallee et al., 1992) to 3-D models (Calov et al., 2005).\n1.8.1 GLIMMER\nGLIMMER is based on an existing ice sheet model (Payne, 1999). It uses\na projected grid scalable over 20-100+ km grid cells. The time steps (years\nto decades) are longer than other components. Different levels of physics are\navailable; mass balance calculations using energy balance and day-degree cal-\nculations; coupled ice flow, thermodynamics and ice-thickness evolution; and\nisostasy. Isostasy along with a simple parameterization of sliding is necessary\nfor glacial-interglacial simulations and, in particular, work on Heinrich events.\nThe code uses quasi-object-oriented techniques in Fortran 95 to allow the model\n10\nto be run as multiple instances over different regions of the globe. Thus the indi-\nvidual ice sheets of the world (Greenland, Antarctica, Laurentide, Scandinavian\netc) can be modeled on separate, local grids and the need for high-resolution\nglobal coverage is avoided.\n2 Coupling and Software\nThe GENIE framework couples the components described above in a modular\nfashion, such that they can be readily interchanged at compilation time. Differ-\nent resolutions of a particular component model are treated as different instances\nof that component. Spatial grids and masks can differ between components, in\nparticular the atmosphere, ocean, and sea-ice, because they have been derived\nfrom different sources. To interpolate between the different grids, we currently\nuse a simple bilinear interpolation routine. In regions where there is a mismatch\nin land-sea mask, we extrapolate from the nearest neighbor. This process is in\ngeneral non-conservative, so after interpolation we apply a correction factor in\nthe tropics (30\u25e6S to 30\u25e6N) to ensure conservation of energy and moisture.\nAt present the default approach to component coupling is a master Fortran\nroutine with a number of compilation time switches and a corresponding suite\nof configuration files to set up different Earth system models. We are currently\nexploring other software approaches to flexible coupling, which will be described\nin separate publications. Achieving full modularity poses considerable scientific\nand technical challenges \u2013 for example in reconciling the different time-stepping\nof atmosphere, ocean and sea-ice routines that is inherent in the parent models\nwe are modularising. This represents ongoing work, in that not all possible com-\nbinations of the modules we have described are currently available and working.\nFurthermore, the modularization of ENTS is still in progress.\nThe GENIE framework is intended to be sufficiently generic that alterna-\ntive models for any given component can be included. In practice, this means\nthat we must define the quantities exchanged at each interface between com-\nponents. We subdivide the interfaces between components of the Earth system\ninto \u201cphysical\u201d (energy, momentum, water, salt) and \u201cbiogeochemical\u201d (carbon,\nnutrients, dust). Most existing studies have only considered physical couplings,\nfurthermore, biogeochemical couplings generally depend on information from\nthe physical couplings but not vice versa. Thus a purely physical coupling of\nvarious instances of Earth system model (with fixed biogeochemistry) should be\nachievable.\nProposals for standard physical interfaces for GCM modelling have been put\nforward for Atmosphere\u2013Ocean\u2013Sea-ice coupling by PRISM (the PRogram for\nIntegrated Earth SystemModelling) (Guilyardi et al., 2002), and for Atmosphere\u2013\nLand-surface coupling by PILPS (the Project for Inter-comparison of Land sur-\nface Parameterisation Schemes) (Polcher et al., 1998). These provide useful\noverviews of the key scientific and technical issues, and are providing the basis\nfor our ongoing modularisation work.\nFor the biogeochemical interfaces, no prototype standard exists hence we\nhave started to develop one. To maximize overall computational speed, the\nexchange of biogeochemical tracers between surface sediments (SEDGEM) and\noverlying ocean (BIOGEM) is carried out asynchronously, with the composition\nof deep-sea sediments and the return dissolution flux to the ocean re-calculated\n11\nat a longer time-step (by default, 1 year) than ocean circulation and biogeo-\nchemistry. This coupling is handled by an interfacing module which integrates\nthe sediment rain flux over the SEDGEM time-step before it is added to the\nsurface sediment layer. In the opposite direction, the sediment dissolution flux\nsupplied to the ocean is assumed constant for the duration of the SEDGEM\ntime-step. The interfacing module also enables simple transformations between\ndifferent grid resolutions, allowing us to use a finer grid for the sediments than\nthe ocean circulation (Ridgwell and Hargreaves, 2006).\n2.1 Software tools\nThe GENIE framework is developed by a team of researchers spread over many\ninstitutions. Several software development tools and approaches have been key\nto making this effort coordinated and efficient. A single, central source code\nrepository is used, maintained using a version control system \u2013 the open source\nConcurrent Version System (CVS). This enables developers to keep their copy\nof the source code up to date with other developers changes and so avoid the\npitfalls of inconsistent versions. CVS provides the ability to view differences\nbetween versions of the source code (and a log of the changes). When used in\nconcert with frequent testing, this provides a means to rapidly track down and\ncorrect coding bugs.\nIn line with good software engineering practice, we have adopted a policy of\nfrequently testing the source code during development. We test for water con-\nservation, restarts, and the integrity of model runs relative to a suite of standard\nsimulations. To make testing as easy as possible, we have created an integrated\nbuild and test system, stored alongside the source code in the repository. This\nis particularly challenging for a model which embodies sensitivity to initial con-\nditions and is developed by researchers working with different compilers and\nhardware architectures. It is worthwhile because it facilitates rigorous quality\ncontrol.\nA Matlab graphical user interface (GUI) called \u201cAladdin\u201d allows the novice\nuser to generate multiple configuration files and then writes a master script to\nsubmit model ensembles to Grid computing resources.\n2.2 Tuning methods\nA substantial part of the workload in the creation of a model must be devoted to\ncalibrating or tuning model parameters. Often, the physically correct parameter\nvalues are not known with much precision, and furthermore, minor missing\nprocesses in the model may lead to modest biases (eg in overall energy flux)\nwhich it can be desirable to tune out in order for the model to simulate a\nreasonable climatological state. The nonlinear and multivariate relationship\nbetween parameters and model climate makes model tuning a challenging task,\nand the implementation and development of tuning and estimation techniques\nhas proceeded in step with the model development.\nA multi-parameter Latin hypercube exploration of 12-dimensional parameter\nspace is described by Edwards and Marsh (2005). A variety of alternative\napproaches using the Design Search and Optimization package OPTIONS are\ndescribed by Price et al. (2006b). These include the application of a Kriging\nmeta-model (Keane, 2003) and the use of a Genetic Algorithm (Michalewicz,\n12\n1992) to locate minima in 12- and 30- dimensional parameter space respectively.\nAn implementation of the non-dominated sorting genetic algorithm (NSGA-II)\n(Deb et al., 2002) has been used to perform a multi-objective tuning of GENIE\nmodels (Price et al., 2006a). A novel, computationally cheap approach has\nalso been developed by Hargreaves et al. (2004) and Annan et al. (2005b),\nbased on the ensemble Kalman filter (Evensen, 2003). This relies on a linear\napproximation to the error covariances. Nevertheless, the method seems to\nwork well in the presence of significant nonlinearity. Finally, a proximal analytic\ncentre cutting plane method (proximal ACCPM), which is highly efficient for\nscalar processing, is described by Beltran et al. (2005). Using any or all of these\nmethods, it is possible to both tune the model to a best fit and also explore the\nrange of possible outcomes (Annan et al., 2005a, Hargreaves and Annan, 2006).\nA potentially powerful tool for the analysis of climate model stability and\nfeedbacks is the adjoint model, which effectively calculates the derivative of\nthe model response with respect to model parameters. To demonstrate the\nfeasibility of constructing an adjoint for GENIE an adjoint has recently been\nconstructed for the C-GOLDSTEIN configuration (described below) using the\nTAPENADE software, and tested by utilising the calculated gradients to repro-\nduce the ACCPM parameter calibration exercise.\n3 Earth system models and existing studies\nA range of Earth System Models have been constructed (or reconstructed) from\nthe GENIE framework and a range of experiments have been conducted with\nthem (Table 3). The notation system used to specify complete ESMs in the\nGENIE framework is: genie aa oo ss ll ii vv gg dd cc. This is based on the\nlabels for components given in Table 1. Particular models for each component\nhave a 2 letter identifier (Table 1), which is substituted for the relevant label.\nWhere a component is not included at all, that part of the notation is removed.\n3.1 GENIE-1: Simple atmosphere ESMs\nOur starting model was the coupled 3-D ocean (36x36x8 resolution), 2-D at-\nmosphere (EMBM), and 2-D sea-ice (free-drift) model \u201cC-GOLDSTEIN\u201d (Ed-\nwards and Marsh, 2005). We have modularised and recreated this using the\nGENIE framework and have reproduced the original results. The modular ver-\nsion is known as genie ea go gs. C-GOLDSTEIN has been tuned using a variety\nof techniques (see Section 2.2). Distributed computing was used to undertake a\nsystematic search for bistability of the thermohaline circulation (Marsh et al.,\n2004). A large number of simulations were also undertaken for the IPCC Fourth\nAssessment Report. In a separate strand of work, C-GOLDSTEIN has been\ncoupled to a highly simplified global economic growth model (Drouet et al.,\n2005, Drouet et al., 2006) and to MERGE: a much more detailed, sectorial\nmacroeconomic and energy supply sector model (Bahn et al., 2006). In both\ncases C-GOLDSTEIN replaced a highly idealised climate module, resulting in\nan integrated assessment model (IAM) with a much more detailed represen-\ntation of climate dynamics. The consistent representation of climate-economy\nfeedbacks was achieved within an oracle-based overall optimisation approach\n13\n(Drouet et al., 2005) using ACCPM, which nevertheless demanded many cli-\nmate integrations and thus relied heavily on the efficiency of the climate model.\nESMs using the simple EMBM atmosphere are grouped under the heading\n\u201cGENIE-1\u201d. Ocean biogeochemistry (BIOGEM), ocean sediments (SEDGEM),\nand the ENTS land surface and carbon cycle, have all been added to the phys-\nical components of C-GOLDSTEIN. A version with only BIOGEM added has\nbeen used to examine the effect of different ocean circulation states, marine car-\nbon pumps, and climate feedback on atmospheric CO2 (Cameron et al., 2005).\nThe biogeochemistry of this model has been tuned using an EnKF (Ridgwell\net al., 2006a), as has a version with sediments (SEDGEM) added (Ridgwell and\nHargreaves, 2006). The coupling of the ENTS land model necessitated some im-\nprovements to the EMBM, including the addition of seasonality (Lenton et al.,\n2006). With ENTS and BIOGEM together the model has a closed carbon cy-\ncle and has been forced with CO2 emissions in future global change studies\n(Lenton et al., 2006). The more complex GENIE-land surface plus TRIFFID\nhave also been coupled under the EMBM, as in the UVic model (Meissner et al.,\n2003). The physical core of GENIE-1 using ENTS with fixed vegetation cover,\nand prescribed changes in ice sheet cover, orography, orbital forcing and CO2\nhas been used for transient simulations of the last deglaciation (Lunt et al.,\n2006), and recently, the whole of the last glacial-interglacial cycle (Marsh et al.,\n2006). GENIE-1 has also recently been coupled to MERGE to form a detailed,\nconsistent IAM with a closed carbon cycle.\n3.2 GENIE-2: Dynamical atmosphere ESMs\nESMs using the IGCM dynamical atmosphere are grouped under the heading\n\u201cGENIE-2\u201d, because the choice of atmosphere model is the main determinant\nof overall model speed. The IGCM at T21 resolution integrates circa 10 years\nper CPU hour on an AMD 64 bit processor, in contrast to GENIE-1 at baseline\nresolution achieving over 1000 years per CPU hour. The IGCM (T21) in iso-\nlation, i.e. coupled to a fixed ocean, fixed sea-ice and its original land surface\nroutine is known as genie ia fo fi il. This has been tuned using an EnKF (An-\nnan et al., 2005a) and a Genetic Algorithm (Price et al., 2006b). The IGCM has\nbeen asynchronously coupled to GLIMMER and used to study glacial inception\n(Rutt et al., 2005). The IGCM has also been coupled to GOLDSTEIN to create\na fully 3-D ocean-atmosphere model. This has been achieved for a range of sur-\nface grids and ocean resolutions (36x36x8, 72x72x16, 64x32x8). The different\nsea-ice options are available along with GENIE-land or the IGCM\u2019s own land\nsurface scheme. Different variants and resolutions of the fully coupled model are\ncurrently being tuned using different methods. In the main article we undertake\na first large ensemble experiment using different resolutions of GENIE-2.\nAcknowledgement The UK Natural Environment Research Council funded\nGENIE (NER\/T\/S\/2002\/00217) and funds the ongoing GENIEfy (NE\/C515904)\nproject through its e-Science programme. The initial inclusion of BIOGEM and\nthe development of ENTS were funded by the Tyndall Centre, UK. The inclusion\nof an EVP sea ice option, and the development of alternative ocean grids were\nfunded by the NERC Rapid Climate Change project \u201cThe role of the cryosphere\non modulating the THC of the North Atlantic\u201d (Ref. NER\/T\/S\/2002\/00462).\n14\nReferences\nAnnan, J. D., Lunt, D. J., Hargreaves, J. C., and Valdes, P. J. (2005a).\nParameter estimation in an atmospheric GCM using the Ensemble Kalman\nFilter. Nonlinear Processes in Geophysics, 12, 363\u2013371.\nAnnan, J. D., Hargreaves, J. C., Edwards, N. R., and Marsh, R. (2005b).\nParameter estimation in an intermediate complexity earth system model\nusing an ensemble Kalman filter. Ocean Modelling, 8, 135\u2013154.\nArcher, D. E. (1991). Modeling the calcite lysocline. Journal of Geophysical\nResearch (Oceans), 96, 17037\u201317050.\nArcher, D. E., Winguth, A., Lea, D., and Mahowald, N. (2000). What caused\nthe glacial\/interglacial pCO2 cycles. Reviews of Geophysics, 38, 159\u2013189.\nArcher, D. E., Morford, J. L., and Emerson, S. R. (2002). A model of suboxic\nsedimentary diagenesis suitable for automatic tuning and gridded global\ndomains. Global Biogeochemical Cycles, 16(1), GB001288.\nBahn, O., Drouet, L., Edwards, N. R., Haurie, A., Knutti, R., Kypreos, S.,\nStocker, T. F., and Vial, J.-P. (2006). The coupling of optimal economic\ngrowth and climate dynamics. Climatic Change, page in press.\nBeltran, C., Edwards, N. R., Haurie, A., Vial, J.-P., and Zachary, D. S.\n(2005). Oracle-based optimisation applied to climate model calibration.\nEnvironmental Modelling and Assessment, 11, 31\u201343.\nBetts, A. (1986). A new convective adjustment scheme. 1. observational and\ntheoretical basis. Q J R Meteorol Soc, 112, 667\u2013691.\nBrovkin, V., Ganopolski, A., and Svirezhev, Y. (1997). A continuous climate-\nvegetation classification for use in climate biosphere studies. Ecological\nModelling, 101, 251\u2013261.\nCalov, R., Ganopolski, A., Claussen, M., Petoukhov, V., and Greve, R. (2005).\nTransient simulation of the last glacial inception. Part I: glacial inception as\na bifurcation in the climate system. Climate Dynamics, 24(6), 545\u2013561.\nCameron, D. R., Lenton, T. M., Ridgwell, A. J., Shepherd, J. G., and Marsh, R.\n(2005). A factorial analysis of the marine carbon cycle and ocean circulation\ncontrols on atmospheric CO2. Global Biogeochemical Cycles, 19, GB4027.\nChallenor, P. G., Hankin, R. K. S., and Marsh, R. (2006). Towards the\nProbability of Rapid Climate Change. In \u201cAvoiding Dangerous Climate\nChange\u201d. Cambridge University Press, Schellnhuber, H J., Cramer, W.,\nNakicenovic, N., Wigley, T. and Yohe, G (Eds)., Cambridge.\nCollatz, G. J., Ball, J. T., Grivet, C., and Berry, J. A. (1991). Physiological\nand environmental regulation of stomatal conductance, photosynthesis and\n15\ntranspiration: a model that includes a laminar boundary layer. Agricultural\nand Forest Meteorology, 54, 107\u2013136.\nCollatz, G. J., Ribas-Carbon, M., and Berry, J. A. (1992). A coupled\nphotosynthesis-stomatal conductance model for leaves for C4 plants. Aus-\ntralian Journal of Plant Physiology, 19, 519\u2013538.\nCox, P. M. (1998). TRIFFID: A Top-Down Model of Interactive Foliage and\nFlora Including Dynamics. Climate Research Technical Note 86. Technical\nreport, Hadley Centre, UK Met. Office.\nCox, P. M., Betts, R. A., Bunton, C. B., Essery, R. L. H., Rowntree, P. R., and\nSmith, J. (1999). The impact of new land surface physics on the GCM sim-\nulation of climate and climate sensitivity. Climate Dynamics, 15(3), 183\u2013203.\nde Forster, P. M., Blackburn, M., Glover, R., and Shine, K. P. (2000). An\nexaminatation of climate sensitivity for idealised climate change experiments\nin an intermediate general circulation model. Climate Dynamics, 16, 833\u2013849.\nDeb, K., Pratap, A., Agarwal, S., and Meyarivan, T. (2002). A fast and elitist\nmultiobjective genetic algorithm: NSGA-II. Evolutionary Computation,\nIEEE Transactions on, 6(2), 182\u2013197.\nDickinson, R. E., Henderson-Sellers, A., Kennedy, P. J., and Wilson, M. F.\n(1986). Biosphere-atmosphere transfer scheme (BATS) for the NCAR\ncommunity climate model. Technical Report 275, NCAR.\nDrouet, L., Edwards, N. R., Beltran, C., Haurie, A. B., Vial, J.-P., and Zachary,\nD. S. (2005). An Oracle Method to Couple Climate and Economic Dynamics.\nIn \u201dThe Coupling of Climate and Economic Dynamics\u201d. Kluwer, Haurie, A.\nand Viguier, L. (eds)., Dordrecht.\nDrouet, L., Edwards, N. R., and Haurie, A. B. (2006). Coupling climate\nand economic models in a cost-benefit framework: A convex optimization\napproach. Environmental Modelling and Assessment, 11, 101\u2013114.\nEdwards, N. R. and Marsh, R. (2005). Uncertainities due to transport-\nparameter sensitivity in an efficient 3-D ocean-climate model. Climate\nDynamics, 24, 415\u2013433.\nEdwards, N. R. and Shepherd, J. G. (2002). Bifurcations of the thermohaline\ncirculation in a simplified three-dimensional model of the world ocean and\nthe effects of inter-basin connectivity. Climate Dynamics, 19(1), 31\u201342.\nEvensen, G. (2003). The Ensemble Kalman Filter: theoretical formulation and\npractical implementation. Climate Dynamics, 53, 343\u2013367.\nFanning, A. G. and Weaver, A. J. (1996). An atmospheric energy-moisture\nmodel: Climatology, interpentadal climate change and coupling to an\nocean general circulation model. Journal of Geophysical Research, 101,\n16\n15111\u201315128.\nGallee, H., van Ypersele, J.-P., Fichefet, T., Marsiat, I., Tricot, C., and Berger,\nA. (1992). Simulation of the last glacial cycle by a coupled, sectorially\naveraged climate-ice sheet model. Part II: Response to insolation and CO2\nvariation. Journal of Geophysical Research, 97, 15713\u201315740.\nGriffies, S. M. (1998). The Gent-McWilliams skew flux. Journal of Physical\nOceanography, 28, 831\u2013841.\nGuilyardi, E., Polcher, J., Fichefet, T., and Planton, S. (2002). PRISM discus-\nsion paper: a proposal for standard atmosphere\/ocean\/sea ice interfaces.\nHargreaves, J. C. and Annan, J. D. (2006). Using ensemble prediction methods\nto examine regional climate variations under global warming scenarios.\nOcean Modelling, 11, 174\u2013192.\nHargreaves, J. C., Annan, J. D., Edwards, N. R., and Marsh, R. (2004). An\nefficient climate forecasting method using an intermediate complexity Earth\nSystem Model and the ensemble Kalman filter. Climate Dynamics, 23,\n745\u2013760.\nHibler, W. D. (1979). A dynamic thermodynamic sea ice model. Journal of\nPhysical Oceanography, 9, 815\u2013846.\nHolland, D. M., Mysak, L. A., Manak, D. K., and Oberhuber, J. M. (1993).\nSensitivity study of a dynamic thermodynamic sea ice model. Journal of\nGeophysical Research (Oceans), 98, 2561\u20132586.\nHoskins, B. J. and Simmons, A. J. (1975). A multi-layer spectral model and\nthe semi-implicit method. Quarterly Journal of the Royal Meteorological\nSociety, 101, 637\u2013655.\nHunke, E. (2001). Viscous plastic dynamics with the EVP model: Linearization\nissues. Journal of Computational Physics, 170, 18\u201338.\nHunke, E. and Zhang, Y. (2001). Recent Arctic change simulated with\na coupled ice-ocean model. Journal of Geophysical Research, 106(C3),\n4369\u20134390.\nHunke, E. C. and Dukowicz, J. K. (1997). An elastic-viscous-plastic model for\nsea-ice dynamics. Journal of Physical Oceanography, 27(9), 1849\u20131867.\nJoos, F., Plattner, G.-K., Stocker, T., Marchal, O., and Schmittner, A. (1999).\nGlobal warming and marine carbon cycle feedbacks on future atmospheric\nCO2. Science, 284, 464\u2013467.\nKeane, A. J. (2003). Wing optimization using design of experiment, response\nsurface and data fusion methods. Journal of Aircraft, 40(4), 741\u2013750.\n17\nKnutti, R., Stocker, T. F., Joos, F., and Plattner, G.-K. (2002). Constraints\non radiative forcing and future climate change from observations and climate\nmodel ensembles. Nature, 416, 719\u2013723.\nLenton, T. M., Williamson, M. S., Edwards, N. R., Marsh, R., Ridgwell, A. J.,\nPrice, A. R., Shepherd, J. G., Cox, S. J., and The GENIE team (2006).\nMillennial timescale carbon cycle and climate change in an efficient Earth\nsystem model. Climate Dynamics, 26, 687\u2013711.\nLunt, D. J., Williamson, M. S., Valdes, P. J., and Lenton, T. M. (2006).\nComparing transient, accelerated, and equilibrium simulations of the last\n30,000 years with the genie-1 model. Climate of the Past Discussions, 2,\n267\u2013283.\nMaier-Reimer, E. (1993). Geochemcal cycles in an ocean general circulation\nmodel. Preindustrial tracer distributions. Global Biogeochem. Cycles, 7,\n645\u2013677.\nMaier-Reimer, E., Mikolajewicz, U., and Hasselmann, K. (1993). Mean circu-\nlation of the Hamburg LSG OGCM and its sensitivity to the thermohaline\nsurface forcing. Journal of Physical Oceanography, 23, 731\u2013757.\nMarsh, R., Yool, A., Lenton, T. M., Gulamali, M. Y., Edwards, N. R., Shep-\nherd, J. G., Krznaric, M., Newhouse, S., and Cox, S. J. (2004). Bistability of\nthe thermohaline circulation identified through comprehensive 2-parameter\nsweeps of an efficient climate model. Climate Dynamics, 23, 761\u2013777.\nMarsh, R., Smith, M. P. L. M., Rohling, E. J., Lunt, D. J., Lenton, T. M.,\nWilliamson, M. S., and Yool, A. (2006). Modelling ocean circulation, climate\nand oxygen isotopes in the ocean over the last 120,000 years. Climate of the\nPast Discussions, 2, 657\u2013709.\nMatthews, H. D., Weaver, A. J., Meissner, K. J., Gillett, N. P., and Eby, M.\n(2004). Natural and anthropogenic climate change: Incorporating historical\nland cover change, vegetation dynamics and the global carbon cycle. Climate\nDynamics, 22, 461\u2013479.\nMeissner, K. J., Weaver, A. J., Matthews, H. D., and Cox, P. M. (2003). The\nrole of land surface dynamics in glacial inception: a study with the UVic\nEarth system model. Climate Dynamics, 21, 515\u2013537.\nMichalewicz, Z. (1992). Genetic Algorithms + Data Structures = Evolution\nPrograms. AI Series. Springer-Verlag, New York.\nOki, T. and Sud, Y. C. (1998). Design of total runoff integrating pathways\n(TRIP) - A global river channel network. Earth Interactions, 2.\nOpsteegh, J. D., Haarsma, R. J., Selten, F. M., and Kattenberg, A. (1998).\nECBILT a dynamic alternative to mixed boundary conditions in ocean\nmodels. Tellus A, 50, 348\u2013367.\n18\nPayne, A. J. (1999). A thermomechanical model of ice flow in West Antarctica.\nClimate Dynamics, 15(2), 115\u2013125.\nPetoukhov, V., Ganopolski, A., Brovkin, V., Claussen, M., Eliseev, A., Ku-\nbatzki, C., and Rahmstorf, S. (2000). CLIMBER-2: A climate system model\nof intermediate complexity. Part I: Model description and performance for\npresent climate. Climate Dynamics, 16, 1\u201317.\nPolcher, J., McAvaney, B., Viterbo, P., Gaertner, M.-A., Hahmann, A.,\nMahfouf, J.-F., Noilhan, J., Phillips, T., Pitman, A., Schlosser, C. A., Schulz,\nJ.-P., Timbal, B., Verseghy, D., and Xue, Y. (1998). A proposal for a general\ninterface between land surface schemes and general circulation models.\nGlobal and Planetary Change, 19, 261\u2013276.\nPrange, M., Lohmann, G., and Paul, A. (2003). Influence of vertical mixing\non the thermohaline hysteresis: Analyses of an OGCM. Journal of Physical\nOceanography, 33(8), 1707\u20131721.\nPrice, A. R., Jiao, Z., Voutchkov, I. I., Lenton, T. M., Williams, G., Lunt,\nD. J., Marsh, R., Valdes, P. J., Cox, S. J., and the GENIE team (2006a).\nCollaborative study of GENIEfy Earth system models using scripted data-\nbase workflows in a Grid-enabled PSE. In S. J. Cox, editor, Proceedings of\nthe UK e-Science All Hands Meeting 2006, page submitted, Nottingham,\nUK. EPSRC.\nPrice, A. R., Xue, G., Yool, A., Lunt, D. J., Valdes, P. J., Lenton, T. M., Wason,\nJ. L., Pound, G. E., Cox, S. J., and the GENIE team (2006b). Optimisation\nof integrated Earth System Model components using Grid-enabled data\nmanagement and computation. Concurrency and Computation: Practice\nand Experience, page in press.\nRidgwell, A. J. (2001). Glacial-interglacial perturbations in the global carbon\ncycle. Ph.D. thesis, University of East Anglia.\nRidgwell, A. J. and Hargreaves, J. (2006). An efficient Earth System Model of\nGlobal biogeochemical cycling: Regulation of atmospheric CO2 by deep-sea\nsediments. Global Biogeochemical Cycles, page submitted.\nRidgwell, A. J., Watson, A. J., and Archer, D. E. (2002). Modelling the\nresponse of the oceanic Si inventory to perturbation and consequences for\natmospheric CO2. Global Biogeochem. Cycles, 16(10).\nRidgwell, A. J., Hargreaves, J. C., Edwards, N. R., Annan, J., Lenton, T. M.,\nMarsh, R., Yool, A., and Watson, A. J. (2006a). Marine geochemical data\nassimilation in an efficient Earth System Model of global biogeochemical\ncycling. Biogeosciences Discussions, 3, 1313\u20131354.\nRidgwell, A. J., Zondervan, I., Hargreaves, J. C., Bijma, J., and Lenton, T. M.\n(2006b). Significant long-term increase of fossil fuel co2 uptake from reduced\n19\nmarine calcification. Biogeosciences Discussions, 3, 1763\u20131780.\nRohling, E. J., Marsh, R., Wells, N. C., Siddall, M., and Edwards, N. R. (2004).\nSimilar meltwater contributions to glacial sea level changes from Antarctic\nand northern ice sheets. Nature, 430, 1016\u20131021.\nRutt, I. C., Payne, A. J., Lunt, D. J., and Valdes, P. J. (2005). Simulation\nof seasonal snow-cover and glacial inception with GENIE and GLIMMER.\nEOS, 86(52 (Fall Meeting Supplement)), Abstract C12A\u201301.\nSemtner, A. J. (1976). A model for the thermodynamic growth of sea ice in\nnumerical investigations of climate. Journal of Physical Oceanography, 6,\n379\u2013389.\nSix, K. D. and Maier-Reimer, E. (1996). Effects of plankton dynamics\non seasonal carbon fluxes in an ocean general circulation model. Global\nBiogeochem. Cycles, 10, 559\u2013583.\nTiedke, M. (1993). A comprehensive mass flux scheme for cumulus parameter-\nization in large-scale models. Monthly Weather Review, 117, 1779\u20131800.\nWang, Z. and Mysak, L. A. (2000). A simple coupled atmosphere-ocean-sea\nice-land surface model for climate and paleoclimate studies. Journal of\nClimate, 13, 1150\u20131172.\nWanninkhof, R. (1992). Relationship between wind speed and gas exchange\nover the ocean. Journal of Geophysical Research (Oceans), 97(C5), 7373\u2013\n7382.\nWeaver, A. J., Eby, M., Weibe, E. C., Bitz, C. M., Duffy, P. B., Ewen, T. L.,\nFanning, A. F., Holland, M. M., MacFadyen, A., Matthews, H. D., Meissner,\nK. J., Saenko, O., Schmittner, A., Wang, H., and Yoshimori, M. (2001).\nThe UVic earth system climate model: Model description, climatology, and\napplications to past, present and future climates. Atmosphere-Ocean, 39(4),\n361\u2013428.\nWilliamson, M. S., Lenton, T. M., Shepherd, J. G., and Edwards, N. R. (2006).\nAn efficient numerical terrestrial scheme (ENTS) for Earth system modelling.\nEcological Modelling, page in press.\nWright, D. G. and Stocker, T. F. (1991). A zonally averaged ocean model for\nthe thermohaline circulation. Part 1: Model development and flow dynamics.\nJournal of Physical Oceanography, 21, 1713\u20131724.\n20\nTable 1: Components currently available in the GENIE framework and their\nnotation\nComponent Label Model Identifier Reference\nAtmosphere aa IGCM ia de Forster et al. (2000)\nEMBM ea Fanning and Weaver (1996)\nFixed fa\nOcean oo GOLDSTEIN go Edwards and Marsh (2005)\nSlab so de Forster et al. (2000)\nFixed fo\nSea-ice ss Multi-option gs Herein, Edwards and Marsh (2005)\nSlab ss de Forster et al. (2000)\nFixed fs\nLand ll GENIE-land gl Meissner et al. (2003)\nIGCM-land il de Forster et al. (2000)\nENTS el Williamson et al. (2006)\nFixed fl\nIce-sheets ii GLIMMER gi Payne (1999)\nFixed fi\nVegetation vv TRIFFID tv Cox (1998)\nENTS ev Williamson et al. (2006)\nFixed fv\nBiogeochemistry gg BIOGEM bg Herein, Ridgwell (2001)\nSediments dd SEDGEM sd Herein, Ridgwell (2001)\nAtmospheric tracers cc Atchem ac Herein\nTable 2: Grids and resolutions currently available in the GENIE framework.\nComponent\nModel\nResolution\nVariant\nLongitude Latitude Vertical\nCells Res. Cells Res. Levels Topography\nOcean Baseline 36 10\u25e6 36 sin(pi\/36) 8 Yes\nGOLDSTEIN High 72 5\u25e6 72 sin(pi\/72) 16 Yes\nIGCM res. 64 5.625\u25e6 32 5.625\u25e6 8 Yes\nEqual lat. 36 10\u25e6 60 3\u25e6 8 Yes\nAtmosphere Baseline 36 10\u25e6 36 sin(pi\/36) 1 Optional\n2-D EMBM High 72 5\u25e6 72 sin(pi\/72) 1 Optional\nIGCM res. 64 5.625\u25e6 32 5.625\u25e6 1 Optional\nEqual Lat. 36 10\u25e6 60 3\u25e6 1 Optional\nAtmosphere\n3-D IGCM\nBaseline\n(T21)\n64 5.625\u25e6 32 5.625\u25e6 7 Yes\n21\nTable 3: Large experiments undertaken with the GENIE framework. Where\nGOLDSTEIN has been used it was at baseline (36x36x8) resolution, except for\nsome of the experiments described in the main article.\nExperiment Components included Ensemble\nsize (yr)\nReference\naa oo ss ll ii vv gg dd cc\nInitial ea go gs \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 2,400,000 Edwards and Marsh (2005)\nBistability 1 ea go gs \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 38,440,000 Marsh et al. (2004)\nEnKF 1 ea go gs \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 1,188,000 Annan et al. (2005b)\nEnKF 2 ea go gs \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 1,944,000 Hargreaves et al. (2004)\nEnKF 3 ea go gs \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 972,000 Hargreaves and Annan (2006)\nKrig tuning ea go gs \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 246,000 Price et al. (2006b)\nMeltwater ea go gs \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 512,000 Rohling et al. (2004)\nEmulator 1 ea go gs \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 10,000 Challenor et al. (2006)\nEmulator 2 ea go gs \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 10,800 McNeall et al., in prep.\nIAM 1 ea go gs \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 84,600 Drouet et al. (2005)\nIAM 2 ea go gs \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 3,955,200 Drouet et al. (2006)\nIAM 3 ea go gs \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 106,400 Bahn et al. (2006)\nIPCC AR4 ea go gs \u2013 \u2013 \u2013 \u2013 \u2013 \u2013 22,897,890 in prep.\nFactorial ea go gs \u2013 \u2013 \u2013 bg \u2013 ac 4,895,000 Cameron et al. (2005)\nCalcification ea go gs \u2013 \u2013 \u2013 bg \u2013 ac 648,000 Ridgwell et al. (2006b)\nAcidification ea go gs \u2013 \u2013 \u2013 bg \u2013 ac 648,000 Ridgwell et al. (2006a)\nFossil C fate ea go gs \u2013 \u2013 \u2013 bg sd ac 600,000 Ridgwell and Hargreaves (2006)\nMillennial ea go gs el \u2013 ev bg \u2013 ac 262,000 Lenton et al. (2006)\nDeglaciation ea go gs el fi fv \u2013 \u2013 \u2013 109,000 Lunt et al. (2006)\nAtl. salinity ea go gs el fi fv \u2013 \u2013 \u2013 100,000 Marsh et al. (2006)\nGlacial cycle ea go gs el fi fv \u2013 \u2013 \u2013 480,000 Marsh et al. (2006)\nEnKF 4 ia fo fs il \u2013 \u2013 \u2013 \u2013 \u2013 38,400 Annan et al. (2005a)\nGA tuning ia fo fs il \u2013 \u2013 \u2013 \u2013 \u2013 60,000 Price et al. (2006b)\nInception ia so ss \u2013 gi \u2013 \u2013 \u2013 \u2013 70,000 Rutt et al. (2005)\nBistability 2 ia go ss il \u2013 \u2013 \u2013 \u2013 \u2013 407,000 Main article\n22\n"}