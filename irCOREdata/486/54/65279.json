{"doi":"10.1109\/tcbb.2007.1019","coreId":"65279","oai":"oai:dro.dur.ac.uk.OAI2:6312","identifiers":["oai:dro.dur.ac.uk.OAI2:6312","10.1109\/tcbb.2007.1019"],"title":"Computing the hybridisation number of two phylogenetic trees is fixed parameter tractable.","authors":["Bordewich,  M.","Semple,  C."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2007-07-01","abstract":"Reticulation processes in evolution mean that the ancestral history of certain groups of present-day species is non-tree-like. These processes include hybridization, lateral gene transfer, and recombination. Despite the existence of reticulation, such events are relatively rare and so a fundamental problem for biologists is the following: given a collection of rooted binary phylogenetic trees on sets of species that correctly represent the tree-like evolution of different parts of their genomes, what is the smallest number of \"reticulation\" vertices in any network that explains the evolution of the species under consideration. It has been previously shown that this problem is NP-hard even when the collection consists of only two rooted binary phylogenetic trees. However, in this paper, we show that the problem is fixed-parameter tractable in the two-tree instance, when parameterized by this smallest number of reticulation vertices","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/65279.pdf","fullTextIdentifier":"http:\/\/dro.dur.ac.uk\/6312\/1\/6312.pdf","pdfHashValue":"2705e6555a0a75ae25c24e4f88b5ff0cfa6a5d11","publisher":"IEEE","rawRecordXml":"<record><header><identifier>\n  \n    \n      oai:dro.dur.ac.uk.OAI2:6312<\/identifier><datestamp>\n      2011-12-06T16:28:27Z<\/datestamp><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        Computing the hybridisation number of two phylogenetic trees is fixed parameter tractable.<\/dc:title><dc:creator>\n        Bordewich,  M.<\/dc:creator><dc:creator>\n        Semple,  C.<\/dc:creator><dc:description>\n        Reticulation processes in evolution mean that the ancestral history of certain groups of present-day species is non-tree-like. These processes include hybridization, lateral gene transfer, and recombination. Despite the existence of reticulation, such events are relatively rare and so a fundamental problem for biologists is the following: given a collection of rooted binary phylogenetic trees on sets of species that correctly represent the tree-like evolution of different parts of their genomes, what is the smallest number of \"reticulation\" vertices in any network that explains the evolution of the species under consideration. It has been previously shown that this problem is NP-hard even when the collection consists of only two rooted binary phylogenetic trees. However, in this paper, we show that the problem is fixed-parameter tractable in the two-tree instance, when parameterized by this smallest number of reticulation vertices.<\/dc:description><dc:subject>\n        Rooted phylogenetic tree<\/dc:subject><dc:subject>\n         Reticulate evolution<\/dc:subject><dc:subject>\n         Hybridization network<\/dc:subject><dc:subject>\n         Agreement forest<\/dc:subject><dc:subject>\n         Subtree prune and regraft.<\/dc:subject><dc:publisher>\n        IEEE<\/dc:publisher><dc:source>\n        Transactions on computational biology and bioinformatics, 2007, Vol.4(3), pp.458-466 [Peer Reviewed Journal]<\/dc:source><dc:date>\n        2007-07-01<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:identifier>\n        dro:6312<\/dc:identifier><dc:identifier>\n        issn:1545-5963<\/dc:identifier><dc:identifier>\n        doi:10.1109\/tcbb.2007.1019<\/dc:identifier><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/6312\/<\/dc:identifier><dc:identifier>\n        http:\/\/dx.doi.org\/10.1109\/tcbb.2007.1019<\/dc:identifier><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/6312\/1\/6312.pdf<\/dc:identifier><dc:rights>\n        \u00a92007 IEEE. This material is presented to ensure timely dissemination of scholarly and technical work. Copyright and all rights therein are retained by authors or by other copyright holders. All persons copying this information are expected to adhere to the terms and constraints invoked by each author's copyright. In most cases, these works may not be reposted without the explicit permission of the copyright holder\\ud\n\\ud\nPersonal use of this material is permitted. However, permission to reprint\/republish this material for advertising or promotional purposes or for creating new collective works for resale or redistribution to servers or lists, or to reuse any copyrighted component of this work in other works must be obtained from the IEEE.<\/dc:rights><dc:accessRights>\n        info:en-repo\/semantics\/openAccess<\/dc:accessRights><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["1545-5963","issn:1545-5963"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2007,"topics":["Rooted phylogenetic tree","Reticulate evolution","Hybridization network","Agreement forest","Subtree prune and regraft."],"subject":["Article","PeerReviewed"],"fullText":"Durham Research Online\nDeposited in DRO:\n06 January 2010\nVersion of attached file:\nPublished Version\nPeer-review status of attached file:\nPeer-reviewed\nCitation for published item:\nBordewich, M. and Semple, C. (2007) \u2019Computing the hybridisation number of two phylogenetic trees is fixed\nparameter tractable.\u2019, Transactions on computational biology and bioinformatics., 4 (3). pp. 458-466.\nFurther information on publisher\u2019s website:\nhttp:\/\/dx.doi.org\/10.1109\/tcbb.2007.1019\nPublisher\u2019s copyright statement:\n2007 IEEE. This material is presented to ensure timely dissemination of scholarly and technical work. Copyright and\nall rights therein are retained by authors or by other copyright holders. All persons copying this information are\nexpected to adhere to the terms and constraints invoked by each author\u2019s copyright. In most cases, these works may\nnot be reposted without the explicit permission of the copyright holder Personal use of this material is permitted.\nHowever, permission to reprint\/republish this material for advertising or promotional purposes or for creating new\ncollective works for resale or redistribution to servers or lists, or to reuse any copyrighted component of this work in\nother works must be obtained from the IEEE.\nAdditional information:\nUse policy\nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without prior permission or charge, for\npersonal research or study, educational, or not-for-profit purposes provided that:\n\u2022 a full bibliographic reference is made to the original source\n\u2022 a link is made to the metadata record in DRO\n\u2022 the full-text is not changed in any way\nThe full-text must not be sold in any format or medium without the formal permission of the copyright holders.\nPlease consult the full DRO policy for further details.\nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom\nTel : +44 (0)191 334 3042 \u2014 Fax : +44 (0)191 334 2971\nhttp:\/\/dro.dur.ac.uk\n  \nDurham Research Online \n \nDeposited in DRO: \n06 January 2010 \n \nPeer-review status: \nPeer-reviewed \n \nPublication status: \nPublished version \n \nCitation for published item: \nBordewich, M. and Semple, C. (2007) 'Computing the hybridisation number of two \nphylogenetic trees is fixed parameter tractable.', Transactions on computational biology and \nbioinformatics., 4 (3). pp. 458-466. \n \nFurther information on publishers website: \nhttp:\/\/dx.doi.org\/10.1109\/tcbb.2007.1019 \n \nPublisher\u2019s copyright statement: \n\u00a92007 IEEE. This material is presented to ensure timely dissemination of scholarly and \ntechnical work. Copyright and all rights therein are retained by authors or by other copyright \nholders. All persons copying this information are expected to adhere to the terms and \nconstraints invoked by each author's copyright. In most cases, these works may not be \nreposted without the explicit permission of the copyright holder \n \nPersonal use of this material is permitted. However, permission to reprint\/republish this \nmaterial for advertising or promotional purposes or for creating new collective works for \nresale or redistribution to servers or lists, or to reuse any copyrighted component of this work \nin other works must be obtained from the IEEE. \n \n \n \nUse policy \n \nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without prior \npermission or charge, for personal research or study, educational, or not-for-profit purposes provided that : \n \n\uf0a7 a full bibliographic reference is made to the original source \n\uf0a7 a link is made to the metadata record in DRO \n\uf0a7 the full-text is not changed in any way \n \nThe full-text must not be sold in any format or medium without the formal permission of the copyright holders. \n \nPlease consult the full DRO policy for further details. \n \nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom \nTel : +44 (0)191 334 2975 | Fax : +44 (0)191 334 2971 \nhttp:\/\/dro.dur.ac.uk \nComputing the Hybridization Number of\nTwo Phylogenetic Trees Is\nFixed-Parameter Tractable\nMagnus Bordewich and Charles Semple\nAbstract\u2014Reticulation processes in evolution mean that the ancestral history of certain groups of present-day species is non-tree-like.\nThese processes include hybridization, lateral gene transfer, and recombination. Despite the existence of reticulation, such events are\nrelatively rare and, so, a fundamental problem for biologists is the following: Given a collection of rooted binary phylogenetic trees on\nsets of species that correctly represent the tree-like evolution of different parts of their genomes, what is the smallest number of\n\u201creticulation\u201d vertices in any network that explains the evolution of the species under consideration? It has been previously shown that\nthis problem is NP-hard even when the collection consists of only two rooted binary phylogenetic trees. However, in this paper, we\nshow that the problem is fixed-parameter tractable in the two-tree instance when parameterized by this smallest number of reticulation\nvertices.\nIndex Terms\u2014Rooted phylogenetic tree, reticulate evolution, hybridization network, agreement forest, subtree prune and regraft.\n\u00c7\n1 INTRODUCTION\nEVOLUTIONARY (phylogenetic) trees are used in biology torepresent the ancestral history of a collection of present-\nday species. While this is appropriate for many groups of\nspecies, there are some groups (including certain plant and\nfish species) for which the ancestral history is non-tree-like.\nThis is caused by processes that include hybridization,\nlateral gene transfer, and recombination. Collectively, these\nprocesses are referred to as reticulation events. For such\nspecies, it is more appropriate to represent their ancestral\nhistory using rooted acyclic digraphs, where vertices of in-\ndegree at least two represent reticulation events\nAlthough reticulation events do occur, they are still\nrelatively rare and, so, a fundamental problem for biologists\nstudying the evolution of species is the following: Given a\ncollection of rooted phylogenetic trees on sets of species that\ncorrectly represents the tree-like evolution of different parts\nof their genomes, what is the smallest number of reticula-\ntion events needed to explain the evolution of the species\nunder consideration? This smallest number sets a lower\nbound on the number of such events.\nThis question has been considered in a number of papers\nincluding [2], [3], [6], [10], [14], [15]. Furthermore, variants\nof it (particularly when the input is a collection of binary\nsequences) have also been considered, for example see [8],\n[9], [11], [12], [13], [18]. In an earlier paper [6], we showed\nthat, computationally, the above problem is NP-hard even\nwhen the initial collection consists of two rooted binary\nphylogenetic trees. However, the main result of this paper\nshows that, in the case where the input consists of two such\ntrees, there is a fixed-parameter algorithm for finding the\noptimal solution.\nThe idea behind fixed-parameter complexity is that,\nwhile the general case of computing the minimum number\nof reticulation events is NP-hard, many biologically\nrelevant cases have a relatively small number of hybridiza-\ntion events and, so, may be tractable. In particular, we show\nthat this minimum number can be computed in time\nO\u00f0f\u00f0k\u00de \u00fe p\u00f0n\u00de\u00de, where n is the number of species, k is the\nactual minimum number, f is some computable function,\nand p is a fixed polynomial. The importance of this result is\nin the separation of the variables n and k; it shows that, for a\nreasonable range of k, the problem may be tractable even for\na very large n.\nTo formally describe the above problem and, in\nparticular, the main result, we need several definitions. A\nrooted binary phylogenetic X-tree is a rooted tree whose root\nhas degree two and all other interior vertices have degree\nthree and whose leaf set is X. The set X is called the label set\nof T and is often denoted L\u00f0T \u00de. Two rooted binary\nphylogenetic trees are shown in Fig. 1a.\nA hybridization network (on X) is a rooted acyclic digraph\nwith root \u0002 in which\n1. X is the set of vertices of out-degree zero,\n2. the out-degree of \u0002 is at least 2, and\n3. for each vertex with out-degree 1, its in-degree is at\nleast 2.\nFor completeness, if jXj \u00bc 1, then thedigraph consisting of an\nisolated vertex labeled by the element inX is also defined to\nbe a hybridization network onX. The setX represents a set of\npresent-day species and vertices of in-degree at least two\n458 IEEE\/ACM TRANSACTIONS ON COMPUTATIONAL BIOLOGY AND BIOINFORMATICS, VOL. 4, NO. 3, JULY-SEPTEMBER 2007\n. M. Bordewich is with the Department of Computer Science, Durham\nUniversity, Durham DH1 3LE, UK.\nE-mail: m.j.r.bordewich@durham.ac.uk.\n. C. Semple is with the Biomathematics Research Centre, Department of\nMathematics and Statistics, University of Canterbury, Christchurch, New\nZealand. E-mail: c.semple@math.canterbury.ac.nz.\nManuscript received 30 May 2006; revised 20 Aug. 2006; accepted 24 Aug.\n2006; published online 10 Jan. 2007.\nFor information on obtaining reprints of this article, please send e-mail to:\ntcbb@computer.org, and reference IEEECS Log Number TCBB-0119-0506.\nDigital Object Identifier no. 10.1109\/TCBB.2007.1019.\n1545-5963\/07\/$25.00 \u0002 2007 IEEE Published by the IEEE CS, CI, and EMB Societies & the ACM\nAuthorized licensed use limited to: University of Durham. Downloaded on January 6, 2010 at 09:24 from IEEE Xplore.  Restrictions apply. \nrepresent an inheritance of genetic information from their\nparents. Generically, we call such vertices hybridization\nvertices. A hybridization network is shown in Fig. 1b. For\nconvenience, throughout the paper, we adopt the conven-\ntion that hybridization networks are always drawn with\ntheir arcs directed downward and, so, we omit the arrow-\nheads. Note that hybridization networks are referred to as\n\u201chybrid phylogenies\u201d in [2], [3].\nTo quantify the number of hybridization events of a\nhybridization networkH, we define the hybridization number\nof H, denoted h\u00f0H\u00de, to be\nh\u00f0H\u00de \u00bc\nX\nv 6\u00bc\u0002\n\u00f0d\u0002\u00f0v\u00de \u0002 1\u00de;\nwhere \u0002 denotes the root of H and d\u0002\u00f0v\u00de denotes the in-\ndegree of v. Apart from the root, every vertex has at least\none parent and, so, \u201c\u00f0d\u0002\u00f0v\u00de \u0002 1\u00de\u201d represents the number of\n\u201cadditional\u201d parents of v. In Fig. 1b, h\u00f0H\u00de \u00bc 1.\nLet T be a rooted binary phylogenetic X-tree and let H\nbe a hybridization network. We say that H displays T if T\ncan be obtained from a rooted subtree of H by suppressing\ndegree-two vertices. In other words, T can be obtained from\nH by first deleting a subset of the edges of H and then\ndeleting the isolated vertices and suppressing nonroot\ndegree-two vertices. The hybridization network in Fig. 1b\ndisplays the two trees in Fig. 1a. For two rooted binary\nphylogenetic X-trees, T and T 0, we set\nh\u00f0T ; T 0\u00de \u00bc minfh\u00f0H\u00de :\nH is a hybridization network that displays T and T 0g:\nThe decision problem HYBRIDIZATION NUMBER is for-\nmally stated as follows:\nProblem HYBRIDIZATION NUMBER\nInstance: Two rooted binary phylogenetic X-trees T and T 0\nand an integer k.\nQuestion: Is h\u00f0T ; T 0\u00de \u0003 k?\nThe main result of this paper is the following theorem:\nTheorem 1.1. The decision problem HYBRIDIZATION\nNUMBER, parameterized by h\u00f0T ; T 0\u00de, is fixed-parameter\ntractable.\nWe note here that, while Theorem 1.1 provides the first\nfixed-parameter algorithm for HYBRIDIZATION NUMBER,\nHallet and Lagergren [10] give a fixed-parameter algorithm\nin a slightly different setting which may be interpreted as a\nrestricted version of this problem.\nInformally, the overall approach we use in proving\nTheorem 1.1 is as follows: We start by taking the input to\nHYBRIDIZATION NUMBER and reducing its size using two\nreduction rules in a regulated way. We show that, once fully\nreduced, the resulting input size is linear in our parameter:\nthe hybridization number of the original pair of input trees.\nWe then apply brute force to compute the hybridization\nnumber on the smaller input, which may take exponential\ntime but is only ever performed on the bounded size input.\nThe resulting solution immediately provides the hybridiza-\ntion number of the original pair of input trees.\nThis approach is similar to that used in showing that\n\u201crooted subtree prune and regraft (rSPR) distance\u201d is fixed-\nparameter tractable [5]; in particular, we kernalize the\nproblem by using two rules that reduce the size of the input\ntrees sufficiently. Loosely speaking, for two rooted binary\nphylogenetic X-trees T and T 0, the rSPR distance is the\nminimum number of subtrees that must be \u201cmoved\u201d to\ntransform T into T 0. Denoting this distance by drSPR\u00f0T ; T 0\u00de,\nthe decision problem rSPR DISTANCE is to decide whether\ndrSPR\u00f0T ; T 0\u00de \u0003 k for some given k. Like HYBRIDIZATION\nNUMBER, this problem is also NP-hard [5]. In the last\nsection, Section 4, we compare the two approaches and\nhighlight an interesting observation with regard to finding a\npolynomial-time approximation algorithm for HYBRIDIZA-\nTION NUMBER.\nThe paper is organized as follows: In the next section, we\ndescribe two notions of an \u201cagreement forest.\u201d Both of these\nnotions have proved fruitful in the study of rSPR DISTANCE\nand HYBRIDIZATION NUMBER. A third notion, which\nextends the other two and will be central to the results in\nthis paper, will be described in Section 3, where the proof of\nTheorem 1.1 is established. Unless otherwise stated, the\nnotation and terminology follow [17]. For an authoritative\nreference on fixed-parameter tractability, we refer the\nreader to [7].\n2 AGREEMENT FORESTS\nAgreement forests have become an essential tool in under-\nstanding the decision problem HYBRIDIZATION NUMBER\nand the closely related problem rSPR DISTANCE. In this\nsection, we describe two notions of agreement forests. The\nsecond notion provides a characterization of HYBRIDIZA-\nTIONNUMBER that underpinsmanyof the results in this area.\nLet T be a rooted binary phylogenetic X-tree and let X0\nbe a subset of X. The minimal rooted subtree of T that\nconnects the vertices of T labeled by the elements of X0 is\ndenoted by T \u00f0X0\u00de. Furthermore, the restriction of T to X0,\ndenoted by T jX0, is the rooted binary phylogenetic tree that\nis obtained from T \u00f0X0\u00de by suppressing any nonroot vertices\nof degree two.\nBORDEWICH AND SEMPLE:COMPUTING THE HYBRIDIZATION NUMBER OF TWO PHYLOGENETIC TREES IS FIXED-PARAMETER ... 459\nFig. 1. (a) Two rooted binary phylogenetic trees T and T 0. (b) A hybridization network H that displays them.\nAuthorized licensed use limited to: University of Durham. Downloaded on January 6, 2010 at 09:24 from IEEE Xplore.  Restrictions apply. \nNow, let T and T 0 be two rooted binary phylogenetic\nX-trees. For the purposes of the definition of an agreement\nforest, we regard the root of both T and T 0 as a vertex \u0002 at\nthe end of a pendant edge adjoined to the original root.\nFurthermore, we also regard \u0002 as part of the label sets of\nboth T and T 0; thus, we view their label sets as X [ f\u0002g. For\nexample, in Fig. 2, we have adjoined the vertex \u0002 to each of\nthe original roots of T and T 0. An agreement forest for T and\nT 0 is a collection F \u00bc fT \u0002; T 1; T 2; . . . ; T kg of restricted\nsubtrees of T and T 0, where T \u0002 is a rooted tree whose (leaf)\nlabel set L\u0002 includes \u0002 and T 1; T 2; . . . ; T k are rooted binary\nphylogenetic trees with label sets L1;L2; . . . ;Lk, respec-\ntively, such that the following properties are satisfied:\n1. The label sets L\u0002;L1;L2; . . . ;Lk partition X [ f\u0002g.\n2. For all i 2 f\u0002; 1; 2; . . . ; kg, T i ffi T jLi ffi T 0jLi.\n3. The trees in fT \u00f0Li\u00de : i 2 f\u0002; 1; 2; . . . ; kgg and fT 0\u00f0Li\u00de :\ni 2 f\u0002; 1; 2; . . . ; kgg are vertex disjoint subtrees of T\nand T 0, respectively.\nIt is easily seen that, if F is an agreement forest for T and\nT 0, then F can be obtained from each of T and T 0 by\ndeleting jF j \u0002 1 edges and suppressing nonroot vertices of\ndegree two. An agreement forest for T and T 0 is a\nmaximum-agreement forest if it has the smallest number of\ncomponents among all agreement forests for T and T 0, in\nwhich case, we denote the value of k by m\u00f0T ; T 0\u00de.\nWhile rSPR DISTANCE can be characterized in terms of\nagreement forests [5] (see Section 4), such a characterization\nfor HYBRIDIZATION NUMBER requires an additional condi-\ntion. This condition excludes the possibility of circular\ninheritance, that is, inheriting genetic information from your\nown descendants. Suppose that F \u00bc fT \u0002; T 1; T 2; . . . ; T kg is\nan agreement forest for T and T 0. Let GF be the directed\ngraph whose vertex set is F and, for distinct vertices T i and\nT j, the ordered pair \u00f0T i; T j\u00de is an arc precisely if either\n1. the root of T \u00f0Li\u00de in T is an ancestor of the root of\nT \u00f0Lj\u00de in T or\n2. the root of T 0\u00f0Li\u00de in T 0 is an ancestor of the root of\nT 0\u00f0Lj\u00de in T 0.\nWe say that F is an acyclic-agreement forest if GF is acyclic,\nthat is, GF contains no directed cycles. Furthermore, if F\ncontains the smallest number of components over all\nacyclic-agreement forests for T and T 0, we say that F is a\nmaximum-acyclic-agreement forest for T and T 0, in which\ncase, we denote this value of k by ma\u00f0T ; T 0\u00de. To illustrate\nthese definitions, Fig. 3a shows a maximum-acyclic-agree-\nment forest F for the two rooted binary phylogenetic trees\nshown in Fig. 2, while Fig. 3b shows the graph GF .\nThe following result is established in [2]:\nTheorem 2.1. Let T and T 0 be two rooted binary phylogenetic\nX-trees. Then, h\u00f0T ; T 0\u00de \u00bc ma\u00f0T ; T 0\u00de.\nTo provide some intuition for Theorem 2.1, suppose that\nH is a hybridization network that displays T and T 0 such\nthat h\u00f0H\u00de \u00bc h\u00f0T ; T 0\u00de. Then, it is easy to see that the in-\ndegree of every hybridization vertex is two. Furthermore,\nup to suppressing degree-two vertices, an acyclic-agree-\nment forest F for T and T 0 can be obtained by deleting each\nof the edges coming into every hybridization vertex. In this\ncase, jF j \u0002 1 \u00bc h\u00f0T ; T 0\u00de and, so, we have one direction of\nthe statement (in particular, ma\u00f0T ; T 0\u00de \u0003 h\u00f0T ; T 0\u00de). Biologi-\ncally, the deleted edges correspond to different paths of\ngenetic inheritance. Consequently, the fewer edges deleted,\nthe smaller the number of hybridization events required to\nexplain T and T 0. On the other hand, if we have an acyclic-\nagreement forest F for T and T 0, then the acyclicity of GF\nallows one to construct a hybridization network H that\ndisplays T and T 0 in which h\u00f0H\u00de \u0003 jFj \u0002 1. This gives the\nother direction of Theorem 2.1.\n3 FIXED-PARAMETER TRACTABILITY\nIn this section, we prove the main result of this paper,\nTheorem 1.1. As mentioned in the introduction, we use two\nreduction rules to kernalize the problem. We begin this\nsection by describing these two rules.\nLet T be a rooted binary phylogeneticX-tree. Forn \u0005 2, an\nn-chain of T is an ordered tuple \u00f0a1; a2; . . . ; an\u00de of leaves of T\nsuch that the parent of a1 is either the same as the parent of a2\nor a child of theparent of a2 and, for all i \u0005 2, the parent of ai is\na childof theparentofai\u00fe1. To illustrate, the treeT inFig. 5has\nan n-chain \u00f0a1; a2; . . . ; an\u00de. Furthermore, a pendant subtree of\nT is one that can be detached by deleting a single edge.\nLet T and T 0 be two rooted binary phylogenetic X-trees.\nLet P be a disjoint collection of 2-element subsets of X such\nthat each pair fa; bg 2 P is a 2-chain in both T and T 0. Let\nw : P ! Z \u00fe be a weight function on the elements of P , that\nis, each pair in P is assigned a positive integer weight. In the\nremainder of the paper, we refer to such a pair of trees with\nassociated set P and weight function w as a pair of weighted\nphylogenetic trees on X.\nThe above-mentioned reduction rules are as follows: Let\nT and T 0 be a pair of weighted phylogenetic trees on X.\nRule 1. Replace any maximal pendant subtree that occurs\nidentically in both trees by a single leaf with a new label.\n460 IEEE\/ACM TRANSACTIONS ON COMPUTATIONAL BIOLOGY AND BIOINFORMATICS, VOL. 4, NO. 3, JULY-SEPTEMBER 2007\nFig. 2. Two rooted binary phylogenetic trees with their roots labeled. Fig. 3. (a) A maximum-acyclic-agreement forest F for T and T\n0 in Fig. 2\nand (b) the graph GF .\nAuthorized licensed use limited to: University of Durham. Downloaded on January 6, 2010 at 09:24 from IEEE Xplore.  Restrictions apply. \nFurthermore, delete all members of P whose elements\nlabel leaves of the pendant subtree.\nRule 2.Forn \u0005 3, replace anymaximaln-chain \u00f0a1; a2; . . . ; an\u00de\nthat occurs identically in both T and T 0 by a 2-chain with\nnew labels a, b. Furthermore, add the new 2-element set\nfa; bg to P with weight\nw\u00f0fa; bg\u00de \u00bc n\u0002 2\u00fe\nX\nfai;ajg2P ;ai;aj2fa1;...;ang\nw\u00f0fai; ajg\u00de\nand then delete all pairs in P whose elements are in\nfa1; a2; . . . ; ang.\nRules 1 and 2 are illustrated in Figs. 4 and 5, respectively.\nRemark. The label set of any maximal pendant subtree or\nmaximal chain which appears in both T and T 0 must\nintersect each pair in P in either both elements or neither.\nHence, the rules above are well-defined. We freely use\nthis fact in the rest of the paper.\nWe next introduce a third notion of agreement forests.\nThis notion extends the previous two and is central to this\npaper. For a pair of weighted phylogenetic X-trees T and\nT 0, an agreement forest F for T and T 0 is legitimate if it is\nacyclic and the following pairwise property holds:\n(P) If fa; bg 2 P , then either a and b are both contained in the\nlabel set of some component of F or a and b label isolated\nvertices in F .\nFurthermore, let F be an (ordinary) agreement forest for T\nand T 0. We define the weight of F , denoted w\u00f0F\u00de, to be\nw\u00f0F\u00de \u00bc \u00f0jFj \u0002 1\u00de \u00fe\nX\nfa;bg2P ;a and b isolated in F\nw\u00f0fa; bg\u00de\nand set f\u00f0T ; T 0\u00de to be the minimum weight of a legitimate-\nagreement forest for T and T 0. Note that we always have\nf\u00f0T ; T 0\u00de \u0005 h\u00f0T ; T 0\u00de since the weight function is nonnega-\ntive, and f\u00f0T ; T 0\u00de \u00bc h\u00f0T ; T 0\u00de whenever the set P is empty.\nThe next lemma is a key result in establishing Theo-\nrem 1.1. For a vertex v of a rooted binary phylogenetic\nX-tree T , the subset of X whose elements are precisely the\ndescendants of v is a cluster of T , while the most recent\ncommon ancestor of a subset A ofX, denotedmrcaT \u00f0A\u00de, is the\nvertex of T whose associated cluster is the minimal cluster\nof T containing A.\nLemma 3.1. Let T and T 0 be a pair of weighted phylogenetic trees\non X. Let A be the leaf set of a maximal pendant subtree\ncommon to T and T 0 and let \u00f0a1; a2; . . . ; an\u00de be a maximal\nn-chain common to both T and T 0, where n \u0005 3. Then, every\nlegitimate-agreement forest F for T and T 0 of minimum\nweight has the following properties:\n1. F contains a tree whose label set contains every\nelement of A and\n2. either F contains a tree whose label set contains\nfa1; a2; . . . ; ang or each of a1; a2; . . . ; an labels an\nisolated vertex in F .\nProof. We start with the proof of 1. Let F \u00bc\nfT \u0002; T 1; T 2; . . . ; T kg be a legitimate-agreement forest for\nT and T 0 of minimum weight. Assume for a contra-\ndiction that no single component contains every\nelement of A in its label set. We form a new\nlegitimate-agreement forest F0 which satisfies 1 and\nhas smaller weight than F . Let J index the compo-\nnents of F which include members of A in their label\nsets. To be precise, J \u00bc fj 2 f\u0002; 1; . . . ; kg : Lj \\A 6\u00bc ;g.\nLet F0 be the forest that is obtained from F by deleting\neach tree T j such that j 2 J and inserting the new tree\nT A \u00bc T j\u00f0[j2JLj\u00de with label set LA, say. Observe that\nLj \u0002A 6\u00bc ; for at most one member of J since the\ncorresponding subtrees in T (and T 0) must be vertex\ndisjoint. Hence, F0 is an agreement forest for T and T 0.\nFurthermore, it is acyclic since the elements of A labeled\na pendant subtree and legitimate since Awas maximal. It\nremains to observe that w\u00f0F\u00de > w\u00f0F 0\u00de, since F0 has fewer\ncomponents and no additional pairs in P whose\nelements are isolated, which gives a contradiction.\nWe now turn to the proof of 2. Let F \u00bc\nfT \u0002; T 1; T 2; . . . ; T kg be a legitimate-agreement forest\nfor T and T 0 of minimum weight and assume that some\nai does not label an isolated vertex. Then, without loss of\nBORDEWICH AND SEMPLE:COMPUTING THE HYBRIDIZATION NUMBER OF TWO PHYLOGENETIC TREES IS FIXED-PARAMETER ... 461\nFig. 4. Two weighted phylogenetic trees reduced under Rule 1, where S\nand S0 are the resulting trees.\nFig. 5. Two weighted phylogenetic trees reduced under Rule 2, where S\nand S0 are the resulting trees.\nAuthorized licensed use limited to: University of Durham. Downloaded on January 6, 2010 at 09:24 from IEEE Xplore.  Restrictions apply. \ngenerality, the label ai is contained in the label set Li of\nT i, where Li \u0002 faig is nonempty. First, we eliminate a\nparticular way in which ai may be related to Li \u0002 faig in\nT and T 0.\nSuppose ai is adjoined to the root of T i such that the\nparent of ai in one of the original trees, T say, is an\nancestor of mrcaT \u00f0Li \u0002 faig\u00de while the parent of ai in T 0\nis not an ancestor of mrcaT 0 \u00f0Li \u0002 faig\u00de (see Fig. 6). Then,\neach of the elements in fa1; a2; . . . ; ang \u0002 faig must label\nan isolated vertex in F ; otherwise, the corresponding\nsubtrees of two components of F in either T or T 0\noverlap. By deleting ai from T i and replacing these\nisolated vertices with a single tree that is isomorphic to\nT jfa1; a2; . . . ; ang, it is easily seen that the resulting\nagreement forest F0 is acyclic. Since \u00f0a1; a2; . . . ; an\u00de is a\nmaximal n-chain and F is legitimate, it follows that F0\nsatisfies (P). But, w\u00f0F 0\u00de < w\u00f0F\u00de, contradicting the minim-\nality of F . Thus, we may assume that, if ai is adjoined to\nthe root of T i and the parent of ai in T is an ancestor of\nmrcaT \u00f0Li \u0002 faig\u00de, then the parent of ai in T 0 is also an\nancestor of mrcaT 0 \u00f0Li \u0002 faig\u00de.\nNow, let J index the components of F which\ncontain elements of the chain. To be precise,\nJ \u00bc fj 2 f\u0002; 1; . . . ; kg : Lj \\ fa1; a2; . . . ; ang 6\u00bc ;g. Observe\nthat Lj \u0002 fa1; . . . ; ang 6\u00bc ; for at most two members of J\nsince the corresponding subtrees in T (and T 0) are vertex\ndisjoint. Let F0 be the forest that is obtained from F by\ndeleting each tree T j such that j 2 J and inserting the\nnew tree T a \u00bc T j\u00f0[j2JLj\u00de with label set La, say.\nEssentially, we have joined the components in F\ninvolving elements of fa1; a2; . . . ; ang together, along the\nchain. An illustration of this is shown in Fig. 7, where the\nleft-hand side of the figure shows the components of F\ncontaining elements in fa1; a2; . . . ; ang, while the right-\nhand side shows T a in F0. It follows from the assumption\nat the end of the previous paragraph that F0 is an\nagreement forest for T and T 0 since the chain is common\nto both trees. Furthermore, as \u00f0a1; a2; . . . ; an\u00de is maximal,\nF0 satisfies (P).\nWe next show that F0 is acyclic. Consider the directed\ngraphs GF0 and GF associated with F0 and F , respec-\ntively. First, the vertex set of GF0 is obtained from GF by\ndeleting the vertices T j for all j 2 J and introducing the\nnew vertex T a. Furthermore, if T l; T m 2 F0 \u0002 fT ag, then\n\u00f0T l; T m\u00de is an arc in GF0 if and only if \u00f0T l; T m\u00de is an arc\nin GF . Regarding the arcs incident with T a, there are two\ncases to consider. First, suppose there is some j1 2 J such\nthat the root of T \u00f0Lj1\u00de in T is above an (i.e., on the path\nfrom an to \u0002). Then, the root of T \u00f0La\u00de is the same as the\nroot of T \u00f0Lj1\u00de and, under our assumptions, the respec-\ntive roots must also coincide in T 0. This occurs in the\nexample given in Fig. 7, where, in both T and T 0, the root\nof T \u00f0L2 [ fa6; a7g\u00de is the same as the root of T \u00f0La\u00de. So,\n\u00f0T a; T l\u00de and \u00f0T l; T a\u00de are arcs in GF0 if and only if\n\u00f0T j1 ; T l\u00de and \u00f0T l; T j1\u00de are arcs in GF , respectively. Since\nGF is acyclic, GF0 must be also. Second, suppose there is\nno such j1 2 J . Then, the root of T \u00f0La\u00de is the parent of an\nin T and, likewise, the root of T 0\u00f0La\u00de is the parent of an in\nT 0. Since not all of the elements in fa1; . . . ; ang are\nisolated in F , there is some j2 2 J such that the root of\nT \u00f0Lj2\u00de in T is above a1. It again follows that \u00f0T a; T l\u00de and\n\u00f0T l; T a\u00de are arcs in GF0 if and only if \u00f0T j2 ; T l\u00de and\n\u00f0T l; T j2\u00de are arcs in GF , respectively, and, so, GF0 is\nacyclic. Hence, F0 is a legitimate-agreement forest for T\nand T 0. If a1; . . . ; an are not all in the same component of\nF (i.e., if jJ j > 1), then we have reduced the number of\ncomponents and, so, w\u00f0F 0\u00de < w\u00f0F\u00de. This contradicts the\nminimality of F . Hence, under the original assumption\nthat some ai does not label an isolated vertex, we\nconclude that the chain is entirely contained in a single\ncomponent of F . This concludes the proof of the\nlemma. tu\n462 IEEE\/ACM TRANSACTIONS ON COMPUTATIONAL BIOLOGY AND BIOINFORMATICS, VOL. 4, NO. 3, JULY-SEPTEMBER 2007\nFig. 6. Under the assumption that this configuration appears in F , then\nthe rest of the members of fa1; a2; . . . ; ang \u0002 faig must label isolated\nvertices in F .\nFig. 7. Joining the components of F containing elements in fa1; a2; . . . ; ang to form a new component T a in F0.\nAuthorized licensed use limited to: University of Durham. Downloaded on January 6, 2010 at 09:24 from IEEE Xplore.  Restrictions apply. \nProposition 3.2. Let T and T 0 be a pair of weighted phylogenetic\nX-trees onX. Let S and S0 be the pair of weighted phylogenetic\nX0-trees obtained from T and T 0, respectively, by applying\neither Rule 1 or Rule 2. Then, f\u00f0T ; T 0\u00de \u00bc f\u00f0S;S0\u00de.\nProof. It is an immediate consequence of Lemma 3.1.1 that\nthe proposition holds if S and S0 have been obtained\nfrom T and T 0 by applying Rule 1. Therefore, consider a\nsingle application of Rule 2 to T and T 0, where the\ncommon n-chain of T and T 0 that is used is\n\u00f0a1; a2; . . . ; an\u00de and the resulting 2-chain is \u00f0a; b\u00de.\nLet F T be a legitimate-agreement forest for T and T 0\nof minimum weight. Then, by Lemma 3.1.2, either\n1. fa1; a2; . . . ; ang is contained in the label set of a\ntree in FT or\n2. each of a1; a2; . . . ; an label isolated vertices in F T .\nLet FS be the forest obtained from F T by either replacing\nthe n-chain \u00f0a1; a2; . . . ; an\u00de with the 2-chain \u00f0a; b\u00de or\nreplacing the isolated vertices labeled with the elements\nof this n-chain with two isolated vertices labeled a and b\ndepending upon whether 1 or 2 holds, respectively.\nIllustrations of F T and FS for 1 and 2 are shown in Fig. 8.\nSince FT is a legitimate-agreement forest for T and T 0, a\nroutine check shows that FS is a legitimate-agreement\nforest for S and S0. Moreover, in the case where 2 holds,\nthe contribution of the isolated vertices a1; a2; . . . ; an to\nw\u00f0F T \u00de is exactly the same as the contribution of the\nisolated vertices a; b to w\u00f0FS\u00de. It now follows that\nf\u00f0S;S0\u00de \u0003 f\u00f0T ; T 0\u00de.\nNow, suppose that FS is a legitimate-agreement forest\nfor S and S0 with minimum weight. Since FS is\nlegitimate, either\n1. there is a tree, Si, say, in FS whose label set\ncontains a and b or\n2. a and b label isolated vertices in FS .\nDepending on which holds, let F T be the forest obtained\nfrom FS by either replacing Si with the restriction of T to\n\u00f0L\u00f0Si\u00de \u0002 fa; bg\u00de [ fa1; a2; . . . ; ang or replacing the isolated\nvertices labeled a and b with n isolated vertices labeled\na1; a2; . . . ; an, respectively. Since FS is a legitimate-\nagreement forest for S and S0, a routine check shows\nthat F T is a legitimate-agreement forest for T and T 0.\nFurthermore, as the contribution of the isolated vertices\nlabeled a; b to w\u00f0FS\u00de is the same as the contribution of\nthe isolated vertices labeled a1; a2; . . . ; an to w\u00f0F T \u00de in\ncase 2, we have that f\u00f0T ; T 0\u00de \u0003 f\u00f0S;S0\u00de. This completes\nthe proof of the proposition. tu\nProposition 3.2 says that the tree reduction rules, Rules 1\nand 2, preserve the function f . We now show that Rules 1\nand 2 can be applied until the label set of the resulting\nrooted binary phylogenetic trees has size bounded by a\nlinear function of the value of f .\nLemma 3.3. Let T and T 0 be two rooted binary phylogenetic\nX-trees and let P be an empty collection of 2-element subsets\nof X. Let S and S0 be two weighted phylogenetic X0-trees\nobtained from T and T 0, respectively, by repeatedly applying\nRules 1 and 2 until no further reduction is possible. Then,\njX0j < 14h\u00f0T ; T 0\u00de.\nProof. As in [5, Lemma 3.3], we follow the approach in\n[1, Lemma 3.7]. Let fS\u0002;S1; . . . ;Skg be a legitimate-\nagreement forest for S and S0 with minimum weight. For\ni \u00bc \u0002; 1; 2; . . . ; k, set Li \u00bc L\u00f0Si\u00de and let ni denote the\nnumber of edges in E\u00f0S\u00de \u0002E\u00f0S\u00f0Li\u00de\u00de which are incident\nwith the subtree S\u00f0Li\u00de and let n0i denote the number of\nedges in E\u00f0S0\u00de \u0002 E\u00f0S0\u00f0Li\u00de\u00de which are incident with the\nsubtree S0\u00f0Li\u00de. The proof essentially consists of two\nclaims.\nClaim 1.\nP\ni ni \u0003 2k and\nP\ni n\n0\ni \u0003 2k.\nBy symmetry, it suffices to show that\nP\ni ni \u0003 2k.\nConsider the tree \u00f0V ;E\u00de obtained from S by contracting\nBORDEWICH AND SEMPLE:COMPUTING THE HYBRIDIZATION NUMBER OF TWO PHYLOGENETIC TREES IS FIXED-PARAMETER ... 463\nFig. 8. Corresponding components of F T and FS for Cases 1 and 2.\nAuthorized licensed use limited to: University of Durham. Downloaded on January 6, 2010 at 09:24 from IEEE Xplore.  Restrictions apply. \neach subtree S\u00f0Li\u00de to a single vertex. In this tree, V\nconsists of the vertices corresponding to the trees Si, each\nof which has degree ni, and the additional vertices of\ndegree 3. Hence, by the Handshaking Lemma,P\ni ni \u00fe 3\u00f0jV j \u0002 \u00f0k\u00fe 1\u00de\u00de \u00bc 2jEj. Therefore, as \u00f0V ;E\u00de is a\ntree and so jV j \u00bc jEj \u00fe 1, it follows that\nX\ni\nni \u00bc 2 jV j \u0002 1\u00f0 \u00de \u0002 3 jV j \u0002 \u00f0k\u00fe 1\u00de\u00f0 \u00de \u00bc 3k\u0002 jV j \u00fe 1 \u0003 2k:\nThus, Claim 1 holds.\nClaim 2. For each i, the number of leaves in Si is at most\n5\u00f0ni \u00fe n0i\u00de \u0002 6.\nLet I be the set of edges e of Si such that, in the path of\nedges corresponding to e in either S\u00f0Li\u00de or S0\u00f0Li\u00de, one of\nthe vertices in this path is incident with an edge in\nE\u00f0S\u00de \u0002 E\u00f0S\u00f0Li\u00de\u00de or E\u00f0S0\u00de \u0002E\u00f0S\u00f0Li\u00de\u00de, respectively. Note\nthat jIj \u0003 ni \u00fe n0i. Let S0i denote the tree obtained from\nthe minimal subtree of Si that contains the edges in I by\nsuppressing nonroot degree-2 vertices not incident\nwith an edge in I. Let J denote the set consisting of\nthese new edges, E\u00f0S0i\u00de \u0002 I, and let Ipend denote the set\nof pendant edges of S0i. Note that Ipend \u0006 I. Observe\nthat every subtree of Si below an edge in Ipend will\nhave been replaced by a single vertex using Rule 1, as\nthese pendant subtrees are clearly common to both\ntrees since they are in the agreement forest and they\nare maximal by Lemma 3.1. Similarly, each chain of\nsubtrees in Si corresponding to an edge in J will have\nbeen replaced by a 2-chain using Rules 1 and 2.\nFurthermore, the only other place a subtree, again\nreduced to a leaf under Rule 1, could attach itself to Si\nis at a degree-2 vertex that is incident with two edges\nin I. If we identify each such vertex by the edge in I\nabove it, it is clear that there are at most jIj \u0002 jIpendj\nsuch leaves. Hence, the number of leaves in Si is at\nmost jIpendj \u00fe 2jJ j \u00fe \u00f0jIj \u0002 jIpendj\u00de \u00bc jIj \u00fe 2jJj.\nLet m2 and m3 denote the number of vertices of S0i of\ndegree 2 and 3, respectively. Then, as jIpendj is the number\nof vertices of degree 1, it follows by the Handshaking\nLemma that 2jE\u00f0S0i\u00dej \u00bc jIpendj \u00fe 2m2 \u00fe 3m3. Therefore, as\njE\u00f0S0i\u00dej \u00bc jV \u00f0S0i\u00dej \u0002 1,\n2 jIpendj \u00fem2 \u00fem3 \u0002 1\n\u0002 \u0003 \u00bc jIpendj \u00fe 2m2 \u00fe 3m3:\nThis last equality implies that m3 \u00bc jIpendj \u0002 2. Further-\nmore,\njJ j \u00fe jIj \u00bc \u00f0jIpendj \u00fem2 \u00fem3\u00de \u0002 1\nand, by construction, any degree-2 vertex in S0i must be\nadjacent to at least one edge in I, so m2 \u0003 2jIj \u0002 jIpendj.\nTherefore, the number of leaves in Si is at most\njIj \u00fe 2jJ j \u00bc jIj \u00fe 2\u00f0jIpendj \u00fem2 \u00fem3 \u0002 1\u0002 jIj\u00de\n\u0003 jIj \u00fe 2\u00f0jIpendj \u00fe \u00f02jIj \u0002 jIpendj\u00de \u00fe \u00f0jIpendj \u0002 2\u00de\n\u0002 1\u0002 jIj\u00de\n\u00bc 2jIpendj \u00fe 3jIj \u0002 6\n\u0003 5jIj \u0002 6\n\u0003 5\u00f0ni \u00fe n0i\u00de \u0002 6:\nThis proves Claim 2.\nNow, by Claim 1, we have\nP\ni\u00f0ni \u00fe n0i\u00de \u0003 4k and, so,\nX\ni\njLij \u0003 5\nX\ni\n\u00f0ni \u00fe n0i\u00de \u0002 6\u00f0k\u00fe 1\u00de \u0003 14k\u0002 6:\nBy the definition of f and Proposition 3.2,\nk \u0003 f\u00f0S;S0\u00de \u00bc f\u00f0T ; T 0\u00de. Since P is initially empty, we\nalso have f\u00f0T ; T 0\u00de \u00bc h\u00f0T ; T 0\u00de and the result follows. tu\nWe are now in a position to show that the decision\nproblem HYBRIDIZATION NUMBER is fixed-parameter\ntractable.\nProof of Theorem 1.1. Let T and T 0 be two rooted binary\nphylogenetic X-trees and let P be an empty collection of\n2-element subsets ofX. Let k be an integer. Let S and S0 be\nthe weighted phylogenetic X0-trees obtained from T and\nT 0 by repeatedly applying Rules 1 and 2 until no further\nreduction is possible. Then, as P is empty, h\u00f0T ; T 0\u00de \u00bc\nf\u00f0T ; T 0\u00de and, by Proposition 3.2, f\u00f0T ; T 0\u00de \u00bc f\u00f0S;S0\u00de, thus\nh\u00f0T ; T 0\u00de \u00bc f\u00f0S;S0\u00de. As in [1] and [5], S and S0 can be\nfound in time polynomial in jXj (p\u00f0jXj\u00de, say). By\nLemma 3.3, jX0j \u0003 14h\u00f0T ; T 0\u00de. Thus, if jX0j > 14k, we\ndeclare that h\u00f0T ; T 0\u00de > k.\nNow, suppose that jX0j \u0003 14k. We next consider the\ntime taken to check whether there is a legitimate-\nagreement forest for S and S0 of weight at most k by\ndeleting up to k edges of S and then seeing if the resulting\nforest is such a legitimate-agreement forest. Note that\nchecking for legitimacy takes polynomial time. For a given\nrooted binary phylogenetic X0-tree, there are 2jX0j \u0002 1\npossible edges to delete, including the edge incident with\n\u0002. Thus, there are at most\nPk\ni\u00bc0\n2jX0 j\u00021\ni\n\u0004 \u0005\n\u0003Pki\u00bc0\u00f02jX0j \u0002\n1\u00dei \u0003 2\u00f02jX0j \u0002 1\u00dek forests to examine, which can be done\nin time O\u00f0\u00f02jX0j\u00dek\u00de \u00bc O\u00f0\u00f028k\u00dek\u00de. If one of these forests is\na legitimate-agreement forest for S and S0 with weight at\nmost k, then we declare h\u00f0T ; T 0\u00de \u0003 k. Otherwise, we\ndeclare h\u00f0T ; T 0\u00de > k. Hence, we can answer the\nHYBRIDIZATION NUMBER decision problem for T and\nT 0 in time O\u00f0f\u00f0k\u00de \u00fe p\u00f0jXj\u00de\u00de, where f\u00f0k\u00de is the computable\nfunction \u00f028k\u00dek and p\u00f0jXj\u00de is the polynomial bound for\nreducing the trees using Rules 1 and 2. This satisfies the\nconditions for HYBRIDIZATION NUMBER to be fixed-\nparameter tractable. tu\nRemark. By making an organized comparison of the set of\nclusters of T and the set of clusters of T 0, a naive\napproach for fully reducing T and T 0 using Rules 1 and 2\nresults in an O\u00f0n3\u00de algorithm, where n \u00bc jXj. While a\nfurther such approach for deciding if a particular set of\nk edge cuts produces a legitimate-agreement forest for T\nand T 0 gives an O\u00f0k2 \u00fe jP j\u00de algorithm. We omit the\ndetails of these algorithms as they are not necessarily the\nbest theoretically and we expect, in practice, much\nquicker methods. An implementation of the associated\nfixed-parameter algorithm and an analysis of its running\ntime is the subject of ongoing research.\n464 IEEE\/ACM TRANSACTIONS ON COMPUTATIONAL BIOLOGY AND BIOINFORMATICS, VOL. 4, NO. 3, JULY-SEPTEMBER 2007\nAuthorized licensed use limited to: University of Durham. Downloaded on January 6, 2010 at 09:24 from IEEE Xplore.  Restrictions apply. \n4 SOME REMARKS ON RSPR DISTANCE AND\nHYBRIDIZATION NUMBER\nIn this section, we compare the approach used to prove\nTheorem 1.1 with that used in [5] for showing that rSPR\nDISTANCE is fixed-parameter tractable. We begin by\nformally defining the subtree prune and regraft operation.\nLet T be a rooted binary phylogenetic X-tree and, as in\nthe definition of an agreement forest, view the root of T as a\nvertex \u0002 adjoined to the original root by a new pendant\nedge. Let e \u00bc fu; vg be an edge of T that is not incident with\n\u0002, where u is in the path from \u0002 to v. Let T 0 be the rooted\nbinary phylogenetic X-tree obtained from T by deleting e\nand then adjoining a new edge f between v and the\ncomponent Cu that contains u as follows: Create a new\nvertex u0 which subdivides an edge in Cu, adjoin f between\nu0 and v, and then suppress the degree-two vertex u. The\ntree T 0 has been obtained from T by a single rooted subtree\nprune and regraft (rSPR) operation. The rSPR distance \u00f0drSPR\u00de\nbetween two arbitrary rooted binary phylogenetic X-trees T\nand T 0 is the minimum number of rSPR operations required\nto transform T into T 0.\nHistorically, drSPR\u00f0T ; T 0\u00de has been used as a replacement\nfor h\u00f0T ; T 0\u00de. The reason for this is that individual\nhybridization events correspond to individual rSPR opera-\ntions and, indeed, a collection of hybridization events can\nbe modeled by a sequence of rSPR operations. However, the\nconverse does not hold since an arbitrary sequence of rSPR\noperations may include circular inheritance. It is shown in\n[2] that the difference between rSPR DISTANCE and\nHYBRIDIZATION NUMBER can be arbitrarily large. Never-\ntheless, the two values are closely related. Recall Theo-\nrem 2.1, which says that, for two rooted binary phylogenetic\nX-trees, T and T 0, the value h\u00f0T ; T 0\u00de is one less than the\nnumber of components in a maximum-acyclic-agreement\nforest, ma\u00f0T ; T 0\u00de. In comparison, we have the following\nresult from [5]:\nTheorem 4.1. Let T and T 0 be two rooted binary phylogenetic\nX-trees. Then, drSPR\u00f0T ; T 0\u00de \u00bc m\u00f0T ; T 0\u00de, where m\u00f0T ; T 0\u00de\ndenotes the size of a maximum-agreement forest for T and T 0\nminus one.\nThe overall approach we have used to prove Theorem 1.1\nis similar to that used in [5] to show that rSPR DISTANCE is\nfixed-parameter tractable (parameterized by drSPR\u00f0T ; T 0\u00de),\nbut there are some crucial differences. In both papers, the\nproblems are kernalized using two reduction rules which\nbound the size of the leaf sets of the resulting pairs of trees\nin terms of the parameter. The first rule in [5] is essentially\nidentical to Rule 1 here, but the second rule differs from\nRule 2 here. The lack of the acyclicity constraint means that\nthere is a maximum-agreement forest in which every\ncommon n-chain \u00f0n \u0005 3\u00de is a connected subtree of a\ncomponent [5, Lemma 3.1] and, so, each such chain can\nbe replaced by an unweighted 3-chain.\nThe implication of this is that there is no need forweighted\nforests, so, if S and S0 are the rooted binary phylogenetic\nX0-trees resulting from applying the appropriate two rules,\nthen the size of a maximum-agreement forest for T and T 0 is\nbounded above by jX0j, the number of leaves in S (or S0). The\nconsequence is that the fixed-parameter algorithm for\nrSPR DISTANCE in [5] also provides a polynomial-time\napproximation algorithm for this problem. The analogue of\nLemma 3.3 in [5] (with the upper bound on drSPR\u00f0T ; T 0\u00de\nincluded) is that\ndrSPR\u00f0T ; T 0\u00de \u0003 jX0j \u0003 28drSPR\u00f0T ; T 0\u00de:\nTherefore, the size of the label sets of the reduced trees S\nand S0 gives a 28-approximation for drSPR\u00f0T ; T 0\u00de. With some\nmodifications along the lines of legitimate-agreement\nforests, this approach can be made to yield a 9-approxima-\ntion. However, no such approximation algorithm for\nHYBRIDIZATION NUMBER follows in an analogous way\nfrom the results in this paper since jX0j does not bound the\nhybridization number due to the presence of weights.\nIndeed, there is currently no polynomial-time approxima-\ntion algorithm for HYBRIDIZATION NUMBER.\nUsing a different approach, based upon ideas in [13],\n[16], the current best polynomial-time approximation\nalgorithm for rSPR DISTANCE is a 5-approximation algo-\nrithm by Bonet et al. [4]. Intuitively, this algorithm builds an\nagreement forest by looking only at local structures. One\nmight hope that this algorithm extends to HYBRIDIZATION\nNUMBER (using Theorem 2.1), but, due to the additional\nglobal condition on an acyclic-agreement forest, it seems\nunlikely that such an approach will work.\nACKNOWLEDGMENTS\nMagnus Bordewich was supported by the EPSRC and\nCharles Semple was supported by the New Zealand\nMarsden Fund.\nREFERENCES\n[1] B.L. Allen and M. Steel, \u201cSubtree Transfer Operations and Their\nInduced Metrics on Evolutionary Trees,\u201d Annals of Combinatorics,\nvol. 5, pp. 1-13, 2001.\n[2] M. Baroni, S. Gru\u00a8newald, V. Moulton, and C. Semple, \u201cBounding\nthe Number of Hybridization Events for a Consistent Evolu-\ntionary History,\u201d Math. Biology, vol. 51, pp. 171-182, 2005.\n[3] M. Baroni, C. Semple, and M. Steel, \u201cHybrids in Real Time,\u201d\nSystematic Biology, vol. 55, pp. 46-56, 2006.\n[4] M.K. Bonet, K. St. John, R. Mahindru, and N. Amenta,\n\u201cApproximating Subtree Distances between Phylogenies,\u201d J.\nComputational Biology, vol. 13, pp. 1419-1434, 2006.\n[5] M. Bordewich and C. Semple, \u201cOn the Computational Complexity\nof the Rooted Subtree Prune and Regraft Distance,\u201d Annals of\nCombinatorics, vol. 8, pp. 409-423, 2004.\n[6] M. Bordewich and C. Semple, \u201cComputing the MinimumNumber\nof Hybridisation Events for a Consistent Evolutionary History,\u201d\nDiscrete Applied Math., vol. 155, pp. 914-928, 2007.\n[7] R. Downey and M. Fellows, Parameterized Complexity. Springer,\n1998.\n[8] D. Gusfield and V. Bansal, \u201cA Fundamental Decomposition\nTheory for Phylogenetic Networks and Incompatible Characters,\u201d\nProc. Ninth Ann. Int\u2019l Conf. Research in Computational Molecular\nBiology (RECOMB \u201905), S. Miyano et al., eds. pp. 217-232, 2005.\n[9] D. Gusfield, S. Eddhu, and C. Langley, \u201cOptimal, Efficient\nReconstruction of Phylogenetic Networks with Constrained\nRecombination,\u201d J. Bioinformatics and Computational Biology,\nvol. 2, pp. 173-213, 2004.\n[10] M. Hallett and J. Lagergren, \u201cEfficient Algorithms for Lateral\nGene Transfer Problems,\u201d Proc. Fifth Ann. Int\u2019l Conf. Research in\nComputational Molecular Biology (RECOMB \u201901), pp. 149-156, 2001.\n[11] J. Hein, \u201cReconstructing Evolution of Sequences Subject to\nRecombination Using Parsimony,\u201d Math. Biosciences, vol. 98,\npp. 185-200, 1990.\nBORDEWICH AND SEMPLE:COMPUTING THE HYBRIDIZATION NUMBER OF TWO PHYLOGENETIC TREES IS FIXED-PARAMETER ... 465\nAuthorized licensed use limited to: University of Durham. Downloaded on January 6, 2010 at 09:24 from IEEE Xplore.  Restrictions apply. \n[12] J. Hein, \u201cA Heuristic Method to Reconstruct the History of\nSequences Subject to Recombination,\u201d J. Molecular Evolution,\nvol. 36, pp. 396-405, 1993.\n[13] J. Hein, T. Jing, L. Wang, and K. Zhang, \u201cOn the Complexity of\nComparing Evolutionary Trees,\u201d Discrete Applied Math., vol. 71,\npp. 153-169, 1996.\n[14] W. Maddison, \u201cGene Trees in Species Trees,\u201d Systematic Biology,\nvol. 46, pp. 523-536, 1997.\n[15] L. Nakhleh, T. Warnow, C.R. Linder, and K. St. John, \u201cRecon-\nstructing Reticulate Evolution in Species\u2014Theory and Practice,\u201d J.\nComputational Biology, vol. 12, pp. 796-811, 2005.\n[16] E.M. Rodrigues, M.-F. Sagot, and Y. Wakabayashi, \u201cSome\nApproximation Results for the Maximum Agreement Forest\nProblem,\u201d Approximation, Randomization and Combinatorial Optimi-\nzation: Algorithms and Techniques, M. Goemans et al., eds., pp. 159-\n169, Springer, 2001.\n[17] C. Semple and M. Steel, Phylogenetics. Oxford Univ. Press, 2003.\n[18] Y.S. Song and J. Hein, \u201cParsimonious Reconstruction of Sequence\nEvolution and Haplotyde Blocks: Finding the Minimum Number\nof Recombination Events,\u201d Algorithms in Bioinformatics, Proc. WABI\n\u201903, G. Benson and R. Page, eds., pp. 287-302, 2003.\n[19] L. Wang, K. Zhang, and L. Zhang, \u201cPerfect Phylogenetic\nNetworks with Recombination,\u201d J. Computational Biology, vol. 8,\npp. 69-78, 2001.\nMagnus Bordewich received the MMath (1998)\nand DPhil degrees in mathematics (2003) from\nNew College, Oxford University. He is a lecturer\nin the Department of Computer Science at the\nUniversity of Durham. Subsequent to receiving\nhis degrees, he was a postdoctoral research\nfellow in the Department of Mathematics and\nStatistics at the University of Canterbury, New\nZealand, and then in the School of Computer\nScience at Leeds University, United Kingdom.\nHe joined Durham University as a lecturer in 2006 and was recently\nawarded an EPSRC postdoctoral fellowship in theoretical computer\nscience, researching randomized algorithms and approximation in\nphylogenetics.\nCharles Semple received the BSc (Hons)\ndegree in mathematics from Massey University\nand the MSc and PhD degrees in mathematics\nfrom Victoria University of Wellington. He is a\nsenior lecturer in the Department of Mathe-\nmatics and Statistics at the University of Canter-\nbury, New Zealand. Initially a postdoctoral\nfellow, he has been a permanent staff member\nat the University of Canterbury since 2001.\nOther academic positions include visiting re-\nsearch fellow at Merton College, University of Oxford (2003) and visiting\nprofessor at the University of Montpellier II (2005). His main research\ninterests are combinatorics, computational complexity, and computa-\ntional biology.\n. For more information on this or any other computing topic,\nplease visit our Digital Library at www.computer.org\/publications\/dlib.\n466 IEEE\/ACM TRANSACTIONS ON COMPUTATIONAL BIOLOGY AND BIOINFORMATICS, VOL. 4, NO. 3, JULY-SEPTEMBER 2007\nAuthorized licensed use limited to: University of Durham. Downloaded on January 6, 2010 at 09:24 from IEEE Xplore.  Restrictions apply. \n"}