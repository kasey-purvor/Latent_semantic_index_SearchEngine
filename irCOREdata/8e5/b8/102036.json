{"doi":"10.1063\/1.2750541","coreId":"102036","oai":"oai:epubs.surrey.ac.uk:1483","identifiers":["oai:epubs.surrey.ac.uk:1483","10.1063\/1.2750541"],"title":"Reappraisal of criticality for two-layer flows and its role in the generation of internal solitary waves","authors":["Bridges, TJ","Donaldson, NM"],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2007-07-01","abstract":null,"downloadUrl":"","fullTextIdentifier":null,"pdfHashValue":null,"publisher":"AMER INST PHYSICS","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:epubs.surrey.ac.uk:1483<\/identifier><datestamp>\n      2017-10-31T14:02:02Z<\/datestamp><setSpec>\n      74797065733D61727469636C65<\/setSpec><setSpec>\n      6469766973696F6E733D656E67616E64706879736963616C736369656E636573:6D617468737075626C<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/epubs.surrey.ac.uk\/1483\/<\/dc:relation><dc:title>\n        Reappraisal of criticality for two-layer flows and its role in the generation of internal solitary waves<\/dc:title><dc:creator>\n        Bridges, TJ<\/dc:creator><dc:creator>\n        Donaldson, NM<\/dc:creator><dc:publisher>\n        AMER INST PHYSICS<\/dc:publisher><dc:date>\n        2007-07-01<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/epubs.surrey.ac.uk\/1483\/1\/fulltext.pdf<\/dc:identifier><dc:identifier>\n          Bridges, TJ and Donaldson, NM  (2007) Reappraisal of criticality for two-layer flows and its role in the generation of internal solitary waves   PHYSICS OF FLUIDS, 19 (7), ARTN 0.       <\/dc:identifier><dc:relation>\n        10.1063\/1.2750541<\/dc:relation><dc:language>\n        English<\/dc:language><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/epubs.surrey.ac.uk\/1483\/","10.1063\/1.2750541"],"year":2007,"topics":[],"subject":["Article","PeerReviewed"],"fullText":"Reappraisal of criticality for two-layer flows and its role in the\ngeneration of internal solitary waves\nThomas J. Bridges and Neil M. Donaldson\nDepartment of Mathematics, University of Surrey,\nGuildford, Surrey, GU2 7XH, England\nMay 9, 2007\nAbstract\nA geometric view of criticality for two-layer flows is presented. Uniform flows are classified by\ndiagrams in the momentum-massflux space for fixed Bernoulli energy, and cuspoidal curves on\nthese diagrams correspond to critical uniform flows. Restriction of these surfaces to critical\nflow leads to new sub-surfaces in energy-massflux space. While the connection between\ncriticality and the generation of solitary waves is well known, we find that the nonlinear\nproperties of these bifurcating solitary waves are also determined by the properties of the\ncriticality surfaces. To be specific, the case of two layers with a rigid lid is considered, and\napplication of the theory to other multi-layer flows is sketched.\n1 Introduction\nThe inviscid flow of two layers of homogeneous fluid of differing density is one of the fundamental\nsimplified models for stratified flow in the atmosphere and ocean. Criticality of uniform flows\nprovides an organizing center for the bifurcation of internal shocks and solitary waves (see\nrecent reviews of Grimshaw [16] and Helfrich & Melville [17] and references therein). In\nthis paper a new perspective on criticality of uniform flows in the two layer system and its\nimplication is presented. For definiteness, attention will be restricted to the case of a rigid lid,\nas shown schematically in Figure 1.\nOur results are not new in the sense that the condition for criticality for two-layer uniform\nflows is well understood (e.g. Armi [1], Baines [2], Bu\u00a8hler [10] and references therein), and\nthe existence of solitary waves bifurcating at criticality is also well understood, indeed even to\nfinite amplitude (e.g. Benjamin [4], Choi & Camassa [11], Dias & Vandenbroeck [13],\nFunakoshi & Oikawa [15], Laget & Dias [18], Long [19], Pullin & Grimshaw [20]).\nHowever, this paper gives a new perspective on criticality, showing that the geometry of the\nsurfaces of uniform flows, and the surfaces of criticality give basic information about the flow\n\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\n\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\n\u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002\n\u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002 \u0002\n\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\n\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\n\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\n\u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004\n\u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004\n\u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004 \u0004\nu\n\u03c1\n2 u2 h2\n\u03c11 1 h1\nFigure 1: Schematic of the two layer flow with a rigid lid.\n1\nQS\nR\nFigure 2: Slices of constant R with R > 0 of the surface in (S,Q,R) space defined by (1.1).\nfield, including the prediction of nonlinear properties of bifurcating solitary waves. The geometric\nview of the uniform flows organizes the flow parameters in a precise way. This latter property\nis particularly valuable when considering the effect of mean flow on non-trivial internal waves\n(see [9] for the analogous result for one-layer flows).\nTo give some idea of the strategy in the paper, the theory for single layer flows is first\nreviewed. The critical functionals for single-layer uniform flow of unit density, depth h and\nvelocity u are\nR = gh + 12 u\n2 , Q = hu , S = hu2 + 12 gh\n2 , (1.1)\nwhere g > 0 is the gravitational constant. These functionals are the Bernoulli energy, mass\nflux and momentum flux respectively. For given values of R and Q , uniform flows correspond\nto solutions of the first two equations \u2013 when the mapping from (R,Q) to (h, u) is uniquely\ninvertible; that is when\ndet\n[\nRh Ru\nQh Qu\n]\n6= 0 .\nThe flow is defined to be critical when the mapping is not uniquely invertible:\n0 = det\n[\nRh Ru\nQh Qu\n]\n= det\n[\ng u\nu h\n]\n= gh\u2212 u2 ,\nwhich recovers the familiar condition in terms of the Froude number: 1 = F 2 := u\n2\ngh . It can be\nshown that this definition of criticality is equivalent to the degeneracy of the linear long wave\nspeed. See Appendix A of [1] for the definition of criticality in terms of linear long wave speed,\nand see [9] for the equivalence with the definition used here.\nThe way to view uniform flows \u2013 including the momentum flux \u2013 is to plot them in the\nthree-dimensional (R,Q, S) space as shown in Figure 2. This figure shows slices through the\nsurface of uniform flows for fixed R > 0. For fixed R > 0 the depth of a uniform flow satisfies\nh =\n1\ng\nR\u2212 1\n2g\nu2 .\nSubstituting this expression into Q and S gives a parameterized curve in the Q\u2212 S plane:\nQ(u) = Rg u\u2212 12gu3\nS(u) = R\n2\n2g +\nR\n2g u\n2 \u2212 38gu4\n}\n\u2212\n\u221a\n2R < u <\n\u221a\n2R . (1.2)\n2\nnh\nu Q\nR\n(R,Q)\nFigure 3: Geometry of the mapping from (h, u) space to (R,Q) space of the criticality curve\ngh\u2212 u2 = 0.\nFor any fixed R , the range of u is bounded: u2 < 2R . The idea of plotting curves of uni-\nform flows (and more general flows) in the SQR space was first proposed by Benjamin &\nLighthill [6]. However, it was Sewell & Porter [22] (see also page 379 of Sewell [21])\nwho first recognized the importance of plotting in the full three-dimensional space.\nThe curves of uniform flow are similar for any R > 0. The cusp points on the curves with R\nfixed correspond to critical flows, and are computed from Q\u2032(u) = S\u2032(u) = 0 (R fixed). In the\nlimit as R \u2192 0 the two curves of cusp points join together in a third cusp at S = R = Q = 0.\nThe projection onto the (R,Q)\u2212plane of the two curves of criticality is shown on the right in\nFigure 3.\nCritical uniform flows consist of points in the (h, u)\u2212plane satisfying gh = u2 . This curve\nis shown on the left in Figure 3. The image of this curve in the (R,Q) plane is shown in the\nright figure.\nThere is important geometry in these figures which shows up in the analysis of criticality\nand in the bifurcation of solitary waves. The vector labelled n in Figure 3 is the normal vector\nto the curve of criticality in the (R,Q) plane. This vector is also in the kernel of the Jacobian\nof the mapping (h, u) 7\u2192 (R(h, u), Q(h, u)) :\nJac(h, u)n = 0 , where Jac(h, u) :=\n[\nRh Ru\nQh Qu\n]\n.\nThe vector n plays another role in determining the location of the cusp in the (R,Q)\u2212plane.\nThe cusp point in the (R,Q)\u2212plane is the image of the point on the curve gh \u2212 u2 = 0 where\nn is tangent to the curve. Let f(h, u) = gh\u2212 u2 . Then the criticality curve is f\u22121(0) and n is\ntangent to this curve if \u2207f \u00b7 n = 0. Now, n = n0(\u2212u, g) where n0 is a non-zero multiplicative\nconstant, and so\n\u2207f \u00b7 n = \u22123gn0u .\nHence \u2207f \u00b7 n = 0 on f\u22121(0) when (h, u) = (0, 0). While it is obvious from the figure that the\ncusp point is the image of (h, u) = (0, 0) this more elaborate geometrical construction will be\nnecessary when considering higher-dimensional surfaces that appear in two-layer flow.\nThis geometry shows up when considering the solitary waves that bifurcate at criticality. The\nappropriate model for bifurcating weakly nonlinear solitary waves is the steady KdV equation.\nWrite the KdV equation for the wave height \u03b7 in the form\n\u03b7t + \u03ba\u03b7\u03b7x \u2212 \u03c4\u03b7xxx = 0 ,\nwhere \u03c4 is proportional to the Bond number minus 13 (see equation (5.15) for the analogous\ncoefficient for two-layer flow), and \u03ba is the coefficient of the nonlinear term. These coefficients\n3\ncan be removed by scaling, but there is an interesting connection between \u03ba and the geometry\nof the criticality curve. The steady KdV equation reduces to the ODE\n\u2212\u03c4\u03b7xx = I \u2212 12 \u03ba\u03b72 ,\nwhere I is a constant of integration. The coefficient \u03ba is determined by the remarkable formula\n\u03ba = a1\u2207f \u00b7 n ,\nwhere a1 is a positive scaling function. See \u00a73 of [9] for further elaboration of this example. The\ndetails of the theory justifying these results can be found in [8, 9, 7].\nThe purpose of this paper is to apply these ideas to the case of two-layer flows. There are\nthree features of interest to generalize. First, the set of basic functionals generalizing (1.1) is\nR,Q1, Q2 and S , and so the surface of uniform flows is a three-dimensional hypersurface, but\nwith R fixed it is reduced to a two-dimensional surface in R3 , generalizing Figure 2. The cusp\ncurves on this figure correspond to critical flows.\nSecondly, the curves shown in Figure 3 will be generalized to a surface associated with a\nmapping from (h1, u1, u2) to (R,Q1, Q2) . The condition of criticality for two-layer flows with a\nrigid lid takes the familiar form\nF 21 + rF\n2\n2 = 1 , F\n2\nj =\nu2j\ng(1 \u2212 r)h2j\n, r =\n\u03c12\n\u03c11\n. (1.3)\n(cf. Armi [1], Baines [2], Bu\u00a8hler [10] and references therein). This condition is normally\ndetermined by solving for the normal mode solutions of the time-dependent equations, linearized\nabout uniform flow, and determining conditions for when the characteristic velocities vanish (cf.\nAppendix A of Armi [1]). Here it is shown that criticality follows from degeneracy of the\nJacobian of the mapping from (h1, u1, u2) to (R,Q1, Q2) (see \u00a74 for details).\nThe equation (1.3) defines a hypersurface in the three-dimensional (h1, u1, u2) space, gener-\nalizing the left-hand curve in Figure 3. The geometry of this surface, and its image in (R,Q1, Q2)\nis studied (see Figure 8 in \u00a74). Thirdly, in \u00a75.1, it is shown how the geometry of these criticality\nsurfaces predicts the nonlinear properties of the bifurcating internal solitary waves.\n2 Shallow-water two-layer flow with a rigid lid\nThe shallow water equations for two layers with a rigid lid take the following form (cf. \u00a73.3 of\nBaines [2])\n\u2202\n\u2202t\n(\u03c11h1) +\n\u2202\n\u2202x\n(\u03c11h1u1) = 0,\n\u2202\n\u2202t\n(\u03c12h2) +\n\u2202\n\u2202x\n(\u03c12h2u2) = 0,\n\u2202\n\u2202t\n(\u03c11u1) +\n\u2202\n\u2202x\n(\n1\n2\n\u03c11u\n2\n1 + \u03c11gh1 + \u03c12gh2 + ps\n)\n= 0,\n\u2202\n\u2202t\n(\u03c12u2) +\n\u2202\n\u2202x\n(\n1\n2\n\u03c12u\n2\n2 + \u03c12gh1 + \u03c12gh2 + ps\n)\n= 0,\n(2.1)\nwhere ps is the pressure at the rigid lid. Accompanying these equations is the rigid lid constraint\nd = h1 + h2 , with d a given positive constant. In these equations u1(x, t) and u2(x, t) are the\ndepth-averaged horizontal velocities and h1(x, t) and h2(x, t) are the layer depths. The two\nBernoulli equations can be combined by subtracting the fourth equation from the third to\neliminate the lid pressure,\n\u2202\n\u2202t\n(\u03c11u1 \u2212 \u03c12u2) + \u2202\n\u2202x\n(\n1\n2\n\u03c11u\n2\n1 \u2212\n1\n2\n\u03c12u\n2\n2 + (\u03c11 \u2212 \u03c12)gh1\n)\n= 0 . (2.2)\n4\nSome comments on the role of the lid pressure in the computation of uniform flows is given in\nAppendix A.\nSteady flows \u2013 which in this case are uniform flows \u2013 satisfy these equations with the time-\nderivative terms dropped. Uniform flows therefore correspond to constant values of (R,Q1, Q2)\nwith\nR = 12\u03c11u\n2\n1 \u2212 12\u03c12u22 + (\u03c11 \u2212 \u03c12)gh1\nQ1 = \u03c11h1u1\nQ2 = \u03c12(d\u2212 h1)u2 .\n(2.3)\nThe Bernoulli energy R = R1 \u2212R2 is the composite energy and so it can take negative values.\nNegative R corresponds to higher energy in the upper layer since R < 0 implies R2 > R1 .\nAccompanying the functions (R,Q1, Q2) is the reduced momentum flux\nS = \u03c11h1u\n2\n1 + \u03c12\n(\n1\n2 d\u2212 h1\n)\nu22 +\n1\n2 (\u03c11 \u2212 \u03c12)gh21 . (2.4)\nThis function satisfies\n\u2202\n\u2202t\n(\u03c11u1h1 \u2212 \u03c12u2h1) + \u2202\n\u2202x\n(S) = 0 .\nThe connection between the reduced momentum flux and the physical momentum flux is dis-\ncussed in Appendix B.\nOur first step in the classification of uniform flows is to take R fixed and look at surfaces of\nuniform flows in the three-dimensional (Q1, Q2, S) space.\n3 Uniform flows in (Q1, Q2, S) space\nThe functions in (2.3)-(2.4) can be viewed as a mapping from R3 = {(h1, u1, u2) : 0 < h1 < d}\nto R4 = {S,Q1, Q2, R} . This hypersurface is a generalization of the surface for a single layer\nfluid shown in Figure 2.\nTaking R fixed, h1 can be expressed as a function of r , R , and the velocities\nh1 =\n2R\u2212 \u03c11u21 + \u03c12u22\n2\u03c11g(1\u2212 r) . (3.5)\nSubstituting this expression for h1 into the equations for Q1 , Q2 and S with fixed r , and R\nresults in a parameterized hypersurface in the three-dimensional (Q1, Q2, S) space,\nQ\u02dc1(u\u02dc1, u\u02dc2) =\nu\u02dc1\n2(1 \u2212 r)\n(\n2R \u2212 u\u02dc21 + ru\u02dc22\n)\n,\nQ\u02dc2(u\u02dc1, u\u02dc2) =\nu\u02dc2\n2(1 \u2212 r)\n(\n2(1 \u2212 r)\u2212 2R + u\u02dc21 \u2212 ru\u02dc22\n)\n,\nS\u02dc(u\u02dc1, u\u02dc2) = \u2212 1\n8(1\u2212 r)\n(\n3u\u02dc41 \u2212 6ru\u02dc21u\u02dc22 + 3r2u\u02dc42 \u2212 4Ru\u02dc21 + 4r(R + r \u2212 1)u\u02dc22 \u2212 4R2\n)\n,\nwhere the tilde variables are defined by\nu\u02dc1 =\nu1\u221a\ngd\n, u\u02dc2 =\nu2\u221a\ngd\n, h\u02dc1 =\nh1\nd\n, h\u02dc2 =\nh2\nd\n,\nQ\u02dc1 =\nQ1\n\u03c11d\n\u221a\ngd\n, Q\u02dc2 =\nQ2\n\u03c12d\n\u221a\ngd\n, R\u02dc =\nR\n\u03c11gd\n, S\u02dc =\nS\n\u03c11gd2\n,\n(3.6)\nand R represents the value of R\u02dc . The surface is parameterized by u\u02dc1 and u\u02dc2 . The feasible\nregion in velocity space is determined by requiring h1 > 0 and h2 = d \u2212 h1 > 0. Using (3.5)\nthese constraints lead to\nu\u02dc21\nr\n\u2212 2R\nr\n< u\u02dc22 <\nu\u02dc21\nr\n+\n2\nr\n(1\u2212 r \u2212R) . (3.7)\n5\nCase 1 Case 2 Case 3\nu2\n2\nu1\n2\nFigure 4: Schematic of feasible regions of uniform flows in velocity space. The shaded regions\n(which extend to infinity) consist of admissible velocity fields for uniform flow. Equations for the\nupper and lower boundaries are given in equation (3.7). Case 1: R < 0, Case 2: 0 < R < 1\u2212r ,\nCase 3: R > 1\u2212 r .\nIn the velocity space (u\u02dc21, u\u02dc\n2\n2) these constraints define an infinite strip bounded above and below\nby parallel straight lines with slope r\u22121 . There are three cases depending on whether the energy\nis predominantly in the upper or lower layer. A schematic of the three cases is shown in Figure\n4. Case 1 corresponds to R < 0. In this case the upper fluid energy is dominant since R2 > R1 .\nCase 2 corresponds to 0 < R < 1 \u2212 r , where the energy in the upper and lower layers is in\nbalance. Case 3 corresponds to R > 1\u2212 r , and in this case the lower fluid energy is dominant.\nTo plot surfaces of uniform flows in the scaled (Q1, Q2, S) space an upper limit is chosen\nfor u\u02dc21 which ensures that the interesting features of the surfaces (the criticality regions) are\nincluded. The three sets of surfaces, corresponding to examples for Cases 1, 2, and 3 respectively,\nare shown in Figures 5, 6 and 7. The parameter values for each figure are\n\u2022 Figure 5 (Case 1): r = 0.1, R = \u22120.1 and (u\u02dc21)max = 0.5\n\u2022 Figure 6 (Case 2): r = 0.1, R = 0.5 and ((u\u02dc21)max = 1.5\n\u2022 Figure 7 (Case 3): r = 0.1, R = 1.0 and ((u\u02dc21)max = 2.5.\nSurprisingly, the qualitative aspects of the criticality surfaces are independent of the choice of\nr and the Case. This is shown in equation (4.8) and discussed in \u00a74.\nTo obtain the surfaces in figures 5(c), 6(c) and 7(c) showing the criticality regions in closer\ndetail we have set the maximum value of u\u02dc21 to be 0.1, 0.6 and 0.8 respectively. Also in\nfigures 5(c) and 6(c) the maximum value of u\u02dc22 is set to be 10 and 5 respectively. In these\nfigures the curves of critical uniform flows are colored in red. These figures are best viewed\ninteractively in Maple where they can be rotated and enlarged, and copies of the Maple codes\nare available for downloading1.\n3.1 Criticality parabolae in velocity space\nIn part (b) of Figures 5, 6, and 7 the curve of criticality with r , R fixed, in velocity space is\nshown. This curve is computed as follows. Take the well known condition for critical flow (1.3)\nin terms of scaled variables,\nF\u02dc 21 + rF\u02dc\n2\n2 = 1 , with F\u02dc\n2\n1 =\nu\u02dc21\n(1\u2212 r)h\u02dc1\nand F\u02dc 22 =\nu\u02dc22\n(1\u2212 r)\n(\n1\u2212 h\u02dc1\n) . (3.8)\n1http:\/\/www.maths.surrey.ac.uk\/personal\/st\/T.Bridges\/RIGID-LID\/\n(a) The surface of uniform flows associated with Case 1, with (u\u02dc21)max = 0.5 .\n(b) The criticality parabola in velocity\nspace.\n(c) Detailed view of the surface in (a) with the criticality curve\nhighlighted.\nFigure 5: Surface of uniform flows and criticality curves corresponding to Case 1, in terms of\nscaled variables with r = 0.1 and R = \u22120.1.\n7\n(a) The surface of uniform flows associated with Case 2, with (u\u02dc21)max = 1.5 .\n(b) The criticality parabola in velocity\nspace.\n(c) Detailed view of the surface in (a) with the criticality curve\nhighlighted.\nFigure 6: Surface of uniform flows and criticality curves corresponding to Case 2, in terms of\nscaled variables with r = 0.1 and R = 0.5.\n8\n(a) The surface of uniform flows associated with Case 2, with (u\u02dc21)max = 2.5 .\n(b) The criticality parabola in velocity\nspace.\n(c) Detailed view of the surface in (a) with the criticality curve\nhighlighted.\nFigure 7: Surface of uniform flows and criticality curves corresponding to Case 3, in terms of\nscaled variables with r = 0.1 and R = 1.\n9\nEliminate h\u02dc1 in this equation using (3.5) and let u\u02dc\n2\n1 = U and u\u02dc\n2\n2 = V ; then the curve of\ncriticality in velocity space is a quadratic in (U, V ) ,\n3U2\u2212 6rUV +3r2V 2 +(6(1\u2212 r)\u2212 8R)U +(8rR\u2212 2r(1\u2212 r))V +4 (R2 \u2212 (1\u2212 r)R) = 0 . (3.9)\nThis equation is a parabola in U and V since the discriminant, (\u22123r)2 \u2212 3 (3r2) , is zero, and\nit can be parameterized by\nU(s) = U0 \u2212 \u03b1s(rs\u2212 2) , V (s) = V0 \u2212 \u03b1s(2r + s) , \u03b1 = r(1\u2212 r)\n3(1 + r2)2\n, with \u2212\u221e < s < \u221e ,\nwhere U0 and V0 are the coordinates of the vertex of the parabola,\nU0 =\n(\u2212r3 + 2Rr2 + r2 + r + 2R \u2212 1)(\u2212r3 + 2Rr2 + r2 \u2212 3r + 2R + 3)\n12(1 \u2212 r)(1 + r2)2 , (3.10)\nand\nV0 =\n1\nr\nU0 \u2212 4R\n3r\n+\n(1\u2212 r)(3 + r2)\n3r(1 + r2)\n. (3.11)\nThe intersection of this curve with the region of uniform flows gives the critical uniform flows.\nIn part (b) of Figures 5, 6, and 7 the criticality parabolae are colored in red.\n4 Geometry of the criticality surfaces in (R, Q1, Q2) space\nThe surfaces in \u00a73 show all uniform flows, with the critical uniform flows showing up as singular\ncurves on the surfaces. However, in the four dimensional space (S,R,Q1, Q2) the critical uniform\nflows form a 2D surface. In this section, the 2D critical surfaces are projected into R3 . It is\nthese surfaces that contain the geometric information about the bifurcation of internal solitary\nwaves.\nUniform flows are relative equilibria, and they are critical precisely when the relative equi-\nlibrium characterization is degenerate. The details of this analysis for two-layer flows is given\nin \u00a74.3 of Donaldson [14]. The upshot is that uniform flows are critical precisely when the\nmapping\n(h1, u1, u2) 7\u2192 (R(h1, u1, u2), Q1(h1, u1, u2), Q2(h1, u1, u2)) , (4.1)\ngiven in (2.3) is degenerate,\ndet\n[\n\u2202(R,Q1, Q2)\n\u2202(h1, u1, u2)\n]\n= 0 . (4.2)\nFirst note that (R,Q1, Q2) is a gradient mapping. Let\nF (c) = 12 \u03c11h1u\n2\n1 +\n1\n2 \u03c12(d\u2212 h1)u22 + 12 (\u03c11 \u2212 \u03c12)gh21 .\nThen\nR := \u2202F\u2202h1 =\n1\n2\u03c11u\n2\n1 \u2212 12\u03c12u22 + (\u03c11 \u2212 \u03c12)gh1\nQ1 :=\n\u2202F\n\u2202u1\n= \u03c11h1u1\nQ2 :=\n\u2202F\n\u2202u2\n= \u03c12(d\u2212 h1)u2 .\n(4.3)\nIt follows from the gradient structure that the Jacobian in (4.2) is symmetric.\nTo simplify notation, let\nc := (h1, u1, u2) and P(c) := (R(c), Q1(c), Q2(c)) . (4.4)\nThen the Jacobian DP(c) is\nDP(c) =\n\uf8ee\uf8f0(\u03c11 \u2212 \u03c12)g \u03c11u1 \u2212\u03c12u2\u03c11u1 \u03c11h1 0\n\u2212\u03c12u2 0 \u03c12(d\u2212 h1)\n\uf8f9\uf8fb , (4.5)\n10\nand so\ndet(DP(c)) = \u03c11\u03c12(\u03c11 \u2212 \u03c12)gh1(d\u2212 h1)\n[\n1\u2212 F 21 \u2212 rF 22\n]\n, (4.6)\nwhere F 21 and F\n2\n2 are as defined in (1.3). Setting det(DP(c)) = 0 recovers the familiar condition\nfor criticality of two-layer uniform flows with a rigid lid.\nAt criticality, the Jacobian has rank 2 (it is not further deficient). This statement is confirmed\nby noting that DP(c) has rank two if\n\u2206\u2032(0) 6= 0 where \u2206(\u03bb) = det[DP(c) \u2212 \u03bbI] , when \u2206(0) = det(DP(c)) = 0 .\nExpanding out the determinant and differentiating\n\u2206\u2032(0) = \u03c121\n[\nu21 + r\n2u22 \u2212 rh1(d\u2212 h1)\u2212 (1\u2212 r)gh1 \u2212 r(1\u2212 r)g(d\u2212 h1)\n]\n.\nBut criticality implies\nu21\ngh1\n+ r\nu22\ng(d\u2212 h1) = (1\u2212 r) .\nSubstituting this expression into \u2206\u2032(0) results in\n\u2206\u2032(0) = \u2212 r\u03c1\n2\n1\nh1(d\u2212 h1) [h\n2\n1u\n2\n1 + (d\u2212 h1)2u22 + h21(d\u2212 h1)2] ,\nwhich is strictly negative when 0 < h1 < d , confirming that the rank of DP(c) is two.\nThe condition det[DP(c)] = 0 defines a hypersurface in c space, and this surface can be\nparameterized by taking\nh1(s, \u03d5) = sd , u1(s, \u03d5) =\n\u221a\ng(1 \u2212 r)sd cos \u03d5 , u2(s, \u03d5) =\n\u221a\ngd(1 \u2212 r)(1\u2212 s)\nr\nsin\u03d5 . (4.7)\nFor fixed r this parameterization maps out a surface in (h1, u1, u2) space by taking 0 \u2264 s \u2264 1\nand 0 \u2264 \u03d5 < 2pi . An example, taking r = 0.1 is shown in Figure 8. The image of the\ncriticality surface in (R,Q1, Q2) space is also shown in Figure 8. The second surface is obtained\nby substituting (4.7) into (4.3). These figures generalize those for one layer shown in Figure 3.\nThe surface in (h1, u1, u2) space has an elliptic cross-section, with rotating axes as h1 in-\ncreases. When h1 = 0 it is a straight line (degenerate ellipse) in the u2 direction and when\nh1 = 1 it is a straight line (again a degenerate ellipse) in the u1 direction. Since r = 0.1 is not\na typical value for open ocean applications, it is useful to note that the surfaces are qualitatively\nthe same for all r \u2208 (0, 1). To see this, recast (4.7) as\nh1\nd\n= s ,\nu1\u221a\ng(1\u2212 r)d =\n\u221a\ns cos \u03d5 ,\n\u221a\nr u2\u221a\ng(1 \u2212 r)d =\n\u221a\n(1\u2212 s) sin\u03d5 . (4.8)\nThe only effect of r is to scale the velocities and to rotate the major and minor axes of the\nelliptic cross section.\nSome remarkable new features show up in the image surface in (R,Q1, Q2) space. There is\na series of cuspoidal curves. These cuspoidal curves can be predicted using singularity theory\n[3, 7]. The cusp curves are the image in (R,Q1, Q2) space of curves where the kernel of DP(c)\nis in the tangent space of the criticality surface.\nThe Jacobian DP(c) has rank two so the kernel of DP(c) is one dimensional. A simple\ncalculation shows that\nDP(c)n = 0 \u21d2 n = R\n\uf8eb\uf8ed 1\u2212u1h1\nu2\n(d\u2212h1)\n\uf8f6\uf8f8 , (4.9)\nwhere R represents an arbitrary multiplicative constant. Since it does not affect the later\ndiscussion, take the multiplicative constant to be unity. The symbol n is used since n can be\n11\nFigure 8: Criticality surfaces when r = 0.1, with units chosen so that \u03c11 = 1, g = 1 and d = 1.\n12\ncf\nn\nh1\nu 1\nu 2\nFigure 9: Schematic of the vectors \u2207f , where f(c) = det(DP(c)) , and n \u2208 Ker(DP(c)) at a\npoint c = (h1, u1, u2) on the surface of criticality in (h1, u1, u2) space.\ninterpreted as a normal vector \u2013 to the surface in (R,Q1, Q2) space \u2013 away from the singular\ncurves.\nNow define\nf(c) := det[DP(c)] = C\n[\n(1\u2212 r)\u2212 u\n2\n1\ngh1\n\u2212 r u\n2\n2\ngh2\n]\n, C = \u03c121\u03c12gh1h2 .\nThen the criticality surface in (h1, u1, u2) space is defined by f\n\u22121(0) and the vector n is tangent\nto this surface if \u2207f \u00b7 n = 0. Now,\n\u2207f = C\ng\n(\nu21\nh21\n\u2212 ru\n2\n2\nh22\n,\u22122u1\nh1\n,\u22122ru2\nh2\n)\n,\nand so\n\u2207f \u00b7 n = 3C\n\u03c11g\n(\n\u03c11\nu21\nh21\n\u2212 \u03c12 u\n2\n2\nh22\n)\n. (4.10)\nThe singularity \u03c11u\n2\n1\/h\n2\n1 = \u03c12u\n2\n2\/h\n2\n2 is familiar in the theory of solitary waves and will arise in\nthe analysis in the next section. Here it arises purely as a singularity in the criticality surfaces.\nThe more familiar version of this singularity in the literature is the special case u21 = u\n2\n2 which\nreduces it to\nh2\nh1\n=\n\u221a\nr . (4.11)\nHowever the case u21 = u\n2\n2 is a single curve in the criticality surface in Figure 8 (see \u00a74.1 for an\nexplicit parameterization of this curve), and the singularity (4.11) then corresponds to a discrete\nset of points on the criticality surface.\nThe condition \u2207f \u00b7 n = 0 defines curves on the criticality surface in (h1, u1, u2) space in\nFigure 8. With the parameterization (4.7), the function \u2207f \u00b7 n can be put in an illuminating\nform\n\u2207f \u00b7 n = 3C(1\u2212 r)\nh1h2\n(\n(d\u2212 h1) cos2 \u03d5\u2212 h1 sin2 \u03d5\n)\n.\nIt is immediate that\n\u2207f \u00b7 n = 0 \u21d2 h1 = d cos2 \u03d5 . (4.12)\nThe origin of \u03d5 can be chosen so that \u03d5 = 0 corresponds to u2 = 0 and u1 > 0. For each fixed\nh1 \u2208 (0, d) , the singularity curve h1 = d cos2 \u03d5 divides the criticality surface into four regions\n13\nas \u03d5 goes from 0 to 2pi . In two of these regions \u2207f \u00b7 n < 0 and in the other two it is positive.\nThe curve h1 = d cos\n2 \u03d5 is highlighted on the criticality surface in Figure 8.\nYet another characterization of the function \u2207f \u00b7 n is in terms of the second derivative of\nthe mapping P(c) in the direction of n . Let\nK(c) = n1R(c) + n2Q1(c) + n3Q2(c) ,\nwhere n = (n1, n2, n3) is in the kernel of DP(c) . Fix c to be any point on the criticality surface\nas in Figure 9 such that \u2207f \u00b7n 6= 0. Look at the image in (R,Q1, Q2) space of the path c+ sn\nwith s small. The image is the curve K(c + sn) which has a vanishing first derivative (since\nDP(c)n = 0) and second derivative\nd2\nds2\nK(c + sn)\n\u2223\u2223\u2223\u2223\ns=0\n= 3\n(\n\u03c11\nu21\nh21\n\u2212 \u03c12 u\n2\n2\nh22\n)\n=\n\u03c11g\nC\n\u2207f \u00b7 n .\nA schematic of K(s) versus s for s small is shown in Figure 10. Note that the image of c + sn\nin (R,Q1, Q2) space creates a barrier. In other words uniform flows exist on only one side of\nthe criticality surface in (R,Q1, Q2) space, and which side is determined by the sign of \u2207f \u00b7 n .\nOn the side of the surface where uniform flows exist, there are two and they are the conjugate\nflows.\n4.1 The Kelvin-Helmholtz instability\nWhen u1 6= u2 there is the potential for Kelvin-Helmholtz (KH) instability [5]. Without surface\ntension, all flows with nonzero velocity difference are unstable, and with surface tension there\nis a critical value of the velocity difference below which the uniform flow is stable. The role of\nKH instability will not be considered in this paper, as it requires bringing in time dependence.\nHowever, it is of interest to look at the velocity difference on the surface of criticality. Using the\nparameterization (4.7) the velocity difference on the surface of criticality is\nu21 \u2212 u22\ngd(1 \u2212 r) =\nh1\nd\ncos2 \u03d5\u2212 1\nr\n(\n1\u2212 h1\nd\n)\nsin2 \u03d5 .\nHence the velocity difference varies over the criticality surface, and there is a distinguished curve\non the criticality surface where the velocity difference vanishes:\nh1\nd\n=\nsin2 \u03d5\nsin2 \u03d5 + r cos2 \u03d5\n. (4.13)\nNote that this curve does not intersect the singular curve (4.12). The main observation is that\nthere are lines on the criticality surface where the KH instability is irrelevant. However, on the\ncriticality surface, away from the curve (4.13), the KH instability will affect the dynamics always\nwhen surface tension is zero. When surface tension is non-zero there will be a region around the\ncurve (4.13) where the uniform flow in KH stable, and KH unstable outside that region.\n5 The role of criticality in the generation of solitary waves\nTo look at the bifurcation of solitary waves, dispersion terms need to be added to the shallow\nwater equations. There are a number of derivations of Boussinesq models for internal waves at\nthe interface between two fluids with a rigid lid (e.g. Choi & Camassa [11], Craig, Guyenne\n& Kalisch [12] and references therein). However, there is an equivalence class of Boussinesq\nmodels and we have two important requirements: the Boussinesq model should be Galilean\ninvariant, and it should contain evolution equations for the mass density in the upper and lower\nlayers. The former requirement ensures a duality between a moving frame and a stationary\n14\nK(s)\ns\npoint on criticality surface\nconjugate states\nFigure 10: A schematic of the image of the path x 7\u2192 c + sn in the direction n in (R,Q1, Q2)\nspace. When \u2207f \u00b7n has the opposite sign, the parabola has a minimum instead of a maximum.\nframe with steady velocity. The independent mass equations are needed to ensure independent\nmean flow in the upper and lower layers. A Boussinesq model satisfying these requirements is\nderived in \u00a72.5 of Donaldson [14],\n\u2202\n\u2202t (\u03c11h1) +\n\u2202\n\u2202x (\u03c11h1u1) = 0\n\u2202\n\u2202t (\u03c12h2) +\n\u2202\n\u2202x (\u03c12h2u2) = 0\n\u2202\n\u2202t (\u03c11u1 \u2212 \u03c12u2) + \u2202\u2202x\n(\n1\n2\u03c11u\n2\n1 \u2212 12\u03c12u22 + (\u03c11 \u2212 \u03c12)gh1\n)\n= \u03c4 \u2202\n3h1\n\u2202x3 ,\n(5.14)\nwith the constraint h1 + h2 = d . The coefficient of the dispersion term is\n\u03c4 = T \u2212 1\n3\nh1h2g(\u03c11 \u2212 \u03c12)(\u03c11h1 + \u03c12h2)\n(\u03c11h2 + \u03c12h1)\n, (5.15)\nwhere T is the coefficient of surface tension at the interface, and h1 , h2 are reference depths\n(they can be taken to be equal to the uniform flow). The evolution equation is ill-posed when\n\u03c4 < 0 (weak surface tension), but this will not be an issue in this paper as attention will be\nrestricted to the steady part of the equations.\nA Hamiltonian formulation of the steady equations is constructed as follows. Introduce new\ncoordinates\nZ := (\u03b3, \u03c61, \u03c62, h1, \u03c7, q1, q2,H) , (5.16)\nwith \u03b3 , \u03c61 and \u03c62 potential functions defined by\nh1 =\nd\u03b3\ndx , u1 =\nd\u03c61\ndx , u2 =\nd\u03c62\ndx\nq1 = \u03c11h1\nd\u03c61\ndx , q2 = \u03c12(d\u2212 h1)d\u03c62dx , H = \u03c4 dh1dx ,\n(5.17)\nand \u03c7 is the value of the Bernoulli function, and satisfies \u03c7x = 0 (see (5.19) below for elabora-\ntion). Then the steady equations are equivalent to the Hamiltonian system\nJZx = \u2207S(Z) , Z \u2208 R8 . (5.18)\nwith Hamiltonian function\nS(Z) = \u03c7h1 \u2212 12 (\u03c11 \u2212 \u03c12)gh21 + 12\nq21\n\u03c11h1\n+ 12\nq22\n\u03c12(d\u2212 h1) +\n1\n2\u03c4\nH2 ,\n15\nand symplectic operator\nJ =\n\uf8ee\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\n0 0 0 0 \u22121 0 0 0\n0 0 0 0 0 \u22121 0 0\n0 0 0 0 0 0 \u22121 0\n0 0 0 0 0 0 0 \u22121\n1 0 0 0 0 0 0 0\n0 1 0 0 0 0 0 0\n0 0 1 0 0 0 0 0\n0 0 0 1 0 0 0 0\n\uf8f9\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb\n.\nThe symbol S(Z) is used for the Hamiltonian function because it can be related to the momen-\ntum flux associated with the Boussinesq model (5.14).\nWritten out the Hamiltonian system (5.18) is\n\u2212d\u03c7dx = \u2202S\u2202\u03b3 = 0\n\u2212dq1dx = \u2202S\u2202\u03c61 = 0\n\u2212dq2dx = \u2202S\u2202\u03c62 = 0\n\u2212dHdx = \u2202S\u2202h1 = \u03c7\u2212 (\u03c11 \u2212 \u03c12)gh1 \u2212 12\nq2\n1\n\u03c11h21\n+ 12\nq2\n1\n\u03c11(d\u2212h1)2\nd\u03b3\ndx =\n\u2202S\n\u2202r = h1\nd\u03c61\ndx =\n\u2202S\n\u2202q1\n= q1\u03c11h1\nd\u03c62\ndx =\n\u2202S\n\u2202q2\n= q2\u03c12(d\u2212h1)\ndh1\ndx =\n\u2202S\n\u2202H =\n1\n\u03c4 H .\nUsing the definitions uj =\nd\u03c6j\ndx for j = 1, 2, the 2\nnd , 3rd , 6th and 7th equations combine to give\nthe first two equations of the steady part of (5.14). The 5th equation is just a definition for \u03b3 .\nThe 1st , 4th and 8th equations combine to give\n0 = \u03c7x =\nd\ndx\n(\n(\u03c11 \u2212 \u03c12)gh1 + 12\nq21\n\u03c11h21\n\u2212 12\nq22\n\u03c11(d\u2212 h1)2\n)\n\u2212 \u03c4 d\n3h1\ndx3\n, (5.19)\nwhich recovers the steady part of the third equation in (5.14).\n5.1 Properties of the bifurcating solitary waves\nUniform flows correspond to a 3\u2212parameter family of relative equilibria of this system. We\nwill not go into the details of this construction as the system (5.18) is simple enough that the\nconstruction can be done explicitly, while still emphasizing the geometry of the bifurcation.\nThe uniform flow plus a perturbation takes the form\n\u03b3(x) = h1x + \u03b3\u0302(x) , h1(x) = h1 + h\u0302(x) , H(x) = 0 + H\u0302(x)\n\u03c61(x) = u1x + \u03c6\u03021(x) , \u03c62(x) = u2x + \u03c6\u03022(x)\n\u03c7(x) = R + \u03c7\u0302(x) , R = (\u03c11 \u2212 \u03c12)gh1 + 12\u03c11(u1)2 \u2212 12\u03c12(u2)2\nq1(x) = Q1 + q\u03021(x) , Q1 = \u03c11h1u1\nq2(x) = Q2 + q\u03022(x) , Q2 = \u03c12(d\u2212 h1)u2 ,\nwith (h1, u1, u2) near a critical uniform flow. Substitution into the governing equations leads to\n\u2212db\u03c7dx = 0 , \u2212dbq1dx = 0 , \u2212dbq2dx = 0\n\u2212d bHdx = n1\u03c7\u0302 + n2q\u03021 + n3q\u03022 + (\u03c11 \u2212 \u03c12)g(F 21 + rF 22 \u2212 1 + \u00b7 \u00b7 \u00b7 )h\u0302\u2212 12\u03bah\u03022 + \u00b7 \u00b7 \u00b7\ndb\u03b3\ndx = h\u0302\ndb\u03c61\ndx =\n1\n\u03c11h1\nq\u03021 \u2212 u1h1 h\u0302 + \u00b7 \u00b7 \u00b7\nd\u03c62\ndx =\n1\n\u03c12(d\u2212h1)\nq\u03022 +\nu2\n(d\u2212h1)\nh\u0302 + \u00b7 \u00b7 \u00b7\ndbh\ndx =\n1\n\u03c4 H\u0302 .\n(5.20)\n16\nwhere n = (n1, n2, n3) is in the kernel of DP(c) (cf. equation (4.9)) and\n\u03ba = 3\n(\n\u03c11\nu21\nh21\n\u2212 \u03c12 u\n2\n2\n(d\u2212 h1)2\n)\n. (5.21)\nRemarkably, the coefficient \u03ba of the nonlinear term is predicted by the geometry of the criticality\nsurface discussed in \u00a74. The value of this coefficient agrees with results in the literature on weakly\nnonlinear solitary waves [19, 4, 11, 12, 13, 15, 18, 20]. What is new here is the connection with\nthe geometry of criticality surfaces.\nThe 5th , 6th and 7th equations of (5.20) just give drift along the \u03b3\u0302 , \u03c6\u03021 and \u03c6\u03022 directions,\nand the 1st , 2nd and 3rd equations correspond to conservation of (Bernoulli) energy and mass\nflux. The important equations for solitary waves are the 4th and 8th equations which combine\nto give\n\u2212\u03c4 h\u0302xx = I \u2212 12 \u03bah\u03022 + \u00b7 \u00b7 \u00b7 . (5.22)\nThe term proportional to h\u0302 drops out to leading order when the uniform flow is taken to be\ncritical. The coefficient I is defined by\nI = n1r\u0302 + n2q\u03021 + n3q\u03022 = n1(R\u2212R) + n2(Q1 \u2212Q1) + n3(Q2 \u2212Q2) ,\nwhere (R,Q1,Q2) is any point on the criticality surface away from the singularity \u03ba = 0. The\ncoefficient I gives the normal distance from the criticality surface in (R,Q1, Q2) space.\nNeglecting the higher order terms in (5.22), there is an explicit sech2 solitary wave solution.\nsign(\u03ba) = sign(I) is a necessary condition for the existence of solitary waves, and the sign of I\ndetermines which side of the criticality surface the solitary waves exist. Once the sign of the\nchosen normal vector n is fixed, the sign of I determines whether the solitary waves exist in\nthe +n (I > 0) or \u2212n (I < 0) direction. The sign of \u03c4 then determines whether the solitary\nwaves are elevation or depression: if sign(\u03c4) = sign(\u03ba) the solitary wave is one of depression\nand if sign(\u03c4) = \u2212sign(\u03ba) the solitary wave is one of elevation. An explicit expression for the\nsolitary wave in the truncated normal form is\nh\u0302(x) = \u03bd (1\u2212 3 sech2(\u03b3x)) ,\nwith\n\u03bd =\n|\u03c4 |\n\u03ba\u03c4\n\u221a\n2\u03baI and \u03b3 =\n(\n\u03baI\n8\u03c42\n)1\/4\n.\nIn this normal form the conjugate flows (shown graphically in Figure 10) appear as \u00b1(2I\/\u03ba)1\/2 .\n6 Concluding Remarks\nA similar analysis can be done for two-layer flow with a free surface. The surface of criticality\nhas higher dimension since h1 and h2 are independent coordinates, and R1 and R2 are inde-\npendent. The surface of criticality generalizing Figure 8 is a three-dimensional hypersurface in\n(h1, h2, u1, u2) space.\nOne of the reasons that the geometric view of criticality proposed in this paper is of interest\nis that it generalizes to criticality of non-trivial steady states. In [9] the criticality problem for\nStokes waves coupled to a mean flow (there called secondary criticality) is formulated. Secondary\ncriticality then leads to a secondary bifurcation of steady dark solitary waves. Dark solitary\nwaves generalize the bifurcation of classical solitary waves associated with critical uniform flows.\nThey are waves which are asymptotic to periodic states as x \u2192 \u00b1\u221e but have local tanh\u2212 like\nbehaviour for |x| small, and the interior region has smaller amplitude than the periodic state\nat large |x| . A typical example is shown in Figure 1 of [9]. The term \u201cdark solitary wave\u201d is\nderived from optics where the small amplitude in the localized interior region is indicative of a\nregion of low intensity light.\n17\nThe theory of secondary criticality can be applied to two-layer flows. In addition to the\nfunctionals (R,Q1, Q2) one includes B , the wave action flux, and in addition to (h1, u1, u2) one\nincludes k the wavenumber of the periodic wave at the interface. Then one can show that the\ncoupled system is critical when the determinant of the extended Jacobian vanishes,\ndet\n[\n\u2202(R,Q1, Q2, B)\n\u2202(h1, u1, u2, k)\n]\n= 0 .\nWhen this condition is satisfied for periodic waves at the interface between two fluids with a\nrigid lid coupled to a 3\u2212component mean flow \u2013 and there is good reason to suspect that it is\nsatisfied for some parameter values \u2013 application of the theory in [9] would lead to the secondary\nbifurcation of dark solitary waves at the interface.\n\u2014 Appendix \u2014\nA Including the lid pressure in calculation of uniform flows\nThe lid pressure can be included in the calculation of uniform flows by treating it as a Lagrange\nmultiplier associated with the depth constraint d = h1 + h2 . In this case the Bernoulli energy\nin each layer is retained. Given values of the Bernoulli energy in the two layers, R1 and R2 ,\nvalues of the mass flux in each layer, Q1 and Q2 , and the value of the total depth d , uniform\nflows consist of values of h1 , h2 , u1 , u2 and ps satisfying\nR1 =\n1\n2\u03c11u\n2\n1 + \u03c11gh1 + \u03c12gh2 + ps :=\n\u2202F\n\u2202h1\nR2 =\n1\n2\u03c12u\n2\n2 + \u03c12gh1 + \u03c12gh2 + ps :=\n\u2202F\n\u2202h2\nQ1 = \u03c11h1u1 :=\n\u2202F\n\u2202u1\nQ2 = \u03c12h2u2 :=\n\u2202F\n\u2202u2\nd = h1 + h2 :=\n\u2202F\n\u2202ps\n,\n(A-1)\nwhere\nF = 12 \u03c11h1u\n2\n1 +\n1\n2 \u03c12h2u\n2\n2 +\n1\n2 \u03c11gh\n2\n1 + \u03c12gh1h2 +\n1\n2 \u03c12gh\n2\n2 + ps(h1 + h2) .\nThe flow is critical when the Jacobian of this mapping is degenerate. The Jacobian is\n\u2202(R1, R2, Q1, Q2, d)\n\u2202(h1, h2, u1, u2, ps)\n=\n\uf8ee\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\n\u03c11g \u03c12g \u03c11u1 0 1\n\u03c12g \u03c12g 0 \u03c12u2 1\n\u03c11u1 0 \u03c11h1 0 0\n0 \u03c12u2 0 \u03c12h2 0\n1 1 0 0 0\n\uf8f9\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb ,\nand\ndet\n[\n\u2202(R1, R2, Q1, Q2, d)\n\u2202(h1, h2, u1, u2, ps)\n]\n= \u03c11\u03c12\n[\n\u03c11h2u\n2\n1 + \u03c12h1u\n2\n2 \u2212 (\u03c11 \u2212 \u03c12)gh1h2\n]\n,\nrecovering the familiar condition for criticality. As expected, the criticality condition is inde-\npendent of the value of ps . An observation that arises from the formulation including ps is\nthat\nps =\n\u2202Sphys\n\u2202d\n, with h1, h2, u1, u2 fixed ,\nwhere Sphys is the physical momentum flux.\n18\nB The momentum flux\nThe reduced momentum flux used in \u00a73 is the natural conserved quantity when one uses the\nreduced energy, R = R1\u2212R2 , which factors out the lid pressure ps . It differs from the physical\nmomentum flux Sphys by a constant.\nThe physical momentum is I = \u03c11h1u1 + \u03c12h2u2 , and using the governing equations (2.1)\nthe conservation law for I can be constructed\n\u2202I\n\u2202t\n+\n\u2202Sphys\n\u2202x\n= 0 ,\nwith\nSphys = \u03c11h1u\n2\n1 + \u03c12h2u\n2\n2 +\n1\n2 \u03c11gh\n2\n1 + \u03c12gh1h2 +\n1\n2 \u03c12gh\n2\n2 + psd .\nTaking h2 = d\u2212 h1 this simplifies to\nSphys = \u03c11h1u\n2\n1 + \u03c12(d\u2212 h1)u22 + 12 (\u03c11 \u2212 \u03c12)gh21 + 12 \u03c12gd2 + psd .\nThe difference between S and Sphys is\nSphys = S + R2d\u2212 12 \u03c12gd2 ,\nwhere\nR2 =\n1\n2 \u03c12u\n2\n2 + \u03c12gh1 + \u03c12gh2 + ps ,\nis the flux of \u03c12u2 (see equation (2.1)). Either S or S\nphys can be used in the diagrams in \u00a73.\nSince the values of R2 and d are chosen independently of h1 , u1 and u2 , the only effect of\nchanging S to Sphys is a shift of the diagrams up or down in the S direction.\nAcknowledgements\nHelpful comments from Roger Grimshaw are gratefully acknowledged. The work of Neil Don-\naldson was supported by a PhD studentship awarded by EPSRC.\nReferences\n[1] L. Armi. The hydraulics of two flowing layers with different densities, J. Fluid Mech. 163\n27\u201358 (1986).\n[2] P.G. Baines. Topographic effects in Stratified Flows, Cambridge University Press (1995).\n[3] V.I. Arnold, S.M. Gusein-Zade & A.N. Varchenko. Singularities of Differentiable\nMaps, Volume I, Birkha\u00a8user: Boston (1985).\n[4] T.B. Benjamin. Internal waves of finite amplitude and permanent form, J. Fluid Mech.\n25 241\u2013270 (1966).\n[5] T.B. Benjamin & T.J. Bridges. Reappraisal of the Kelvin-Helmholtz instability. Part 1.\nHamiltonian structure, J. Fluid Mech. 333 301\u2013325 (1997).\n[6] T.B. Benjamin & M.J. Lighthill. On cnoidal waves and bores, Proc. Royal Soc. London\nA 224 448\u2013460 (1954).\n[7] T.J. Bridges. Degenerate relative equilibria, curvature of the momentum map, and homo-\nclinic bifurcation, Preprint, University of Surrey (2006).\n19\n[8] T.J. Bridges & N.M. Donaldson. Degenerate periodic orbits and homoclinic torus bi-\nfurcation, Phys. Rev. Lett. 95(10) 104301 (2005).\n[9] T.J. Bridges & N.M. Donaldson. Secondary criticality of water waves. Part 1. Defini-\ntion, bifurcation and solitary waves, J. Fluid Mech. 565 381\u2013417 (2006).\n[10] J. Bu\u00a8hler. Simple internal waves and bores, J. Hydr. Engrg. 120 638\u2013645 (1994).\n[11] W. Choi & R. Camassa. Fully nonlinear internal waves in a two-fluid system, J. Fluid\nMech. 396 1\u201336 (1999).\n[12] W. Craig, P. Guyenne & H. Kalisch. Hamiltonian long-wave expansions for free sur-\nfaces and interfaces, Comm. Pure Appl. Math. 58 1587\u20131641 (2005).\n[13] F. Dias & J.-M. Vandenbroeck. On internal fronts, J. Fluid Mech. 479 145\u2013154 (2003).\n[14] N.M. Donaldson. Criticality theory and conformal mapping techniques for single and\ntwo-layer water-wave systems, PhD Thesis, University of Surrey (2006).\n[15] M. Funakishi & M. Oikawa. Long internal waves of large amplitude in a two-layer fluid,\nJ. Phys. Soc. Japan 55 128\u2013144 (1986).\n[16] R.H.J. Grimshaw. Internal solitary waves, Adv. in Fluid Mech. V, 209\u2013218, Adv. Fluid\nMech. 40, WIT Press: Southampton (2004).\n[17] K.R. Helfrich & W.K. Melville. Long nonlinear internal waves, Ann. Rev. Fluid Mech.\n38 395\u2013425 (2006).\n[18] O. Laget & F. Dias. Numerical computation of capillary-gravity interfacial solitary waves,\nJ. Fluid Mech. 349 221\u2013251 (1997).\n[19] R.R. Long. Solitary waves in the one and two-fluid system, Tellus 8 460\u2013471 (1956).\n[20] D.I. Pullin & R.H.J. Grimshaw. Finite-amplitude solitary waves at the interface between\ntwo homogeneous fluids, Phys. Fluids 31 3550\u20133559 (1988).\n[21] M.J. Sewell. Maximum and Minimum Principles, Cambridge University Press (1987).\n[22] M.J. Sewell & D. Porter. Constitutive surfaces in fluid mechanics, Math. Proc. Camb.\nPhil. Soc. 88 517\u2013546 (1980).\n20\n"}