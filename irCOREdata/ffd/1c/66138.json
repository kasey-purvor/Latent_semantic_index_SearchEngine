{"doi":"10.1214\/105051607000000212","coreId":"66138","oai":"oai:dro.dur.ac.uk.OAI2:2996","identifiers":["oai:dro.dur.ac.uk.OAI2:2996","10.1214\/105051607000000212"],"title":"A Markov chain model of a polling system with parameter regeneration.","authors":["MacPhee, I. M.","Menshikov, M.","Petritis, D.","Popov, S."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2007-10-03","abstract":"We study a model of a polling system i.e. a collection of d queues with a single server that switches from queue to queue. The service time distribution and arrival rates change randomly every time a queue is emptied. This model is mapped to a mathematically equivalent model of a random walk with random choice of transition probabilities, a model which is of independent interest. All our results\\ud\nare obtained using methods from the constructive theory of Markov chains. We determine conditions for the existence of polynomial moments of hitting times for the random walk. An unusual phenomenon of thickness of the region of null recurrence for both the random walk and the queueing model is also proved","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/66138.pdf","fullTextIdentifier":"http:\/\/dro.dur.ac.uk\/2996\/1\/2996.pdf","pdfHashValue":"7116c26988a59238a7865949f35820d0fa197e72","publisher":"Institute of Mathematical Statistics","rawRecordXml":"<record><header><identifier>\n  \n    \n      oai:dro.dur.ac.uk.OAI2:2996<\/identifier><datestamp>\n      2017-09-25T10:08:58Z<\/datestamp><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        A Markov chain model of a polling system with parameter regeneration.<\/dc:title><dc:creator>\n        MacPhee, I. M.<\/dc:creator><dc:creator>\n        Menshikov, M.<\/dc:creator><dc:creator>\n        Petritis, D.<\/dc:creator><dc:creator>\n        Popov, S.<\/dc:creator><dc:description>\n        We study a model of a polling system i.e. a collection of d queues with a single server that switches from queue to queue. The service time distribution and arrival rates change randomly every time a queue is emptied. This model is mapped to a mathematically equivalent model of a random walk with random choice of transition probabilities, a model which is of independent interest. All our results\\ud\nare obtained using methods from the constructive theory of Markov chains. We determine conditions for the existence of polynomial moments of hitting times for the random walk. An unusual phenomenon of thickness of the region of null recurrence for both the random walk and the queueing model is also proved.<\/dc:description><dc:subject>\n        Polling system<\/dc:subject><dc:subject>\n         Hitting time moments<\/dc:subject><dc:subject>\n         Random environment<\/dc:subject><dc:subject>\n         Parameter regeneration<\/dc:subject><dc:subject>\n         Stability<\/dc:subject><dc:subject>\n         Time-inhomogeneous Markov chains<\/dc:subject><dc:subject>\n         Recurrence<\/dc:subject><dc:subject>\n         Lyapunov functions.<\/dc:subject><dc:publisher>\n        Institute of Mathematical Statistics<\/dc:publisher><dc:source>\n        Annals of applied probability, 2007, Vol.17(5\/6), pp.1447-1473 [Peer Reviewed Journal]<\/dc:source><dc:date>\n        2007-10-03<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:identifier>\n        dro:2996<\/dc:identifier><dc:identifier>\n        issn:1050-5164<\/dc:identifier><dc:identifier>\n        doi:10.1214\/105051607000000212<\/dc:identifier><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/2996\/<\/dc:identifier><dc:identifier>\n        https:\/\/doi.org\/10.1214\/105051607000000212<\/dc:identifier><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/2996\/1\/2996.pdf<\/dc:identifier><dc:accessRights>\n        info:en-repo\/semantics\/openAccess<\/dc:accessRights><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["issn:1050-5164","1050-5164"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2007,"topics":["Polling system","Hitting time moments","Random environment","Parameter regeneration","Stability","Time-inhomogeneous Markov chains","Recurrence","Lyapunov functions."],"subject":["Article","PeerReviewed"],"fullText":"Durham Research Online\nDeposited in DRO:\n17 May 2010\nVersion of attached file:\nPublished Version\nPeer-review status of attached file:\nPeer-reviewed\nCitation for published item:\nMacPhee, I. M. and Menshikov, M. and Petritis, D. and Popov, S. (2007) \u2019A Markov chain model of a polling\nsystem with parameter regeneration.\u2019, Annals of applied probability., 17 (5\/6). pp. 1447-1473.\nFurther information on publisher\u2019s website:\nhttp:\/\/dx.doi.org\/10.1214\/105051607000000212\nPublisher\u2019s copyright statement:\nAdditional information:\nUse policy\nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without prior permission or charge, for\npersonal research or study, educational, or not-for-profit purposes provided that:\n\u2022 a full bibliographic reference is made to the original source\n\u2022 a link is made to the metadata record in DRO\n\u2022 the full-text is not changed in any way\nThe full-text must not be sold in any format or medium without the formal permission of the copyright holders.\nPlease consult the full DRO policy for further details.\nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom\nTel : +44 (0)191 334 3042 \u2014 Fax : +44 (0)191 334 2971\nhttp:\/\/dro.dur.ac.uk\nThe Annals of Applied Probability\n2007, Vol. 17, Nos. 5\/6, 1447\u20131473\nDOI: 10.1214\/105051607000000212\n\u00a9 Institute of Mathematical Statistics, 2007\nA MARKOV CHAIN MODEL OF A POLLING SYSTEM WITH\nPARAMETER REGENERATION\nBY IAIN MACPHEE, MIKHAIL MENSHIKOV,1 DIMITRI\nPETRITIS2 AND SERGUEI POPOV 3\nUniversity of Durham, University of Durham, Universit\u00e9 de Rennes 1 and\nUniversidade de S\u00e3o Paulo\nWe study a model of a polling system, that is, a collection of d queues\nwith a single server that switches from queue to queue. The service time dis-\ntribution and arrival rates change randomly every time a queue is emptied.\nThis model is mapped to a mathematically equivalent model of a random\nwalk with random choice of transition probabilities, a model which is of in-\ndependent interest. All our results are obtained using methods from the con-\nstructive theory of Markov chains. We determine conditions for the existence\nof polynomial moments of hitting times for the random walk. An unusual\nphenomenon of thickness of the region of null recurrence for both the ran-\ndom walk and the queueing model is also proved.\n1. Introduction. The results presented in this paper, depending on the affini-\nties of the reader, can be looked at from two different viewpoints: a model from\nqueueing theory or a model from the theory of Markov chains. These two mod-\nels are mathematically equivalent but have their own individual interest. In this\npaper we start by describing the queueing model and stating the results for it. Sub-\nsequently, the proofs are obtained, after the queueing model has been bijectively\nmapped to a random walk model, by using methods from the constructive theory of\nMarkov chains to determine the asymptotic behavior of this random walk. A phe-\nnomenon, exceptional in the theory of stochastic processes, namely, a thick region\nof null recurrence, is also proved for our model.\nOur main objective is to investigate stability conditions for a polling model with\nparameter regeneration. We feel that parameter regeneration is quite a natural hy-\npothesis for realistic queueing systems: it models changes in behavior (of cus-\ntomers or servers) due to factors that are external to the studied system. In our\nReceived July 2006; revised December 2006.\n1Supported in part by FAPESP (20004\/13610-2).\n2Supported in part by the \u201cR\u00e9seau Math\u00e9matique France\u2013Br\u00e9sil\u201d and by the European Science\nFoundation.\n3Supported in part by CNPq (302981\/02\u20130), FAPESP (04\/03056\u20138) and by the \u201cRede Matem\u00e1tica\nBrasil\u2013Fran\u00e7a.\u201d\nAMS 2000 subject classifications. Primary 60K25, 60J10; secondary 60G42, 90B22.\nKey words and phrases. Polling system, parameter regeneration, stability, time-inhomogeneous\nMarkov chains, recurrence, Lyapunov functions.\n1447\n1448 MACPHEE, MENSHIKOV, PETRITIS AND POPOV\nmodel there are d \u2265 2 stations where queues of jobs can form and a single server\nwhich switches from station to station. The server only processes jobs at its cur-\nrent station. For clearer exposition we treat in this paper the case where only two\nstations are open, that is, receiving jobs, at any time. We study the model where\nall stations are open in a separate paper [9]. The reason for splitting this work into\ntwo separate papers, depending on whether two or more stations receive jobs, is\nthat in the former case stability conditions are expressible in terms of explicitly de-\ntermined factors, while in the latter, they are expressible in terms of factors whose\nexistence is shown but whose values are inaccessible to direct computation. These\nfactors are reminiscent of the Lyapunov exponents for products of random matri-\nces whose values can be approximated only by stochastic simulation. Moreover,\nwhile the obtained results in the two papers can be phrased in similar ways, the\ntechniques used to obtain them differ at key points.\nWhen the server completes all the jobs at its current station k, say, it starts to\nmove to the other open station i, station k closes and independently of the process\nhistory, station j \u0002= i opens with probability Pij , where \u2211j \u0002=i Pij = 1 for each\nstation i. The sequence of stations visited by the server thus forms a Markov chain\n{Ir : r = 1,2, . . .} on state space Sd = {1,2, . . . , d} with transition matrix P which\nwe will assume is irreducible but may be periodic (this is necessary for the case\nd = 2 and for cases where one station has priority over the others). We call the time\nperiod between the server\u2019s arrival at and departure from a station an epoch. The\nserver takes some time with distribution Hij which is independent of the process\nhistory to switch between stations and we will assume such times have bounded\nfirst moments (for some results a stronger assumption will be needed).\nDuring each switching time and service epoch, jobs arrive at the open stations\nin independent Poisson streams with rates \u03bb1 at the server\u2019s station i and \u03bb2 at\nthe other open station j . The jobs at station i have independent service times with\ndistribution function G, mean \u00b5\u22121, where G is selected from the class of distrib-\nutions \u0002 with uniformly bounded second moments. This service time distribution\nand the arrival rates (\u03bb1, \u03bb2) are regenerated at the start of each switching time\nindependently of the process history using a measure \u03bdij which depends upon the\nordered pair (i, j) of open stations. It will follow from our Condition E, given later\nin the paper, that there exist two positive constants m0 and M0, with m0 < M0\nsuch that m0 < \u03bbi < M0 for i = 1, 2. Each job at queue i leaves the system after\nprocessing by the server and when the server completes all jobs at station i, includ-\ning any that arrive since the server switched to i (exhaustive service), the epoch\nends. Succeeding epochs are defined in the same way except that if the system ever\nhas no jobs, then the server waits for some to arrive\u2014we do not go into any de-\ntails as we are interested in establishing stability criteria, not studying equilibrium\nbehavior. Our main interest is in the queue lengths, but their behavior is controlled\nby the process of regenerated parameters, so we consider this in detail.\nA MARKOV CHAIN WITH PARAMETER REGENERATION 1449\nParameter regeneration. The parameters in each epoch have the form (i, j,G,\n\u03bb1, \u03bb2) \u2208 S2d \u00d7\u0002\u00d7 (m0,M0)2 \u2261 \u0004e. We impose below conditions on service times\nand arrival rates that ensure that the overall rate of events for the random walk is\nuniformly bounded and all epochs are finite with probability 1.\nAs stated above, we assume that the Markov chain {Ir} supplying the sequence\nof open stations is irreducible and starts from a state i1 \u2208 Sd . Denote the space of\nparameter sequences by \u0004S = \u0004Ne = {(ir , ir+1,Gr,\u03bbr ) : r = 1,2, . . .}, the collec-\ntion of all sequences of ordered pairs of open stations together with service time\ndistribution and arrival rates.\nProbability is associated with events in \u0004S as follows. At each switching time\nr \u2265 1, the station where the server was closes, the server starts switching to station\nIr = i and at the same time, with chance Pij , j = 1, . . . , d , station Ir+1 = j \u0002= i\nopens. The arrival rates \u03bbr = (\u03bb1(r), \u03bb2(r)) and the service time distribution Gr\nat queue i (the random parameters) are chosen using measure \u03bdij independently\nof the process history and are constant throughout the epoch. As stated above, the\nserver takes a time with distribution Hij to complete its switch from i to j .\nWe will use \u03c9 \u2208 \u0004S to denote a sequence of regenerated parameters and \u03c9r =\n(ir , ir+1,Gr,\u03bbr ) to denote the parameter set in epoch r . Where it will not cause\nconfusion we will drop the epoch number dependence from parameter sets and\nwrite \u03c9r = (i, j,G,\u03bb).\nEmbedded Markov chain. We find it convenient to establish our stability re-\nsults for the queueing process in a discrete time setting, so we work with a Markov\nchain embedded in the continuous time process. Specifically, we consider the dis-\ncrete time embedded process (W, \u03be) = {Wn, \u03ben}n\u2208N by observing the continuous\ntime process just after the instants of service completions and the ends of switch-\ning times. Here Wn \u2208 \u0004e identifies the parameters immediately after event n and \u03ben\ndenotes the ordered pair of queue lengths so \u03ben \u2208 N20 (where N0 = {0,1,2,3, . . .})\nand specifically, \u03ben,1 is the queue length at the server\u2019s current station and \u03ben,2 the\nqueue length at the other open station.\nLet e1 and e2 denote the unit vectors of R2. Given Wn = (k, i,G,\u03bb), the possible\nincrements of the queue lengths at event n are of the form\nse1 + te2, s, t \u2208 N0 during a switching time\nand\nse1 + te2, s \u2208 {\u22121} \u222a N0; t \u2208 N0 during a service epoch\n(as the server\u2019s queue is always given by x1). During switching times and during\nservice epochs when \u03ben = (x1, x2) with x1 > 1, the parameters will not change,\nthat is, Wn+1 = Wn but if, during a service epoch, we have x1 = 1, then an incre-\nment (\u22121, t) ends the current epoch. For the continuous time process, as stated\nearlier: station k closes; the server starts the switch to station i; some station j ,\n1450 MACPHEE, MENSHIKOV, PETRITIS AND POPOV\nselected using the Markov chain {Ir}, opens; given the pair (i, j) a service time\ndistribution G and arrival rates \u03bb are selected using measure \u03bdij ; the customers\nwaiting at station i become the initial queue at the server\u2019s new location and dur-\ning the switching time customers arrive at the open stations (i, j) with the selected\nrates. The possible transitions for our embedded process are to states\n(i, j, G\u02c6, \u03bb\u02c6;x2 + s, t) with intensity Pijd\u03bdij (G\u02c6, \u03bb\u02c6)hki(s, t;\u03bb),\nwhere hki(s, t;\u03bb) is the probability of increment se1 + te2, given the arrival rates\n\u03bb, at the transition where the server switches from station k to i.\nIn order to study the stability of the queueing system, we will consider the tra-\njectories of a particle moving according to drift vector fields D related to the para-\nmeter regeneration process. As such vector field or fluid models are quite standard\nin the queueing literature, we will leave details for later and briefly describe now\nonly what we need to state our main results. The one-step mean drifts of \u03be , condi-\ntioned on the parameters in the service epochs, form a vector field D0 :\u0004\u00d7N \u2192 R2\ndefined by\nD0(\u03c9, r) = E(\u03ben+1 \u2212 \u03ben | \u03c9r) =\n(\n\u03bb1\n\u00b5\n\u2212 1, \u03bb2\n\u00b5\n)\n,(1)\nwhere \u03c9r = (i, j,G,\u03bb1, \u03bb2). The process \u03be is homogeneous during each service\nepoch so the mean drift does not depend on queue lengths \u03ben but only upon\n\u03c9r = (ir , ir+1,Gr,\u03bbr ), the parameters in epoch r . Our vector field model will\nnot include switching times so we only define the mean drifts for service epochs.\nNow we observe that if a particle starts from position (x,0) and moves across a\nquarter plane in direction D0, then it eventually arrives at point (0, x\u03bb2\/(\u00b5\u2212 \u03bb1)).\nThe multiplying ratio that appears here plays a key role in the phenomena we are\ninterested in. For later use we observe that, given open stations (i, j),\nYij \u2261 \u03bb2\n\u00b5\u2212 \u03bb1 = tan \u03b8,(2)\nwhere \u03b8 is the minor angle between D and the vector \u2212e1. We also introduce the\nnotation\nFij (x) = \u03bdij [(G,\u03bb1, \u03bb2) :Yij \u2264 x] for x > 0\nfor the cumulative distribution function of the slope Yij for each pair of stations\ni, j \u2208 Sd = {1,2, . . . , d} with i \u0002= j . For notational convenience, set Fii(x) = 0,\nx < 1 and Fii(x) = 1, x \u2265 1, for all i \u2208 Sd .\nRegularity conditions. In order to obtain our results, we have to impose some\nrestriction on the regeneration of parameters and we state these now.\nCONDITION E. For all pairs of distinct stations i, j , there exists m0 > 0, M0 >\nm0 such that:\nA MARKOV CHAIN WITH PARAMETER REGENERATION 1451\n(i) \u03bdij [(G,\u03bb) :\u03bb1 +m0 <\u00b5<M0] = 1,\n(ii) Fij\n(\n1\/M0\n)= 0, Fij (M0)= 1.\nPart (i) ensures that the service rate is uniformly bounded from above and be-\nlow and that the server is never trapped at any station forever. Part (ii) limits the\neffect that any single epoch can have on the long term behavior of the process by\npreventing the mean drift vectors D(\u03c9, r) from approaching the axial directions\ntoo closely (so it is a type of uniform ellipticity condition).\nBy observing the vector field model only at parameter regeneration times we\nobtain a multiplicative Markov process of independent interest which we now de-\nfine.\nMultiplicative model. Let (I,X) = {(Ir ,Xr) : r \u2265 0} denote a discrete time\nMarkov process on the state space Sd \u00d7 R+ (recall that Sd = {1,2, . . . , d}) which\njumps from state (i, x) \b\u2192 (j, \u03b1x) with transition measure PijdFij (\u03b1) for \u03b1 > 0.\nThe matrix P = [Pij ] is the transition matrix of an irreducible Markov chain on\nSd and the Fij are a family of distribution functions with support R+ that satisfy\nCondition E(ii). Assuming that the process waits for time x in state (i, x) before\nmaking its next jump, we associate with (I,X) an accumulated time process {Tr}\ndefined by\nT0 = 0 and Tr = Tr\u22121 +Xr =\nr\u2211\n1\nXn, r = 1,2, . . . .(3)\nThe sequence of times {Tr} is increasing and so the limit T = limr\u2192\u221e Tr exists (in\nsome cases it is infinite) and we call it the total time of the multiplicative model.\n2. The main results. Let \u03c0 = (\u03c01, \u03c02, . . . , \u03c0d) denote the equilibrium distri-\nbution of the open stations Markov chain {Ir}. For each pair i, j \u2208 S2d , let Yij be a\nrandom variable with distribution Fij and for any constant s > 0, set\nLi =\nd\u2211\nj=1\nPijE(logYij ) and Mij (s) = PijE(Y sij ).(4)\nThe d \u00d7 d matrix M(s) = [Mij (s)] is nonnegative and irreducible because {Ir}\nis irreducible. Hence, M(s) has a Perron\u2013Frobenius eigenvalue \u03b7(s) > 0 such that\n\u03b7(s) \u2265 |\u03b7i(s)| for all other eigenvalues of M(s). The size of \u03b7(s) determines which\nmoments of the total time T of the multiplicative model exist, which in turn affects\nthe long term behavior of the random walk \u03be .\nIt is important in Theorem 3.1 below to note that\n\u03b7\u2032(0) =\nd\u2211\ni=1\n\u03c0iLi.(5)\n1452 MACPHEE, MENSHIKOV, PETRITIS AND POPOV\nWe briefly indicate why this is the case. We have M \u2032ij (0) = PijE(logYij ) and we\nnote that the matrix M(0) has \u03b7(0) = 1 with corresponding left eigenvector \u03c0 and\nright eigenvector 1. For any fixed s > 0, let u(s) be the left eigenvector correspond-\ning to eigenvalue \u03b7(s) of M(s). Scale u(s) so that (\u03c0 \u2212u(s)) \u00b71 = 0 (\u00b7 indicates the\nscalar product). Now, for s small, write u(s) = \u03c0 + sx, where x \u00b7 1 = 0. We note\nthat Mij (s) = Pij (1 + sE(logYij )) + O(s2) and \u03b7(s) = u(s)M(s)1(u(s)1)\u22121 =\nu(s)M(s)1.\nNow we expand u(s)M(s)1 to get\n\u03b7(s) = (\u03c0 + sx)[Pij (1 + sE(logYij ))]1 +O(s2) = 1 + s\u2211\u03c0iLi +O(s2)\nsince xP1 = x \u00b7 1 = 0. The relation \u03b7(s) = 1 + s\u2211\u03c0iLi + O(s2) immediately\nimplies (5).\nThe multiplicative Markov chain\u2019s time component and our calculations for it\nare key elements of our main results which give stability conditions for the queue\nlength component \u03be = {\u03ben} of the stochastic model (W, \u03be). Let \u2205 denote the state\n(0,0) where both open queues have no customers and let \u03c4 = min{n > 0 : \u03ben = \u2205}\nbe the time until the system first reaches this empty state. In both of the following\ntheorems it is assumed that the measures \u03bdij for selecting the parameters at the\nstarts of epochs satisfy Condition E.\nTHEOREM 2.1. (i) If \u2211d1 \u03c0iLi < 0, then P(\u03c4 < \u221e) = 1.\n(ii) If \u2211d1 \u03c0iLi = 0 and switching times are all 0, then P(\u03c4 < \u221e) = 1.\n(iii) If \u2211d1 \u03c0iLi > 0, then P(\u03c4 = \u221e) > 0.\nREMARK. The case where\n\u2211d\n1 \u03c0iLi = 0 and switching times are nonzero is\ndifficult and we do not consider it here. The two station model in this case but with\nconstant, not regenerated, parameters was considered by Menshikov and Zuyev\nin [11]. A detailed classification of a critical random walk on a 2-dimensional\ncomplex, again with a fixed jump distribution on each face, was given by MacPhee\nand Menshikov in [8]. In these papers, generalizations of the results of Lamperti\non processes with asymptotically zero drift (see [6]) were used to establish how the\nbehavior of the process during switching events affects which moments of hitting\ntimes to the empty state exist.\nThe major result in this paper is that we can make refined statements about\nthe tail of the hitting time \u03c4 in the recurrent case (i) of the previous result by\ndetermining which moments of \u03c4 are finite and which are infinite. The existence\nof moment s of \u03c4 requires moment conditions on the service and switching times,\nspecifically that there is some constant Ks such that\n\u222b\u221e\n0 x\ns dG(x) <Ks uniformly\nover G \u2208 \u0002 and, similarly, \u222b\u221e0 xs dHij (x) < Ks for all pairs of stations i, j .\nTHEOREM 2.2. If \u2211d1 \u03c0iLi < 0, then:\nA MARKOV CHAIN WITH PARAMETER REGENERATION 1453\n(i) if \u03b7(s) < 1 and the sth moments of switching times and service times are\nuniformly bounded by some constant Ks , then E(\u03c4 s) < \u221e;\n(ii) if \u03b7(s) \u2265 1, then E(\u03c4 s) = \u221e.\nThis result implies that the region of parameter space where the queueing\nprocess \u03be exhibits \u201cnull-recurrence\u201d can be of considerable volume. It also implies\nthat we have only polynomial ergodicity in the sense that the time of reaching the\nempty state has only finite order moments and the order smoothly changes when\nwe pass from the null recurrent to the positive recurrent case. Note that as long\nas they have sufficient moments, the switching times play no role whatever in the\nresult which is in accord with what is known about the constant parameter polling\nnetwork in the recurrent case; see [5]. The phenomenon of a large null-recurrence\nregion is present even in the case of zero switching times. We now illustrate it with\na simple example before further commenting on it.\nEXAMPLE. There are d = 2 nodes and the arrival rates are \u03bb1 = \u03bb2 = 1 in all\nepochs. When the server is at station 2 service times are always exponential with\nrate 2. At station 1 service times are again exponential, but there are two possible\nservice rates, 5\/4 and 5. Each time the server comes to station 1 it works at the\nsmaller rate with probability p \u2208 [0,1] and at the larger rate with probability 1\u2212p.\nThat is, according to our notation,\n\u03bd12[(\u00b5,\u03bb) :\u00b5 = 2,\u03bb= (1,1)] = 1,\n\u03bd21[(\u00b5,\u03bb) :\u00b5 = 5\/4,\u03bb= (1,1)] = p,\n\u03bd21[(\u00b5,\u03bb) :\u00b5 = 5,\u03bb= (1,1)] = 1 \u2212 p.\nNow, elementary computations show that L1 = (4p \u2212 2) log 2, L2 = 0, \u03c01 = \u03c02 =\n1\/2 so that\n\u2211\n\u03c0iLi < 0 is equivalent to p < 1\/2. Further, M11(s) = M22(s) = 0,\nM12(s) = 1 and M21(s) = p4s + (1 \u2212 p)(1\/4)s so that\n\u03b7(s) = [p4s + (1 \u2212 p)(1\/4)s]1\/2 and \u03b7\u2032(0) = (2p \u2212 1) log 2.\nBy Theorem 2.1, the process is certain to return to the empty state \u2205 when\u2211\n\u03c0iLi < 0, that is, p < 1\/2 and has positive probability of never returning when\np > 1\/2. The condition p < 1\/2 implies that \u03b7\u2032(0) < 0 and so \u03b7(s) = 1 has a root\nsp = log(1 \u2212 p)\u2212 logplog 4 > 0\nin this case. By Theorem 2.2, E(\u03c4 s) is finite when 0 \u2264 s < sp , and is infinite when\ns > sp . We see that sp = 1 for p = 1\/5 and, thus, the system is transient for p \u2208\n(1\/2,1], null recurrent for p \u2208 [1\/5,1\/2) and positive recurrent for p \u2208 [0,1\/5),\nso, indeed, we have a \u201cthick\u201d null recurrent phase here.\n1454 MACPHEE, MENSHIKOV, PETRITIS AND POPOV\nIn order to establish stability results for the queueing system, we need vari-\nous Lyapunov functions. We can find them by studying the long term behavior of\nparticles moving according to some random vector field models built using the pa-\nrameter regeneration process and, in particular, the mean drift vector field of the\nprocess \u03be over service epochs.\nThe phenomenon of thickness of the critical region implied by the Theorem 2.2\nand exhibited in the previous example is quite exceptional in the theory both of\nstochastic processes and of critical phenomena. This phenomenon appeared in a\nrelated model but with fixed parameters that was studied by Fayolle, Ignatyuk,\nMalyshev and Menshikov [4] (their results also appear in Section 5 of [3]). Their\nmodel is a random walk \u03be on a 2-dimensional complex, that is, a collection of\nquarter planes connected at their edges in some fashion with possible multiple\nconnections and with no edge unconnected. On any quarter plane the walk drifts\naway from one axis and toward the other. When the boundary is reached, the quar-\nter plane to enter next is chosen according to a transition matrix P . Specifically,\nTheorem 5.3.2 of [3] establishes recurrence of the Markov chain \u03be in a fixed envi-\nronment (which satisfies our Condition E) if and only if the condition \u2211i \u03c0iLi < 0\nholds (in fact, their result is established also for cases where the transition matrix\nP is not irreducible). Further, Theorem 5.3.4 of [3] shows that under the same reg-\nularity conditions \u03be (again with fixed parameters) is positive recurrent if and only\nif \u03b7(1) < 1.\nThe new features in this paper are the following: all the parameters in the FIMM\nmodel are known constants, while here they change at each switching event ac-\ncording to some known distributions; moreover, the results in [4] concern only es-\ntimates of E(\u03c4 ), while here we have conditions for deciding whether E(\u03c4 s) < \u221e\nor not for any s > 0. Finally, the phenomenon of thickness of the critical region\nboth in [4] and in the present paper is due to some underlying randomness in the\nchoice of the next set of parameters. In [4] this randomness is due to a Markovian\nchoice of the next complex, analogous to our matrix P = [Pij ]: when this random-\nness is eliminated, the critical region shrinks to a zero measure manifold. In the\npresent paper the thickness persists even when the Markov process induced by the\nmatrix P = [Pij ] becomes a deterministic routing process.\n3. The multiplicative model and the vector field model. We first establish\nour results for the multiplicative model. We then define the random vector field\nmodel and show that our results for the multiplicative model enable us to describe\nits behavior. Using the vector field model, we can define the \u201crandom\u201d Lyapunov\nfunction we use to establish our results for the stochastic process (W, \u03be).\nLet (I,X) denote the multiplicative model and \u03c3A = min{r > 0 :Xr \u2264 A} for\nany given constant A > 0. Part of the next result appears in [2] where conditions\nwere found determining when the expected total time of (I,X) is finite.\nTHEOREM 3.1. Suppose that the multiplicative Markov chain (I,X) has dis-\ntributions Fij that satisfy Condition E above:\nA MARKOV CHAIN WITH PARAMETER REGENERATION 1455\n(i) If \u2211d1 \u03c0iLi < 0, then Xr \u2192 0 a.s. as r \u2192 \u221e, the total time T of (I,X) is\na.s. finite and for any s > 0 satisfies\nE(T s)\n{\n< \u221e, if \u03b7(s) < 1,\n= \u221e, if \u03b7(s) \u2265 1.\n(ii) If \u2211d1 \u03c0iLi = 0, then, for any A > 0, P(\u03c3A < \u221e | X0 = x0) = 1 for anyfinite x0.\n(iii) If \u2211d1 \u03c0iLi > 0, then Xr \u2192 \u221e a.s. as r \u2192 \u221e.\nREMARK. It is important to note that \u03b7(0) = 1 and \u03b7 is log-convex in s so\n\u03b7(s) < 1 for some s > 0 is equivalent to \u03b7\u2032(0) = \u2211\u03c0iLi < 0. If \u2211d1 \u03c0iLi > 0,\nthen T = \u221e a.s.\n3.1. Proofs for the multiplicative model. We prove first the results about the\nlimiting behavior of the process {Xr} and then establish conditions for the exis-\ntence of E(T s).\nPROOF OF THEOREM 3.1 (Limiting properties of {Xr}). The process\n(I, logX) \u2261 {(Ir , logXr) : r \u2265 0}\nis a nonlattice random walk on Sd \u00d7 R which is homogeneous in its second coor-\ndinate. Its jumps in this coordinate are bounded due to Condition E(ii). As we now\nshow, its stability conditions can be demonstrated using the Lyapunov function\nf (i, x) = ai + logx, where the ai , i = 1, . . . , d , are constants to be determined.\nFor all states (i, x), let\n\u03b2i = E(f (Xr+1)\u2212 f (Xr) | Ir = i,Xr = x).\nWriting a = (a1, . . . , ad), L = (L1, . . . ,Ld) and \u03b2 = (\u03b21, . . . , \u03b2d), we find that\n\u03b2 = \u2212(I \u2212P)a +L, where I denotes the d \u00d7 d identity matrix. The Markov chain\n{Ir} is irreducible with equilibrium vector \u03c0 so it follows that the matrix I \u2212 P\nhas rank d \u2212 1 and that \u03c0 is orthogonal to the range of I \u2212 P . Hence, by standard\nlinear algebra arguments, for any \u03b5 > 0, there exists a such that:\n(i) \u03b2i \u2264 \u2212\u03b5 for each i only when \u2211di=1 \u03c0iLi < 0;\n(ii) \u03b2i = 0 for each i only when \u2211di=1 \u03c0iLi = 0;\n(iii) \u03b2i \u2265 \u03b5 for each i only when \u2211di=1 \u03c0iLi > 0.\nApplying Theorem 2.1.7 of [3], we see that logXr \u2192 \u00b1\u221e a.s. or, equivalently,\nXr \u2192 \u221e or 0 a.s. according as to whether \u2211di=1 \u03c0iLi is positive or negative. If\u2211d\ni=1 \u03c0iLi = 0, then there exist constants ai such that {f (Ir ,Xr)} is a martingale\nwith bounded jumps. By standard results, for example, Theorem 8.4.3 of Meyn\nand Tweedie [12], the process f (I,X) is recurrent and as\n{Xr \u2264 A} \u2283 {f (Ir ,Xr) \u2264 amin + logA},\nthe a.s. finiteness of \u03c3A follows. \u0001\n1456 MACPHEE, MENSHIKOV, PETRITIS AND POPOV\nREMARK. A similar model, a Markov chain on the half-strip Sd \u00d7 Z+, was\nstudied in Section 3.1 of [3] and we borrowed the Lyapunov function x + ai from\nthere.\nWe now consider the question of the total time of the multiplicative process.\nWe start by restating its definition (3) in a slightly different way. For each pair\n(i, j) \u2208 S2d with i \u0002= j , Fij is a distribution function satisfying Condition E. We\nconstruct a sequence of random variables \u03b11, \u03b12, . . . tied to the Markov chain {Ir}\nas follows: when Ir\u22121 = i, Ir = j , then \u03b1r has distribution function Fij . The \u03b1i\nare conditionally independent given the state of {Ir}. The total time of the multi-\nplicative model started from state (i,1) is\nT = 1 + \u03b11 + \u03b11\u03b12 + \u03b11\u03b12\u03b13 + \u00b7 \u00b7 \u00b7 = 1 +\n\u221e\u2211\nr=1\nr\u220f\n1\n\u03b1n.\nIf\n\u2211\ni \u03c0iLi \u2265 0, then the set of states (i, x) with x \u2265 1 is visited infinitely often and\nthe total time T will be infinite a.s. When\n\u2211\ni \u03c0iLi < 0, we can calculate which\ns > 0 have E(T s) < \u221e.\nRecall the d \u00d7 d matrix M(s) = [PijE(Y sij )]i,j , where Yij has distribution\nfunction Fij . Let vi(s) denote the right eigenvectors and \u03b7i(s) the correspond-\ning eigenvalues of M(s). As E(Y sij ) > 0 for all pairs i, j and {Ir} is irreducible,\nthe results of Perron\u2013Frobenius state there is a simple eigenvalue \u03b7(s) > 0 such\nthat \u03b7(s) \u2265 |\u03b7i(s)| for all other eigenvalues and its eigenvector v(s) has elements\nv(j)(s) > 0 and is the only eigenvector with this property.\nWe start by determining the asymptotic behavior of E(\u03b11 \u00b7 \u00b7 \u00b7\u03b1n)s .\nLEMMA 3.2. For any s > 0, there exist constants C > 0, \u03b3 \u2208 (0,1) such that\nlim\nn\u2192\u221e\u03b7(s)\n\u2212n(E(\u03b11 \u00b7 \u00b7 \u00b7\u03b1n)s) = C +O(\u03b3 n).\nPROOF. Let u be the row vector with ui = P(I0 = i) and 1 denote the d-vector\nof 1s. Following the standard argument for establishing the Chapman\u2013Kolmogorov\nconditions, we can write\nE(\u03b11 \u00b7 \u00b7 \u00b7\u03b1n)s = u(M(s))n1\nand the result follows directly from this for each fixed s using the result of Frobe-\nnius. \u0001\nThis estimate makes it evident that the value of \u03b7(s) is crucial to deciding\nwhether E(T s) is finite or infinite.\nPROOF OF THEOREM 3.1 [Conditions for E(T s) = \u221e]. The proof that\nE(T s) = \u221e when \u03b7(s) > 1 is straightforward. As the \u03b1i are a.s. positive, we have\nfor any n\nE(T s) \u2265 E(\u03b11 \u00b7 \u00b7 \u00b7\u03b1n)s.\nA MARKOV CHAIN WITH PARAMETER REGENERATION 1457\nIf \u03b7(s) > 1, then E(\u03b11 \u00b7 \u00b7 \u00b7\u03b1n)s \u2192 \u221e as n \u2192 \u221e by Lemma 3.2 and so E(T s) = \u221e.\nWhen \u03b7(s) = 1 and s \u2265 1, we have T s = (\u2211\u221en=1 \u03b11 \u00b7 \u00b7 \u00b7\u03b1n)s \u2265 \u2211\u221en=1(\u03b11 \u00b7 \u00b7 \u00b7\u03b1n)s\nand again the result follows from Lemma 3.2.\nWhen \u03b7(s) = 1 and s < 1, we can use Jensen\u2019s inequality applied to f (x) = xs\nwhich says that, for any u, v, G, H > 0 and s < 1 with G \u0002= H ,(\nuG+ vH\nu+ v\n)s\n>\nuGs + vHs\nu+ v\nor\n(uG+ vH)s > (u+ v)s\u22121(uGs + vHs).(6)\nLet Tn = 1 + \u03b11 + \u03b11\u03b12 + \u00b7 \u00b7 \u00b7 + \u03b11 \u00b7 \u00b7 \u00b7\u03b1n and let tn = E(T sn ). Applying (6) with\nu = 1, v = n\u2212a , G = Tn and H = na\u03b11 \u00b7 \u00b7 \u00b7\u03b1n+1 where a > 1 is constant, we obtain\ntn+1 = E(T sn+1) = E((Tn + \u03b11 \u00b7 \u00b7 \u00b7\u03b1n+1)s)\n> (1 + n\u2212a)s\u22121(E(T sn )+ na(s\u22121)E(\u03b11 \u00b7 \u00b7 \u00b7\u03b1n+1)s).\nFrom Lemma 3.2, there exist constants C > 0, \u03b3 \u2208 (0,1) such that the term\nE(\u03b11 \u00b7 \u00b7 \u00b7\u03b1n+1)s = C +O(\u03b3 n) and so\ntn+1 > (1 + n\u2212a)s\u22121(tn +Cna(s\u22121))+O(\u03b3 n)\n>\n(\n1 + (s \u2212 1)n\u2212a)(tn +Cna(s\u22121))+O(\u03b3 n)\n= tn + (s \u2212 1)n\u2212atn +C(na(s\u22121) \u2212 (1 \u2212 s)na(s\u22122))+O(\u03b3 n),\nwhere (1+n\u2212a)s\u22121 > 1+ (s \u2212 1)n\u2212a as s < 1. Choose a = (1\u2212 s\/2)\/(1\u2212 s) > 1\nand for some constant \u03b2 \u2208 (0,C\/s), pick n0 \u2261 n0(C, s) such that, for n \u2265 n0,\n(1 \u2212 s)(\u03b2n\u2212a+s\/2 +Cna(s\u22122))+O(\u03b3 n) < (C \u2212 \u03b2s\/2)n\u22121+s\/2.\nThis is possible as \u2212a + s\/2 < \u22121 + s\/2 and a(s \u2212 2) < a(s \u2212 1) = \u22121 + s\/2. As\ntn > t1 = E(\u03b1s1) > 0 for all n, we can choose \u03b2 \u2208 (0, tn0n\u2212s\/20 ). Hence, tn > \u03b2ns\/2\nfor some n \u2265 n0 and for such n,\ntn+1 > \u03b2ns\/2 +Cn\u22121+s\/2 \u2212 (1 \u2212 s)(\u03b2n\u2212a+s\/2 +Cna(s\u22122))+O(\u03b3 n)\n> \u03b2\n(\nns\/2 + s\n2\nn\u22121+s\/2\n)\n> \u03b2(n+ 1)s\/2,\nso, by induction, tn > \u03b2ns\/2 for all n \u2265 n0. Finally, as T s > T sn for all n, E(T s) =\u221e.\nConditions for E(T s) < \u221e. Now we assume \u03b7(s) < 1. If s \u2264 1, then for, any n,\nT s =\n( \u221e\u2211\nn=1\n\u03b11 \u00b7 \u00b7 \u00b7\u03b1n\n)s\n\u2264\n\u221e\u2211\nn=1\n(\u03b11 \u00b7 \u00b7 \u00b7\u03b1n)s\nand E(T s) < \u221e by comparison with the tail sum \u2211n\u2265n0 \u03b7(s)n.\n1458 MACPHEE, MENSHIKOV, PETRITIS AND POPOV\nIt only remains to sort out the case when s > 1. Again, applying Jensen\u2019s in-\nequality to the function f (x) = xs , we have, for any real numbers u, v, G, H > 0\nand s > 1 with G \u0002= H , (\nuG+ vH\nu+ v\n)s\n<\nuGs + vHs\nu+ v\nor\n(uG+ vH)s < (u+ v)s\u22121(uGs + vHs).(7)\nFix any \u03b2 \u2208 ((\u03b7(s))1\/s,1), and apply (7) with u = 1, v = \u03b2n+1, G = Tn, H =\n\u03b2\u2212(n+1)\u03b11 \u00b7 \u00b7 \u00b7\u03b1n+1 to obtain the inequality\nE(T sn+1) = E\n(\nTn + \u03b2n+1 \u00d7 \u03b2\u2212(n+1)\u03b11 \u00b7 \u00b7 \u00b7\u03b1n+1)s(8)\n\u2264 (1 + \u03b2n+1)s\u22121(E(T sn )+ \u03b2n+1\u03b2\u2212s(n+1)E(\u03b11 \u00b7 \u00b7 \u00b7\u03b1n+1)s).\nFrom the definition of \u03b7(s) and, choice of \u03b2 , it follows that\nlim\nn\u2192\u221e\u03b2\n\u2212s(n+1)E(\u03b11 \u00b7 \u00b7 \u00b7\u03b1n+1)s = 0.\nAgain, as tn \u2265 t1 = E(\u03b1s1) > 0 for any n, it follows that there exists n0 such that,\nfor all n \u2265 n0,\n\u03b2\u2212s(n+1)E(\u03b11 \u00b7 \u00b7 \u00b7\u03b1n+1)s \u2264 tn.\nNow (8) implies that, for all n \u2265 n0,\ntn+1 \u2264 (1 + \u03b2n+1)s\u22121(tn + \u03b2n+1tn) = (1 + \u03b2n+1)stn.\nThus, for any n,\nE(T sn ) \u2264 tn0\n\u221e\u220f\nm=n0\n(1 + \u03b2m+1)s < \u221e.\nThat E(T s) < \u221e when \u03b7(s) < 1 and s > 1 follows from this bound and the\nmonotone convergence theorem. \u0001\n3.2. Definition and properties of the random vector field model. We now de-\nfine a random vector field model {(S(\u03c9, t),V (\u03c9, t)) :\u03c9 \u2208 \u0004S, t \u2265 0} using the pa-\nrameter process W . It is motivated by the one-step mean drift vector field defined\nin (1), but we define a more general version so we can consider perturbations of\nthis natural field. This type of model is simple and standard, but we describe it\ncarefully here as we use it to define the random Lyapunov functions we need to\nestablish the properties of the random walk process \u03be .\nThere are no switching times in the vector field model. Consider a particle that\nmoves around on S2d \u00d7 R2+ with velocity field D = {D(\u03c9, r) \u2208 R\u2212 \u00d7 R+ :\u03c9 \u2208\n\u0004S, r \u2208 N}, where the D(\u03c9, r) = (\u2212d1(\u03c9r), d2(\u03c9r)) satisfy conditions equivalent\nto Condition E which we now specify.\nA MARKOV CHAIN WITH PARAMETER REGENERATION 1459\nCONDITION E\u2032 . As before, let Fij denote the distribution function of the slope\nY(\u03c9, r) = d2(\u03c9r)\/d1(\u03c9r) and assume that there exists some constants m0, M0\nsuch that\n\u03bdij [d1 >m0,\u2016D\u2016 <M0] = 1 and that Fij (1\/M0) = 0, Fij (M0) = 1\nfor each pair i, j .\nFor our regenerated parameter process (W, \u03be), the natural vector field satisfies\nd1 = 1 \u2212 \u03bb1\/\u00b5, d2 = \u03bb2\/\u00b5 and we denote it by D0. In this section we are consid-\nering d1 and d2 to be more general functions of the parameters.\nThe process (S,V ) on the state space \u0004e \u00d7 N \u00d7 R2+ has components\nS(\u03c9, t) = (ir , ir+1,Gr,\u03bbr , r),\nthe parameter set at time t including the current epoch number and\nV (\u03c9, t) = (v1(\u03c9, t), v2(\u03c9, t)),\nthe position of the particle on the quarter plane indicated by the parameter ir at\ntime t . For each parameter sequence \u03c9 and initial point (x0,0) with x0 > 0 and\nt0 = 0, set S(\u03c9, t) = S(\u03c9,0) = \u03c91 = (i1, i2,G1,\u03bb1,1) and\nV (\u03c9, t) = (x0,0)+ tD(\u03c9,1)\nuntil the particle reaches the boundary of quarter plane (i1, i2) which defines the\nend of the current epoch. This occurs at time\nt1 \u2261 t1(\u03c9, x0) = x0\nd1(\u03c91)\n.\nSwitching times are assumed to be 0 in this model so at t = t1 set\nS(\u03c9, t1) = \u03c92 and V (\u03c9, t1) =\n(\nd2(\u03c91)\nx0\nd1(\u03c91)\n,0\n)\n= (x0Y(\u03c9,1),0),\nwhere Y(\u03c9, r) = d2(\u03c9r)\/d1(\u03c9r). The components of V are transposed at t1 as the\nparticle moves from plane (i1, i2) to plane (i2, i3) at that moment, corresponding\nto the server switching stations. For epochs r = 2, 3, . . . , define their end times by\ntr \u2261 tr (\u03c9, x0) = tr\u22121 + v1(\u03c9, tr\u22121)\nd1(\u03c9r)\n.(9)\nNow, for t \u2208 [tr\u22121, tr ), we set S(\u03c9, t) = \u03c9r and\nV (\u03c9, t) = V (\u03c9, tr\u22121)+ (t \u2212 tr\u22121)D(\u03c9, r)\nso that v2(\u03c9, t) = d2(\u03c9r)(t \u2212 tr\u22121) and then\nV (\u03c9, tr) = (d2(\u03c9r)(tr \u2212 tr\u22121),0).\n1460 MACPHEE, MENSHIKOV, PETRITIS AND POPOV\nIt is clear from these definitions that, for every parameter sequence \u03c9, the sequence\n{tr} is increasing and so t\u2205(\u03c9, x0) = limr\u2192\u221e tr (\u03c9, x0) exists. Under conditions\nsuch that t\u2205 is bounded a.s., it is the time taken for the particle to reach the empty\nstate \u2205. We now determine conditions which ensure \u2016V (\u03c9, t)\u2016 \u2192 0 and condi-\ntions under which \u2016V (\u03c9, t)\u2016 \u2192 \u221e as t \u2192 \u221e and then consider the process time.\nThe sequence v1(\u03c9, tr ), r = 1,2, . . . , describes the distance of the particle from\nthe origin at the starts of epochs r + 1. For each r = 1,2, . . . ,\nv1(\u03c9, tr ) = d2(\u03c9r)(tr \u2212 tr\u22121) = d2(\u03c9r)v1(\u03c9, tr\u22121)\nd1(\u03c9r)\n= v1(\u03c9, tr\u22121)Y (\u03c9, r)\nand, hence,\nv1(\u03c9, tr ) = x0\nr\u220f\nn=1\nY(\u03c9,n).(10)\nWe re-iterate at this point that this vector field model is a random process driven by\nthe parameter regeneration process including the Markov chain {Ir} for the server\nlocation. Recall that when In = i, In+1 = j \u0002= i, then Y(\u03c9,n) = d2(\u03c9n)\/d1(\u03c9n)) \u223c\nYij with distribution Fij ; \u03c0 = (\u03c01, \u03c02, . . . , \u03c0d) denotes the equilibrium distribu-\ntion of {Ir}; Li = \u2211dj=1 PijE(logYij ) for each i. For C > 0, let tC = min{t \u2265\n0 :v1(\u03c9, t)+ v2(\u03c9, t) \u2264 C}.\nLEMMA 3.3. For the random vector field model (S,V ):\n(i) if \u2211di=1 \u03c0iLi < 0, then v1(\u03c9, tr ) \u2192 0 a.s. and\nt\u2205(\u03c9, x0) = lim\nr\u2192\u221e tr (\u03c9, x0) < \u221e a.s.,\n(ii) if \u2211di=1 \u03c0iLi = 0, then P(tC < \u221e) = 1,\n(iii) if \u2211di=1 \u03c0iLi > 0, then v1(\u03c9, tr ) \u2192 \u221e a.s. as r \u2192 \u221e.\nPROOF. The process {(Ir , v1(\u03c9, tr ))}r is a multiplicative Markov process, so\nparts (i) and (iii) follow immediately from Theorem 3.1(i) and (iii). Theorem 3.1(ii)\nimplies that min{r :v1(\u03c9, tr ) < C} is finite \u03c9-a.s. From equation (9) epoch r lasts\nfor time tr \u2212 tr\u22121 = v1(\u03c9, tr\u22121)\/d1(\u03c9r) which is finite as d1(\u03c9r) \u2265 m0 and, hence,\ntC < \u221e a.s. \u0001\nREMARK. As tr (\u03c9, x0) = x0tr (\u03c9,1) for all r and all x0 > 0, it follows that if\nt\u2205(\u03c9,1) < \u221e, then t\u2205(\u03c9, x0) < \u221e for all x0 > 0.\nNext we recall the Perron\u2013Frobenius eigenvalue \u03b7(s) of the matrix M(s) defined\nin (4).\nLEMMA 3.4. Suppose\n\u2211d\ni=1 \u03c0iLi < 0. For s > 0, if \u03b7(s) < 1, then E(ts\u2205) < \u221e\nwhile if \u03b7(s) \u2265 1, then E(ts\n\u2205\n) = \u221e.\nA MARKOV CHAIN WITH PARAMETER REGENERATION 1461\nPROOF. Combining equations (9) and (10), we obtain\ntr \u2212 tr\u22121 = v1(\u03c9, tr\u22121)\nd1(\u03c9r)\n= v1(\u03c9, tr )\nd2(\u03c9r)\n= x0\nd2(\u03c9r)\nr\u220f\nn=1\nY(\u03c9,n)\nfor r = 1, 2, . . . and so\nt\u2205 =\n\u221e\u2211\nr=1\ntr \u2212 tr\u22121 = x0\n\u221e\u2211\nr=1\n1\nd2(\u03c9r)\nr\u220f\nn=1\nY(\u03c9,n).\nUnder Condition E\u2032 for the vector field model, there exists a constant K > 0 (uni-\nformly in \u03c9) such that 1\/K < 1\/d2(\u03c9r) < K a.s. for all epochs r . It follows that\nx0\nK\n\u221e\u2211\nr=1\nr\u220f\n1\nY(\u03c9,n) < t\u2205(\u03c9, x0) < Kx0\n\u221e\u2211\nr=1\nr\u220f\n1\nY(\u03c9,n).\nThe expression\n\u2211\nr\n\u220f\nn Y (\u03c9,n) is the total time for the multiplicative random walk\nassociated with the parameter regeneration process that drives this vector field\nmodel. From Theorem 3.1(i), it follows that E(ts\n\u2205\n) < \u221e is equivalent to \u03b7(s) < 1.\n\u0001\nThe assumptions in Condition E\u2032 ensure this construction can be carried out\nfor indefinitely many epochs for all parameter sequences from any initial particle\nposition x with x > 0 in any epoch r . To indicate this, we denote the switching\ninstants defined above by tn(\u03c9, r,x) for n \u2265 r . Under the condition\u2211di=1 \u03c0iLi < 0,\nit follows that t\u2205(\u03c9, r,x) = limn\u2192\u221e tn(\u03c9, r,x) < \u221e and is the time taken by the\nparticle to reach 0 from initial point x in epoch r . In this case, for any constant\nA> 0,\ntA(\u03c9, r,x) = min{t :V (t) \u2208 BA,S(0) = \u03c9r,V (0) = x} < \u221e a.s.,(11)\nwhere BA = {x \u2208 R2+ :x + y \u2264 A}.\n4. Lyapunov functions and their properties. Now we return to studying\n(W, \u03be), the random walk together with its regenerated parameter process. We\nuse the vector field model to construct Lyapunov functions along each parame-\nter sequence \u03c9 and then take expectations over the parameter process to estab-\nlish Theorems 2.1 and 2.2. We outline the simplest case of our scheme now to\nhelp explain this general argument. Let E\u03c9 denote expectation for the random\nwalk conditioned on the parameter sequence \u03c9, let (rn, \u03ben) denote the epoch and\nqueue lengths at time n and let \u03c4A = min{n : \u03ben \u2208 BA}. For the natural vector field\nD0(\u03c9, r) \u2261 (\u2212d01 (\u03c9, r), d02 (\u03c9, r)) = (\u03bbr,1\/\u00b5r \u2212 1, \u03bbr,2\/\u00b5r) consider the function\ntA defined in (11). For \u03c9 such that tA is finite and for x \/\u2208 BA,\nE\u03c9\n(\ntA(\u03c9, r, \u03ben+1)\u2212 tA(\u03c9, r, \u03ben) | \u03ben = x)= \u22121.(12)\n1462 MACPHEE, MENSHIKOV, PETRITIS AND POPOV\nIn the case where switching happens instantaneously, Foster\u2019s criterion (see Theo-\nrems 2.1.1 and 2.2.3 of [3]) implies that\nE\u03c9(\u03c4A | \u03be0 = x0) < tA(\u03c9,1,x0) < \u221e\nand it follows, by taking expectation over \u0004S and using Lemma 3.4 with s = 1,\nthat E(\u03c4A | \u03be0 = x0) < \u221e whenever \u03b7(1) < 1.\nWe see from this that, during epoch r , tA(\u03c9, r, \u00b7) based on D0 is a random\n(\u03c9-dependent) Lyapunov function for establishing stability (E(\u03c4A) < \u221e) of the\nqueue length process \u03be . Our plan is to show that when E(tsA) < \u221e (conditions for\nthis are given in Lemma 3.4), then E(\u03c4 sA) < \u221e. However, a stronger result than\nFoster\u2019s is necessary to decide whether E(\u03c4 sA) < \u221e for given s > 1 (see The-\norem 5.3 below). This result requires stronger bounds, than (12). To get these\nstronger bounds we actually have to use tA from a vector field which is a mod-\nification of D0. It is also necessary to handle nonzero switching times.\nTo establish which moments of \u03c4A are infinite, a different approach is needed.\nWe show that for almost all parameter sequences \u03c9 there is some probability,\n\u03b2 > 0, say, that the random walk takes time comparable with the vector field to\nreach BA. This \u03b2 is uniform over \u03c9, so we can take expectation over \u0004S to show\nthat E(tsA) = \u221e implies E(\u03c4 sA) = \u221e.\n4.1. Modified vector fields and Lyapunov functions. Consider the set of par-\nticle trajectories, under a vector field D, from all possible initial points on the e1\naxis in epoch 1. For any parameter sequence \u03c9, any point (r,x) \u2208 N \u00d7 R2+ lies on\na unique such trajectory.\nDEFINITION 4.1. For a vector field D satisfying Condition E\u2032, we define two\ndistinct Lyapunov functions. For each parameter sequence \u03c9, define\ng :\u0004S \u00d7 N \u00d7 R2+ \u2192 R+ by g(\u03c9, r,x) = \u03b3,\nwhere \u03b3 is such that the trajectory under D(\u03c9, \u00b7), started from (1, \u03b3 e1), passes\nthrough the point (r,x), that is, g is constant along particle trajectories under the\nvector field D. On\nF = {\u03c9 \u2208 \u0004S : t\u2205(\u03c9,1, e1) < \u221e},\nthe set of parameter sequences for which t\u2205 is everywhere finite, define f :F \u00d7\nN \u00d7 R2+ \u2192 R+ by\nf (\u03c9, r,x) = tA(\u03c9, r,x) where A> 0 is a given constant.\nWe will need to consider expectations E\u03c9 of f and g as functions of the random\nwalk \u03be for given \u03c9 and, subsequently, with respect to the measure on the parameter\nsequences.\nA MARKOV CHAIN WITH PARAMETER REGENERATION 1463\nREMARK. For any given \u03c9, the functions f and g are linear within epochs\nand we consider their properties for general vector fields D. We will call f the\nremaining life, as it is the time for the particle to reach BA = {x \u2208 R2+ :x + y \u2264 A}\nfrom initial point x in epoch r along the trajectory defined by the vector field\nD for the parameter sequence \u03c9 \u2208 F . Similarly, we will call g the initial value\nfunction and observe that it is everywhere finite for a.s. all \u03c9 for any D satisfying\nCondition E\u2032.\nIn particular, we will use f for establishing that specified moments of the ran-\ndom time \u03c4A = min{n : \u03ben \u2208 BA} exist, g for establishing instability and f and g\ntogether for showing nonexistence of certain moments of \u03c4A. We now describe\nsome of their properties.\nLEMMA 4.2. If vector field D has \u2211i \u03c0iLi < 0, then P\u0004(F) = 1. For fixed \u03c9,\nthe functions f (for \u03c9 \u2208 F ) and g are linear in x for fixed r and continuous at\nchanges of epoch r . Writing:\n(i) f (\u03c9, r,x) = arx1 + brx2 + f0 for \u03c9 \u2208 F (ar , br and f0 are functions of\n\u03c9), we have:\n\u2022 ar = br\u22121 for each r and there exists M > 0, uniform in \u03c9 and r , such that\nbr\/M \u2264 ar \u2264 Mbr ,\n\u2022 \u03c6r \u2261 max{ar, br} \u2265 1\/M0 (the constant in Condition E\u2032),\n\u2022 f (\u03c9, r,x) \u2265 (x1 + x2)\/M0;\n(ii) g(\u03c9, r,x) = crx1 + cr+1x2, we have:\n\u2022 cr+1 = cr\/Y (\u03c9, r) for each r and, hence, cr\/cr+1 = Y(\u03c9, r) \u2208 (1\/M0,M0) for\nall epochs r ,\n\u2022 cr \u220fr\u22121n=1 Y(\u03c9,n) = c1 for all r .\nPROOF. P\u0004(F) = 1 is the content of Lemma 3.3(i). That f , for \u03c9 \u2208 F , and g\nare linear in x for fixed r and continuous at changes of epoch r follows from the\nvector field D being constant during epochs.\nThe properties of f for \u03c9 \u2208 F follow from Condition E\u2032 which constrains d1\nand d2 and the relations ar(x1 \u2212 d1) + br(x2 + d2) = arx1 + brx2 \u2212 1 or, equiva-\nlently, 1 + brd2(r) = ard1(r) for each r . The lower bound on f is immediate. The\nrelations satisfied by the cr follow similarly. \u0001\nUnfortunately, ar and br , the x-coefficients of f within an epoch, can be arbi-\ntrarily large, so the level curves of f (\u03c9, r, \u00b7) (constructed under D0) in the x-plane\ncan make an arbitrarily small angle with the natural drift direction D0(\u03c9, r) of\n{\u03ben}. This prevents us making the estimates needed to establish which hitting time\nmoments exist if we construct f with respect to field D0.\n1464 MACPHEE, MENSHIKOV, PETRITIS AND POPOV\nModified vector fields. To resolve this problem, we construct modified vector\nfields (small perturbations of the natural vector field D0) for which f and g per-\nmit some useful estimations. We do this in different ways for showing whether\nE(\u03c4 sA) < \u221e or not.\nTo show that E(\u03c4 sA) < \u221e, we want a vector field D such that its remaining life\nf is greater than that of D0 but is still finite a.s. and for which moment s of f\nexists. When we want to show that E(\u03c4 sA) = \u221e for some s, we use a different\nmodification of D0 and the initial value function g.\nDEFINITION 4.3. As in equation (2), we write\n\u03b80(\u03c9, r) = arctan[\u03bb2(\u03c9, r)\/(\u00b5(\u03c9, r)\u2212 \u03bb1(\u03c9, r))]\nfor the minor angle between D0(\u03c9, r) and \u2212e1. We define\nD+(\u03c9, r) \u2261 (\u2212d+1 (\u03c9r), d+2 (\u03c9r))(13)\n= \u2016D0(\u03c9, r)\u2016(\u2212 cos(\u03b80(\u03c9, r)+ \u03b8 \u2032), sin(\u03b80(\u03c9, r)+ \u03b8 \u2032))\nfor some \u03b8 \u2032 > 0 such that \u03b80(\u03c9, r) + \u03b8 \u2032 < \u03c0\/2 for all pairs \u03c9, r . We will say that\nsuch a D+ is uniformly above D0. We further define\nD\u2212(\u03c9, r) \u2261 (\u2212d1(\u03c9r), d2(\u03c9r))(14)\n= \u2016D0(\u03c9, r)\u2016(\u2212 cos(\u03b80(\u03c9, r)\u2212 \u03b8 \u2032), sin(\u03b80(\u03c9, r)\u2212 \u03b8 \u2032))\nfor some sufficiently small \u03b8 \u2032 > 0. In this case we say that D\u2212 is uniformly be-\nlow D0.\nThis definition is possible, as, by Condition E,\n\u03b80(\u03c9, r) \u2208 (arctanm0\/M0, arctanM0\/m0) \u2282 (0, \u03c0\/2).\nClearly, there are \u03c9 for which the remaining life under D0 is finite, but under\nD+ it becomes infinite. In fact, the set of these has zero probability for some suit-\nably small \u03b8 \u2032 as we now show. Let M+(s), M0(s) and M\u2212(s) denote the matrix\n[PijE(Y sij )] under the vector fields D+, D0 and D\u2212 respectively and let \u03b7+(s),\n\u03b70(s) and \u03b7\u2212(s) denote the Perron\u2013Frobenius eigenvalues of these matrices. Also,\nfor each station i, let L0i =\n\u2211d\nj=1 PijE(logYij ) under D0 and L\n\u2212\ni the same quanti-\nties under D\u2212.\nLEMMA 4.4. For any given s > 0, we can choose \u03b8 \u2032 > 0 small enough that:\n(i) if \u03b70(s) < 1, then \u03b7+(s) < 1;\n(ii) if \u03b70(s) > 1, then \u03b7\u2212(s) > 1;\n(iii) if \u2211i \u03c0iL0i > 0, then \u2211i \u03c0iL\u2212i > 0\n(\u03b8 \u2032 does not depend upon \u03c9).\nA MARKOV CHAIN WITH PARAMETER REGENERATION 1465\nREMARK. When\n\u2211\ni \u03c0iL\n0\ni < 0 and \u03b8 \u2032 is chosen to satisfy condition (i) or (ii),\nwe say that D+ or D\u2212 respectively is s-neutral.\nPROOF OF LEMMA 4.4. For the vector field D+, we have Yij = d+2 \/d+1 =\ntan(\u03b80 + \u03b8 \u2032) when \u03c9r = (i, j,G,\u03bb). As the function tan is continuous on (0, \u03c0\/2)\nand \u03b7+(s) is a continuous function of M+(s), it follows that \u03b7+(s) is continuous\nin \u03b8 \u2032. Part (i) follows as Condition E bounds the rate of change of \u03b7+(s) in \u03b8 \u2032 and\nparts (ii) and (iii) follow from a similar argument. \u0001\nThe advantage of working with D+ rather than D0 is that the expected one-step\njumps of the process {f (\u03c9, rn, \u03ben)}n are of size comparable to \u03c6r where, as before,\nf (\u03c9, r,x) = arx + bry +f0 and \u03c6r = max{ar, br}. Let \u0011fn = f (\u03c9, rn+1, \u03ben+1)\u2212\nf (\u03c9, rn, \u03ben) and \u0011gn = g(\u03c9, rn+1, \u03ben+1)\u2212 g(\u03c9, rn, \u03ben).\nLEMMA 4.5. Suppose that D+ lies uniformly above D0 and is s-neutral\nfor some s > 0. Let f denote the remaining life of D+. Then F+ = {\u03c9 \u2208\n\u0004S :f (\u03c9,1, e1) < \u221e} satisfies P\u0004(F+) = 1 and for each \u03c9 \u2208 F+ and any ser-\nvice epoch r ,\nE(f (\u03c9, r,x)s) < \u221e\nand there exists \u03b51 > 0 such that\nE\u03c9(\u0011fn | rn = r, \u03ben = x) = \u2212ard01 (\u03c9, r)+ brd02 (\u03c9, r) \u2264 \u2212\u03b51\u03c6r,\nwhere \u03c6r \u2265 1\/M0. Similarly, the initial value function g of a vector field D\u2212 which\nis uniformly below D0 satisfies\nE\u03c9(\u0011gn | rn = r, \u03ben = x) = \u2212crd01 (\u03c9, r)+ cr+1d02 (\u03c9, r) \u2265 \u03b52cr\nfor some \u03b52 > 0 which does not depend upon r and there exists a constant \u03ba > 0\nsuch that\nE\u03c9(\u0011g2n | rn = r, \u03ben = x) \u2264 c2r \u03ba.\nPROOF. P(F+) = 1 and E(f (\u03c9, r,x)s) < \u221e follow immediately from\nLemma 3.4 applied to the vector field D+.\nLet \u03b2 , \u03b2+ denote the angles between the vector (ar , br) and D0, D+ respec-\ntively. By comparison with (12), we see that \u03b2 > \u03c0\/2 and, by construction, there\nexists \u03b8 \u2032 > 0 such that \u03b2+ = \u03b2 + \u03b8 \u2032. The inequality for E(\u0011fn) follows from the\ncomparability of ar and br , \u03c6r \u2265 1\/M0 (from Lemma 4.2), \u2016D0\u2016 \u2265 m0 and the\ncosine rule.\nThe inequality for E(\u0011gn) follows from a very similar argument, while the\nexistence of the constant \u03ba for bounding E(\u0011g2n) follows from the restriction on the\nrates \u03bb imposed by Condition E and the assumption that service time distributions\nG are selected from a set \u0002 with uniformly bounded second moments. \u0001\n1466 MACPHEE, MENSHIKOV, PETRITIS AND POPOV\n5. Proofs for the polling system. We are now in a position to establish The-\norems 2.1 and 2.2. Our treatment of the vector field model in the previous sections\nignored switching times, but we must now consider them.\n5.1. Technique for handling switching times. Our main method is to observe\nthe process not at all transitions, but at carefully calculated sampling times. The-\norem 5.1 below states the semi-martingale result from Fayolle, Menshikov and\nMalyshev [3] which we will use to establish the recurrence part of Theorem 2.1.\nLet {Zt, t \u2265 0} be a sequence of nonnegative random variables with Z0 constant\nand Zt measurable with respect to a filtration F = {Ft , t \u2265 0}. Let {Nn,n \u2265 0} be\na strictly increasing sequence of stopping times adapted to F such that N0 = 0\nand |Nn+1 \u2212 Nn| is bounded for all n \u2265 0. Define a sampled process {Xn,n \u2265 0}\nby X0 = Z0 and Xn = ZNn for n \u2265 1. Also, for constant C > 0, let \u03b6C = min{t \u2265\n1 :Zt \u2264 C} and \u03c3 = min{n \u2265 1 :Xn \u2264 C}. Finally, let {Xt\u2227\u03c3 } denote the sequence\n{Xt } stopped at \u03c3 . With this notation, we now state Theorem 2.1.2 of [3].\nTHEOREM 5.1. If Z0 >C and for some \u03b5 > 0 and all n \u2265 0\nE\n(\nX(n+1)\u2227\u03c3 | FNn\u2227\u03c3\n)\u2264 Xn\u2227\u03c3 \u2212 \u03b5E(N(n+1)\u2227\u03c3 \u2212Nn\u2227\u03c3 | FNn\u2227\u03c3 ) a.s.,\nthen E(\u03b6C) \u2264 Z0\/\u03b5 < \u221e.\nTo use this result, we will calculate in the proof of Theorem 2.1 a constant N\nsuch that the inequality of this theorem is satisfied N steps after any switching\ntime.\n5.2. A key supermartingale for the instability results. We now show that the\nlevel curves of the initial value function g of D\u2212 form a useful barrier for the\nrandom walk \u03be . For each \u03c9 \u2208 \u0004, K > 0, let\nGK(\u03c9) = {(r,x) \u2208 N \u00d7 R2+ :g(\u03c9, r,x) \u2264 K}(15)\ndenote the set of states below the trajectory of D\u2212 with initial value K . Let\n\u03c1K(\u03c9) = min{n : (rn, \u03ben) \u2208 GK(\u03c9)}\ndenote the hitting time of the random walk to GK (rn denotes the epoch in which\nstep n of \u03be occurs). We recall that BA = {x \u2208 R2+ :x + y \u2264 A}.\nLEMMA 5.2. Let g denote the initial value function of vector field D\u2212 and let\n\u03c4A denote the hitting time of BA by \u03be . Let Zn = g(\u03c9, rn, \u03ben) for n \u2208 N and suppose\nthat Z0 = z0 for some constant z0 > A. Define Un = 1\/Zn\u2227\u03c4A for n = 1, 2, . . . .\nIf A is sufficiently large, then, for every epoch r and every parameter sequence \u03c9,\nE\u03c9(Un+1 \u2212Un | rn = r, \u03ben = x) < 0\nand, hence, U\u221e exists a.s.\nA MARKOV CHAIN WITH PARAMETER REGENERATION 1467\nPROOF. Taylor\u2019s theorem applied to the function (1 + x)\u22121 provides the in-\nequality\n(1 + x)\u22121 \u2212 1 < \u2212x + x2(1 \u2212 t0)\u22123 at any x > \u2212t0 > \u22121.\nWrite Zn = z, rn = r and consider \u03ben = x \/\u2208 BA. From Lemma 4.2(ii), we have\nz \u2265 crA\/M0 and either \u0011gn = Zn+1 \u2212 Zn \u2265 0 or 0 < \u2212\u0011gn \u2264 cr . In either case\n\u0011gn\/z \u2265 \u2212M0\/A > \u22121 for A > M0. It now follows from Lemma 4.5 and the\nassumption cr\/z \u2264 M0\/A that\nE\u03c9(Un+1 \u2212Un | \u03ben = x) = 1\nz\n(\nE\u03c9\n( 1\n1 +\u0011gn\/z\n\u2223\u2223\u2223 \u03ben = x\n)\n\u2212 1\n)\n<\n1\nz\nE\u03c9\n(\n\u2212\u0011gn\nz\n+ (1 \u2212M0\/A)\u22123 \u0011g\n2\nn\nz2\n\u2223\u2223\u2223 \u03ben = x\n)\n< \u2212\u03b52M0\nzA\n+ (1 \u2212M0\/A)\u22123 \u03baM\n2\n0\nzA2\n.\nThe right-hand side can be made negative by choosing A sufficiently large. There-\nfore, along any given parameter sequence, the process (Un) is a bounded super-\nmartingale which guarantees the existence of U\u221e. \u0001\n5.3. Proof of Theorem 2.1. (i) We wish to show that \u03c4 , the return time to the\nempty state \u2205, is a.s. finite under the condition\n\u2211\ni \u03c0iLi < 0. Consider a vector\nfield D+ which is uniformly above D0 and s-neutral for some s > 0. As before,\nwe denote the remaining life of D+ by f and let F denote the set of parameter\nsequences where f is a.s. finite for all points (r,x). For each \u03c9 \u2208 F , Lemma 4.5\nimplies\nE\u03c9\n(\nf (\u03c9, r, \u03ben+1)\u2212 f (\u03c9, r, \u03ben) | \u03ben = x)\u2264 \u2212\u03b51\u03c6r \u2264 \u2212\u03b51\/M0\nduring service epochs. During switching times, the queue lengths have drift up-\nward so this inequality does not hold. Let Tr\u22121 denote the time at which the event\nwhich concludes epoch r \u2212 1 occurs. Then\nE\u03c9\n(\nf (\u03c9, r, \u03ben+1)\u2212 f (\u03c9, r, \u03ben) | \u03ben = x, Tr\u22121 = n,\u03c9r = (i, j,G,\u03bb))\n= (ar\u03bb1 + br\u03bb2)mij > 0,\nwhere mij is the mean switching time from station i to j . To employ Theo-\nrem 5.1, we choose \u03b51 > 0 according to Lemma 4.5, \u03b5\u2032 \u2208 (0, \u03b51) and an integer\nN \u2265 2M0m\u2217\/(\u03b51 \u2212 \u03b5\u2032), where m\u2217 = maxij mij . As long as x = (x, y) has x > N ,\nE\u03c9\n(\nf (\u03c9, r, \u03ben+N)\u2212 f (\u03c9, r, \u03ben) | \u03ben = x, Tr\u22121 = n,\u03c9r = (i, j,G,\u03bb))(16)\n\u2264 \u03c6r [(\u03bb1 + \u03bb2)m\u2217 \u2212 \u03b51N] < \u2212\u03b5\u2032\u03c6rN \u2264 \u2212 \u03b5\n\u2032\nM0\nN\nas \u03c6r = max(ar , br) \u2265 1\/M0 and \u03bb1 + \u03bb2 \u2264 2M0 by Condition E.\n1468 MACPHEE, MENSHIKOV, PETRITIS AND POPOV\nNow we apply Theorem 5.1 to Zn = f (\u03c9, rn, \u03ben), with C chosen so that \u03c4A, the\ntime {\u03ben} hits BA, satisfies \u03c4A < \u03b6C (the time {Zn} falls to level C). This is possible\nbecause, by Lemma 4.2, f (\u03c9, r,x) \u2265 \u2016x\u2016\/M0, that is, \u2016x\u2016 large implies f large.\nHence,\nE\u03c9(\u03c4A | \u03be0 = x) < f (\u03c9,0,x)M0\n\u03b5\u2032\n< \u221e\nfor each \u03c9 \u2208 F and this in turn implies that the process \u03be enters BA infinitely often\nalong almost all parameter sequences. Our process is not irreducible in the normal\nsense, as it is not possible to reach the empty state \u2205 in epoch r from state (r,x),\nwhere x = (x, y) with y > 0. However, it is possible to reach \u2205 in epoch r + 1\nand the probability of this is bounded away from 0 uniformly in \u03c9 (the bound does\ndepend upon A and M0). Hence, by Borel\u2013Cantelli, we have \u03c4 < \u221e a.s.\n(ii) Here \u2211\u03c0iLi = 0. Again, we use f to denote the remaining time for the\nvector field model, but this time with the natural field D0. We have from Lemma 4.2\nthat f is finite a.s. and from the inequality (12), we know that for each parameter\nsequence \u03c9 \u2208 F the process (f (\u03c9, rn, \u03ben))n is a supermartingale (remember that\nwe only consider instantaneous switching in this case). Now, from standard results,\nit follows that \u03c4A is a.s. finite for every \u03c9 \u2208 F . That \u03c4 is a.s. finite follows as in\npart (i).\n(iii) We have \u2211\u03c0iLi > 0 and we wish to show that \u03c4 = \u221e with positive proba-\nbility. Consider the initial value function g for a vector field D\u2212 uniformly below\nD0 but with\n\u2211\ni \u03c0iL\n\u2212\ni > 0. We know from Lemma 3.3(iii) and Lemma 4.2(ii) that,\nfor almost all parameter sequences \u03c9, the x-coefficients cr of g in epoch r con-\nverge to 0 as r \u2192 \u221e. For such \u03c9 and for any given constants A > 0 and K \u2032 > 0,\nthere exists r0 such that [recall (15)] the set (r,BA) \u2282 GK \u2032(\u03c9) for all epochs\nr \u2265 r0. For any fixed parameter sequence \u03c9, the process \u03be is certain to reach\nsome state (r \u2032,x\u2032) \/\u2208 GK \u2032(\u03c9) where r \u2032 \u2265 r0. Let K = g(\u03c9, r \u2032,x\u2032). Starting from\n(r \u2032,x\u2032), \u03c1K \u2032 \u2264 \u03c4A a.s. by construction but, as we now show, \u03c1K \u2032 < \u221e a.s. is impos-\nsible. The conditions of Lemma 5.2 hold from which we get E\u03c9(U\u221e) \u2264 1\/K ,\nbut if \u03c1K \u2032 < \u221e a.s., then U\u221e \u2265 1\/K \u2032 > 1\/K a.s. As U\u221e \u2265 0, it follows that\nP\u03c9(\u03c4A = \u03c1K \u2032 = \u221e) \u2265 1 \u2212K \u2032\/K > 0 for almost all \u03c9.\nREMARK. Another way to describe the idea in part (iii) of the proof above\nis to say when (r,BA) \u2282 GK \u2032 for all epochs r there is some probability \u03b2 > 0\n(uniform over parameter sequences \u03c9) such that P\u03c9(\u03ben \/\u2208 GK \u2032 for all n) > \u03b2 , that\nis, if the vector field D\u2212 has trajectories that remain outside GK \u2032 , then the random\nwalk \u03be can stay outside GK \u2032 indefinitely.\n5.4. Semimartingale estimates for Theorem 2.2(i). We now state the key result\nwe use for establishing finiteness of moments of hitting times to the neighborhood\nof the empty state. It is a slight extension of Theorem 1 of [1]. This, in turn, is\nthe generalization to general powers s of Theorem 2.2 of [7] (a similar result for\ninteger moments only).\nA MARKOV CHAIN WITH PARAMETER REGENERATION 1469\nTHEOREM 5.3. Let K > 1, (\u0004, (Fn)n,P) be a filtered probability space and\n(Zn)n\u2208N an (Fn)n-adapted positive valued process with Z0 = z \u2265 K . Let \u03c3K =\ninf{n \u2265 1 :Zn \u2264 K}, \u03c3 \u2032 an arbitrary (Fn)n-stopping time and \u03c3 = inf{\u03c3K,\u03c3 \u2032}.\nSuppose that there exists s0 > 0 such that, for every n \u2208 N, we have E(Zs0n ) < \u221e.\nIf there exists \u03b52 > 0 such that\nE(Zs0n+1 \u2212Zs0n | Fn) \u2264 \u2212\u03b52Zs0\u22121n on {\u03c3 > n},\nthen, for all s \u2264 s0, there exists C = C(s0, \u03b52) such that E(\u03c3 s | Z0 = z) \u2264 Czs .\nREMARK. If we try to apply this result to Zn = f (\u03c9, rn, \u03ben), where f is the\nremaining life of the natural field D0, the condition of the theorem is not generally\nsatisfied. This is why we have to introduce the modified field D+.\nPROOF OF THEOREM 5.3. Straightforward extension (to deal with the intro-\nduction of \u03c3 \u2032) of the corresponding proof of Theorem 1 of [1]. \u0001\nThe following result establishes the key inequality for the application of The-\norem 5.3 under a condition on \u03b70(s), the Perron\u2013Frobenius eigenvalue of M0(s)\nwhich was considered in Lemma 4.4. As in the proof of Theorem 2.1(i), it is nec-\nessary to sample the process at carefully chosen times to deal with the absence of\nservice during switching times.\nPROPOSITION 5.4. Suppose that \u03b70(s0) < 1 for some s0 > 0 and let D+ be\nuniformly above D0 and s0-neutral. Write Zn = f (\u03c9, rn, \u03ben) for all \u03c9 \u2208 F , where\nf denotes the remaining life under D+. Then for such \u03c9 and all s < s0, there exists\n\u03b52 > 0 such that at times n which are not switching times and for \u2016x\u2016 sufficiently\nlarge,\nE\u03c9(Zsn+1 \u2212Zsn | rn = r, \u03ben = x) \u2264 \u2212\u03b52Zs\u22121n .\nPROOF. Letting z = Zn = f (\u03c9, r,x), we have, for \u2016x\u2016 (and, hence, z) large,\nby Lemma 4.2, 1\/C\u2016x\u2016 \u2264 \u03c6r\/z \u2264 C\/\u2016x\u2016 for some C > 0 which is uniform in \u03c9.\nWriting \u0011fn = f (\u03c9, rn+1, \u03ben+1)\u2212 f (\u03c9, rn, \u03ben), we have\nE\u03c9(Zsn+1 \u2212Zsn | rn = r, \u03ben = x) = E\u03c9\n(\n(z +\u0011fn)s \u2212 zs | rn = r, \u03ben = x)\nand from Taylor\u2019s theorem,\n(z +\u0011fn)s = zs + s\u0011fnzs\u22121 + s(s \u2212 1)\n\u222b 1\n0\n(\u0011fn)\n2(z + t\u0011fn)s\u22122(1 \u2212 t) dt.\nAs \u0011fn \u2265 \u2212\u03c6r , when rn = r , we have, for t \u2208 [0,1],\n(z + t\u0011fn)s\u22122 \u2264 zs\u22122\n(\n1 \u2212 \u03c6r\nz\n)s\u22122\nif s \u2264 2\n1470 MACPHEE, MENSHIKOV, PETRITIS AND POPOV\nand so, from Lemma 4.5,\nE(Zsn+1 \u2212Zsn | rn = r, \u03ben = x) \u2264 \u03c6r\n(\n\u2212s\u03b51 +C1s(s \u2212 1)\u03c6r\nz\n)\nzs\u22121,\nwhere C1 > 0 is some constant which is uniform in \u03c9.\nFor s > 2, we have\n(z + t\u0011fn)s\u22122 \u2264\n{\nzs\u22122(1 + t)s\u22122, if \u0011fn \u2264 z,\n(\u0011fn)\ns\u22122(1 + t)s\u22122, if \u0011fn > z.\nThe assumption of a uniform bound Ks on moment s of the service time distri-\nbution implies there is some constant C\u2032 such that E\u03c9(\u0011f sn | rn = r, \u03ben = x) \u2264\n\u03c6srC\n\u2032Ks and, hence, E\u03c9(\u0011f sn I {\u0011fn > z} | rn = r, \u03ben = x) = O(\u03c6sr ). In this case,\nfor \u2016x\u2016 large enough, there exists some C1 > 0 (uniform in \u03c9) such that\nE(Zsn+1 \u2212Zsn | rn = r, \u03ben = x) \u2264 \u03c6rzs\u22121\n(\n\u2212s\u03b51 +C1s(s\u22121)\u03c6r\nz\n+O((\u03c6r\/z)s\u22121)\n)\n,\nagain using Lemma 4.5.\nFinally, for any given s > 2 and any \u03b52 with 0 < \u03b52 < s\u03b51, we can choose \u2016x\u2016\nlarge enough that \u2212s\u03b51 + C1s(s \u2212 1)\u03c6rz + O((\u03c6r\/z)s\u22121) < \u2212\u03b52. The argument is\nsimilar for s \u2264 2. This establishes the result as \u03c6r \u2265 1\/M0. \u0001\nPROOF OF THEOREM 2.2(i). As in Proposition 5.4, we consider the process\nf (\u03c9, rn, \u03ben) where f is the remaining life under a vector field D+ which\nis uniformly above D0 and s-neutral. It follows from E(f (\u03c9, r,x)s0) < \u221e\n(Lemma 4.5) and the fact that E\u03c9((\u03ben1 + \u03ben2)s) < \u221e for all \u03c9, s > 0 and all n\nthat E(f (\u03c9, rn, \u03ben)s) < \u221e for all s \u2208 [0, s0] and all n.\nTo deal with switching times, we sample this process at times Nn where Nn+1 \u2212\nNn = 1 unless Nn is the end of an epoch, in which case Nn+1 \u2212 Nn = N for\nsome constant N to be determined. This makes it necessary to introduce modified\nversions of the hitting times for which we wish to make moment estimates.\nLet Zn = f (\u03c9, rNn, \u03beNn), \u03c3\u02dcK = inf{n \u2265 1 :Zn \u2264 K}, \u03c4\u02dcA = inf{n \u2265 1 : \u03beNn \u2208 BA}\nfor suitably large A and \u03c3\u02dc = min{\u03c3\u02dcK, \u03c4\u02dcA}. For Z0 = z > K for some sufficiently\nlarge constant K , we have, by Proposition 5.4,\nE\u03c9(Zsn+1 \u2212Zsn | rn = r, \u03ben = x) \u2264 \u2212\u03b52Zs\u22121n on {\u03c3\u02dc > n}(17)\nas long as jump Nn is not a switching event. If the server switches queues at time\nNn, then\nZn+1 = Zn + f (\u03c9, rNn + 1, \u03beNn+N \u2212 \u03beNn).\nBy the argument leading to the inequality (16), we have, for large enough N (but\n\u03beNn > N to ensure there is no change of epoch),\nE\n(\nf (\u03c9, rNn + 1, \u03beNn+N \u2212 \u03beNn) | FNn\n)\u221d \u2212N.\nA MARKOV CHAIN WITH PARAMETER REGENERATION 1471\nUsing this together with the moment bound assumed above, it follows that, for\ngiven \u03b52, there exists N such that the bound (17) also holds when the jump at time\nNn is a switching event.\nHence, by Theorem 5.3, there exists a constant C such that E\u03c9(\u03c3\u02dc s | Z0 = z) <\nCzs uniformly over \u03c9 \u2208 F . We can choose A> KM0 which ensures that \u03c4\u02dcA \u2264 \u03c3\u02dcK\na.s. and, hence, for x \/\u2208 BA,\nE(\u03c4\u02dc sA | \u03be0 = x) = E(\u03c3\u02dc s | Z0 = z)\n= E(E\u03c9(\u03c3\u02dc s | Z0 = z))\n\u2264 CE(f (\u03c9,1,x)s) < \u221e.\nTo complete the proof, let \u03c4A = inf{n \u2265 1 : \u03ben \u2208 BA} for suitably large A (so \u03c4A\nis measured in process time n rather than the sampling sequence {Nn}) and recall\nthat \u03c4 = inf{n \u2265 1 : \u03ben = \u2205}. Observe that \u03c4A < N\u03c4\u02dcA so that E(\u03c4 sA | \u03be0 = x) < \u221e.\nFinally, by a standard argument, for example, Theorem A.1 from [10], it follows\nthat E(\u03c4 s | \u03be0 = x) < \u221e for all finite x. \u0001\n5.5. Proof of Theorem 2.2(ii), nonexistence of moments. We start this proof\nby showing that, with a probability that can be bounded away from 0 uniformly\nfor all parameter sequences, the random walk started outside GK stays outside GK\nat least until it hits BA.\nPROPOSITION 5.5. Suppose that \u03b70(s0) < 1 for some s0 > 0 and that g is\nthe initial value function of an s-neutral vector field D\u2212. For any given parameter\nsequence \u03c9, suppose that the queue length process \u03be starts at state (r,x) such\nthat g(\u03c9, r,x) = K and x \/\u2208 BA for A large enough to satisfy the conditions of\nLemma 5.2. For 1 <K \u2032 <K ,\nP\u03c9(\u03c1K \u2032 \u2265 \u03c4A) \u2265 1 \u2212 K\n\u2032\nK\n> 0.\nPROOF. As \u03b70(s0) < 1, Theorem 2.1(iii) implies that \u03c4A is a.s. finite. Con-\nsider the process Un = 1\/g(\u03ben\u2227\u03c4A\u2227\u03c1K\u2032 ). By Lemma 5.2, (Un) is a positive super-\nmartingale. Therefore, the limit U\u221e exists almost surely and its law is supported\nby [0,1] as K \u2032 > 1. Moreover, by Fatou\u2019s lemma,\n1\nK\n= E\u03c9(U0) \u2265 E\u03c9(U\u221e)\n= 1\nK \u2032\nP\u03c9(\u03c1K \u2032 < \u03c4A)+ E\u03c9(U\u03c4A | \u03c1K \u2032 \u2265 \u03c4A)P\u03c9(\u03c1K \u2032 \u2265 \u03c4A)\nas \u03c4A is a.s. finite. Hence, P\u03c9(\u03c1K \u2032 < \u03c4A) \u2264 K \u2032K < 1 by the initial choice of K and\nK \u2032 and (Un) being nonnegative. Thus, P\u03c9(\u03c1K \u2032 \u2265 \u03c4A) \u2265 1 \u2212 K \u2032K > 0. \u0001\n1472 MACPHEE, MENSHIKOV, PETRITIS AND POPOV\nPROOF OF THEOREM 2.2(ii). We have \u03b70(s) > 1 and \u03b70(s0) < 1 for some\ns0 < s. Hence, the remaining life f of vector field D\u2212 (uniformly below D0) is a.s.\nfinite. As f and the initial value function g of D\u2212 are both linear within epochs,\ng can be scaled so that g(\u03c9,1, xe1) = f (\u03c9,1, xe1) for all x > 0. Starting \u03be from\nstate (r,x) with g(\u03c9, r,x) = K > K \u2032 and applying Proposition 5.5, we see that\nP\u03c9(\u03c1K \u2032 \u2265 \u03c4A) \u2265 1 \u2212K \u2032\/K > 0 uniformly over all \u03c9.\nWe now show that on the event {\u03c1K \u2032 \u2265 \u03c4A} the random walk takes such a long\ntime to reach BA that the s0 moment of \u03c4A cannot be finite. The event {\u03c1K \u2032 \u2265 \u03c4A}\ncan only happen when (i) there is an epoch r\u02c6 where (r\u02c6,BA) is not a subset of GK \u2032 ,\nthat is, where the D\u2212 trajectory {g(\u03c9,S(t),V (t)) : t \u2265 0, g(\u03c9,S(t),V (t)) = K \u2032}\nenters BA during epoch r\u02c6 ; (ii) the random walk does not enter GK \u2032 prior to epoch r\u02c6 .\nFor fixed \u03c9 and K \u2032, suppose the random walk starts from \u03be0 = (x0,0) in epoch 1\nwith g(\u03c9,1, x0e1) > K \u2032. Let the random times T1, T2, . . . denote the ends of the\nepochs (for the random walk, not the dynamical system) up to epoch r\u02c6 \u2212 1. On the\nevent {\u03c1K \u2032 \u2265 \u03c4A} we have\nf (\u03c9,1, x0e1) \u2264\nr\u02c6\u22121\u2211\nr=1\ntr \u2212 tr\u22121 +AM0\/m0,\nwhere, in the notation of Section 3.2, the tr are the epoch endtimes for a parti-\ncle moving according to the vector field D\u2212 and the bound AM0\/m0 on the final\nepoch\u2019s contribution to f (\u03c9,1, x0e1), the time for the particle trajectory to reach\nBA, is obtained from Condition E with some obvious geometry. Recalling the no-\ntation v1(\u03c9, tr\u22121) for the particle position at the start of epoch r (for the dynamical\nsystem) and writing Xr\u22121 for the queue length at the start of epoch r (for the ran-\ndom walk), we have, for each epoch r < r\u02c6 ,\nTr \u2212 Tr\u22121 \u2265 Xr\u22121 > v1(\u03c9, tr\u22121),\nas only one job can complete in each service time and, by assumption, the random\nwalk does not enter GK \u2032 . From\nv1(\u03c9, tr\u22121) = d1(tr \u2212 tr\u22121) \u2265 m0(tr \u2212 tr\u22121),\nwe have\n\u03c4A > Tr\u02c6\u22121 =\nr\u02c6\u22121\u2211\nr=1\nTr \u2212 Tr\u22121 >\nr\u02c6\u22121\u2211\nr=1\nv1(\u03c9, tr\u22121) \u2265 m0\nr\u02c6\u22121\u2211\nr=1\ntr \u2212 tr\u22121\n\u2265 m0f (\u03c9,1, x0e1)\u2212AM0\non all random walk trajectories such that \u03c4A \u2264 \u03c1K \u2032 .\nFinally, as \u03b7\u2212(s) > 1, for any initial vector x \/\u2208 BA for A sufficiently large,\nE(\u03c4 sA | \u03be0 = x) \u2265 (1 \u2212K \u2032\/K)ms0E\n([f (\u03c9,1,K \u2032e1)\u2212AM0]s)= \u221e,\nwhere the final equality follows from Lemma 3.4 applied to the vector field D\u2212.\n\u0001\nA MARKOV CHAIN WITH PARAMETER REGENERATION 1473\nREFERENCES\n[1] ASPANDIIAROV, S., IASNOGORODSKY, R. and MENSHIKOV, M. (1996). Passage-time mo-\nments for nonnegative stochastic processes and an application to reflected random walks\nin a quadrant. Ann. Probab. 24 932\u2013960. MR1404537\n[2] DE CALAN, C., LUCK, J. M., NIEUWENHUIZEN, TH. M. and PETRITIS, D. (1985). On the\ndistribution of a random variable occurring in 1D disordered systems. J. Phys. A 18 501\u2013\n523. MR0783195\n[3] FAYOLLE, G., MALYSHEV, V. A. and MENSHIKOV, M. V. (1995). Topics in the Constructive\nTheory of Countable Markov Chains. Cambridge Univ. Press. MR1331145\n[4] FAYOLLE, G., IGNATYUK, I., MALYSHEV, V. and MENSHIKOV, M. (1991). Random walks\nin two-dimensional complexes. Queueing Systems 9 269\u2013300. MR1132178\n[5] FOSS, S. and LAST, G. (1996). Stability of polling systems with exhaustive service policies\nand state-dependent routing. Ann. Appl. Probab. 6 116\u2013137. MR1389834\n[6] LAMPERTI, J. (1960). Criteria for the recurrence or transience of stochastic processes. I.\nJ. Math. Anal. Appl. 1 314\u2013330. MR0126872\n[7] LAMPERTI, J. (1963). Criteria for stochastic processes. II. Passage-time moments.\nJ. Math. Anal. Appl. 7 127\u2013145. MR0159361\n[8] MACPHEE, I. M. and MENSHIKOV, M. (2003). Critical random walks on two-dimensional\ncomplexes with applications to polling systems. Ann. Appl. Probab. 13 1399\u20131422.\nMR2023881\n[9] MACPHEE, I., MENSHIKOV, M., PETRITIS, D. and POPOV, S. YU. (2007). Polling systems\nwith random changes of regime. Ann. Appl. Probab. To appear.\n[10] MENSHIKOV, M. V. and POPOV, S. YU. (1995). Exact power estimates for countable Markov\nchains. Markov Process. Related Fields 1 57\u201378. MR1403077\n[11] MENSHIKOV, M. and ZUYEV, S. (2001). Polling systems in the critical regime. Stochastic\nProcess. Appl. 92 201\u2013218. MR1817586\n[12] MEYN, S. P. and TWEEDIE, R. L. (1993). Markov Chains and Stochastic Stability. Springer,\nLondon. MR1287609\nI. MACPHEE\nM. MENSHIKOV\nMATHEMATICS DEPARTMENT\nUNIVERSITY OF DURHAM\nUNITED KINGDOM\nE-MAIL: i.m.macphee@durham.ac.uk\nmikhail.menshikov@durham.ac.uk\nD. PETRITIS\nINSITUT DE RECHERCHE MATH\u00c9MATIQUE\nUNIVERSIT\u00c9 DE RENNES 1\nFRANCE\nE-MAIL: dimitri.petritis@univ-rennes1.fr\nS. POPOV\nINSTITUTO DE MATEM\u00c1TICA E ESTAT\u00cdSTICA\nUNIVERSIDADE DE S\u00c3O PAULO\nBRASIL\nE-MAIL: popov@ime.usp.br\n"}