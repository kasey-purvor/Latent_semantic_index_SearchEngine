{"doi":"10.1111\/j.1467-9868.2009.00710.x","coreId":"217070","oai":"oai:eprints.lse.ac.uk:31710","identifiers":["oai:eprints.lse.ac.uk:31710","10.1111\/j.1467-9868.2009.00710.x"],"title":"Adaptively varying-coefficient spatiotemporal models","authors":["Lu, Zudi","Steinskog, Dag Johan","Tj\u00f8stheim, Dag","Yao, Qiwei"],"enrichments":{"references":[{"id":17328451,"title":"A hierarchical Bayesian model for space time variation of disease risk.","authors":[],"date":"2001","doi":"10.1191\/147108201128069","raw":"Lagazio, C., Dreassi, E. and Biggeri, A. (2001). A hierarchical Bayesian model for space time variation of disease risk. Statistical Modelling 1, 17-19.","cites":null},{"id":17328440,"title":"A high frequency kriging approach for non-stationary environmental processes.","authors":[],"date":"2001","doi":"10.1002\/env.473","raw":"Fuentes M. (2001). A high frequency kriging approach for non-stationary environmental processes. Environmetrics 12: 469-483.","cites":null},{"id":17328459,"title":"A short note on optimal bandwidth selection for kernel estimators.","authors":[],"date":"1990","doi":"10.1016\/0167-7152(90)90090-t","raw":"Mammem, E. (1990). A short note on optimal bandwidth selection for kernel estimators. Statistics and Probability Letters, 9, 23\u201325.","cites":null},{"id":17328460,"title":"A simple substitute for conditional expectation: the disjunctive kriging.","authors":[],"date":"1976","doi":"10.1007\/978-94-010-1470-0_14","raw":"Matheron, G. (1976). A simple substitute for conditional expectation: the disjunctive kriging.","cites":null},{"id":17328458,"title":"Adaptive Varying-Coe\ufb03cient Linear Models for Stochastic Processes: Asymptotic Theory.","authors":[],"date":"2007","doi":null,"raw":"Lu, Z., Tj\u00f8stheim, D. and Yao, Q. (2007). Adaptive Varying-Coe\ufb03cient Linear Models for Stochastic Processes: Asymptotic Theory. Statistica Sinica, 17, 177-197 . [Additional proofs for \u201cAdaptive varying-coe\ufb03cient linear models for stochastic processes: asymptotic theory\u201d. Available at the website of Statistica Sinica.] Lu, Z., Tj\u00f8stheim, D. and Yao, Q. (2008). Spatial smoothing, Nugget e\ufb00ect and in\ufb01ll asymptotics. Statistics and Probability Letters, 78, 3145\u20133151.","cites":null},{"id":17328438,"title":"Adaptive varying-coe\ufb03cient linear models.","authors":[],"date":"2003","doi":"10.1111\/1467-9868.00372","raw":"Fan, J., Yao, Q. and Cai, Z. (2003). Adaptive varying-coe\ufb03cient linear models. Journal of the Royal Statistical Society, B, 65, 57-80.","cites":null},{"id":17328466,"title":"An e\ufb00ective bandwidth selector for local least squares regression.","authors":[],"date":"1995","doi":"10.1080\/01621459.1995.10476630","raw":"Ruppert, D., Sheather, S. J. and Wand, M. P. (1995). An e\ufb00ective bandwidth selector for local least squares regression. Journal of the American Statistical Association, 90, 1257\u20131270.","cites":null},{"id":17328461,"title":"ASI: Advanced Geostatistics in the Mining Industry","authors":[],"date":"1975","doi":null,"raw":"Proceedings, NATO ASI: Advanced Geostatistics in the Mining Industry (Rome, Oct. 1975), 221-236.","cites":null},{"id":17328472,"title":"Asymptotic Behavior of Bandwidth Selected by the CrossValidation Method for Local Polynomial Fitting.","authors":[],"date":"2002","doi":"10.1006\/jmva.2001.2048","raw":"Xia, Y. and Li, W. K. (2002). Asymptotic Behavior of Bandwidth Selected by the CrossValidation Method for Local Polynomial Fitting. Journal of multivariate analysis, 83, 265-287.","cites":null},{"id":17328449,"title":"Asymptotic behaviors of some measures of accuracy in nonparametric curve estimation with dependent observations.","authors":[],"date":"1995","doi":"10.1006\/jmva.1995.1025","raw":"Kim, T. Y. and Cox, D. D. (1995). Asymptotic behaviors of some measures of accuracy in nonparametric curve estimation with dependent observations. Journal of multivariate analysis, 53, 67\u201393.","cites":null},{"id":17328452,"title":"Bandwidth selection: classical or plug-in?","authors":[],"date":"1999","doi":"10.1214\/aos\/1018031201","raw":"Loader, C. R. (1999). Bandwidth selection: classical or plug-in? Ann. Statist., 27, 415\u2013438.","cites":null},{"id":17328450,"title":"Bayesian modelling of inseparable space time variation in disease risk.","authors":[],"date":"2000","doi":"10.1002\/1097-0258(20000915\/30)19:17\/18<2555::aid-sim587>3.0.co;2-#","raw":"Knorr-Held, L. (2000). Bayesian modelling of inseparable space time variation in disease risk.","cites":null},{"id":17328463,"title":"Comparison of bandwidth selectors in nonparametric regression under dependence,","authors":[],"date":"1996","doi":"10.1016\/0167-9473(95)00028-3","raw":"Quintela-del-R\u00b4 \u0131o, A. (1996). Comparison of bandwidth selectors in nonparametric regression under dependence, Comput. Statist. Data Anal. 21, 563\u2013580.","cites":null},{"id":17328470,"title":"Cross-validatory choice and assessment of statistical predictions (with discussion).","authors":[],"date":"1974","doi":null,"raw":"Stone, M. (1974). Cross-validatory choice and assessment of statistical predictions (with discussion). Journal of the Royal Statistical Society, B, 36. 111-147.","cites":null},{"id":17328445,"title":"Density estimation for spatial processes: the L1 theory.","authors":[],"date":"2004","doi":"10.1016\/s0047-259x(03)00060-5","raw":"Hallin, M., Lu, Z. and Tran, L. T. (2004a). Density estimation for spatial processes: the L1 theory. Journal of Multivariate Analysis, 88, 61-75.","cites":null},{"id":17328444,"title":"Empirical functionals and e\ufb03cient smoothing parameter selection (with discussions).","authors":[],"date":"1992","doi":null,"raw":"Hall, P. and Johnstone, I. (1992). Empirical functionals and e\ufb03cient smoothing parameter selection (with discussions). Journal of the Royal Statistical Society, B, 54, 475\u2013530.","cites":null},{"id":17328467,"title":"Empirical-bias bandwidths for local polynomial regression and density estimation.","authors":[],"date":"1997","doi":"10.2307\/2965570","raw":"Rupert, D. (1997). Empirical-bias bandwidths for local polynomial regression and density estimation. Journal of the American Statistical Association, 92, 1049-1062.","cites":null},{"id":17328441,"title":"Estimation in semiparametric spatial regression.","authors":[],"date":"2006","doi":"10.1214\/009053606000000317","raw":"Gao, J., Lu, Z. and Tj\u00f8stheim, D. (2006). Estimation in semiparametric spatial regression.","cites":null},{"id":17328453,"title":"Exploring spatial nonlinearity using additive approximation.","authors":[],"date":"2007","doi":"10.3150\/07-bej5093","raw":"26Lu Z., Lundervold, A., Tj\u00f8stheim, D. and Yao, Q. (2007). Exploring spatial nonlinearity using additive approximation. Bernoulli 13, 447-472.","cites":null},{"id":17328473,"title":"Gaussian maximum likelihood estimation for ARMA models II: spatial processes.","authors":[],"date":"2006","doi":"10.3150\/bj\/1151525128","raw":"Yao, Q. and Brockwell, P.J. (2006). Gaussian maximum likelihood estimation for ARMA models II: spatial processes. Bernoulli, 12, 403-429.","cites":null},{"id":17328439,"title":"Geographically weighted regression: a natural evolution of the expansion method for spatial data analysis. Environment and planning","authors":[],"date":"1998","doi":"10.1068\/a301905","raw":"Fotheringham, A.S., Charlton, M.E. and Brunsdon, C. (1998). Geographically weighted regression: a natural evolution of the expansion method for spatial data analysis. Environment and planning A, 30, 1905-1927.","cites":null},{"id":17328434,"title":"Geostatistics: Modeling Spatial Uncertainty.","authors":[],"date":"1999","doi":"10.1002\/9781118136188","raw":"Chil` es, J.-P. and Del\ufb01ner, P. (1999). Geostatistics: Modeling Spatial Uncertainty. Wiley, New York.","cites":null},{"id":17328468,"title":"Interpolation of Spatial Data.","authors":[],"date":"1999","doi":"10.1007\/978-1-4612-1494-6","raw":"Stein, M.L. (1999). Interpolation of Spatial Data. Springer, New York.","cites":null},{"id":17328465,"title":"Introduction to Disjunctive Kriging and Non-linear Geostatistics.","authors":[],"date":"1994","doi":"10.2307\/1270423","raw":"Rivoirard, J. (1994). Introduction to Disjunctive Kriging and Non-linear Geostatistics. Clarendon Press, Oxford.","cites":null},{"id":17328447,"title":"Kernel regression smoothing of time series.","authors":[],"date":"1992","doi":"10.1111\/j.1467-9892.1992.tb00103.x","raw":"H\u00a8 ardle, W. and Vieu, P. (1992) Kernel regression smoothing of time series. Journal of Time Series Analysis, 13, 209\u2013224.","cites":null},{"id":17328446,"title":"Local Linear Spatial Regression.","authors":[],"date":"2004","doi":"10.1214\/009053604000000850","raw":"Hallin, M., Lu, Z. and Tran, L. T. (2004b). Local Linear Spatial Regression. Annals of Statistics, 32, 2469\u20132500.","cites":null},{"id":17328437,"title":"Nonlinear Time Series: Nonparametric and Parametric Methods.","authors":[],"date":"2003","doi":"10.1007\/b97702","raw":"Fan, J. and Yao, Q. (2003). Nonlinear Time Series: Nonparametric and Parametric Methods. Springer, New York.","cites":null},{"id":17328432,"title":"Nonparametric spatial prediction.","authors":[],"date":"2004","doi":"10.1023\/b:sisp.0000049116.23705.88","raw":"Biau, G. and Cadre, B. (2004). Nonparametric spatial prediction. Stat. Inference Stoch. Process. 7, 327-349.","cites":null},{"id":17328462,"title":"Numerical Recipes in C++: The art of scienti\ufb01c computing.","authors":[],"date":"1992","doi":"10.1016\/s0003-2670(00)82860-3","raw":"Press, W.H., Teukolsky, S.A., Vetterling, W.T. and Flannery, B.P. (1992). Numerical Recipes in C++: The art of scienti\ufb01c computing. Cambridge University Press: Cambridge.","cites":null},{"id":17328471,"title":"On single-index coe\ufb03cient regression models.","authors":[],"date":"1999","doi":"10.2307\/2669941","raw":"Xia, Y. and Li, W. K. (1999). On single-index coe\ufb03cient regression models. Journal of the American Statistical Association, 94, 1275-1285.","cites":null},{"id":17328443,"title":"Random Fields on a Network: Modelling, Statistics, and Application.","authors":[],"date":"1995","doi":"10.2307\/1271325","raw":"Guyon, X. (1995). Random Fields on a Network: Modelling, Statistics, and Application. Springer-Verlag, New York.","cites":null},{"id":17328474,"title":"Smoothing for spatial-temporal models and its application in modelling muskrat-mink interaction.","authors":[],"date":"2003","doi":"10.1111\/j.0006-341x.2003.00095.x","raw":"Zhang, W., Yao, Q., Tong, H. and Stenseth, N.C. (2003). Smoothing for spatial-temporal models and its application in modelling muskrat-mink interaction. Biometrics, 59, 813-821.","cites":null},{"id":17328431,"title":"Spatial Econometrics: Methods and Models.","authors":[],"date":"1988","doi":"10.1007\/978-94-015-7799-1_15","raw":"Anselin, L. (1988). Spatial Econometrics: Methods and Models. Kluwer Academic: Dordrecht, Netherlands.","cites":null},{"id":17328464,"title":"Spatial Statistics.","authors":[],"date":"1981","doi":"10.1002\/0471725218","raw":"Ripley, B.D. (1981). Spatial Statistics. John Wiley & Sons: New York.","cites":null},{"id":17328433,"title":"Spatial variations in the average rainfallaltitude relationship in Great Britain: an approach using geographically weighted regression.","authors":[],"date":"2001","doi":"10.1002\/joc.614","raw":"Brunsdon, C., McClatchey, J. and Unwin, D.J. (2001). Spatial variations in the average rainfallaltitude relationship in Great Britain: an approach using geographically weighted regression. International Journal of Climatology, 21, 455-466.","cites":null},{"id":17328436,"title":"Statistical analysis of spatial point patterns.","authors":[],"date":"2003","doi":null,"raw":"25Diggle, P.J. (2003). Statistical analysis of spatial point patterns. Arnold, London.","cites":null},{"id":17328435,"title":"Statistics For Spatial Data.","authors":[],"date":"1993","doi":"10.2307\/2348117","raw":"Cressie, N.A.C. (1993). Statistics For Spatial Data. Wiley, New York.","cites":null},{"id":17328448,"title":"The NCEP\/NCAR 40-year Reanalysis Project.","authors":[],"date":"1996","doi":"10.1175\/1520-0477(1996)077<0437:tnyrp>2.0.co;2","raw":"Kalnay E., M. Kanamitsu, R. Kitsler, W. Collins, D. Deaven, L. Candin, M. Iredell, S. Saha, G. White, J. Wollen, Y. Zhu, M. Chelliah, W. Ebisuzaki, W. Higgins, J. Janowiak, K. Mo, C. Ropelewski, J. Wang, A. Leetmaa, R. Reynolds, R. Jenne, and D. Joseph, 1996: The NCEP\/NCAR 40-year Reanalysis Project. Bulletin of the American Meteorological Society. 77(3), 437\u2013471.","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2009-09","abstract":"We propose an adaptive varying-coefficient spatiotemporal model for data that are observed irregularly over space and regularly in time. The model is capable of catching possible non-linearity (both in space and in time) and non-stationarity (in space) by allowing the auto-regressive coefficients to vary with both spatial location and an unknown index variable. We suggest a two-step procedure to estimate both the coefficient functions and the index variable, which is readily implemented and can be computed even for large spatiotemporal data sets. Our theoretical results indicate that, in the presence of the so-called nugget effect, the errors in the estimation may be reduced via the spatial smoothing\u2014the second step in the estimation procedure proposed. The simulation results reinforce this finding. As an illustration, we apply the methodology to a data set of sea level pressure in the North Sea","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/217070.pdf","fullTextIdentifier":"http:\/\/eprints.lse.ac.uk\/31710\/1\/Adaptively_varying_coefficient_spatio-temporal_models%28lsero%29.pdf","pdfHashValue":"4d1ae8cf0d2dbd71e9c5e6957c06c93cf9c5da4a","publisher":"Wiley on behalf of the Royal Statistical Society","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lse.ac.uk:31710<\/identifier><datestamp>\n      2017-10-13T15:54:42Z<\/datestamp><setSpec>\n      74797065733D4445505453:4C53452D5354<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/eprints.lse.ac.uk\/31710\/<\/dc:relation><dc:title>\n        Adaptively varying-coefficient spatiotemporal models<\/dc:title><dc:creator>\n        Lu, Zudi<\/dc:creator><dc:creator>\n        Steinskog, Dag Johan<\/dc:creator><dc:creator>\n        Tj\u00f8stheim, Dag<\/dc:creator><dc:creator>\n        Yao, Qiwei<\/dc:creator><dc:subject>\n        QA Mathematics<\/dc:subject><dc:description>\n        We propose an adaptive varying-coefficient spatiotemporal model for data that are observed irregularly over space and regularly in time. The model is capable of catching possible non-linearity (both in space and in time) and non-stationarity (in space) by allowing the auto-regressive coefficients to vary with both spatial location and an unknown index variable. We suggest a two-step procedure to estimate both the coefficient functions and the index variable, which is readily implemented and can be computed even for large spatiotemporal data sets. Our theoretical results indicate that, in the presence of the so-called nugget effect, the errors in the estimation may be reduced via the spatial smoothing\u2014the second step in the estimation procedure proposed. The simulation results reinforce this finding. As an illustration, we apply the methodology to a data set of sea level pressure in the North Sea.<\/dc:description><dc:publisher>\n        Wiley on behalf of the Royal Statistical Society<\/dc:publisher><dc:date>\n        2009-09<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/eprints.lse.ac.uk\/31710\/1\/Adaptively_varying_coefficient_spatio-temporal_models%28lsero%29.pdf<\/dc:identifier><dc:identifier>\n          Lu, Zudi and Steinskog, Dag Johan and Tj\u00f8stheim, Dag and Yao, Qiwei  (2009) Adaptively varying-coefficient spatiotemporal models.  Journal of the Royal Statistical Society. Series B: Statistical Methodology, 71 (4).  pp. 859-880.  ISSN 1369-7412     <\/dc:identifier><dc:relation>\n        http:\/\/www.wiley.com\/bw\/journal.asp?ref=1369-7412<\/dc:relation><dc:relation>\n        10.1111\/j.1467-9868.2009.00710.x<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/eprints.lse.ac.uk\/31710\/","http:\/\/www.wiley.com\/bw\/journal.asp?ref=1369-7412","10.1111\/j.1467-9868.2009.00710.x"],"year":2009,"topics":["QA Mathematics"],"subject":["Article","PeerReviewed"],"fullText":"  \nZudi Lu, Dag Johan Steinskog, Dag Tj\u00f8stheim, Qiwei Yao \nAdaptively varying-coefficient \nspatiotemporal models \n \nArticle (Accepted version) \n(Unrefereed) \n \n \n \nOriginal citation: \nLu, Zudi and Steinskog, Dag Johan and Tj\u00f8stheim, Dag and Yao, Qiwei (2009) Adaptively \nvarying-coefficient spatiotemporal models. Journal of the Royal Statistical Society: series B \n(statistical methodology), 71 (4). pp. 859-880. ISSN 1369-7412 \n \nDOI: 10.1111\/j.1467-9868.2009.00710.x  \n \n\u00a9 2009 Royal Statistical Society \n \nThis version available at: http:\/\/eprints.lse.ac.uk\/31710\/ \nAvailable in LSE Research Online: November 2011 \n \nLSE has developed LSE Research Online so that users may access research output of the \nSchool. Copyright \u00a9 and Moral Rights for the papers on this site are retained by the individual \nauthors and\/or other copyright owners. Users may download and\/or print one copy of any \narticle(s) in LSE Research Online to facilitate their private study or for non-commercial research. \nYou may not engage in further distribution of the material or use it for any profit-making activities \nor any commercial gain. You may freely distribute the URL (http:\/\/eprints.lse.ac.uk) of the LSE \nResearch Online website.  \n \nThis is the pre-peer reviewed version of the above article, which has been published in final form \nat http:\/\/www.wiley.com\/bw\/journal.asp?ref=1369-7412. There may be differences between this \nversion and the published version.  You are advised to consult the publisher\u2019s version if you wish \nto cite from it. \n \n \nAdaptively Varying Coefficient Spatio-Temporal Models\u2217\nZudi Lu1,2,3 Dag Johan Steinskog4,5 Dag Tj\u00f8stheim6 Qiwei Yao1,7\n1Department of Statistics, London School of Economics, London, WC2A 2AE, UK\n2Department of Mathematics & Statistics, Curtin University of Technology, Perth, Australia\n3 School of Mathematical Sciences, The University of Adelaide, Adelaide, Australia\n4 Nansen Environmental and Remote Sensing Center, 5006 Bergen, Norway\n5Bjerknes Centre for Climate Research, 5007 Bergen, Norway\n6Department of Mathematics, University of Bergen, 5007 Bergen, Norway\n7Guanghua School of Management, Peking University, Beijing 100871, China\nAbstract\nWe propose an adaptive varying-coefficient spatio-temporal model for data observed irreg-\nularly over space and regularly in time. The model is capable of catching possible nonlinearity\n(both in space and in time) and nonstationarity (in space) by allowing the autoregressive co-\nefficients to vary with both spatial location and an unknown index variable. We suggest a\ntwo-step procedure to estimate both the coefficient functions and the index variable, which\nis readily implemented and can be computed even for large spatio-temporal data sets. Our\ntheoretical results indicate that in the presence of the so-called nugget effect, the errors in\nthe estimation may be reduced via the spatial smoothing \u2013 the second step in the proposed\nestimation procedure. The simulation results reinforce this finding. As an illustration, we\napply the methodology to a data set of sea level pressure in the North Sea.\nKey words: \u03b2-mixing, kernel smoothing, local linear regression, nugget effect, spatial smoothing,\nunilateral order.\n\u2217Partially supported by a Leverhulme Trust research grant and EPSRC research grant. Lu\u2019s work was also\npartially supported by an Internal Research Grant from Curtin University of Technology and the Discovery Grant\nfrom Australian Research Council.\n1\n1 Introduction\nThe wide availability of data observed over time and space, in particular through inexpensive\ngeographical information systems, has stimulated many studies in a variety of disciplines such as\nenvironmental science, epidemiology, political science, demography, economics and geography. In\nthese studies, the geographical areas (e.g. counties, census tracts) are taken as units of analysis,\nand specific statistical methods have been developed to deal with the spatial structure reflected in\nthe distribution of the dependent variable; see e.g. Ripley (1981), Anselin (1988), Cressie (1993),\nGuyon (1995), Stein (1999) and Diggle (2003) for systematic reviews of these and related topics.\nIn this paper we are concerned with spatio-temporal data which are measured or transformed\nto a continuous scale and observed irregularly over space but regularly over time. Data sets of this\nform exist extensively. It may be environmental monitoring stations located irregularly in some\nregion, but with measurements taken daily; see for instance Fotheringham et al. (1998), Brunsdon\net al. (2001), Fuentes (2001), Zhang et al. (2003). Applications in spatial disease modelling may\nbe found in Knorr-Held (2000), Lagazio et al. (2001).\nOur model is of the form\nYt(s) = a {s,\u03b1(s)\n\u03c4Xt(s)}+ b1{s,\u03b1(s)\n\u03c4Xt(s)}\n\u03c4Xt(s) + \u03b5t(s), (1.1)\nwhere Yt(s) is the spatio-temporal variable of interest, and t is time, s = (u, v) \u2208 S \u2282 R\n2 is a\nspatial location. Moreover, a(s, z) and b1(s, z) are unknown scalar and d\u00d71 functions, \u03b1(s) is an\nunknown d\u00d7 1 index vector, {\u03b5t(s)} is a noise process which, for each fixed s, forms a sequence of\ni.i.d. random variables over time, andXt(s) = {Xt1(s), \u00b7 \u00b7 \u00b7 , Xtd(s)}\n\u03c4 consists of time-lagged values\nof Yt(\u00b7) in a neighbourhood of s and, possibly, some exogenous variables. Throughout the paper\nwe use \u03c4 to denote the transpose of a vector or a matrix. We let both the regression coefficient b1\nand the intercept a depend on the location s, as well as on the index variable \u03b1(s)\u03c4Xt(s), to catch\npossible nonstationary features over space. Model (1.1) is unilateral in time and, therefore, it can\nbe easily simulated in a Monte Carlo study. Furthermore it is readily applicable to model practical\nproblems. Those features make the model radically different from purely spatial autoregressive\nmodels (Yao and Brockwell 2006). Also note that at a given location s, the coefficient functions\nare univariate functions of \u03b1(s)\u03c4Xt(s). Therefore only one-dimensional smoothing is required in\nestimating those coefficients. (See Section 2.2.1 below).\nModel (1.1) is proposed to model nonlinear and nonstationary spatial data in a flexible manner.\nNote that the literature on spatial processes is overwhelmingly dominated by linear models. On\n1\nthe other hand, many practical data exhibit clearly nonlinear and nonstationary features. For\nexample, in our analysis of the daily mean sea level pressure (MSLP) readings in Section 5, the\noriginal time series at each location is non-linear. Figure 3 below displays the plots for the MSLP\ndata at five randomly selected locations. There are roughly three high pressure periods within\nthe time span concerned. In the middle column of Figure 3, the correlation structure of the\ndifferenced series in the high pressure periods is different from that of the low pressure periods\nand the transition periods. This naturally calls for a nonlinear model with varying coefficients\ndepending also on the past values of the variables from the neighbourhood locations. Such a\ndynamics cannot result in a Gaussian marginal distribution, as indicated in the plots on the right\ncolumn in Figure 3. The estimated densities are more peaked than the normal distribution, the\naccumulation of density mass around zero being due to the high pressure activity.\nModel (1.1) is a spatial extension of the adaptive varying-coefficient linear model of Fan\net al. (2003), see also Xia and Li (1999). Due to the spatial non-stationarity of the model, we adopt\nan estimation strategy involving two steps, which also facilitates the parallel computation over\ndifferent locations. First, for each fixed location s, we estimate the varying coefficient functions\na and b1 and the index vector \u03b1 based on the observations at the location s only. This is a\ntime series estimation problem. Our estimation is based on local linear regression. The second\nstep is to apply spatial smoothing to pool together the information from neighbourhood locations.\nAsymptotic properties of our estimators have been established, which indicate that in the presence\nof the so-called \u2018nugget effect\u2019, the spatial smoothing will reduce the estimation errors. (See also\nLu et al. 2008). Our simulation study reinforces this finding.\nAs far as we are aware, this is the first paper to address spatio-temporal nonlinear dependence\nstructures with spatial nonstationarity and non-Gaussian distributions. Earlier work on nonlinear\nand\/or non-Gaussian spatial models includes, among others, Matheron (1976), Rivoirard (1994),\nChile`s and Delfiner (1999, Chapter 6), Hallin et al. (2004a, 2004b), Biau and Cadre (2004), Gao\net al. (2006), Lu et al. (2007).\nThe structure of the paper is as follows. We introduce our methodology in Section 2. Illus-\ntration with simulated examples are reported in Section 3. In Section 5 there is an application\nto a data set of sea level pressure in the North Sea, for which the index variable may be viewed\nas an analogue of a spatial principal component used in the so-called EOF analysis for climate\ntime series. The asymptotic properties are reported in Section 4, with the regularity conditions\ndeferred to an appendix.\n2\n2 Methodology\n2.1 Identification\nModel (1.1) is not identifiable. In fact, it may be equivalently expressed as\nYt(s) = [a{s,\u03b1(s)\n\u03c4Xt(s)}+ \u03ba{s,\u03b1(s)\n\u03c4Xt(s)}\u03b1(s)\n\u03c4Xt(s)]\n+ [b1{s,\u03b1(s)\n\u03c4Xt(s)} \u2212 \u03ba{s,\u03b1(s)\n\u03c4Xt(s)}\u03b1(s)]\n\u03c4\nXt(s) + \u03b5t(s), (2.1)\nfor any real-valued function \u03ba(\u00b7). To overcome this problem, we may assume that the last com-\nponent of \u03b1(s) is non-zero, the first non-zero component of \u03b1(s) is positive, and ||\u03b1(s)||2 = 1.\nBased on those assumptions, Fan et al. (2003) impose the condition that the last component of\nb1 is 0 in (1.1). Put b1 = (b\n\u03c4 , 0)\u03c4 . This effectively reduces (1.1) to the form\nYt(s) = a{s,\u03b1(s)\n\u03c4Xt(s)}+ [b{s,\u03b1(s)\n\u03c4Xt(s)}]\n\u03c4 X\u02d8t(s) + \u03b5t(s), (2.2)\nwhere X\u02d8t(s) = {Xt,1(s) \u00b7 \u00b7 \u00b7 , Xt,d\u22121(s)}\n\u03c4 . In fact, \u03b1, a and b in (2.2) are now identifiable as\nlong as the regression function E{Yt(s)|Xt(s) = x} is not of the form \u03b1\n\u03c4x\u03b2\u03c4x+ \u03b3\u03c4x+ c, where\n\u03b2, \u03b3 \u2208 Rd, c \u2208 R1 are constants only related to s; see Theorem 1(b) of Fan et al. (2003). Note\nthat (2.1) reduces to (2.2) by setting \u03ba(s, z) = b1d\/\u03b1d, where b1j and \u03b1j denote, respectively, the\nj-th component of b1(s, z) and \u03b1(s).\nA disadvantage of the form (2.2) is that all the components ofXt(s) are not on an equal footing,\nwhich may cause difficulties in model interpretation. This may be particularly problematic when\nXt(s) consists of neighbour variables of Yt(s). One possible remedy is to impose an orthogonal\nconstraint in the model instead, that is\nYt(s) = a\n\u22c6{s,\u03b1(s)\u03c4Xt(s)}+ b1{s,\u03b1(s)\n\u03c4Xt(s)}\n\u03c4Xt(s) + \u03b5t(s), \u03b1(s)\n\u03c4b1(s, z) = 0. (2.3)\nIn fact such an orthogonal representation may be obtained from (2.2) with\na\u22c6(s, z) = a(s, z) + \u03b1(s)(b(s, z)\u03c4 , 0)z and b1(s, z) = (b(s, z)\n\u03c4 , 0)\u03c4 \u2212\u03b1(s)(b(s, z)\u03c4 , 0)\u03b1(s) (2.4)\nwhile \u03b1(s) remains unchanged. Note the condition \u03b1(s)\u03c4b1(s, z) = 0 is fulfilled as ||\u03b1(s)||\n2 = 1.\nFurthermore, (2.3) is an equivalent representation of (2.2), and it is identifiable as long as (2.2)\nis identifiable. To see this, we first note that (2.2) may be deduced from (2.3) by letting\na(s, z) = a\u22c6(s, z) +\nb1d\n\u03b1d\nz and b(s, z) = (b11, \u00b7 \u00b7 \u00b7 , b1,d\u22121)\n\u03c4 \u2212\nb1d\n\u03b1d\n(\u03b11, \u00b7 \u00b7 \u00b7 , \u03b1d\u22121)\n\u03c4 . (2.5)\n3\nThis is effectively to write the first equation in (2.3) in the form of (2.1) with (a, \u03ba) replaced by\n(a\u22c6, b1d\/\u03b1d). Moreover, as \u03b1(s)\n\u03c4b1(s, z) = 0 and ||\u03b1(s)||\n2 = 1, it follows from the second equality\nin (2.5) that\n(b(s, z)\u03c4 , 0)\u03b1(s) =\nd\u22121\u2211\nj=1\n\u03b1jb1j \u2212\nb1d\n\u03b1d\nd\u22121\u2211\nj=1\n\u03b12j = \u2212\u03b1db1d \u2212\nb1d\n\u03b1d\n(1\u2212 \u03b12d) = \u2212\nb1d\n\u03b1d\n.\nHence the d-component b1d of b1(s, z) is identifiable when model (2.2) is identifiable. This,\ntogether with (2.5), implies that all the other components of b1(s, z) as well as a\n\u22c6(s, z) are also\nidentifiable.\nSince the orthogonal constraint \u03b1\u03c4b1 = 0 in (2.3) poses further technical complication in\ninference, in the sequel we proceed with the identifiable model (2.2), assuming that the first non-\nzero element of \u03b1(s) is positive. Only for the real data example in section 5, we present the fitted\nmodel in the form (2.3) via the transformation (2.4).\n2.2 Estimation\nWith the observations {Yt(si), Xt(si)} for t = 1, \u00b7 \u00b7 \u00b7 , T and i = 1, \u00b7 \u00b7 \u00b7 , N , we estimate a,b and\n\u03b1 in model (2.2) in two steps: (i) For each fixed s = si, we estimate them using the time series\ndata {Yt(s),Xt(s), t = 1, \u00b7 \u00b7 \u00b7 , T} only. (ii) By pooling the information from neighbour locations\nvia spatial smoothing, we improve the estimators obtained in (i). The second step also facilitates\nthe estimation at a location s with no direct observations (i.e. s 6= si for 1 \u2264 i \u2264 N).\n2.2.1 Time Series Estimation\nFor a fixed s, we estimate the direction \u03b1(s) and the coefficient functions a(s, \u00b7) and b(s, \u00b7). Fan\net al. (2003) proposed a backfitting algorithm to solve this estimation problem. We argue that\nwith modern computer power, the problem can be dealt with in a more direct manner even for\nmoderately large d such as d between 10 and 20. Note that once the direction \u03b1(s) is fixed, the\nestimators for a and b may be obtained by one-dimensional smoothing over \u03b1(s)\u03c4Xt(s) using, for\nexample, the standard kernel regression methods.\nWe consider the estimation for \u03b1(s) first. If the coefficient functions a and b were known, we\nmay estimate \u03b1 by solving a nonlinear least squares problem; see (2.7) below. Since a and b are\nunknown, we may plug in their appropriate estimators instead. By doing so, we will have used\nthe same observations twice. Note that those estimators themselves are functions of \u03b1. Hence a\ncross-validation approach will be employed to mitigate the effect of the double use of the same\n4\ndata set. For any \u03b1(s), define the leave-one-out estimators a\u02c7\u2212t(s, z) = a\u02c7 and b\u02c7\u2212t(s, z) = b\u02c7, where\n(a\u02c7, b\u02c7) minimises\n1\nT \u2212 1\n\u2211\n1\u2264j\u2264T\nj 6=t\n{\nYj(s)\u2212 a\u2212 b\n\u03c4 X\u02d8j(s)\n}2\nKh{\u03b1\n\u03c4 (s)Xj(s)\u2212 z}, (2.6)\nwhere Kh(\u00b7) = h\n\u22121K(\u00b7\/h), K(\u00b7) is a kernel function and h > 0 is a bandwidth. Then we choose\n\u03b1\u0302(s) and h which minimise\nR(\u03b1, h) =\n1\nT\nT\u2211\nt=1\n[\nYt(s)\u2212 a\u02c7\u2212t{s,\u03b1\n\u03c4Xt(s)} \u2212 b\u02c7\u2212t{s,\u03b1\n\u03c4Xt(s)}\n\u03c4 X\u02d8t(s)\n]2\nw{\u03b1\u03c4Xt(s)}, (2.7)\nwhere w(\u00b7) is a weight function which controls the boundary effect. In the above definition for the\nestimator \u03b1\u0302(s), we used the Nadaraya-Watson estimators a\u02c7 and b\u02c7 in (2.6) to keep the function\nR(\u03b1, h) simple. The asymptotic property of the estimator \u03b1\u0302(s) has been derived based on the\nresults of Lu et al. (2007); see (4.11) in section 4 below. The minimisation of R(\u00b7) may be carried\nout using, for example, the downhill simplex method (section 10.4 of Press et al. 1992).\nOnce \u03b1(s) = \u03b1\u0302(s) is known, we may estimate a and b using univariate local linear regression\nestimation. To this end, let (a\u0302, b\u0302, c\u0302, d\u0302) be the minimisers of\n1\nT\nT\u2211\nj=1\n[\nYj(s)\u2212 a\u2212 c(Zj \u2212 z)\u2212 {b\u2212 d(Zj \u2212 z)}\n\u03c4X\u02d8j(s)\n]2\nKh\u00af(Zj \u2212 z), (2.8)\nwhere Zt = \u03b1\u0302(s)\n\u03c4Xt(s), and a different bandwidth h\u00af from the h in (2.6) will be used. Note that\nboth h and h\u00af are depending on T . The estimators for the functions a(s, \u00b7) and b(s, \u00b7) at z are\ndefined as a\u0302(s, z) = a\u0302 and b\u0302(s, z) = b\u0302.\n2.2.2 Spatial smoothing\nAlthough we do not assume stationarity over space, improvement in estimation of a,b and \u03b1 over\ns may be gained by extracting information from neighbourhood locations, due to the continuity\nof the functions concerned. Zhang et al. (2003) showed for the model they considered that it\nwas indeed the case in the presence of the nugget effect (Cressie, 1993, \u00a7 2.3.1). See also Lu\net al. (2008). Furthermore, the spatial smoothing provides a way to extrapolate our estimators\nto the locations at which observations are not available.\nLet W (\u00b7) be a kernel function defined on R2. Put Wh\u02dc(s) = h\u02dc\n\u22122W (s\/h\u02dc), where h\u02dc > 0 is a\nbandwidth depending on the size N of spatial samples. The bandwidth h\u02dc is different from both\n5\nh and h\u00af in the last subsection. Based on the estimators obtained above for each of the locations\ns1, \u00b7 \u00b7 \u00b7 , sN , the spatially smoothed estimators at the location s0 are defined as\n\u03b1\u02dc(s0) =\nN\u2211\nj=1\n\u03b1\u0302(sj)Wh\u02dc(sj \u2212 s0)\n\/ N\u2211\nj=1\nWh\u02dc(sj \u2212 s0), (2.9)\na\u02dc(s0, z) =\nN\u2211\nj=1\na\u0302(sj , z)Wh\u02dc(sj \u2212 s0)\n\/ N\u2211\nj=1\nWh\u02dc(sj \u2212 s0), (2.10)\nb\u02dc(s0, z) =\nN\u2211\nj=1\nb\u0302(sj , z)Wh\u02dc(sj \u2212 s0)\n\/ N\u2211\nj=1\nWh\u02dc(sj \u2212 s0). (2.11)\n2.3 Bandwidth selection\nFan et al. (2003) outlined an empirical rule for selecting a bandwidth in fitting non-spatial varying-\ncoefficient regression models. Below we adapt that idea to determining bandwidths h\u00af in (2.8) and\nh\u02dc in (2.9) \u2013 (2.11). Note that the bandwidth h in (2.7) is selected, together with \u03b1\u0302(s), by cross-\nvalidation.\nWe first deal with the selection of h\u00af in (2.8). Let\nCV1(h\u00af) =\n1\nT\nT\u2211\nt=1\n[\nYt(s)\u2212 a\u02c7\u2212t,h\u00af{s, \u03b1\u0302\n\u03c4Xt(s)} \u2212 b\u02c7\u2212t,h\u00af{s, \u03b1\u0302\n\u03c4Xt(s)}\n\u03c4 X\u02d8t(s)\n]2\nw{\u03b1\u0302\u03c4Xt(s)}, (2.12)\nwhere a\u02c7\u2212t,h\u00af{s, z} and b\u02c7\u2212t,h\u00af{s, z} are the leave-one-out estimators defined as in (2.8) but with the\nterm of j = t removed from the sum. Under appropriate regularity conditions (c.f. Lu, Tj\u00f8stheim\nand Yao, 2007), it holds that\nCV1(h\u00af) = c0 + c1h\u00af\n4 +\nc2\nT h\u00af\n+ oP (h\u00af\n4 + T\u22121h\u00af\u22121).\nThus, up to first order asymptotics, the optimal bandwidth is h\u00afopt = (c2\/4Tc1)\n1\/5. In practice,\nthe coefficients c0, c1 and c2 will be estimated from solving the least squares problem\nmin\nc0,c1,c2\nq\u2211\nk=1\n{\nCV1k \u2212 c0 \u2212 c1h\u00af\n4\nk \u2212 c2\/(T h\u00afk)\n}2\n, (2.13)\nwhere CV1k = CV1(h\u00afk) obtained from (2.12), and h\u00af1, \u00b7 \u00b7 \u00b7 , h\u00afq are q prescribed bandwidth values.\nWe let h\u00af = (c\u03022\/4T c\u03021)\n1\/5 when both c\u03021 and c\u03022 are positive. In the likely event that one of\nthem is nonpositive, we let h\u00af = argmin1\u2264k\u2264q CV1(h\u00afk). This bandwidth selection procedure is\ncomputationally efficient as q is moderately small, i.e. we only need to compute q CV-values; see\nRemark 2(c) in Fan et al. (2003). Furthermore the least squares estimation (2.13) also serves as\na smoother for the CV bandwidth estimates. Also see Ruppert (1997).\n6\nThe bandwidth h\u02dc in (2.9) \u2013 (2.11) may be determined in the same manner. For example, for\nthe estimator (2.9), the CV function is defined as\nCV2(h\u02dc) =\n1\nN\nN\u2211\ni=1\n[\n\u03b1\u0302(si)\u2212 \u03b1\u02dc\u2212si,h\u02dc(si)\n]2\n,\nwhich admits the asymptotic expansion\nCV2(h\u02dc) = d0 + d1h\u02dc\n4 +\nd2\nNh\u02dc2\n+ oP (h\u02dc\n4 +N\u22121h\u02dc\u22122).\nThe resulting bandwidth is of the form h\u02dc = {d\u03022\/(2Nd\u03021)}\n1\/6.\nThe CV bandwidth selection has been extensively studied in the literature. In the sense of\nmean integrated squared error (MISE) the relative error of a CV-bandwidth is higher than that\nof, for example, a plug-in method of Ruppert et al. (1995). However there is a growing body of\nopinion (e.g., Mammem, 1990; Jones, 1991; Ha\u00a8rdle & Vieu, 1992; and Loader, 1999) maintaining\nthat the selection of bandwidth should be targeted at estimating the unknown function instead\nof the ideal bandwidth itself. Therefore, one should seek a bandwidth minimising the integrated\nsquared error (ISE) rather than the MISE, i.e., focusing on loss rather than risk. From this point\nof view, the CV-bandwidth performs reasonably well (Hall and Johnstone, 1992, page 479). In\ntime series context, the argument for why cross-validation is an appropriate selection method for\nthe bandwidth can be found in Kim and Cox (1996), Quintela-del-R\u00b4\u0131o (1996) and Xia and Li\n(2002), among others.\n3 A simulated example\nConsider a spatio-temporal process\nYt+1(sij) = a{sij , Zt(sij)}+ b1{sij , Zt(sij)}Yt(sij) + b2{sij , Zt(sij)}Xt(sij) + 0.1\u03b5t(sij)\ndefined on the grid points sij = (ui, vj), where\na(sij , z) = 3exp\n{ \u22122z2\n1 + 7(ui + vj)\n}\n, b1(sij , z) = 0.7 sin{7\u03c0(ui + vj)}, b2(sij , z) = 0.8z,\nZt(sij) =\n1\n3\n{2Yt(sij) + 2Xt(sij) +Xt(si,j+1))}, Xt(sij) =\n2\n9\n1\u2211\nk=\u22121\n1\u2211\n\u2113=\u22121\net(si+k,j+\u2113),\nand all \u03b5t(sij) and et(sij) are independent N(0, 1) random variables. Observations were taken\nover N = 64 grid points {(ui, vj), 1 \u2264 i, j \u2264 8}, where ui = vi = (i \u2212 1)\/8 with T = 60 or\n7\n100. For each given s = sij , we estimated the curves a(s, \u00b7), b1(s, \u00b7) and b2(s, \u00b7) on the 11 grid\npoints z\u2113 = \u22120.5 + 0.1(\u2113\u2212 1) (\u2113 = 1, \u00b7 \u00b7 \u00b7 , 11), as well as the index \u03b1(s) = (\u03b11(s), \u03b12(s), \u03b13(s))\n\u03c4 \u2261\n(2\/3, 2\/3, 1\/3)\u03c4 , which is independent of s. The accuracy of the estimation is measured by the\nthe squared estimation errors:\nSEE{\u03b1\u0302j(s)} = {\u03b1\u0302j(s)\u2212 \u03b1j}\n2, j = 1, 2, 3,\nSEE{a\u0302(s)} =\n1\n11\n11\u2211\n\u2113=1\n{a\u0302(s, z\u2113)\u2212 a(s, z\u2113)}\n2,\nSEE{b\u0302k(s)} =\n1\n11\n11\u2211\n\u2113=1\n{b\u0302k(s, z\u2113)\u2212 bk(s, z\u2113)}\n2, k = 1, 2.\nFor each setting, we replicated the experiments 10 times. The SEE over the 64 grid points are\ncollectively displayed as boxplots in Figure 1 for T = 60, and in Figure 2 for T = 100 (i.e. each\nof the boxplots is based on 10 \u00d7 64 = 640 SEE values). It is clear that the estimates defined in\nsection 2.2.1 are less accurate than those defined in section 2.2.2. In fact the gain from the spatial\nsmoothing is substantial. The plots also indicate that the estimation becomes more accurate when\nT increases.\nThe improvement from the spatial smoothing is due to the fact that the functions to be es-\ntimated are continuous in s. If we view the observations {Yt(sij), Xt(sij)} as a sample from a\nspatio-temporal process with s varying continuously over space, the sample paths of such an un-\nderlying process are discontinuous over space, as both \u03b5t(s) and et(s) are independent at different\nlocations no matter how close they are. The spatial smoothing pulls together the information on\nthe mean function from neighbour locations. It is intuitively clear that there would not be any\ngains from such a \u2018local pulling\u2019 if the sample realisations of both Xt(\u00b7) and \u03b5t(\u00b7) are continuous\nin s. The improvement may be obtained when the observations pulled together bring in different\ninformation, which is only possible when the sample realisations are discontinuous. The theory\ndeveloped in next section indicates that the spatial smoothing may indeed improve the estimation\nwhen the \u2018nugget effect\u2019 is present, which results in the discontinuity in sample realisations as a\nfunction of s. See also Lu et al. (2008) for more detailed discussions regarding the asymptotic\ntheory with or without nugget effect.\n8\nPanel A\n0.\n0\n0.\n05\n0.\n10\n0.\n15\n0.\n20\n0.\n25\n0.\n30\nNon-SS SS\nsq\nua\nre\nd \ner\nro\nr\n(a)\n0.\n0\n0.\n01\n0.\n02\n0.\n03\n0.\n04\nNon-SS SS\nsq\nua\nre\nd \ner\nro\nr\n(b)\n0.\n0\n0.\n05\n0.\n10\n0.\n15\n0.\n20\n0.\n25\n0.\n30\nNon-SS SS\nsq\nua\nre\nd \ner\nro\nr\n(c)\nPanel B\n0\n1\n2\n3\n4\n5\nNon-SS SS\nsq\nua\nre\nd \ner\nro\nr\n(a)\n0\n10\n20\n30\n40\nNon-SS SS\nsq\nua\nre\nd \ner\nro\nr\n(b)\n0\n2\n4\n6\n8\n10\n12\nNon-SS SS\nsq\nua\nre\nd \ner\nro\nr\n(c)\nFigure 1: Simulation with T = 60 \u2013 Boxplots for the SEEs of the three components of \u03b1 (Panel\nA), and the varying coefficient functions (Panel B): (a) a(\u00b7), (b) b1(\u00b7), (c) b2(\u00b7). The plots for the\nestimates defined in section 2.2.1 are labelled as \u2018Non-SS\u2019, and the plots for the spatial smoothing\nestimates are labelled as \u2018SS\u2019.\n9\nPanel A\n0.\n0\n0.\n05\n0.\n10\n0.\n15\n0.\n20\n0.\n25\n0.\n30\nNon-SS SS\nsq\nua\nre\nd \ner\nro\nr\n(a)\n0.\n0\n0.\n01\n0.\n02\n0.\n03\nNon-SS SS\nsq\nua\nre\nd \ner\nro\nr\n(b)\n0.\n0\n0.\n05\n0.\n10\n0.\n15\n0.\n20\n0.\n25\nNon-SS SS\nsq\nua\nre\nd \ner\nro\nr\n(c)\nPanel B\n0\n1\n2\n3\n4\nNon-SS SS\nsq\nua\nre\nd \ner\nro\nr\n(a)\n0\n10\n20\n30\nNon-SS SS\nsq\nua\nre\nd \ner\nro\nr\n(b)\n0\n2\n4\n6\nNon-SS SS\nsq\nua\nre\nd \ner\nro\nr\n(c)\nFigure 2: Simulation with T = 100 \u2013 Boxplots for the SEEs of the three components of \u03b1 (Panel\nA), and the varying coefficient functions (Panel B): (a) a(\u00b7), (b) b1(\u00b7), (c) b2(\u00b7). The plots for the\nestimates defined in section 2.2.1 are labelled as \u2018Non-SS\u2019, and the plots for the spatial smoothing\nestimates are labelled as \u2018SS\u2019.\n10\n4 Asymptotic properties\nThe improvements due to the spatial smoothing have been illustrated via simulation in Section 3.\nIn this section, we derive the asymptotic bias and variance of the estimators (2.9) \u2013 (2.11), which\nalso show the benefits from spatial smoothing in the presence of the so-called nugget effect. Note\nthat those asymptotic approximations are derived without the stationarity over space. On the\nother hand, the asymptotic normality for the time series estimators defined in Section 2.2.1 may\nbe derived from Theorems 3.1 and 3.2 of Lu et al. (2007). We introduce some notation first.\nWe always assume the true index \u03b1(s) \u2208 B for all s \u2208 S, where\nB ={\u03b2 = (\u03b21, \u00b7 \u00b7 \u00b7 , \u03b2d)\n\u03c4 \u2208 Rd : \u2016\u03b2\u2016 = 1, the first non-zero element is positive,\nand the last element is non-zero with |\u03b2d| \u2265 \u01eb0}, (4.1)\nand \u01eb0 > 0 is a fixed constant. Put Xt(s) = (1, X\u02d8t(s)\n\u03c4 )\u03c4 = (1, Xt1(s), \u00b7 \u00b7 \u00b7 , Xt,d\u22121(s))\n\u03c4 , and\ng(s, z,\u03b2) = [E{Xt(s)X\n\u03c4\nt (s)|\u03b2\n\u03c4Xt(s) = z}]\n\u22121E{Xt(s)Yt(s)|\u03b2\n\u03c4Xt(s) = z},\nwhere the matrix inverse is ensured by Assumption C6 in the appendix. We denote the derivatives\nof g as follows:\ng\u02d9z(s, z,\u03b2) = \u2202g(s, z,\u03b2)\/\u2202z, g\u02d9\u03b2(s, z,\u03b2) = \u2202g(s, z,\u03b2)\/\u2202\u03b2\n\u03c4 , g\u00a8z(s, z,\u03b2) = \u2202\n2g(s, z,\u03b2)\/\u2202z2.\nWhen \u03b2 = \u03b1(s), we will often drop \u03b1(s) in g{s, z,\u03b1(s)} and its derivatives if no confusion arises.\nIt therefore follows from (2.2) that g{s, z}\u03c4 = g{s, z,\u03b1(s)}\u03c4 = {a(s, z),b(s, z)\u03c4}. Further, we let\nZt(s) = \u03b1(s)\n\u03c4Xt(s), and define\n\u0393(s) = E[g\u02dc(s)\u03c4Xt(s)Xt(s)\n\u03c4 g\u02dc(s)w{Zt(s)}], (4.2)\nwhere g\u02dc(s) = g\u02d9z{s, Zt(s), \u03b1(s)}Xt(s)\n\u03c4 + g\u02d9\u03b2{s, Zt(s), \u03b1(s)}.\nLet \u03b1j(s) and \u03b1\u00a8j(s) be the j-th component of \u03b1(s) and its second order derivative matrix with\nrespect to s, respectively. Recall that h = hT and h\u00af = h\u00afT are the two bandwidths used for time\nseries smoothing in Section 2.2.1, and h\u02dc = h\u02dcN is the bandwidth for spatial smoothing in Section\n2.2.2. Put \u00b52,K =\n\u222b\nu2K(u) du, \u00b52,W =\n\u222b\nS\nuu\u03c4W (u)du and \u03bd0,K =\n\u222b\nK2(u) du, where K and W\nare the two kernel functions used in our estimation.\nNow we are ready to present the asymptotic biases and variances for the spatial smoothing\nestimators \u03b1\u02dc(s0), a\u02dc(s0) and b\u02dc(s0), which are derived when T \u2192 \u221e. The key is to show that the\n11\ntime series estimators \u03b1\u0302(s), a\u0302(s) and b\u0302(s) converge uniformly in s over a small neighbourhood of\ns0, which is established using the results in Lu et al. (2007). Naturally the derived asymptotic\napproximations for the biases and variances of \u03b1\u02dc(s0), a\u02dc(s0) and b\u02dc(s0) depend on N , and those\napproximations admit more explicit expressions when N \u2192 \u221e. Note we write aN \u2243 bN if\nlimN\u2192\u221e aN\/bN = 1.\nTheorem 4.1 Let conditions C1 \u2013 C10 listed in the Appendix hold. Assume that s0 \u2208 S and\nf(s0) > 0, where f(\u00b7) is given in condition C8. Then as T \u2192\u221e, it holds that\n\u03b1\u02dc(s0)\u2212\u03b1(s0) = B1,N (s0)h\n2(1 + oP (1)) + B2,N (s0)\n+ T\u22121\/2 {V1,N (s0) + V2,N (s0)} \u03b7(s0)(1 + oP (1)),\nwhere \u03b7(s0) is a d\u00d7 1 random vector with zero mean and identity covariance matrix,\nB1,N (s) \u2243 \u2212\n1\n2\n\u0393\u22121(s)E[g\u02dc(s)\u03c4Xt(s)Xt(s)\n\u03c4 g\u00a8z{s, Zt(s),\u03b1(s)}w{Zt(s)}]\u00b52,K , (4.3)\nB2,N (s) \u2243\n1\n2\nh\u02dc2 (tr [\u03b1\u00a81(s)\u00b52,W ] , \u00b7 \u00b7 \u00b7 , tr [\u03b1\u00a8d(s)\u00b52,W ])\n\u03c4 , (4.4)\nand V1,N (s0) and V2,N (s0) are two d\u00d7 d matrices, satisfying\nV1,N (s)V\n\u03c4\n1,N (s) \u2243 (\u03c3\n2\n1(s) + \u03c3\n2\n2(s))\u0393\n\u22121(s)V(s, s)\u0393\u22121(s)\n{\n1\nNh\u02dc2\nf(s)\u22121\n\u222b\nW 2(u)du\n}\n, (4.5)\nV2,N (s)V\n\u03c4\n2,N (s) \u2243 \u03c3\n2\n1(s)\u0393\n\u22121(s)V1(s, s)\u0393\n\u22121(s). (4.6)\nIn the above expressions, \u0393(s) is defined in (4.2), and \u03c321(s) and \u03c3\n2\n2(s) are defined in C2, and V\nand V1 in C3 in the Appendix.\nLet \u03d1\u02dc(s0, z) \u2261 (a\u02dc(s0, z), b\u02dc(s0, z)\n\u03c4 )\u03c4 and \u03d1(s, z) \u2261 (a(s, z),b(s, z)\u03c4 )\u03c4 . Denote by \u03d1j(s, z) the\nj-th component of \u03d1(s, z), and \u03d1\u00a8s,j(s, z) its second derivative matrix with respect to s. Denote\nby \u03d1\u00a8z(s, z) = (a\u00a8z(s, z), b\u00a8z(s, z)\n\u03c4 )\u03c4 the second order derivatives with respect to z.\nTheorem 4.2 Let the conditions of Theorem 4.1 hold, and h\u00af = O(T\u22121\/5). Let the density\nfunction of \u03b1(s0)\n\u03c4Xt(s0) be positive at z. Then as T \u2192\u221e, it holds that\n\u03d1\u02dc(s0, z)\u2212 \u03d1(s0, z) = B3,N (s0, z)h\u00af\n2(1 + oP (1)) + B4,N (s0, z)\n+\n{\n(T h\u00af)\u22121\/2V3,N + T\n\u22121\/2V4,N\n}\n\u03be(s0)(1 + oP (1)),\n12\nwhere \u03be(s0) is a d\u00d7 1 random vector with zero mean and identity covariance matrix,\nB3,N (s0, z) \u2243\n1\n2\n\u00b52K \u03d1\u00a8z(s0, z), (4.7)\nB4,N (s0, z) \u2243\n1\n2\nh\u02dc2\n(\ntr\n[\n\u03d1\u00a8s,1(s0, z)\u00b52,W\n]\n, \u00b7 \u00b7 \u00b7 , tr\n[\n\u03d1\u00a8s,d(s0, z)\u00b52,W\n])\u03c4\n, (4.8)\nand V3,N and V4,N are two d\u00d7 d matrices, satisfying\nV3,NV\n\u03c4\n3,N \u2243 (\u03c3\n2\n1(s0) + \u03c3\n2\n2(s0))\u03bd0,KA\n\u22121(s0, z)f\n\u22121\nZ (s0, z)\n{\n1\nNh\u02dc2\nf\u22121(s0)\n\u222b\nW 2(s)ds\n}\n, (4.9)\nV4,NV\n\u03c4\n4,N \u2243 \u03c3\n2\n1(s0)(A\n\u22121(s0, z)A1(s0, s0; z, z)A\n\u22121(s0, z))f\n\u22122\nZ (s0, z)f\n\u2217(s0, z). (4.10)\nwhere \u03c321(s) and \u03c3\n2\n2(s) are defined in (C2), and A(s, z) = A(s, s, z, z) and A1(s, s, z, z) in (C5)\nin the Appendix.\nRemark. (i) In the above theorems, (4.3), (4.4), (4.7) and (4.8) are approximate biases whereas\n(4.5), (4.6), (4.9) and (4.10) are approximate variances.\n(ii) In the presence of nugget effect specified in C2 and C3 in the Appendix, the spatial\nsmoothing estimators \u03b1\u02dc(s0), a\u02dc(s0, z) and b\u02dc(s0, z) have smaller asymptotic variances than the\ncorresponding time series estimators \u03b1\u0302(s0), a\u0302(s0, z) and b\u0302(s0, z). In fact using the results in Lu\net al. (2007), we may deduce that\n\u03b1\u0302(s)\u2212\u03b1(s) = B1(s)h\n2(1 + oP (1)) + T\n\u22121\/2A1(s)\u03b7(s)(1 + oP (1)), (4.11)\nwhere B1(s) is as defined in Theorem 4.1, and\nA1(s)A\n\u03c4\n1(s) = (\u03c3\n2\n1(s) + \u03c3\n2\n2(s))\u0393\n\u22121(s)V(s, s)\u0393\u22121(s),\nand that\n\u03d1\u0302(s, z)\u2212 \u03d1(s, z) = B3(s, z)h\u00af\n2(1 + oP (1)) + (T h\u00af)\n\u22121\/2A3(s, z)\u03be(s)(1 + oP (1)), (4.12)\nwhere B3(s, z) is as defined in Theorem 4.2, and\nA3(s, z)A\n\u03c4\n3(s, z) = (\u03c3\n2\n1(s) + \u03c3\n2\n2(s))\u03bd0,KA\n\u22121(s, z){fZ(s, z)}\n\u22121.\nComparing (4.11) and (4.12) with Theorems 4.1 and 4.2, respectively, we note that both (4.5) and\n13\n(4.9) tend to 0, and the asymptotic variances of the spatial smoothing estimators are therefore\nmuch smaller.\n(iii) In the case of no nugget effect (i.e. \u03c322(s0) = 0 in C2, A0(s0, z) = A2(s0, s0, z, z) \u2261 0\nand V2(s0, s0) = 0 in C3), spatial smoothing cannot reduce the asymptotic variance of the time\nseries estimators \u03b1\u0302(s0), a\u0302(s0) and b\u0302(s0). See also Lu et al. (2008). This is due to the fact\nthat the spatial smoothing uses effectively the data at locations within a distance h\u02dc from s0.\nDue to the continuity of the function \u03b31(\u00b7, \u00b7) stated in C2, all the \u03b5t(s)\n\u2032s from those locations\nare asymptotically identical. We argue that asymptotic theory under this setting presents an\nexcessively gloomy picture. Adding a nugget effect in the model brings the theory closer to reality\nsince in practice the data used in local spatial smoothing usually contain some noise components\nwhich are not identical even within a very small neighborhood. Note that the nugget effect is\nnot detectable in practice since we can never estimate \u03b3(s+\u2206, s) defined in (6.1) below for ||\u2206||\nless than the minimum pairwise-distance among observed locations. See also Remark 3 of Zhang\net al. (2003).\nThe proofs of Theorems 4.1 and 4.2 are included in an extended version of this paper available\nat http:\/\/stats.lse.ac.uk\/q.yao\/qyao.links\/paper\/spatioVLM.pdf.\n5 A real data example\nWe illustrate the proposed methodology with a meteorological data set.\n5.1 Data\nWe analyze the daily mean sea level pressure (MSLP) readings measured in units of Pascal in an\narea of the North Sea with longitudes from 20 degrees East to 20 degrees West and latitudes from\n50 to 60 degrees North. This area is heavily influenced by travelling low pressure systems. The\ngrid points are of size 2.5\u00d72.5 degrees with total number of 17\u00d75 = 85 spatial locations. The time\nperiod is winter 2001-2002 with 100 daily observations at each location starting from 1 December\n2001. The data are provided by the National Centers for Environmental Prediction-National\nCenter for Atmospheric Research (NCEP-NCAR). This type of data is commonly used in climate\nanalysis, and more detailed information about the data can be found in Kalnay et al. (1996).\nTrends are not removed, and therefore the original time series of mean sea level pressure (MSLP)\nat each location is generally non-stationary, and we have chosen to work with the differenced\n14\nseries (daily change series). Figure 3 displays some plots for MSLP data at five randomly selected\nlocations. We denote the daily changes of MSLP as Yt(sij) = Yt(ui, vj), t = 1, \u00b7 \u00b7 \u00b7 , 99, ui =\n60\u2212 (i\u2212 1)\u00d7 2.5 with i = 1, \u00b7 \u00b7 \u00b7 , 5, and vj = \u221217.5+ (j\u2212 1)\u00d7 2.5 with j = 1, 2, \u00b7 \u00b7 \u00b7 , 17. From the\nmiddle column of Figure 3, the daily change series of MSLP, Yt(s), looks approximately stationary\nat each site.\nThe contour plots of the daily changes are given in Figure 4 for the time period t = 1 to t = 20.\nThese plots show the difference from one day to another as a function of spatial coordinate. For\nthe high pressure period (approximately t = 8 to t = 16) it is seen that for most spatial locations\nthere are small changes, corresponding to the fact that a high pressure system is fairly stable in\ntime and in space. The zero-contour of no change is also seen to be fairly stable running in the\nnorth-south direction roughly in the middle of this area. Just prior to t = 8, positive pressure\ngradients are dominating corresponding to the build-up of the high pressure system, whereas\nnegative gradients are dominating after t = 16, when the high pressure system is deteriorating.\n5.2 Varying coefficient modelling\nNow we model the daily changes Yt(s) by the varying coefficient model (1.1) with\nXt(sij)\n\u03c4 = (Yt\u22121(si\u22121,j), Yt\u22121(si+1,j), Yt\u22121(si,j\u22121), Yt\u22121(si,j+1), Yt\u22121(sij)), (5.1)\ni.e. X(sij) consists of the lagged values at the four nearest neighbours of the location sij , and\nthe lagged value at sij itself. We only use the time lag 1 since the autocorrelation of the daily\nchange data is weak. It is clear that this specification does not require that the data are recorded\nregularly over the space. With X(sij) specified above, (1.1) is now of the form\nYt(sij) =a(sij , Zt(sij)) + b1(sij , Zt(sij))Yt\u22121(si\u22121,j) + b2(sij , Zt(sij))Yt\u22121(si+1,j) (5.2)\n+b3(sij , Zt(sij))Yt\u22121(si,j\u22121) + b4(sij , Zt(sij))Yt\u22121(si,j+1) + b5(sij , Zt(sij))Yt\u22121(si,j) + \u03b5t(sij)\nwith Zt(sij) = \u03b1(sij)\n\u03c4Xt(sij), \u03b1(sij)\n\u03c4 = (\u03b11(sij), \u03b12(sij), \u03b13(sij), \u03b14(sij), \u03b15(sij)) and b\n\u03c4 =\n(b1, b2, b3, b4, b5). The estimation was based on data from 45 locations: Yt(sij) = Yt(ui, vj),\nt = 1, \u00b7 \u00b7 \u00b7 , 99, i = 2, 3, 4, and j = 2, \u00b7 \u00b7 \u00b7 , 16, owing to the boundary effect in space. The band-\nwidths were selected using the methods specified in Section 2.3, in which we let q = 10 and\ntake h\u00afk = CT h\u00afck with CT = std(Zt)(99)\n\u22121\/5 and std(Zt) being the sample standard deviation of\n{Zt = \u03b1\u0302\n\u03c4Xt(s)}\n99\nt=1 at location s, and h\u00afck = 0.1k for k = 1, 2, \u00b7 \u00b7 \u00b7 , q. The estimated a(z), b1(z),\nb2(z), b3(z), b4(z) and b5(z) at 45 locations, together with their averages (over the 45 locations),\nare plotted in Figure 5 without spatial smoothing, and Figure 6 with the spatial smoothing.\n15\n0 20 40 60 80 100\n98\n00\n0\n10\n00\n00\n10\n20\n00\n10\n40\n00\n0 20 40 60 80 100\n-\n20\n00\n-\n10\n00\n0\n10\n00\n20\n00\nx\nde\nns\nity\n-3000 -2000 -1000 0 1000 2000 3000\n0.\n0\n0.\n00\n01\n0.\n00\n03\n0.\n00\n05\n0 20 40 60 80 100\n98\n00\n0\n10\n00\n00\n10\n20\n00\n10\n40\n00\n0 20 40 60 80 100\n-\n20\n00\n-\n10\n00\n0\n10\n00\n20\n00\nx\nde\nns\nity\n-2000 0 2000 4000\n0.\n0\n0.\n00\n01\n0.\n00\n02\n0.\n00\n03\n0.\n00\n04\n0 20 40 60 80 100\n99\n00\n0\n10\n10\n00\n10\n30\n00\n0 20 40 60 80 100\n-\n20\n00\n-\n10\n00\n0\n10\n00\n20\n00\nx\nde\nns\nity\n-3000 -2000 -1000 0 1000 2000 3000\n0.\n0\n0.\n00\n02\n0.\n00\n04\n0.\n00\n06\n0 20 40 60 80 100\n98\n00\n0\n10\n00\n00\n10\n20\n00\n10\n40\n00\n0 20 40 60 80 100\n-\n30\n00\n-\n10\n00\n0\n10\n00\n20\n00\nx\nde\nns\nity\n-4000 -2000 0 2000\n0.\n0\n0.\n00\n01\n0.\n00\n03\n0.\n00\n05\n0 20 40 60 80 100\n10\n00\n00\n10\n20\n00\n10\n40\n00\n0 20 40 60 80 100\n-\n10\n00\n0\n10\n00\nx\nde\nns\nity\n-2000 -1000 0 1000 2000\n0.\n0\n0.\n00\n01\n0.\n00\n03\n0.\n00\n05\nFigure 3: Modelling of MSLP data \u2013 Column on the left: the time series plots of the daily MSLP\nseries in 1 December 2001 \u2013 10 March 2002. Middle column: the daily changes of MSLP. Column\non the right: the estimated density function (solid curves) of the daily changes together with the\nthe normal density with the same mean and variance (dashed curves).\n16\nlongitude\nla\ntit\nud\ne\n-20 -10 0 10 20\n50\n52\n54\n56\n58\n60\n-500  0\n 0\n500 500\n10001000\n15002000\nt=1\nlongitude\nla\ntit\nud\ne\n-20 -10 0 10 20\n50\n52\n54\n56\n58\n60\n-2000\n-1500\n-1000\n-1000\n-500\n 0\n 0\n500\nt=2\nlongitude\nla\ntit\nud\ne\n-20 -10 0 10 20\n50\n52\n54\n56\n58\n60\n-1000\n 0\n1000\n2000\nt=3\nlongitude\nla\ntit\nud\ne\n-20 -10 0 10 20\n50\n52\n54\n56\n58\n60\n-500\n 0\n500\n10001500\n2000\nt=4\nlongitude\nla\ntit\nud\ne\n-20 -10 0 10 20\n50\n52\n54\n56\n58\n60\n-500\n 0\n 0500\n5001000\n1000\n1500\nt=5\nlongitude\nla\ntit\nud\ne\n-20 -10 0 10 20\n50\n52\n54\n56\n58\n60\n-1000\n-500  0\n500\n500 1000\n1500\n1500\nt=6\nlongitude\nla\ntit\nud\ne\n-20 -10 0 10 20\n50\n52\n54\n56\n58\n60\n 0\n500\n500 500\n1000\n15002000\nt=7\nlongitude\nla\ntit\nud\ne\n-20 -10 0 10 20\n50\n52\n54\n56\n58\n60\n-600\n-400\n-200\n 0\n 0\n 0\n 0\n200\n400\nt=8\nlongitude\nla\ntit\nud\ne\n-20 -10 0 10 20\n50\n52\n54\n56\n58\n60\n-800\n-600\n-400\n-400-200\n-200\n 0  0\n 0\n200400 400\nt=9\nlongitude\nla\ntit\nud\ne\n-20 -10 0 10 20\n50\n52\n54\n56\n58\n60\n-600\n-400\n-200\n 0\n 0200\n200400600\nt=10\nlongitude\nla\ntit\nud\ne\n-20 -10 0 10 20\n50\n52\n54\n56\n58\n60\n-600\n-400-200\n 0\n 0\n200\n200\n400\n600\nt=11\nlongitude\nla\ntit\nud\ne\n-20 -10 0 10 20\n50\n52\n54\n56\n58\n60\n-500\n 0\n 0\n500\n1000\nt=12\nlongitude\nla\ntit\nud\ne\n-20 -10 0 10 20\n50\n52\n54\n56\n58\n60\n-600\n-400\n-200\n 0\n200\n200\n200\n400\n600 800\nt=13\nlongitude\nla\ntit\nud\ne\n-20 -10 0 10 20\n50\n52\n54\n56\n58\n60\n-600\n-400\n-200 0200\n200\n200\n400\n400\n400\n600\nt=14\nlongitude\nla\ntit\nud\ne\n-20 -10 0 10 20\n50\n52\n54\n56\n58\n60 -800\n-600\n-400\n-200\n-200\n 0\n 0\n 0\n200400\nt=15\nlongitude\nla\ntit\nud\ne\n-20 -10 0 10 20\n50\n52\n54\n56\n58\n60\n-400\n-200\n 0  0200\n400\nt=16\nlongitude\nla\ntit\nud\ne\n-20 -10 0 10 20\n50\n52\n54\n56\n58\n60\n-800 -600\n-400\n-200\n-200 0\n 0200\nt=17\nlongitude\nla\ntit\nud\ne\n-20 -10 0 10 20\n50\n52\n54\n56\n58\n60\n-2500\n-2000\n-1500\n-1000\n-500\n 0\nt=18\nlongitude\nla\ntit\nud\ne\n-20 -10 0 10 20\n50\n52\n54\n56\n58\n60\n-500\n-500\n 0\n 0\n500\n1000\nt=19\nlongitude\nla\ntit\nud\ne\n-20 -10 0 10 20\n50\n52\n54\n56\n58\n60\n-2500\n-2000\n-2000\n-1500\n-1000\n-1000-500 -500\nt=20\nFigure 4: Modelling of MSLP data \u2013 The contour plots of the daily MSLP changes {Yt(s)} for\nthe first 20 days (i.e. t = 1, \u00b7 \u00b7 \u00b7 20). 17\nIf the meteorological data could be described linearly, the functions displayed in Figures 5 and\n6 would be constant. But clearly they are not. If these plots are continued for higher and lower\nvalues of z, the asymptote turns out to be roughly horizontal. This means that in a low pressure\nsituation the system behaves roughly as a linear system, but not in the high pressure zones\n(z \u2248 0) and the transition zones. This indicates that altogether the weather system is nonlinear.\nIn another context it would be of interest to try to give a detailed meteorological interpretation\nof the curves. But since this is a general paper, we satisfy ourselves by noting the following: 1)\nz \u2248 0: This corresponds to a high pressure situation primarily. The curves for bi, i = 1, . . . , 5,\nhave their maximum\/minimum at zero, the negative and positive peak values roughly balancing\nout, and given that the Xt-variables stay around zero for a high pressure situation, the effect is\nthat Yt stays around zero, and the high pressure continues. 2) z < 0: This is the situation when\na high pressure deteriorates, or when new low pressure areas are coming in. It is seen that there\nare only small contributions from the north (b1), east (b4) and the site itself (b5), but a main\npositive contribution from west (b3) having the effect of maintaining a negative difference in Xt.\nIt is tempting to interpret this as having to do with low pressure systems coming primarily from\nthe west in the North Sea.\nThe contour plots (not shown) of the estimated index \u03b1\u03c4X(s) resemble the patterns of Figure\n4; indicating that it catches the major spatial variation of Y (s). Furthermore there were little vari-\nation in the index vector\u03b1(s) over the space. The average value is \u03b1\u00af\u03c4 = (\u22120.367,\u22120.252, 0.174, 0.219, 0.851).\nNote that the last component of the index vector is substantially greater than all the others, in-\ndicating the dominating role of the lagged value from the same site; see (5.1). We plot the 45\nestimated index time series Zt(s) in Figure 7(a), together with the first principal component series\n\u03b3(t) = \u03bb\u03c41Yt where \u03bb1 is the first principal component of the data (explaining about 46% of the\ntotal variation). Note that the oscillatory patterns of \u03b3(t) and the estimated index series Zt(s) are\nsimilar. The high pressure areas can again be identified as regions where the Zt(s)-series are close\nto zero, building up a high pressure area corresponds to positive Zt(s) (but not conversely), and\ndeterioration to negative Zt(s) (but not conversely). There does not seem to be a corresponding\nregularity for the \u03b3(t) series, which is sometimes taken as a representative index for the North\nAtlantic Oscillation (NAO) on another time scale.\n18\noooooooooo\nooo\noo\noooo\nooo\nooo\noo\nooo\noo\nooo\nooo\nooo\nooo\nooooooooooooooooooooooo\noo\nooooooooooooo\nz\na\n0\n-100 -50 0 50 100\n-\n20\n0\n-\n15\n0\n-\n10\n0\n-\n50\n0\n50\n10\n0\n(a)\nooooooooooooooooooooooooooooo\noo\nooo\nooo\nooo\noo\noo\nooo\noooo\noooooooooooooo\nz\nb1\n-100 -50 0 50 100\n-\n6\n-\n4\n-\n2\n0\n2\n4\n(b)\nooooooooooooooooooooooooooo\noo\noo\noo\nooo\nooo\noooo\noooooooooooooo\nz\nb2\n-100 -50 0 50 100\n-\n6\n-\n4\n-\n2\n0\n2\n4\n(c)\noooooooo\noooooo\noooo\noooo\noooooooooooooooooooooooooooooooooooooooo\nz\nb3\n-100 -50 0 50 100\n-\n5\n0\n5\n(d)\noooooo\noooooooo\nooo\nooo\noooo\noooooooooooooooooooooooooooooooooooooooooo\nz\nb4\n-100 -50 0 50 100\n-\n5\n0\n5\n(e)\nooooooooooooooooooooooooooooo\noo\nooo\nooo\nooo\nooo\nooo\noo\noo\noo\noooo\noooooooooooo\nz\nb5\n-100 -50 0 50 100\n-\n6\n-\n4\n-\n2\n0\n2\n4\n(f)\nFigure 5: Modelling of MSLP data \u2013 The estimated curves (dotted lines) of 45 locations together\nwith the averaged curve (solid line) for (a) a(\u00b7), (b) b1(\u00b7), (c) b2(\u00b7), and (d) b3(\u00b7), (e) b4(\u00b7), and (f)\nb5(\u00b7). No spatial smoothing applied in estimation.\n19\nooooooooooooo\noooooo\nooo\nooo\noo\noo\nooo\nooo\noo\noooooooooooooooooooooooooooooooooooooo\nz\na\n0\n-100 -50 0 50 100\n-\n20\n0\n-\n15\n0\n-\n10\n0\n-\n50\n0\n50\n10\n0\n(a)\noooooooooooooooooooooooooooooooo\noo\nooo\nooo\nooo\nooo\nooo\nooo\nooo\noooo\noooooooooooooo\nz\nb1\n-100 -50 0 50 100\n-\n6\n-\n4\n-\n2\n0\n2\n4\n(b)\nooooooooooooooooooooooooooooo\noo\nooo\nooo\noo\noo\nooo\nooo\noooooo\noooooooooo\nz\nb2\n-100 -50 0 50 100\n-\n6\n-\n4\n-\n2\n0\n2\n4\n(c)\nooooooo\nooooooo\noooo\nooooo\nooooooooooooooooooooooooooooooooooo\nz\nb3\n-100 -50 0 50 100\n-\n5\n0\n5\n(d)\nooooo\noooooooooo\noooo\noooo\nooo\noooooooooooooooooooooooooooooooooooooo\nz\nb4\n-100 -50 0 50 100\n-\n5\n0\n5\n(e)\noooooooooooooooooooooooooooo\noo\nooo\nooo\nooo\nooo\noo\nooo\noooo\noooooooooooooo\nz\nb5\n-100 -50 0 50 100\n-\n6\n-\n4\n-\n2\n0\n2\n4\n(f)\nFigure 6: Modelling of MSLP data \u2013 The spatial-smoothed estimated curves (dotted lines) of 45\nlocations together with the averaged curve (solid line) for (a) a(\u00b7), (b) b1(\u00b7), (c) b2(\u00b7), and (d)\nb3(\u00b7), (e) b4(\u00b7), and (f) b5(\u00b7).\n20\n(a) (b)\n0 20 40 60 80 100\n-\n40\n00\n-\n20\n00\n0\n20\n00\n40\n00\n60\n00\ndate\na\nbs\nol\nut\ne \nfo\nre\nca\nst\nin\ng \ner\nro\nr,a\nve\nra\nge\nd \nov\ner\n s\npa\nce\n105 110 115 120\n50\n0\n10\n00\n15\n00\n20\n00 ADAPTIVE forecast\nLINEAR forecast\nMEAN forecast\nLAST-DAY forecast\nFigure 7: MSLP data \u2013 (a) Time series plots of the 45 estimated index series (dotted lines) and the global spatial\nindex series (i.e. the first principle component series, solid line, scaled down by 3). (b) Absolute one-step ahead\nforecasting errors, averaged over 45 locations, over the period of 11 \u2013 30 March 2002.\n5.3 Forecasting comparisons\nTo further assess the capability of model (5.2), we compared its post-sample forecasting perfor-\nmance with those of other models including linear one. We used the adaptive varying-coefficient\nmodel (AVCM) fitted from the above for one-step ahead prediction for the 20 MSLP values in\nthe period of 11 \u2013 30 March 2002 over the 45 locations. Also included in the comparison are\nthe LINEAR model which may be viewed as a special case of AVCM with constant coefficient\n21\nTable 1: Mean absolute predictive errors (MAPE) of the four different models\nModel AVCM LINEAR MEAN LAST-DAY\nMAPE 494.1 553.0 1052.8 599.9\nTable 2: Mean absolute predictive errors (MAPE) of AVCM with different bandwidths\n(a) h\u00afc = h\u00af0c, h\u02dc = h\u02dc0:\nh h0 \u2212 4 h0 \u2212 1 h0 + 1 h0 + 4\nMAPE 499.9 496.8 498.9 508.7\n(b) h = h0, h\u02dc = h\u02dc0:\nh\u00afc h\u00af0c \u2212 0.4 h\u00af0c \u2212 0.1 h\u00af0c + 0.1 h\u00af0c + 0.4\nMAPE 523.3 494.1 496.2 495.0\n(c) h = h0, h\u00afc = h\u00af0c:\nh\u02dc h\u02dc0 \u2212 0.4 h\u02dc0 \u2212 0.1 h\u02dc0 + 0.1 h\u02dc0 + 0.4\nMAPE 505.2 495.3 493.9 493.3\nfunctions, the MEAN forecast which forecasts the future based on the mean of the past values\nfrom 1 December 2001 onwards, and the LAST-DAY forecast which forecasts tomorrow\u2019s value by\ntoday\u2019s value. The absolute forecasting errors, averaged over the 45 space locations, are plotted in\nFigure 7(b). The mean absolute predictive errors (MAPE), over the 45 space locations and the 20\ndays of 11 \u2013 30 March 2002, are listed in Table 1. Overall our adaptive varying-coefficient model\noutperforms the other three simple models. This lends further support to the assertion that the\ndynamic structure of the MSLP is nonlinear and it cannot be accommodated, for example, in a\nlinear dynamic model.\nIn the above comparison, the bandwidths used in fitting AVCM were selected using the meth-\nods specified in Section 2.3. Over the 45 locations, the selected values for h, h\u00afc in h\u00af = CT h\u00afc and\nh\u02dc are around, respectively, 15, 0.6 and 0.7. To examine the sensitivity of the AVCM forecasting\non the bandwidths, we repeat the above exercises with the bandwidths shifted from the selected\nvalues. We denote by h0, h\u00af0c and h\u02dc0 the selected values of h, h\u00afc and h\u02dc using the methods specified\nin Section 2.3. Table 2 lists the MAPE of the AVCM with different bandwidths. Comparing with\nTable 1, the MAPE of the AVCM varies with the bandwidths used in the estimation, but the\n22\nvariation is not excessive. Further the AVCM always offers better prediction than the three other\nmodels.\n6 Appendix: Regularity conditions\nWe list below the regularity conditions, among which C4(i,ii), C5-C7 and C9-C10 are basically\ninherited from Lu, Tj\u00f8stheim and Yao (2007) in the time series context.\nC1. For each s, {\u03b5t(s), t \u2265 1} is a sequence of independent and identically distributed random\nvariables. The distribution of \u03b5t(s) is the same for all s \u2208 S. Further, for each t >\n1, {\u03b5t(s), s \u2208 S} is independent of {(Yt\u2212j(s),Xt+1\u2212j(s)), s \u2208 S and j \u2265 1}. The spatial\ncovariance function\n\u03b3(s1, s2) \u2261 Cov{\u03b5t(s1), \u03b5t(s2)} (6.1)\nis bounded over S2.\nC2. For any t \u2265 1 and s \u2208 S,\n\u03b5t(s) = \u03b51,t(s) + \u03b52,t(s) (6.2)\nwhere {\u03b51,t(s), t \u2265 1, s \u2208 S} and {\u03b52,t(s), t \u2265 1, s \u2208 S} are two independent pro-\ncesses, and both fulfill the conditions imposed on \u03b5t(s) in C1 above. Further, \u03b31(s1, s2) \u2261\nCov{\u03b51,t(s1), \u03b51,t(s2)} is continuous in (s1, s2) (we will denote \u03c3\n2\n1(s1) = \u03b31(s1, s1)), and\n\u03b32(s1, s2) \u2261 Cov{\u03b52,t(s1), \u03b52,t(s2)} = 0 if s1 6= s2, and \u03c3\n2\n2(s) = \u03b32(s, s) > 0 is continuous.\nC3. (i)A(s, s\u2032; z1, z2) \u2261 E{Xt(s)Xt(s\n\u2032)\u03c4 |Zt(s) = z1, Zt(s\n\u2032) = z2} = A1(s, s\n\u2032; z1, z2)+A2(s, s\n\u2032; z1, z2),\nwhere A1(s, s\n\u2032; z1, z2) is continuous, and A2(s, s; z1, z2) is a positive definite matrix. Further,\nA2(s, s\n\u2032; z1, z2) = 0 if s 6= s\n\u2032, and A0(s, z) \u2261 A2(s, s; z, z) is continuous.\n(ii) Set Vt(s) = Wt(s)\u2212Bt(s)Xt(s), whereBt(s) = E{Wt(s)Xt(s)\n\u03c4 |Zt(s)}[E{Xt(s)Xt(s)\n\u03c4 |Zt(s)}]\n\u22121\nand Wt(s) = Xt(s)g\u02d9z({s, Zt(s)}\n\u03c4\nXt(s). ThenV(s1, s2) \u2261 E[Vt(s1)Vt(s2)\n\u03c4w{Zt(s1)}w{Zt(s2)}] =\nV1(s1, s2)+V2(s1, s2), where V1(s1, s2) is continuous, V2(s1, s2) = 0 if s1 6= s2, and V2(s, s)\nis positive-definite and continuous.\nC4. (i) g(s, z,\u03b2) is twice continuously differentiable with respect to s, and \u03b1(s) is twice contin-\nuously differentiable. Also in the expression\nR(a(\u00b7),b(\u00b7),\u03b2) = E\n{(\nYt \u2212 a(\u03b2\n\u03c4Xt)\u2212 b(\u03b2\n\u03c4Xt)\n\u03c4 X\u02d8t\n)2\nw(\u03b2\u03c4Xt)\n}\n,\n23\ndifferentiation with respect to \u03b2 and the expectation are exchangeable.\n(ii) The density function f\u03b2\u03c4Xt(s)(s, z) of \u03b2\n\u03c4Xt(s) is continuous. For any fixed s \u2208 S, it\nis uniformly bounded away from 0 for z \u2208 [\u2212L,L] and \u03b2 \u2208 B, where L > 0 is a constant.\nFurthermore, the joint probability density function of (\u03b2\u03c4Xt0(s), \u03b2\n\u03c4Xt1(s), \u00b7 \u00b7 \u00b7 , \u03b2\n\u03c4Xtk(s))\nexists and is bounded uniformly for any t0 < t1 < \u00b7 \u00b7 \u00b7 < tk and 0 \u2264 k \u2264 2(r\u2212 1) and \u03b2 \u2208 B,\nwhere r > 3d is a positive integer.\n(iii) Denote by fZ,Z(s1, s2; z1, z2) the joint density function of Zt(s1) and Zt(s2). Then\nfZ,Z(s1, s2; z, z) is continuous in z, and it converges to f\n\u2217(s, z) as ||si \u2212 s|| \u2192 0 for i = 1, 2.\nC5. E|Yt(s)|\n\u033ar <\u221e and E\u2016Xt(s)\u2016\n\u033ar <\u221e. Furthermore, it holds for some \u033a > 6 and r given in\nC4 that sup\u03b2\u2208B E|Yt(s)\u2212 g(s,\u03b2\n\u03c4Xt(s), \u03b2)\n\u03c4\nXt|\n\u033ar <\u221e.\nC6. Matrix E (Xt X\n\u03c4\nt |\u03b2\n\u03c4Xt = z) is positively definite for z \u2208 [\u2212L,L] and \u03b2 \u2208 B.\nC7. For each fixed s \u2208 S, the time series {(Yt(s),Xt(s)), t \u2265 1} is strictly stationary and \u03b2-\nmixing with the mixing coefficients satisfying the condition \u03b2(t) = O(t\u2212b) for some b >\nmax{2(\u033ar + 1)\/(\u033ar \u2212 2), (r + a)\/(1 \u2212 2\/\u033a)}, where r and \u033a are specified in (C4) and (C5),\nand a \u2265 (r\u033a\u2212 2)r\/(2 + r\u033a\u2212 4r).\nC8. There exists a continuous sampling intensity function (i.e. density function) f defined on S\nfor which N\u22121\n\u2211N\ni=1 I(si \u2208 A)\u2192\n\u222b\nA f(s)ds for any measurable set A \u2282 S.\nC9. W (\u00b7) is a symmetric density function on R2 with bounded support. K(\u00b7) is a bounded and\nsymmetric density function on R1 with bounded support SK . Furthermore, |K(x)\u2212K(y)| \u2264\nC|x\u2212 y| for x, y \u2208 SK and some 0 < C <\u221e.\nC10. As N \u2192 \u221e, h\u02dc \u2192 0 and Nh\u02dc2 \u2192 \u221e. As T \u2192 \u221e, Th4 = O(1), Th3+3d\/r \u2192 \u221e, and\nlim infT\u2192\u221e Th\n2(r\u22121)a+(\u033ar\u22122)\n(a+1)\u033a > 0 for r given in C4, \u033a given in C5 and a, b given in C7. Fur-\nthermore, there exists a sequence of positive integers mT \u2192\u221e such that mT = o((Th)\n1\/2),\nTm\u2212bT \u2192 0 and mTh\n2(\u033ar\u22122)\n2+b(\u033ar\u22122) > 1.\nConditions C1 and C2 were introduced in Zhang et al. (2003). C2 manifests the so-called\nnugget effect in the noise process when \u03c322(s1) > 0. The concept of nugget effect was introduced\nby G. Matheron in early 1960\u2019s. It implies that the variogram E{\u03b5t(s1) \u2212 \u03b5t(s2)}\n2 does not\nconverge to 0 as \u2016s1\u2212 s2\u2016 \u2192 0, or equivalently, the function \u03b3\u02dc(s) \u2261 \u03b3(s1+ s, s1) is not continuous\nat s = 0 for any given s1 \u2208 S. Note that \u03b51,t(s) in (6.2) represents so-called system noise which\n24\ntypically has continuous sample realisation (in s), while \u03b52,t(s) stands for microscale variation\nand\/or measurement noise; see Cressie (1993, section 2.3.1). Condition C3 represents the possible\nnugget effect in the regressor process Xt(s). Note that when Xt(s) contains some lagged values\nof Yt(s), C3 may be implied by C2.\nThe function f\u2217(s, \u00b7) in C4(iii) may not be the density function of Zt(s) due to the nugget\neffect; see the discussion below (3.1) in Lu et al. (2008). Other smooth conditions in C4 and the\nmoment conditions in C5 are standard, though some of them may be reduced further at the cost\nof an increase of the already lengthy technical arguments. C6 is not essential and is introduced\nfor technical convenience.\nC7 imposes the \u03b2-mixing condition on the time series. The complex restriction on the mixing\ncoefficients is required to ensure that the time series estimators \u03b1\u0302(s), a\u0302(s) and b\u0302(s) converge\nuniformly in s. Further discussion on mixing time series may be found in, for example, Section 2.6\nof Fan and Yao (2003).\nC8 specifies that the asymptotic approximations in the spatial domain are derived from the\nfixed-domain or infill asymptotics (Cressie, 1993, Section 3.3).\nThe conditions on W and K in C9 and h\u02dc in C10 are standard for nonparametric regression.\nMore sophisticated conditions on the bandwidth h in C10 are required to ensure the uniform\nconvergence of the time series estimators.\nAcknowledgment. The authors thank Joint Editor, Professor George Casella, an Associate\nEditor and two referees for very helpful comments and suggestions.\nReferences\nAnselin, L. (1988). Spatial Econometrics: Methods and Models. Kluwer Academic: Dordrecht,\nNetherlands.\nBiau, G. and Cadre, B. (2004). Nonparametric spatial prediction. Stat. Inference Stoch. Process.\n7, 327-349.\nBrunsdon, C., McClatchey, J. and Unwin, D.J. (2001). Spatial variations in the average rainfall-\naltitude relationship in Great Britain: an approach using geographically weighted regression.\nInternational Journal of Climatology, 21, 455-466.\nChile`s, J.-P. and Delfiner, P. (1999). Geostatistics: Modeling Spatial Uncertainty. Wiley, New\nYork.\nCressie, N.A.C. (1993). Statistics For Spatial Data. Wiley, New York.\n25\nDiggle, P.J. (2003). Statistical analysis of spatial point patterns. Arnold, London.\nFan, J. and Yao, Q. (2003). Nonlinear Time Series: Nonparametric and Parametric Methods.\nSpringer, New York.\nFan, J., Yao, Q. and Cai, Z. (2003). Adaptive varying-coefficient linear models. Journal of the\nRoyal Statistical Society, B, 65, 57-80.\nFotheringham, A.S., Charlton, M.E. and Brunsdon, C. (1998). Geographically weighted regres-\nsion: a natural evolution of the expansion method for spatial data analysis. Environment\nand planning A, 30, 1905-1927.\nFuentes M. (2001). A high frequency kriging approach for non-stationary environmental pro-\ncesses. Environmetrics 12: 469-483.\nGao, J., Lu, Z. and Tj\u00f8stheim, D. (2006). Estimation in semiparametric spatial regression.\nAnnals of Statistics, 34, 1395-1435.\nGuyon, X. (1995). Random Fields on a Network: Modelling, Statistics, and Application.\nSpringer-Verlag, New York.\nHall, P. and Johnstone, I. (1992). Empirical functionals and efficient smoothing parameter\nselection (with discussions). Journal of the Royal Statistical Society, B, 54, 475\u2013530.\nHallin, M., Lu, Z. and Tran, L. T. (2004a). Density estimation for spatial processes: the L1\ntheory. Journal of Multivariate Analysis, 88, 61-75.\nHallin, M., Lu, Z. and Tran, L. T. (2004b). Local Linear Spatial Regression. Annals of Statistics,\n32, 2469\u20132500.\nHa\u00a8rdle, W. and Vieu, P. (1992) Kernel regression smoothing of time series. Journal of Time\nSeries Analysis, 13, 209\u2013224.\nJones, M. C. (1991). The roles of ISE and MISE in density estimation. Statistics and Probability\nLetters, 12, 51\u201356.\nKalnay E., M. Kanamitsu, R. Kitsler, W. Collins, D. Deaven, L. Candin, M. Iredell, S. Saha,\nG. White, J. Wollen, Y. Zhu, M. Chelliah, W. Ebisuzaki, W. Higgins, J. Janowiak, K. Mo,\nC. Ropelewski, J. Wang, A. Leetmaa, R. Reynolds, R. Jenne, and D. Joseph, 1996: The\nNCEP\/NCAR 40-year Reanalysis Project. Bulletin of the American Meteorological Society.\n77 (3), 437\u2013471.\nKim, T. Y. and Cox, D. D. (1995). Asymptotic behaviors of some measures of accuracy in non-\nparametric curve estimation with dependent observations. Journal of multivariate analysis,\n53, 67\u201393.\nKnorr-Held, L. (2000). Bayesian modelling of inseparable space time variation in disease risk.\nStatistics in Medicine, 19, 2555-567.\nLagazio, C., Dreassi, E. and Biggeri, A. (2001). A hierarchical Bayesian model for space time\nvariation of disease risk. Statistical Modelling 1, 17-19.\nLoader, C. R. (1999). Bandwidth selection: classical or plug-in? Ann. Statist., 27, 415\u2013438.\n26\nLu Z., Lundervold, A., Tj\u00f8stheim, D. and Yao, Q. (2007). Exploring spatial nonlinearity using\nadditive approximation. Bernoulli 13, 447-472.\nLu, Z., Tj\u00f8stheim, D. and Yao, Q. (2007). Adaptive Varying-Coefficient Linear Models for\nStochastic Processes: Asymptotic Theory. Statistica Sinica, 17, 177-197 . [Additional\nproofs for \u201cAdaptive varying-coefficient linear models for stochastic processes: asymptotic\ntheory\u201d. Available at the website of Statistica Sinica.]\nLu, Z., Tj\u00f8stheim, D. and Yao, Q. (2008). Spatial smoothing, Nugget effect and infill asymp-\ntotics. Statistics and Probability Letters, 78, 3145\u20133151.\nMammem, E. (1990). A short note on optimal bandwidth selection for kernel estimators. Statis-\ntics and Probability Letters, 9, 23\u201325.\nMatheron, G. (1976). A simple substitute for conditional expectation: the disjunctive kriging.\nProceedings, NATO ASI: Advanced Geostatistics in the Mining Industry (Rome, Oct. 1975),\n221-236.\nPress, W.H., Teukolsky, S.A., Vetterling, W.T. and Flannery, B.P. (1992). Numerical Recipes in\nC++: The art of scientific computing. Cambridge University Press: Cambridge.\nQuintela-del-R\u00b4\u0131o, A. (1996). Comparison of bandwidth selectors in nonparametric regression\nunder dependence, Comput. Statist. Data Anal. 21, 563\u2013580.\nRipley, B.D. (1981). Spatial Statistics. John Wiley & Sons: New York.\nRivoirard, J. (1994). Introduction to Disjunctive Kriging and Non-linear Geostatistics. Claren-\ndon Press, Oxford.\nRuppert, D., Sheather, S. J. and Wand, M. P. (1995). An effective bandwidth selector for local\nleast squares regression. Journal of the American Statistical Association, 90, 1257\u20131270.\nRupert, D. (1997). Empirical-bias bandwidths for local polynomial regression and density esti-\nmation. Journal of the American Statistical Association, 92, 1049-1062.\nStein, M.L. (1999). Interpolation of Spatial Data. Springer, New York.\nStone, M. (1974). Cross-validatory choice and assessment of statistical predictions (with discus-\nsion). Journal of the Royal Statistical Society, B, 36. 111-147.\nXia, Y. and Li, W. K. (1999). On single-index coefficient regression models. Journal of the\nAmerican Statistical Association, 94, 1275-1285.\nXia, Y. and Li, W. K. (2002). Asymptotic Behavior of Bandwidth Selected by the Cross-\nValidation Method for Local Polynomial Fitting. Journal of multivariate analysis, 83, 265-\n287.\nYao, Q. and Brockwell, P.J. (2006). Gaussian maximum likelihood estimation for ARMA models\nII: spatial processes. Bernoulli, 12, 403-429.\nZhang, W., Yao, Q., Tong, H. and Stenseth, N.C. (2003). Smoothing for spatial-temporal models\nand its application in modelling muskrat-mink interaction. Biometrics, 59, 813-821.\n27\n"}