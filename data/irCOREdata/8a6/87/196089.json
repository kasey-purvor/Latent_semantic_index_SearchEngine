{"doi":"10.1080\/00207170802512816","coreId":"196089","oai":"oai:lra.le.ac.uk:2381\/8252","identifiers":["oai:lra.le.ac.uk:2381\/8252","10.1080\/00207170802512816"],"title":"Anti-windup compensation for systems with sensor saturation: a study of architecture and structure","authors":["Turner, Matthew C.","Tarbouriech, Sophie"],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2009-07","abstract":"This article proposes a linear dynamic anti-windup strategy for the alleviation of performance and stability problems in systems which are linear apart from saturating sensors. Unlike anti-windup compensation for systems subject to actuator saturation, there is no agreed architecture for applying anti-windup to systems with sensor saturation and therefore attention is devoted to the discussion of various candidate configurations which can be interpreted as a particular choice of a static non-linear map. The main results of the article give existence conditions for compensators which yield global exponential stability and finite L2 gain of the overall non-linear closed-loop system. The existence conditions are different to those which have appeared hitherto in the literature","downloadUrl":"http:\/\/www.informaworld.com\/smpp\/content~db=all?content=10.1080\/00207170802512816.","fullTextIdentifier":"https:\/\/lra.le.ac.uk\/bitstream\/2381\/8252\/3\/sensor_IJCrev.pdf","pdfHashValue":"3aa43cc356c97bc0c0b39f900ffcfe598bf9a6bc","publisher":"Taylor & Francis","rawRecordXml":"<record><header><identifier>\n        \n            \n                oai:lra.le.ac.uk:2381\/8252<\/identifier><datestamp>\n                2016-01-08T09:40:25Z<\/datestamp><setSpec>\n                com_2381_171<\/setSpec><setSpec>\n                com_2381_9549<\/setSpec><setSpec>\n                col_2381_835<\/setSpec>\n            <\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:doc=\"http:\/\/www.lyncode.com\/xoai\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n            \nAnti-windup compensation for systems with sensor saturation: a study of architecture and structure<\/dc:title><dc:creator>\nTurner, Matthew C.<\/dc:creator><dc:creator>\nTarbouriech, Sophie<\/dc:creator><dc:description>\nThis article proposes a linear dynamic anti-windup strategy for the alleviation of performance and stability problems in systems which are linear apart from saturating sensors. Unlike anti-windup compensation for systems subject to actuator saturation, there is no agreed architecture for applying anti-windup to systems with sensor saturation and therefore attention is devoted to the discussion of various candidate configurations which can be interpreted as a particular choice of a static non-linear map. The main results of the article give existence conditions for compensators which yield global exponential stability and finite L2 gain of the overall non-linear closed-loop system. The existence conditions are different to those which have appeared hitherto in the literature.<\/dc:description><dc:date>\n2010-07-19T15:54:07Z<\/dc:date><dc:date>\n2010-07-19T15:54:07Z<\/dc:date><dc:date>\n2009-07<\/dc:date><dc:type>\nArticle<\/dc:type><dc:identifier>\nInternational Journal of Control, 2009, 82 (7), pp. 1253-1266.<\/dc:identifier><dc:identifier>\n0020-7179<\/dc:identifier><dc:identifier>\nhttp:\/\/www.tandfonline.com\/doi\/abs\/10.1080\/00207170802512816<\/dc:identifier><dc:identifier>\nhttp:\/\/hdl.handle.net\/2381\/8252<\/dc:identifier><dc:identifier>\n10.1080\/00207170802512816<\/dc:identifier><dc:language>\nen<\/dc:language><dc:rights>\nThis is the author's final draft of the paper published as International Journal of Control, 2009, 82 (7), pp. 1253-1266.  The final version is available from http:\/\/www.informaworld.com\/smpp\/content~db=all?content=10.1080\/00207170802512816.  Doi: 10.1080\/00207170802512816<\/dc:rights><dc:publisher>\nTaylor & Francis<\/dc:publisher>\n<\/oai_dc:dc>\n<\/metadata>\n        <\/record>","journals":[{"title":null,"identifiers":["0020-7179","issn:0020-7179"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2009,"topics":[],"subject":["Article"],"fullText":"Anti-windup compensation for systems with sensor saturation:\na study of architecture and structure\nMatthew C. Turner \u2217\u0087, Sophie Tarbouriech \u0086\nmct6@le.ac.uk tarbour@laas.fr\nSeptember 9, 2008\nAbstract\nThis paper proposes a linear dynamic anti-windup strategy for the alleviation of performance and stability\nproblems in systems which are linear apart from saturating sensors. Unlike anti-windup compensation for\nsystems subject to actuator saturation, there is no agreed architecture for applying anti-windup to systems\nwith sensor saturation and therefore attention is devoted to the discussion of various candidate configurations\nwhich can be interpreted as a particular choice of a static nonlinear map. The main results of the paper\ngive existence conditions for compensators which yield global exponential stability and finite L2 gain of the\noverall nonlinear closed-loop system. The existence conditions are different to those which have appeared\nhitherto in the literature.\nKeywords: Anti-windup, L2 gain, sensor saturation.\n1 Introduction\nThe stability and performance problems associated with actuator saturation are well known to control engineers\nand have been responsible for a broad, sustained study in this area by the research community. Over the last\ntwenty years, numerous results have been obtained, stemming from the fundamental theory established by [4,\n21, 15, 6, 17] and other authors, to the recent anti-windup based design techniques of [16, 28, 3, 20, 25, 8, 7, 9,\n30, 29]. Although much research remains to be completed, the engineer now at least has tools to enable him\/her\nto cope - to some extent - with actuator saturation. The references [27] and [23] contain good selections of\nstate-of-the-art research articles.\nThe study of systems in which saturation of the sensor is the chief concern is less developed, with only a few\npapers devoted to this topic [22, 14, 11, 13, 2, 10]. This frugal treatment in the literature is perhaps due to the less\nfrequent occurrence of sensor saturation, although, as it too introduces a nonlinearity into largely linear control\nloops, it is easy to see that it poses similar performance and stability issues. Sensor saturation is normally found\nin applications where cost prohibits the use of sensors with adequate range, leading to sensor saturation for large\nreference\/disturbance inputs. Alternatively sensor saturation can model the situation where only the sign of the\noutput is known. In this case, the sign function can be modelled by a saturation function with a steep gradient.\nThere are few prior results on systematic treatment of sensor saturation. Early work was pioneered by [11]\nwhere the observability properties of such systems were studied and [13] where a specific controller design\nstrategy was presented. More recent work ([14]) suggests a low-gain control strategy. One interesting feature\nin [14] was that the existence of a (one-step) controller ensuring global stability of the (nonlinear) closed-loop\n\u2217Department of Engineering, University of Leicester, Leicester, LE1 7RH, UK\n\u2021Work supported by CNRS\n\u2020LAAS-CNRS, University of Toulouse, 7 Avenue du Colonel Roche, 31077 Toulouse cedex 4, France\nsystem was ensured if the open-loop linear plant contained no invariant zeros in the open right half complex\nplane. This contrasts to the actuator saturation literature where a necessary and sufficient condition for the\nglobal stabilisation of systems with actuator saturation is that the open-loop plant must contain no poles in the\nopen-right-half complex plane. However, it transpires that the condition on the invariant zeros given in [14],\nwhile sufficient for the control strategy advocated there, is not necessary in general. A further result appears\nin [2] where the Circle Criterion is used to design H\u221e controllers for linear systems with sensor nonlinearities.\nFinally, some work on sensor saturation also appeared in [10], where a dynamic saturated linear control law was\nproposed.\nA naive appraisal of the sensor saturation problem suggests that it is similar to the actuator saturation problem\nwith the plant and the controller interchanged. In fact this is not the case ([14, 22, 19]); one of the crucial\ndifferences between the two problems is the availability of the \u201cun-saturated\u201d signal. In the actuator saturation\ncase, knowledge of both the output produced by the linear controller and the saturated version of this (i.e. the\nsignals either side of the saturation block) is assumed. In the case of sensor saturation, it is not realistic to assume\nthat the actual plant output is known; only the saturated version of this is known (otherwise there would be no\nproblem!). This is problematic for the two-stage (anti-windup) approach taken here, and hence an observer is\nused to overcome this difficulty.\nIf the study of systems subject to sensor saturation is under-developed, the study of anti-windup compensation for\nthis class of systems is less developed still. To the best of the authors\u2019 knowledge, the only literature discussing\nthis approach are the papers [19, 22, 26]. The first of these papers considers so-called \u201cstate constrained\u201d systems\nwhich can be interepreted as sensor-saturated systems when the plant direct feedthrough term is absent. [19]\nseems to be the first paper which proposes a systematic anti-windup design for the sensor saturation problem\nand the results given in that paper hint at some of the results given here. However, the work of [19] does\nnot discuss the relative merits of different sensor saturation anti-windup architectures and only gives a single\n(albeit explicit) construction of an anti-windup compensator. Furthermore, the authors of this paper consider\nso-called total stability and, in essence, only prove that the closed-loop system trajectories are bounded, rather\nthan exponentially stable. We shall discuss aspects of [19] as the paper progresses.\nThe latter two papers, [22] and [26] are the basis for the work presented here. These papers establish conditions\nfor both local stability, and global stability and L2 gain, respectively, but use architectures which, as we shall\nshow later, are probably not the best for the sensor saturation problem as they introduce another unnecessary\nnonlinearity into the system. Furthermore, in [26] a small oversight led to some slightly weaker results being\nreported.\nThe paper is organised as follows. The next section is devoted to the study of potential architectures for sys-\ntems subject to sensor saturation. The subsequent section establishes necessary and sufficient conditions for the\nexistence of a particular type of \u201canti-windup\u201d compensator which yields global quadratic stability and finite\nL2 gain. Following this, a discussion of these conditions is given. Section 5 applies the synthesis conditions\nestablished in this paper to a simple example and finally conclusions are offered in Section 6.\nNotation used in the paper is standard. The induced L2 norm, or finite L2 gain, of an operator H is denoted\n\u2016H \u2016i,2 := sup06=x\u2208L2\n\u2016H x\u20162\n\u2016x\u20162\nwhere \u2016x\u20162 =\n\u221a\u222b\n\u221e\n0 \u2016x\u20162dt is the L2 norm of the vector x(t) and \u2016x\u2016 is its Euclidean\nnorm. The H\u221e norm for a linear operator P is defined as \u2016P\u2016\u221e := sup\u03c9 \u03c3\u00af [P( j\u03c9)] where \u03c3\u00af(.) denotes the\nmaximum singular value and P( j\u03c9) is the frequency response matrix associated with the linear operator P.\nEquivalently, the H\u221e norm may be defined as \u2016P\u2016\u221e = \u2016P\u2016i,2. We denote the space of all positive definite\nsymmetric l\u00d7 l matrices as Rl\u00d7l+ and the subspace of these which are diagonal as D\nl\u00d7l\n+ . As normal, I and 0\nrepresent the identity and null matrices of appropriate dimensions, respectively. The orthogonal complement of\na matrix G \u2208 Rn\u00d7m with n > m and rank(G) = m is denoted G\u22a5 \u2208 R(n\u2212m)\u00d7m where the columns of G\u22a5 span the\nnull-space of G\u2032.\ndym\nr u yG(s)K(s)\nFigure 1: System with sensor saturation\n2 Anti-windup compensation for systems with sensor saturation\n2.1 System description\nConsider Figure 1 where a system with sensor saturation is depicted. The plant G(s) and the controller K(s) are\ndescribed by the following state-space equations\nG(s) \u223c\n{\nx\u02d9p = Apxp +Bpu+Bpdd\ny = Cpxp\n(1)\nK(s) \u223c\n{\nx\u02d9c = Acxc +Bcym +Bcrr\nu = Ccxc +Dcym +Dcrr\n(2)\nwhere xp \u2208 Rnp is the plant state, xc \u2208 Rnc is the controller state, d \u2208 Rnd is the disturbance, r \u2208 Rnr is the\nreference, u \u2208 Rm is the manipulated plant input, y \u2208 Rq is the output of the plant (used for feedback purposes)\nand sat(y) =: ym \u2208 Rq is the output of the sensor.\nTo simplify the presentation, the plant is assumed strictly proper. The saturation and deadzone functions are\ndefined as normal as\nsat(y) = y\u2212Dz(y) (3)\nsat(y) =\n\uf8ee\n\uf8ef\uf8f0 sat1(y1)...\nsatq(yq)\n\uf8f9\n\uf8fa\uf8fb , Dz(y) =\n\uf8ee\n\uf8ef\uf8f0 Dz1(y1)...\nDzq(yq)\n\uf8f9\n\uf8fa\uf8fb (4)\nwhere sati(yi) = sign(yi)min(|yi|, y\u00afi) \u2200i and Dzi(yi) = sign(yi)max(0, |yi| \u2212 y\u00afi) \u2200i. The positive scalars y\u00afi >\n0 \u2200i \u2208 {1, . . . ,q}, represent the saturation levels. It is convenient to introduce the set\nY := [\u2212y\u00af1, y\u00af1]\u00d7 . . .\u00d7 [\u2212y\u00afq, y\u00afq] (5)\nIf the vector y(t) resides within this set, we can expect linear behaviour, that is\nsat(y) = y \u2200y \u2208 Y , Dz(y) = 0 \u2200y \u2208 Y , (6)\nAssume first that sat(y) \u2261 y (that is Y = Rq). Then, defining the interconnection of G(s) and K(s) through\nequations (1) and (7) as [G,K]nom (a state-space realisation of this is given in the appendix), i.e. the nominal\nlinear closed-loop, we make the assumption\nAssumption 1 [G,K]nom is asymptotically stable and well-posed.\nAs with the anti-windup literature on actuator saturation, we assume that K(s) has been designed to ensure good\nbehaviour in the absence of sensor saturation, and K(s) may have been designed in ignorance of this saturation.\ndu\nG(s)\nr\nK(s)\nym\n+\n+\nv v1 2\ny\n^\nG(s)\ny^\nu^\nyAW\n\u0393(.)\n(s)\u039b\nFigure 2: System with sensor saturation and \u201canti-windup\u201d compensation\nWhen sat(y) 6= y (when Y \u2282 Rq), the interconnection depicted in the Figure 1 may exhibit undesirable perfor-\nmance and stability properties due to the nonlinearity present in the loop. To overcome the problem of sensor\nsaturation, we would like to use an \u201canti-windup\u201d like strategy where the system behaves nominally provid-\ning sensor saturation is not encountered, but, when sensor saturation is encountered, an additional compensator\nbecomes active to limit performance degradation and to retain stability. Unlike actuator saturation where it is\nstraightforward to implement this type of anti-windup strategy, the sensor saturation case is more problematic\nbecause we only know the saturated version of the output ym(t) = sat(y(t)) and do not know the actual \u201cunsat-\nurated\u201d output, y(t). Thus it appears difficult to duplicate the anti-windup strategy used in actuator saturation\nproblems, for systems with sensor saturation problems. In this paper we explore some possible strategies which\nfollow a similar philosophy.\nConsider the system depicted in Figure 2, where again the nominal plant, with saturated sensor, and nominal\ncontroller are shown. The controller now has the state-space realisation\nK(s) \u223c\n{\nx\u02d9c = Acxc +Bcym +Bcrr + v1\nu = Ccxc +Dcym +Dcrr + v2\n(7)\nwhere v1 \u2208Rnc and v2 \u2208Rm are signals produced by the anti-windup compensator; during linear operation these\nsignals are identically zero. The anti-windup compensator, \u039b(s), which becomes active when the signal yAW 6= 0,\nis also shown. When yAW 6= 0, the signals v1 and v2 become non-zero and, if \u039b(s) is designed appropriately,\nshould enable stability and performance to be retained despite sensor saturation. Accompanying the anti-windup\ncompensator is an observer, G\u02c6(s) which is tasked with estimating the unsaturated output y(t) as closely as\npossible. The observer is driven by the nominal control signal, u(t), as normal, and also an \u201coutput injection\u201d\nu\u02c6 \u2208 Rq. Both the anti-windup compensator, \u039b(s) and the observer, G\u02c6(s) are driven by the static nonlinearity\n\u0393 : Rq\u00d7Rq 7\u2192 Rq\u00d7Rq which is defined as\n[\nu\u02c6\nyAW\n]\n= \u0393\n([\nsat(y)\ny\u02c6\n])\n(8)\nThe map \u0393(.) is central to the architecture of the sensor saturation anti-windup problem. Roughly speaking,\nthe role of \u0393(.) is to generate suitable signals u\u02c6 (for driving the observer) and yAW (for driving the anti-windup\ncompensator) from the saturated output ym = sat(y) and the estimated output y\u02c6. It is essential to have some other\nmeans of generating yAW as y itself is not available. The goal of \u0393(.) therefore is to generate a suitable signal yAW\nsuch that yAW is reasonably close to y\u2212 sat(y), so that the AW compensator is only active when saturation of the\nsensors occur (yAW \u2248 y\u2212 sat(y)).\nThe architecture in Figure 2 is a generalisation of that used in [22] and [26]. The presence of the observer is\ncrucial as we do not know the \u201cunsaturated\u201d output, y, and instead have to drive the anti-windup compensator\nwith a signal, yAW generated from an estimate, y\u02c6 and ym = sat(y). However, the signals yAW and u\u02c6 can be\ndu\nG(s)\nG(s)\n^\nr\nK(s)\nym _\n+\n+ _\n+\n+\nv v1 2\ny~\ny\ny^\n\u039b(s)\nFigure 3: System with sensor saturation and \u201canti-windup\u201d compensation\ngenerated in different ways, effectively leading to different architectures for the sensor saturation problem. In\nthe next subsection we discuss various candidates for \u0393 and comment on their suitability.\nSimilar to [12, 8], we assign our anti-windup compensator the state-space realisation\n\u039b(s)\u223c\n\uf8f1\uf8f2\n\uf8f3\nx\u02d9aw = \u039b1xaw +\u039b2yAW[\nv1\nv2\n]\n=\n[\n\u039b31\n\u039b32\n]\nxaw +\n[\n\u039b41\n\u039b42\n]\nyAW\n(9)\nand the observer has state-space equations\nG\u02c6(s)\u223c\n{ \u02d9\u02c6x = Apx\u02c6+Bpu+Lu\u02c6\ny\u02c6 = Cpx\u02c6\n(10)\nWe make the following standard assumption to ensure the existence of an appropriate observer gain, L.\nAssumption 2 The pair (Cp,Ap) is detectable. Equivalently there exists a matrix L such that Ap + LCp is Hur-\nwitz.\nThe goal of this paper is to use an appropriate static nonlinear map \u0393(.) to establish conditions for the existence\nof an anti-windup compensator \u039b(s) to ensure that the nonlinear closed-loop behaves in some desirable way.\nThe performance output is defined as\nz = Cpzxp =: C2,nomxnom (11)\nwhere C2,nom is defined in the appendix and xnom = [x\u2032p x\n\u2032\nc]\n\u2032. The focus of the paper is then to consider the\nfollowing problem.\nProblem 1 Given a nonlinear static operator \u0393(.), find existence conditions for a compensator \u039b(s), defined by\nequation (9) such that\n1. The closed-loop system in Figure 2 (equivalently, that defined by equations (1), (7), (8), (9) and (10)) is\nglobally quadratically (and thus exponentially) stable when w = 0.\n2. The map from w to z is finite L2 gain stable with gain \u03b3 > 0.\n\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\n\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\n\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\n\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\n\u0000\u0001\u0000\u0001\u0000\u0001\u0000\u0001\u0000\n\u0002 \u0002 \u0002 \u0002 \u0002\n\u0002 \u0002 \u0002 \u0002 \u0002\n\u0002 \u0002 \u0002 \u0002 \u0002\n\u0002 \u0002 \u0002 \u0002 \u0002\n\u0002 \u0002 \u0002 \u0002 \u0002\n\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\n\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\n\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\n\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\n\u0003\u0001\u0003\u0001\u0003\u0001\u0003\u0001\u0003\n\u0004 \u0004 \u0004 \u0004 \u0004\n\u0004 \u0004 \u0004 \u0004 \u0004\n\u0004 \u0004 \u0004 \u0004 \u0004\n\u0004 \u0004 \u0004 \u0004 \u0004\n\u0004 \u0004 \u0004 \u0004 \u0004\ny\ny\ny\ny\ny\ny\n^\n_\n_\n__\n\u2212\n\u2212\nLinear region\nFigure 4: Region for which u\u02c6 = 0 - architecture 1\n2.2 Architecture 1: two nonlinearities, non-zero measure\nPerhaps the most intuitive architecture for the sensor saturation problem was proposed in [22] in which the anti-\nwindup compensator is driven by the difference between an estimate of the output and a saturated version of\nthis, and the observer is driven by the difference between the saturated output and the estimated saturated output.\nThis is equivalent to \u0393(.) being defined as\n[\nu\u02c6\nyAW\n]\n= \u0393\n([\nsat(y)\ny\u02c6\n])\n=\n[\nsat(y\u02c6)\u2212 sat(y)\ny\u02c6\u2212 sat(y\u02c6)\n]\n(12)\nThus the observer is driven by the difference between two saturated signals and the anti-windup compensator\nis driven by the \u201cdeadzoned\u201d version of the estimated output, y\u02c6. This architecture was used in [22] in order\nto obtain local results and also in [26] for establishing global existence conditions. The architecture is shown\nexplicitly in Figure 3. While this architecture can be seen as intuitive, there are some philosophical issues with\nits use. In particular it is of interest to discover the conditions under which the output injection vector u\u02c6 = 0. In\nlinear system observers, this would correspond to the case when there is perfect reproduction of the estimated\noutput, i.e. y\u02c6 = y. However for our case, we can see that u\u02c6 = 0 under non-unique conditions, namely when\nsat(y) = sat(y\u02c6), which occurs when\n(i) y\u02c6i \u2265 y\u00afi, yi \u2265 y\u00afi\n(ii) y\u02c6i \u2264\u2212y\u00afi, yi \u2264\u2212y\u00afi\n(iii) y\u02c6i = yi\n\uf8fc\uf8fd\n\uf8fe\u21d2 u\u02c6i = 0 \u2200i \u2208 {1,2, . . . ,q} (13)\nWhen y and y\u02c6 are scalar, such conditions can be seen graphically and the hatched regions in Figure 4 show the\nvalue of [y\u02c6\u2032 y\u2032]\u2032 for which u\u02c6 = 0, but y\u02c6 6= y. Note that unlike the linear case, the set\nYobs,1 =\n{[\ny\ny\u02c6\n]\n\u2208 R2q : u\u02c6 = sat(y\u02c6)\u2212 sat(y) = 0\n}\n(14)\ndoes not have a measure of zero. Effectively this means that the output injection u\u02c6 is zero even though y\u02c6 6= y and\nis relaying \u201cfalse\u201d information to the observer, G\u02c6(s).\nAnother compelling reason for considering other architectures than that shown in Figure 3 is that there are more\nrestrictive technical conditions on the existence of a globally stabilising anti-windup compensator: in [26] it was\nestablished that a necessary\u2217 condition was that the linear open-loop must be asymptotically stable. This is not\npossible when the linear controller contains integral modes, and thus such an architecture would be of less use\nin tracking problems. Indeed this was a major motivating factor in seeking alternative architectures.\n\u2217In that paper, they are also claimed to be suf\u0002cient, but this is, in fact, not the case.\ndu\nG(s)\nG(s)\n^\nr\nK(s)\nym\n+ _\n+\n+\nv v1 2\ny~\ny\ny^\n+\n_\n(s)\u039b\nFigure 5: System with sensor saturation and \u201canti-windup\u201d compensation\n2.3 Architecture 2: two nonlinearities, zero measure\nThe philosophical problem of u\u02c6 = 0 when y\u02c6 6= y can be remedied easily by driving the anti-windup compensator\nwith the same signal as in architecture 1, but by altering slightly the signal which drives the observer. Thus for\nthis architecture, we choose \u0393(.) as\n[\nu\u02c6\nyAW\n]\n= \u0393\n([\nsat(y)\ny\u02c6\n])\n=\n[\ny\u02c6\u2212 sat(y)\ny\u02c6\u2212 sat(y\u02c6)\n]\n(15)\nThe anti-windup architecture is shown explicitly in Figure 5. In this case, we find that u\u02c6 = 0 in the following\ncases\n(i) y\u02c6i = y\u00afi, yi \u2265 y\u00afi\n(ii) y\u02c6i =\u2212y\u00afi, yi \u2264\u2212y\u00afi\n(iii) y\u02c6i = yi\n\uf8fc\uf8fd\n\uf8fe\u21d2 u\u02c6i = 0 \u2200i \u2208 {1,2, . . . ,q} (16)\nThus, we see that output injection term, u\u02c6, is zero only when y = y\u02c6 or in the special case when y\u02c6 is exactly equal\nto its upper (lower) saturation limit and y is operating in its upper (lower) saturation region. Again, assuming y\u02c6\nand y are scalars we can examine the set\nYobs,2 =\n{[\ny\ny\u02c6\n]\n\u2208 R2q : u\u02c6 = y\u02c6\u2212 sat(y) = 0\n}\n(17)\ngraphically and deduce that this set has measure zero - see Figure 6, where the dotted line marks the region\nwhere u\u02c6 = 0 and y\u02c6 6= y.\nRemark 1: Although Architecture 2 seems a better choice from a philosophical perspective, it makes remarkably\nlittle difference to the anti-windup existence conditions whether Architecture 1 or 2 is chosen. Reference [26]\nuses the first architecture to derive conditions which ensure the existence of a compensator achieving global\nstability and finite L2 gain, but if a similar derivation to this is carried out using Architecture 2, the resulting\nexistence conditions are essentially the same. \u0003\n2.4 Architecture 3: one nonlinearity, zero measure\nArchitectures 1 and 2 are probably the most intuitive architectures for the sensor saturation problem as they\nfollow exactly the same rationale as the actuator saturation problem: the anti-windup compensator is driven by\ny\ny\ny\ny\ny\ny\n^\n_\n_\n__\n\u2212\n\u2212\nLinear region\nFigure 6: Region for which u\u02c6 = 0 - architecture 2\nd\nu\nG(s)\nG(s)\n^\nr\nK(s)\nym\n+\n+\nv v1 2\ny\ny^ + _\n\u039b(s)\nFigure 7: System with sensor saturation and \u201canti-windup\u201d compensation\nthe difference between a signal and its saturated version, i.e. a \u201cdeadzoned\u201d version of the signal. As y itself\nis not available, this signal was chosen as y\u02c6 in the previous architectures, making yAW = y\u02c6\u2212 sat(y\u02c6). However,\nnote that these architectures introduce an extra saturation nonlinearity into the problem in order to generate\ny\u02c6. It transpires that this extra nonlinearity makes existence conditions fairly complex (see [26]). Instead of\nintroducing an extra nonlinearity, it appears more prudent to use the following signals to drive the observer and\nthe anti-windup compensator. Thus \u0393(.) is chosen as\n[\nu\u02c6\nyAW\n]\n= \u0393\n([\nsat(y)\ny\u02c6\n])\n=\n[\ny\u02c6\u2212 sat(y)\ny\u02c6\u2212 sat(y)\n]\n(18)\nThus both observer and anti-windup compensator are driven by the difference between the estimated output\nand the saturated version of this. Note that only one nonlinearity, sat(y) appears in the architecture. This has\nthe philosophical advantages of Architecture 2, discussed earlier, but it also prevents the addition of the extra\nsaturation nonlinearity, sat(y\u02c6) which complicates the establishment of the stability and L2 gain conditions. This\narchitecture is shown graphically in Figure 7.\nRemark 2: In the anti-windup literature, it is customary to ensure that the anti-windup compensator is inactive\nunless actuator saturation occurs. This was formalised in [24] as requiring v1 = 0,v2 = 0 for all control signals\nwhich did not violate the saturation bounds, which can be interpreted as those signals not straying outside a\ncertain set. In the sensor saturation case, this is equivalent to requiring\ny(t) \u2208 Y \u2200t \u2265 0\u21d2 v1 = 0,v2 = 0 \u2200t \u2265 0 (19)\nHowever, as our anti-windup compensator is driven by yAW which is generated by the static nonlinear map \u0393(.),\nand we know that yAW 6= y\u2212 sat(y), it may be the case that y(t) \u2208 Y when y\u02c6(t) \/\u2208 Y (and vice versa) due to the\nerror between the actual output and estimated output. Thus, our anti-windup compensator, \u039b(s), could be active\nunnecessarily or inactive when necessary. Assuming our observer is sufficiently fast and accurate, this is not\nthought to be a problem. \u0003\nRemark 3: The anti-windup architecture used in [19] is almost the same as Architecture 3, with one additional\nassumption: G\u02c6(s) has no observer gain (L \u2261 0) making G\u02c6(s) just a copy of G(s). In addition to simplifying\nthe problem, such a choice is attractive because, as will be seen later, it removes one of the matrix inequality\nconstraints. The downside is that the \u201cobserver\u201d output and the actual output could converge slowly. \u0003\n3 Main results\nThe goal of this paper is to derive conditions which ensure existence of a globally exponentially stabilising anti-\nwindup compensator which provides a finite L2 gain bound from exogenous input, w to performance output, z.\nThe existence conditions obtained are generally a function of the architecture of the AW compensator. In [26],\nthe foregoing existence conditions were investigated using Architecture 1. For the reasons given in the previous\nsection, concentration is hereafter focused on Architecture 3, in which only one nonlinearity (the physical sensor\nsaturation) is present.\n3.1 State-space manipulations\nThe main result is easier to state when some basic state-space manipulations have been carried out. As we\nconsider Architecture 3 (Figure 7) we assume that u\u02c6 = yAW = y\u02c6\u2212 sat(y) \u2208 Rq. For convenience we define the\nfollowing vector valued signals:\ny\u02dc = y\u2212 sat(y) \u2208 Rq (20)\n\u03b5 = x\u02c6p\u2212 xp \u2208 Rnp (21)\nUsing these definitions it follows that\ny\u02c6\u2212 sat(y) = y\u02c6\u2212 y+ y\u02dc = Cp\u03b5 + y\u02dc (22)\nwhere y\u02dc = Dz(y). It then follows that a state-space realisation of the system (1), (7), (9) and (10) is\n\u03a3\u223c\n\uf8f1\uf8f2\n\uf8f3\n\u02d9\u02dcx = A\u02dcx\u02dc+ B\u02dc1w+ B\u02dc2y\u02dc\ny = C\u02dc1x\u02dc\nz = C\u02dc2x\u02dc\n(23)\nwhere x\u02dc := [x\u2032p x\n\u2032\nc x\n\u2032\naw \u03b5 \u2032]\u2032 \u2208 R2np+nc+naw represents the concatenated state of the system, w = [r\u2032 d\u2032]\u2032 \u2208 Rnw\nrepresents the exogenous inputs, and expressions for the tilded matrices can be found in the appendix. These\nmatrices can be split to reveal a matrix of anti-windup compensator matrices (as in [5, 8]:\nA\u02dc = Ao + B\u00af\u039bC\u00af B\u02dc2 = Bo + B\u00af\u039bD\u00af (24)\nThis decomposition is crucial to the development of the results and the matrices A0,B0, B\u00af,C\u00af and D\u00af are described\nin the appendix.\n3.2 Preliminary results\nThe main results are established using some well known results (see [1] and [5] for example).\nLemma 1 (Projection Lemma)\nThe inequality \u03a8+G\u03a0H \u2032+H\u03a0\u2032G\u2032 < 0 holds iff\nG\u22a5\u03a8(G\u22a5)\u2032 < 0 and H\u22a5\u03a8(H\u22a5)\u2032 < 0 (25)\nAs we deal with the deadzone nonlinearity, y\u02dc = Dz(y), we make use of the commonly used sector bound. This\nis known to be conservative, but allows tractable results to be obtained and also provides \u201crobustness\u201d to a class\nof sensor nonlinearities. In the remainder of the paper, we provide results assuming only that y\u02dc = \u03c8(y) and\n\u03c8(.) \u2208 Sector[0, I]. The central result we use is ([8]):\nLemma 2 (Quadratic stability and L2 gain) A state-space system\nx\u02d9 = Ax+B\u03c8(Cx), x \u2208 Rn, \u03c8 : Rq 7\u2192 Rq\nis said to be quadratically stable with L2 gain \u03b3 for all \u03c8(.)\u2208 Sector[0, I] if and only if \u2203P\u2208Rn\u00d7n+ and \u2203W \u2208D\nq\u00d7q\n+\nsuch that the following inequality holds\nV\u02d9 (x)+ \u03b3\u22121\u2016z\u20162\u2212 \u03b3\u2016w\u20162 +2\u03c8(u)W \u2032(u\u2212\u03c8(u)) < 0 (26)\nfor V (x) = x\u2032Px > 0.\nFinally, we shall need the following lemma from [18].\nLemma 3 Let X ,Y \u2208 Rn\u00d7n+ . Then the conditions\nY \u2212X\u22121 \u2265 0 (27)\nrank(Y \u2212X\u22121) \u2264 n1 (28)\nhold if and only if there exist matrices Y12,X12 \u2208 Rn\u00d7n1 and Y22,X22 \u2208 R\nn1\u00d7n1\n+ such that[\nX X12\nX \u203212 X22\n]\u22121\n=\n[\nY Y12\nY \u203212 Y22\n]\n> 0 (29)\n3.3 Existence conditions\nThe main result gives a set of matrix inequalities which can be checked for the existence of a globally stabilising\nanti-windup compensator.\nTheorem 1 Assume \u0393(.) is given as in equations (8) and (18), then there exists an naw\u2019th order anti-windup\ncompensator, \u039b(s), which solves Problem 1 with L2 gain \u03b3 for all y\u02dc = \u03c8(y) where \u03c8(.) \u2208 Sector[0, I] if and only\nif there exist matrices\nQnom =\n[\nQ11 Q12\n? Q22\n]\n\u2208 R\n(np+nc)\u00d7(np+nc)\n+ , Rnom \u2208 R\n(np+nc)\u00d7(np+nc)\n+ , P44 \u2208 R\nnp\u00d7np\n+ W \u2208 D\nq\u00d7q\n+ (30)\nsuch that the following matrix inequalities hold:\uf8ee\n\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\nB\u22a5p (Q11A\n\u2032\np +ApQ11)(B\n\u22a5\np )\n\u2032 0 B\u22a5p Q11C\n\u2032\npW B\n\u22a5\np Bpd B\n\u22a5\np Q11C\n\u2032\npz\n? (Ap +LCp)\u2032P44 +P44(Ap +LCp) P44L \u2212P44Bpd 0\n? ? \u22122W 0 0\n? ? ? \u2212\u03b3I 0\n? ? ? ? \u2212\u03b3I\n\uf8f9\n\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb< 0 (31)\n\uf8ee\n\uf8ef\uf8ef\uf8f0\nRnomA\u2032nom +AnomRnom B0,nom +RnomC\n\u2032\n0,nom(W ) B1,nom RnomC\n\u2032\n2,nom\n? A\u2032pP44 +P44Ap\u22122C\n\u2032\npWCp P44[0 \u2212Bpd] 0\n? ? \u2212\u03b3I 0\n? ? ? \u2212\u03b3I\n\uf8f9\n\uf8fa\uf8fa\uf8fb < 0 (32)\nQnom\u2212Rnom \u2265 0 (33)\nrank(Qnom\u2212Rnom)\u2264 naw (34)\nwhere expressions for the matrices Anom,B0,nom,B1,nom,C0,nom,C2,nom are given in the appendix.\nProof: If \u0393(.) is given as in equations (8) and (18), the system under consideration has state-space realisation\ngiven by equation (23). From Lemma 2, we know this will be the case iff there exists P\u2208R(2np+nc+naw)\u00d7(2np+nc+naw)+ ,\nW \u2208 Dq\u00d7q+ such that\nd\ndt\n(x\u02dc\u2032Px\u02dc)+2y\u02dc\u2032W (C\u02dc1x\u02dc\u2212 y\u02dc)+ \u03b3\u22121\u2016z\u20162\u2212 \u03b3\u2016w\u20162 < 0 (35)\nSubstituting for x\u02dc and z from equation (23) and applying the Schur complement, inequality (35) holds if and only\nif \uf8ee\n\uf8ef\uf8ef\uf8f0\nA\u02dc\u2032P+PA\u02dc PB\u02dc2 +C\u02dc\u20321W PB\u02dc1 C\u02dc\n\u2032\n2\n? \u22122W 0 0\n? ? \u2212\u03b3I 0\n? ? ? \u2212\u03b3I\n\uf8f9\n\uf8fa\uf8fa\uf8fb < 0 (36)\nwhich can be written as\uf8ee\n\uf8ef\uf8ef\uf8f0\nA\u2032oP+PAo PBo +C\u02dc\n\u2032\n1W PB\u02dc1 C\u02dc\n\u2032\n2\n? \u22122W 0 0\n? ? \u2212\u03b3I 0\n? ? ? \u2212\u03b3I\n\uf8f9\n\uf8fa\uf8fa\uf8fb\n\ufe38 \ufe37\ufe37 \ufe38\n=:\u03a8\n+\n\uf8ee\n\uf8ef\uf8ef\uf8f0\nC\u00af\u2032\nD\u00af\u2032\n0\n0\n\uf8f9\n\uf8fa\uf8fa\uf8fb\n\ufe38 \ufe37\ufe37 \ufe38\n=:G\n\u039b\u2032\n[\nB\u00af\u2032P 0 0 0\n]\ufe38 \ufe37\ufe37 \ufe38\n=:H \u2032\n+(?)\u2032 < 0 (37)\nUsing Lemma 1, this holds iff\nG\u22a5\u03a8(G\u22a5)\u2032 < 0 and H\u22a5\u03a8(H\u22a5)\u2032 < 0 (38)\nThe remainder of the proof evaluates these two expressions for G and H defined above.\n(i) G\u22a5\u03a8(G\u22a5)\u2032. Note that G \u2208 R(2np+naw+nc+q+nw+nz)\u00d7(naw+q) can be written as\nG =\n\uf8ee\n\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\n0 0\n0 0\nI 0\n0 C\u2032p\n0 I\n0 0\n0 0\n\uf8f9\n\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb\nwith rank(G) = naw +q (39)\nThus the null-space of G\u2032 has dimension 2np +nc +nw +nz and a matrix of maximal rank whose columns span\nthis null-space can be constructed as\nG\u22a5 =\n\uf8ee\n\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\nI 0 0 0 0 0 0\n0 I 0 0 0 0 0\n0 0 0 I \u2212C\u2032p 0 0\n0 0 0 0 0 I 0\n0 0 0 0 0 0 I\n\uf8f9\n\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb =:\n\uf8ee\n\uf8f0 I\u20321 I\u20322 0 00 0 I 0\n0 0 0 I\n\uf8f9\n\uf8fb (40)\nThus it follows that G\u22a5\u03a8(G\u22a5)\u2032 < 0 is equivalent to\uf8ee\n\uf8f0 I\u20321(A\u2032oP+PAo)I1 + I\u20321(PBo +C\u02dc\u20321W )I2 + I\u20322(B\u2032oP+WC\u02dc1)I1\u22122I\u20322WI2 I\u20321PB\u02dc1 I\u20321C\u02dc\u20322? \u2212\u03b3I 0\n? ? \u2212\u03b3I\n\uf8f9\n\uf8fb < 0 (41)\nIf, without loss of generality \u2020, P is structured as\nP =\n\uf8ee\n\uf8ef\uf8ef\uf8f0\nP11 P12 P13 0\n? P22 P23 0\n? ? P33 0\n? ? ? P44\n\uf8f9\n\uf8fa\uf8fa\uf8fb > 0 (42)\nthen extensive algebra proves that inequality (41) can be written as\uf8ee\n\uf8ef\uf8ef\uf8f0\nA\u2032nomPnom +PnomAnom PnomB0,nom +C\n\u2032\n0,nom(W ) PnomB1,nom C\n\u2032\n2,nom\n? A\u2032pP44 +P44Ap\u22122C\n\u2032\npWCp P44[0 \u2212Bpd] 0\n? ? \u2212\u03b3I 0\n? ? ? \u2212\u03b3I\n\uf8f9\n\uf8fa\uf8fa\uf8fb < 0 (43)\nApplying the congruence transformation blockdiag(P\u22121nom, I, I, I), and defining Rnom := P\n\u22121\nnom, then gives inequality\n(32) in the theorem.\n(ii) H\u22a5\u03a8(H\u22a5)\u2032. Note that H can be written as\nH = blockdiag(P, I, I, I)\n[\nB\u00af\u2032 0 0 0\n]\u2032\ufe38 \ufe37\ufe37 \ufe38\nH\u02dc\n(44)\nThus H\u22a5 = H\u02dc\u22a5blockdiag(P\u22121, I, I, I), where H\u02dc \u2208 R(2np+naw+nc+q+nw+nz)\u00d7(naw+nc+m) is given by\nH\u02dc =\n\uf8ee\n\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\n0 0 Bp\n0 I 0\nI 0 0\n0 0 0\n0 0 0\n0 0 0\n0 0 0\n\uf8f9\n\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb\nwith rank(H\u02dc) = naw +nc +m (45)\nThe null space of H\u02dc has dimension 2np\u2212m+q+nw +nz. Thus we can calculate H\u02dc\u22a5 as\nH\u02dc\u22a5 =\n\uf8ee\n\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\nB\u22a5p 0 0 0 0 0 0\n0 0 0 I 0 0 0\n0 0 0 0 I 0 0\n0 0 0 0 0 I 0\n0 0 0 0 0 0 I\n\uf8f9\n\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb =:\n\uf8ee\n\uf8ef\uf8ef\uf8f0\nJ\u20321 0 0 0\n0 I 0 0\n0 0 I 0\n0 0 0 I\n\uf8f9\n\uf8fa\uf8fa\uf8fb (46)\n\u2020Due to the triangular structure of \u0098A, there is no loss in generality of enforcing P to be block-diagonal - see appendix for more details\nThus letting Q := P\u22121 we get\nH\u22a5\u03a8(H \u2032)\u22a5=\n\uf8ee\n\uf8ef\uf8ef\uf8f0\nJ\u20321(QA\n\u2032\no +AoQ)J1 J\n\u2032\n1(Bo +QC\u02dc\n\u2032\n1W ) J\n\u2032\n1B\u02dc1 J\n\u2032\n1QC\u02dc\n\u2032\n2\n? \u22122W 0 0\n? ? \u2212\u03b3I 0\n? ? ? \u2212\u03b3I\n\uf8f9\n\uf8fa\uf8fa\uf8fb < 0 (47)\nUsing the structure of P given in equation (42), Q = P\u22121 is defined as\nQ :=\n\uf8ee\n\uf8ef\uf8ef\uf8f0\nQ11 Q12 Q13 0\n? Q22 Q23 0\n? ? Q33 0\n? ? ? Q44\n\uf8f9\n\uf8fa\uf8fa\uf8fb (48)\nLabourious algebra then shows that inequality (47) is equivalent to\uf8ee\n\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\nB\u22a5p (Q11A\n\u2032\np +ApQ11)(B\n\u22a5\np )\n\u2032 0 B\u22a5p Q11C\n\u2032\npW B\n\u22a5\np Bpd B\n\u22a5\np Q11C\n\u2032\npz\n? Q44(Ap +LCp)\u2032+(Ap +LCp)Q44 L \u2212Bpd 0\n? ? \u22122W 0 0\n? ? ? \u2212\u03b3I 0\n? ? ? ? \u2212\u03b3I\n\uf8f9\n\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb < 0\n(49)\nThe congruence transformation blockdiag(I,Q\u2212144 , I, I, I) can then be used to arrive at inequality (31) in the theo-\nrem.\niii) Ensuring P > 0\nQuadratic stability holds under the condition that P > 0, which is equivalent to inequality (42) holding. In\nturn this will hold if P44 > 0, Qnom > 0 and there exist matrices, [Q\u203213 Q\n\u2032\n23]\n\u2032, [P\u203213 P\n\u2032\n23]\n\u2032 \u2208 R(np+nc)\u00d7naw and\nP33,Q33 \u2208 Rnaw\u00d7naw such that the following inequality holds\uf8ee\n\uf8f0 Pnom\n[\nP13\nP23\n]\n? P33\n\uf8f9\n\uf8fb\u22121 =\n\uf8ee\n\uf8f0 Qnom\n[\nQ13\nQ23\n]\n? Q33\n\uf8f9\n\uf8fb > 0 (50)\nNow, from Lemma 3 these matrices exist if and only if the following inequalities hold\nQnom\u2212P\u22121nom \u2265 0 (51)\nrank(Qnom\u2212P\u22121nom) \u2264 naw (52)\nRecalling that P\u22121nom = Rnom yields inequalities (33) and (34). This completes the proof. \u0003\u0003\nThe existence conditions in Theorem 1 are \u201calmost\u201d linear matrix inequalities in the variables Qnom,Rnom,W\nand \u03b3 with two sources of nonlinearity preventing them being linear. The first is the obvious non-convex rank-\nconstraint in inequality (34) which often occurs in LMI controller design [5]. However, as in [8], for certain\norders of anti-windup compensator, particularly naw \u2265 np and naw = 0, the rank constraint will vanish. The\nsecond source of nonlinearity is the bilinear term involving Q11 and W , although for fixed W this becomes linear\nand hence the inequalities become linear. Unlike the corresponding conditions for the input saturation case ([8])\nnote that the \u201cmultiplier\u201d matrix W is still present in the existence conditions.\n4 Discussion\nWhen the anti-windup compensator is chosen to be of order np or zero, Theorem 1 gives matrix inequalities\nwhich can be checked for existence. However, they do not reveal any intrinsic properties about the class of\nsystems for which they are satisfied, nor do they reveal lower bound on the L2 gain. A lower bound on the\nL2 gain can easily checked by omitting the 2nd and 3rd rows and columns of inequality (31) and the second\ncolumn of inequality (32) to yield.\uf8ee\n\uf8f0 B\u22a5p (Q11A\u2032p +ApQ11)(B\u22a5p )\u2032 B\u22a5p Bpd B\u22a5p Q11C\u2032pz? \u2212\u03b3I 0\n? ? \u2212\u03b3I\n\uf8f9\n\uf8fb < 0 (53)\n\uf8ee\n\uf8f0 RnomA\u2032nom +AnomRnom B1,nom RnomC\u20322,nom? \u2212\u03b3I 0\n? ? \u2212\u03b3I\n\uf8f9\n\uf8fb < 0 (54)\n(55)\nThese two equations are in the form of \u201cbounded real lemma\u201d inequalities, which imply that the L2 gain is lower\nbounded by the H\u221e norm of the closed-loop system, \u2016[G,K]nom\u2016\u221e, and the H\u221e norm of a system very closely\nrelated to the open-loop plant (as given in inequality (53)). This is a similar observation to that made in the\ncase of anti-windup for systems with input saturation in [8], although added complications with the structure of\ninequalities (31) and (32), make the bound above more conservative (due to the extra constraints in the 2nd and\n3rd rows) than in the case of anti-windup compensation for systems with input saturation.\n4.1 Simplified existence conditions\nIt is interesting to examine the properties of systems for which there exists an anti-windup compensator guar-\nanteeing global quadratic stability and L2 gain. Although conditions are given in Theorem 1, it is desirable\nto reveal deeper properties which the nominal linear system must possess in order for these conditions to be\nsatisfied. The main result of this section is\nCorollary 1 Assume L = 0, then an anti-windup compensator \u039b(s) which satisfied the conditions of Theorem 1\nexists if and only if\n1. Ap is Hurwitz\n2. Anom is Hurwitz\nProof: Theorem 1 will be satisfied for sufficiently large \u03b3 providing that the following conditions hold:\uf8ee\n\uf8f0 B\u22a5p (Q11A\u2032p +ApQ11)(B\u22a5p )\u2032 0 B\u22a5p Q11C\u2032pW? (Ap +LCp)\u2032P44 +P44(Ap +LCp) P44L\n? ? \u22122W\n\uf8f9\n\uf8fb< 0 (56)\n[\nRnomA\u2032nom +AnomRnom B0,nom +RnomC\n\u2032\n0,nom(W )\n? A\u2032pP44 +P44Ap\u22122C\n\u2032\npWCp\n]\n< 0 (57)\nQnom\u2212Rnom \u2265 0 (58)\nrank(Qnom\u2212Rnom)\u2264 naw (59)\nWe shall examine these conditions in turn.\nInequality (56). Letting L = 0 and applying the Schur complement, it follows that inequality (56) is equivalent\nto.\nA\u2032pP44 +P44Ap < 0 (60)\nB\u22a5p (Q11A\n\u2032\np +ApQ11 +Q11C\n\u2032\npWCpQ11)(B\n\u22a5\np )\n\u2032 < 0 (61)\nThese conditions will hold iff if Ap is Hurwitz.\nInequality (57). Necessity. From the (1,1) element it is trivial that Anom must be Hurwitz. To see that Ap also\nmust be Hurwitz, we apply the congruence transformation\uf8ee\n\uf8f0 R\u22121nom\n[\n\u2212I\n0\n]\n0 I\n\uf8f9\n\uf8fb (62)\nto obtain the equivalent inequality\uf8ee\n\uf8f0 A\u20320,nomPnom +PnomA0,nom +\n[\nX44 0\n0 0\n]\nPnomB0,nom +\n[\nX44 +C\u2032pWCp\n0\n]\n? A\u2032pP44 +P44Ap\u22122C\n\u2032\npWCp\n\uf8f9\n\uf8fb < 0 (63)\nwhere X44 = A\u2032pP44 +P44Ap. Simple algebra shows that the (1,1) element is negative definite if and only if Ap is\nHurwitz and (BpCc,Ac) is detectable, which is implied by Anom being Hurwitz.\nSufficiency. Assume, Anom and Ap are Hurwitz, then, choosing P44 sufficiently large ensures that inequality (57)\nholds.\nConditions (58) and (59). Assume that naw = np, then condition (59) is trivially satisfied. Next let,\nQnom =\n[\nQ11 R12\n? R22\n]\n(64)\nThen choosing Q11 sufficiently large ensures that inequality (58) is satisfied. \u0003\u0003\nRemark 4 Again, it is useful to constrast these results with those in [8] which correspond to the case of actuator\nrather than sensor saturation. The fundamental existence conditions are effectively the same in both cases: global\nexponential stability of both the plant and the un-saturated closed-loop is a requirement for there to exist an anti-\nwindup compensator ensuring global quadratic stability and finite L2 gain. These conditions were also hinted at\nin [19]. However, the L2 gain bound is somewhat different in the sensor saturation case because (i) the presence\nof the observer adds extra constraints to this bound (see inequalities (31) and (32)) and (ii), the \u201cbounded real\u201d\ninequality for the open-loop (which contributes to a lower bound on the L2 gain) is modified by \u201couter factors\u201d\nwhich depend on B\u22a5p . In particular the dependence of the L2 gain bound on B\n\u22a5\np implies that the more actuated a\nsystem is, the fewer constraints on the L2 gain there will be. \u0003\n5 Example\nTo illustrate the use of anti-windup compensation for sensor saturation, Theorem 1 is applied to a simple exam-\nple. Consider the plant\n\uf8ee\n\uf8f0 Ap Bp BpdCp 0 0\nCpz 0 0\n\uf8f9\n\uf8fb =\n\uf8ee\n\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\n\u22122.2000 \u22120.2050 \u22120.0100 1 0.001\n2.0000 0 0 0 0\n0 1.0000 0 0 0\n1.0000 0.4000 0.0750 0 0\n1.0000 0.4000 0.0750 0 0\n\uf8f9\n\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb (65)\nand the linear controller [\nAc Bc Bcr\nCc Dc Dcr\n]\n=\n[\n0 \u22124 4\n4.25 \u221217 17\n]\n(66)\nThe closed-loop interconnection [G,K]nom of these two elements is asymptotically stable; the plant is also asymp-\ntotically stable. Thus from Corollary 1, we know that an anti-windup compensator enforcing global exponential\nstability and L2 gain will exist. An observer for this system is constructed according equation (10) with L = 0\n(i.e. the observer is just a copy of the plant, as proposed in [19]).\nAn anti-windup compensator was designed using Theorem 1, with W = 1. Using standard controller re-construction\nalgorithms (given in [8] and [5] for example), the following anti-windup compensator was obtained\n\uf8ee\n\uf8f0 \u039b1 \u039b2\u039b31 \u039b32\n\u039b41 \u039b42\n\uf8f9\n\uf8fb =\n\uf8ee\n\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\n\u2212308.3860 \u221218.9999 \u221212.8327 \u221221.1642\n\u221237.2891 \u22124.1645 \u22120.9023 \u22121.5614\n\u22121.3277 1.4301 \u22121.5368 \u22120.6332\n\u221212.7091 \u22121.8722 0.0113 \u22128.1895\n\u22126679.9 \u2212424.6887 \u2212272.5045 \u2212487.7512\n\uf8f9\n\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb (67)\nwhich corresponded to an L2 gain of \u03b3 = 1.0254.\nFigure 8 shows the system\u2019s response, y(t) to a pulse input of magnitude 2 units in various circumstances. The\ndotted line shows the response when no sensor saturation is present, and thus the anti-windup compensator is not\nactive. The dashed line shows the response when sensor saturation with limits y\u00af = 1.5 units is introduced. Notice\nthe sharp degradation in performance and the excessive overshoot in the response. The solid line shows the\nresponse of the system with the same level of sensor saturation but with the above anti-windup compesator active.\nAlthough the system cannot recover the precise pulse characteristics, the deviation from the linear behaviour is\nsubstantially lower and the recovery of the linear response is much faster. Figure 9 shows the behaviour of the\nsignal which is passed to the sensors (i.e. after saturation), ym(t). Observe that when anti-windup compensation\nis active, the sensor remains saturated for a shorter period of time and linear behaviour is resumed earlier.\nRemark 5: Note that the results in [26] are more restrictive because that uses Architecture 1 which involves\ntwo saturation nonlinearities and is hence more conservative. Crucially, the results of [26] also require the linear\ncontroller to be exponentially stable which is not the case with the PI controller used here.\n0 1 2 3 4 5 6 7 8 9 10\n\u22125\n\u22124\n\u22123\n\u22122\n\u22121\n0\n1\n2\n3\n4\n5\nTime [sec]\nlinear\nsaturation, no AW\nsaturation, AW\nFigure 8: Output response y(t) of example system\n6 Conclusion\nNecessary and sufficient conditions for the existence of an anti-windup compensator which guarantees quadratic\nstability and L2 gain of a linear system subject to a sensor saturation nonlinearity have been presented. An\nimportant corollary to these conditions implies that such an anti-windup compensator only exists if and only if\nthe nominal open-loop and closed-loop linear systems are asymptotically stable. This implies that anti-windup\ncompensators for systems with sensor saturation exist under the same conditions as they do for systems with input\nsaturation; a fact which was first hinted at in [19], although no proof was supplied. However, due to the problem\u2019s\n0 1 2 3 4 5 6 7 8 9 10\n\u22122.5\n\u22122\n\u22121.5\n\u22121\n\u22120.5\n0\n0.5\n1\n1.5\n2\n2.5\nTime [sec]\nlinear\nsaturation, no AW\nsaturation, AW\nFigure 9: Sensor response ym(t) of example system\nstructure, the L2 gain bound for systems with sensor saturation is generally different to that for systems with\ninput saturation. An example has presented the effectiveness of the proposed technique. As indicated in the\nintroduction, sensor saturation could be used to approximate the case in which only the sign of the output is\nknown and it would be of interest to investigate the use of the methods proposed here in such situations.\nReferences\n[1] S. Boyd, L. El Ghaoui, E. Feron, and V. Balakrishnan. Linear Matrix Inequalities in System and Control\nTheory. SIAM, 1994.\n[2] Y.Y. Cao, Z. Lin, and B.M. Chen. An output feedback H\u221e controller for linear systems subject to sensor\nnonlinearities. IEEE Transactions on Circuits and Systems-I, 50(7):914\u2013921, 2003.\n[3] S. Crawshaw. Global and local analyses of coprime-factor based anti-windup for stable and unstable plants.\nIn Proc. European Control Conference, Cambridge, 2003.\n[4] A.T. Fuller. In-the-large stability of relay and saturating control systems with linear controller. International\nJournal of Control, 10:457\u2013480, 1969.\n[5] P. Gahinet and P. Apkarian. A linear matrix inequality approach to H\u221e control. International Journal of\nRobust and Nonlinear Control, 4:421\u2013448, 1994.\n[6] A. H. Glattfelder, W. Schaufelberger, and H.P. Fassler. Stability of override control systems. International\nJournal of Control, 37(5):1023\u20131037, 1983.\n[7] J.M. Gomes da Silva Jr. and S. Tarbouriech. Anti-windup design with guaranteed region of stability: an\nLMI-based approach. IEEE Transactions on Automatic Control, 50(1):106\u2013111, 2005.\n[8] G. Grimm, J. Hatfield, I. Postlethwaite, A.R. Teel, M.C. Turner, and L. Zaccarian. Anti-windup for stable\nlinear systems with input saturation: an LMI based synthesis. IEEE Transactions on Automatic Control,\n48(9):1509\u20131525, 2003.\n[9] G. Herrmann, M.C. Turner, and I. Postlethwaite. Discrete-time and sampled-data anti-windup synthesis:\nstability and performance. International Journal of Systems Science, 37(10), 2006.\n[10] G. Kaliora and A. Astolfi. Nonlinear control of feedforward systems with bounded signals. IEEE Transac-\ntions on Automatic Control, 49(11):1975\u20131990, 2004.\n[11] R.B. Koplon, M.L.J. Hautus, and E.D. Sontag. Observability of linear systems with saturated outputs.\nLinear Algebra and Applications, 205-206:909\u2013936, 1994.\n[12] M.V. Kothare, P.J. Campo, M. Morari, and C.N. Nett. A unified framework for the study of anti-windup\ndesigns. Automatica, 30(12):1869\u20131883, 1994.\n[13] G. Kreisselmeier. Stabilisation of linear systems in the presence of output measurement saturation. Systems\nand Control Letters, 29:27\u201330, 1996.\n[14] Z. Lin and T. Hu. Semi-global stabilisation of linear systems subject to output saturation. Systems and\nControl Letters, 43:211\u2013217, 2001.\n[15] Z. Lin and A. Saberi. Semi-global exponential stabilisation of linear systems subject to input saturation via\nlinear feedbacks. Systems and Control Letters, 21:225\u2013239, 1996.\n[16] V.R. Marcopoli and S.M. Phillips. Analysis and synthesis tools for a class of actuator-limited multivari-\nable control systems: a linear matrix inequality approach. International Journal of Robust and Nonlinear\nControl, 6(9-10):1045\u20131063, 1996.\n[17] T. Nguyen and F. Jabbari. Output feedback controllers for disturbance attenuation with actuator amplitude\nand rate saturation. Automatica, 36(9):1339\u20131346, 2000.\n[18] A. Packard. Gain scheduling via linear fractional transformations. Systems and Control Letters, 22(2):79\u2013\n92, 1994.\n[19] J.-K. Park and H.Y. Youn. Dynamic anti-windup based control method for state-constrained systems.\nAutomatica, 39:1915\u20131922, 2003.\n[20] S. Solyom. A synthesis method for static anti-windup compensators. In Proc. European Control Confer-\nence, Cambridge, 2003.\n[21] H.J. Sussmann, E.D. Sontag, and Y. Yang. A general result on the stabilisation of linear systems using\nbounded controls. IEEE Transactions on Automatic Control, 39:2411\u20132425, 1994.\n[22] S. Tarbouriech and G. Garcia. Preliminary results about anti-windup strategy for systems subject to actuator\nand sensor saturations. In Proc. of the IFAC World Congress, Prague, 2005.\n[23] S. Tarbouriech, G. Garcia, and A.H. Glattfelder, editors. Advanced Strategies in Control Systems with Input\nand Output Constraints, volume 346 of Lecture Notes in Control and Infomrmation Sciences. Springer,\n2007.\n[24] A.R. Teel and N. Kapoor. The L2 anti-windup problem: Its definition and solution. In Proc. European\nControl Conference, Brussels, 1997.\n[25] M.C. Turner and I. Postlethwaite. A new perspective on static and low order anti-windup synthesis. Inter-\nnational Journal of Control, 77(1):27\u201344, 2004.\n[26] M.C. Turner and S. Tarbouriech. Anti-windup compensation for systems with sensor saturation: sufficient\nconditions for stability and L2 gain. In Proc. of the IEEE Conference on Decision and Control, San Diego,\n2006.\n[27] M.C. Turner and L. Zaccarian, editors. Special Issue on Anti-windup, volume 37 of International Journal\nof Systems Science, 2006.\n[28] N. Wada and M. Saeki. Design of a static anti-windup compensator which guarantees robust stability.\nTransactions of the Institute of Systems, Control and Instrumentation Enigneers, 12(11):664\u2013670, 1999.\n[29] M.J. Walsh and M.J. Hayes. A robust throughput rate control mechanism for an 802.15.4 wireless sensor\nnetwork - an anti-windup approach. In Proc. of the American Control Conference, New York, 2007.\n[30] F. Wu and M. Soto. Extended anti-windup control schemes for lti and lft systems with actuator saturations.\nInternational Journal of Robust and Nonlinear Control, 14(15):1255\u20131281, 2004.\nA State-space matrices\nNominal linear system. Closed-loop linear system:\n\uf8ee\n\uf8f0 Anom B0,nom B1,nomC1,nom 0 0\nC2,nom 0 0\n\uf8f9\n\uf8fb =\n\uf8ee\n\uf8ef\uf8ef\uf8f0\nAp +BpDcCp BpCc BpDcCp BpDcr Bpd\nBcCp Ac BcCp Bcr 0\nCp 0 0 0 0\nCpz 0 0 0 0\n\uf8f9\n\uf8fa\uf8fa\uf8fb\nOpen-loop linear system \u201cA\u201d matrix:\nA0,nom =\n[\nAp BpCc\n0 Ac\n]\n(68)\nDummy C-matrix\nC0,nom(W ) =\n[\n\u2212CpWC\u2032p 0\n]\n(69)\nSaturated system\nA\u02dc =\n\uf8ee\n\uf8ef\uf8ef\uf8f0\nAp +BpDcCp BpCc Bp\u039b32 Bp\u039b42Cp\nBcCp Ac \u039b31 \u039b41Cp\n0 0 \u039b1 \u039b2Cp\n0 0 0 Ap +LCp\n\uf8f9\n\uf8fa\uf8fa\uf8fb\nB\u02dc1 =\n\uf8ee\n\uf8ef\uf8ef\uf8f0\nBpDcr Bpd\nBcr 0\n0 0\n0 \u2212Bpd\n\uf8f9\n\uf8fa\uf8fa\uf8fb B\u02dc2 =\n\uf8ee\n\uf8ef\uf8ef\uf8f0\nBp(\u039b42\u2212Dc)\n\u039b41\u2212Bc\n\u039b2\nL\n\uf8f9\n\uf8fa\uf8fa\uf8fb\nC\u02dc1 =\n[\nCp 0 0 0\n]\nC\u02dc2 =\n[\nCpz 0 0 0\n]\n(70)\nPartitioned saturated system\nA0 =\n\uf8ee\n\uf8ef\uf8ef\uf8f0\nAp BpCc 0 0\nBcCp Ac 0 0\n0 0 0 0\n0 0 0 Ap +LCp\n\uf8f9\n\uf8fa\uf8fa\uf8fb B0 =\n\uf8ee\n\uf8ef\uf8ef\uf8f0\n\u2212BpDc\n\u2212Bc\n0\nL\n\uf8f9\n\uf8fa\uf8fa\uf8fb (71)\nB\u00af =\n\uf8ee\n\uf8ef\uf8ef\uf8f0\n0 0 Bp\n0 I 0\nI 0 0\n0 0 0\n\uf8f9\n\uf8fa\uf8fa\uf8fb \u039b =\n\uf8ee\n\uf8f0 \u039b1 \u039b2\u039b31 \u039b32\n\u039b41 \u039b42\n\uf8f9\n\uf8fb (72)\nC\u00af =\n[\n0 0 I 0\n0 0 0 Cp\n]\nD\u00af =\n[\n0\nI\n]\n(73)\nB On the use of diagonal Lyapunov functions\nIn this section we show that, without loss of generality when one is seeking a Lyapunov function to enforce\nthe Circle Criterion for \u03a8(.) \u2208 Sector[0, I], then if the \u201cA\u201d matrix has a triangular structure, then without loss of\ngenerality one can assume a diagonal structure for the Lyapunov function. Formally this is stated as\nLemma 4 Consider the inequality [\nA\u2032P+PA PB+C\u2032W\n? \u22122W\n]\n< 0 (74)\nwhere A is block triangular, viz\nA =\n[\nA11 A12\n0 A22\n]\n\u2208 R(n1+n2)\u00d7(n1+n2) B =\n[\nB11\nB21\n]\n\u2208 R(n1+n2)\u00d7m C =\n[\nC11 C12\n]\n\u2208 Rm\u00d7(n1+n2) (75)\nThen there exist matrices P \u2208 R(n1+n2)\u00d7(n1+n2)+ and W \u2208 D\nm\u00d7m\n+ which satisfies this inequality if and only if there\nexists matrices P = blockdiag(P11,P22)\u2208R\n(n1+n2)\u00d7(n1+n2)\n+ and W \u2208D\nm\u00d7m\n+ which also satisfy the above inequality.\nProof: The proof is a simple application of Finsler\u2019s lemma. Note that in terms of the matrices A,B,C, the above\ninequality can be written as\n\uf8ee\n\uf8f0 A\u203211P11 +P11A11 P11A12 P11B11 +C\u203211W? A\u203222P22 +P22A22 P22B21 +C\u203212W\n? ? \u22122W\n\uf8f9\n\uf8fb\n\ufe38 \ufe37\ufe37 \ufe38\n\u03a8M\n+\n\uf8ee\n\uf8f0 I A\u2032110 A\u203212\n0 B\u203211\n\uf8f9\n\uf8fbP12 [ 0 A22 B210 I 0\n]\n+(?)\u2032 < 0 (76)\nUsing Finsler\u2019s Lemma and the Schur complement, it follows that inequality (76) is satisfied if and only if\n\u2203\u03c3 \u2208 R such that\uf8ee\n\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\nA\u203211P11 +P11A11 P11A12 P11B11 +C\n\u2032\n11W I A\n\u2032\n11\n? A\u203222P22 +P22A22 P22B21 +C\n\u2032\n12W 0 A\n\u2032\n12\n? ? \u22122W 0 B\u203211\n? ? ? \u2212\u03c3\u22121I 0\n? ? ? ? \u2212\u03c3\u22121I\n\uf8f9\n\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb < 0 (77)\n\uf8ee\n\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\nA\u203211P11 +P11A11 P11A12 P11B11 +C\n\u2032\n11W 0 0\n? A\u203222P22 +P22A22 P22B21 +C\n\u2032\n12W A\n\u2032\n22 I\n? ? \u22122W B\u203221 0\n? ? ? \u2212\u03c3\u22121I 0\n? ? ? ? \u2212\u03c3\u22121I\n\uf8f9\n\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb < 0 (78)\nNecessity. For both inequalities (77) and (78) to hold, it is necesssary that \u03a8M < 0.\nSufficiency. If \u03a8M < 0, then it follows that there always exists a sufficiently small \u03c3 such that both inequalities\n(77) and (78) hold.\nHence \u03a8M < 0 is both necessary and sufficient for the inequality (74) to hold, providing the matrices are struc-\ntured as above. Notice that \u03a8M < 0 is nothing more than inequality (74) with P = blockdiag(P11,P22). This\ncompletes the proof. \u0003\u0003\n"}