{"doi":"10.1016\/j.ymssp.2006.12.006","coreId":"140875","oai":"oai:dspace.lib.cranfield.ac.uk:1826\/1837","identifiers":["oai:dspace.lib.cranfield.ac.uk:1826\/1837","10.1016\/j.ymssp.2006.12.006"],"title":"An automated methodology for performing time synchronous averaging of a gearbox\nsignal without speed sensor.","authors":["Combet, Francois","Gelman, Leonid"],"enrichments":{"references":[{"id":37921040,"title":"1285-1314. Cyclostationary modelling of rotating machine vibration signals.","authors":[],"date":"2004","doi":"10.1016\/s0888-3270(03)00088-8","raw":"J. Antoni, F. Bonnardot, A. Raad, M. El Badaoui, Mechanical Systems and Signal Processing 18 (2004) 1285-1314. Cyclostationary modelling of rotating machine vibration signals.","cites":null},{"id":37921041,"title":"187-205. Analysis of computed order tracking.","authors":[],"date":"1997","doi":"10.1006\/mssp.1996.0056","raw":"K.R. Fyfe and D.S. Munck, Mechanical Systems and Signal Processing 11 (2) (1997) 187-205. Analysis of computed order tracking.","cites":null},{"id":37921027,"title":"766-785. Use of the acceleration signal of a gearbox in order to perform angular resampling (with limited speed uctuation).","authors":[],"date":"2005","doi":"10.1016\/j.ymssp.2004.05.001","raw":"F. Bonnardot, M. El Badaoui, R.B. Randall, J. Dani ere, F. Guillet, Mechanical Systems and Signal Processing 19 (2005) 766-785. Use of the acceleration signal of a gearbox in order to perform angular resampling (with limited speed uctuation).","cites":null},{"id":37921046,"title":"87-97. Interpolation techniques for time domain averaging of gear vibration.","authors":[],"date":"1989","doi":"10.1016\/0888-3270(89)90024-1","raw":"P.D. McFadden, Mechanical Systems and Signal Processing 3 (1) (1989) 87-97. Interpolation techniques for time domain averaging of gear vibration. 24[10] F. Candocia, J.C. Principe, IEEE Transactions on Signal Processing 45 (7) (1998) 2044-2047. Comments on sinc interpolation of discrete periodic signals.","cites":null},{"id":37921026,"title":"A revised model for the extraction of periodic waveforms by time-domain averaging.","authors":[],"date":"1987","doi":"10.1016\/0888-3270(87)90085-9","raw":"P.D. McFadden, Mechanical Systems and Signal Processing 1 (1) (1987) 83-95. A revised model for the extraction of periodic waveforms by time-domain averaging.","cites":null},{"id":37921024,"title":"Acustica Vol.","authors":[],"date":"1975","doi":null,"raw":"S. Braun, Acustica Vol. 32 (1975) 69-77. The extraction of periodic waveforms by time domain averaging.","cites":null},{"id":37921049,"title":"Advanced Vibration Analysis Techniques for Fault Detection and Diagnosis in Geared Transmission Systems,","authors":[],"date":"1996","doi":null,"raw":"B.D. Forrester, Advanced Vibration Analysis Techniques for Fault Detection and Diagnosis in Geared Transmission Systems, Ph.D dissertation (1996), Swinburne University of Technology, Melbourne, Australia.","cites":null},{"id":37921037,"title":"Detecting fatigue cracks in gears by amplitude and phase demodulation of the meshing vibration.","authors":[],"date":"1986","doi":"10.1115\/1.3269317","raw":"P.D. McFadden, Journal of Vibration, Acoustics, Stress, and Reliability in Design 108 (1986), 165-170. Detecting fatigue cracks in gears by amplitude and phase demodulation of the meshing vibration.","cites":null},{"id":37921039,"title":"Estimation of slight speed gaps between signals via the scale transform.","authors":[],"date":"2005","doi":"10.1016\/j.ymssp.2004.04.004","raw":"F. Combet, P. Jaussaud, N. Martin, Mechanical Systems and Signal Processing 19 (2005) 239-257. Estimation of slight speed gaps between signals via the scale transform.","cites":null},{"id":37921048,"title":"Mechanical Systems and Signal Processing 15 (5) (2001) 945-962. The relationship between spectral correlation and envelope analysis in the diagnostics of bearing faults and other cyclostationary machine signals.","authors":[],"date":null,"doi":"10.1006\/mssp.2001.1415","raw":"R.B. Randall, J. Antoni, S. Chobsaard, Mechanical Systems and Signal Processing 15 (5) (2001) 945-962. The relationship between spectral correlation and envelope analysis in the diagnostics of bearing faults and other cyclostationary machine signals.","cites":null},{"id":37921047,"title":"On-line interpolation using spline functions.","authors":[],"date":"1996","doi":"10.1109\/97.491656","raw":"T.J. Lim, M.D. Macleod, IEEE Signal Processing Letters 3 (5) May 1996, 144-146. On-line interpolation using spline functions.","cites":null},{"id":37921038,"title":"Transmission path phase compensation for gear monitoring under uctuating load conditions.","authors":[],"date":"2006","doi":"10.1016\/j.ymssp.2005.05.009","raw":"C.J. Stander, P.S. Heyns, Mechanical Systems and Signal Processing 20 (2006) 1511-1522. Transmission path phase compensation for gear monitoring under uctuating load conditions.","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2007-08-01T00:00:00Z","abstract":"In this paper we extend a sensorless algorithm proposed by Bonnardot et al. for\nangular resampling of the acceleration signal of a gearbox submitted to limited\nspeed fluctuation. The previous algorithm estimates the shaft angular position\nby narrow-band demodulation of one harmonic of the mesh frequency. The harmonic\nwas chosen by trial and error. This paper proposes a solution to select\nautomatically the mesh harmonic used for the shaft angular position estimation.\nTo do so it evaluates the local signal-to-noise ratio associated to the mesh\nharmonic and deduces the associated low-pass filtering effect on the time\nsynchronous average (TSA) of the signal. Results are compared with the TSA\nobtained when using a tachometer on an industrial gearbox used for wastewater\ntreatment. The proposed methodology requires only the knowledge of an\napproximate value of the running speed and the number of teeth of the gears. It\nforms an automated scheme which can prove useful for real-time diagnostic\napplications based on TSA where speed measurement is not possible or not\nadvisable due to difficult environmental conditions","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/140875.pdf","fullTextIdentifier":"http:\/\/dx.doi.org\/10.1016\/j.ymssp.2006.12.006","pdfHashValue":"7b67f0558777bee3c50209a41d76378b948fa274","publisher":"Elsevier Science B.V., Amsterdam","rawRecordXml":"<record><header><identifier>\noai:dspace.lib.cranfield.ac.uk:1826\/1837<\/identifier><datestamp>2011-11-05T23:01:10Z<\/datestamp><setSpec>hdl_1826_19<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>An automated methodology for performing time synchronous averaging of a gearbox\nsignal without speed sensor.<\/dc:title><dc:creator>Combet, Francois<\/dc:creator><dc:creator>Gelman, Leonid<\/dc:creator><dc:subject>Time synchronous averaging without speed sensor<\/dc:subject><dc:subject>Gearbox vibration signal<\/dc:subject><dc:subject>Automated methodology<\/dc:subject><dc:subject>Condition monitoring applications<\/dc:subject><dc:description>In this paper we extend a sensorless algorithm proposed by Bonnardot et al. for\nangular resampling of the acceleration signal of a gearbox submitted to limited\nspeed fluctuation. The previous algorithm estimates the shaft angular position\nby narrow-band demodulation of one harmonic of the mesh frequency. The harmonic\nwas chosen by trial and error. This paper proposes a solution to select\nautomatically the mesh harmonic used for the shaft angular position estimation.\nTo do so it evaluates the local signal-to-noise ratio associated to the mesh\nharmonic and deduces the associated low-pass filtering effect on the time\nsynchronous average (TSA) of the signal. Results are compared with the TSA\nobtained when using a tachometer on an industrial gearbox used for wastewater\ntreatment. The proposed methodology requires only the knowledge of an\napproximate value of the running speed and the number of teeth of the gears. It\nforms an automated scheme which can prove useful for real-time diagnostic\napplications based on TSA where speed measurement is not possible or not\nadvisable due to difficult environmental conditions.<\/dc:description><dc:publisher>Elsevier Science B.V., Amsterdam<\/dc:publisher><dc:date>2011-11-05T23:01:10Z<\/dc:date><dc:date>2011-11-05T23:01:10Z<\/dc:date><dc:date>2007-08-01T00:00:00Z<\/dc:date><dc:type>Article<\/dc:type><dc:identifier>F. Combet and L. Gelman, An automated methodology for performing time\nsynchronous averaging of a gearbox signal without speed sensor, Mechanical\nSystems and Signal Processing, Volume 21, Issue 6, August 2007, Pages 2590-2606.<\/dc:identifier><dc:identifier>0888-3270<\/dc:identifier><dc:identifier>http:\/\/dx.doi.org\/10.1016\/j.ymssp.2006.12.006<\/dc:identifier><dc:identifier>http:\/\/dspace.lib.cranfield.ac.uk\/handle\/1826\/1837<\/dc:identifier><dc:language>en_UK<\/dc:language><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["issn:0888-3270","0888-3270"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2007,"topics":["Time synchronous averaging without speed sensor","Gearbox vibration signal","Automated methodology","Condition monitoring applications"],"subject":["Article"],"fullText":"An automated methodology for performing\ntime synchronous averaging of a gearbox\nsignal without speed sensor\nF. Combet \u2217, L. Gelman\nApplied Mathematics and Computing Group, School of Engineering,\nCranfield University, Cranfield MK43 OAL, UK\nAbstract\nIn this paper we extend a sensorless algorithm proposed by Bonnardot & al. for\nangular resampling of the acceleration signal of a gearbox submitted to limited speed\nfluctuation. The previous algorithm estimates the shaft angular position by narrow-\nband demodulation of one harmonic of the mesh frequency. The harmonic was\nchosen by trial and error. This paper proposes a solution to select automatically the\nmesh harmonic used for the shaft angular position estimation. To do so it evaluates\nthe local signal to noise ratio associated to the mesh harmonic and deduces the\nassociated low-pass filtering effect on the time synchronous average (TSA) of the\nsignal. Results are compared with the TSA obtained when using a tachometer on\nan industrial gearbox used for wastewater treatment. The proposed methodology\nrequires only the knowledge of an approximate value of the running speed and the\nnumber of teeth of the gears. It forms an automated scheme which can prove useful\nfor real time diagnostic applications based on TSA where speed measurement is not\npossible or not advisable due to difficult environmental conditions.\nKey words: Time Synchronous Averaging without speed sensor, gearbox vibration\nsignal, automated methodology, condition monitoring applications.\n1 Introduction\nTime domain averaging or time synchronous averaging (TSA) is a well adopted\nsignal processing technique which enables periodic waveforms to be extracted\nfrom noisy signals [1,2]. It is particularly suited for the vibration analysis of\n\u2217 f.combet@cranfield.ac.uk\nPreprint submitted to Elsevier Science 17 July 2007\nmechanical systems such as gearboxes, as it enables the vibration of a single\ngear to be separated from the vibration of the complete system. This technique\nrequires the measurement of the \u201dtrigger\u201d signal, i.e. a signal phase-locked\nwith the angular position of one rotating shaft in the system. This speed\nmeasurement is typically delivered by a tachometer which delivers one pulse\nper revolution. An optical encoder (with multiple pulses per revolution) can\nalso be used for a better angular resolution.\nIn some particular environments however, a speed sensor could be rather in-\nconvenient - if not impossible - to use for condition monitoring purposes.\nOptical encoders need to be attached to the end of a shaft, which is possible\nfor limited applications only. Optical \u201dpick-up\u201d sensors (tachometers) could be\neasier to manipulate, but in some environments they can cause problems, for\nexample in high ambient light conditions or where they are subjected to con-\ntaminants like dust, oil or steam. In these conditions, a condition monitoring\nmethodology that would operate without the need of any speed measurement\nwould be of great interest in practice.\nRecently, an original method has been proposed by Bonnardot & al. [3] for\nangular resampling of the vibration signal of a gearbox without the need of a\nspeed sensor, when the gearbox is submitted to limited speed fluctuation (i.e.\nunder relatively steady load condition). The idea was to estimate the angular\nposition of the shaft by narrow-band demodulation of one harmonic of the\nmesh frequency. The harmonic was chosen by trial and error. However, in order\nfor this method to be applicable in a real time and industrial environment,\ndifferent parameters in the method need to be adjusted in an automated and\nreliable fashion, i.e. without the need of any visual inspection of the frequency\nspectrum of the signal or of the estimated speed.\nThe objective of this paper, which can be viewed as a extension of this previous\nwork [3], is to propose an automated methodology in order to obtain the time\nsynchronous averaged signal for any particular shaft in a gearbox without\nspeed sensor. In that purpose, different points in the methodology must be\ndiscussed: which stage in the gearbox and which mesh harmonic to select, how\nto quantify the accuracy of the estimated speed and of the TSA, and which\ninterpolation method to use for resampling the signal.\nIn section 2 we first briefly recall the method proposed in [3] for estimation\nof the instantaneous shaft angular position and we show that the phase error\nof the estimation can be quantified by the local signal to noise ratio of the\ndemodulated mesh harmonic. In section 3 we discuss the interpolation method\nto use for performing angular resampling and TSA, and we quantify the low-\npass filtering effect on the TSA due to the phase error by what we call the\n\u201dcut-off order\u201d of the TSA. These results are then illustrated in section 4\non an industrial gearbox used in wastewater treatment. Finally, a complete\n2\nmethodology is proposed in section 5 for the selection of the mesh harmonic\nto demodulate and the estimation of the TSA of a particular shaft in the\ngearbox.\n2 Shaft speed estimation from a mesh harmonic\n2.1 Recall of the method\nThe model of the vibration signal for one stage of the gearbox used in [3] and\nfirst proposed in [4] is:\nx(t) =\nK\u2211\nk=1\nXk(1 + ak(t)) cos(2pikfmt + \u03c6k(t) + \u03a6k) + b(t) (1)\nwhere Xk is the amplitude of the kth mesh harmonic, fm is the average mesh\nfrequency for the stage considered, ak(t) and \u03c6k(t) are the amplitude and phase\nmodulation functions of mesh harmonic k and \u03a6k is the initial phase of har-\nmonic k. b(t) represents the additive background noise. The phase modulation\nof mesh harmonic k is assumed proportional to that of the mesh fundamental\n\u03c6m(t):\n\u03c6k(t) = k \u03c6m(t) (2)\nThe mesh frequency fm is linked to the two rotation speeds f1 and f2 of the\ngears in mesh by:\nfm = N1f1 = N2f2 (3)\nwhere N1 and N2 are the corresponding number of teeth of the meshing gears.\nFigure 1 presents an example of a mesh frequency with its surrounding first\norder sidebands. Spectral components (mesh and sidebands) are smeared due\nto slight speed fluctuations. In order to extract the instantaneous speed, a\nnarrow-band filter centred at the mesh frequency and with a bandwidth equal\nto 2B is applied. The choice of B will be discussed later on part 2.2. The\nclosest sidebands around the mesh frequency are those of the meshing gear\nwith the lower rotation speed. Since these sidebands are modulated the same\nway as the mesh frequency due to speed fluctuations, the maximum frequency\nfluctuation of the kth mesh harmonic \u03b4fk that causes no overlap is [3]:\n\u03b4fk \u2264 Bmax (4)\n3\nwith Bmax the maximum width of the band-pass filter:\nBmax = min(f1, f2)\/2 =\nfm\n2 max(N1, N2)\n(5)\nThis maximum bandwidth fixes the maximum fluctuation allowed by the\nmethod: since fm = fk k, the maximum allowed relative speed fluctuation\nfor mesh harmonic k is:\n\u03b4fk\nfk\n\u2264 1\n2k max(N1, N2)\n(6)\nEquation (6) shows that the higher the rank of the mesh harmonic k, the lower\nis the maximum allowed speed fluctuation.\nAfter band-pass filtering, the mesh harmonic k is shifted to zero frequency,\nand the phase modulation \u03c6k(t) is extracted from the analytic signal and\nunwrapped. The instantaneous angular position of the shaft is then obtained\nby:\n\u03c6sh(t) =\n\u03c6k(t)\nkNsh\n+ 2pi\nfm\nNsh\nt (7)\nwhere Nsh = N1 or N2 depending on the shaft considered.\nNotes:\n\u2022 In model (1) fm is constant and so we are dealing with limited speed fluc-\ntuation only, especially this model is not appropriate for a ramp speed.\n\u2022 This model is for one stage of the gearbox only. For a multistage gearbox,\nwe then have the choice of the stage to use. This will be discussed later on\nan example (section 4.3).\n\u2022 The transmission path effects (response of the structure) are not taken into\naccount in the model. This can create additional phase modulations due\nto variation of the transmission path phase when the speed is fluctuating,\nas mentioned in [5]. However, if a structural resonance is located near the\ndemodulated mesh component, its effect can be neglected if we assume the\nresonance frequency peak is wide compared to the demodulation bandwidth\n2B. This is equivalent to assuming a damping factor of the resonance large\ncompared to the relative speed fluctuation [6].\n4\n456 458 460 462 464 466 468 470 472\n0\n1\n2\n3\n4\n5\n6\n7\n8\n9\nx 105\nFT\n m\nag\nni\ntu\nde\nFrequency (Hz)\nzoom\nB \nsideband\nnoise level\nestimation\nFig. 1. Narrowband filtering of a mesh component of a gearbox for instantaneous\nspeed estimation by phase demodulation.\n2.2 Phase estimation error\nFor the speed estimation it was advised in [3] to try many different harmon-\nics and to select the best one(s) based on a visual comparison between the\nestimated speeds. However this would not be a viable solution in a real time\nenvironment and we are looking here for an automated choice of the rank\nof the harmonic to use for demodulation. This choice must be performed in\norder to achieve the best angular precision of the recovered instantaneous po-\nsition \u03c6sh(t). Eq. (7) shows that this precision is conditioned by the error on\nthe phase modulation \u03c6k(t) estimated from mesh harmonic k. By writing the\nestimated phase \u03c6\u02c6k(t) as:\n\u03c6\u02c6k(t) = \u03c6k(t) + \u03b4\u03c6k(t) (8)\nwhere \u03b4\u03c6k(t) is the phase error on the estimated phase modulation, the stan-\ndard deviation of the phase error can be expressed as (see appendix A):\n\u03c3[\u03b4\u03c6k] =\n1\u221a\n2\n10\u2212SNRk\/20 (9)\nwhere SNRk represents the local Signal to Noise Ratio (in dB) of mesh har-\nmonic k in the demodulated band of width 2B. This phase error \u03b4\u03c6k(t) then\n5\nyields an error on the angular position of the shaft:\n\u03c3[\u03b4\u03c6sh] =\n\u03c3[\u03b4\u03c6k]\nkNsh\n(10)\nEq. (10) shows that the shaft phase error will be lowered for a gear with a\nhigher number of teeth and also by using a higher rank for the demodulated\nmesh harmonic. However a high rank k is also more restrictive for the max-\nimum speed fluctuation allowed by eq. (6). Therefore care must be taken in\nthe choice of the mesh harmonic.\nIn order to quantify the phase error from eq. (9), the local SNR of the de-\nmodulated mesh harmonic must be estimated. For the sake of simplicity we\nset the band-pass filter width to: B = Bmax (eq. 5). The level of the noise\npower spectral density (PSD) is first estimated at both edges of the band-pass\nfilter, as shown on figure 1. For this estimation we suggest to use a bandwidth\nequal to 10% of the filter half bandwidth B. The noise is then assumed lo-\ncally white inside the filter bandwidth with a level equal to the averaged PSD\nlevels estimated at each edge of the filter. This provides an estimation of the\nnoise power Pb inside the filter bandwidth. Note that for this estimation we\nassume that no \u201dparasite\u201d component is included in the demodulation band\n(this case will be discussed on section 6). The total power Ptot (signal + noise)\nin bandwidth 2B is then estimated by integrating the PSD of the signal over\nthis bandwidth. We thus obtain an estimation of the local SNR for each mesh\nharmonic k by:\n\u02c6SNRk = 10 log\n(\nPtot \u2212 Pb\nPb\n)\n(11)\nThis estimation provides an estimate of the shaft phase error (eq. 9 & 10).\n3 Estimation of the time synchronous averaged signal\n3.1 Definition of the TSA of a shaft\nIn [3] Bonnardot used the speed estimation in order to perform angular re-\nsampling of the signal. Our work is more specifically focused on the estimation\nof the time synchronous average (TSA), from which a number of diagnostic\nmethods can be tackled out. In fact the TSA of a signal is a practical esti-\nmation of the signal average (first order cyclostationarity), which is defined in\n6\nangular domain as:\nmx(\u03b8) = E[x(\u03b8)] = mx(\u03b8 + \u0398) (12)\nwhere \u0398 is the period of the cycle to which the machinery operation is peri-\nodic and E[.] refers to the expectancy (ensemble average). Under the assump-\ntion of cycloergodicity, the ensemble average can be conveniently replaced by\nthe cycle average (TSA) [7]. Note that gearboxes introduce different cycles\nrelated to each individual shaft. In this context signals have been named poly-\ncyclostationary because they are a combination of cyclostationary processes\nwith different basic cycles [7].\n3.2 Angular resampling techniques\nIn order to estimate the TSA, the time signal must be resampled according\nto the angle of rotation: this is known as the angular resampling or order\ntracking technique [8]. Different interpolation techniques have been proposed\nin the literature for resampling based on a tachometer or a shaft encoder [8,9].\nHere this interpolation must be performed by using the shaft angular position\n\u03c6sh(t) estimated from one harmonic of the mesh vibration. In this purpose we\nconsider the two following interpolation methods:\n\u2022 Spline Angular Resampling (SAR): this is the method used in [3]. By using\na 3rd order spline interpolation (cubic spline), this ensures a smooth inter-\npolation function as its first two derivatives are continuous.\n\u2022 Tacho Pulse Recovery (TPR): this is the alternative method proposed here.\nThe tacho pulse instants tp(n), occurring once per revolution, are first re-\ncovered from the estimated shaft position inverse function by:\ntp(n) = \u03c6\n\u22121\nsh (2pin), n = 1, . . . , Ntot (13)\nwhere Ntot is the integer number of shaft revolutions on the total duration\nof the signal. Then, by using Fourier interpolation [10] each shaft period is\nresampled up to a constant number of points between the recovered tacho\ninstants tp(n).\nEstimation of the tacho instants in eq. (13) requires to interpolate Ntot points\non the inverse function of the shaft instantaneous position \u03c6sh(t). This in-\nterpolation is not computationally demanding and moreover can be linear in\npractice since \u03c6sh(t) is slowly varying in time. It is however not the case for\nthe interpolation of the signal versus angle (angular resampling), which is also\nmore computationally demanding.\n7\nFor modelling the phase variations, the SAR method is a smoother interpola-\ntion (3rd order method), whereas the TPR method is piecewise linear. This\ncan introduce some distortions in the resampled signal, however limited as the\nshaft speed is considered slowly varying within the shaft rotation period.\n3.3 Comparison and limitations in the real time computation\nThe angular resampling scheme involves two stages: interpolation of the time\nsignal and resampling according to the angle of rotation. Considering the\nreal time objective of our methodology, the cost in time computation and in\nmemory space is quite different for the two techniques presented in section 3.2\n(TPR and SAR).\nThe TPR method being a piecewise method, each shaft period is resampled\nseparately by using Fourier interpolation (Fourier transform, zero-padding in\nfrequency domain and inverse Fourier transform [10]). Conversely, classical\nB-spline interpolation requires to solve a tridiagonal linear system and then\nto interpolate at least as many samples as in the original time signal (to avoid\naliasing), which can be a highly computationally demanding task. Note that\na running spline interpolator could be used for the online interpolation of the\nsignal, which enjoys a significant computational advantage [11]. However this\nalso needs to address the problem of online estimation of the shaft angular\nposition, i.e. when each new data sample has been recorded.\nIn this paper the application is limited to the processing of a block of N\nsamples of data only after these N samples have been recorded. Therefore,\nthe algorithm is not completely real time as this needs to wait that the whole\nblock duration (say 100s) has been recorded before being processed. However\nsuch a delay is acceptable for the application considered here. Nevertheless,\nthe problem of real time angular resampling without speed sensor for online\napplications still needs to be considered (online tracking and filtering of a\nmesh harmonic, online estimation of the angular position).\nThe two angular resampling techniques will be compared in section 4.4 on a\nreal case.\n3.4 Cut-off order of the estimated TSA\nThe TSA estimation results from the instantaneous phase position of the shaft\nestimated in section 2 and, consequently, will be affected by the shaft phase\nerror, which has been quantified from the local SNR in eq. (10). We aim here\nto quantify the effect of the phase error on the TSA estimation.\n8\nIt is known that errors on the estimated speed fluctuation will induce smearing\nof the higher shaft orders and, due to the averaging process, these higher\norders will be lowered in the resulting TSA signal. The resulting low-pass\nfiltering effect has been quantified in previous works and shown to correspond\nto the Fourier transform of the probability density function of the phase error\n[7,12]. A simple demonstration of this effect is given here in appendix B when\nconsidering only the phase errors of the recovered tacho pulses.\nLet us assume that the density probability function of the shaft phase error\n\u03b4\u03c6sh(t) can be modelled as a Gaussian function (see section 4 for justification),\nwith zero mean and standard deviation \u03c3[\u03b4\u03c6sh] given by eq. (10). This error\nbeing expressed as a phase (in radians), it must be related to the jitter error\nof the recovered tacho pulses on each shaft period, which is: \u03c3[\u03b4\u03c6sh]\/(2pi)\nshaft period. The corresponding low-pass filter (in order domain) will also\nhave a Gaussian shape with a 3dB cut-off order equal to:\n\u221a\nln 2\/\u03c3[\u03b4\u03c6sh] '\n0.83\/\u03c3[\u03b4\u03c6sh]. Thus we define the 3dB cut-off order o\n(k)\nc of the TSA signal\nestimated from mesh harmonic k as:\no(k)c =\n0.83\n\u03c3[\u03b4\u03c6sh]\n= 0.83\n\u221a\n2 k Nsh 10\nSNRk\/20 (orders) (14)\nCut-off order o(k)c represents the maximum \u201dresolution\u201d in terms of shaft orders\nrecovered in the estimated TSA signal, and the ratio o(k)c \/Nsh represents the\nresolution in terms of the number of recovered mesh harmonics. Eq. (14) shows\nthat this ratio depends on two parameters: the rank k and the SNRk of the\nmesh harmonic k selected for speed estimation. Shaft orders above the cut-off\norder are expected to be affected by phase errors and so will be lowered by\nthe averaging process. This effect will be illustrated in next section on a real\ncase.\n4 Real case study\nThe gearbox under study is a two-stage helical reduction gearbox with ratio\n20.5:1 designed by WYKO Fenner UK and here used in a wastewater treat-\nment installation. It is driven by a 1.5kW motor. The output shaft speed is\nabout 70rpm. Fig. 2 shows the gearbox under experiment as well as a sim-\nple schematic of the gear components with their respective number of teeth.\nAn optical pick-up sensor was used as a tachometer for measurement of the\noutput shaft speed. This speed measurement was used in a first instance in\norder to validate the methodology based on TSA. Experimental conditions\nare however not ideal in this outdoor environment for installation of the speed\nsensor. The metallic protection covering the chain driving the paddle system\nhad to be removed, and consequently the reflective tape stuck onto the output\n9\nshaft could be easily moistened and the measurement affected. Thus it would\nbe advantageous for future trials to avoid the need of this speed measurement.\n70rpm\n86 teeth\ngear pinion\n59 teeth\ngear\n13 teeth\npinion\n19 teeth\nmotor\noutput\nFig. 2. Two-stage helical reduction gearbox used in a wastewater treatment site\n(left) and simple schematic (right).\nFig. 3 shows the Power Spectral Density (PSD) in the low frequency part of\nthe vertical acceleration signal measured on the casing near the output bearing\n(see figure 2). The first three harmonics of the output stage mesh (at ' 69Hz)\nare indicated. Some electrical components can be observed at 50 and 100Hz.\nThe strong component at about 30Hz is related to the load (chain driven by\nthe gearbox). Although the highest mesh harmonic is here the second one,\nit appears to be also the noisiest of the three (Tab. 1 lists the local SNR\nestimated for each component).\n4.1 Phase error of the recovered tacho pulses\nThe tachometer signal will be used here as a reference for the comparison\nbetween the recovered tacho pulse instants with the measured ones. The har-\nmonics of the output stage mesh are first band-pass filtered with a band-\nwidth 2B equal to the lowest shaft speed (here the output shaft at 1.2Hz).\nThis bandwidth is chosen in order to allow a maximum speed fluctuation, i.e.\nB = Bmax = 0.6Hz (eq. 5).\nThe estimated and maximum allowed speed fluctuations are shown in table 1\nfor the first three mesh harmonics (for higher harmonics the estimated speed\nfluctuation becomes higher than the allowed one and so may be affected by\nunwrapping errors). Phase demodulation of each one of the mesh harmonics\nyields an estimation of the shaft angular position. Fig. 4 shows the analytic\nsignal obtained after band-pass filtering and demodulation of the first two\nmesh harmonics, performed by selection of the part of the Fourier transform\nand then translation to zero frequency. The second harmonic appears much\nnoisier than the first one here. The tacho instants are then recovered and\n10\n50 100 150 200 250\n\u221250\n\u221240\n\u221230\n\u221220\n\u221210\n0\n10\naveraged Power Spectral Density of acceleration signal\nfrequency (Hz)\ndB\nmesh\n2x mesh\n3x mesh\nFig. 3. Low frequency part of the spectrum of the vertical acceleration measured on\nthe gearbox near the output bearing. The first three harmonics of the output stage\nmesh (' 69Hz) are indicated.\nthe tacho phase errors are computed as the difference between the measured\nand recovered tacho instants (with time origin taken at the first measured\ntacho pulse). The distributions of the tacho errors computed on a 200s signal\nduration (about 230 rotations of the output shaft) are shown on fig. 5 for the\nfirst two mesh harmonics. Note that the Gaussian assumption regarding the\nshape of the error distribution made in section 3.4 seems to be reasonable\nhere.\n\u22120.15 \u22120.1 \u22120.05 0 0.05 0.1 0.15\n\u22120.1\n\u22120.05\n0\n0.05\n0.1\n0.15\nRe\nIm\nmesh1\n\u22121.5 \u22121 \u22120.5 0 0.5 1 1.5\n\u22121.5\n\u22121\n\u22120.5\n0\n0.5\n1\nRe\nIm\nmesh2\nFig. 4. Representation of the demodulated analytic signal in the complex plane\nfrom: first mesh harmonic (left), second mesh harmonic (right).\nThe experimental tacho phase error can now be compared with the phase\nerror standard deviation predicted from the local SNR of the mesh harmonics\n(eq. 9). Results in Tab. 1 show that the standard deviation of the predicted\nphase error is relatively well in accordance with the experimental one for the\nfirst three harmonics of the output stage mesh. This result validates the phase\nerror estimation based on the local SNR of the mesh harmonic.\n11\n\u22120.6 \u22120.4 \u22120.2 0 0.2 0.4 0.6\n0\n10\n20\n30\n40\n50\n60\n70\ndeg\nhi\nst\nog\nra\nm\n a\nm\npl\nitu\nde\ntacho errors\nfrom mesh 1\n\u03c3 =0.07 deg.\n\u22120.6 \u22120.4 \u22120.2 0 0.2 0.4 0.6\n0\n5\n10\n15\n20\n25\n30\ndeg\ntacho errors\nfrom mesh 2\n\u03c3 =0.18 deg.\nFig. 5. Distributions of the tacho phase errors computed as the difference between\nthe measured (from tachometer) and recovered tacho pulse instants from phase\ndemodulation of the output stage mesh: first harmonic (left) and second harmonic\n(right).\nTable 1\nLocal SNR and speed fluctuation estimated for each mesh components and com-\nparison of the predicted and measured phase errors for the output shaft.\noutput stage input stage\nMesh harmonic demodulated 1st 2nd 3rd 1st\nestimated local SNR (dB) 22 7 13 17\ncut-off order of the TSA 970 320 920 3220\nestimated speed fluctuation (%) 0.19 0.38 0.23 0.31\nmaximum allowed fluctuation (%) 0.85 0.42 0.28 0.58\nOutput shaft phase error (std dev. in degree)\npredicted from local SNR 0.048 0.145 0.051 0.015\nmeasured from tacho signal 0.068 0.166 0.096 0.057\n4.2 Comparison of the estimated TSA\nThe TSA signal is now computed for the three mesh harmonics of the output\nstage after resampling by using the TPR interpolation method (section 3.2).\nThe TSA is affected by the phase error by a low-pass filter which 3dB cut-\noff order, defined by eq. (14) in section 3.4, is inversely proportional to the\nphase error standard deviation. Fig. 6 compares the spectra of the TSA signals\n(obtained by Fourier transform of the TSA) estimated from tacho signal and\nthe first two mesh harmonics. Although the two TSA spectra for tacho and\nmesh fundamental appear very similar, the low-pass filtering effect is clearly\nobserved when using 2nd mesh harmonic (due to a lower local SNR of this\ncomponent): on this spectrum the higher mesh harmonics (rounds) are low-\n12\n0 500 1000 1500 2000 2500\n\u221260\n\u221240\n\u221220\n0\ndB\norders\n(a)  tacho\n0 500 1000 1500 2000 2500\n\u221260\n\u221240\n\u221220\n0\norders\ndB\n(b)  mesh1\n0 500 1000 1500 2000 2500\n\u221260\n\u221240\n\u221220\n0\norders\ndB\n(c)  mesh2\nFig. 6. Comparison of order spectra of the output shaft TSA estimates: (a) from\ntacho signal, (b) from mesh fundamental (cut-off order o\n(1)\nc = 970) and (c) from\nmesh 2nd harmonic of output stage (o\n(2)\nc = 320). The rounds indicate the output\nstage mesh harmonics (59 multiple orders).\nered compared to the other two spectra. The cut-off order estimated for 2nd\nharmonic (320) seems in accordance with the low-pass filtering effect observed\non the spectrum.\n4.3 Use of the input stage mesh\nThe speed estimation can also be performed by using the input stage mesh\nbetween the motor and inner shafts of the gearbox, running at about 450Hz\n(see fig. 2). In this case however only the mesh fundamental can be used since\nfrom second harmonic the estimated speed fluctuation becomes higher than\nthe maximum allowed one by eq. (6).\n4.3.1 for estimating the output shaft TSA\nIn this case, in order to recover the output shaft angular position \u03c6out(t), the\nphase modulation of the input mesh fundamental is first divided by the number\nof teeth of the inner shaft gear (86), which provides the instantaneous angular\nposition of this shaft: \u03c6in(t), and then further divided by the gear ratio R of\nthe output stage (R = 59\/13 ' 4.54). As a consequence the phase error of the\noutput shaft should in theory be R times lower than that of the inner shaft.\n13\nThe phase error standard deviation estimated from the local SNR of the input\nmesh frequency is 0.068deg. for the inner shaft, which gives an theoretical error\nof 0.015deg. for the output shaft. However, the experimental error obtained\nby comparison of the recovered tacho pulses with those of the measured tacho\nsignal is almost 4 times higher (see table 1). This brings to the conclusion\nthat the phase error of one shaft cannot simply be divided by the gear ratio\nof the stage to estimate the phase error on the other shaft. This is likely to\nbe due to the transmission errors in the meshing process (static transmission\nerror, tooth deflection, torsional vibrations of the shafts) which are not taken\ninto account here in the model. A better estimation of the output phase error\nwould require further modelling of these effects, which is out of the scope of\nthis paper. However the experimental phase error obtained from the input\nstage is still lower than that of the output stage, whatever harmonics. This\ncomes from the fact that we use a higher frequency component, so that the\nphase errors in the transmission are compensated by a better accuracy of the\ndemodulated phase.\n4.3.2 for estimating the inner shaft TSA\nFor estimation of the inner shaft angular position and TSA, the input stage is\nmore advantageous than the output stage (in the case of a reduction gearbox).\nBy using the output stage the phase error for this shaft is 0.24deg. (with 1st\nharmonic), corresponding to a cut-off order of about 200, whereas by using\nthe input stage the error is reduced to 0.068deg. (690 orders). The effect on\nthe TSA signal can be observed on figure 7: the spectrum contains higher\nfrequency components when using the input stage compared with the output\nstage. The low-pass filtering effect can also be observed on the TSA signal.\nThis difference in phase error is mainly due to rather different number of teeth\nof the inner shaft gears at the input and output stages (86 and 13 respectively).\nThus when two wheels are connected to a same shaft, the one with the higher\nnumber of teeth, i.e. with the higher mesh frequency, should be preferred\n(similarly to a shaft encoder).\nIn conclusion, the use of the input stage mesh performs well for both the\noutput and inner shafts. It is also obviously preferable to use for the TSA\nof the motor shaft. However the maximum allowed speed fluctuation is lower\nhere because the input stage gear has a higher number of teeth than the one\nat the output stage (see table 1).\n14\n5 10 15 20 25\n\u22125\n0\n5\n10\nangle (deg)\nTime Synchronous Average of inner shaft\na\nm\npl\nitu\nde\n100 200 300 400 500 600 700 800\n\u221260\n\u221240\n\u221220\n0\ndB\n S\npe\nct\nru\nm\norders\n \n \ninput stage 1st mesh\noutput stage 1st mesh\nFig. 7. Estimated TSA signals for the inner shaft of the gearbox (500 averages)\nwith speed estimated from the input stage mesh (thin curve) and output stage\nmesh (thick curve).\n4.4 Comparison of the Tacho Pulse Recovery and Spline interpolation meth-\nods\nThe TSA signals in previous sections were estimated by using the Tacho Pulse\nRecovery (TPR) method presented in section 3.2. In this section we compare\nresults when using the Spline Angular Resampling (SAR) method [3]. Fig. 8\nshows the interpolated tacho pulses of the TPR method on the estimated shaft\nphase fluctuation. Although this method assumes a piecewise linear model of\nthe phase fluctuation, the difference between the model and the real phase fluc-\ntuation remains small because the estimated phase is slowly varying, so that\nwe can expect the TSA signal not to be too affected by this approximation.\n4.4.1 in the rate of convergence of the TSA\nIn order to compare the TSA signals for both interpolation methods, we ob-\nserve how the TSA energy decreases versus the number of averages n. For a\npurely random signal, the energy decreases as 1\/n, thus forming a straight line\nin a log-log diagram. For a gearbox signal the situation is more complex since\nthe decrease is not as regular due to interferences from other shaft compo-\nnents [13]. However when all random and non-synchronous components have\nbeen averaged out the TSA energy should stop decreasing and converge to a\nconstant value, ideally represented by a horizontal line in the diagram (note\nthat this method could be an empirical way to estimate the required minimum\n15\n20 25 30 35\n0.095\n0.1\n0.105\n0.11\n0.115\nsec\nph\nas\ne \n(ra\nd)\n \n \nestimated phase fluctuation\ninterpolated tacho instants\nFig. 8. Estimated shaft phase fluctuation and recovered tacho pulse instants.\nnumber of averages, but this is not further developed here).\nFig. 9 shows the decrease of the output shaft TSA energy versus n for both\ninterpolation methods when using the output stage mesh fundamental. On the\nleft figure the convergence is assessed to be reached at about 100 averages and\nthe final value is almost identical for both methods (0.03dB difference). On the\nright figure the signal has first been low-pass filtered with a cut-off frequency\ncorresponding to the estimated cut-off order for this mesh component (970\norders). In this case no significant difference appears between the two methods.\nNote the convergence seems faster with prior low-pass filtering: this is due to\nthe fact that orders higher than the cut-off order are affected by the phase\nerror (the remaining jitter effect) so that their amplitudes in the TSA are\nslowly decreasing with the averaging process.\n4.4.2 in the computation time\nWe now compare in table 2 the computation time for both methods. As ex-\npected in section 3.3 the SAR method appears to be more demanding in time\nand in memory space than the TPR method. Indeed for a long signal duration\n(300s) the usual spline resampling function running under Matlab on a stan-\ndard PC could not be computed due to a memory error, whereas for the TPR\nmethod the computation time remains small and increases in a more linear\nfashion. Therefore we argue that the TPR method should be preferred in a\nreal time environment due to its gain in simplicity and in computation cost\nand its efficiency.\n16\n100 101 102\n\u221210\n\u22129\n\u22128\n\u22127\n\u22126\n\u22125\n\u22124\n\u22123\n\u22122\n\u22121\nTS\nA \nen\ner\ngy\n (d\nB)\nnumber of averaged periods\n \n \ntacho recovery\nspline resampling\n100 101 102\n\u22124\n\u22123.5\n\u22123\n\u22122.5\n\u22122\n\u22121.5\n\u22121\n\u22120.5\nTS\nA \nen\ner\ngy\n (d\nB)\nnumber of averaged periods\n \n \ntacho recovery\nspline resampling\nFig. 9. Decrease of the output shaft TSA energy versus the number of averages for\nthe tacho recovery and spline resampling interpolation methods: full range frequency\nspectrum (left), range limited to cut-off order 970 (right). No significant difference\nappears in the TSA energy rate of convergence between the two methods.\nTable 2\nComputation time of the output shaft TSA for both interpolation methods and for\ndifferent signal lengths (100s representing 1125000 samples or 118 shaft rotations).\nPrograms are running under Matlab on a PC with 3GHz clock speed and 1Go\nmemory.\nInterpolation method signal duration: 100s 200s 300s\nTacho Pulse Recovery computation time: 3s 4s 5s\nSpline Angular Resampling 8s 40s pb memory\n5 Proposed methodology for estimation of the time synchronous\naverage without speed sensor\nBased on the previous theoretical developments and experimental study we\nnow propose a complete methodology for the estimation of the TSA signal of\na particular shaft in a gearbox by speed estimation from the mesh vibration.\nFigure 10 presents the flow chart of the proposed methodology. Each step is\nnow detailed in the following.\nThe method first requires an a priori value of the shaft speed and the number\nof teeth of the two gears in mesh at the considered stage. The mesh frequency\nis then adjusted to its actual value by a peak detection performed on the\nsignal spectrum in a certain frequency range around the a priori mesh fre-\nquency (eg. \u00b15%). In order to avoid spurious maxima, the spectrum is first\nsmoothed by convolution with a narrow window (we used a Parzen window\nwith a 9 frequency bin width). Also, for a better robustness in the detection,\nwe recommend to use several mesh harmonics by accumulating the spectrum\namplitudes at multiples of the search frequency (eg. 3 harmonics).\n17\nThe next step is to estimate the local SNRs for a set of mesh harmonics (eq.\n11). The filter half bandwidth is set to half the slowest gear speed in order to\nallow maximum speed fluctuation (eq. 5). The cut-off order for each harmonic\nis then computed via eq. (14). The selected harmonic at this stage will be that\nwith the highest cut-off order for the TSA signal (or with the lowest phase\nerror of the estimated speed). We performed this selection among the five first\nharmonics only since higher harmonics generally have a lower SNR.\nThe previously selected harmonic is then demodulated and the shaft angular\nposition is estimated (eq. 7). Before angular resampling, a test is performed\non the estimated speed: the peak-to-peak speed fluctuation must be lower\nthan the maximum allowed one (eq. 6). If this is not the case it means the\nestimated speed is not accurately estimated (unwrapping problems may have\noccurred) and a lower rank harmonic is selected and then again demodulated.\nThis scheme is performed as long as the speed test is not satisfied. If even the\nfirst harmonic does not pass the test it means the speed fluctuation are too\nhigh for the method to perform. In that case the use of another stage can be\nconsidered.\nOnce the shaft instantaneous position has been estimated, the tacho pulse\ninstants are recovered and each rotation period is resampled up to a constant\nnumber of samples (which must be higher than the highest number of samples\nper period in order to avoid aliasing). The average of all resampled shaft\nperiods provides the TSA signal for the considered shaft.\nIt should be noted that the proposed methodology applies for one stage of the\ngearbox only. The choice of the stage will depend on the application consid-\nered: if we are interested in monitoring the output gear only then the output\nstage should be preferred since we have here a higher allowed speed fluctua-\ntion and also a good agreement between the experimental and predicted phase\nerrors (Tab. 1). However if all gears need to be monitored in the gearbox then\nall TSA signals of all shafts need to be estimated. In that case the input stage\nshould be preferred as shown in section 4.3. It is even possible to perform\nonly one angular resampling and then to estimate the TSA of each shaft by\nextracting the appropriate components in frequency domain [7].\n6 Discussion\nA particular problem mentioned in [3] can arise when a \u201dparasite\u201d component\nis included in the demodulation bandwidth of a particular mesh harmonic.\nThe effect of the parasite component will be first to decrease the local SNR\nand so to lower the cut-off order for this harmonic, and second to create an\nadditional strong fluctuation in the estimated speed, so that it is likely that\n18\nset of harmonics (~5)\nyes\nno\nspeed fluctuation < max allowed?\nselect a lower rank harmonic\nPeak detection of mesh frequency on spectrum\nEstimation of the local SNR and cut\u2212off order\nfor each mesh harmonic and selection of\nharmonic with the highest cut\u2212off order\nDemodulation of the selected mesh harmonic\nand estimation of the shaft angular position \nTacho instants estimation and resampling\nnumber of samples per rotation\nof each shaft rotation period to a constant \nTime Synchronous Average\na priori shaft speed\nvibration signal\nnumber of teeth of the gears\nsearch bandwidth (+\/\u22125% of\naveraging of all shaft rotation periods\na priori value)\nfilter bandwith set to max.  \nallowed (half shaft speed)\nuse of several harmonics (~3)\nFig. 10. Methodology for estimation of the TSA of a particular shaft in a gearbox\nwithout speed sensor.\nthe mesh harmonic will not pass the speed fluctuation test in that case.\nTable 3\nSelection of input stage mesh harmonic for estimating the inner shaft TSA. The\nthird harmonic is here selected (highest cut-off order). The SNR of first harmonic\nis low here due to a parasite component close to this mesh.\nmesh harmonic 1 2 3 4 5\nlocal SNR (dB) -1.4 13.5 13.9 1.1 8.9\ncut-off order 84 938 1478 448 1376\nTable 3 presents an interesting case when estimating the inner shaft TSA for a\ndifferent type of load coupled to the same gearbox. In this case the input stage\nis used and the mesh frequency is estimated at 452.5Hz after peak detection.\n19\n0 50 100 150 200 250 300 350\n\u22125\n0\n5\nangle (deg)\nTSA (840 gear rotations)\na\nm\npl\nitu\nde\n0 50 100 150 200 250 300 350\n\u22125\n0\n5\nangle (deg)\na\nm\npl\nitu\nde\ntacho\nmesh2\nFig. 11. Estimated TSA from tachometer (top) and from mesh second harmonic\n(bottom) for a spur gearbox with a simulated 10% surface pitting on one tooth of\nthe gear. A time shift appears between the two TSA as the zero angle position is\nundetermined when using the proposed method for speed recovery.\nThe filter half bandwidth is set to Bmax = 2.7Hz (inner shaft speed is 5.4Hz).\nThe local SNRs and the cut-off orders are estimated for the first five mesh\nharmonics (see table 3). The third harmonic is here selected due to its highest\ncut-off order. Note that the first harmonic SNR is abnormally low here: an\ninspection of the spectrum reveals an electrical component at 450Hz which is\ninside the demodulation bandwidth of this harmonic. This parasite component\nis the reason for this low SNR. The estimated speed fluctuation for the third\nharmonic is 0.11% (0.19% max.). By using first harmonic it would have been\n0.33% due to the parasite, which is however still in the allowed range (0.58%).\nThus in this particular case the parasite is discarded by the SNR estimation\nrather than by the test on the speed fluctuation.\nThe proposed methodology has also been tested with success on other types of\nindustrial gearboxes, especially with spur gears. However the helical gearbox\npresented here was a more difficult case since the mesh harmonics were found\nto be lower than that of the spur gears. The tested gearboxes being used under\nrelatively steady loading conditions, we have not found so far cases where the\nspeed fluctuation limitation prevented the method to perform. It should be\nmentioned however that one drawback of the method is that, contrary to a\ntachometer, we have obviously no more angular reference available here for\nthe localisation of a fault on the gear, as shown on figure 11.\n20\n7 Conclusion\nThe purpose of this paper was to extend the original idea proposed in [3] for\nangular resampling by using the mesh vibration of a gearbox and to propose\na general methodology that could be used as an automated scheme for condi-\ntion monitoring of gear systems without the need of a speed sensor. First the\nangular precision of the shaft has been quantified by the phase error standard\ndeviation, which is related to the local signal\/noise ratio (SNR) of the demod-\nulated mesh harmonic. By assuming a normal distribution of the phase error,\nthe corresponding low-pass filtering effect on the TSA can be quantified by\nits 3dB cut-off order, which depends on both the rank and the local SNR of\nthe selected mesh harmonic. Comparison on a real case shows good agreement\nbetween the predicted and measured (from a tachometer) phase errors of the\nestimated shaft angular position, and the filtering effect on the TSA signal\nhas also been observed for some mesh harmonics. Furthermore an alternative\nmethod for angular resampling of the signal from the estimated speed has\nbeen proposed: the Tacho Pulse instants Recovery. This method showed no\nsignificant difference compared to the spline interpolation method. Its advan-\ntage is to be much less demanding in computation time and in memory space,\nespecially for relatively long signal duration, and is thus better adapted to real\ntime applications. Finally a methodology has been proposed for estimation of\nthe TSA without speed sensor, which requires only an a priori estimation of\nthe shaft speed and the number of teeth of the meshing gears. The choice\nof the stage to use has been discussed and will generally depend on the ap-\nplication considered. The proposed methodology forms an automated scheme\nwhich could be easily implemented and can be useful for condition monitoring\napplications where speed measurement is not advisable due to difficult envi-\nronmental conditions. One drawback of the method is obviously that no more\nangular reference is available for the TSA for the localisation of a fault on the\ngear.\nAcknowledgements\nThis work is a part of a project funded by the DTI (UK). The authors grate-\nfully acknowledge the financial support of the DTI, grant STI\/6\/037. We also\ngratefully thank industrial partners for their in-kind support: WYKO (Mr.\nOhren, Mr. Patel), Severn Trent Water (Mr. Stanley), and Compact Orbital\nGears (Mr. LaPayne, Mr. Huges).\n21\nXk\u03b4\n\u03d5\n\u03b2\nx\nIm\nRe\nB\n~\nFig. A.1. Representation of the analytic signal in the complex plane and of the phase\nerror \u03b4.\nA Relation between phase error and local SNR in the demodula-\ntion band\nThe signal from model (1) after band-pass filtering of mesh harmonic k and\nfrequency shift to zero is written\nx(t) = Xk cos \u03d5k(t) + b(t) (A.1)\nwhere \u03d5k(t) = \u03c6k(t) + \u03a6k is the phase modulation to be recovered and b(t) is\nthe noise present in the filter bandwidth, assumed zero mean and with variance\n\u03c32b . After applying the Hilbert transform, we obtain the analytic signal:\nx\u02dc = Xke\nj\u03d5k + Bej\u03b2 (A.2)\nwith j2 = \u22121, the time dependency being omitted here. In eq. (A.2) Xk is\na constant, \u03d5k is a deterministic function of time, B and \u03b2 are random and\nrepresent the analytic function of noise b(t) (so that b = B cos \u03b2). By assuming\n\u03b2 uniformly distributed in interval [\u2212pi, pi] the variance of noise b is\n\u03c32b = E[|B cos \u03b2|2] = \u03c32B\/2 (A.3)\nThe signal to noise ratio (SNR) in dB of demodulated signal x is written\nSNR = 10 log\nX2k\/2\n\u03c32b\n= 20 log\nXk\n\u03c3B\n(A.4)\nThe analytic signal x\u02dc is represented as a vector in the complex plane on figure\nA.1. At one given instant t, the effect of the additive noise of amplitude B will\n22\nbe to create a phase error \u03b4 on the estimated phase \u03d5. The resulting position\nof the analytic signal is located on a circle of radius B, all points on this circle\nbeing equiprobable since angle \u03b2 is assumed randomly distributed. From this\nfigure we can write the trigonometric relation:\ntan \u03b4 =\nB sin \u03b2\nXk + B cos \u03b2\n(A.5)\nBy assuming a relatively good SNR, the noise amplitude B remains small\ncompared to Xk, so that (A.5) can be simplified by\ntan \u03b4 ' \u03b4 ' B sin \u03b2\nXk\n(A.6)\nThe mean phase error of \u03b4 is zero. The variance is\n\u03c3[\u03b4]2 =\nE[B2 sin2 \u03b2]\nX2k\n=\n\u03c32B\n2X2k\n(A.7)\nsince E[sin2 \u03b2] = 1\/2. Thus the phase error standard deviation is related to\nthe local SNR at mesh harmonic k by\n\u03c3[\u03b4] =\n1\u221a\n2\n10\u2212SNR\/20 (A.8)\nB Effect of the tacho phase error on the time synchronous average\nDue to the phase error of the shaft angular position estimation, the tacho\npulse instant at rotation i is estimated with an jitter error \u000fi. After angular\nresampling, the shaft ith rotation period xi(t) can be written\nxi(t) = s(t\u2212 \u000fi) + bi(t) (B.1)\nwhere s(t) is the deterministic part of the signal which is periodic with the ro-\ntation period of interest and b(t) represents the random and non-synchronous\nsources. The \u201dideal\u201d time synchronous averaged (TSA) signal, i.e. after suffi-\ncient number of averaging, is\nmx(t) = E[xi(t)] = E[s(t\u2212 \u000fi)] (B.2)\nThe TSA being exactly periodic, its spectrum (orders) is simply computed by\na Fourier transform. Assuming commutativity with expectancy (linear opera-\n23\ntors) we get:\nMx(f) = FT{mx(t)} = E[S(f) e\u2212j2pif\u000fi] (B.3)\nwhere S(f) = FT{s(t)} is deterministic. By denoting p(\u000fi) the probability\ndensity function of random variable \u000fi, we obtain:\nMx(f) = S(f).E[e\n\u2212j2pif\u000fi] = S(f).\n\u222b\ne\u2212j2pif\u000fip(\u000fi)d\u000fi = S(f).\u03a6(f) (B.4)\nwhere \u03a6(f) represents the Fourier transform of p(\u000fi), which acts as a low-pass\nfilter on the TSA spectrum. The narrower is p(\u000fi) (the lower is the phase\nerror), the higher is the cut-off frequency (or cut-off order) of filter \u03a6(f) and\nthe more orders of signal s(t) can be recovered in the TSA.\nReferences\n[1] S. Braun, Acustica Vol. 32 (1975) 69-77. The extraction of periodic waveforms\nby time domain averaging.\n[2] P.D. McFadden, Mechanical Systems and Signal Processing 1 (1) (1987) 83-95. A\nrevised model for the extraction of periodic waveforms by time-domain averaging.\n[3] F. Bonnardot, M. El Badaoui, R.B. Randall, J. Danie`re, F. Guillet, Mechanical\nSystems and Signal Processing 19 (2005) 766-785. Use of the acceleration signal of\na gearbox in order to perform angular resampling (with limited speed fluctuation).\n[4] P.D. McFadden, Journal of Vibration, Acoustics, Stress, and Reliability in Design\n108 (1986), 165-170. Detecting fatigue cracks in gears by amplitude and phase\ndemodulation of the meshing vibration.\n[5] C.J. Stander, P.S. Heyns, Mechanical Systems and Signal Processing 20 (2006)\n1511-1522. Transmission path phase compensation for gear monitoring under\nfluctuating load conditions.\n[6] F. Combet, P. Jaussaud, N. Martin, Mechanical Systems and Signal Processing\n19 (2005) 239-257. Estimation of slight speed gaps between signals via the scale\ntransform.\n[7] J. Antoni, F. Bonnardot, A. Raad, M. El Badaoui, Mechanical Systems and\nSignal Processing 18 (2004) 1285-1314. Cyclostationary modelling of rotating\nmachine vibration signals.\n[8] K.R. Fyfe and D.S. Munck, Mechanical Systems and Signal Processing 11 (2)\n(1997) 187-205. Analysis of computed order tracking.\n[9] P.D. McFadden, Mechanical Systems and Signal Processing 3 (1) (1989) 87-97.\nInterpolation techniques for time domain averaging of gear vibration.\n24\n[10] F. Candocia, J.C. Principe, IEEE Transactions on Signal Processing 45 (7)\n(1998) 2044-2047. Comments on sinc interpolation of discrete periodic signals.\n[11] T.J. Lim, M.D. Macleod, IEEE Signal Processing Letters 3 (5) May 1996, 144-\n146. On-line interpolation using spline functions.\n[12] R.B. Randall, J. Antoni, S. Chobsaard, Mechanical Systems and Signal\nProcessing 15 (5) (2001) 945-962. The relationship between spectral correlation\nand envelope analysis in the diagnostics of bearing faults and other cyclostationary\nmachine signals.\n[13] B.D. Forrester, Advanced Vibration Analysis Techniques for Fault Detection and\nDiagnosis in Geared Transmission Systems, Ph.D dissertation (1996), Swinburne\nUniversity of Technology, Melbourne, Australia.\n25\n"}