{"doi":"10.1198\/jasa.2009.0009","coreId":"69539","oai":"oai:eprints.lancs.ac.uk:26253","identifiers":["oai:eprints.lancs.ac.uk:26253","10.1198\/jasa.2009.0009"],"title":"Bayesian Analysis of Isochores.","authors":["Fearnhead, Paul","Vasilieou, Despina"],"enrichments":{"references":[{"id":1017174,"title":"A Bayesian analysis for change point problems.","authors":[],"date":"1993","doi":null,"raw":null,"cites":null},{"id":1022853,"title":"A fine-scale map of recombination rates and hotspots across the human genome.","authors":[],"date":"2005","doi":null,"raw":null,"cites":null},{"id":1021784,"title":"A high-resolution recombination map of the human genome.","authors":[],"date":"2002","doi":null,"raw":null,"cites":null},{"id":1017444,"title":"A maximisation technique occurring in the statistical analysis of probabilistic functions of Markov chains.","authors":[],"date":"1970","doi":null,"raw":null,"cites":null},{"id":1018762,"title":"A simple and species-independent coding measure.","authors":[],"date":"2002","doi":null,"raw":null,"cites":null},{"id":1019407,"title":"An isochore map of human chromosomes.","authors":[],"date":"2006","doi":null,"raw":null,"cites":null},{"id":1022141,"title":"Applications of recursive segmentation to the analysis of DNA sequences.","authors":[],"date":"2002","doi":null,"raw":null,"cites":null},{"id":1023086,"title":"Assessment of compositional heterogeneity within and between eukaryotic genomes.","authors":[],"date":"2000","doi":null,"raw":null,"cites":null},{"id":1022109,"title":"Autoregressive models with piecewise constant volatility and regression parameters. Statistica Sinica,","authors":[],"date":"2005","doi":null,"raw":null,"cites":null},{"id":1020725,"title":"Bayesian analysis of Markov modulated Poisson processes.","authors":[],"date":"2006","doi":null,"raw":null,"cites":null},{"id":1022696,"title":"Bayesian inference on biopolymer models.","authors":[],"date":"1999","doi":null,"raw":null,"cites":null},{"id":1017587,"title":"Compositional segmentation and long-range fractal correlations in dna sequences. Physical Review E,","authors":[],"date":"1996","doi":null,"raw":null,"cites":null},{"id":1020343,"title":"Computational methods for complex stochastic systems: A review of some alternatives to MCMC.","authors":[],"date":"2008","doi":null,"raw":null,"cites":null},{"id":1021249,"title":"Covariation in frequencies of substitution, deletion, transposition, and recombination during eutherian evolution.","authors":[],"date":"2003","doi":null,"raw":null,"cites":null},{"id":1018149,"title":"Detecting homogeneous segments in DNA sequences by using hidden Markov models.","authors":[],"date":"2000","doi":null,"raw":null,"cites":null},{"id":1024250,"title":"Estimation of a noisy discrete-time step function: Bayes and empirical Bayes approaches. The Annals of Statistics,","authors":[],"date":"1984","doi":"10.1214\/aos\/1176346802","raw":null,"cites":null},{"id":1020207,"title":"Exact and efficient inference for multiple changepoint problems.","authors":[],"date":"2006","doi":null,"raw":null,"cites":null},{"id":1019948,"title":"Exact Bayesian curve fitting and signal segmentation.","authors":[],"date":"2005","doi":null,"raw":null,"cites":null},{"id":1019054,"title":"GC composition of the human genome: In search of isochores. Molecular Biology and Evolution,","authors":[],"date":"2005","doi":null,"raw":null,"cites":null},{"id":1020984,"title":"GC-content evolution in mammalian genomes: The biased gene conversion hypothesis.","authors":[],"date":"2001","doi":null,"raw":null,"cites":null},{"id":1023611,"title":"Genome segmentation using piecewise constant intensity models and reversible jump MCMC. Bioinformatics,","authors":[],"date":"2002","doi":null,"raw":null,"cites":null},{"id":1021517,"title":"Initial sequencing and analysis of the human genome.","authors":[],"date":null,"doi":null,"raw":null,"cites":null},{"id":1017879,"title":"Isochores and evolutionary genomics of vertebrates.","authors":[],"date":"2000","doi":null,"raw":null,"cites":null},{"id":1023339,"title":"IsoFinder: computational prediction of isochores in genome sequences.","authors":[],"date":"2004","doi":null,"raw":null,"cites":null},{"id":1018400,"title":"Multiple changepoint fitting via quasilikelihood, with application to DNA sequence segmentation.","authors":[],"date":"2000","doi":null,"raw":null,"cites":null},{"id":1020468,"title":"Online inference for multiple changepoint problems.","authors":[],"date":"2007","doi":null,"raw":null,"cites":null},{"id":1017055,"title":"Product partition models for change point problems. The Annals of Statistics,","authors":[],"date":"1992","doi":null,"raw":null,"cites":null},{"id":1023701,"title":"Regional similarities in polymorphism in the human genome extended for many megabases. Trends in Genetics,","authors":[],"date":"2002","doi":null,"raw":null,"cites":null},{"id":1022415,"title":"Rejection control and sequential importance sampling.","authors":[],"date":"1998","doi":null,"raw":null,"cites":null},{"id":1018460,"title":"Statistical methods for DNA sequence segmentation.","authors":[],"date":"1998","doi":null,"raw":null,"cites":null},{"id":1019683,"title":"The evolution of isochores.","authors":[],"date":"2001","doi":null,"raw":null,"cites":null},{"id":1023910,"title":"The influence of recombination on human genetic diversity. Plos Genetics,","authors":[],"date":"2006","doi":"10.1371\/journal.pgen.0020148","raw":null,"cites":null},{"id":1023986,"title":"The sequence of the human genome.","authors":[],"date":"2001","doi":null,"raw":null,"cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2009-03-01","abstract":"Statistical identification of isochore structure, the variation in large-scale GC composition (proportion of DNA bases that are G or C as opposed to A or T), of mammalian genomes is a necessary requirement for understanding both the evolution of base composition and the many genomic features such as mutation and recombination rates, which covary with base composition. We have developed a Bayesian method for isochore analysis that we demonstrate to be more accurate than the commonly used binary segmentation approach implemented within the program IsoFinder. The method accounts for both fine-scale and large-scale structure. We adapt direct simulation methods to allow for iid samples from the posterior distribution of our model, and provide an accurate approximation to this that can analyze data from a chromosome in a matter of seconds. We apply our method to human chromosome 1. The resulting estimate of how GC content varies across this region is shown to be a better predictor of local recombination rates than IsoFinder, and we are able to detect regions consistent with the classic definition of isochores that cover 85% of the chromosome. We also show a measure of relative GC content to be particularly predictive of local recombination rates","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/69539.pdf","fullTextIdentifier":"http:\/\/eprints.lancs.ac.uk\/26253\/1\/Isochorejasa.pdf","pdfHashValue":"f072fb180a28e561887b3837570d5d6ec54a08f4","publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lancs.ac.uk:26253<\/identifier><datestamp>\n      2018-01-24T02:47:48Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D51:5141<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        Bayesian Analysis of Isochores.<\/dc:title><dc:creator>\n        Fearnhead, Paul<\/dc:creator><dc:creator>\n        Vasilieou, Despina<\/dc:creator><dc:subject>\n        QA Mathematics<\/dc:subject><dc:description>\n        Statistical identification of isochore structure, the variation in large-scale GC composition (proportion of DNA bases that are G or C as opposed to A or T), of mammalian genomes is a necessary requirement for understanding both the evolution of base composition and the many genomic features such as mutation and recombination rates, which covary with base composition. We have developed a Bayesian method for isochore analysis that we demonstrate to be more accurate than the commonly used binary segmentation approach implemented within the program IsoFinder. The method accounts for both fine-scale and large-scale structure. We adapt direct simulation methods to allow for iid samples from the posterior distribution of our model, and provide an accurate approximation to this that can analyze data from a chromosome in a matter of seconds. We apply our method to human chromosome 1. The resulting estimate of how GC content varies across this region is shown to be a better predictor of local recombination rates than IsoFinder, and we are able to detect regions consistent with the classic definition of isochores that cover 85% of the chromosome. We also show a measure of relative GC content to be particularly predictive of local recombination rates.<\/dc:description><dc:date>\n        2009-03-01<\/dc:date><dc:type>\n        Journal Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/eprints.lancs.ac.uk\/26253\/1\/Isochorejasa.pdf<\/dc:identifier><dc:relation>\n        http:\/\/dx.doi.org\/10.1198\/jasa.2009.0009<\/dc:relation><dc:identifier>\n        Fearnhead, Paul and Vasilieou, Despina (2009) Bayesian Analysis of Isochores. Journal of the American Statistical Association, 485. pp. 132-141. ISSN 1537-274X<\/dc:identifier><dc:relation>\n        http:\/\/eprints.lancs.ac.uk\/26253\/<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/dx.doi.org\/10.1198\/jasa.2009.0009","http:\/\/eprints.lancs.ac.uk\/26253\/"],"year":2009,"topics":["QA Mathematics"],"subject":["Journal Article","PeerReviewed"],"fullText":"Bayesian Analysis of Isochores\nPaul Fearnhead and Despina Vasileiou\nDepartment of Mathematics and Statistics, Lancaster University, UK\nAbstract\nThe statistical identification of isochore structure, the variation in large scale GC\ncomposition, of mammalian genomes is a necessary requirement for understand-\ning both the evolution of base composition and the many genomic features such\nas mutation and recombination rates which covary with base composition. We\nhave developed a Bayesian method for isochore analysis, which we demonstrate to\nbe more accurate than the commonly used binary segmentation approach imple-\nmented within the program IsoFinder. The method accounts for both fine-scale\nand large-scale structure. We adapt direct simulation methods to allow for iid\nsamples from the posterior distribution of our model, and provide an accurate\napproximation to this which can analyse data from a chromosome in a matter of\nseconds. We apply our method to human Chromosome 1. The resulting estimate\nof how GC content varies across this region is shown to be a better predictor of\nlocal recombination rates than IsoFinder; and we are able to detect regions con-\nsistent with the classical definition of isochores that cover 85% of the chromosome.\nWe also show a measure of relative GC content to be particularly predictive of\nlocal recombination rates.\n1\nKeywords: Changepoint; GC Content; Direct Simulation; Hidden Markov\nModel; Recombination\n1 Background\nThe genomes of many eukaryotes display striking large scale heterogeneity in\nbase composition along their chromosomes. In particular, the distribution of\nG+C content (hereafter GC) along the chromosomes of mammals is highly\nvariable (Bernardi 2000; Eyre-Walker and Hurst 2001). Initial analysis of these\ncompositional patterns was performed using centrifugation experiments, which\nappeared to show discrete classes of different GC content. These results lead to\nthe isochore model for the genomes of warm-blooded vertebrates: such genomes\nwere thought to consist of a mosaic of isochores, defined as regions longer than\n300 kilobases (kb) within which base composition is homogenous, and which\nbelong to a number of distinct families differing greatly in GC abundance\n(Bernardi, 2000). The recent sequencing of many complete vertebrate genomes\nhas led to the re-evaluation of the isochore model using in silico analyses\n(IHGSC, 2001). The precise meaning of the term \u2018isochore\u2019, particularly with\nregard to the notion of homogeneity within isochores implied by the prefix \u201ciso\u2019,\nhas been the subject of dispute. What is abundantly clear from plots of GC\ncontent across mammalian chromosomes (e.g. using UCSC Genome Browser\nhttp:\/\/genome.cse.ucsc.edu) is that there is considerable variation in base\ncomposition at large scales (hundreds of kb and above). It is the analysis of such\nlarge scale variation which we address in this study.\nWhat are the reasons for analysing patterns of base composition? The most\nsimple aim is descriptive: there is considerable large scale compositional\n2\nvariation in mammalian genomes, but the signal is obscured by small scale noise,\nso we need computational tools to understand any underlying structure there\nmay be. The second reason is for practical and predictive purposes. It appears\nthat many features of the genome are correlated with GC content, such as gene\ndensity (Venter et al., 2001), repeat density (IHGSC, 2001), substitution rates\n(Hardison et al., 2003), and recombination rates (Kong et al., 2002). Much,\nalthough not all, of the covariation can be explained by GC variation (Hardison\net al., 2003; Spencer et al., 2006). For example, if we are designing gene\nprediction methods, it is more likely that a high GC region will contain genes\nthan a low GC region (Carpena et al., 2002), so utilising information about the\nisochore structure is worthwhile. Finally, there is the ultimate aim of trying to\nunderstand the evolution of genomes at the finest possible scale, that of the\nsingle nucleotide (Eyre-Walker and Hurst, 2001). What are the evolutionary\nforces which affect base composition? How and when were isochores created?\nWhy do some genomes have isochores while others show far less compositional\nvariation? To answer these sorts of questions we need to develop powerful\nstatistical methods to infer underlying patterns of base composition and to test\nhypotheses concerning their evolution.\nIt seems clear that it is better to analyse patterns of base composition by using\nthe underlying structure in GC variation, i.e. what we term isochores, rather\nthan simply using windows based methods which are dependent on the choice of\nwindow size (Li et al., 2002). Current methods for the identification of isochores\nfrom sequence data can be divided into two main classes: highly efficient\nmethods for dealing with genomic sequences many megabases (Mb) long\n(Nekruteno and Li, 2000; Oliver et al., 2004), and more sophisticated but slower\nmethods that are usually applied to much smaller sequences (reviewed in Braun\n3\nand Muller, 1998). Methods for identifying isochores are segmentation methods:\nthe aim is to divide a sequence into a number of regions, termed segments, which\nrepresent the hidden deterministic process which generates the observed\ncompositional variation. Only at the boundaries between segments, termed\nchangepoints, does the underlying process change, although stochastic effects\ngenerate additional variation throughout the sequence. A fast heuristic method\nfor sequence analysis is recursive segmentation, in which binary segmentation is\nrepeatedly applied to the data (Braun and Muller, 1998; Li et al., 2002). Binary\nsegmentation involves choosing whether to cut a sequence into two sub-sequences\nand where the cut should be made. The general approach is to first find the\nchangepoint which maximises some statistic measuring the difference in GC on\neither side of the changepoint. The cut is then made, provided that the evidence\nfor segmentation is strong enough. If the sequence is cut, then binary\nsegmentation is independently repeated on the two sub-sequences. So the\nrecursive segmentation continues until no further changepoints can be found\nwithin any of the sub-sequences. The final set of sub-sequences becomes the\nidentified segments. As an example, the program IsoFinder implement a binary\nsegmentation for GC content (Bernaola-Galvan et al., 1996; Oliver et al., 2004).\nWe describe a Bayesian approach to inferring isochore structure. This approach\nhas numerous advantages over the binary segmentation procedure implemented\nwithin IsoFinder: it jointly infers all changepoints, quantifies uncertainty in the\nunderlying isochore structure, and averages over this uncertainty when\nproducing estimates of GC content across the chromosome. It also appears to be\nmore robust in terms of the inferred isochore structure, whereas relatively minor\nchanges in the DNA sequence can cause comparatively large changes in the\ninferred isochore structure using binary segmentation.\n4\nThe use of Bayesian methods for segmentation of genomic features is becoming\nincreasingly popular. There are methods for segmentation of the DNA sequence\n(Liu and Lawrence, 1999; Boys et al., 2000) as well as methods for segmenting\nthe genome based on other features (Salmenkivi et al., 2002; Fearnhead and\nSherlock, 2006). Whilst our approach is based on segmenting the genome based\non the DNA sequence, we focus solely on the large-scale features of the sequence.\nWe first partition the chromosomal region of interest into 3kb windows (though\nthe approach is robust to the choice of window size of the order of 3\u20135kb) and\nthen summarise the data based on the GC content in these windows. This both\nfilters out very fine-scale variation in GC content (such as due to CpG islands,\nwhich are \u2248 1kb regions of high GC content), and also leads to algorithms that\nare computationally more efficient, and scalable to the whole genome. Our\napproach is most similar to that described in Fearnhead and Liu (2007), but it is\nbased on a more realistic model, which directly models isochore families (see\nSection 3) and allows for both fine and large scale structure though allowing for\ndependence in GC content across isochores. While there are algorithms that\nanalyse either fine-scale variation in GC content (e.g. Fearnhead and Liu, 2007),\nor large-scale variation (e.g. Cohen et al., 2005; Constantini et al., 2006), our\napproach and that of IsoFinder are perhaps the only that try to infer both.\nThe outline of the paper is that we first give a more detailed description of the\nproblem, followed by details of the model we use. We then describe our\ncomputational algorithm that enables us to generate samples from the posterior\ndistribution of our model. In Section 5 we show how our method is substantially\nmore accurate in estimating GC content than IsoFinder. We apply our method\nto analysing the GC content of human chromosome 1 in Section 6, and look at\npredicting local recombination rates from our estimates of the local GC content\n5\nof the region. Our paper concludes with a discussion.\n2 Problem Description\nThe raw data consists of a single contiguous stretch of DNA data, which can be\nviewed as a long \u2018word\u2019 containing only four different \u2018letters\u2019: A, C, G and T.\nOur aim is to infer how the GC content (the proportion of letters that are G or\nC) varies across this contiguous region (\u2018word\u2019). As an example Figure 1 shows\ndata from a 6.0 megabase (Mb) stretch of human chromosome 1. We have\nsummarised the DNA data by partitioning the 6.0Mb region into 2000 windows,\neach of 3.0 kb long, and for each window plotting the proportion of letters\nwithin that window that are G or C. Overlaid on the data in Figure 1 we show\nthe inferred isochore structure calculated by the IsoFinder computer program:\na series of segments of homogeneous (constant mean) GC content. Throughout\nthis paper we refer to each segment as an \u2018isochore\u2019, though the classical\ndefinition of isochores is usually restricted to segments whose length is of the\norder of 300kb or longer.\nThe program we used to calculate the isochore structure of the region of\nchromosome 1 in Figure 1 is currently perhaps the most popular program for\ninferring isochore structure. For example the Isochore structure detected by\nIsoFinder is displayed on the human genome web browser\n(http:\/\/genome.cse.ucsc.edu). IsoFinder uses a binary segmentation\napproach as described in the introduction.\nWhilst simple and quick to implement, there are several disadvantages to\nIsoFinder. Firstly the user needs to specify a p-value to be used within the\nsegmentation approach, which governs the amount of evidence required for a\n6\n6 7 8 9 10 11 12\n0.3\n0.4\n0.5\n0.6\n0.7\nPosition (Mb)\nGC\n co\nnte\nnt\nFigure 1: Plot of GC content in 3kb windows for 6Mb of human chromosome\n1 (black); and IsoFinder segmentation (red). Data comes from positions 6Mb\u2013\n12Mb of build hg17.\nnew breakpoint to be introduced. The results in Figure 1 were obtained with a\np-value of 0.95 and give an inferred structure which contains 116 isochores.\nChanging the p-value to 0.99 would have produced a different structure with\nfewer isochores. Secondly, the method produces a single estimate of the Isochore\nstructure, and we get no measure of the underlying uncertainty with the position\nof the breakpoints in this structure. The number and position of changepoints it\ninfers can vary quite noticeably even with only minor changes to the underlying\nDNA sequence (see Section 5). Finally, there is also evidence that binary\nsegmentation procedures are inferior to methods that jointly infer all\nchangepoints (Braun et al., 2000).\nHere we propose a Bayesian, model-based approach for inferring isochores. We\napply our method to DNA data which is summarised by the proportion of GC\ncontent in a series of consecutive, non-overlapping windows (such as the data\n7\npresented in Figure 1). This filters out the fine-scale structure in the DNA\nsequence, and by summarising the data in this way we can produce a method\nthat can scale to analysing genomewide data. The former is important in terms\nof the aim of analysing structure in GC content, and IsoFinder also filters out\nthe structure at the 3kb\u20135kb level.\n3 Model\nBefore describing the model that we chose for detecting Isochore structure, we\nfirst describe the results of some preliminary analysis and some prior knowledge\nof the GC structure that guided our choice of model. Throughout, we assume\nour data is described by y1, y2, . . . , yn, the average GC content in consecutive\nwindows.\nBoth for simplicity and because it is known to capture the main large-scale\nstructure in the data, we are going to assume a piecewise constant model for the\nunderlying isochore structure. Thus a single realisation of this process will look\nlike the output of IsoFinder as shown in Figure 1. This realisation can be\ndescribed by changepoints and mean levels.\nTo specify a model we will need to describe (i) the marginal distribution of the\nmean level, \u00b5, for each Isochore; (ii) the dependence structure in these mean\nlevels across Isochores; (iii) the joint distribution of the number and position of\nthe changepoints; (iv) the distribution of the data conditional on the Isochore\nstructure.\nIt has been suggested by Bernardi (2000), that the isochore organisation of the\nhuman genome can be partitioned into four families, and the GC content for\n8\n0.30 0.35 0.40 0.45 0.50 0.55 0.60\n0\n1\n2\n3\n4\n5\n6\n7\nC+G content\nRe\nlat\nive\n Am\nou\nnts\nH3\nH2\nH1\n L\nFigure 2: The Isochore Organisation into four Families according to the GC con-\ntent level, one GC poor the L ( ) and three GC rich, namely the H1 ( ), H2\n( ), H3 ( )\nisochores within each family can be described by a normal distribution, as shown\nin Figure 2 (alternatively five family models have been suggested, e.g.\nConstantini et al., 2006). Therefore this motivates fitting a normal mixture\nmodel for the marginal distribution of mean GC content of the isochores, with\neach component associated with a different family.\nWhile previous models have assumed independence of the mean GC content of\ndifferent isochores (e.g. Fearnhead and Liu, 2007), this assumption is unrealistic.\nSmith and Lercher (2002) documents the long range correlation that exists in\nthe human genome, and Bernaola-Galvan et al. (2002) showed that there is\nstructure inside long relatively homogeneous regions. We allow for dependence\nthrough a hidden Markov model, where the hidden state relates to the family of\nthe isochore. This enables us to capture some degree of dependency, whilst\nremaining within a computationally tractable framework.\n9\nWe model the joint distribution of the number and position of changepoints\nthrough a probabilistic model for the length of each isochore. For the results\nthat are presented, we chose an geometric distribution for the isochore length \u2013\nas the results from IsoFinder has a range of very short to long lengths in the\nisochore structure that it finds (see Figure 1), though the computational\nmethodology below can be extended to any distribution for this length.\nFinally, analysing the residuals of the chromosome 1 dataset after we run\nIsoFinder, suggests that conditional on the isochore mean, the data is, at least\napproximately, normally distributied and is close to being independent\n(autocorrelation at lag 1 is 0.25; and no significant autocorrelation at lags > 2.).\n3.1 Mathematical Description of Model\nThe specific model we use has a hierarchical structure. Firstly, denote the\nnumber of isochores by m, and the changepoint positions by \u03c40 < \u03c41 < \u00b7 \u00b7 \u00b7 < \u03c4m\nwith \u03c40 = 0, \u03c4m = n and the ith isochore containing observations\ny\u03c4i\u22121+1:\u03c4i = (y\u03c4i\u22121+1, y\u03c4i\u22121+2, . . . , y\u03c4i). For each isochore we associate an isochore\nfamily. We allow for K different isochore families, and let \u03b6i \u2208 {1, . . . , K} denote\nthe family of the ith isochore.\nThe distribution of m and the position of the changepoints is specified through a\nmodel for the isochore lengths. We let this distribution depend on the family of\nthe isochore. We assume a Markov model for the isochore families. Thus the\njoint probability of the number and position of the changepoints, and the\nfamilies of the isochores can be factorised as\nPr(m, \u03c41, . . . , \u03c4m\u22121, \u03b61, . . . , \u03b6m) = Pr(\u03b61)\n(\nm\u22121\u220f\ni=1\nPr(\u03c4i|\u03c4i\u22121, \u03b6i) Pr(\u03b6i+1|\u03b6i)\n)\nPr(\u03c4m|\u03c4m\u22121, \u03b6m).\nWe then assume that the distribution of the length of an isochore has a\n10\ngeometric distribution, with mean 1\/\u03bbk for an isochore in family k:\nPr(\u03c4i = s|\u03c4i\u22121 = t\u2212 1, \u03b6i = k) = \u03bbk(1\u2212 \u03bbk)\nt\u2212s,\nfor s = t, t+ 1, . . . , n\u2212 1. The probability of no further changepoints (i.e.\ns = n), conditional on an isochore in family k, is (1\u2212 \u03bbk)\nn\u2212t. We further\nintroduce a K \u00d7K transition matrix P so that Pr(\u03b6i+1 = l|\u03b6i = k) = Pkl. The\ndistribution Pr(\u03b61) is defined to be the stationary distribution of P .\nConditional on \u03b6i = k, the isochore family of the ith isochore, the mean and\nvariance of the GC content of that isochore is drawn from the standard\nconjugate normal-variance prior, with\n\u03c32j \u223c IG(\u03bd\/2, \u03b3\/2), and \u00b5j|\u03c3\n2\nj \u223c N(\u03bek, \u03c3\n2\nj\/\u03b4k),\nwhere IG(\u00b7, \u00b7) denotes the inverse gamma distribution and N(\u00b7, \u00b7) the normal\ndistribution.\nFinally, conditional on the changepoints, the hidden states of the Markov chain\nand parameters associated with the segments, the observations are considered to\nbe independent, and normally distributed. For observation yj that belongs to\nthe ith isochore:\nyj \u223c N(\u00b5i, \u03c3\n2\ni ), where j \u2208 {\u03c4i\u22121 + 1, . . . , \u03c4i}.\nThis model has an important feature which makes it computational tractabile. If\nwe condition on the hyperparameters of the model, then given a changepoint at\ntime s and the isochore family of the isochore starting at time s+ 1, the data\ny1:s and ys+1:n are independent of one another.\n11\n4 Bayesian Inference\nWe perform Bayesian inference for this model, conditional on the values of\nhyper-parameters: K, the number of isochore families; \u03bbk for k = 1, . . . , K for\nthe distribution of the isochore length; P , the transition matrix of the isochore\nfamilies; \u03bek, and \u03b4k for k = 1, . . . , K for the prior distribution of the isochore\nmeans; and \u03bd and \u03b3 for the prior distribution of the segment variances.\nConditional on these values we can obtain iid samples from the joint distribution\nof the number and position of changepoints, the family of each isochore, and the\nGC content of each isochore using an algorithm related to the\nForward-Backward algorithm Baum et al. (1970). The algorithm we present here\nis a new extension of previous algorithms for changepoint models (Yao, 1984;\nBarry and Hartigan, 1992, 1993; Liu and Lawrence, 1999; Fearnhead, 2005; Lai\net al., 2005; Fearnhead, 2006) to allow for the HMM component of the model. In\nparticular we adapt the method of Fearnhead and Liu (2007) due to its\ncomputational efficiency (see Section 4.2). Details of how we choose the\nhyperparameters is given in Section 4.3\n4.1 Exact Inference\nOur choice of conjugate priors means that we can integrate out the parameters\nassociated with a given isochore (conditional on the isochore family). This means\nthat given a sample from the joint distribution of the number and position of the\nchangepoints, and the family of each isochore, it is straightforward to sample the\nisochore means. We thus focus on how to simulate from the posterior\ndistribution of the changepoint positions and isochore families.\nFirstly define the marginal likelihood of observations yt:s conditional on them\n12\nbelonging to a single isochore, and the isochore belongs to family k by R(t, s, k).\nWe allow for missing data in one or more windows. For notational simplicity\ndefine yi = 0 if there is no observation for window i, so that\n\u2211s\ni=t yi is the sum of\nobservations for windows t to s inclusive; and let nt be the cumulative sum of\nobservations up to an including window t (so nt = t if there is no missing data).\nThen the marginal likelihood is\nR(t, s, k) =\n\u222b\n\u00b5\n\u222b\n\u03c32\n(\ns\u220f\ni=t\nf(yi|\u00b5, \u03c3)\n)\np(\u00b5|\u03c3, \u03b6 = k)p(\u03c3) d\u03c3 d\u00b5.\n=\npi\u2212(ns\u2212nt+1)\/2 \u03b3\u03bd\/2(\n\u03b3 +\n\u2211s\ni=t y\n2\ni + \u03be\n2\nk\u03b4k \u2212\nP\ns\ni=t\nyi +\u03be2k\u03b4k\nns\u2212nt+1+\u03b4k\n)(ns\u2212nt+1+\u03bd)\/2 \u0393\n(\n(ns \u2212 nt + 1 + \u03bd)\/2\n)\n\u0393(\u03bd\/2)\n.\n(1)\nWe introduce a 2-dimensional state at time t, (Ct, Zt), where Ct is defined as the\ntime of the most recent changepoint prior to time t, and Zt is the family of the\ncurrent isochore at time t. Under our model (Ct, Zt) is a Markov chain with\ntransition probabilities:\nPr(Ct+1 = j, Zt+1 = l|Ct = i, Zt = k) =\n\uf8f1\uf8f2\n\uf8f3 (1\u2212 \u03bbk) if j = i and l = k,\u03bbkPkl if j = t,\nwith all other transitions having zero probability.\nWe can then write down recursions for the filtering probabilities Pr(Ct, Zt|y1:t)\n(See Appendix A for derivation). For j < t we have\nPr(Ct+1 = j, Zt+1 = l|y1:t+1) \u221d\nR(j + 1, t+ 1, l)\nR(j + 1, t, l)\nPr(Ct = j, Zt = l|y1:t)(1\u2212 \u03bbk),\n(2)\nwhile\nPr(Ct+1 = t, Zt+1 = l|y1:t+1) \u221d R(t+1, t+1, l)\nt\u22121\u2211\ni=0\nK\u2211\nk=1\nPr(Ct = i, Zt = k|y1:t)\u03bbkPkl.\n(3)\n13\nThe recursions are initalised with P (C1 = 0, Zt+1 = l|y1) = Pr(\u03b61 = l)R(1, 1, l)\nfor l = 1, ldots,K. Note that the normalising constant of these equations is\nPr(yt+1|y1:t) and thus a by-product of solving them is that we can calculate the\nlikelihood Pr(y1:n) (see Fearnhead, 2008).\nThese recursions can be solved for t = 1, . . . , n. Once calculated, the last\nchangepoint and isochore family can be simulated directly from Pr(Cn, Zn|y1:n).\nThen if we condition on a changepoint at t with isochore family l (Ct+1 = t,\nZt+1 = l) we have that\nPr(Ct = i, Zt = k|y1:n, Ct+1 = t, Zt+1 = l) \u221d Pr(Ct = i, Zt = k|y1:t)\u03bbkPkl,\nfor i = 0, . . . , t\u2212 1 and k = 1, . . . , K. Simulating from this distribution gives us\nboth the family and the position of the beginning of the isochore that ends at t.\nThus we can recursively simulate the changepoints and isochores backwards in\ntime.\n4.2 A Computationally Efficient Algorithm\nThe above algorithm enables iid samples to be drawn from the posterior\ndistribution of the number and position of the changepoints and the families of\nthe isochores. Once these have been sampled, it is trivial to sample the\nparameters (mean GC content, and variance) for each isochore. However, the\nalgorithm suffers from the disadvantage that its computational and storage costs\nis quadratic in the number of observations, n.\nTo have an algorithm that scales linearly with n, and can be applied to data\nfrom whole chromosomes, we applied resampling ideas from Fearnhead and Liu\n(2007). Their idea is to approximate Pr(Ct, Zt|y1:t) by a discrete distribution\nwith fewer than tK support points: by stochastically removing support points\n14\nthat have small probability. We used their Stratified Rejection Control\nalgorithm (see also Liu et al., 1998), which was shown to perform well both\ntheoretically and in simulation studies. The basic idea is as follows. Assume\nthat we have a discrete distribution with N support points (c\n(i)\nt , z\n(i)\nt and\nassociated probabilities w\n(i)\nt (for i = 1, . . . , N) that approximate Pr(Ct, Zt|y1:t).\nWe can produce an approximation with fewer support points using the following\nresampling algorithm:\n(i) Choose an arbitrary cut-off \u03b1. Order the support points so that if i < j\nthen either c\n(i)\nt < c\n(j)\nt or c\n(i)\nt = c\n(j)\nt and z\n(i)\nt < z\n(j)\nt .\n(ii) Simulate u a realisation of a uniform random variable on [0, \u03b1]. Set i = 1.\n(iii) If w\n(i)\nt \u2265 \u03b1 goto (iv); else let u = u\u2212 w\n(i)\nt . If u \u2264 0 then let u = u+ \u03b1 and\nset w\n(i)\nt = \u03b1, otherwise set w\n(i)\nt = 0.\n(iv) Let i = i+ 1; if i < N return to (ii); otherwise remove all support points\nfor which w\n(i)\nt = 0, and renormalise the probabilities of the remaining\nsupport points.\nThe idea is that support points with probability, w\n(i)\nt less than \u03b1 are\nprobabilistically removed. The probability of removing a support point is w\n(i)\nt \/\u03b1.\nThose support points that are kept have their probabilities increased in step (iii)\nso that the algorithm is unbiased (before normalisation, expected probability of\na support point after resampling is equal to its probability before). The ordering\nin step (i) ensures that the support points removed are evenly spread over the\nsupport of Pr(Ct, Zt|y1:t). Note that \u03b1 governs the trade-off between smaller\napproximation (smaller \u03b1) and speed (larger \u03b1).\nIn practice we have found \u03b1 = 10\u22126 introduces negligible error, but can greatly\n15\nincrease the speed of the overall algorithm. In the application in Section 6, the\nresulting algorithm approximated the filtering densities, Pr(Ct, Zt|y1:t), by\ndistributions with an average of around 200 support points. The true\ndistributions had an average of 80,000 support points, so this led to a 400-fold\nreduction in CPU and memory cost.\n4.3 Choosing the Hyper-parameters\nThe above exact simulation method requires the specification of the\nhyper-parameters. Based on Figure 2, in our analysis below we specify the\nnumber of isochore families to be 4, and the mean GC content to be\n(\u03be1, \u03be2, \u03be3, \u03be4) = (0.39, 0.44, 0.48, 0.53). The other hyper-parameters were\nestimated via maximum likelihood using a Monte Carlo EM algorithm. Details\nof this are given in Appendix B.\n5 Comparison with IsoFinder\nWe compared our new Bayesian approach with that of IsoFinder on a series of\nsimulated data sets. In order to simulate data that captures the structure we\nobserve in real data, we based all simulated data sets around the inferred\nisochore structure in the region of chromosome 1 that is shown in Figure 1. This\ninferred structure was taken to be the underlying truth that we wish to estimate.\nOur three simulated data sets differed in how the observations relate to the\nunderlying isochore structure:\n(A) Observations are independent and normally distributed with common\nvariance; isochore mean given by the sample mean of the observations\n16\nwithin that isochore.\n(B) Same as (A) except that we introduce extra changepoints within the longer\nisochores (greater than 90kb), and recalculate the mean of the observations\nbased on these. Extra changepoints were added approximately every 60kb.\n(C) Same marginal distribution as (A), but we introduce dependence into the\nobservations through an AR(1) model for the observation, with 1-lag\ncorrelation of 0.25.\nThe idea of (B) and (C) is to introduce extra structure in the observation\nprocess within each isochore; (C) allows for dependencies that are greater than\nthose inferred in the true data (see Section 3).\nWe compare the results of our method and IsoFinder in terms of estimating the\nunderlying GC content. For our method we estimate the GC content for any 3kb\nwindow via the posterior mean of the GC content for that window. We measure\nthe accuracy of a method by averaging the square error of its estimated GC\ncontent from the true GC content across the 2000 3kb windows.\nTo run IsoFinder on the simulated data, we had to simulate sequence data. We\ndid this by simulating the order of nucleotides for each window at random\nsubject to the constraint on the number of GC nucleotides for that window.\nWhilst this approach does not adequately reflect the true fine-scale structure in\nDNA sequences, this should not affect IsoFinder much as it filters out fine-scale\nstructure at less than the 3kb level. However we did run IsoFinder on two\nsimulated sequences for each data set, and found a noticeable difference in the\nsegmentation and hence the performance of the method, which suggests the\nsegmentation approach is relatively sensitive to minor changes in the DNA\nsequence being analysed. The reason for this is that IsoFinder gives a single\n17\nData Bayesian Approach IsoFinder p = 0.95 IsoFinder p = 0.99\nMSE MSE MSE MSE MSE\n(A) 1.7\u00d710\u22124 3.1\u00d710\u22124 3.0\u00d710\u22124 3.6\u00d7 10\u22124 3.4\u00d7 10\u22124\n(B) 2.0\u00d710\u22124 2.5\u00d710\u22124 2.7\u00d710\u22124 3.4\u00d7 10\u22124 3.7\u00d7 10\u22124\n(C) 2.6\u00d710\u22124 4.5 \u00d710\u22124 4.1\u00d710\u22124 3.7\u00d7 10\u22124 3.7\u00d7 10\u22124\nTable 1: Results of our method (Bayesian Approach) and IsoFinder, for two\ndifferent significance levels, at inferring GC structure for 3 different simulation\nscenarios (see text for details). We give mean square error (MSE) for our method,\nand MSE for two sequences (simulated for same GC content per 3kb window) for\neach scenario for the IsoFinder analyses.\nsegmentation of the data. As there are often a range of segmentations that are\nplausible for a given data-set, minor changes can mean that IsoFinder jumps\nbetween two relatively dissimilar segmentations. One of advantage of the\nBayesian approach we take is that we average over possible segmentations, and\nthus our algorithm is much more robust to minor changes in the sequence data\n(which for the Bayesian approach correspond to small changes in the GC content\nof each window).\nOur results are given in Table 1. Our method is substantially more accurate at\ninferring GC content that IsoFinder, regardless of whether IsoFinder is run\nwith a significance value of p = 0.95 or p = 0.99. Mean square error is reduced\nby between 40% and 50% for data set (A); between 20% and 40% for (B); and\nbetween 30% and 40% for (C).\n6 Analysis of Chromosome 1 DNA sequence\nWe applied our method to data from human Chromosome 1, with the DNA\nsequence taken from build hg17 (available from\nhttp:\/\/hgdownload.cse.ucsc.edu\/goldenPath\/hg17). There was substantial\nmissing data around the centromere of the chromosome, and so we analysed the\ntwo arms of the chromosome separately: the first 120,408kb; and positions\n146,328kb\u2013245,217kb. In total this accounts for over 219MB of sequence (approx\n7% of the human genome), with over 73,000 3kb windows. We counted as\nmissing data any window for which the complete DNA sequence was not known,\nand this resulted in 431 missing data points.\nAnalysis of the data for a given set of hyper-parameters took substantially less\nthan a minute on a desktop PC. Convergence of the EM algorithm was achieved\nwithin around 30 iterations. Figure 3 shows the estimates of mean GC content.\nThe estimated parameters suggest that there is less heterogeneity within the L\nisochore family (mean number of windows between changepoints is 18 for the L\nfamily, and 5 for each of H1\u2013H3). For all isochore families we expect between 15\nand 25 consecutive isochores from that family. For each family, the modal\ntransition is to a neighbouring isochore family.\nFor comparison we also analysed the data using the method of Fearnhead and\nLiu (2007), which corresponds to the special case of K = 1 in our model (i.e. it\nignores isochore families). We compared the models based on the change in\nlog-likelihood. There was an increase of 1,530 for the K = 4 model; while the\nnumber of estimated hyper-parameters increased by only 16. Thus using either\ninformation criteria such as AIC or BIC, or a chi-squared test based on the\nlikelihood ratio statistic, there is over-whelming evidence in favour of choosing\n19\nthe model with K = 4.\n6.1 Detecting Classical Isochores\nOne ongoing question is to what extent \u201cclassical isochores\u201d exist within the\nhuman chromosome, and whether they are detectable. Cohen et al. (2005) define\na classical isochore as a region of a chromosome which is (i) longer than 300kb;\n(ii) is more homogeneous in its composition than the chromosome on which it\nresides; and (iii) can be classified into an isochore family . They suggest testing\n(ii) for an isochore based on whether there is significant evidence for the variance\nin GC content within a segment is smaller than the variance in GC content\nacross the whole chromosome. Results based on the method of Cohen et al.\n(2005) suggest that only 41% of the human genome lies within such classical\nisochores.\nWe considered whether our analysis enables us to detect classical isochores more\neffectively. Our idea was to use the posterior distribution on the isochore family\nfor each window. We first calculated the modal isochore family for each window,\nand then partitioned the chromosome into contiguous regions of the same modal\nfamily. For each contiguous region we then tested whether they satisfied\nconditions (i) and (ii) above (by definition they trivially satisfy (iii)). The\nregions that satisfied these conditions are shown in Figure 3. In total these\ncovered 85% of the chromosome.\nBy comparison, applying the same method to the isochores detected by\nIsoFinder, gave only 60% coverage of the chromosome. Our results are\ncomparable with those of Constantini et al. (2006), who also found classical\nisochores that cover 85% of the genome, though they were using a somewhat\n20\n0 10 20 30 40 50\n0.\n2\n0.\n4\n0.\n6\n50 60 70 80 90 100\n0.\n2\n0.\n4\n0.\n6\n100 110 120 130 140 150\n0.\n2\n0.\n4\n0.\n6\n150 160 170 180 190 200\n0.\n2\n0.\n4\n0.\n6\n200 210 220 230 240 250\n0.\n2\n0.\n4\n0.\n6\nFigure 3: Results of our model on the Human Chromosome 1 dataset: the raw\ndata is given by black dots; the inferred GC content is given by the red line. At\nthe bottom of the plots we show the regions of contiguous modal isochore family\nthat are consistent with the features of classical isochores (different levels of the\nlines correspond to different families; from highest to lowest: H3, H2, H1 and L.\n21\nadhoc algorithm specifically designed to detect such classical isochores.\n6.2 Fine-Scale Correlation with Recombination Rates\nOne motivation for inferring GC content is to look for correlation with other\ngenomic features. Galtiera et al. (2001) have established a causal relationship\nbetween recombination and GC content by examining the variation on the levels\nof polymorphism in the genome, and we decided to investigate this relationship\non chromosome 1. We downloaded the fine-scale recombination map (Myers\net al., 2005) from phase II of the HapMap project (available from\nhttp:\/\/www.hapmap.org\/) and analysed the correlation between these\nestimates of recombination (for each 3kb window) and GC content. Our\nrationale is that a better method at estimating the local variation in GC content\nis likely to have greater correlation with local recombination rate.\nWe first log-transformed the recombination rate estimates, so that their\nmarginal distribution was close to normal. We then calculated the correlation\nbetween log-recombination and GC content as inferred by (i) GC content within\nthe 3kb window; (ii) IsoFinder; and (iii) our method. The resulting correlations\nwere (i) 0.30, (ii) 0.30, and (iii) 0.32. An alternative approach is to infer GC\ncontent using a larger region centered on each window. If we implement this,\nand choose the optimal size of region (27kb), we obtain correlation that is\nalmost identical to that obtained by our method (0.32).\nTo gain a greater insight into the correlation between GC content and\nrecombination rate, we repeated the analysis for overlapping 5Mb windows\nacross chromosome 1 (see Figure 4). The correlation of recombination rate with\nthe estimates from our method is greater than that with the estimate of\n22\n0 20 40 60 80 100 120\n0.0\n0.2\n0.4\n0.6\nPosition (Mb)\nCo\nrrel\natio\nn\n160 180 200 220 240\n0.0\n0.2\n0.4\n0.6\nPosition (Mb)\nCo\nrrel\natio\nn\nFigure 4: Correlation of GC content with log recombination rate for 5Mb windows\nof chromosome 1. The lines correspond to 3 different measurements of GC content:\nraw 3kb data (black dashed-line); IsoFinder estimate (blue, dotted-line); our\nestimate (red, full-line).\nIsoFinder in over 80% of the windows (and greater than correlation with raw\nGC in 95% of the windows). However more striking is the fact that correlation\nbetween GC content and recombination rate varies considerably across the\nchromosome, from < 0 to > 0.6.\nOne reason for this is that the auto-correlation structure in GC content extends\nmuch further than auto-correlation of recombination rates. Thus a relative\nmeasure of GC content, which considers the difference between the local\nestimate of GC content and the average GC content over a Mb scale may be a\nbetter predictor of local recombination rate. For a 3kb window let ri denote the\nlog recombination-rate, Gi the inferred GC content from our method, and G\u00afi the\naverage GC content for a 1Mb region centered on the region. Linear regression\nsuggests the predictor Gi \u2212 0.65G\u00afi for ri. This predictor has correlation 0.36\nwith recombination rate.\n23\n7 Discussion\nWe have presented a novel Bayesian method for inferring isochore structure from\nDNA sequence data. Both our simulation results, and the correlation analysis of\nthe chromosome 1 data suggest that it is a more accurate approach than the\nbinary segmentation procedure used by the program IsoFinder. We have\nderived a new direct simulation algorithm that enables iid draws from the\nposterior distribution, and shown how using resampling ideas we can implement\nan approximate algorithm that can analysis data from a whole chromosome in a\nmatter of seconds.\nInference for the hyper-parameters of our model are possible using an EM\nalgorithm. For our analysis we fixed the number of isochore families, K, and\ntheir mean GC content based on prior information (Bernardi, 2000). It would\nhave been possible to perform inference for the mean GC content of the families\nwithin the EM algorithm, though maximisation becomes more difficult due to\nmultiple local maximum. Inference for the number of families is also possible\nusing our algorithm, as the algorithm calculates the marginal likelihood of the\ndata, which can then be used to compare models with different values of K.\nAn important feature of our model is that it captures both fine-scale variation in\nGC content, which can be used to look at correlation of GC content with other\nfeatures; and also large-scale variation which helps define regions of the\nchromosome that fit within the classical idea of isochores. Our analysis of GC\ncontent on chromosome 1 demonstrated the accuracy of both the inferences for\nfine-scale and large-scale variation in GC content. Furthermore we showed that\nrelative measures of GC content may be the most predictive of local\nrecombination-rates; something that has not been considered previously (see e.g.\n24\nSpencer et al., 2006).\nThe program implementing our method is available from the first author.\nAcknowledgements: This work was supported by Engineering and Physical\nSciences Research Council grant GR\/T19698\/01 to the first author, and a\nLancaster University 40th Anniversary PhD studentship to the second author.\nWe thank Danny Wilson for helpful comments. We dedicate the paper to the\nmemory of Nick Smith, who first motivated us to look at this problem.\nAppendix A: Derivation of Recursions (2) and (3)\nBy Bayes theorem\nPr(Ct+1 = j, Zt+1 = l|y1:t+1) \u221d Pr(yt+1|y1:t, Ct+1 = j, Zt+1 = l) Pr(Ct+1 = j, Zt+1 = l|y1:t)\nFor recursion (2) we use the fact that if j < t\nPr(Ct+1 = j, Zt+1 = l|y1:t) = Pr(Ct = j, Zt = l|y1:t)(1\u2212 \u03bbk).\nFurthermore by the conditional independence property of the model\nPr(yt+1|y1:t, Ct+1 = j, Zt+1 = l) = Pr(yt+1|yj+1:t, Ct+1 = j, Zt+1 = l)\n=\nPr(yj+1:t+1|Ct+1 = j, Zt+1 = l)\nPr(yj+1:t|Ct+1 = j, Zt+1 = l)\n=\nR(j + 1, t+ 1, l)\nR(j + 1, t, l)\n.\nA similar derivation applies for (3), but here\nPr(Ct+1 = t, Zt+1 = l|y1:t) =\nt\u22121\u2211\ni=0\nK\u2211\nk=1\nPr(Ct = i, Zt = k|y1:t)\u03bbkPkl.\nAppendix B: Monte Carlo EM Algorithm\nWithin the EM algorithm, the full data consists of the number and position of\nthe changepoints, the family of each isochore, and the mean GC content and\n25\nvariance associated with each isochore. From this we define summary statistics:\nmk the number of complete isochores of family k (i.e. excluding the final\nisochore); lk the number of windows contained in isochores of family k; nij the\nnumber of transitions from family i to family j. Let Sk denote the set of\nisochores from family k and \u00b5i and \u03b2i = 1\/\u03c3\n2\ni be the mean and precision of\nisochore i. Let m = 1 +\n\u2211K\nk=1 mk denote the number of isochores as before.\nFor analytical simplicity we drop the contribution to the likelihood from the\nfamily of the first isochore. Due to the length of the data sets analysed, the\neffect of this is negligible. The resulting full-data log-likelihood is:\nK\u2211\ni=1\nK\u2211\nj=1\nnij log(Pij) +\nK\u2211\nk=1\n(mk log(\u03bbk) + (lk \u2212mk) log(1\u2212 \u03bbk))+\nK\u2211\ni=1\n(\n\u2212nk log(\u03b4k)\/2\u2212\n\u03b4k\n2\n\u2211\nj\u2208Sk\n\u03b2j(\u03bek \u2212 \u00b5j)\n2\n)\n+\n\u03bd\nm\u2211\nj=1\nlog(\u03b2j)\/2 +m\u03bd log \u03b3 \u2212 \u03b3\nm\u2211\nj=1\n\u03b2j\/2\u2212m log(\u0393(\u03bd\/2)).\nThe EM algorithm proceeds by taking expectation of the log-likelihood (with\nrespect to their conditional distribution given the current values of the\nhyper-parameters). Within our Monte Calo EM algorithm we estimate this\nexpectation using the simulated realisations from the current posterior\ndistribution. Thus for example if we denote the Monte Carlo estimates of the\nexpectations of nij for i, j = 1, . . . , K by n\u02c6ij, then our new estimates of Pij are\nn\u02c6ij\/(\n\u2211K\nk=1 n\u02c6ik). Updates for all hyper-parameters except \u03bd can be performed\nanalytically; we maximise \u03bd numerically.\n26\nReferences\nBarry, D. and Hartigan, J. A. (1992). Product partition models for change point\nproblems. The Annals of Statistics, 20:260\u2013279.\nBarry, D. and Hartigan, J. A. (1993). A Bayesian analysis for change point\nproblems. Journal of the American Statistical Society, 88:309\u2013319.\nBaum, L. E., Petrie, T., Soules, G., and Weiss, N. (1970). A maximisation\ntechnique occurring in the statistical analysis of probabilistic functions of\nMarkov chains. Ann. Math. Stats., 41:164\u2013171.\nBernaola-Galvan, P., Carpena, P., Roma\u00b4n-Rolda\u00b4n, R., and Oliver, J. L. (2002).\nStudy of statistical correlations in DNA. Gene, 300:105\u2013115.\nBernaola-Galvan, P., Roman-Roldan, R., and Oliver, J. L. (1996).\nCompositional segmentation and long-range fractal correlations in dna\nsequences. Physical Review E, 53:5181\u20135189.\nBernardi, G. (2000). Isochores and evolutionary genomics of vertebrates. Gene,\n241:3\u201317.\nBoys, R. J., Henderson, D. A., and Wilkinson, D. J. (2000). Detecting\nhomogeneous segments in DNA sequences by using hidden Markov models.\nJournal of the Royal Statistical Society, Series C, 49:269\u2013285.\nBraun, J. V., Braun, R. K., and Muller, H. G. (2000). Multiple changepoint\nfitting via quasilikelihood, with application to DNA sequence segmentation.\nBiometrika, 87:301\u2013314.\nBraun, J. V. and Muller, H. G. (1998). Statistical methods for DNA sequence\nsegmentation. Statistical Science, 13:142\u2013162.\n27\nCarpena, P., Bernaola-Galvan, P., Roman-Roldan, R., and Oliver, J. L. (2002).\nA simple and species-independent coding measure. Gene, 300:97\u2013104.\nCohen, N., Dagan, T., Stone, L., and Graur, D. (2005). GC composition of the\nhuman genome: In search of isochores. Molecular Biology and Evolution,\n22:1260\u20131272.\nConstantini, M., Clay, O., Auletta, F., and Bernardi, G. (2006). An isochore\nmap of human chromosomes. Genome Research, 16:536\u2013541.\nEyre-Walker, A. and Hurst, L. D. (2001). The evolution of isochores. Nature\nReview Genetics, 2:549\u2013555.\nFearnhead, P. (2005). Exact Bayesian curve fitting and signal segmentation.\nIEEE Transactions on Signal Processing, 53:2160\u20132166.\nFearnhead, P. (2006). Exact and efficient inference for multiple changepoint\nproblems. Statistics and Computing, 16:203\u2013213.\nFearnhead, P. (2008). Computational methods for complex stochastic systems: A\nreview of some alternatives to MCMC. To appear in Statistics and Computing.\nFearnhead, P. and Liu, Z. (2007). Online inference for multiple changepoint\nproblems. Journal of the Royal Statistical Society Series B, 69:589\u2013605.\nFearnhead, P. and Sherlock, C. (2006). Bayesian analysis of Markov modulated\nPoisson processes. Journal of the Royal Statistical Society, Series B,\n68:767\u2013784.\nGaltiera, N., Piganeaub, G., Mouchiroudb, D., and L., D. (2001). GC-content\nevolution in mammalian genomes: The biased gene conversion hypothesis.\nGenetics, 159:907\u2013911.\n28\nHardison, R. C., Roskin, K. M., Yanf, S., Diekhans, M., Kent, W. J., Weber, R.,\nElnitski, L., and Li et al., J. (2003). Covariation in frequencies of substitution,\ndeletion, transposition, and recombination during eutherian evolution.\nGenome Research, 13:13\u201326.\nIHGSC (2001). Initial sequencing and analysis of the human genome. Nature,\n409:860\u2013921.\nKong, A., Gubdjartsson, D. F., Sainz, J., Jonsdottir, G. M., Gudjonson, S. A.,\nRichardsson, B., Sigurdardottir, S., Barnard, J., Hallbeck, B., Masson, G.,\nShlien, A., Palsson, S. T., Frigge, M. L., Thorgeirsson, T. E., Gulcher, J. R.,\nand Stefansson, K. (2002). A high-resolution recombination map of the human\ngenome. Nature Genetics, 31:241\u2013247.\nLai, T. L., Liu, H., and Xing, H. (2005). Autoregressive models with piecewise\nconstant volatility and regression parameters. Statistica Sinica, 15:279\u2013301.\nLi, W. T., Bernaola-Galvan, P., Haghighi, F., and Grosse, I. (2002). Applications\nof recursive segmentation to the analysis of DNA sequences. Gene, 276:57\u201372.\nLiu, J. S., Chen, R., and Wong, W. H. (1998). Rejection control and sequential\nimportance sampling. Journal of the American Statistical Society,\n93:1022\u20131031.\nLiu, J. S. and Lawrence, C. E. (1999). Bayesian inference on biopolymer models.\nBioinformatics, 15:38\u201352.\nMyers, S., Bottolo, L., Freeman, C., McVean, G. A. T., and Donnelly, P. (2005).\nA fine-scale map of recombination rates and hotspots across the human\ngenome. Science, 310:321\u2013324.\n29\nNekruteno, A. and Li, W. H. (2000). Assessment of compositional heterogeneity\nwithin and between eukaryotic genomes. Genome Research, 10:1986\u20131995.\nOliver, J. L., Carpena, P., Hackenberg, M., and Bernaola-Galvan, P. (2004).\nIsoFinder: computational prediction of isochores in genome sequences. Nucleic\nAcids Research, 32:W287\u2013W292.\nSalmenkivi, M., Kere, J., and Mannila, H. (2002). Genome segmentation using\npiecewise constant intensity models and reversible jump MCMC.\nBioinformatics, 18:S211\u2013S218.\nSmith, N. G. and Lercher, M. J. (2002). Regional similarities in polymorphism\nin the human genome extended for many megabases. Trends in Genetics,\n18(281\u2013283).\nSpencer, C., Deloukas, P., Hunt, S., Mullikin, J., Myers, S., Silverman, B.,\nDonnelly, P., Bentley, D., and McVean, G. (2006). The influence of\nrecombination on human genetic diversity. Plos Genetics, 2:e148.\nVenter, J. C., Adams, M. D., Myers, E. W., Li, P. W., Mural, R. J., and Sutton\net al., G. G. (2001). The sequence of the human genome. Science,\n291:1304\u20131351.\nYao, Y. (1984). Estimation of a noisy discrete-time step function: Bayes and\nempirical Bayes approaches. The Annals of Statistics, 12:1434\u20131447.\n30\n"}