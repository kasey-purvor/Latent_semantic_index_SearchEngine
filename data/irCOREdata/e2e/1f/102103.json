{"doi":"10.1137\/050637170","coreId":"102103","oai":"oai:epubs.surrey.ac.uk:1550","identifiers":["oai:epubs.surrey.ac.uk:1550","10.1137\/050637170"],"title":"Numerical continuation of symmetric periodic orbits","authors":["Wulff, C","Schebesch, A"],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2006-01-01","abstract":null,"downloadUrl":"","fullTextIdentifier":null,"pdfHashValue":null,"publisher":"SIAM PUBLICATIONS","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:epubs.surrey.ac.uk:1550<\/identifier><datestamp>\n      2017-10-31T14:02:18Z<\/datestamp><setSpec>\n      74797065733D61727469636C65<\/setSpec><setSpec>\n      6469766973696F6E733D656E67616E64706879736963616C736369656E636573:6D617468737075626C<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/epubs.surrey.ac.uk\/1550\/<\/dc:relation><dc:title>\n        Numerical continuation of symmetric periodic orbits<\/dc:title><dc:creator>\n        Wulff, C<\/dc:creator><dc:creator>\n        Schebesch, A<\/dc:creator><dc:publisher>\n        SIAM PUBLICATIONS<\/dc:publisher><dc:date>\n        2006-01-01<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/epubs.surrey.ac.uk\/1550\/1\/fulltext.pdf<\/dc:identifier><dc:identifier>\n          Wulff, C and Schebesch, A  (2006) Numerical continuation of symmetric periodic orbits   SIAM JOURNAL ON APPLIED DYNAMICAL SYSTEMS, 5 (3).  pp. 435-475.      <\/dc:identifier><dc:relation>\n        10.1137\/050637170<\/dc:relation><dc:language>\n        English<\/dc:language><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/epubs.surrey.ac.uk\/1550\/","10.1137\/050637170"],"year":2006,"topics":[],"subject":["Article","PeerReviewed"],"fullText":"Numerical Continuation of Symmetric Periodic Orbits\nClaudia Wulff\nDepartment of Mathematics & Statistics\nUniversity of Surrey\nGuildford GU2 7XH, United Kingdom\nemail: c.wulff@surrey.ac.uk\nand\nAndreas Schebesch\nFachbereich Mathematik und Informatik\nFreie Universita\u00a8t Berlin\n14195 Berlin, Germany\nemail: schebesc@inf.fu-berlin.de\nDedicated to the memory of our dear friend and colleague Karin Gatermann\nAbstract\nThe bifurcation theory and numerics of periodic orbits of general dynamical systems is\nwell developed, and in recent years there has been rapid progress in the development of a\nbifurcation theory for symmetric dynamical systems. But there are hardly any results on\nthe numerical computation of those bifurcations yet. In this paper we show how spatio-\ntemporal symmetries of periodic orbits can be exploited numerically. We describe methods\nfor the computation of symmetry breaking bifurcations of periodic orbits for free group\nactions and show how bifurcations increasing the spatiotemporal symmetry of periodic orbits\n(including period halving bifurcations and equivariant Hopf bifurcations) can be detected\nand computed numerically. Our pathfollowing algorithm is based on a multiple shooting\nalgorithm for the numerical computation of periodic orbits via an adaptive Poincare\u00b4 section\nand a a tangential continuation method with implicit reparametrization.\nAMS subject classification. 37G15, 37G40, 37M20, 65P30\nKeywords. Numerical continuation, symmetry breaking bifurcations, symmetric periodic orbits\n1\nContents\n1 Introduction 3\n2 Continuation of symmetric periodic orbits 4\n2.1 Computation of single periodic orbits - single shooting method . . . . . . . . . . 4\n2.2 Symmetries of periodic orbits and how to exploit them . . . . . . . . . . . . . . . 6\n2.3 Multiple shooting approach . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 8\n2.4 Continuation of nondegenerate periodic orbits . . . . . . . . . . . . . . . . . . . . 10\n2.4.1 Single shooting method . . . . . . . . . . . . . . . . . . . . . . . . . . . . 10\n2.4.2 Multiple shooting ansatz . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11\n2.5 Turning points . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 12\n3 Computation of flip down and flip up bifurcations 12\n3.1 Detection and computation of period doubling bifurcations . . . . . . . . . . . . 13\n3.1.1 Numerical detection of period doubling bifurcations . . . . . . . . . . . . 14\n3.1.2 Computation of period doubling bifurcation points . . . . . . . . . . . . . 14\n3.1.3 Computation of start off directions for the bifurcating branch . . . . . . . 15\n3.2 Detection and computation of period halving bifurcations . . . . . . . . . . . . . 16\n3.2.1 Detection of period halving bifurcations . . . . . . . . . . . . . . . . . . . 16\n3.2.2 Computation of period halving bifurcation points and start off directions 17\n3.3 Bifurcations of periodic orbits with Zp-symmetry . . . . . . . . . . . . . . . . . . 18\n3.3.1 Flip pitchfork bifurcation . . . . . . . . . . . . . . . . . . . . . . . . . . . 18\n3.3.2 Flip doubling bifurcation . . . . . . . . . . . . . . . . . . . . . . . . . . . 19\n3.4 Numerical computation of symmetry breaking bifurcations . . . . . . . . . . . . . 19\n3.4.1 Detection and computation of flip down bifurcations . . . . . . . . . . . . 19\n3.4.2 Initialization of the bifurcating branch . . . . . . . . . . . . . . . . . . . . 19\n3.5 Numerical computation of symmetry increasing bifurcations . . . . . . . . . . . . 20\n3.5.1 Detection of flip up bifurcations . . . . . . . . . . . . . . . . . . . . . . . . 20\n3.5.2 Computation of flip up points and start off tangents . . . . . . . . . . . . 21\n4 Computation of equivariant Hopf points 21\n4.1 Hopf bifurcations for non-symmetric systems . . . . . . . . . . . . . . . . . . . . 21\n4.1.1 Detection of Hopf points along branches of periodic orbits . . . . . . . . . 22\n4.1.2 Computation of Hopf bifurcations of non-symmetric systems . . . . . . . 22\n4.2 Detection and computation of equivariant Hopf points . . . . . . . . . . . . . . . 24\n4.2.1 Equivariant Hopf points . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24\n4.2.2 Detection of equivariant Hopf points . . . . . . . . . . . . . . . . . . . . . 25\n4.2.3 Computation of equivariant Hopf bifurcations . . . . . . . . . . . . . . . . 25\n5 Applications 31\n5.1 The Lorenz model - comparison with AUTO and CONTENT . . . . . . . . . . . 31\n5.2 Symmetry breaking bifurcations in coupled cells . . . . . . . . . . . . . . . . . . . 33\n5.3 Electronic ring oscillator . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35\nConclusion 39\n2\n1 Introduction\nThe bifurcation theory and numerics of periodic orbits of general dynamical systems is well\ndeveloped, see e.g. [1, 8, 13, 16, 17]. Frequently the considered problems possess certain sym-\nmetries. Symmetries change the generic behaviour of a dynamical system dramatically, and in\nrecent years there has been rapid progress in the development of a bifurcation theory for periodic\norbits of symmetric dynamical systems, see eg [9, 11, 18, 19, 24]. But there are hardly any results\non the numerical computation of those bifurcations yet. Gatermann and Hohmann [10] devel-\noped numerical methods for the exploitation of symmetry and the computation of symmetry\nbreaking and symmetry increasing bifurcations of stationary solutions and implemented those\nmethods in the mixed symbolic numerical code SYMCON. They treat finite symmetry groups.\nCliffe et al [2] developed numerical methods for the computation of bifurcations of stationary\nsolutions in the case of continuous rotational symmetries.\nIn this paper we start a systematic theory on numerical bifurcation of symmetric periodic\norbits by extending the methods of Gatermann and Hohmann [10] to periodic solutions. We\nconsider a parameter dependent dynamical system\nx\u02d9 = f(x, \u03bb), f : Rn \u00d7 R \u2192 Rn, (1.1)\nwhich is equivariant with respect to a finite symmetry group \u0393 \u2282 GL(n), i.e.,\n\u03b3f(x, \u03bb) = f(\u03b3x, \u03bb) \u2200 \u03b3 \u2208 \u0393, x \u2208 Rn, \u03bb \u2208 R.\nIn most parts of this paper we assume that \u0393 acts freely, i.e., \u03b3x 6= x for all \u03b3 6= id and\nx \u2208 Rn. We numerically continue periodic solutions with respect to the parameter \u03bb exploiting\npossible symmetries and computing symmetry breaking and symmetry increasing bifurcations\nof those periodic orbits. For the computation of periodic orbits we employ the multiple shooting\nalgorithm presented by Deuflhard [5], which we briefly recall in Section 2.1. Section 2.2 is\nconcerned with the exploitation of spatial and spatio-temporal symmetries of periodic orbits\nin the multiple shooting context. In Section 2.4 the aspect of continuation is added and the\npathfollowing method of Deuflhard, Fiedler and Kunkel [7] is used for the continuation of periodic\nsolutions in the single and multiple shooting approach. A different method for the numerical\ncontinuation of periodic solutions with symmetry based on Fourier expansions has been presented\nby Dellnitz [4].\nIn Sections 3 and 4 bifurcations of symmetric periodic orbits are treated. First symmetry\nbreaking and symmetry increasing bifurcations of periodic orbits are considered (Section 3) and\nthen equivariant Hopf bifurcations along periodic orbits (Section 4). In these sections numerical\ntechniques of Gatermann and Hohmann [10] are extended from stationary solutions to periodic\nsolutions.\nGeneric symmetry breaking bifurcations of periodic orbits of free group actions correspond\nto period doubling bifurcations in the space of group orbits, or equivalently, to period doubling\nbifurcations of the symmetry reduced Poincare\u00b4 map [18]. In Section 3.4 we show how such\nsymmetry breaking bifurcations can be detected and computed numerically by extending the\ncorresponding methods for non-symmetric systems, c.f. Section 3.1.\nWe have also developed methods for the computation of bifurcations which increase the\nspatio-temporal symmetry of the periodic solution, in particular an algorithm for the compu-\ntation of period halving points which is based on the methods for computing period doubling\nbifurcation points, see Sections 3.2 and 3.5.\nIn Section 4 we derive methods for the detection of equivariant Hopf points along branches\nof symmetric periodic orbits and present an extended system for the computation of equivariant\n3\nHopf points. The main problem is how to deal with multiple Hopf eigenvalues forced by sym-\nmetry. The issue of numerically dealing with multiple critical eigenvalues was treated by Cliffe\net al [2] in the case of continuation of stationary solutions with continuous rotation symmetry.\nThe numerical methods we present have been implemented in the C code SYMPERCON [20].\nIn Section 5, examples are presented to illustrate the performance of the developed algorithmic\ntools. In Subsection 5.1 we use both SYMPERCON, AUTO [8] and CONTENT [17] for the\ncomputation of the period doubling cascade of the Lorenz equations to demonstrate the better\nperformance of SYMPERCON. In Section 5.2 we compute symmetry breaking bifurcations of\nperiodic orbits of four coupled cells. In Section 5.3 we show how oscillations of an electric circuit\ncan be computed efficiently by exploiting their spatio-temporal symmetry.\nWe partly follow the unpublished manuscripts [20, 22, 23]. For a description of the program\nSYMPERCON see [22, 20].\nAcknowledgements\nThis paper is dedicated to the memory of Karin Gatermann who died on New Year\u2019s Day 2005.\nShe pioneered the use of symmetry methods in numerical bifurcation theory and introduced one\nof us (CW) to this topic back in 1991. Karin gave us lots of valuable advice and encouragement\nand was a dear friend.\nCW was partially supported by the Nuffield Foundation and by a European Union Marie\nCurie fellowship under contract number HPMF-CT-2000-00542, AS acknowledges funding by\na European Union Marie Curie studentship at the Marie-Curie Training Site \u201cUniversity of\nWarwick\u201d during the academic year 2001\/2002. CW thanks the Freie Universita\u00a8t Berlin, in\nparticular the research group of Bernold Fiedler, for their hospitality during visits when parts\nof this paper were written. We both thank Mark Roberts for many helpful discussions and for\ninviting us to the Warwick Symposium on Geometric Mechanics and Symmetry in 2001\/2002\nduring which this project was started. Finally we acknowledge the EU-TMR network MASIE\nfor funding our participation in various summer schools, workshops and conferences.\n2 Continuation of symmetric periodic orbits\nIn this section we review the multiple shooting method of Deuflhard [5] for the computation of\nperiodic orbits, show how symmetries of periodic orbits can be exploited within the multiple\nshooting approach and present a continuation method for symmetric periodic orbits based on\nthe Gauss-Newton method.\n2.1 Computation of single periodic orbits - single shooting method\nIn this subsection we briefly recollect the algorithm for the computation of periodic orbits of an\nautonomous ordinary differential equation (ODE)\nx\u02d9 = f(x), f : Rn \u2192 Rn, (2.1)\nwhich has been introduced in [5].\nLet \u03a6t(\u00b7) be the flow of (2.1) and let x(t) = \u03a6t(x\n\u2217) be a periodic solution of (2.1) of period\nT \u2217, i.e., x(T \u2217) = x\u2217. Then any time shifted solution x(t+ t0), t0 \u2208 R, is also a periodic solution,\nbecause the system (2.1) is autonomous. All these solutions determine the same periodic orbit\nP = Px(\u00b7) = {x(t), t \u2208 R}.\n4\nIn order to avoid this non-uniqueness a well known analytical technique is to fix a Poincare\u00b4\nsection S = Sx\u2217 which is an (n \u2212 1)-dimensional affine hyperplane transversal to the periodic\norbit P at the point x\u2217, see e.g. [16]. Let us use the Poincare\u00b4 section orthogonal to the orbit\nS = Sx\u2217 = x\n\u2217 + S\u2032x\u2217 where S\n\u2032\nx\u2217 = span(f(x\n\u2217))\u22a5.\nThen x\u2217 is a fixed point of the Poincare\u00b4 map (first return map) \u03a0 : S \u2192 S.\nDefinition 2.1 We say that a periodic orbit P with period T \u2217 is non-degenerate if\nDx\u03a0(x)|x=x\u2217 \u2212 id\nis regular for x\u2217 \u2208 P.\nIn this case x\u2217 is a locally unique fixed point of the Poincare\u00b4 map \u03a0 and a locally unique root\nof the equation\nF(x) := \u03a0(x) \u2212 x = 0, where F : S \u2192 S.\nNumerically one can either fix the phase by an additional phase condition, as described eg in\n[1, 16], or solve an underdetermined equation, as in [5]. We follow the latter approach and\ncompute a point x = x\u2217 on the periodic solution together with its period T = T \u2217 by solving the\nunderdetermined equation F (y) = 0. Here F : Rn \u00d7 R \u2192 Rn is given by\nF (x, T ) = \u03a6T (x)\u2212 x = 0, where y = (x, T ). (2.2)\nWe solve (2.2) by an underdetermined Gauss-Newton method:\n\u2206yk = \u2212DF (yk)+F (yk),\nyk+1 = yk + \u2206yk,\n(2.3)\nwhere DF (yk)+ denotes the Moore-Penrose pseudo-inverse of DF (yk). Remember that for\nA \u2208 Mat(m, n), m \u2264 n, rank A = m, x \u2208 Rn, b \u2208 Rm, x = A+b is defined by\nAx = b, x\u22a5 ker(A),\nwhere ker(A) is the kernel of A. So x = A+b is the smallest in norm solution of Ax = b and\nhence the Newton correction \u2206yk is the smallest solution of the underdetermined linear system\nin (2.3).\nThe Jacobian DF (x, T ) of (2.2) in the solution (x\u2217, T \u2217) is given by\nDF (x\u2217, T \u2217) = [\u2212 id +Dx\u03a6T\u2217(x\n\u2217), f(\u03a6T\u2217(x\n\u2217))] = [\u2212 id+Dx\u03a6T\u2217(x\n\u2217), f(x\u2217)]. (2.4)\nTherefore a kernel vector tf of DF (y\u2217) at the solution point y\u2217 = (x\u2217, T \u2217) is the tangent\ntf = (f(x\u2217), 0) to the trajectory.\nRemark 2.2 This approach can be interpreted as computing periodic orbits in an adaptive\nPoincare\u00b4 section, which is approximately orthogonal to the periodic orbit: Since for the kernel\nvectors tk = (tkx, t\nk\nT ) of DF (y\nk) we have tk \u2192 tf as k \u2192 \u221e, the Gauss-Newton iterate xk+1 =\nxk + \u2206xk lies in the adaptive Poincare\u00b4 section Sxk = x\nk + span(tkx)\u22a5 \u2248 x\n\u2217 + span(f(x\u2217))\u22a5.\nIf x\u2217 lies on a non-degenerate periodic orbit, i.e., if Dx\u03a0(x\n\u2217) \u2212 id is regular, then by (2.4)\nthe Jacobian DF (x\u2217, T \u2217) is regular. Since this condition does not depend on the chosen point\nx\u2217 on P we get the following convergence result:\nProposition 2.3 If the periodic orbit P through x\u2217 = \u03a6T\u2217(x\n\u2217) is non-degenerate then there is\na tubular neighbourhood U of the periodic orbit P where there is no other periodic solution with\nperiod near T \u2217 and which is such that the Gauss-Newton method (2.3) applied to (2.2) converges\nfor initial data x\u02c6 \u2208 U and T\u02c6 \u2248 T \u2217.\nBefore we review the extension of this basic shooting method to the multiple shooting context\nwe show how symmetries of periodic orbits can be exploited numerically.\n5\n2.2 Symmetries of periodic orbits and how to exploit them\nLet \u0393 \u2286 GL(n) be a finite group and let f be \u0393-equivariant [11], ie:\nf(\u03b3x) = \u03b3f(x) \u2200 x \u2208 Rn, \u03b3 \u2208 \u0393. (2.5)\nThis condition on the vectorfield (2.1) implies that if x(t) is a solution of the dynamical system\n(2.1) then also \u03b3 x(t) is a solution. Hence the flow \u03a6t(\u00b7) of (2.1) is also \u0393-equivariant: \u03b3\u03a6t(x0) =\n\u03a6t(\u03b3x0) for every \u03b3 \u2208 \u0393, x0 \u2208 R\nn.\nFor any x \u2208 Rn the element \u03b3 x is called conjugate to x [11]. An element \u03b3 \u2208 \u0393 is called a\nsymmetry of x \u2208 Rn if \u03b3x = x; the set of all symmetries of x (isotropy subgroup of x) is given\nby K = \u0393x = {\u03b3 \u2208 \u0393 | \u03b3x = x}. It can be seen easily that the vectorfield f of (2.1) maps the\nfixed point space of K\nFix(K) = {x \u2208 Rn | \u03b3x = x \u2200 \u03b3 \u2208 K}\ninto itself. Thus we can restrict the ODE (2.1) to the fixed point space Fix(K) ' Rnred which has\na lower dimension nred \u2264 n. In this way we obtain a symmetry reduced system fred : R\nnred \u2192\nRnred which can be computed symbolically (see Gatermann, Hohmann [10]). The symmetry\ngroup acting on Fix(K) is N(K)\/K where N(K) is the normalizer of K.\nRemark 2.4 [11] If a finite group (or, more generally, a compact group) \u0393 acts linearly on the\nphase space X = Rn, i.e., if\n\u03b3x := \u03d1(\u03b3)x, \u03b3 \u2208 \u0393, x \u2208 X,\nwhere \u03d1 : \u0393 \u2192 GL(n) is a homomorphism, then the phase space X = Rn can be decomposed\ninto a sum Rn = X1 \u2295X2 \u2295 . . .\u2295Xl where the Xi are \u0393-invariant vector spaces and can not be\ndecomposed into smaller \u0393-invariant subspaces. Such vectorspaces Xi are called \u0393-irreducible\nand their corresponding reduced group actions \u03d1i := \u03d1|Xi are called irreducible representations\nof the action of \u0393 on Rn. If a \u0393-irreducible subspace X is also irreducible as a vectorspace over\nC, then its irreducible representation \u03d1|X is called an absolutely irreducible representation. If\nit is reducible over C it is called a complex irreducible representation. We will encounter the\nconcept of irreducible representations in the computation of bifurcations, c.f. Section 4.2.\nThe spatial symmetries K of periodic solutions x(t) are those group elements \u03b3 \u2208 \u0393 which leave\neach point on the periodic orbit invariant:\nK := \u0393x(t) = {\u03b3 \u2208 \u0393 | \u03b3x(t) = x(t) \u2200 t}.\nSince the flow \u03a6t is \u0393-equivariant the set of spatial symmetries K of a periodic solution x(t)\ndoes not depend on the time t. In addition to spatial symmetries there are also spatio-temporal\nsymmetries which leave the periodic orbit P := Px(\u00b7) invariant as a whole but not pointwise,\ni.e., the spatio-temporal symmetries of a periodic orbit P are given by\nL := {\u03b3 \u2208 \u0393 | \u03b3P = P}.\nEach \u03b3 \u2208 L corresponds to a phase shift \u0398(\u03b3) T \u2217 of the T \u2217-periodic solution x(t):\n\u03b3 \u2208 L \u21d2 x(t) = \u03b3x(t + \u0398(\u03b3) T \u2217), where \u0398(\u03b3) \u2208 S1 ' R\/Z. (2.6)\nSo spatio-temporal symmetries come in pairs (\u03b3, \u0398(\u03b3)) \u2208 \u0393 \u00d7 S1. We define an action of the\nspatio-temporal symmetry group \u0393\u00d7S1, where S1 = R\/Z, on T \u2217-periodic solutions x(t) of (2.1)\nas follows:\n((\u03b3, \u03b8)x)(t) := \u03b3x(t + \u03b8T \u2217), (\u03b3, \u03b8) \u2208 \u0393\u00d7 S1. (2.7)\n6\nNote that \u0398 : L \u2192 R\/Z is a group homomorphism with the spatial symmetries K as kernel and\nthat\nL\/K \u2261 Z`, ` \u2208 N, (2.8)\nsee [11]. The spatial symmetries of periodic solutions can be exploited by restriction onto the\nfixed point space Fix(K), i.e., by using a symmetry reduced system fred : Fix(K) \u2192 Fix(K).\nFrom now on we assume that the spatial symmetry K of the periodic orbit is trivial. Then\nthe spatio-temporal symmetries of the periodic orbit form a finite cyclic group L = Z`. In\nbifurcation theory the spatio-temporal symmetries of periodic orbits are taken into account by\nstudying the reduced Poincare\u00b4 map. It was first introduced by Fiedler [9] and later used by\nLamb, Melbourne and Wulff [18, 19] in order to classify symmetry breaking bifurcations of\nperiodic orbits, see also Section 3. Let \u03b1 \u2208 L = Z` be that element in L that corresponds to the\nsmallest possible non-zero phase shift T \u2217\/`:\n\u03b1 x(t +\nT \u2217\n`\n) = x(t) \u2200 t. (2.9)\nWe call this spatio-temporal symmmetry the drift symmetry of the periodic orbit [25]. For\nx\u2217 \u2208 P define the Poincare\u00b4 section as usual by S = x\u2217 + span(f(x\u2217))\u22a5. Then the reduced\nPoincare\u00b4 map is defined as\n\u03a0red = \u03b1\u03a0\u02c6, \u03a0\u02c6 : S \u2192 \u03b1\n\u22121 S, (2.10)\nwhere \u03b1 is the drift symmetry of the periodic orbit, i.e., satisfies (2.9), and \u03a0\u02c6 maps x \u2208 S into\nthe point where the positive semi-flow through x first hits \u03b1\u22121 S [9]. The fixed point equation\n\u03a0red(x) = x or, equivalently, the equation\nF(x) = \u03a0red(x)\u2212 x = 0, where F : S \u2192 S,\nthen determines periodic orbits with spatio-temporal symmetry L. Note that in the case of\ntrivial symmetry ` = 1, \u03b1 = id, the reduced Poincare\u00b4 map \u03a0red becomes the standard Poincare\u00b4\nmap \u03a0 introduced in Section 2.1. In order to numerically exploit spatio-temporal symmetries\nwe proceed as in Section 2.1: Each point x on a T -periodic orbit with drift symmetry \u03b1 satisfies\nthe underdetermined equation\nF : Rn \u00d7 R \u2192 Rn, F (x, T ) = \u03b1\u03a6T\n`\n(x) \u2212 x = 0. (2.11)\nThis system is analogous to the corresponding underdetermined system (2.2) in the case of trivial\nsymmetry and reduces to it in the case \u03b1 = id, ` = 1. It can also be solved by a Gauss-Newton\nmethod. Note that it suffices to compute the flow \u03a6t(\u00b7) and the Wronskian matrix Dx\u03a6t(\u00b7) only\nup to time T` instead of T , which is a remarkable reduction of the computational cost in the\ncase of high spatio-temporal symmetry. In a solution point (x\u2217, T \u2217) we have\nDF (x\u2217, T \u2217) = [\u03b1Dx\u03a6T\u2217\n`\n(x\u2217)\u2212 id,\n1\n`\nf(\u03b1\u03a6T\u2217\n`\n(x\u2217))] = [\u03b1Dx\u03a6T\u2217\n`\n(x\u2217)\u2212 id,\n1\n`\nf(x\u2217)], (2.12)\nanalogous to the case of trivial symmetry, c.f. (2.4). In particular DF (x\u2217, T \u2217) is closely related\nto DxF(x\n\u2217) = Dx\u03a0red(x)|x=x\u2217 \u2212 id. We extend the definition of non-degeneracy to symmetric\nperiodic orbits as follows:\nDefinition 2.5 We say that a symmetric periodic orbit P with drift symmetry \u03b1 is non-degenerate\nif D\u03a0red(x\n\u2217)\u2212 id is regular for x\u2217 \u2208 P where \u03a0red is from (2.10).\nFrom (2.12) we conclude that DF (x\u2217, T \u2217) in the periodic orbit is regular if and only if the\nperiodic orbit is non-degenerate, and so we get the following proposition which is analogous to\nProposition 2.3:\n7\nProposition 2.6 If the symmetric periodic orbit through x\u2217 = \u03b1\u03a6T\u2217\n`\n(x\u2217) is non-degenerate in\nthe sense of Definition 2.5 then there is a tubular neighbourhood U about the periodic orbit P\nthrough x\u2217 with the property that there is no other periodic orbit with symmetry L and period\nnear T \u2217 in U and which is such that the Gauss-Newton method (2.3) applied to (2.11) converges\nfor initial values x\u02c6 \u2208 U , T\u02c6 \u2248 T \u2217.\n2.3 Multiple shooting approach\nIn order to numerically compute unstable symmetric periodic solutions we use the just described\nalgorithm in the multiple shooting context (c.f. [5]): we compute k points on a periodic orbit\nwith spatio-temporal symmetry L = Z`, trivial isotropy and drift symmetry \u03b1 by solving the\nunderdetermined equation\nF (x1, . . . , xk, T ) = 0, F : R\nN \u2192 RM , (2.13)\nwhere N = M + 1 = kn + 1, 0 = s1 < . . . < sk+1 = 1 is a partition of the unit interval,\n\u2206si = si+1 \u2212 si for i = 1, . . . k, and\nFi(x1, . . . , xk, T ) =\n{\n\u03a6\u2206siT\n`\n(xi)\u2212 xi+1 for i = 1, . . . , k \u2212 1,\n\u03b1\u03a6\u2206skT\n`\n(xk)\u2212 x1 for i = k.\n(2.14)\nThe linear systems which arise in the Gauss-Newton method are of the form Jy = b, where\ny = (x, T ) \u2208 Rnk+1, x = (x1, . . . , xk), b = (b1, . . . , bk),\nJ = DF (x, T ) =\n\uf8eb\uf8ec\uf8ec\uf8ec\uf8ec\uf8ec\uf8ed\nG1 \u2212 id g1\nG2 \u2212 id g2\n. . .\n. . .\n...\nGk\u22121 \u2212 id gk\u22121\n\u2212 id Gk gk\n\uf8f6\uf8f7\uf8f7\uf8f7\uf8f7\uf8f7\uf8f8 = [G, g], (2.15)\nwhere G is an (nk, nk)-matrix, g an nk-vector, and\nGi = Dx\u03a6\u2206siT\n`\n(xi), i = 1, 2, . . . , k \u2212 1,\nGk = \u03b1Dx\u03a6\u2206skT\n`\n(xk),\ngi = DT Fi(x, T ) = DT \u03a6\u2206siT\n`\n(xi) =\n\u2206si\n` f(\u03a6\u2206siT\n`\n(xi)), i = 1, . . . , k \u2212 1,\ngk =\n\u2206sk\n` \u03b1f(\u03a6\u2206skT\n`\n(xk)).\nWe have\nJy = b \u21d4 [G, g]\n(\nx\nT\n)\n= b \u21d4 Gx = b\u2212 gT,\nso we can apply Gaussian block elimination to G to solve these linear systems. This yields the\nfollowing algorithm:\n1.) Compute the condensed right hand side\nbc := C(G, b, k) = bk + Gkbk\u22121 + \u00b7 \u00b7 \u00b7+ Gk \u00b7 \u00b7 \u00b7G2b1.\n2.) Compute the condensed matrix [Gc, gc] with\nGc := Gk \u00b7 \u00b7 \u00b7G1, gc := C(G, g, k). (2.16)\n8\n3.) Compute a solution of the condensed system [Gc \u2212 id, gc]\n(\nx1\nT\n)\n= bc, e.g.(\nx1\nT\n)\n= [Gc \u2212 id, gc]\n+ bc,\nusing QR-decomposition.\n4.) Compute x via the explicit recursion\nxi = Gi\u22121xi\u22121 \u2212 bi\u22121 + gi\u22121T for i = 2, . . . , k. (2.17)\nWe have now obtained a solution y = J\u2212b where y = (x, T ) and J\u2212 is an outer inverse of J . In\norder to compute the solution J+b where J+ is the Moore-Penrose pseudo-inverse of J we have\nto add one more step:\n5.) Compute the kernel vector t = (tx, tT ) of J , where tx = (t1, t2, . . . , tk). Starting from a\ntangent of the condensed system\n(\nt1\ntT\n)\n[Gc \u2212 id, gc]\n(\nt1\ntT\n)\n= 0\nwe obtain a tangent t of the whole system by\nti = Gi\u22121ti\u22121 + gi\u22121tT for i = 2, . . . , k.\nIn the end we project y \u2192 y \u2212 \u3008y,t\u3009\u3008t,t\u3009 t.\nAn easy computation shows that in a solution point y\u2217 = (x\u2217, T \u2217) we have\n[Gc \u2212 id, gc] = [\u03b1Dx\u03a6T\u2217\n`\n(x\u22171)\u2212 id,\n1\n`\nf(x\u22171)], (2.18)\nso the condensed matrix Ec := [Gc \u2212 id, gc] equals the Jacobian (2.12) of the single shooting\napproach in the point x\u22171. The Jacobian J is regular iff [Gc\u2212 id, gc] is regular. Hence we get the\nfollowing result which is analogous to Proposition 2.6:\nTheorem 2.7 The Jacobian J of the multiple shooting system (2.13) is regular at the symmetric\nperiodic orbit if and only if the periodic orbit is non-degenerate in the sense of Definition 2.5. In\nthis case the Gauss-Newton method (2.3) applied to (2.13) converges for sufficiently good initial\ndata.\nRemarks 2.8\na) The approach for symmetry exploitation in the multiple shooting approach can be trans-\nferred to collocation methods (used in AUTO and CONTENT [8, 17]) since collocation can\nbe viewed as a special case of a multiple shooting method where the number of grid points\ncorresponds to the number of multiple shooting points k and the initial value problem\nsolver consists of only one integration step of a collocation method. The advantage of the\nmultiple shooting approach is that it allows the use of adaptive order and stepsize initial\nvalue problem solvers for the computation of the flow \u03a6t(x) and the Wronskians Dx\u03a6t(x)\nwhich we use for the evaluation of F rsp. DF , like the extrapolation codes of Deufhard [6].\nThese techniques have been implemented in the code SYMPERCON [22, 20], see Section\n5.1 for a comparison with AUTO and CONTENT.\nb) Note that in the program packages AUTO and CONTENT [8, 17] a phase condition is used\nto obtain a unique periodic orbit, whereas we solve an underdetermined equation for the\nperiodic orbit. Since we use the Moore-Penrose pseudo-inverse to compute the corrections\nof the Gauss-Newton method \u2206yk = \u2212DF (yk)+F (yk), we have \u2206yk\u22a5 ker(DF (yk)). Here\nker(DF (yk)) \u2248 ker(DF (y\u2217)) = span(tf ),\nwhere\ntf = (f(x\u22171), . . . , f(x\n\u2217\nk), 0, 0). (2.19)\nThe condition \u2206yk\u22a5 ker(DF (yk)) is therefore an \u201dadaptive phase condition\u201d which is such\nthat the correction \u2206yk is the smallest solution of the equation for the Newton corrections\nDF (yk)\u2206yk = \u2212F (yk), c.f. Remark 2.2.\nc) Dellnitz [3, 4] computes symmetric periodic orbits by a Galerkin ansatz based on Fourier\nmodes. This method is effective near Hopf bifurcations since in this situation periodic\norbits can be approximated by few Fourier modes.\n2.4 Continuation of nondegenerate periodic orbits\nIn this section we show how the pathfollowing method for stationary solutions described in [7] can\nbe extended to the case of symmetric periodic solutions. We consider the parameter dependent\n\u0393-equivariant dynamical system x\u02d9 = f(x, \u03bb) from (1.1) again and first look at stationary solutions\nof (1.1),\nf(y) = 0, f : Rn+1 \u2192 Rn, y = (x, \u03bb). (2.20)\nIf y\u2217 = (x\u2217, \u03bb\u2217) is a stationary solution and Dyf(y) is regular at y\n\u2217 then (2.20) locally defines a\nsolution branch. We apply the tangential continuation method based on implicit reparametriza-\ntion presented in [7] to compute this solution branch. By writing y = (x, \u03bb) we want to express\nthat the parameter \u03bb does not play any extraordinary role so that turning points can be treated\neasily. The pathfollowing algorithm works as follows: if a solution y\u2217 is given a new guess y\u02c6 is\ncomputed by setting y\u02c6 = y\u2217 + \u000f t(y\u2217) where t(y) is the normalized kernel vector of Dyf(y), and\nhence the continuation tangent, and \u000f is a suitably chosen stepsize. Then an underdetermined\nGauss-Newton method as in (2.3) is used for the iteration from the guess y\u02c6 back to the solution\npath. The stepsize control is described in [7]. We now show how to apply this continuation\nmethod to symmetric periodic orbits.\n2.4.1 Single shooting method\nIn the case of symmetric periodic solutions we want to compute fixed points of the parameter\ndependent reduced Poincare\u00b4 map \u03a0red : S \u00d7 R \u2192 S\n\u03a0red(x, \u03bb) = x \u21d4 F(x, \u03bb) := \u03a0red(x, \u03bb) \u2212 x = 0, (2.21)\nor, equivalently, solutions of the parameter dependent nonlinear equation\nF(x, \u03bb) = 0, F : S \u00d7 R \u2192 S.\nWe can in principle apply the above described continuation method to this equation. The\ncontinuation tangent in a solution point (x\u2217, \u03bb\u2217) is simply the kernel vector t\u2217F of DF(x\n\u2217, \u03bb\u2217).\nBut in the numerical realization of this idea we want to use the method of adaptive Poincare\u00b4\nsections of Sections 2.1, 2.2, c.f. Remark 2.2. So we again introduce the period as a new variable\nand solve (in the single shooting approach) the underdetermined equation\nF : Rn+2 \u2192 Rn, F (x, T, \u03bb) = \u03b1\u03a6T\n`\n(x, \u03bb) \u2212 x = 0, (2.22)\n10\nby a Gauss-Newton procedure. Now the kernel ker(DF ) of DF is two-dimensional. In a solution\npoint (x\u2217, \u03bb\u2217) one kernel vector of DF is the tangent to the periodic orbit\ntf = (f(x\u2217, \u03bb\u2217), 0, 0) \u2208 ker(DF (x\u2217, T \u2217, \u03bb\u2217)).\nWe want to determine the continuation tangent t\u2217 in such a way that it corresponds to the\ntheoretical tangent vector t\u2217F . First the continuation tangent has to be in the kernel of DF ,\nand second the continuation tangent should lie in the Poincare\u00b4 section S. Since we choose the\nPoincare\u00b4 section orthogonal to the orbit, this leads to the conditions\nt\u2217 \u2208 ker(DF ), t\u2217\u22a5 tf . (2.23)\nThe Jacobian in the solution point (x\u2217, T \u2217, \u03bb\u2217) is given by\nDF (x\u2217, T \u2217, \u03bb\u2217) = [\u03b1Dx\u03a6T\u2217\n`\n(x\u2217, \u03bb\u2217)\u2212 id,\n1\n`\nf(x\u2217, \u03bb\u2217), \u03b1D\u03bb\u03a6T\u2217\n`\n(x\u2217, \u03bb\u2217)], (2.24)\nand therefore we get the following proposition, analogous to Proposition 2.6:\nProposition 2.9 Let x\u2217 lie on a T \u2217-periodic orbit P of (1.1) with symmetry L = Z` and drift\nsymmetry \u03b1. Then the Jacobian DF (x\u2217, T \u2217, \u03bb\u2217) is regular if and only if\nDF(x\u2217, \u03bb\u2217) = [DxF(x\n\u2217, \u03bb\u2217), D\u03bbF(x\n\u2217, \u03bb\u2217)] = [Dx\u03a0red(x\n\u2217)\u2212 id, D\u03bb\u03a0red(x\n\u2217)] (2.25)\nis regular. In this case the path of periodic solutions given by (2.21) is locally unique in the\nfollowing sense: there is a tubular neighbourhood U of the periodic orbit P such that every\nperiodic solution x\u02c6(t) in this neighbourhood with period T\u02c6 close to T \u2217, parameter \u03bb\u02c6 close to \u03bb\u2217\nand drift symmetry \u03b1 lies on the path of periodic solutions defined by (2.21). Moreover the\nGauss-Newton method (2.3) applied to (2.22) converges to a periodic solution on this path for\ninitial data x\u02c6 \u2208 U , T\u02c6 \u2248 T \u2217, \u03bb\u02c6 \u2248 \u03bb\u2217.\nNote that for non-degenerate periodic orbits the condition of Proposition 2.9 is always satisfied,\nbut it also holds in a turning point bifurcation, see Section 2.5.\n2.4.2 Multiple shooting ansatz\nIn the multiple shooting approach we solve the parameter dependent equation\nF (x1, . . . , xk, T, \u03bb) = 0, F : R\nnk \u00d7 R\u00d7 R \u2192 Rnk, (2.26)\nwhere F is as in (2.14). Nearly everything carries over from Section 2.3, we just have one more\ncolumn in the Jacobian consisting of the parameter derivatives\nPi = D\u03bb\u03a6\u2206siT\n`\n(xi, \u03bb), i = 1, . . . , k \u2212 1, Pk = \u03b1D\u03bb\u03a6\u2206skT\n`\n(xk , \u03bb).\nTherefore, to solve the linear equations Jy = b, y = (x1, . . . , xk, T, \u03bb), we have to compute an\nadditional condensed vector (step 1 in the Gaussian block elimination algorithm), namely\npc := C(P ) = Pk + GkPk\u22121 + \u00b7 \u00b7 \u00b7+ Gk \u00b7 \u00b7 \u00b7G2P1.\nThe condensed matrix in steps 2 and 3 is of the form [Gc \u2212 id, gc, pc], the recursion (step 4) has\nto be modified to\nxi = Gi\u22121xi\u22121 \u2212 bi\u22121 + gi\u22121T + Pi\u22121\u03bb for i = 2, . . . , k,\n11\nand in step 5 we compute an orthonormal basis of the 2-dimensional kernel of J and project the\npreliminary solutions y = J\u2212b onto the orthogonal complement of this kernel.\nAs can be seen from the Gaussian block elimination, J has full rank if the condensed matrix\nEc := [Gc \u2212 id, gc, pc] has full rank. A simple computation shows that the matrix Ec equals the\nJacobian of the single shooting approach (2.24). Thus the Gauss-Newton method (2.3) applied\nto the multiple shooting system of equations (2.26) converges under the same conditions to a\nsolution as the Gauss-Newton method of the single shooting method, namely if the assumptions\nof Proposition 2.9 are satisfied.\nAs in the case of the single shooting method, we choose the continuation tangent t\u2217 as the\nkernel vector of DF (y\u2217) (with F from (2.26)) which is orthogonal to tf from (2.19).\n2.5 Turning points\nBefore we come to the detection and computation of bifurcations of symmetric periodic orbits\nin Sections 3 and 4 we first consider turning points of symmetric periodic orbits. We saw that\nperiodic orbits are solutions of the equation F(x, \u03bb) = 0 where F is as in (2.21). Turning points\nare characterized by the condition that DxF(x\n\u2217, \u03bb\u2217) from (2.25) is singular, but that DF(x\u2217, \u03bb\u2217)\nhas full rank. In this case the solution path (x(s), \u03bb(s)), of (2.21), s \u2208 R, x(0) = x\u2217, \u03bb(0) = \u03bb\u2217,\nsatisfies \u03bb\u2032(0) = 0. Generically \u03bb\u2032\u2032(0) 6= 0 so that the solution path has a turning point in \u03bb.\nTurning points can be detected by a change of sign of the \u03bb-component t\u2217\u03bb of the continuation\ntangent t\u2217 of the periodic solution provided this test is done after the tests of other bifurcations.\nThis ordering of the monitoring tests for bifurcations is important, because, as we will see in\nSections 3.2, 3.5 and 4, a change of sign of the \u03bb-component t\u2217\u03bb of the continuation tangent t\n\u2217\nalso occurs at flip up bifurcations and Hopf points along periodic orbits.\nA turning point between two points y(0) = (x(0), T (0), \u03bb(0)) and y(1) = (x(1), T (1), \u03bb(1)) with\ncontinuation tangents t(0), t(1) respectively is detected if\nt\n(0)\n\u03bb t\n(1)\n\u03bb < 0.\nThe \u03bb-component of the turning point is then computed by Hermite interpolation exactly in\nthe same way as in the case of stationary solutions, see [7]: We construct a cubic polynomial\ny(\u03c4) = (x(\u03c4), T (\u03c4), \u03bb(\u03c4)), where y : [0, 1] \u2192 RN , over the line y(0) + \u03c4(y(1) \u2212 y(0)), \u03c4 \u2208 [0, 1],\nsuch that\ny(0) = y(0), y\u2032(0) = \u2016y\n(1)\u2212y(0)\u20162\n\u3008y(1)\u2212y(0),t(0)\u3009\nt(0),\ny(1) = y(1), y\u2032(1) = \u2016y\n(1)\u2212y(0)\u20162\n\u3008y(1)\u2212y(0),t(1)\u3009\nt(1),\n(2.27)\nand solve the quadratic equation d\u03bbd\u03c4 (\u03c4) = 0 for its unique root \u03c4\u02c6 \u2208 [0, 1]. We then take the value\ny\u02c6 = y(\u03c4\u02c6 ) of the Hermite polynomial at \u03c4\u02c6 as initial guess for a Gauss-Newton iteration. The\nperiodic solution y\u2217 obtained in this way is accepted as turning point if\n|t\u2217\u03bb| < tol\nwhere t\u2217 is the continuation tangent at y\u2217 and tol is the required accuracy of the computation.\nOtherwise we replace y(0) or y(1) by y\u2217 so that t\n(0)\n\u03bb t\n(1)\n\u03bb < 0 and repeat the procedure.\n3 Computation of flip down and flip up bifurcations\nIn this section we show how generic bifurcations of symmetric periodic orbits to other periodic\norbits can be computed numerically. This involves the detection and numerical computation of\nbifurcation points and the computation of the start off directions for the bifurcating branches.\n12\nWe only have to follow non-conjugate branches and distinguish between two types of symmetry\nchanging bifurcations: there are symmetry increasing bifurcations which lead to a super group\nof the symmetry group of the original solution, i.e., the bifurcating solutions possess more sym-\nmetry, and we have symmetry breaking bifurcations which lead to a subgroup of the symmetry\ngroup of the original solution.\nIn this section we only treat bifurcations from periodic orbits to periodic orbits, not Hopf\nbifurcations (from periodic orbits to stationary solutions) - we will treat these in the next\nsection. Such bifurcations have been classified by Fiedler [9] in the case of cyclic symmetry\ngroups. Bifurcations of periodic orbits in systems with arbitrary finite symmetry group were\nclassified by Lamb and Melbourne [18], see also [19].\nIn this paper we assume that the symmetry group of the dynamical system is discrete and\nthat the isotropy K of the periodic orbit is trivial, i.e., we restrict the dynamical system to the\ncorresponding fixed point space Fix(K). In other words, we do not treat bifurcations to periodic\norbits with smaller or bigger isotropy group K. The methods we present extend the techniques of\nGatermann and Hohmann [10] for the numerical computation of symmetry changing bifurcations\nof stationary solutions to the case of periodic solutions. In particular, the symmetry monitoring\nfunctions which are used for the detection of symmetry changing bifurcations are related to\nthose used in [10].\nGeneric bifurcations of periodic orbits with trivial isotropy to other periodic orbits are caused\nby a period doubling (flip down) or period halving (flip up) bifurcation of the reduced Poincare\u00b4\nmap [18, 19]. We start with generic bifurcations without symmetry where the ODE (1.1) is not\nassumed to be equivariant.\n3.1 Detection and computation of period doubling bifurcations\nt\u02dcx\nFigure 1: Period doubling bifurcation in phase space. The bifurcating periodic orbit lies on a\nMobius strip. Dashed line: original periodic orbit, solid line: bifurcating periodic orbit with\ntwice the period, t\u02dcx: x-component of the continuation tangent for the bifurcating branch.\nA point (x\u2217, \u03bb\u2217) characterizing a periodic solution with period T \u2217 is a period doubling bifurcation\npoint (flip down point) if the Jacobian Dx\u03a0 of the Poincare\u00b4 map has a single eigenvalue \u22121 in\n(x\u2217, \u03bb\u2217) with eigenvector v\u2217S \u2208 S and if this is the only eigenvalue on the complex unit circle, see\ne.g. [13, 16]. Let x(\u03bb) be the solution branch of \u03a0(x, \u03bb) = x with x(\u03bb\u2217) = x\u2217. Then we moreover\nrequire that the path \u00b5(\u03bb) of eigenvalues of Dx\u03a0(x(\u03bb), \u03bb) with \u00b5(\u03bb\n\u2217) = \u22121 satisfies the generic\ntransversality condition\n\u2202\u00b5\n\u2202\u03bb\n(\u03bb\u2217) 6= 0. (3.1)\n13\nUnder these assumptions (x\u2217, \u03bb\u2217) is a pitchfork bifurcation point of the map\nF\u02dc(x, \u03bb) = \u03a0(\u03a0(x, \u03bb), \u03bb) \u2212 x = 0, (3.2)\nsee [13, 16]. The normal form of this bifurcation is\nf\u02dc(z, \u03bb) = z3 \u2212 \u03bbz. (3.3)\nBy a Lyapounov-Schmidt reduction (3.2) can be reduced to a scalar equation in z = \u3008x\u2212x\u2217, v\u2217S\u3009.\nAfter a suitable change of coordinates this scalar equation takes the form (3.3), up to order 3,\nsee [13, 16]. The vector t\u02dcF\u02dc = (v\n\u2217\nS , 0) is the tangent vector of the bifurcating branch in (x\n\u2217, \u03bb\u2217).\nThe bifurcating periodic orbits correspond to fixed points of \u03a02 and hence have approximately\ntwice the period of the original periodic solution. They lie on a Mobius strip around the original\nperiodic orbit, see Figure 1. The map F\u02dc is Z2-equivariant where the nonlinear Z2-action is given\nby the Poincare\u00b4 map (x, \u03bb) \u2192 (\u03a0(x), \u03bb) (in the normal form (3.3) this Z2-symmetry becomes\nz \u2192 \u2212z). So a period doubling bifurcation is a Z2-symmetry breaking bifurcation of equilibria of\nF\u02dc . If we consider the T -periodic solutions on the original branch as T\u02dc -periodic, where T\u02dc := 2T ,\nthe original branch has temporal Z2-symmetry for the action of the spatio-temporal symmetry\ngroup \u0393\u00d7 R given by (2.7):\n(id, \u03b8)x(t) = x(t + \u03b8T\u02dc ) = x(t) for \u03b8 = 1\/2,\nand the branching solutions are not Z2-symmetric. So we see that even in the case of a triv-\nial symmetry group \u0393 = {id} the period doubling bifurcation corresponds to a Z2-symmetry\nbreaking bifurcation as the phase shift symmetry (temporal symmetry) of the periodic orbit is\nbroken.\nIn the following we briefly describe how to numerically detect and compute period doubling\nbifurcations in non-symmetric systems. We adapt standard techniques used in the context of\ncollocation methods [1, 8, 17] to our approach for the computation of periodic orbits as solutions\nof underdetermined systems, as described in Section 2. In Section 3.5 we show how to adapt\nthese methods to the numerical computation of symmetry breaking bifurcations of symmetric\nperiodic orbits.\n3.1.1 Numerical detection of period doubling bifurcations\nPeriod doublings can be detected by a change of sign of\nd(\u03bb) := det(Dx\u03a6T\u2217(x\n\u2217, \u03bb\u2217) + id)\nwhich occurs due to the transversality condition (3.1). The matrix Dx\u03a6T\u2217(x\n\u2217, \u03bb\u2217) is computed\nin the single shooting approach to obtain DF (x\u2217, T \u2217, \u03bb\u2217), see (2.4), and also in the multiple\nshooting approach in the computation of the condensed matrix Gc, see (2.18) with ` = 1 and\n\u03b1 = id.\n3.1.2 Computation of period doubling bifurcation points\nIf a period doubling point has been detected it can be computed by use of linear interpolation\nand a Gauss-Newton procedure to iterate back to the solution path: If there is a period doubling\npoint between two consecutively computed periodic solutions y(0) and y(1) then\nd(\u03bb(0))d(\u03bb(1)) < 0.\n14\nBy linear interpolation of the two points (\u03bb(0), d(\u03bb(0))) and (\u03bb(1), d(\u03bb(1))) we obtain a point (\u03bb\u02c6, 0)\nwhich gives us an approximation for the parameter value \u03bb\u02c6 of the bifurcation point. Linear\ninterpolation between the points y(0) and y(1) provides a first guess y\u02c6 with parameter \u03bb\u02c6 for the\nperiod doubling point. This guess is then iterated back to a point y\u2217 on the solution path by a\nGauss-Newton procedure. If\n\u2016y\u2217 \u2212 y\u02c6\u2016 \u2264 tol,\ny\u2217 is accepted as period doubling point. If not, then either y(0) or y(1) is replaced by y\u2217, such\nthat the condition d(\u03bb(0))d(\u03bb(1)) < 0 is satisfied, and the procedure is repeated.\nDoubling the number of multiple shooting points for the bifurcating branch If we\nfix the number of multiple shooting points on the bifurcating branch of 2T -periodic solutions,\nthen after some period doubling bifurcations the multiple shooting method is likely to diverge\nbecause the initial number of multiple shooting points will not be appropriate for a periodic\nsolution with a much higher period than the original period. Therefore it is preferable to\ncompute the bifurcating branch of periodic orbits with twice as many multiple shooting points,\ni.e., to set k\u02dc = 2k as the number of multiple shooting points of the bifurcating branch. The\nbifurcation point y\u02dc = (x\u02dc1, . . . , x\u02dck\u02dc , T\u02dc , \u03bb\u02dc) on the bifurcating branch is given by\nx\u02dci = x\n\u2217\ni , x\u02dci+k = x\n\u2217\ni for i = 1, . . . , k, T\u02dc = 2T\n\u2217, \u03bb\u02dc = \u03bb\u2217,\nand the multiple shooting nodes s\u02dci, i = 0, 1, . . . , k\u02dc, of the bifurcating branch are set to\ns\u02dci =\nsi\n2\n, s\u02dci+k =\n1 + si\n2\n, i = 1, . . . , k.\n3.1.3 Computation of start off directions for the bifurcating branch\nAfter a period doubling bifurcation point has been found the start off direction for the bifurcating\nbranch has to be computed. The continuation tangent of the original periodic branch is just the\nusual continuation tangent. The start off direction for the bifurcating branch is computed as\nfollows:\nSingle shooting ansatz We first consider the single shooting approach: we want the start\noff direction for the bifurcating branch of periodic orbits to be orthogonal to the T \u2217-periodic\norbit, so that it lies in the Poincare\u00b4 section S. In S\u00d7R the tangent of the bifurcating branch in\nthe bifurcation point should be the vector t\u02dcF\u02dc = (v\n\u2217\nS , 0) where v\n\u2217\nS is the eigenvector of Dx\u03a0(x\n\u2217)\nto the eigenvalue \u22121, see above. It can be computed by projecting the kernel vector v\u2217 of\nDx\u03a6T (x\n\u2217, \u03bb\u2217) + id onto the orthogonal complement of the tangent f(x\u2217) to the periodic orbit\nthrough x\u2217: Let\nt\u02dcx = v\n\u2217 \u2212\n\u3008v\u2217, f(x\u2217)\u3009\n\u3008f(x\u2217), f(x\u2217)\u3009\nf(x\u2217). (3.4)\nThen we take\nt\u02dc = (t\u02dcx, t\u02dcT , t\u02dc\u03bb) = (t\u02dcx, 0, 0)\nas the start off direction for the bifurcating periodic solutions. In phase space the bifurcating\nperiodic solutions lie on a Moebius band in the middle of which is the original T \u2217-periodic\nsolution. The start off direction is tangential to the Moebius band and orthogonal to the original\nsolution (see Figure 1).\n15\nMultiple shooting ansatz As preliminary tangent vector v\u22171 of the bifurcating branch for the\nfirst multiple shooting point we choose the eigenvector of Gc + id to \u22121 where Gc \u2248 Dx\u03a6T\u2217(x\n\u2217)\nis the condensed matrix, see (2.16, 2.18). As preliminary tangent start off directions at the\nmultiple shooting points x\u22172,. . . , x\n\u2217\nk we take\nv\u2217j = Gjv\n\u2217\nj\u22121, j = 2, . . . , k.\nThe first nk components of the start off tangent t\u02dc of the bifurcating branch in the multiple shoot-\ning approach are then obtained by projecting v\u2217 = (v\u22171 , . . . , v\n\u2217\nk) to the orthogonal complement\nof the vector tf = (f(x\u22171), . . . , f(x\n\u2217\nk)).\nSince the number of multiple shooting points is doubled on the bifurcating branch (see Section\n3.1.2), this gives us only the first half of the x-component\nt\u02dcx = (t\u02dc1, t\u02dc2, . . . , t\u02dck, t\u02dck+1, . . . , t\u02dc2k)\nof the start off tangent t\u02dc = (t\u02dcx, 0, 0) of the bifurcating branch. The whole x-component of t\u02dc is\nobtained by copying the first half into the second half and multiplying it with \u22121, i.e.,\nt\u02dck+i = \u2212t\u02dci, i = 1, . . . k. (3.5)\nAs in the single shooting approach we have t\u02dcT = t\u02dc\u03bb = 0.\n3.2 Detection and computation of period halving bifurcations\nIn this section we describe an algorithm for the detection and computation of period halving\nbifurcations (flip up points) along branches of periodic orbits. Again, we assume that the sym-\nmetry group \u0393 of the dynamical system (1.1) is trivial.\n3.2.1 Detection of period halving bifurcations\nPeriod halvings can be detected as follows: for a solution point y = (x1, . . . , xk, T, \u03bb) of (2.26)\nwe compute\nu(y) := \u03a6T\n2\n(x1, \u03bb)\u2212 x1 = xj \u2212 x1.\nHere one multiple shooting node sj is set to sj = 1\/2 so that no additional initial value problem\nhas to be solved.\nIf there is a period halving point y\u2217 = (x\u2217, T \u2217, \u03bb\u2217) between two consecutively computed\nperiodic solutions y(0) and y(1) the vector u goes through zero. As we saw before, a flip bifurcation\ncorresponds to a pitchfork bifurcation of (3.2). Figure 2 shows the normal form (3.3) of the\npitchfork bifurcation and points x(0) and x(1) corresponding to periodic orbits before and after\npassing the bifurcation. For each parameter value \u03bb, the corresponding point on the solid and\ndashed curve belong to the same periodic orbit, and are conjugate points with respect to the\nZ2-symmetry action which, for (3.2), is given by x \u2192 \u03a0(x, \u03bb), see above. For the points x\n(0) and\nx(1) we denote the difference vectors by u(\u03bd) = \u03a0(x(\u03bd), \u03bb(\u03bd))\u2212x(\u03bd), \u03bd = 0, 1. From Figure 2 we see\nthat the vectors u(0) and u(1) are approximately parallel with opposite sign. At the numerically\ncomputed solutions y(0) and y(1) the vectors u(y(0)) and u(y(1)) are good approximations for\nu(0) and u(1). Therefore a period halving point can be detected by the following condition on\nthe angle between u(y(0)) and u(y(1)):\n\u3008u(y(0)), u(y(1))\u3009\n\u2016u(y(0))\u2016\u2016u(y(1))\u2016\n< 0. (3.6)\n16\n\u03bbx\nbranch of periodic orbits\nbranch of periodic orbits\nwith halved period\nu\n(0)\nx\n(0)\nu\n(1)\nx\n(1)\nFigure 2: Detection of period halvings using (3.6). Solid curve: branch of periodic orbits before\npassing the flip up point; dashed curve: branch of periodic orbits after passing the flip up point;\nSee text for more explanations.\n3.2.2 Computation of period halving bifurcation points and start off directions\nAssume that a period halving bifurcation has been detected between two consecutively computed\nperiodic solutions y(0) and y(1). We now describe a method for the computation of period halving\npoints which is based on existing methods for detecting period doubling points. The algorithm\nconsists of the following steps:\n1. We obtain a first guess for the location of the flip up point by approximating the solution\nbranch by a Hermite interpolating polynomial, c.f. Figure 2. We compute a Hermite poly-\nnomial y(\u03c4) of degree 3 through the two points y(0) = y(0), y(1) = y(1) of the bifurcation\ndiagram in between of which a period halving has been detected. This is analogous to\nthe Hermite interpolation used to locate turning points, see Section 2.5. By computing\nthe extremum \u03bb(\u03c4\u02c6 ) of the polynomial \u03bb(\u03c4) where y(\u03c4) = (x(\u03c4), T (\u03c4), \u03bb(\u03c4)) we obtain a\nfirst guess y\u02c6 = y(\u03c4\u02c6 ) = (x\u02c61, . . . , x\u02c6k , T\u02c6 , \u03bb\u02c6) for the flip up point. We now halve the period\nT\u02c6 := T\u02c6 \/2. Again, as in the case of period doubling bifurcations, the number of multiple\nshooting points is adapted with respect to changes of the period. In this case the number\nof multiple shooting points is k\u02dc = j where j is such that sj =\n1\n2 . Decreasing the number of\nmultiple shooting points at flip up bifurcations obviously speeds up the calculation time.\n2. Now we use this first guess as starting value for a flip down point computation. We look\nfor a flip down point in the parameter scope [\u03bbmin, \u03bbmax] where\n\u03bbmin = \u03bb\u02c6\u2212 \u000f, \u03bbmax = \u03bb\u02c6 + \u000f, \u000f = max(tol, min(|\u03bb\n(0) \u2212 \u03bb\u02c6|, |\u03bb(1) \u2212 \u03bb\u02c6|)),\nand tol is the prescribed accuracy. The period doubling bifurcation point on this branch\nis then accepted as period halving point for the original branch.\nRemarks 3.1\na) In AUTO and CONTENT period halving bifurcations are not properly detected: the pro-\ngrams detect bifurcation points of \u201dunknown type\u201d, but does not compute the bifurcating\nbranch of periodic solutions with halved period.\nb) Note that period halving bifurcations can not be detected by a change of sign of a de-\nterminant, in contrast to transcritical and saddle node bifurcations of equilibria. The\nmonitoring function that we use is inspired by the monitoring functions for symmetry\nincreasing bifurcations of equilibria developed by Gatermann and Hohmann [10].\n17\nc) In the computation of bifurcations of equilibria numerical methods based on extended\nsystems are frequently employed (see e.g. [1, 16]). One could of course also use such a\nmethod to locate period halving bifurcations. A period halving point could for example\nbe computed by solving the system\n0 = F (x, T, \u03bb, v) :=\n\uf8eb\uf8ed \u03a6T\/2(x; \u03bb)\u2212 xDx\u03a6T\/2(x; \u03bb)v + v\n\u2016v\u20162 \u2212 1\n\uf8f6\uf8f8\nusing a Newton type method. But since this requires the approximation of the second\nderivative of the flow map it would be more expensive than the method that we suggest.\n3.3 Bifurcations of periodic orbits with Zp-symmetry\nIn this section we deal with generic symmetry changing but isotropy preserving secondary bi-\nfurcations of symmetric periodic orbits. The right hand side f of the ODE (1.1) is assumed\nto be \u0393-equivariant under a finite group \u0393 \u2282 GL(n), as in Section 2.2. We assume that the\nspatial symmetry K of the periodic orbit is trivial (or restrict the dynamics to Fix(K)). This\nimplies that the spatio-temporal symmetry of the periodic orbits is cyclic: L ' Z`. We can then,\nwithout loss of generality, restrict to the case \u0393 ' Zp for p a multiple of `, see [18]. We describe\nhow the generic secondary bifurcations of periodic orbits with Zp-symmetry, which have been\nclassified by Fiedler [9], can be treated numerically. In this section we only deal with bifurcations\nof periodic orbits into other periodic orbits (not Hopf bifurcations along branches of periodic\norbits).\nSo let x\u2217 lie on a periodic orbit P with period T \u2217, trivial isotropy K, spatio-temporal\nsymmetry L = Z` and drift symmetry \u03b1. Define the Poincare\u00b4 section as usual by S = x\n\u2217 +\nspan(f(x\u2217))\u22a5. To examine bifurcations of symmetric periodic orbits the reduced Poincare\u00b4 map\n\u03a0red = \u03b1\u03a0\u02c6, \u03a0\u02c6 : S \u2192 \u03b1\n\u22121S,\nfrom (2.10) is used where \u03a0\u02c6 maps points of S into the points where the positive semi-flow through\nx first hits \u03b1\u22121 S. In the case of trivial isotropy K the relationship between the full Poincare\u00b4\nmap \u03a0 and the reduced Poincare\u00b4 map \u03a0red is given by\n\u03a0 = \u03b1\u2212`\u03a0`red = \u03a0\n`\nred. (3.7)\nHere we used that \u03b1` = id. Generic bifurcations of symmetric periodic orbits are bifurcations of\nthe reduced Poincare\u00b4 map \u03a0red which arise from an eigenvalue \u00b11 of the Jacobian Dx\u03a0red, see\n[9, 18].\nGeneric bifurcations of \u03a0red without breaking of the spatial symmetry are turning points\nand period doublings\/halvings (flip down and flip up bifurcations); turning points of \u03a0red lead\nto turning points of the full Poincare\u00b4 map \u03a0. They can be detected and computed in the same\nway as in the case of no symmetry, see Section 2.5.\nFlip down bifurcations of the reduced Poincare\u00b4 map \u03a0red lead to pitchfork bifurcations re-\nspectively period doubling bifurcations of \u03a0 depending on whether ` is odd or even, see [9]. If\n` is odd, in particular if the symmetry is trivial (i.e. ` = 1), we have a flip doubling (period\ndoubling) bifurcation. If ` is even then a flip pitchfork bifurcation takes place where the period\nis preserved, but the spatio-temporal symmetry halved.\n3.3.1 Flip pitchfork bifurcation\nFirst we consider the flip pitchfork bifurcation. Let ` be even. Assume that the reduced Poincare\u00b4\nmap \u03a0red undergoes a flip down bifurcation. Then the bifurcating solutions x\u02dc(s), s \u2208 R, x\u02dc(0) =\n18\nx\u2217, are fixed points of \u03a02red. By (3.7),\n\u03a0(x\u02dc(s)) =\n(\n\u03a02red\n)`\/2\n(x\u02dc(s)) = x\u02dc(s),\nand so the Poincare\u00b4 map \u03a0 undergoes a pitchfork bifurcation. Hence the branching solutions\nhave approximately the same period but their spatio-temporal symmetry L\u02dc = Z`\/2, \u02dc`= `\/2 has\nbeen halved. The drift symmetry of the bifurcating periodic orbits is \u03b1\u02dc = \u03b12.\n3.3.2 Flip doubling bifurcation\nNext we consider the flip doubling bifurcation, ie, let ` be odd. Since \u03a02red(x\u02dc(s)) = x\u02dc(s) and ` is\nodd the following can be concluded:\n\u03a02(x\u02dc(s)) = \u03a02`red(x\u02dc(s)) = x\u02dc(s) and \u03a0(x\u02dc(s)) = \u03a0\n`\nred(x\u02dc(s)) = \u03a0red(x\u02dc(s)) 6= x\u02dc(s).\nSo the Poincare\u00b4 map \u03a0 undergoes a period doubling bifurcation without breaking the symmetry\nZ`: the spatio-temporal symmetry group of the bifurcating branch is L\u02dc = Z\u02dc` where \u02dc` = ` and\nis generated by the order ` element \u03b1\u02dc = \u03b1. Note that the flip doubling bifurcation reduces to\nthe period doubling bifurcation of non-symmetric systems, see Section 3.1, with ` = 1, \u03b1 = id\nwhereas the flip pitchfork bifurcation does not occur for non-symmetric systems.\n3.4 Numerical computation of symmetry breaking bifurcations\nSince the generic bifurcations of periodic orbits with underlying symmetry group Zp described\nabove are generated by periodic doubling bifurcations of the reduced Poincare\u00b4 map they can be\ntreated numerically with the methods for the period doubling bifurcation described in Section\n3.1.\n3.4.1 Detection and computation of flip down bifurcations\nFlip down bifurcations are detected by the a sign change of\nd(\u03bb) = det(\u03b1Dx\u03a6T\u2217\n`\n(x\u2217) + id), where \u03b1Dx\u03a6T\u2217\n`\n(x\u2217) = Gc,\nanalogously to the case of no symmetry, see Section 3.1.1. Once a flip down bifurcation has been\ndetected it can be computed analogously as in the case of non-symmetric systems, see Section\n3.1.2.\n3.4.2 Initialization of the bifurcating branch\nOnce a flip down point (x\u2217, T \u2217, \u03bb\u2217) on the original branch has been found, the starting point\ny\u02dc = (x\u02dc, T\u02dc , \u03bb\u02dc) for the bifurcating branch has to be computed. We set T\u02dc = T \u2217 for a flip pitchfork\nbifurcation and T\u02dc = 2T \u2217 otherwise, and \u03bb\u02dc = \u03bb\u2217. Since the number of multiple shooting points is\ndoubled the second half of x\u02dc = (x\u02dc1, . . . , x\u02dc2k) will be computed by applying the symmetry matrix\nto the first points:\nx\u02dci = x\n\u2217\ni for i = 1, . . . , k,\nx\u02dci+k = \u03b1\n\u22121x\u2217i for i = 1, . . . , k.\nThe tangent vector t\u02dc = (t\u02dcx, 0, 0) of the bifurcating branch is computed in a similar way: The\nfirst nk components (t\u02dc1, . . . , t\u02dck) of the x-component t\u02dcx of the tangent t\u02dc of the bifurcating branch\nare computed as in Section 3.1.3, with Dx\u03a6T\u2217(x\n\u2217) replaced by \u03b1Dx\u03a6T\u2217\n`\n(x\u2217). Then the second\nhalf of t\u02dcx = (t\u02dc1, . . . , t\u02dc2k) is computed by applying the symmetry matrix to the first half and\nmultiplying it with \u22121:\nt\u02dci+k = \u2212\u03b1\n\u22121t\u02dci for i = 1, . . . , k. (3.8)\n19\n3.5 Numerical computation of symmetry increasing bifurcations\nIn this section we extend the algorithms for the detection and computation of period halving\npoints for non-symmetric systems (Section 3.2) to systems with symmetry. The main issue here\nis the identification of the possible spatio-temporal symmetries of the bifurcating solutions which\nare needed for both, the detection of bifurcations and the computation of the bifurcating branch.\n3.5.1 Detection of flip up bifurcations\nSimilarly as in the non-symmetric case, see Section 3.2, flip up points on a branch of periodic\norbits with spatio-temporal symmetry L = Z`, trivial isotropy and drift symmetry \u03b1 are detected\nby the angle condition (3.6)\n\u3008u(y(0)), u(y(1))\u3009\n\u2016u(y(1))\u2016\u2016u(y(1))\u2016\n< 0\nwhere y(0) and y(1) are two consecutive points on a branch of periodic solutions and\nu(x) := \u03b1\u02dc\u03a6 T\n2`\n(x1, \u03bb) \u2212 x1 = \u03b1\u02dcxj \u2212 x1.\nHere the multiple shooting node sj is set to sj =\n1\n2 and \u03b1\u02dc is a group element \u03b1\u02dc which satisfies\n\u03b1\u02dc2 = \u03b1. (3.9)\nWe now need to classify the possible choices of \u03b1\u02dc and decide whether a flip up doubling or a flip\nup pitchfork bifurcation occurs.\nTheorem 3.2 Let i be such that \u03b1 = \u03b3ip where \u03b3p generates the symmetry group \u0393 = Zp of\n(1.1). Similarly, write \u03b1\u02dc = \u03b3 i\u02dcp. Then we have:\na) Either i\u02dc = i2 or i\u02dc =\ni+p\n2 . Both these values for i\u02dc are possible if p and i are even, i\u02dc =\ni\n2 is\na possible solution for p odd, i even, and i\u02dc = i+p2 for p and i odd.\nb) (i) If\n`\u02dci = 0 mod p\nthen a flip up doubling bifurcation takes place. The order \u02dc` of the drift symmetry \u03b1\u02dc\nof the bifurcating branch and its period T\u02dc in the bifurcation point then satisfy\n\u02dc`= `, T\u02dc =\nT \u2217\n2\n,\nwhere T \u2217 is the period of the original periodic orbit at the bifurcation point.\n(ii) If\n`\u02dci 6= 0 mod p\nthen a flip up pitchfork bifurcation takes place. The order \u02dc` of the drift symmetry \u03b1\u02dc\nof the bifurcating branch and its period T\u02dc in the bifurcation point then satisfy\n\u02dc`= 2`, T\u02dc = T \u2217.\nProof. From (3.9) we get\n2i\u02dc = i mod p,\nand so\ni\u02dc = (i + jp)\/2, j \u2208 N. (3.10)\n20\nPossible solutions to (3.10) which are different modulo p are\ni\u02dc = i\/2, i\u02dc = (i + p)\/2.\nThis proves part a) of the theorem. The rest follows from the definitions of flip pitchfork and\nflip doubling bifurcations, see Sections 3.3.1 and 3.3.2.\nRemark 3.3 Consider a periodic orbit with trivial spatio-temporal symmetry, i.e., \u03b1 = id,\ni = 0. Then, if the order p of the symmetry group \u0393 = Zp is odd and the \u0393-action is free, every\nflip up bifurcation is a period halving bifurcation. If p is even then a flip up bifurcation of \u03a0red\ncan be a period halving bifurcation or a flip up pitchfork bifurcation with \u03b1\u02dc = \u03b3\np\n2\np .\n3.5.2 Computation of flip up points and start off tangents\nOnce the spatio-temporal symmetry of the bifurcating periodic orbit is identified the flip up\npoint and the start off directions for the bifurcating branch can be computed in the same way\nas for non-symmetric systems, see Section 3.2.\n4 Computation of equivariant Hopf points\nIn this section we show how equivariant Hopf points along branches of periodic orbits can be\ndetected and computed. For sake of simplicity, we first consider the case of a trivial symmetry\ngroup \u0393 = {id}.\n4.1 Hopf bifurcations for non-symmetric systems\nx2\nx1\n\u03bb\nx\u2217\nf (0)\nt(1)\nf (1)\nx(1)\nf (0) = f(x(0))\nf (1) = f(x(1))\nFigure 3: Detection of Hopf points between two periodic orbits y(0) = (x(0), T (0), \u03bb(0)) and\ny(1) = (x(1), T (1), \u03bb(1)) (single shooting method). Here t(1) is the continuation tangent at the\npoint y(1).\nA Hopf bifurcation point is a stationary solution (x\u2217, \u03bb\u2217), for which the Jacobian Dxf(x\n\u2217, \u03bb\u2217)\nhas a pair of purely imaginary eigenvalues \u00b1\u03c9\u2217i, \u03c9\u2217 6= 0. We make the generic assumptions that\nthese eigenvalues are simple, and that there is no resonance, i.e., no multiple i\u03c9\u2217j, j \u2208 N0 \\ {1},\nis an eigenvalue of Dxf(x\n\u2217, \u03bb\u2217). Denote by x(\u03bb) the path of equilibria of (1.1) with parameter\n21\n\u03bb, so that in particular x(\u03bb\u2217) = x\u2217. Let \u00b5(\u03bb) be the path of eigenvalues of Dxf(x(\u03bb), \u03bb) such\nthat \u00b5(\u03bb\u2217) = i\u03c9\u2217 and assume that the generic transversality condition\nRe\n(\n\u2202\u00b5\n\u2202\u03bb\n(\u03bb\u2217)\n)\n6= 0 (4.1)\nis satisfied. Then (see e.g. [13, 16]) a unique branch x(t; \u000f) of periodic solutions emanates from\nthe stationary solution with small amplitude O(\u000f) and period T (\u000f) \u2248 T (0) = 2pi\/\u03c9\u2217. This\nsurface of periodic solutions is tangential to the real eigenspace N\u03c9\u2217 of \u00b1\u03c9\n\u2217i, ie D\u000fx(t; 0) \u2208 N\u03c9\u2217 ,\nand generically agrees (after a smooth coordinate change) to second order with a paraboloid\n\u03bb\u2212\u03bb\u2217 = C(z21 +z\n2\n2), see e.g. [13, 16]. We can consider the Hopf point (x\n\u2217, \u03bb\u2217) as an S1-invariant\n2pi\/\u03c9\u2217-periodic solution with respect to the action (2.7) of the temporal symmetry group on the\nperiodic solutions x(t) of (1.1):\nx\u2217(t) \u2261 x\u2217 \u2200 t =\u21d2 (id, \u03b8) x\u2217(t) = x\u2217(t) \u2200 t.\nHence the Hopf bifurcation is an S1-symmetry breaking bifurcation.\n4.1.1 Detection of Hopf points along branches of periodic orbits\nIf a pathfollowing algorithm for periodic solutions runs through a Hopf point the continuation\ndirection changes its sign and the same path of periodic orbits is computed again. Therefore\nHopf points which occur during the pathfollowing of periodic orbits should be detected so that\nthe pathfollowing routine can be stopped at the Hopf point. If there is a Hopf point between two\nconsecutively computed periodic orbits y(0) and y(1), where y = (x, T, \u03bb), x = (x1, . . . , xk), then\nthe vectors f(xi), which are the infinitesimal generators of the S\n1-symmetry in the point xi, go\nthrough zero. Thus f(xi) is a symmetry monitoring function in this case. If the angle between\nthe vectors f(xi) of two consecutively computed periodic orbits is greater than 90 degree, i.e.,\nif for some i \u2208 {1, . . . , k},\n\u3008f(x\n(0)\ni ), f(x\n(1)\ni )\u3009\n\u2016f(x\n(0)\ni )\u2016\u2016f(x\n(1)\ni )\u2016\n< 0\nthen there is a Hopf point on the branch of periodic orbits between the y(0) and y(1), c.f. Figure\n3.\nRemark 4.1 Note that in the program packages AUTO [8] and CONTENT [17] the numerical\npart of which is based on AUTO Hopf points along periodic orbits are not detected properly.\nThey are detected as general cycle branching points, but when switching to the bifurcating\nbranch of stationary solutions an error occurs.\n4.1.2 Computation of Hopf bifurcations of non-symmetric systems\nIf a Hopf point along a path of periodic orbits is detected, it can be computed by an extended\nsystem [12, 14], see also the review in [1]. We use a slightly different form of extended system\nwhich is underdetermined and does not fix the phase of the Hopf eigenvector to be computed.\nWe present this extended system briefly in this subsection.\nLet x\u2217 be Hopf point, i.e., an equilibrium f(x\u2217, \u03bb\u2217) = 0, the Jacobian Dxf(x\n\u2217, \u03bb\u2217) of which\nhas a pair of purely imaginary eigenvalues \u00b1i\u03c9\u2217. Hence\nDxf(x\n\u2217, \u03bb\u2217)(v\u2217 + iw\u2217) = i\u03c9\u2217(v\u2217 + iw\u2217).\nSo we get\nDxf(x\n\u2217, \u03bb\u2217)v\u2217 = \u2212\u03c9\u2217w\u2217, Dxf(x\n\u2217, \u03bb\u2217)w\u2217 = \u03c9\u2217v\u2217, \u2016w\u2217\u20162 + \u2016v\u2217\u20162 = 1.\n22\nDefine F : R3n+2 \u2192 R3n+1 where\nF (x, \u03bb, v, w, \u03c9) =\n\uf8eb\uf8ec\uf8ec\uf8ed\nf(x, \u03bb)\nDxf(x, \u03bb)v + \u03c9w\nDxf(x, \u03bb)w \u2212 \u03c9v\n\u3008v, v\u3009 + \u3008w, w\u3009 \u2212 1\n\uf8f6\uf8f7\uf8f7\uf8f8 . (4.2)\nThen F = 0 yields the Hopf point and its imaginary eigenvalue and corresponding eigenvector.\nMoreover we have:\nTheorem 4.2 If the eigenvalue \u00b1i\u03c9\u2217 is simple, if Dxf(x\n\u2217, \u03bb\u2217) is invertible and if the transver-\nsality condition (4.1) holds, then the Gauss-Newton method applied to (4.2) converges for suffi-\nciently good initial data.\nThe proof of this theorem is basically contained in [1, 12, 14]. As shown there the transversality\ncondition Re \u00b5\u2032(\u03bb\u2217) 6= 0 implies that any kernel vector t = (tx, t\u03bb, tv , tw, t\u03c9) of the derivative\nDF (x\u2217, \u03bb\u2217, v\u2217, w\u2217, \u03c9\u2217) of F in the Hopf point satisfies t\u03c9 = 0, t\u03bb = 0 and tx = 0 and hence\n(tv , tw) satisfies the equations\n0 = Dxf(x\n\u2217, \u03bb\u2217)tv + \u03c9\n\u2217tw (4.3)\n0 = Dxf(x\n\u2217, \u03bb\u2217)tw \u2212 \u03c9\n\u2217tv (4.4)\n0 = 2\u3008v\u2217, tv\u3009+ 2\u3008w\n\u2217, tw\u3009. (4.5)\nTherefore tv + itw is a Hopf eigenvector. Equation (4.5) and the fact that the Hopf eigenvalue\ni\u03c9\u2217 is a simple eigenvalue of Dxf(x\n\u2217, \u03bb\u2217) imply that the kernel of DF in the Hopf point is one-\ndimensional. Hence DF has full rank in the Hopf point and the Gauss-Newton method applied\nto (4.2) converges for sufficiently good initial data. As we will see later (see Sections 4.2.1 and\n5.2), symmetry often inforces multiple Hopf eigenvalues, so that the extended system (4.2) has\nto be modified in the case of equivariant Hopf points.\nInitial guess for the Gauss-Newton iteration An initial guess for a Hopf point detected\nbetween two periodic orbits y(0) = (x(0), T (0), \u03bb(0)) and y(1) = (x(1), T (1), \u03bb(1)), where x =\n(x1, . . . , xk), can be obtained by Hermite interpolation y(\u03c4) between those points over the line\ny(0) + \u03c4(y(1) \u2212 y(0)), \u03c4 \u2208 [0, 1], such that y(0) = y(0), y(1) = y(1), and by computing the point\ny\u02c6 = y(\u03c4\u02c6 ) = (x(\u03c4\u02c6 ), T (\u03c4\u02c6), \u03bb(\u03c4\u02c6 )) such that \u03bb\u2032(\u03c4\u02c6 ) = 0, analogously to the computation of initial\nguesses for a turning point, see Section 2.5. We then set\nx\u02c6 := x1(\u03c4\u02c6 ),\ndefine an approximation for the Hopf frequency \u03c9\u02c6 as\n\u03c9\u02c6 =\n2pi\nT\u02c6\n, where T\u02c6 = T (\u03c4\u02c6),\nand an approximation for the parameter value of the Hopf point as\n\u03bb\u02c6 = \u03bb(\u03c4\u02c6 ).\nWe moreover define initial guesses v\u02c6 + iw\u02c6 for the Hopf eigenvector as\nv\u02c6 = c\nd\nd\u03c4\nx1(\u03c4\u02c6 ), w\u02c6 = \u2212\n1\n\u03c9\u02c6\nDxf(x\u02c6, \u03bb\u02c6)v\u02c6\nwith c such that\n\u2016v\u02c6\u20162 + \u2016w\u02c6\u20162 = 1.\nThe point (x\u02c6, \u03bb\u02c6, v\u02c6, w\u02c6, \u03c9\u02c6) is then used as initial guess for the Newton iteration applied to (4.2).\n23\n4.2 Detection and computation of equivariant Hopf points\nIn this section we extend the methods for the computation of Hopf points of non-symmetric\nsystems from Section 4.1 to systems with symmetry. The main issue here is how to deal with\nmultiple Hopf eigenvalues forced by symmetry which lead to convergence failure of the extended\nsystem (4.2) for the computation of Hopf points of non-symmetric systems.\n4.2.1 Equivariant Hopf points\nWe are starting from a \u0393-invariant stationary solution (x\u2217, \u03bb\u2217), i.e., \u0393x\u2217 = \u0393. We assume that\nthe Jacobian Dxf(x\n\u2217, \u03bb\u2217) has a pair \u00b1\u03c9\u2217i of purely imaginary eigenvalues, \u03c9\u2217 6= 0, and that\nthere are no resonances, i.e., \u00b1ji\u03c9\u2217, j = 0, 2, 3, 4, . . ., is not an eigenvalue of Dxf(\n\u2217, \u03bb\u2217). As\nbefore let N\u03c9\u2217 be the real eigenspace of Dxf(x\n\u2217, \u03bb\u2217).\nLemma 4.3 [11] If \u03b3 \u2208 \u0393x then \u03b3Dxf(x, \u03bb) = Dxf(x, \u03bb)\u03b3. Moreover, every eigenspace of\nDxf(x, \u03bb) is \u0393x-invariant.\nProof. The first statement follows from the \u0393-equivariance of f and the \u03b3-invariance of x. For\nthe second statement let u be a complex eigenvector of A = Dxf(x, \u03bb) to the eigenvalue \u00b5. Since\n\u03b3A = A\u03b3 we have A\u03b3u = \u03b3Au = \u03b3\u00b5u so that \u03b3u is an eigenvector of A to the eigenvalue \u00b5 as\nwell.\nAs a consequence, Dxf(x\n\u2217, \u03bb\u2217) is \u0393-equivariant and N\u03c9\u2217 is \u0393-invariant. Hence N\u03c9\u2217 can be\ndecomposed into irreducible \u0393-invariant subspaces, see Remark 2.4.\nDefinition 4.4 [11] We call an eigenvalue \u00b5 of a \u0393-equivariant matrix A a \u0393-simple eigenvalue\nof A if the real eigenspace N of A to the eigenvalue \u00b5 is irreducible.\nWe make the generic assumption that i\u03c9\u2217 is a \u0393-simple eigenvalue of Dxf(x\n\u2217, \u03bb\u2217). This means\nthat i\u03c9\u2217 has the lowest multiplicity allowed by the symmetry group \u0393.\nSince Dxf(x\n\u2217, \u03bb\u2217) is invertible, by the implicit function theorem applied to Fix(\u0393) = Rnred\nthere is a path x(\u03bb) of \u0393-invariant equilibria of (1.1) with x(\u03bb\u2217) = x\u2217. As in the case of the\nstandard Hopf bifurcation we assume that the transversality condition (4.1) holds for the path\n\u00b5(\u03bb) of the pair of eigenvalues of Dxf(x(\u03bb), \u03bb) with \u00b5(\u03bb\n\u2217) = i\u03c9\u2217.\nWe define the operation of \u0393\u00d7 S1 on a T -periodic solution x(t) as in (2.7)\n(\u03b3, \u03b8)x(t) = \u03b3x(t + \u03b8 T ) for (\u03b3, \u03b8) \u2208 \u0393\u00d7 S1,\nand the operation of \u0393\u00d7 S1 on the real eigenspace N\u03c9\u2217 of \u00b1\u03c9\n\u2217i of Dxf(x\n\u2217, \u03bb\u2217) by\n(\u03b3, \u03b8)u = \u03b3e\u03b8Dxf(x\n\u2217,\u03bb\u2217)T\u2217u, (\u03b3, \u03b8) \u2208 \u0393\u00d7 S1, u \u2208 N\u03c9\u2217 , (4.6)\nwhere T \u2217 = 2pi\u03c9\u2217 .\nTheorem 4.5 [11] (Equivariant Hopf Theorem) Let the above conditions be satisfied. If then\nfor a subgroup L \u2282 \u0393\u00d7 S1 the fixed point space\nNL\u03c9\u2217 := {u \u2208 N\u03c9\u2217 : (\u03b3, \u03b8)u = u \u2200 (\u03b3, \u03b8) \u2208 L} (4.7)\nsatisfies the condition\ndim NL\u03c9\u2217 = 2, (4.8)\nthen there is a unique branch x(t; \u000f) of periodic solutions with amplitude O(\u000f) bifurcating from\n(x\u2217, \u03bb\u2217) with D\u000fx(t; 0) \u2208 N\nL\n\u03c9\u2217, with parameter \u03bb(\u000f), such that \u03bb(0) = \u03bb\n\u2217, with minimal periods\nT (\u000f), such that T (0) = 2pi\/\u03c9\u2217, and with L as spatio-temporal symmetry group.\n24\nAs in the non-symmetric case the bifurcating periodic orbits generically lie on a paraboloid, see\nFigure 3.\nRemark 4.6 The equivariant Hopf theorem provides the spatio-temporal symmetries L of the\nbifurcating periodic orbits and the planes NL\u03c9\u2217 from which the start off directions for the em-\nanating periodic orbits can be chosen: We define the phase space for the bifurcating periodic\norbit with symmetry L as Fix(K) where K, the group of spatial symmetries of the periodic\norbit, is the kernel of the homomorphism \u0398 of the periodic orbit, see (2.6), and thus\nK = {\u03b3 \u2208 \u0393, (\u03b3, 0) \u2208 L}.\nWe compute the integer ` such that L\/K ' Z`, see (2.8), and the drift symmetry \u03b1 of the\nperiodic orbit by determining the element (\u03b1, \u03b8\u2217) in L with the smallest non-zero phase shift\n\u03b8\u2217 = 1` , c.f. (2.9). We identify the Hopf point (x\n\u2217, \u03bb\u2217) with a periodic orbit which has period\nT \u2217 = 2pi\u03c9\u2217 , multiple shooting points x\n\u2217\ni = x\n\u2217 for i = 1, . . . k and the parameter \u03bb\u2217. Similarly as\nin the non-symmetric case (c.f. [1]) we then define the continuation tangent t\u2217 = (t\u2217x, t\n\u2217\nT , t\n\u2217\n\u03bb) at\nthis Hopf periodic orbit as follows:\nt\u2217T = 0, t\n\u2217\n\u03bb = 0, t\n\u2217\nx = (t\n\u2217\n1, . . . , t\n\u2217\nk),\nwhere\nt\u2217i = cos(siT\n\u2217\/`)v\u2217 + sin(siT\n\u2217\/`)w\u2217, i = 1, . . . , k.\nHere v\u2217 + iw\u2217 is the eigenvector to the purely imaginary eigenvalue \u03c9\u2217i of Dxf(x\n\u2217, \u03bb\u2217) which is\ndetermined by the condition v\u2217, w\u2217 \u2208 NL\u03c9\u2217 . See Sections 5.2 and 5.3 for applications.\n4.2.2 Detection of equivariant Hopf points\nEquivariant Hopf points along branches of periodic orbits are detected in the same way as Hopf\npoints of non-symmetric systems, see Section 4.1.1.\n4.2.3 Computation of equivariant Hopf bifurcations\nAs mentioned in Section 4.1.2 the extended system (4.2) for the computation of Hopf points\nof non-symmetric systems only converges if the Hopf eigenvalue i\u03c9\u2217 is simple. In the case\nof symmetric dynamical systems this assumption can only be satisfied if the corresponding\nirreducible representation is one-dimensional. In general the symmetry might enforce multiple\neigenvalues (see Section 5.2 for an example). Therefore the numerical method for computing\nHopf points from Section 4.1.2 has to be modified in the case of symmetric dynamical systems.\nIn this section we present an efficient algorithm for computing equivariant Hopf points which\napplies to Hopf points which satisfy the conditions of the equivariant Hopf theorem.\nAssume that an equivariant Hopf point (x\u2217, \u03bb\u2217) with Hopf eigenvalue \u00b1i\u03c9\u2217, \u03c9\u2217 > 0, has been\ndetected numerically along a branch of periodic orbits of the \u0393-equivariant ODE (1.1) with drift\nsymmetry \u03b1 of order ` and, for simplicity, trivial isotropy K (restrict the dynamics to Fix(K)\nand replace \u0393 by N(K)\/K otherwise). As before we denote by L ' Z` the spatio-temporal\nsymmetry of the branch of periodic orbits. Then the Hopf point x\u2217 is L-invariant: L \u2286 \u0393x\u2217 . We\nmake the assumptions of the equivariant Hopf Theorem 4.5 replacing \u0393 by \u0393x\u2217 and denote the\nplane tangent to the branch of periodic orbits at the Hopf point by NL\u03c9\u2217 , as in (4.7).\nWe will now formulate an algorithm for the computation of the equivariant Hopf point (x\u2217, \u03bb\u2217)\nalong with the Hopf frequency \u03c9\u2217 and the corresponding Hopf eigenvector v\u2217 + iw\u2217 satisfying\nv\u2217, w\u2217 \u2208 NL\u03c9\u2217 .\n25\nNote that the condition of the equivariant Hopf Theorem 4.5 that NL\u03c9\u2217 is 2-dimensional is\nequivalent to requiring that there is only one eigenvector v\u2217+iw\u2217 of Dxf(x\n\u2217, \u03bb\u2217) to the eigenvalue\n\u00b1i\u03c9\u2217 satisfying\nv\u2217 + iw\u2217 = \u03b1e\n2pi\n\u03c9\u2217`\nDxf(x\n\u2217,\u03bb\u2217)(v\u2217 + iw\u2217). (4.9)\nSolving the nonlinear equation (4.9) numerically using an extended system would involve the\ncomputation of the exponential exp( 2pi\u03c9`Dxf(x\n\u2217, \u03bb\u2217)) of Dxf(x\n\u2217, \u03bb\u2217) which is in general expensive.\nAn extended system involving Dxf(x\n\u2217, \u03bb\u2217) rather than its exponential, like the system (4.2) in\nthe case of non-symmetric systems, is therefore preferable. To derive such a system we use the\nfollowing approach: Note that\nDxf(x\n\u2217, \u03bb\u2217)(v\u2217 + iw\u2217) = i\u03c9\u2217(v\u2217 + iw\u2217)\nand so\nexp\n(\n2pi\n\u03c9\u2217`\nDxf(x\n\u2217, \u03bb\u2217)\n)\n(v\u2217 + iw\u2217) = e\n2pii\n` (v\u2217 + iw\u2217)\nand hence\n\u03b1(v\u2217 + iw\u2217) = e\u2212\n2pii\n` (v\u2217 + iw\u2217). (4.10)\nSo v\u2217 +iw\u2217 lies in the the complex eigenspace of \u03b1 to the eigenvalue e\u22122pii\/` which we denote by\nXc` \u2282 X\nc = Cn, and v\u2217 and w\u2217 lie in the real eigenspace of \u03b1 to the eigenvalue e\u22122pii\/` which we\ndenote by X`. So X` is the L-invariant subspace of X = R\nn where \u03b1, the generator of L ' Z`,\nacts as a rotation by \u22122pi\/`.\nThe following lemma is crucial for the numerical computation of equivariant Hopf points.\nLemma 4.7 Let the assumptions of the equivariant Hopf theorem 4.5 hold. If then v +iw \u2208 X c`\nis an eigenvector of Dxf(x\n\u2217, \u03bb\u2217) to the eigenvalue i\u03c9\u2217 then v + iw = c(v\u2217 + iw\u2217) for some c \u2208 C\nwhere v\u2217 + iw\u2217 is a Hopf eigenvector with v\u2217, w\u2217 \u2208 NL\u03c9\u2217 .\nProof. The vector v +iw satisfies (4.9) and by the assumption of the equivariant Hopf theorem\n4.5 there is only one such eigenvector (over C), namely v\u2217 + iw\u2217. This proves the lemma.\nDue to this lemma, we can solve (4.9) as follows: We first compute the space X `c . Then we\ncompute the L-invariant Hopf point together with a Hopf eigenvector which lies in X` by an\nextended system.\nFirst step of the algorithm. We compute an orthonormal basis of X c` and store it as row\nvectors of a matrix E`. We assume that ` > 1, i.e., that the branch of periodic orbits along\nwhich a Hopf bifurcation has been detected has non-trivial spatio-temporal symmetry L = Z`.\nWe consider two cases:\nCase 1: ` = 2. We compute the kernel X2 = ker(B2) of B2 = \u03b1 + idn and store an orthonormal\nbasis of it in the row vectors of the (d, n)-matrix E2. Here d = dim X2 and X2 is the L-invariant\nsubspace of Rn where the action of the symmetry group L = Z2 generated by \u03b1 is given by\n\u03b1|X2 = \u22121. Hence,\nET2 E2 = id |X2 . (4.11)\nCase 2: ` > 2. In this case we compute the null space of the (2n, 2n)-matrix\nB` :=\n(\n\u03b1\u2212 cos(2pi\/`) idn \u2212 sin(2pi\/`) idn\nsin(2pi\/`) idn \u03b1\u2212 cos(2pi\/`) idn\n)\n. (4.12)\nWe store an orthonormal basis of ker(B`) in the row vectors of the matrix E` = [EV , EW ] \u2208\nMat(d, 2n) where EV , EW \u2208 Mat(d, n).\nBefore we continue with the description of the algorithm we present the following lemma:\n26\nLemma 4.8 Let ` > 2. Then the following holds true:\na) If (v, w) \u2208 kerB`, v, w \u2208 R\nn, we have v + iw \u2208 Xc` .\nb) If (v, w) \u2208 kerB`, then so is (\u2212w, v). In particular, kerB` has even dimension d = 2d\u02c6,\nd\u02c6 \u2208 N, the eigenvalue e\u22122pii\/` of \u03b1 has geometric multiplicity d\u02c6 , and d = dim X`.\nc) For any x \u2208 Rd we have ETV x + iE\nT\nW x \u2208 X\nc\n` .\nd) Both ETV and E\nT\nW have X` as range.\nProof.\na) By Definition, v +iw \u2208 Xc` if and only if v +iw satisfies (4.10). Taking real and imaginary\nparts of the left and right hand side of (4.10) we see that v + iw satisfies (4.10) iff (v, w) \u2208\nkerB`.\nb) follows from a) and the fact that (v, w) ' v + iw and i(v + iw) \u223c (\u2212w, v) are linearly\nindependent over R.\nc) follows from the definition of E`.\nd) follows from a) and b).\nSecond step of the algorithm. Again we consider two cases: ` = 2, ` > 2.\nCase 1: ` = 2. We solve an extended system\nF (xred, \u03bb, vred, wred, \u03c9) = 0,\nsimilarly to (4.2), where now\nvred, wred \u2208 X` ' R\nd, xred \u2208 Fix(L) ' R\nnred\nand\nF : Rnred+2d+2 \u2192 Rnred+2d+1.\nLet fred := f |Fix(L) and let Q : R\nn \u2192 Rnred be the matrix which contains an orthonormal basis\nof Fix(L), dim Fix(L) = nred, as row vectors. Then we define F as\nF (xred, \u03bb, vred, wred, \u03c9) =\n\uf8eb\uf8ec\uf8ec\uf8ed\nfred(xred, \u03bb)\nE2Dxf(x, \u03bb)|x=QT xredE\nT\n2 vred + \u03c9wred\n\u2212\u03c9vred + E2Dxf(x, \u03bb)|x=QT xredE\nT\n2 wred\n\u3008vred, vred\u3009+ \u3008wred, wred\u3009 \u2212 1\n\uf8f6\uf8f7\uf8f7\uf8f8 . (4.13)\nCase 2: ` > 2. In this case the real part v\u2217 of the Hopf eigenvector v\u2217 + iw\u2217 and the knowledge\nof the drift symmetry \u03b1 of the branch of periodic orbits along which a Hopf bifurcation was\ndetected determines the Hopf eigenvector uniquely since v\u2217 + iw\u2217 satisfies (4.10) and so\nw\u2217 =\n1\nsin(2pi\/`)\n(\u03b1v\u2217 \u2212 cos(2pi\/`)v\u2217) .\n27\nTherefore only the real part of the Hopf eigenvector, the Hopf point, its parameter and the Hopf\nfrequency need to be computed by an extended system. We define F : Rnred+d+2 \u2192 Rnred+d+1\nby\nF (xred, \u03bb, vred, \u03c9) =\n\uf8eb\uf8ed fred(xred, \u03bb)EV (Dxf(x, \u03bb)|x=QT xredETV vred + \u03c9ETW vred)\n\u3008vred, vred\u3009 \u2212 1\n\uf8f6\uf8f8 . (4.14)\nProposition 4.9\na) If ` = 2 and (x\u2217red, \u03bb\n\u2217, v\u2217red, w\n\u2217\nred, \u03c9\n\u2217) is a solution to F = 0 as defined in (4.13) then\nx\u2217 = QT x\u2217red is an equivariant Hopf point with Hopf frequency \u03c9\n\u2217. Moreover a Hopf\neigenvector v\u2217 + iw\u2217 with v\u2217, w\u2217 \u2208 NL\u03c9\u2217 is given by v\n\u2217 = ET2 v\n\u2217\nred, w\n\u2217 = ET2 w\n\u2217\nred.\nb) Similarly, if ` > 2, and (x\u2217red, \u03bb\n\u2217, v\u2217red, \u03c9\n\u2217) is a solution to F = 0 as defined in (4.14)\nthen x\u2217 = QT x\u2217red is an equivariant Hopf point with Hopf frequency \u03c9\n\u2217. Moreover a Hopf\neigenvector v\u2217 + iw\u2217 with v\u2217, w\u2217 \u2208 NL\u03c9\u2217 is given by v\n\u2217 = ETV v\n\u2217\nred, w\n\u2217 = ETW v\n\u2217\nred.\nFor the proof we need the following lemma:\nLemma 4.10 Let A be an (n, n)-matrix which is equivariant with respect to a linear Z`-action\non Rn. Let \u03b1 generate Z` and define X` as before. Then X` is A-invariant.\nProof. Let v \u2208 X`. Then there is some w \u2208 X` such that v + iw is an eigenvector of \u03b1 to the\neigenvalue exp(\u22122pii\/`). By Z`-equivariance of A also A(v + iw) is an eigenvector of \u03b1 to the\neigenvalue exp(\u22122pii\/`) and so both Av and Aw lie in X`.\nNote that X` is an isotypic component of the Z` action on R\nn, and that generally isotypic com-\nponents for a linear action of a group \u0393 are invariant under \u0393-equivariant matrices [11].\nProof of Proposition 4.9.\na) Case ` = 2. The first equation fred(x, \u03bb) = 0 of F = 0 implies that x\n\u2217\nred is an equilibrium\nof fred(\u00b7, \u03bb\n\u2217). Hence x\u2217 = QT x\u2217red is an L-invariant equilibrium of f(\u00b7, \u03bb\n\u2217). From the other\nequations in F = 0 we conclude that v\u2217red + iw\n\u2217\nred is an eigenvector of E2Dxf(x\n\u2217, \u03bb\u2217)ET2\nto the eigenvalue i\u03c9\u2217. Since x\u2217 \u2208 Fix(L) the derivative Dxf(x\n\u2217, \u03bb\u2217) is L-equivariant\nby Lemma 4.3 and therefore, by Lemma 4.10, maps X2 into itself. Let v\n\u2217 = ET2 v\n\u2217\nred,\nw\u2217 = ET2 w\n\u2217\nred. Because of (4.11), v\n\u2217 + iw\u2217 \u2208 Xc2 is an eigenvector of Dxf(x\n\u2217, \u03bb\u2217) to the\neigenvalue i\u03c9\u2217. Hence (x\u2217 = QT x\u2217red, \u03bb\n\u2217) is a Hopf point. Lemma 4.7 now implies that\nv\u2217, w\u2217 \u2208 NL\u03c9\u2217 .\nb) Case ` > 2. As in the case ` = 2 the first equation of F = 0 implies that x\u2217 = QT x\u2217red is an\nL-invariant equilibrium of f(\u00b7, \u03bb\u2217). Let v\u2217 = ETV v\n\u2217\nred and w\n\u2217 = ETW w\n\u2217\nred. From Lemma 4.8\nc) we conclude that v\u2217 + iw\u2217 \u2208 Xc` . Since Dxf(Q\nT xred(\u03bb), \u03bb) is L-equivariant by Lemma\n4.3 and hence maps X` into itself by Lemma 4.10 and since EV |X` is an isomorphism by\nLemma 4.8 d), the other equations in F = 0 imply that\nDxf(x\n\u2217, \u03bb\u2217)v\u2217 + \u03c9\u2217w\u2217 = 0 (4.15)\nand so\nRe(Dxf(x\n\u2217, \u03bb\u2217)(v\u2217 + iw\u2217)\u2212 i\u03c9\u2217(v\u2217 + iw\u2217)) = 0.\nMultiplying (4.15) by \u03b1 and using the L-equivariance of Dxf(x\n\u2217, \u03bb\u2217) we obtain\nDxf(x\n\u2217, \u03bb\u2217)\u03b1v\u2217 + \u03c9\u2217\u03b1w\u2217 = 0.\n28\nFrom the fact that v\u2217 + iw\u2217 \u2208 Xc` we conclude\nRe\n(\ne\u22122pii\/`(Dxf(x\n\u2217, \u03bb\u2217)(v\u2217 + iw\u2217)\u2212 i\u03c9\u2217(v\u2217 + iw\u2217))\n)\n= 0.\nSince e2pii\/` \/\u2208 R this implies that\nDxf(x\n\u2217, \u03bb\u2217)(v\u2217 + iw\u2217) = i\u03c9\u2217(v\u2217 + iw\u2217)\nand therefore (x\u2217, \u03bb\u2217) is a Hopf point and v\u2217 + iw\u2217 \u2208 Xc` a Hopf eigenvector. By Lemma\n4.7 we then get v\u2217, w\u2217 \u2208 NL\u03c9\u2217 .\nAnalogously to Theorem 4.2 we have:\nTheorem 4.11 If the assumptions of the equivariant Hopf Theorem 4.5 hold and if the initial\nguess is good enough then the Gauss-Newton method applied to (4.13) for ` = 2 and applied to\n(4.14) for ` > 2 converges.\nProof. Similarly as in the non-symmetric case (Theorem 4.2, see [1, 12, 14]) we show that DF ,\nwith F from (4.13) for ` = 2 and from (4.14) for ` > 2, has full rank in the Hopf point. As\nbefore we consider the cases ` = 2 and ` > 2 separately.\nCase ` = 2. The assumptions of the equivariant Hopf theorem imply that i\u03c9\u2217 is a simple eigen-\nvalue of Dxf(x\n\u2217, \u03bb\u2217)|X2 and hence, due to (4.11), also of E2Dxf(x\n\u2217, \u03bb\u2217)ET2 . The proof that DF\nhas full rank in the Hopf point is therefore very similar to the non-symmetric case: the only\ndifference is that we require v, w \u2208 X2 and x \u2208 Fix(L). We omit the details.\nCase ` > 2. In this case we have\nD(xred,\u03bb,vred,\u03c9)F (xred, \u03bb, vred, \u03c9) =\uf8eb\uf8ed Dxredfred(xred, \u03bb) D\u03bbfred(xred, \u03bb) 0 0EV D2xfETV vredQT EV DxD\u03bbfETV vred EV (DxfETV + \u03c9ETW ) EV ETW vred\n0 0 2vTred 0\n\uf8f6\uf8f8 ,\nwhere f is short for f(QT xred, \u03bb). Let t = (txred , t\u03bb, tvred , t\u03c9) be a kernel vector of DF in the\nequivariant Hopf point:\n0 = Dxredfred(x\n\u2217\nred, \u03bb\n\u2217)txred + D\u03bbfred(x\n\u2217\nred, \u03bb\n\u2217)t\u03bb,\n0 = EV D\n2\nxfE\nT\nV v\n\u2217\nredQ\nT txred + EV DxD\u03bbfE\nT\nV v\n\u2217\nredt\u03bb\n+EV (DxfE\nT\nV + \u03c9\n\u2217ETW )tvred + EV E\nT\nW v\n\u2217\nredt\u03c9 ,\n0 = 2\u3008v\u2217red, tvred\u3009.\n(4.16)\nWe need to show that ker(DF ) is one-dimensional. Similarly, as in the proof of convergence for\nthe non-symmetric case, Theorem 4.2, see e.g. [1, 12, 14], we conclude from the first equation of\n(4.16) that\n(txred , t\u03bb) = t\u03bb(x\n\u2032\nred(\u03bb\n\u2217), 1).\nSince\nD2xf(x\n\u2217, \u03bb\u2217)x\u2032(\u03bb\u2217) + DxD\u03bbf(x\n\u2217, \u03bb\u2217) =\nd\nd\u03bb\nDxf(x(\u03bb), \u03bb)|\u03bb=\u03bb\u2217 ,\n29\nwhere x(\u03bb) = QT xred(\u03bb), we deduce from the second equation of (4.16) that\nEV\n(\nt\u03bb\nd\nd\u03bb\nDxf(x(\u03bb), \u03bb)|\u03bb=\u03bb\u2217E\nT\nV v\n\u2217\nred + (Dxf(x\n\u2217, \u03bb\u2217)ETV + \u03c9\n\u2217ETW )tvred + t\u03c9E\nT\nW v\n\u2217\nred\n)\n= 0.\n(4.17)\nSince ETV v\n\u2217\nred, E\nT\nV tv, E\nT\nW v\n\u2217\nred, E\nT\nW tv \u2208 X` and EV |X` is an isomorphism by Lemma 4.8 d) and\nsince Dxf(x(\u03bb), \u03bb) maps X` into itself by Lemmata 4.3 and 4.10, (4.17) implies that\nt\u03bb\nd\nd\u03bb\nDxf(x(\u03bb), \u03bb)|\u03bb=\u03bb\u2217E\nT\nV v\n\u2217\nred + Dxf(x\n\u2217, \u03bb\u2217)ETV tv + \u03c9\n\u2217ETW tv + t\u03c9E\nT\nW v\n\u2217\nred = 0.\nLet tv = E\nT\nV tvred and tw = E\nT\nW tvred . By Lemma 4.8 c) we have tv +itw \u2208 X\nc\n` which we will need\nlater on. Denote v\u2217 = ETV v\n\u2217\nred, w\n\u2217 = ETW v\n\u2217\nred such that, by Proposition 4.9 b), v\n\u2217 +iw\u2217 is a Hopf\neigenvector. Then we get\n0 = t\u03bb\nd\nd\u03bb\nDxf(x(\u03bb), \u03bb)|\u03bb=\u03bb\u2217v\n\u2217 + Dxf(x\n\u2217, \u03bb\u2217)tv + \u03c9\n\u2217tw + t\u03c9w\n\u2217\n= Re\n(\nt\u03bb\nd\nd\u03bb\nDxf(x(\u03bb), \u03bb)|\u03bb=\u03bb\u2217 (v\n\u2217 + iw\u2217) + Dxf(x\n\u2217, \u03bb\u2217)(tv + itw)\n)\n\u2212Re (i\u03c9\u2217(tv + itw) + it\u03c9(v\n\u2217 + iw\u2217)) .\nBy Lemma 4.8 c), v\u2217 + iw\u2217 \u2208 Xc` . Therefore\n0 = \u03b1t\u03bb\nd\nd\u03bb Dxf(x(\u03bb), \u03bb)|\u03bb=\u03bb\u2217v\n\u2217 + \u03b1Dxf(x\n\u2217, \u03bb\u2217)tv + \u03c9\n\u2217\u03b1tw + t\u03c9\u03b1w\n\u2217\n= t\u03bb\nd\nd\u03bb Dxf(x(\u03bb), \u03bb)|\u03bb=\u03bb\u2217\u03b1v\n\u2217 + Dxf(x\n\u2217, \u03bb\u2217)\u03b1tv + \u03c9\n\u2217\u03b1tw + t\u03c9\u03b1w\n\u2217\n= Re\n(\ne\u22122pii\/`(t\u03bb\nd\nd\u03bb Dxf(x(\u03bb), \u03bb)|\u03bb=\u03bb\u2217 (v\n\u2217 + iw\u2217) + Dxf(x\n\u2217, \u03bb\u2217)(tv + itw))\n)\n\u2212Re\n(\ne\u22122pii\/`(i\u03c9\u2217(tv + itw)\u2212 it\u03c9(v\n\u2217 + iw\u2217))\n)\n,\nwhere we used the L-equivariance of Dxf(x(\u03bb), \u03bb) (Lemma 4.3) in the second line. Since e\n\u22122pii\/` \/\u2208\nR for ` > 2 these last two equations imply that\n0 = t\u03bb\nd\nd\u03bb Dxf(x(\u03bb), \u03bb)|\u03bb=\u03bb\u2217 (v\n\u2217 + iw\u2217)\n+Dxf(x\n\u2217, \u03bb\u2217)(tv + itw)\u2212 i\u03c9\n\u2217(tv + itw)\u2212 it\u03c9(v\n\u2217 + iw\u2217).\n(4.18)\nLet v(\u03bb) + iw(\u03bb), v(\u03bb\u2217) = v\u2217, w(\u03bb\u2217) = w\u2217, v(\u03bb), w(\u03bb) \u2208 X`, be the path of eigenvectors of\nDxf(x(\u03bb), \u03bb) to the eigenvalues \u00b5(\u03bb) with \u2016v(\u03bb)\u2016 = 1. Let u\n\u2217 = v\u2217 + iw\u2217 and let u\u2217L \u2208 X\nc\n` be\nthe uniquely determined left eigenvector of Dxf(x\n\u2217, \u03bb\u2217) to the eigenvalue i\u03c9\u2217 with \u3008u\u2217L, u\n\u2217\u3009 = 1.\nAs in the non-symmetric case, see [1, 14, 12], (4.18) then implies that\nt\u03bbu\n\u2217\nL\nd\nd\u03bb\nDxf(x(\u03bb), \u03bb)\u03bb=\u03bb\u2217u\n\u2217 = it\u03c9 .\nThis combined with\n\u3008u\u2217L,\nd\nd\u03bb\nDxf(x(\u03bb), \u03bb)\u03bb=\u03bb\u2217u\n\u2217\u3009 = \u00b5\u2032(\u03bb\u2217)\nand the assumption that Re \u00b5\u2032(\u03bb\u2217) 6= 0 gives t\u03bb = 0. Hence tx = 0 and t\u03c9 = 0. As in the proof\nof Theorem 4.2, (4.18) reduces to\nDxf(x\n\u2217, \u03bb\u2217)(tv + itw)\u2212 i\u03c9\n\u2217(tv + itw) = 0\n30\nso that tv + itw is a Hopf eigenvector. Since tv + itw \u2208 X\nc\n` we deduce from Lemma 4.7 that\ntv + itw = c(v\n\u2217 + iw\u2217) for some c \u2208 C. By the definition of v\u2217, w\u2217 and tv, tw this is equivalent to\nETV tvred + iE\nT\nW tvred = c(E\nT\nV v\n\u2217\nred + iE\nT\nW v\n\u2217\nred). (4.19)\nBy Lemma 4.8 the map EV E\nT\nV \u2208 Mat(d) is invertible. Therefore we conclude from (4.19) that\ntvred \u2208 span(v\n\u2217\nred, w\n\u2217\nred), where w\n\u2217\nred := (EV E\nT\nV )\n\u22121EV E\nT\nW v\n\u2217\nred. From the last row of DF we get\nthe additional condition \u3008v\u2217red, tvred \u3009 = 0 on tvred . Hence the kernel of DF is one-dimensional and\nDF has full rank in the Hopf point.\nInitial guess for the Gauss-Newton iteration As in the non-symmetric case, see Section\n4.1.2, we use Hermite interpolation between two consecutive periodic orbits y(0) and y(1) be-\ntween of which a Hopf bifurcation was detected and determine the point \u03c4\u02c6 on the interpolating\npolynomial y(\u03c4) = (x(\u03c4), T (\u03c4), \u03bb(\u03c4)) with \u03bb\u2032(\u03c4\u02c6 ) = 0. This way we obtain an initial approxima-\ntion x\u02c6 = x(\u03c4\u02c6 ) for the Hopf point, an initial approximation \u03bb\u02c6 = \u03bb(\u03c4\u02c6 ) for its parameter, and an\ninitial approximation \u03c9\u02c6 = 2pi\nT\u02c6\nfor its frequency, where T\u02c6 = T (\u03c4\u02c6). If ` = 2 we let\nv\u02c6 = c E2\nd\nd\u03c4\nx1(\u03c4\u02c6 ), w\u02c6 = \u2212c\n1\n\u03c9\u02c6\nDxf(x\u02c6, \u03bb\u02c6)\nd\nd\u03c4\nx1(\u03c4\u02c6 )\nwhere c is such that \u3008v\u02c6, v\u02c6\u3009+ \u3008w\u02c6, w\u02c6\u3009 = 1 and take the point (x\u02c6red = Qx\u02c6, \u03bb\u02c6, v\u02c6, w\u02c6, \u03c9\u02c6) as initial guess\nfor the Gauss-Newton iteration applied to (4.13). If ` > 2 we define\nv\u02c6 = cEV\nd\nd\u03c4\nx1(\u03c4\u02c6 )\nwith c \u2208 R such that \u3008v\u02c6, v\u02c6\u3009 = 1 and use (x\u02c6red, \u03bb\u02c6, v\u02c6, \u03c9\u02c6) as initial guess for the Gauss-Newton\niteration applied to (4.14).\n5 Applications\nIn this section we illustrate the numerical methods for the continuation of symmetric periodic\norbits which we presented in the preceding sections and implemented in the code SYMPERCON\n[20] with some examples.\n5.1 The Lorenz model - comparison with AUTO and CONTENT\nThere are many programs for the numerical continuation of periodic orbits of non-symmetric\nsystems. Two of the most well known and widely used programs are AUTO [8] and CONTENT\n[17] the numerical part of which is based on AUTO. In both programs collocation is used to\nfind periodic solutions. This approach is equivalent to the multiple shooting ansatz with the\nmultiple shooting points being the grid points and the IVP solver having only one step.\nOne of the key new features of SYMPERCON compared to those program packages is the\nexploitation of symmetries of periodic orbits and the computation of symmetry breaking and\nsymmetry increasing bifurcations, and we present some applications of these methods in the next\nsections. In this section we give numerical evidence that the program package SYMPERCON\nis also competitive when applied to continuation of non-symmetric periodic orbits. We compare\nthe programs AUTO, CONTENT and SYMPERCON using an example which is taken from\n31\n\u03bbx2\n\u03bb\nx2\nFigure 4: Feigenbaum cascade in the Lorenz model as computed by SYMPERCON. The right\nfigure is a zoom of the lower left corner of the left figure.\nthe CONTENT Tutorial (ver 1.4) [17] \u201dODEs: Lorenz system: Continuation of limit cycles and\nbranch switching\u201d. Starting with the Lorenz system\nx\u20321 = \u2212\u03c3x1 + \u03c3x2,\nx\u20322 = \u2212x1x3 + \u03bbx1 \u2212 x2.\nx\u20323 = x1x2 \u2212 bx3,\nwhere\n\u03c3 = 10, b = 8\/3,\nall programs find a periodic solution for the initial guess\n(x\u2217, T \u2217, \u03bb\u2217) = ((16.2, 57.4, 250.8), 0.411, 312)\nfrom [17]. We continue this limit cycle with respect to the parameter \u03bb with required relative\nerror tol = 10\u22125. The Lorenz system has the Z2-symmetry (x1, x2, x3) \u2192 (\u2212x1,\u2212x2, x3) and the\nabove periodic orbit is Z2-symmetric. All programs detect a bifurcation of this periodic orbit at\n\u03bb = 312.97. This is a symmetry breaking flip pitchfork bifurcation, so the bifurcating periodic\norbits are non-symmetric. The bifurcating branch of non-symmetric periodic orbits which we\ntake as primary branch in this comparison subsequently undergoes a period doubling cascade,\nand we compared AUTO, CONTENT and SYMPERCON in their performance computing this\nbifurcation cascade.\nWhile SYMPERCON automatically doubles the number of multiple shooting points at each\nflip bifurcation up to a given maximum, in AUTO and CONTENT the entered number of grid\npoints has to be set by the user. Since this number of grid points has to be increased at period\ndoubling bifurcations - otherwise the Newton method fails to converge - we doubled the number\nmanually. But after the 4th period doubling we did not manage to configure CONTENT in\nsuch a way that it would find any more period doubling points. With AUTO we found a\n5th period doubling bifurcation. In comparison, SYMPERCON found periodic orbits of 26\ntimes the original period, with period-doubling bifurcations starting from the primary branch\nat parameters \u03bb = 229.41, \u03bb = 218.21, \u03bb = 215.97, \u03bb = 215.49, \u03bb = 215.39, and \u03bb = 215.37,\nsee Figure 4, and (when run with the compiler gcc under linux) even a 7th period doubling\npoint at \u03bb = 215.36. But all programs were very sensitive to changes of the parameters of the\ncomputation (like the number of initial grid points m, the initial continuation steplength etc)\nand the choice of C compiler used.\n32\n5.2 Symmetry breaking bifurcations in coupled cells\n+\n+\n+\n+\n+\n+\n20.00 20.05 20.10 20.15 20.20 20.25 20.30 20.35 20.40 20.45\n2.96 \n2.97 \n2.98 \n2.99 \n3.00 \n3.01 \n3.02 \n3.03 \n3.04 \n+ + + + + + + + +\n+\n+\n+\n+\n+\n+\n+\n+\n+\nx4\n\u03bb\nFigure 5: Equivariant Hopf bifurcation of Z4-symmetric periodic orbits of the Brusselator\n+\n+\n+\n+\n+\n+\n2.86 2.88 2.90 2.92 2.94 2.96 2.98 3.00 3.02 3.04\n2.86 \n2.88 \n2.90 \n2.92 \n2.94 \n2.96 \n2.98 \n3.00 \n3.02 \n3.04 \n+ + + + + + + + + +\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\nx4\nx2\nFigure 6: Z4-symmetric periodic orbits near an equivariant Hopf point of the Brusselator - the\nbold parts of the trajectories are computed numerically.\nIn this section we apply our methods to compute equivariant Hopf points and symmetry\nbreaking flip pitchfork bifurcations in the Brusselator model of coupled cells with parameters\nas in [3]. We consider four identical cells in which the same reaction takes place and which are\ncoupled by diffusion. The equations for the 4-cell Brusselator are the following (j = 1, 3, 5, 7,\nxi := xi\u22128 for i > 8)\nx\u2032j = A\u2212 (B + 1)xj + x\n2\njxj+1 + \u03bb(\u22123xj + xj+2 + xj+4 + xj+6)\/1000,\nx\u2032j+1 = Bxj \u2212 x\n2\njxj+1 + \u03bb(\u22123xj+1 + xj+3 + xj+5 + xj+7)\/1000,\nwhere A = 2.0, B = 5.9. The problem is invariant with respect to permutations of the cells,\nthus the equations are S4-equivariant. We denote the elements of \u0393 = S4 by \u03b3ijkl , e.g.,\n\u03b32314 =\n\uf8eb\uf8ec\uf8ec\uf8ed\n0 0 id 0\nid 0 0 0\n0 id 0 0\n0 0 0 id .\n\uf8f6\uf8f7\uf8f7\uf8f8 , id \u2208 Mat(2, 2).\n33\nFrom [3] we took the following equivariant Hopf point\n(x\u2217, \u03bb\u2217) = (2.0, 2.95, 2.0, 2.95, 2.0, 2.95, 2.0, 2.95, 20.45).\nThe corresponding imaginary eigenvalue \u03c9\u2217i has the value \u03c9\u2217 = 0.62058 and belongs to an\nabsolutely irreducible 3-dimensional representation, c.f. Remark 2.4. The real eigenspace N\u03c9\u2217\nof \u03c9\u2217i is of the form N\u03c9\u2217 = V \u2295W with\nV = {(v1, 0, v2, 0, v3, 0,\u2212v1 \u2212 v2 \u2212 v3, 0) | v1, v2, v3 \u2208 R},\nW = {(0, w1, 0, w2, 0, w3, 0,\u2212w1 \u2212 w2 \u2212 w3) | w1, w2, w3 \u2208 R}.\nLet eVj , e\nW\nj be the j-th unit vector of V and W respectively. Then the vectors e\nV\nj + ie\nW\nj ,\nj = 1, 2, 3, are eigenvectors to the Hopf eigenvalues i\u03c9\u2217:\nDxf(x\n\u2217, \u03bb\u2217)(eVj + ie\nW\nj ) = i\u03c9\n\u2217(eVj + ie\nW\nj ), j = 1, . . . , 3. (5.1)\nUsing the equivariant Hopf Theorem (Theorem 4.5) we can now compute the symmetries and\ninitial planes of the emanating periodic solutions, as in [3]. As an example we consider periodic\norbits with spatio-temporal symmetry group\nL = {id, (\u03b33142,\n3\n4\n), (\u03b34321,\n1\n2\n), (\u03b32413,\n1\n4\n)},\nwhich means\nL = Z4, K = {id}.\nIn order to compute the starting plane NL\u03c9\u2217 we need to know how S\n1 acts on N\u03c9\u2217 . Let u =\n(v, w) \u2208 N\u03c9\u2217 = V \u2295W . Due to (5.1) and (4.6) we have for \u03b8 \u2208 S\n1 ' R\/Z\n(id, \u03b8)u =\n(\ncos(2pi\u03b8)v \u2212 sin(2pi\u03b8)w\nsin(2pi\u03b8)v + cos(2pi\u03b8)w\n)\n.\nBy the equivariant Hopf Theorem 4.5 the starting plane NL\u03c9\u2217 is determined by the condition\nNL\u03c9\u2217 = {u \u2208 N\u03c9\u2217 | (\u03b3, \u03b8)u = u \u2200 (\u03b3, \u03b8) \u2208 L} = {u \u2208 N\u03c9\u2217 | (\u03b32413,\npi\n2\n)u = u}.\nHere we used that L = Z4 is generated by \u03b32413. After a short computation we obtain\nNL\u03c9\u2217 = {(u1, u2,\u2212u2, u1, u2,\u2212u1,\u2212u1,\u2212u2) | u1, u2 \u2208 R}.\nThe Z4-symmetric periodic orbits bifurcating from the equivariant Hopf point are shown in\nFigures 5 and 6. These solutions have already been computed in [3] by a Galerkin method based\non Fourier modes.\nUsing the methods of Section 3, SYMPERCON finds that this branch of Z4-symmetric\nperiodic orbits undergoes a flip pitchfork bifurcation at \u03bb\u2217 = 2.6738. A point x\u2217 on the periodic\norbit at the symmetry breaking bifurcation point is given by\nx\u2217 = (1.7041, 3.0132, 0.86523, 4.8152, 3.6590, 1.5591, 0.92057, 6.0440),\nand the period of this periodic solution is T \u2217 = 5.0410. The Z4-periodic solution close to the\nsymmetry breaking bifurcation (at the parameter \u03bb = 2.7904) and a Z2-symmetric periodic\norbit after the bifurcation (at the parameter \u03bb = 2.6734) can be seen in Figure 8, the bifurcation\ndiagram is shown in Figure 7.\n34\n++\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\n1.8 2.0 2.2 2.4 2.6 2.8 3.0 3.2 3.4 3.6 3.8 4.0\n0.75 \n0.80 \n0.85 \n0.90 \n0.95 \n1.00 \n1.05 \n+ + + + + + + + + + + +\n+\n+\n+\n+\n+\n+\n+\nx7\n\u03bb\nFigure 7: Flip pitchfork bifurcation from Z4 to Z2-symmetry in the 4-cell Brusselator\n1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5\n1.5 \n2.0 \n2.5 \n3.0 \n3.5 \n4.0 \n4.5 \n5.0 \n5.5 \n+ + + + + + + + +\n+\n+\n+\n+\n+\n+\n+\n+\n+\n1.5 2.0 2.5 3.0 3.5 4.0 4.5 5.0 5.5 6.0\n1.5 \n2.0 \n2.5 \n3.0 \n3.5 \n4.0 \n4.5 \n5.0 \n5.5 \n6.0 \n+ + + + + + + + + +\n+\n+\n+\n+\n+\n+\n+\n+\n+\n+\nx2\nx4\nx2\nx4\nFigure 8: Symmetric periodic orbits of the 4-cell Brusselator before and after a flip pitchfork\nbifurcation from Z4-symmetry to Z2-symmetry - the bold parts of the trajectories are computed\nnumerically.\n5.3 Electronic ring oscillator\nIn this section we a simulate an electrical circuit consisting of n MOSFET-inverters taken from\nKampowsky, Rentrop, Schmidt [15]. Such a circuit can be modelled in the following way: let Ui\nbe the voltage at the i-th node, then using Kirchhoff\u2019s law we get the differential equations\nf , f\u02dc : Rn \u2192 Rn, U\u02d9 = f(U), f(U) = \u2212C\u22121f\u02dc(U)\nfor the vector U = (U1, . . . , Un) of the voltages. Here C is the capacity matrix\nC =\n\uf8eb\uf8ec\uf8ec\uf8ec\uf8ed\n2Cp + C \u2212Cp \u2212Cp\n\u2212Cp 2Cp + C \u2212Cp\n. . .\n. . .\n\u2212Cp \u2212Cp 2Cp + C\n\uf8f6\uf8f7\uf8f7\uf8f7\uf8f8 ,\n35\nFigure 9: Circuit of ring oscillator\nand the function f is given by\nf\u02dc(U) =\n\uf8eb\uf8ec\uf8ec\uf8ec\uf8ed\n1\/R(U1 \u2212 Uop) + g(Un, U1, U0)\n1\/R(U2 \u2212 Uop) + g(U1, U2, U0)\n...\n1\/R(Un \u2212 Uop) + g(Un\u22121, Un, U0)\n\uf8f6\uf8f7\uf8f7\uf8f7\uf8f8 ,\nwhere\ng(UG, UD, US) = K max{(UG \u2212 US \u2212 UT ), 0}\n2\n\u2212K max{(UG \u2212 UD \u2212 UT ), 0}\n2.\nThe constants K, UT , U0, Uop, R and the capacities C and Cp are technical parameters,\nwhich have (after appropriate scaling) the values K = 0.2, UT = 1, U0 = 0, Uop = 5, R = 5,\nC = 0.21, Cp = 5 \u00b7 10\n\u22123, see [15]. From [15] we took the initial values of a periodic solution,\nnamely U1 = 4.2087, U2 = 0.917, U3 = 2.6534, U4 = 4.2762, U5 = 0.6928, T = 6.298. This\nperiodic solution is shown in Figure 10. Furthermore there is a stationary solution given by\nUi(t) \u2261 2.56155, i = 1, . . . , 5. Our aim is now the numerical simulation of oscillations of large\nelectrical circuits, i.e., the computation of periodic orbits for large n.\nThe function f : Rn \u2192 Rn is Zn-equivariant where the generating element \u03b3n of\nZn = {id, \u03b3n, . . . \u03b3\nn\u22121\nn }\nis acting on Rn by shifting the components to the right\n\u03b3n(x1, . . . , xn) = (x2, . . . , xn, x1).\nThis representation of Zn is called the regular representation of Zn, see [21]. Using SYMPER-\nCON we checked that the above periodic solution (with n = 5) has spatio-temporal symmetry\nL = Z5. Since the stationary solution is Zn-invariant the periodic solution might have branched\nfrom the stationary solution via an equivariant Hopf bifurcation. So we introduce Uop as a\n36\n0.00 1.00 2.00 3.00 4.00 5.00 6.00\n1.00 \n1.50 \n2.00 \n2.50 \n3.00 \n3.50 \n4.00 \n4.50 \n+ + + + + + +\n+\n+\n+\n+\n+\n+\n+\n+\nt\nU1 U3 U5 U2 U4\nFigure 10: Periodic solution for 5 inverters\ncontinuation parameter and examine the stationary Zn-invariant solutions U = (u, . . . , u) \u2208 R\nn,\nu \u2208 R, which are given by the equation\n1\/R(u\u2212 Uop) + g(u, u, U0) = 0\n\u21d0\u21d2 1\/R(u\u2212 Uop) + K(max(u\u2212 UT , 0))\n2 = 0.\nIn U = (u, . . . , u) the Jacobian DUf(U) is Zn-symmetric:\n\u03b3 DU f(U) = DUf(U) \u03b3 \u2200 \u03b3 \u2208 \u0393 = Zn. (5.2)\nFrom elementary representation theory it is known that in a regular representation each irre-\nducible representation \u03d1i is contained ni times, where ni is the dimension of the representation\n\u03d1i, see [21]. Finite cyclic groups Zn only have two dimensional complex irreducible representa-\ntions (as defined in Remark 2.4). Over C they are given by\n\u03d1j(\u03b3n) = e\n2piij\nn , j = 0, . . . n\u2212 1, (5.3)\nsee [21]. Let Xj denote the \u0393-irreducible subspace of R\nn belonging to \u03d1j . Then Xj , j =\n0, . . . , n\u2212 1, is spanned by the real part vj and imaginary part wj of the vector\nvj + iwj = (1, e\n2piij\nn , e\n2pii2j\nn , . . . , e\n2pii(n\u22121)j\nn ).\nUsing (5.2) we conclude that the Jacobian DUf(U) can be diagonalised over C. Here vj + iwj\nis an eigenvector to the eigenvalue\n\u03bbj =\n1\/R + 2K max(u\u2212 UT , 0)e\n2pii(n\u22121)j\nn\nC + (2\u2212 2 cos 2pijn )Cp\n, (5.4)\nas can be computed easily. Setting Re(\u03bbj) = 0 we get simple expressions for the stationary\nsolution u = u(j) and the corresponding parameter U\n(j)\nop for which an equivariant Hopf bifurcation\ncan occur, and also for the Hopf frequency \u03c9j . Using the equivariant Hopf Theorem 4.5 we\nconclude that every bifurcating periodic solution has the symmetry L = Zn. But we also have\n37\nTable 1: Amount of work for the computation of symmetric periodic orbits with trivial isotropy\nof the electrical circuit depending on the number n of inverters\nwith exploitation\nof symmetry\nwithout exploita-\ntion of symmetry\nflow \u03a6t(x) O(n) Nstep \u2217O(n)\nWronskian matrix Dx\u03a6t(x) O(n) Nstep \u2217O(n\n2)\nlinear algebra O(n) O(n3)\nto determine the homomorphism \u0398 of the bifurcating periodic orbits and thereby their isotropy\nK and drift symmetry \u03b1. For this we have to know the operation of \u0393 \u00d7 S1 on the Hopf\neigenspace N\u03c9\u2217 = Xj , see (4.6). We compute that \u0393\u00d7 S\n1 operates on the irreducible subspace\nXj = span(vj , wj) in the following way\n(\u03b3, \u03b8)(vj + iwj) = \u03d1j(\u03b3)e\n2pii\u03b8(vj + iwj), (5.5)\nwhere \u03b3 \u2208 \u0393, \u03b8 \u2208 S1 \u2261 R\/Z. We can characterize the homomorphism \u0398j of the bifurcating\nperiodic orbits tangential to N\u03c9\u2217 = Xj by the homomorphism \u0398j(\u03b3n) applied to the generating\nelement \u03b3n of Zn. From (5.5) and (5.3) we get\n\u0398j(\u03b3n) = \u2212j\/n.\nLet r be the greatest common divisor of n and j and nred := n\/r. Then K is generated by \u03b3\nnred\nn ,\nand the fixed point space Fix(K) contains all vectors in Rn which consist of r equal sections of\nlength nred. Therefore nred is the dimension of the reduced system.\nAfter restriction onto the fixed point space Fix(K) = Rnred we obtain L = Znred , K = {id}.\nThen \u03b3nred \u2261 \u03b3nK is a generating element of Znred . The group Znred also acts on R\nnred by\ncyclically permuting the components of every x \u2208 Rnred . The representation \u03d1jred with jred :=\nj\/r is the irreducible representation of Znred on R\nnred which corresponds to \u03d1j . Thus,\nN red\u03c9\u2217 = \u3008Vjred , Wjred \u3009 \u2282 R\nnred\nis the initial plane for the periodic solutions in the reduced coordinates. Finally we have to\ndetermine the element \u03b1 \u2208 Znred with the smallest phase shift \u0398red(\u03b1). Let \u03b1 = \u03b3\nk\nnred , where k\nis an integer between 1 and nred \u2212 1. Then \u03b1 is given by the equation \u0398red(\u03b1) = 1\/nred, i.e.,\n\u03d1jred (\u03b1)e\n2pii\/nred = 1 \u21d4 jred k \u2261 1 (mod nred).\nBy the just described method we can compute initial values for periodic solutions for arbitrary\nn, and by exploiting symmetry we can reduce the amount of work effectively: if the considered\nperiodic solution has large spatial symmetry then the ODE is reduced to a system with small\ndimension nred. For example, in the case n = 1000, there is a periodic solution with K = Z200,\nnred = 5, which corresponds to the above computed solution with n = 5.\nIf the periodic solution does not have any spatial symmetry, but only spatio-temporal sym-\nmetry then only the integration interval can be reduced by exploitation of symmetry. Let Nstep\nbe the number of integration steps for the full integration interval [0, T ]. If the symmetry is not\nexploited, Nstep \u2217O(n) multiplications and divisions are needed for the computation of the flow;\nexploiting the symmetry we can reduce the number of integration steps from Nstep to Nstep\/n,\n38\nsince the integration interval is only [0, T\/n]. Hence for large n the number of time steps is O(1),\nand so the number of multiplications and divisions for the computation of the flow is O(n) when\nsymmetry is exploited. Since the derivatives Dxf(x) are tridiagonal matrices and hence contain\nonly O(n) non-zero components, Nstep \u2217 O(n\n2) multiplications are needed for the computation\nof the Wronskian matrices Dx\u03a6t(x) by integration of the variational equation if the symmetry\nis not exploited; if the symmetry is exploited then for large n only few steps of integration are\nnecessary for the computation of the Wronskian matrices. Therefore the Wronskian matrices\nare sparse, and only contain non-zero entries close to the diagonal. Hence by exploitation of\nsymmetry the amount of work for the computation of the Wronskian reduces to O(n). For the so-\nlution of the linear equations which arise in the Gauss-Newton method O(n3) multiplications are\nneeded if the symmetry is not exploited, and the amount of work for the linear algebra reduces\nto O(n) due to the sparse structure of the Wronskians if the symmetry is exploited. Altogether\nwe obtain a remarkable reduction of the computational cost by exploitation of symmetry, c.f.\nTable 1.\nConclusion and future directions\nIn this paper we have presented efficient algorithms for the computation of generic symmetry\nchanging but isotropy preserving bifurcations of periodic orbits in systems where the symmetry\ngroup is discrete. These bifurcations were analyzed by Golubitsky et al (equivariant Hopf bifur-\ncation, see eg [11]) and Fiedler (flip doubling and flip pitchfork bifurcations, see [9]). General\nsymmety breaking bifurcations of periodic orbits in systems with discrete symmetry group were\nclassified by Lamb and Melbourne [18], see also [19] and [24] for the case of continuous symme-\ntry groups. In future work we will extend our numerical results to compute symmetry changing\nbifurcations of periodic orbits of arbitrary Lie group actions. In the paper [26] we extend the\nmethods presented here to Hamiltonian systems with continuous symmetries building on the\npersistence results of [25].\nReferences\n[1] W.-J. Beyn, A. Champneys, E. Doedel, W. Govaerts, Y. A. Kuznetsov, B. Sandstede.\nNumerical continuation, and computation of normal forms. Chapter 4 of Handbook of\nDynamical Systems, vol. 2, B. Fiedler ed., pp. 149\u2013219, 2002.\n[2] K. A. Cliffe, A. Spence, and S. J. Tavener. O(2)-symmetry breaking bifurcation: with\napplication to the flow past a sphere in a pipe. Internat. J. Numer. Methods Fluids 32(2):\n175\u2013200, 2000.\n[3] M. Dellnitz. A computational method and pathfollowing for periodic solutions with sym-\nmetry. In D. Roose, B. de Dier, A.Spence, ed., Continuation and Bifurcations: Numerical\nTechniques and Applications, NATO ASI SERIES C, vol. 313, pp. 153\u2013167, 1990.\n[4] M. Dellnitz. Computational bifurcation of periodic solutions in systems with symmetry.\nIMA Journal of Numerical Analysis, 12: 429\u2013455, 1992.\n[5] P. Deuflhard. Computation of periodic solutions of nonlinear ODE\u2019s. BIT 24: 456\u2013466,\n1984.\n[6] P. Deuflhard. Recent progress in extrapolation methods for ordinary differential esquations.\nSIAM Review 27: 505-535, 1985.\n39\n[7] P. Deuflhard, B. Fiedler, P. Kunkel. Efficient numerical pathfollowing beyond critical points.\nSIAM J. Numer. Anal., 18: 949\u2013987, 1987.\n[8] E.J. Doedel, R.C. Paffenroth, A.R. Champneys, T.F. Fairgrieve, Y.A. Kuznetsov, B.E.\nOldeman, B. Sandstede and X.-J. Wang. AUTO2000: Continuation and bifurcation software\nfor ordinary differential equations. Technical Report, Concordia University 2000, available\nfrom http:\/\/www.cs.concordia.ca.\n[9] B. Fiedler. Global Bifurcation of Periodic Solutions with Symmetry. Lecture Notes in\nMathematics. Springer Verlag, Berlin, Heidelberg, New York, 1988.\n[10] K. Gatermann, A. Hohmann. Symbolic exploitation of symmetry in numerical pathfollow-\ning. IMPACT Comput. Sci. Engrg. 3: 330\u2013365, 1991.\n[11] M. Golubitzky, I. Stewart, D. Schaeffer. Singularities and Groups in Bifurcation Theory,\nvolume 2. Springer-Verlag, Berlin, Heidelberg, New York, 1988.\n[12] A. Griewank and G. W. Reddien. The calculation of Hopf points by a direct method. IMA\nJ. Numer. Anal. 3: 295\u2013303, 1983.\n[13] J. Guckenheimer and P. Holmes. Nonlinear Oscillations, Dynamical Systems, and Bifurca-\ntions of Vector Fields, Applied Mathematical Sciences, vol. 42. Springer-Verlag, New York,\nHeidelberg, Berlin, 1990.\n[14] A. D. Jepson. Numerical Hopf Bifurcation. PhD thesis, California Institute of Technology,\n1981.\n[15] W. Kampowsky, P. Rentrop, W. Schmidt. Classification and numerical simulation of electric\ncircuits. Surveys on Mathematics for Industry, 2(1): 23\u201365, 1992.\n[16] Y. Kuznetsov. Elements of Applied Bifurcation Theory. Applied Mathematical Sciences,\nvol. 112. Springer, New York, 1995.\n[17] Y.A. Kuznetsov and V.V. Levitin. CONTENT: A multiplatform environment for continua-\ntion and bifurcation analysis of dynamical systems. Centrum voor Wiskunde en Informatica\n1997, available from ftp:\/\/ftp.cwi.nl\/pub\/CONTENT.\n[18] J. S. W. Lamb and I. Melbourne. Bifurcation from discrete rotating waves. Archive\nRat. Mech. Anal. 149: 229\u2013270, 1999.\n[19] J. Lamb, I. Melbourne, C. Wulff. General bifurcations from periodic solutions with spa-\ntiotemporal symmetry, including mode interactions and resonances. J. Differential Equa-\ntions, 191(2): 377\u2013407, 2003.\n[20] A. Schebesch. SYMPERCON - a package for the numerical continuation of symmetric\nperiodic orbits. Diplomarbeit, Freie Universita\u00a8t Berlin, 2004. The current version of SYM-\nPERCON can be obtained from http:\/\/www.maths.surrey.ac.uk\/personal\/st\/C.Wulff\/.\n[21] J.-P. Serre. Linear Representations of Finite Groups. Springer-Verlag, New York, Heidel-\nberg, Berlin, 1977.\n[22] C. Wulff. Numerische Pfadverfolgung von periodischen Lo\u00a8sungen mit Symmetrie. Di-\nplomarbeit, Freie Universita\u00a8t Berlin, 1993.\n[23] C. Wulff, A. Hohmann, P. Deuflhard. Numerical continuation of periodic orbits with sym-\nmetry. Technical report, Konrad-Zuse-Zentrum, Berlin, 1994.\n40\n[24] C. Wulff, J. Lamb, I. Melbourne. Bifurcation from relative periodic solutions. Er-\ngodic Th. Dyn. Syst. 21: 605\u2013635, 2001.\n[25] C. Wulff. Persistence of Hamiltonian relative periodic orbits. J. Geom. Phys. 48: 309-338,\n2003.\n[26] C. Wulff and A. Schebesch. Numerical continuation of Hamiltonian relative periodic orbits.\nPreprint.\n41\n"}