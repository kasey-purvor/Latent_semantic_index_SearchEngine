{"doi":"10.1109\/TIFS.2006.873596","coreId":"102432","oai":"oai:epubs.surrey.ac.uk:1891","identifiers":["oai:epubs.surrey.ac.uk:1891","10.1109\/TIFS.2006.873596"],"title":"The Boneh-Shaw fingerprinting scheme is better than we thought","authors":["Schaathun, HG"],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2006-06","abstract":"Digital fingerprinting is a forensic method against illegal copying. The distributor marks each individual copy with a unique fingerprint. If an illegal copy appears, it can be traced back to one or more guilty pirates due to this fingerprint. To work against a coalition of several pirates, the fingerprinting scheme must be based on a collusion-secure code. This paper addresses binary collusion-secure codes in the setting of Boneh and Shaw (1995\/1998). We prove that the Boneh-Shaw scheme is more efficient than originally proven, and we propose adaptations to further improve the scheme. We also point out some differences between our model and others in the literature. \u00a9 2006 IEEE","downloadUrl":"","fullTextIdentifier":null,"pdfHashValue":null,"publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:epubs.surrey.ac.uk:1891<\/identifier><datestamp>\n      2017-10-31T14:03:33Z<\/datestamp><setSpec>\n      74797065733D61727469636C65<\/setSpec><setSpec>\n      6469766973696F6E733D656E67616E64706879736963616C736369656E636573:436F6D707574696E67<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/epubs.surrey.ac.uk\/1891\/<\/dc:relation><dc:title>\n        The Boneh-Shaw fingerprinting scheme is better than we thought<\/dc:title><dc:creator>\n        Schaathun, HG<\/dc:creator><dc:description>\n        Digital fingerprinting is a forensic method against illegal copying. The distributor marks each individual copy with a unique fingerprint. If an illegal copy appears, it can be traced back to one or more guilty pirates due to this fingerprint. To work against a coalition of several pirates, the fingerprinting scheme must be based on a collusion-secure code. This paper addresses binary collusion-secure codes in the setting of Boneh and Shaw (1995\/1998). We prove that the Boneh-Shaw scheme is more efficient than originally proven, and we propose adaptations to further improve the scheme. We also point out some differences between our model and others in the literature. \u00a9 2006 IEEE.<\/dc:description><dc:date>\n        2006-06<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/epubs.surrey.ac.uk\/1891\/1\/fulltext.pdf<\/dc:identifier><dc:identifier>\n          Schaathun, HG  (2006) The Boneh-Shaw fingerprinting scheme is better than we thought   IEEE Transactions on Information Forensics and Security, 1 (2).  pp. 248-255.      <\/dc:identifier><dc:relation>\n        10.1109\/TIFS.2006.873596<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/epubs.surrey.ac.uk\/1891\/","10.1109\/TIFS.2006.873596"],"year":2006,"topics":[],"subject":["Article","PeerReviewed"],"fullText":"248 IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY, VOL. 1, NO. 2, JUNE 2006\nThe Boneh\u2013Shaw Fingerprinting\nScheme is Better Than We Thought\nHans Georg Schaathun, Member, IEEE\nAbstract\u2014Digital fingerprinting is a forensic method against\nillegal copying. The distributor marks each individual copy with\na unique fingerprint. If an illegal copy appears, it can be traced\nback to one or more guilty pirates due to this fingerprint. To work\nagainst a coalition of several pirates, the fingerprinting scheme\nmust be based on a collusion-secure code. This paper addresses\nbinary collusion-secure codes in the setting of Boneh and Shaw\n(1995\/1998). We prove that the Boneh\u2013Shaw scheme is more\nefficient than originally proven, and we propose adaptations to\nfurther improve the scheme. We also point out some differences\nbetween our model and others in the literature.\nIndex Terms\u2014Collusion-secure codes, copyright protection, dig-\nital fingerprinting (FP), traitor tracing.\nI. INTRODUCTION\nUNAUTHORIZED copying and distribution of copyrightedmaterial has received increasing attention over many\nyears, both in research communities and in the daily press.\nAuthors and artists depend on their income from legal sales,\nand unauthorised copying is often seen as a threat to these\nsales. For the movie or music industry, this is a question of big\nmoney.\nEstimated losses due to illegal copying are generally dis-\nputable. There is no generally accepted method to estimate the\nsales that would have been achieved without illegal copying.\nFor example, it is sometimes claimed that illegally distributed\ncopies have a promotional effect which actually increases sales.\nStill, it is clear that big money is at stake and the issue receives\ninterest from many different angles. Several countries these\ndays change their legislation to deal more effectively with\nillegal distribution in new media.\nDigital fingerprinting (FP) was introduced in [1], and given\nincreasing attention following [2]. A vendor selling digital\ncopies of copyrighted material wants to prevent illegal copying.\nDigital FP is supposed to make it possible to trace the guilty\nuser (pirate) when an illegal copy is found. This is done by\nembedding a secret identification mark, called a fingerprint, in\nManuscript received April 26, 2005; revised February 20, 2006. This work\nwas supported in part by the Commission of the European Communities through\nthe IST program under Contract IST-2002-507932, and in part by the Norwe-\ngian Research Council under Grant 146874\/20. Research was conducted in the\nDepartment of Informatics, University of Bergen, Bergen N-5020, Norway. The\ninformation in this document is provided as is, and no warranty is given or im-\nplied that the information is fit for any particular purpose. The user thereof uses\nthe information at its sole risk and liability. The associate editor coordinating\nthe review of this manuscript and approving it for publication was Prof. Thomas\nJohansson.\nThe author is with the Department of Computing, School of Electronics and\nPhysical Sciences, University of Surrey, Guildford GU2 7XH, U.K. (e-mail:\nh.schaathun@surrey.ac.uk).\nDigital Object Identifier 10.1109\/TIFS.2006.873596\neach copy, making every copy unique. FP can also be used to\nprotect broadcast encryption keys (i.e., cable TV decoders), in\nwhich context it is usually referred to as traitor tracing [3].\nThe fingerprint must be embedded in such a way that it does\nnot disturb the information in the data file too much. It must also\nbe impossible for the user to remove or damage the fingerprint,\nwithout damaging the information contents beyond any prac-\ntical use. In particular, the fingerprint must survive any change\nof file format (e.g., gif to tiff) and any reasonable lossy com-\npression. This embedding problem is essentially the same as the\nproblem of watermarking.\nIf a single pirate distributes unauthorized copies, they will\ncarry his or her fingerprint. If the vendor discovers the illegal\ncopies he or she can trace them back to the pirate and prosecute\nhim or her. If several pirates collude, they can to some extent\ntamper with the fingerprint. When they compare their copies,\nthey see some bits (or symbols) which differ and, thus, must\nbe part of the fingerprint. Identified bits may be changed and,\nthus, the pirates create a hybrid copy with a false fingerprint.\nCollusion-secure coding is required to enable tracing of at least\none pirate where a coalition of pirates have colluded.\nIn this paper, we study binary, concatenated, FP schemes gen-\neralizing and improving the approach of [2]. In Section II, we\nwill define the FP model, which we refine a little compared to\npast literature. In Section III, we give the main result, which is\nan improved error analysis of the BS FP scheme and new vari-\nants of it. Section IV gives further improvements in the two pi-\nrate case, and we finish with a conclusion and comparison with\nother schemes in Section V.\nII. FINGERPRINTING PROBLEM\nA. Preliminaries From Coding Theory\nAn code is a set of words of symbols from an\nalphabet of elements. The Hamming distance between two\nwords and is denoted , and the minimum distance\nof a code is denoted . The normalized minimum distance is\n.\nClosest neighbor decoding is any algorithm which takes a\nword and returns a word such that is minimized.\nThis can always be performed in operations and, for\nsome codes, it may be faster.\nFor the error analysis, we will use the well-known Chernoff\nbound as given in the following theorem. See, for example, [5]\nfor a proof. The relative entropy function is defined as\n(1)\n1556-6013\/$20.00 \u00a9 2006 IEEE\nSCHAATHUN: THE BONEH\u2013SHAW FINGERPRINTING SCHEME IS BETTER THAN WE THOUGHT 249\nTheorem 1 (Chernoff): Let be bounded, indepen-\ndent, and identically distributed stochastic variables in the range\n[0,1]. Let be their (common) expected value. Then, for any\n, we have\nWe write for the binomial distribution with trials\nwith probability . If is distributed as , we write\n. All logarithms will be to base 2 unless otherwise stated.\nB. BS Model and Marking Assumption\nOur model follows that of Boneh and Shaw (BS) [2]. Let\nbe a digital file divided into segments .\nWe call the file alphabet. Let be the set of users. We can\nview as a customer account number. Write .\nThe model assumes a watermarking scheme with an em-\nbedder allowing us to hide a symbol from some alphabet\nin a file segment , producing a watermarked file segment\n. The extractor inverts the embedding; given , it\noutputs .\nThe fingerprint encoder is an injective map ,\nidentifying each user by a fingerprint ,\nwhere . The image under of a subset is\ndenoted . The secret key is drawn uniformly at random\nfrom a key space when the system is initialized, and kept\nsecret by the vendor. The set is an code\ncalled the FP code (corresponding to ).\nWhen user buys a copy of file , the vendor obtains the\nfingerprint , and embeds each in to\nobtain the fingerprinted file , which is handed\nto the user.\nIf user na\u00efvly copies and redistributes , then the\nwatermarks can be extracted to obtain the fingerprint\n, which identifies the pirate who can\nbe prosecuted. If several pirates collude, they can cut and paste\nsegments from their different copies. Thus, the output from\nthe extractor will match one of the pirate fingerprints, but\nthe full sequence is a hybrid fingerprint which\nmatches none of the pirates.\nThe BS model presumes that this cut-and-paste attack is the\nonly one available to the pirates. This is expressed formally by\nthe marking assumption.\nDefinition 2 (The Marking Assumption): Let be the\nset of fingerprints held by a coalition of pirates. The pirates can\nproduce a copy with a false fingerprint for any ,\nwhere\nWe call the feasible set of .\nA position where the pirates see at least two symbols and,\nthus, have a choice is called a detectable position.\nExample 3 (Traitor Tracing): Collusion-secure codes are\nused for traitor tracing [3], where Definition 2 is satisfied as\nfollows. The system uses a matrix of permanent keys\n. Each row corresponds to an alphabet symbol and each\ncolumn to a coordinate position. The user with fingerprint\nreceives the key for every . The session\nkey is the exclusive or of elements to . An enabling\nblock is transmitted at the start of each session consisting of\nfor each and , where is the encryption function\nfor key . To get the session key, one key from each column of\nthe matrix is required, and that is exactly what each user has.\nWhen the pirates make a pirate decoder box, they must supply\nit with a key for each coordinate position from one of their true\nfingerprints and, thus, the marking assumption is satisfied.\nSome authors use alternative marking assumptions. Some\nmodels assume that the pirates can output any symbol in a\ndetectable position, or they may be allowed to output an erasure\n(no valid symbol) in detectable positions. See [6] and [7] for\ndetails. Muratani [8] uses a stronger assumption where the pi-\nrates output each word in the feasible set with equal probability,\nallowing much shorter codewords. Some authors assume that\nthe pirates have a certain probability of outputting a random\nsymbol from the alphabet in every column. These lead to the\nstudy of error- and collusion-secure codes [9].\nC. FP Scheme\nAn FP scheme is an ensemble\n, where is the encoding as defined in the previous\nsection, and the FP code is an code. The tracing al-\ngorithm takes a hybrid fingerprint as an input and outputs\na set . It is successful if is a nonempty subset of the\npirates. The rate of the FP scheme is the rate of the code ,\nnamely .\nWe adhere to Kerchoff\u2019s principles, so the key is random and\nsecret, and everything but the key is public information. That\nis, the pirates know the definition of and . If the entire\nsystem is leaked, a new random key can be chosen for the same\nscheme, and it will be secure for future applications (until the\nkey is again compromised).\nThe game proceeds in the following steps.\n1) The vendor chooses the FP scheme to use for the product\nhe or she is selling; this is the vendor strategy. We assume\nthat this is known to the pirates.\n2) The key is chosen at random, and kept secret by the\nvendor.\n3) The copies of the digital data are generated using the FP\nscheme and the key, and distributed to the users. A coalition\nof (potential) pirates is thus assigned fingerprints\n, and receives a set of\nfingerprinted copies.\n4) The coalition of potential pirates gets together and com-\npares the copies .\n5) If Error is sufficiently low, the pirates seeing\nwill opt out, without committing any crime.\n6) If the pirates choose to play, they choose a strategy for\nselecting segments from the different copies, paste together\na hybrid copy, and sell the copies with a hybrid fingerprint\n.\n7) If and when an illegal copy is discovered, the vendor ex-\ntracts the hybrid FP , computes , and prosecutes\nany users traced.\n250 IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY, VOL. 1, NO. 2, JUNE 2006\nNote that we have three outcomes of the game. The pirates can\nchoose not to play (Event 0). If they do play, we get a random\noutcome, either error where the pirates win, or error where the\npirates lose.\nFor an event , let denote the probability of\nunder the distribution induced by the uniform distribution of\nunder the assumption that the pirates always play regardless\nof and choose strategy in Step 6. The pirates want to es-\ncape and will therefore choose to maximize , so let\n. The traditional definition of col-\nlusion-secure codes is based on the unconditional probability\nError , given no information about or .\nDefinition 4 (Weak Security): An FP scheme is (weak)\n-secure if, for any , Error when a set\nof pirates is drawn uniformly at random.\nUnauthorized copying is a criminal act (in most countries),\nand pirates that are caught will therefore be subject to punish-\nment. The primary reason for assigning punishment is to deter\npotential pirates. The vendor\u2019s goal is not necessarily to win the\ngame (make the pirates lose). Deterring the pirates (Event 0)\nobtaining a stalemate where nobody wins and nobody loses is\nperfectly satisfactory.\nThe pirates choose whether to play or not in Step 5,\naccording to their perceived probability of escaping (i.e.,\nError ). This probability can be higher or lower\nthan the unconditional probability Error . We expect that\nthere is a threshold such that the pirates choose to play if\nand only if Error . If Error ,\nwe get Event 0. Note that a (weak) -secure code is not\nsufficient to deter all pirate coalitions of size or less. This is\nwhy we introduce a new and stronger definition.\nDefinition 5 (Strong Security): An FP scheme is strongly\n-secure if, for any seen by at most pirates, we have\nError .\nClearly, a strongly -secure FP scheme will deter any pirate\ncoalition of size at most if . By abuse of language, we\nshall sometimes say that is -secure when the scheme\nis.\nDefinition 6: Let be an FP scheme. The a priori error bound\nis the smallest such that is (weak) -secure. The a\nposteriori error bound is the smallest such that is strongly\n-secure.\nEven though the explicit definition of strong -secure codes is\nnew, many previous schemes do meet the definition, including\nthe BS scheme. Some authors bound Error for any\n, which clearly bounds .\nThe phenomenon that pirates with a higher escape proba-\nbility are more likely to play is called adverse selection in eco-\nnomics and game theory. This affects the following interesting\nprobability:\nError The pirates did play\nOf course, when the vendor finds an illegal copy, he or she\nknows that the pirates have played, and it is interesting for him\nor her (and for the court if the FP scheme is used as evidence),\nwhat the error probability is under this condition. The following\nlemmata gives some information about this.\nLemma 7: When the vendor obtains an illegal copy having\nonly the knowledge of the key and the false fingerprint , the\nprobability of getting an incorrect output from is, at\nmost, the a posteriori error bound .\nProof: Since bounds the conditional error probability\nfor any information that the pirate could have; in particular, it\nbounds this probability for any information which would induce\nthe pirates to play. Hence, also bounds the probability of error\nunder the condition that the pirates play.\nLemma 8: Unless Error is constant over all ,\nthere is a pirate strategy such that .\nProof: Write Error , and write\nSuppose the pirates choose to play whenever . Write\n. Then, we get that\nWe clearly get that since we have removed only small\nterms from the average.\nTo summarize, if the pirates decide to do illegal copying be-\nfore they see their copies, their chance of escape is at most .\nFor any pirate collusion of size, at most, having compared their\ncopies, the chance of escape is, at most, . Which error bound\nis the most important will depend on the application.\nDefinition 9 (Errors and Failures): Let be the output\nof the tracing algorithm and be the pirate collusion. An\nerror of Type I (or a failure) is the event that . An error of\nType II (or false accusation) is the event that .\nIn the context of criminal law, we know that Type II errors\nare a serious matter. Frequent Type I errors mean that we often\ndo not get useful output, but they do not affect the reliability\nof the output which is obtained. If Type II errors are frequent,\nthe output cannot be trusted even when we have output. For the\nrest of this paper, will denote the a posteriori probability of\nType I error, and the a posteriori probability of Type II error.\nA scheme with such error probabilities is said to be (strongly)\n-secure.\nIII. CONCATENATED SCHEMES\nIn this chapter, we develop a general analysis of concatenated\nFP schemes. Such concatenation was applied in [2], but our error\nanalysis will prove that those constructions have a better error\nrate than originally proven. We make the following formal def-\ninition of concatenated schemes.\nDefinition 10 (Concatenated Fingerprinting Scheme): Let\nbe an FP scheme, and\nan FP scheme. Let denote the alphabet of .\nA concatenated FP scheme\nconsists of the following elements. The key is a tuple\nSCHAATHUN: THE BONEH\u2013SHAW FINGERPRINTING SCHEME IS BETTER THAN WE THOUGHT 251\n, where is a key for and\nare keys for . The encoding is\nwhere and (2)\nEach segment of the word is called a block. The algo-\nrithm first decodes each block using , and then decodes\nthe resulting word over using .\nNote that the FP code of is the concatenation of the FP\ncodes of and . Let and denote the rates of and\n, respectively. We demand that is strongly secure,\nbut our analysis is otherwise oblivious to its structure. On the\nother hand, the error analysis must be made separately for each\ntype of outer scheme , but this scheme does not have to be\ncollusion-secure in itself.\nWe analyze two different kinds of outer codes, namely\nrandom codes as suggested in [2] in Section III-B, and codes\nwith large minimum distance in Section III-D. The probability\nof Type II errors is bounded for each choice of outer codes. In\nSection III-C, we study parameters of the BS codes (i.e., using\nthe inner code of [2] and random outer codes).\nThe original concatenated BS scheme will be named BS\u2013RC.\nThe acronym before the dash indicates the inner code, the BS\ninner code, and the last letters indicate the outer code, a random\ncode. Other schemes discussed in this section are BS\u2013RS with\nReed\u2013Solomon outer codes, and BS\u2013AG with asymptotic alge-\nbraic-geometry (AG) outer codes.\nA. Decoding and Type I Errors\nFor the outer tracing algorithm , we use list decoding,\ndefined as follows.\nDefinition 11: A list decoding algorithm for a code takes\nas input an word and a threshold and returns the set\nWe have chosen list decoding because it gives us simple\nproofs. It has the additional advantage that we often get to trace\nseveral pirates.\nRemark 12: The closest neighbor of will be in the list\nunless . Hence, if list decoding is successful, then the\nclosest neighbor decoding is successful too. Thus, we can use\nthe closest neighbor decoding instead without increasing the\ntotal error probability. However, when , list decoding\ngives Type I error and closest neighbor gives Type II.\nLet be the number of blocks where inner decoding\nis incorrect. The pirates match in at least blocks\non average, which means that if , then\nat least one guilty pirate is caught.\nObserve that is the sum of independent Bernoulli trials\nwith probability at most . It follows that:\nwhere , and we get the following theorem by\nthe Chernoff bound.\nTheorem 13: Let be a strongly -secure FP scheme,\nand a scheme where is list decoding\nwith threshold . Then, using , the probability of\nidentifying no guilty user is\nif\nCorollary 14: If and ,\nthen the probability of Type I error tends to zero with increasing\ncode length .\nNote that the bound on depends only on , , , and\n. It is oblivious to . The Type II error probability will\ndepend on the design of . The inner code keys have to be\nindependent so that errors in two distinct blocks are independent\nevents. Otherwise, the Chernoff bound would not be applicable.\nB. Random Codes (RC)\nBS used random codes for . Let be an ma-\ntrix over where every entry is chosen independently and uni-\nformly at random. Suppose some arbitrary ordering on . The\nencoding maps the th user to the th row of .\nTheorem 15: Let be a scheme using random\ncodes for . If , the probability of including a\ngiven innocent user in the output list is bounded as\nand the total Type II error probability is bounded as\nProof: Consider the output from inner decoding and an\ninnocent user . Let . Clearly, is\na stochastic variable with distribution , and\n. The error probability is bounded as\nand the theorem follows by Chernoff\u2019s bound.\nCorollary 16: The Type II error probability tends to zero with\nan increasing length if and\n.\nOne great advantage of random codes is that they can be\nmade for any number of users quite trivially. Observe that for\nincreasing , the bound on is unaltered, and the bound on\ndegrades gracefully.\nC. BS Concatenated Code\nThe following -secure scheme was used in [2]. Let\nbe a code with a codebook consisting of\ndistinct columns, each replicated times. A set of iden-\ntical columns will be called a type. Every column has the form\n, such that the th user has zeroes\nin the first types and a one in the rest.\n252 IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY, VOL. 1, NO. 2, JUNE 2006\nExample 17: The BS inner code for and is the\nset of the following five codewords:\nThe key maps the code onto an equivalent code by\npermuting the columns. View as the identity. We can see that\nunless user is a pirate, the pirates cannot distinguish between\nthe th and the th type. Hence, they have to use the same\nprobability of choosing a 1 in both of these types. The tracing\nalgorithm uses statistics to test the null hypothesis that user\nbe innocent. The output is some user(s) for whom the null\nhypothesis may be rejected.\nThe key size in bits is\nThe probability of accusing a given innocent user is bounded as\nTheorem 18 (BS): The BS inner code with replication factor\nis strongly secure whenever .\nLet BS\u2013RC be the scheme with as described\nabove and a random code with list decoding for . There are\nseveral control parameters which may be used to tune the per-\nformance of the system. The inner code cardinality is the trick-\niest one. Most of the time, we will follow BS and set .\nObviously, and control a tradeoff between the code length\nand error rate, and controls the tradeoff between the two error\ntypes.\nTheorem 19: If we use\nthen BS\u2013RC is a strongly -secure FP scheme,\nwhere\n(3)\n(4)\nAsymptotically, the length is\n(5)\nIn order to use Theorem 13, we require so that\nthe first argument to is positive. In this theorem, is only\nslightly greater than this minimum. In order to use Corollary\n14, we require , but to make linear in ,\nTABLE I\nSOME LENGTHS WHEN t = logM\nmust, in fact, be much smaller than . The choice of\ngives .\nProof: We have . We get (3) by expanding\nthe parameters and in the definition. Equation (4) follows\nfrom the two bounds on from Theorems 13 and 15. Using\nthe fact that , we get\nEquation (5) follows easily by combining this with (3).\nSample rates are presented in Table I, both for our analysis\nand for that of BS. Considering asymptotic classes of codes,\ncan be made smaller. The following theorem gives the better\nrates.\nTheorem 20: There exists an asymptotic class of BS\u2013RC FP\nschemes with exponentially declining error probability for any\nrate satisfying\n(6)\nif and are natural numbers such that\n.\nProof: Asymptotically, can be taken arbitrarily close to\n, and by Theorem 18, we get that\nBy Theorem 15, the outer rate can be chosen arbitrarily close\nto . We get the following component code\nrates:\nwhich gives the total rate as stated in the theorem.\nIn Table II, we can see some asymptotic rates for our codes,\nas well as those of [6] Barg Blakley, and Kabatiansky (BBK).\nWe note that BBK has the better rate for few pirates, whereas\nours is better against seven pirates. It is also interesting to note\nthat is not the maximizing value of asymptotically, except\nfor .\nD. Outer Code With Large Distance\nWe recall that codes with sufficiently large distance give com-\nbinatorially secure codes. The BBK scheme introduced outer\nSCHAATHUN: THE BONEH\u2013SHAW FINGERPRINTING SCHEME IS BETTER THAN WE THOUGHT 253\nTABLE II\nASYMPTOTIC RATES AND MAXIMIZING VALUES OF q AND r FOR THE\nBS\u2013RC VODES FOR SOME NUMBERS OF PIRATES\ncodes where the minimum distance is large enough not only to\nsuccessfully trace, but also to correct for some decoding errors\nfrom the inner decoding. We shall see how this can be com-\nbined with strongly -secure inner codes following the lines\nof BS-RC.\nLet be a strongly -secure scheme as before. Let\nbe an upper bound on the probability of accusing a given inno-\ncent user . Even though this is a parameter traditionally not ex-\nplicitly stated for constructed FP schemes, it is often known by\na bound at least as good as that for , which is often bounded\nas .\nWe do not require randomization for the outer scheme when\nit is based on a large minimum distance (i.e., the key space is\na Singleton set), and the ensemble contains a unique pair\n. The encoding is arbitrary and the tracing is\nlist decoding with threshold as before.\nLet be the minimum distance of , and\nbe a pirate coalition. Consider a false\nfingerprint after inner decoding and an arbitrary innocent\nuser . For each , matches in, at most,\npositions. If inner decoding were error free, would match\nin, at most, positions.\nFirst, we study the probability that an innocent user\nbe accused. Let be the set of coordinates where is different\nfrom any pirate, and let be the complement (i.e., the set\nof positions where match at least one pirate). Let be a\nstochastic variable which is one if and only if , and\nthe total number of such matches. We get that\nWe have . If we let be any subset of\nsize , we get\nwhere\nWe have that is 1 with probability at most and 0 oth-\nerwise. The probability is\nbounded as\nUsing the Chernoff bound, we get the following theorem.\nTheorem 21: The probability of accusing a given innocent\nuser in as described in this section is\nThe total probability of Type II error is\nThis error bound is rather pessimistic. We assume that the hy-\nbrid fingerprint matches the innocent user in every block where\none pirate matches the innocent.\nCombining Theorems 13 and 21, we get that\nwhich implies . Any asymptotic code requires\nby the Plotkin bound. A good can-\ndidate as an outer code with large minimum distance is the\nRS codes, which can be decoded with\nthe Guruswami\u2013Sudan (GS) algorithm [10], with polynomial\ncomplexity in .\nExample 22: An RS outer code can be combined with a BS\ninner code. Take, for instance, and . Let\nand , and use a BS as inner code. As\nan outer code, we use a generalized RS code. With a\ndecoding threshold of , we get a total error rate of\n. The total length is . These parameters\nare inferior to BS\u2013RC, but are still good enough to be interesting\nfor applications where decoding complexity is important.\nConcatenations of BS inner codes and RS outer codes will be\ndenoted as BS\u2013RS. We have from the inner\ncode, and due to the distance requirement. This gives\nus , which is inferior to BS\u2013RC. Furthermore,\nit is rather difficult to find the optimal choices for the various\nparameters.\nTo make asymptotic classes of codes, we can use the AG\ncodes guaranteed by the following result from [11].\nTheorem 23: For any , there are constructible, infi-\nnite families of codes with parameters for\nand\nObserve that these codes require , and recall\nthat . Hence, the AG codes require . The\nproblem is that large require very long codewords in the BS\ninner code. Using AG and RS codes would be much more ef-\nfective if the inner code could be improved.\nProposition 24: If there is an strongly -secure\ncode where the probability of accusing a given innocent user\nis at most , then there is an asymptotic family of strongly\n254 IEEE TRANSACTIONS ON INFORMATION FORENSICS AND SECURITY, VOL. 1, NO. 2, JUNE 2006\n-secure codes with any rate of less than ,\nwhere solves\nand where vanishes exponentially.\nProof: We see from Theorem 13 that exponentially de-\nclining is obtained if , but can be taken\narbitrarily close to this bound. From Theorem 21, we get that\nwill decline exponentially if ,\nwhere\nAgain, can be taken arbitrarily close to this bound. By The-\norem 23, we get\ngiving\nNow, can be taken arbitrarily close to the solution of the\nequation stated in the proposition.\nIV. FIGHTING TWO PIRATES\nWe mentioned that the BS replication codes may not be the\nideal choice for inner codes. For two pirates, we have good al-\nternatives, which we consider in this section.\nIt was proven in [12] that so-called separating systems (SS)\ngive -secure schemes . The FP code is\nequivalent to a (2,2)-separating base code , is arbitrary,\nand is an exhaustive search through all possible two sets\n. The [31,5,15] Simplex code is -secure,\nand the [126,14] dual BCH code is -secure.\nWe define three new concatenated schemes, all using sepa-\nrating inner codes as described above. The SS\u2013RC scheme uses\nrandom outer codes as described in Section III-B. The SS\u2013RS\nand SS\u2013AG codes use, respectively, Reed\u2013Solomon and AG\ncodes as described in Section III-D.\nA. Asymptotic Constructions\nThe best asymptotic rate offered for in [6] was 0.015,\nusing the [126,14] BCH dual as inner code and an AG outer\ncode. On the other hand, [12] offered a rate of 0.026 for an\nasymptotic class of (2,2)-SS.\nTheorem 25: The SS\u2013RC scheme with the [126,14] punc-\ntured dual of the two-error-correcting BCH code as an inner\ncode, forms an infinite class of strongly -secure schemes\nwith rate , for any and exponentially declining\nerror probability given as\nfor any such that .\nThe algebraic structure of SS\u2013AG makes it possible to take\nadvantage of the fact that the inner codes have and make\nconcatenated schemes which also have .\nFor any innocent user and a hybrid fingerprint , we have\n. Hence, will never be accused if\n. Asymptotically, can be taken arbitrarily close to\n. The bound on is found from Theorem 13\nIt is necessary that , which gives us\nBy Theorem 23, we obtain outer code rate arbitrarily close to\nThe [126,14] inner code, gives and an overall rate\nof 0.0269. This is not as good as using random codes, but it is\nbetter than the BBK scheme [6], and like BBK, it can be GS\ndecoded. An alternative inner code is the [15,4,8] code. This is\ntoo small to use AG codes (cf. Thm. 23), but it works well with\nrandom codes.\nTheorem 26: The SS\u2013RC scheme with a [15,4,8] inner code\nforms an infinite class of strongly -secure codes with rate\n, for any , and exponentially declining error prob-\nabilities given as\nand\nfor any such that .\nCorollary 27: The SS\u2013RC codes with [15,4,8] inner codes\nare strongly secure with length\nfor any such that .\nB. Practical Codes\nIn Table III, we present code lengths for 1000 to a billion\nusers with the schemes we know, including those of [13] and\n[14]. The RS\u2013RC codes are computed with , .\nThe error probabilities were set such that and both are less\nthan . We used for users,\nfor users, for users, for\nusers, and for users.\nSCHAATHUN: THE BONEH\u2013SHAW FINGERPRINTING SCHEME IS BETTER THAN WE THOUGHT 255\nTABLE III\nCODE LENGTHS AGAINST TWO PIRATES FOR 1000 TO A BILLION\nUSERS AND ERROR PROBABILITY \" \u0014 10\nTABLE IV\nSOME SS\u2013RS CODES\nThe constructions of SS\u2013RS are shown in Table IV and the\ngeneral result is given in the theorem below. Also, the [126,14]\nand [254,24] BCH duals are secure.\nTheorem 28: Let be a concatenated code of an\n-secure inner code and a RS code .\nIf we use GS decoding for , then is 2-secure with\nand\nwhere (7)\nProof: We have where\n, from the proof of Theorem 13. Using the facts\nthat and , we get the theorem.\nThere is a variant from [15] using Simplex inner codes,\nReed\u2013Solomon outer codes, and a more complicated inner\ndecoding algorithm.\nV. OTHER KNOWN SCHEMES AND CONCLUSION\nWe have studied concatenated collusion-secure codes. As\ninner codes, we suggest separating codes in the two pirate case,\nand the BS inner code in the general case. As outer codes, we\npropose random codes, Reed\u2013Solomon codes, or asymptotic\nAG codes. One of the schemes, BS\u2013RC, is the classic of [2], but\nour analysis shows length can be less than previously assumed.\nSamples with an error rate of show a reduction by a\nfactor of about 2.1.\nWe know of one other strongly -secure scheme for our\nmodel, namely the BBK scheme of [6]. The BBK scheme is very\ngood against a few pirates. Against sufficiently many pirates\nthe BS-based schemes are better. Asymptotically, BS-RC has\nthe best rate for seven pirates and more. Against two pirates,\nour construction of SS\u2013RS appears to give the best codes for a\nthousand to a billion users, whereas SS\u2013RC has the best known\nasymptotic rate.\nThere are many other FP schemes in the literature, but most\nof them use different marking assumptions and, thus, fall out-\nside the scope of this paper. There are two schemes which are\nweakly -secure under the BS marking assumption, due to\nTardos [13] and LBH [14]. Tardos has a code length of\n, giving it the best known rate for many parame-\nters. LBH is very good against three pirates, but .\nThe best asymptotic decoding complexity is polynomial in\n, obtained by the GS algorithm for AG outer codes, in-\ncluding the BBK scheme. Using random codes (i.e., for BS\u2013RC\nand SS\u2013RC as well as Tardos), a linear search through the code\nis needed for decoding. Decoding of BBK, however, is exponen-\ntial in , and this problem is avoided by BS\u2013RS. Thus, against\nmany pirates, BS\u2013RS has the most efficient decoding algorithm\nknown, even for weak security.\nAn interesting open problem is lower bounds on the code\nlength in terms of and . The few known bounds are inde-\npendent of . Another open issue is optimizing the construc-\ntion parameters of our schemes.\nACKNOWLEDGMENT\nThe author would like to thank some of the anonymous ref-\nerees for useful comments and many anonymous colleagues for\nencouragement and discussions.\nREFERENCES\n[1] N. R. Wagner, \u201cFingerprinting,\u201d in Proc. Symp. Security Privacy, 1983,\npp. 18\u201322.\n[2] D. Boneh and J. Shaw, \u201cCollusion-secure fingerprinting for digital\ndata,\u201d IEEE Trans. Inf. Theory, vol. 44, no. 5, pp. 1897\u20131905, Sep.\n1998.\n[3] B. Chor, A. Fiat, M. Naor, and B. Pinkas, \u201cTracing traitors,\u201d IEEE\nTrans. Inf. Theory, vol. 46, no. 3, pp. 893\u2013910, May 2000.\n[4] A. Somekh-Baruch and N. Merhav, \u201cOn the capacity game of pri-\nvate fingerprinting systems under collusion attacks,\u201d IEEE Trans. Inf.\nTheory, vol. 51, no. 3, pp. 884\u2013899, Mar. 2005.\n[5] T. Hagerup and C. R\u00fcb, \u201cA guided tour of Chernoff bounds,\u201d Inf.\nProcess. Lett., vol. 33, pp. 305\u2013308, 1990.\n[6] A. Barg, G. R. Blakley, and G. A. Kabatiansky, \u201cDigital fingerprinting\ncodes: Problem statements, constructions, identification of traitors,\u201d\nIEEE Trans. Inf. Theory, vol. 49, no. 4, pp. 852\u2013865, Apr. 2003.\n[7] K. Yoshioka, J. Shikata, and T. Matsumoto, \u201cCollusion secure codes:\nSystematic security definitions and their relations,\u201d IEICE Trans. Fun-\ndamentals, vol. E87-A, no. 5, May 2004.\n[8] H. Muratani, \u201cOptimization and evaluation of randomized c-secure\nCRT code defined on polynomial ring,\u201d in Information Hiding 2004,\nJ. Fridrich, Ed., 2004, vol. 3200, Lecture Notes Comput. Sci., pp.\n282\u2013292.\n[9] H.-J. Guth and B. Pfitzmann, \u201cError- and collusion-secure finger-\nprinting for digital data,\u201d in Proc. Information Hiding, New York, 2000,\nvol. 1768, Lecture Notes Comput. Sci., pp. 134\u2013145, Springer-Verlag.\n[10] V. Guruswami and M. Sudan, \u201cImproved decoding of Reed-Solomon\nand algebraic-geometry codes,\u201d IEEE Trans. Inform. Theory, vol. 45,\nno. 6, pp. 1757\u20131767, Sep. 1999.\n[11] M. A. Tsfasman, \u201cAlgebraic-geometric codes and asymptotic prob-\nlems,\u201d Discrete Appl. Math., vol. 33, no. 1\u20133, pp. 241\u2013256, 1991.\n[12] H. G. Schaathun, \u201cFighting two pirates,\u201d in Applied Algebra, Alge-\nbraic Algorithms and Error-Correcting Codes. New York: Springer-\nVerlag, May 2003, vol. 2643, Lecture Notes Comput. Sci., pp. 71\u201378.\n[13] G. Tardos, \u201cOptimal probabilistic fingerprint codes,\u201d J. ACM, 2005, To\nappear. In part at STOC\u201903.\n[14] T. Van Le, M. Burmester, and J. Hu, \u201cShort c-secure fingerprinting\ncodes,\u201d in Proc. 6th Information Security Conf., Bristol, U.K., Oct.\n2003.\n[15] M. Fernandez and M. Soriano, Protecting intellectual property by\nguessing secrets. Prague, Czech Republic, 2003, EC-Web, Sep. 2\u20135,\n2003.\nHans Georg Schaathun (M\u201900) was born in Bergen, Norway, in 1975.\nHe was a Lecturer in coding and cryptography with the University of Bergen,\nBergen, Norway, in 2002 and Postdoctoral from 2003 to 2006. He began as a\nPermanent Lecturer with the Department of Computing, School of Electronics\nand Physical Sciences (SEPS), University of Surrey, Surrey, U.K. in 2006.\nHis research interests are multimedia security, algebraic coding theory, and\ncryptography.\n"}