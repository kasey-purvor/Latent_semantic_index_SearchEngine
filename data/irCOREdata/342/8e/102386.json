{"doi":"10.1109\/LSP.2007.911162","coreId":"102386","oai":"oai:epubs.surrey.ac.uk:1845","identifiers":["oai:epubs.surrey.ac.uk:1845","10.1109\/LSP.2007.911162"],"title":"On the accuracy of first-order numerical derivatives in multidimensional digital waveguide mesh topologies","authors":["Hacihabiboglu, H","Gunel, B","Kondoz, AM"],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2008-01-01","abstract":null,"downloadUrl":"","fullTextIdentifier":null,"pdfHashValue":null,"publisher":"IEEE-INST ELECTRICAL ELECTRONICS ENGINEERS INC","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:epubs.surrey.ac.uk:1845<\/identifier><datestamp>\n      2017-10-31T14:03:21Z<\/datestamp><setSpec>\n      74797065733D61727469636C65<\/setSpec><setSpec>\n      6469766973696F6E733D656E67616E64706879736963616C736369656E636573:656C656374726F6E6963656E67696E656572696E67:63637372<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/epubs.surrey.ac.uk\/1845\/<\/dc:relation><dc:title>\n        On the accuracy of first-order numerical derivatives in multidimensional digital waveguide mesh topologies<\/dc:title><dc:creator>\n        Hacihabiboglu, H<\/dc:creator><dc:creator>\n        Gunel, B<\/dc:creator><dc:creator>\n        Kondoz, AM<\/dc:creator><dc:publisher>\n        IEEE-INST ELECTRICAL ELECTRONICS ENGINEERS INC<\/dc:publisher><dc:date>\n        2008-01-01<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/epubs.surrey.ac.uk\/1845\/1\/fulltext.pdf<\/dc:identifier><dc:identifier>\n          Hacihabiboglu, H, Gunel, B and Kondoz, AM  (2008) On the accuracy of first-order numerical derivatives in multidimensional digital waveguide mesh topologies   IEEE SIGNAL PROCESSING LETTERS, 15.  pp. 9-12.      <\/dc:identifier><dc:relation>\n        10.1109\/LSP.2007.911162<\/dc:relation><dc:language>\n        English<\/dc:language><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/epubs.surrey.ac.uk\/1845\/","10.1109\/LSP.2007.911162"],"year":2008,"topics":[],"subject":["Article","PeerReviewed"],"fullText":"IEEE SIGNAL PROCESSING LETTERS, VOL. 15, 2008 9\nOn the Accuracy of First-Order Numerical\nDerivatives in Multidimensional Digital\nWaveguide Mesh Topologies\nH\u00fcseyin Hac\u0131habibog\u02d8lu, Member, IEEE, Banu G\u00fcnel, Member, IEEE, and Ahmet M. Kondoz, Member, IEEE\nAbstract\u2014Digital waveguide mesh (DWM) models are numer-\nical solvers for the wave equation in -dimensions. They are used\nfor obtaining the traveling-wave solution in practical acoustical\nmodeling applications. Although unstructured meshes can be used\nwith DWMs, regular mesh topologies are traditionally used due to\ntheir implementation simplicity. This letter discusses the accuracy\nof first-order approximations to numerical derivatives on more\ngeneral unstructured mesh topologies. The results are applied to\nstructured, regular mesh topologies as used in DWM modeling. A\ncomparison of 2-D and 3-D DWM topologies with respect to the\naccuracy of first-order approximations to numerical derivatives is\npresented.\nIndex Terms\u2014Acoustic signal processing, acoustical modeling,\ndigital waveguides, finite difference methods, multidimensional\nsampling, numerical derivatives.\nI. INTRODUCTION\nAS A NUMERICAL solver for the wave equation, thedigital waveguide mesh (DWM) approach is used in a\nvariety of audio synthesis and acoustical modeling contexts\nincluding the vocal tract [1], musical instruments [2], [3],\nand room acoustics [4], [5]. DWM approach is equivalent\nto transmission line modeling (TLM) and finite-difference\ntime-domain (FDTD) methods [6]. Although it is sufficient to\nuse a 1-D DWM for simpler modeling problems such as string\ninstruments and the vocal tract, multidimensional DWMs are\nused in other modeling problems such as the modeling of a\ndrum membrane or the acoustics of a room due to their inherent\nmultidimensionality.\nIt is possible to obtain the pressure, , and velocity, , com-\nponents of a modeled acoustical field on discrete junctions on\na DWM. While these components are sufficient to define the\nacoustical field at a given position in space, other acoustical pa-\nrameters may also be calculated from DWMs with reference to\nthe linear acoustic equations and the acoustic-energy corollary.\nManuscript received August 17, 2007; revised September 25, 2007. The work\npresented was developed within VISNET II, a European Network of Excellence,\nfunded under the European Commission IST FP6 programme. The associate ed-\nitor coordinating the review of this manuscript and approving it for publication\nwas Prof. Vesa V\u00e4lim\u00e4ki.\nThe authors are with Multimedia and DSP Research Group (I-Lab),\nCentre for Communication Systems Research (CCSR), University of Surrey,\nGuildford GU2 7XH, U.K. (e-mail: h.hacihabiboglu@surrey.ac.uk; b.gunel@\nsurrey.ac.uk; a.kondoz@surrey.ac.uk).\nDigital Object Identifier 10.1109\/LSP.2007.911162\nIn particular, the following parameters may be derived among\nothers:\nRate of change of fluid density\nRate of change of velocity\nVorticity\nRate of change of energy density\nwhere is the fluid density after excitation, is the ambient\nfluid density, is the vorticity, and is the acoustic energy\ndensity [7].\nThe calculation of all of these acoustical quantities requires\nthe use of the vector operators, gradient , divergence ,\nand curl , which in turn require partial derivatives of\nthe respective acoustical field component. While the direc-\ntional derivatives are easy to obtain using a second-order\n(i.e., three-point) finite difference approximation on rectilinear\nand cubic mesh topologies due to the intuitive positioning of\ntheir junctions, other mesh topologies lack efficient means of\ncalculation for second-order approximations.\nThis letter presents a comparison of different DWM topolo-\ngies with respect to the accuracy of first-order approximations\nto directional derivatives and is organized as follows: Section II\npresents a method for calculating the directional derivatives on a\ngeneral unstructured -dimensional mesh. The approximation\nerrors are also discussed. Section III presents the application of\nthe results and a comparison of different mesh topologies with\nrespect to the accuracy of numerical derivatives. Section IV con-\ncludes this letter.\nII. NUMERICAL DERIVATIVES ON AN\nUNSTRUCTURED MESH GRID\nAlthough the use of unstructured mesh topologies with fi-\nnite difference methods is not a new concept [8], they are tra-\nditionally not used with DWM models due to the difficulties in\nusing fractional delays for each bidirectional delay element in\nthe mesh. However, the calculation of the numerical derivatives\nis given for unstructured meshes in this section without loss of\ngenerality.\nA. First-Order Finite Difference Approximation\nLet us have a sample point with neighboring\nsample points on an -dimensional\n1070-9908\/$25.00 \u00a9 2007 IEEE\nAuthorized licensed use limited to: University of Surrey. Downloaded on April 13,2010 at 14:48:28 UTC from IEEE Xplore.  Restrictions apply. \n10 IEEE SIGNAL PROCESSING LETTERS, VOL. 15, 2008\nFig. 1. Node andM neighboring points in an arbitraryN -dimensional unstruc-\ntured grid. u^ denotes the unit vector in the direction of the ith neighbor.\nunstructured mesh grid. Let us also define the -dimensional\ndisplacement vectors, , such that\n(1)\nwhere for is the unit\nvector in the direction of the neighboring sample point in -di-\nmensional hyperspherical coordinates, and denotes the Eu-\nclidean norm of the vector. The unit vector in hyperspherical\ncoordinates can be represented in the Euclidean space as\n.\n.\n.\n(2)\nwhere represents the angular coordinates of the hyper-\nspherical coordinate system. Fig. 1 shows the unstructured mesh\ngrid topology.\nFor an -dimensional, real, differentiable function\nsampled on the described grid, a two-point first-order approx-\nimation to the directive derivatives can be formed for each\nneighboring point, , of the central point, , such that\n(3)\nThis approximates the gradient of the function, , in the\ndirection of . Therefore, the first-order finite difference ap-\nproximation is a predictor of the following projection of the gra-\ndient in that direction:\n(4)\nIt is then possible to express the ensemble of these approxima-\ntions as a set of linear equations such that\n(5)\nwhere\n(6)\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n(7)\n(8)\nand represent the Cartesian coordinates.\nFor , the linear system of equations is underdeter-\nmined and a unique solution does not exist, while for ,\na unique solution exists if the matrix is not singular (i.e., the\nequations are linearly independent). For , which is also\nthe case for regular mesh grids in two and three dimensions [9],\nthe solution for can be obtained in the optimal sense as\n(9)\nwhere is the Moore\u2013Penrose pseudoinverse of the matrix\nwhich is unique for each different positioning of sample points.\nB. Approximation Errors\nThe approximation error, , for the directional derivative,\n, is defined as\n(10)\nA frequency-domain expression for the error can be obtained by\nthe -dimensional spatial Fourier transform such that\n(11)\n(12)\nwhere is the spatial frequency vector\nwith . It is then possible to express the approxi-\nmation error in the spatial frequency domain as\n(13)\n(14)\nWhen the spatial frequency vector is orthogonal to the displace-\nment vector (i.e., ) or when , the corre-\nsponding error is zero.\nThe projection of the approximation errors to Cartesian coor-\ndinates can be obtained as in (9) such as\n(15)\nFrom (14), it is possible to rewrite (15) such that\n(16)\nAuthorized licensed use limited to: University of Surrey. Downloaded on April 13,2010 at 14:48:28 UTC from IEEE Xplore.  Restrictions apply. \nHACIHABIBO \u02d8GLU et al.: ACCURACY OF FIRST-ORDER NUMERICAL DERIVATIVES 11\nFig. 2. Approximation error, \u0014(!), with \u0000\u0019=2 \u0014 ! ; ! \u0014 \u0019=2 for (a) 2-D rectilinear, (b) triangular, and (c) hexagonal regular grids.\nTABLE I\nMAXIMUM AND AVERAGE APPROXIMATION ERRORS IN dB\nwhere . Note that\nis determined solely by the local topology of the mesh and\nis independent of spatial frequency while is dependent both\non the local topology and on the spatial frequency.\nThe approximation error is vectorial and its square magnitude\ncan be obtained as\n(17)\nwhere represents the Hermitian (conjugate) transpose of\nthe approximation error vector. This can be expressed as\n(18)\nIt is then possible to characterize the accuracy of the mesh grid\nby defining an error function, , which is the ratio of the\nmagnitude of the approximation error to the magnitude of the\ngradient of the sampled function at that spatial frequency such\nthat\n(19)\nAn average value for the approximation error function, ,\ncan be obtained by averaging for all node positions in the\nmesh. In a structured, regular mesh, each sample point has the\nsame approximation error, and thus, . Also, a fre-\nquency-independent error index, , can be obtained by aver-\naging the approximation error across all frequencies within the\nfrequency bandwidth limits of the mesh grid.\nIII. COMPARISON OF DWM TOPOLOGIES\nAlthough it is possible to use unstructured meshes with DWM\nmodels [6], regular meshes for which the distance between the\nsample points is constant are preferred as they allow simpler\nmodels with the use of unit delay elements in between junctions.\nThere is only a limited number of regular mesh topologies in two\nand three dimensions.\nA. The 2-D DWM Topologies\nThree regular 2-D grid topologies exist: rectilinear, triangular,\nand hexagonal. For the triangular mesh, , for the recti-\nlinear mesh, , and for the hexagonal mesh, . In all\ncases, , where for the 2-D setting. The reader is\nreferred to [10] for more details of these topologies.\nFig. 2 shows the contour plot of values in logarithmic\nscale for the three mesh topologies. The interjunction distance\nfor each topology is selected to be equal to a unit distance,\ni.e., to allow a comparison between topolo-\ngies. If another comparison for equal mesh density (i.e., same\nnumber of elements per unit area) is considered, the interjunc-\ntion distance for the triangular mesh will be higher than recti-\nlinear mesh, which in turn will be higher than the hexagonal\nmesh. The mesh densities for the three topologies are given as\n, , and , for\nrectilinear, triangular, and hexagonal meshes, respectively [10].\nThe maximum and averaged error values across all spatial\nfrequencies for different mesh topologies for the same inter-\njunction distance, , and the same mesh density\nare summarized in Table I. When the same\ninterjunction distance is used, the lowest approximation errors\nare obtained for the triangular mesh. When the mesh densities\nare equal, the lowest average approximation error is obtained\nAuthorized licensed use limited to: University of Surrey. Downloaded on April 13,2010 at 14:48:28 UTC from IEEE Xplore.  Restrictions apply. \n12 IEEE SIGNAL PROCESSING LETTERS, VOL. 15, 2008\nFig. 3. Approximation error, \u0014(!), with \u0000\u0019=2 \u0014 ! ; ! ; ! \u0014 \u0019=2 for (a)\ncubic, (b) tetrahedral, (c) CCP, and (d) BCC regular grids. The shading is the\nsame for all figures, where black represents \u00009 dB, and white represents \u00003\ndB.\nwith the rectilinear mesh, and the lowest maximum approxima-\ntion error is obtained with the triangular mesh. The rectangular\nmesh has lower approximation errors in the diagonal directions,\ni.e., . The triangular mesh has a fairly isotropic\nerror distribution. The hexagonal mesh has lower approximation\nerrors in directions.\nB. The 3-D DWM Topologies\nThere exist four regular 3-D mesh topologies: cubic, tetrahe-\ndral, body-centric cubic (BCC), and cubic close-packed (CCP).\nFor the cubic mesh, , for the tetrahedral mesh, ,\nfor the BCC mesh, , and for the CCP mesh, . As\nwith the 2-D case, for all topologies with . The\nreader is referred to [9] for the details of these topologies.\nFig. 3 shows the visualization of values in logarithmic\nscale for the four 3-D mesh topologies at . The inter-\njunction distance for each topology is selected to be equal\nto a unit distance, i.e., , to allow a comparison\nbetween topologies. Another comparison is also made for the\nsame mesh density in all topologies. Mesh densities for the 3-D\ntopologies are given as , ,\n, and , for cubic, tetrahe-\ndral, CCP, and BCC topologies, respectively [9].\nThe maximum and averaged approximation error values\nacross all spatial frequencies for different mesh topolo-\ngies for the same interjunction distance and same mesh\ndensity (i.e., same number of elements per unit volume)\nare summarized in\nTable I. It may be observed that the lowest errors are obtained\nfor the CCP topology when the same interjunction spacing\nis used. On the other hand, while the mesh densities are the\nsame, the average error is the lowest for the cubic mesh and the\nmaximum error is lowest for the CCP mesh.\nIV. CONCLUSIONS\nA comparison of different multidimensional digital wave-\nguide mesh topologies with respect to the accuracy of numerical\nderivatives was presented in this letter. The derivation of the\nnumerical derivatives in a general -dimensional mesh was\ngiven. A measure for quantifying the approximation error in\nthe spatial frequency domain was proposed. The results were\napplied to regular DWM grid topologies in 2-D and 3-D. In\n2-D, the rectilinear, triangular, and hexagonal mesh topologies\nwere compared. In 3-D, cubic, tetrahedral, CCP, and BCC,\nmesh topologies were compared. The results suggest that for\nthe same internodal distance, the triangular mesh in 2-D and\nthe CCP mesh in 3-D have lower approximation errors. For the\nsame mesh density, rectilinear mesh in 2-D and cubic mesh in\n3-D have the lowest average errors. However, the triangular\nmesh in 2-D and CCP mesh in 3-D have the lowest maximum\napproximation error. Although the comparison was given for\nthe regular mesh structures only, the results are general and are\nreadily applicable to unstructured mesh topologies.\nACKNOWLEDGMENT\nThe authors would like to thank Prof. V. V\u00e4lim\u00e4ki and\nthree anonymous reviewers for their feedback and constructive\ncomments.\nREFERENCES\n[1] J. Mullen, D. M. Howard, and D. T. Murphy, \u201cReal-time dynamic ar-\nticulations in the 2-D waveguide mesh vocal tract model,\u201d IEEE Trans.\nAudio, Speech, Lang. Process., vol. 15, no. 2, pp. 577\u2013585, Feb. 2007.\n[2] C. Erkut, \u201cAspects in analysis and model-based sound synthesis\nof plucked string instruments,\u201d Ph.D. dissertation, Helsinki Univ.\nTechnol., Helsinki, Finland, Nov. 2002.\n[3] F. Fontana and D. Rocchesso, \u201cPhysical modeling of membranes for\npercussion instruments,\u201d Acta Acustica united with Acustica, vol. 83,\nno. 3, pp. 529\u2013542, May-Jun. 1998.\n[4] L. Savioja and V. V\u00e4lim\u00e4ki, \u201cInterpolated rectangular 3-D digital\nwaveguide mesh algorithms with frequency warping,\u201d IEEE Trans.\nSpeech Audio Process., vol. 11, no. 6, pp. 783\u2013790, Nov. 2003.\n[5] H. Hac\u0131habibog\u02d8lu, B. G\u00fcnel, and A. M. Kondoz, \u201cSource directivity\nsimulation in digital waveguide mesh-based room acoustics models,\u201d in\nProc. AES 30th Int. Conf. Intelligent Audio Environments, Mar. 15\u201317,\n2007, on CD-ROM.\n[6] S. Bilbao, Wave and Scattering Methods for Numerical Simulation.\nChichester, U.K.: Wiley, 2004.\n[7] A. D. Pierce, Acoustics: An Introduction to Its Physical Principles and\nApplications. Woodbury, NY: Acoust. Soc. Amer., 1994.\n[8] R. H. MacNeal, \u201cAn asymmetrical finite difference network,\u201d Quart.\nAppl. Math., vol. 11, no. 3, pp. 295\u2013310, 1953.\n[9] G. R. Campos and D. M. Howard, \u201cOn the computational efficiency of\ndifferent waveguide mesh topologies for room acoustics simulation,\u201d\nIEEE Trans. Speech Audio Process., vol. 13, no. 5, pp. 1063\u20131072, Sep.\n2005.\n[10] F. Fontana and D. Rocchesso, \u201cSignal-theoretic characterization of\nwaveguide mesh geometries for models of two-dimensional wave\npropagation in elastic media,\u201d IEEE Trans. Speech Audio Process.,\nvol. 9, no. 2, pp. 152\u2013161, Feb. 2001.\nAuthorized licensed use limited to: University of Surrey. Downloaded on April 13,2010 at 14:48:28 UTC from IEEE Xplore.  Restrictions apply. \n"}