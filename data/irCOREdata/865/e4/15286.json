{"doi":"10.1137\/040619557","coreId":"15286","oai":"oai:dro.dur.ac.uk.OAI2:7910","identifiers":["oai:dro.dur.ac.uk.OAI2:7910","10.1137\/040619557"],"title":"String gradient weighted moving finite elements in multiple dimensions with applications in two dimensions.","authors":["Wacher,  Abigail","Sobey,  Ian"],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2007-01-01","abstract":"We formulate the string gradient weighted moving finite element method (SGWMFE) for systems of PDEs in multiple dimensions. Then we illustrate implementation issues for the method using two dimensions. The method is applied successfully to solve the highly nonlinear unsteady porous medium equation in two dimensions and the results are compared to exact solutions. We proceed to present results for the method when applied to the Gray Scott chemical reaction diffusion model in two dimensions. Finally, we apply the method to the shallow water equations in two dimensions and compare the meshes produced with those produced using gradient weighted finite element methods (GWMFE). Our conclusion is that SGWMFE is an easily applied member of the group of moving finite element methods","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/15286.pdf","fullTextIdentifier":"http:\/\/dro.dur.ac.uk\/7910\/1\/7910.pdf","pdfHashValue":"2f6a5bd8ed301436136eb18f19df05e4af4eb899","publisher":"Society for Industrial and Applied Mathematics","rawRecordXml":"<record><header><identifier>\n  \n    \n      oai:dro.dur.ac.uk.OAI2:7910<\/identifier><datestamp>\n      2011-01-28T12:21:27Z<\/datestamp><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        String gradient weighted moving finite elements in multiple dimensions with applications in two dimensions.<\/dc:title><dc:creator>\n        Wacher,  Abigail<\/dc:creator><dc:creator>\n        Sobey,  Ian<\/dc:creator><dc:description>\n        We formulate the string gradient weighted moving finite element method (SGWMFE) for systems of PDEs in multiple dimensions. Then we illustrate implementation issues for the method using two dimensions. The method is applied successfully to solve the highly nonlinear unsteady porous medium equation in two dimensions and the results are compared to exact solutions. We proceed to present results for the method when applied to the Gray Scott chemical reaction diffusion model in two dimensions. Finally, we apply the method to the shallow water equations in two dimensions and compare the meshes produced with those produced using gradient weighted finite element methods (GWMFE). Our conclusion is that SGWMFE is an easily applied member of the group of moving finite element methods. <\/dc:description><dc:subject>\n        Moving finite elements<\/dc:subject><dc:subject>\n         Mesh adaptation.<\/dc:subject><dc:publisher>\n        Society for Industrial and Applied Mathematics<\/dc:publisher><dc:source>\n        SIAM journal on scientific computing, 2007, Vol.29(2), pp.459-480 [Peer Reviewed Journal]<\/dc:source><dc:date>\n        2007-01-01<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:identifier>\n        dro:7910<\/dc:identifier><dc:identifier>\n        issn:1064-8275<\/dc:identifier><dc:identifier>\n        issn: 1095-7197<\/dc:identifier><dc:identifier>\n        doi:10.1137\/040619557 <\/dc:identifier><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/7910\/<\/dc:identifier><dc:identifier>\n        http:\/\/dx.doi.org\/10.1137\/040619557 <\/dc:identifier><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/7910\/1\/7910.pdf<\/dc:identifier><dc:rights>\n        \u00a9 2007 Society for Industrial and Applied Mathematics.<\/dc:rights><dc:accessRights>\n        info:en-repo\/semantics\/openAccess<\/dc:accessRights><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["issn: 1095-7197","issn:1064-8275","1064-8275"," 1095-7197"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2007,"topics":["Moving finite elements","Mesh adaptation."],"subject":["Article","PeerReviewed"],"fullText":"Durham Research Online\nDeposited in DRO:\n28 January 2011\nVersion of attached file:\nPublished Version\nPeer-review status of attached file:\nPeer-reviewed\nCitation for published item:\nWacher, Abigail and Sobey, Ian (2007) \u2019String gradient weighted moving finite elements in multiple\ndimensions with applications in two dimensions.\u2019, SIAM journal on scientific computing., 29 (2). pp. 459-480.\nFurther information on publisher\u2019s website:\nhttp:\/\/dx.doi.org\/10.1137\/040619557\nPublisher\u2019s copyright statement:\n2007 Society for Industrial and Applied Mathematics.\nAdditional information:\nUse policy\nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without prior permission or charge, for\npersonal research or study, educational, or not-for-profit purposes provided that:\n\u2022 a full bibliographic reference is made to the original source\n\u2022 a link is made to the metadata record in DRO\n\u2022 the full-text is not changed in any way\nThe full-text must not be sold in any format or medium without the formal permission of the copyright holders.\nPlease consult the full DRO policy for further details.\nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom\nTel : +44 (0)191 334 3042 \u2014 Fax : +44 (0)191 334 2971\nhttp:\/\/dro.dur.ac.uk\nSIAM J. SCI. COMPUT. c\u00a9 2007 Society for Industrial and Applied Mathematics\nVol. 29, No. 2, pp. 459\u2013480\nSTRING GRADIENT WEIGHTED MOVING FINITE ELEMENTS IN\nMULTIPLE DIMENSIONS WITH APPLICATIONS IN TWO\nDIMENSIONS\u2217\nA. WACHER\u2020 AND I. SOBEY\u2021\nAbstract. We formulate the string gradient weighted moving finite element method (SGWMFE)\nfor systems of PDEs in multiple dimensions. Then we illustrate implementation issues for the method\nusing two dimensions. The method is applied successfully to solve the highly nonlinear unsteady\nporous medium equation in two dimensions and the results are compared to exact solutions. We\nproceed to present results for the method when applied to the Gray Scott chemical reaction diffusion\nmodel in two dimensions. Finally, we apply the method to the shallow water equations in two\ndimensions and compare the meshes produced with those produced using gradient weighted finite\nelement methods (GWMFE). Our conclusion is that SGWMFE is an easily applied member of the\ngroup of moving finite element methods.\nKey words. moving finite elements, mesh adaptation\nAMS subject classifications. 74S05, 65M60, 65M50\nDOI. 10.1137\/040619557\n1. Introduction. This paper has two objectives. The first is to present the\ngeneral formulation for a string gradient weighted moving finite element method\n(SGWMFE) in multiple space dimensions. The second is to demonstrate the im-\nplementation of SGWMFE in several nonlinear systems of PDEs, the porous medium\nequation, the Gray Scott equations, and the shallow water equations. Solutions of\neach problem can be found using other methods, and we are not suggesting or at-\ntempting to demonstrate that SGWMFE is better or worse than other moving (or\nnonmoving) finite element or discretization methods; rather, it is an implementation\nof gradient weighted moving finite elements (GWMFE) with an elegant general form\nthat is straightforward to use.\nMoving finite element methods (MFE), originally introduced in [14], are well\nestablished to provide reliable solutions to unsteady systems of PDEs, often with less\ncomputational cost than fixed mesh methods. There is a wide literature dealing with\nmoving mesh methods, both for finite elements and for finite differences. The text\nof [1] gives an extensive view of MFE and [5, 11, 15, 16] describe recent applications\nof moving mesh methods. GWMFE were developed in detail in [8] and [9], and the\nstring version, suggested in [12], was implemented in [17]. For other background on\nmoving mesh methods, see [17], where there is an extended reference list on moving\nmesh methods including MFE, GWMFE, and moving finite difference type methods.\nHere our interest is however in developing details of SGWMFE for systems of PDEs\nin two or more dimensions. Using a projection matrix, a very general form of the\nmethod can be developed and details are illustrated for a system of two PDEs. There\n\u2217Received by the editors November 24, 2004; accepted for publication (in revised form) August\n30, 2006; published electronically March 15, 2007.\nhttp:\/\/www.siam.org\/journals\/sisc\/29-2\/61955.html\n\u2020Faculty of Aerospace Engineering, Technion City, Haifa 32000, Israel (abigail.wacher@comlab.\nox.ac.uk). This author was supported in part by the National Science and Engineering Research\nCouncil of Canada in the form of the NSERC graduate scholarship and by Corpus Christi College,\nOxford.\n\u2021Oxford University Computing Laboratory, Parks Road, Oxford OX1 3PQ, UK (ian.sobey@\ncomlab.ox.ac.uk).\n459\n460 A. WACHER AND I. SOBEY\nare a number of implementation issues for MFE and the details of implementation\nof SGWMFE are examined for a number of commonly occurring terms in first and\nsecond order PDEs.\nIn the remainder of this section we set out the three test problems that are consid-\nered in this paper. In the second section we develop a mathematical formulation for\nSGWMFE that is elegant and easily generalized to arbitrary systems of evolutionary\nPDEs in multiple space dimensions. The third section considers implementation issues\nfor a system two independent variables in two space dimensions, focusing the theory\nfrom section two for this case and showing details of how different terms are treated.\nThe fourth section gives solutions for the three test problems using SGWMFE.\n1.1. Porous medium equation. The first test problem we consider is the ap-\nplication to the porous medium equation in two space dimensions. While this is a\nsingle PDE rather than a system, it admits an exact similarity solution under some\ninitial conditions so that the results of applying SGWMFE can be compared to the\nexact solution.\nThe porous medium equation is well known (see [6] or [4]) but in computational\nterms represents a hard problem because under some parameter values, the solution\ndevelops a singularity in the slope of an advancing front. The porous medium equation\nin two dimensions is given by\n(1.1) ut = \u2207 \u00b7 (um\u2207u),\nand we consider the problem with u = 0 imposed at the boundary.\nThis is a problem with a known set of similarity solutions when the initial data has\ncircular symmetry. The symmetric self-similar solutions used are of the same form as\nin [2] and originally from [4]. Earlier studies on self-similar numerical solutions of the\nporous medium equation can be found in [6] and [7]. The following form represents\nthe solutions for the one- (d = 1), two- (d = 2), and three- (d = 3) dimensional\nproblems for an initial distribution centered at the origin and starting at time t0:\n(1.2) u(r, t) =\n\u23a7\u23a8\n\u23a9\n1\n\u03bbd(t)\n(1\u2212 ( r\nr0\u03bb(t)\n)2)1\/m, r \u2264 r0\u03bb(t)\n0, r > r0\u03bb(t)\n\u23ab\u23ac\n\u23ad ,\nwhere r is distance from the origin, m is an integer greater than 0, and\n(1.3) \u03bb(t) =\n(\nt\nt0\n) 1\n2+md\nwith t0 =\nr20m\n2(2 +md)\n.\nThe computations described below are for times T = t\u2212 t0 > 0. The computational\ndifficulty with this problem is that the slope of the solution at the moving front,\nr = r0\u03bb(t), is singular when m > 1.\n1.2. Gray Scott equations. The Gray Scott equations are a model for chemical\nspecies undergoing reaction and diffusion. Reaction and diffusion of chemical species\ncan lead to a variety of patterns which have beautiful and interesting solutions. For\na description of the physics of the model studied here, see [10]. The reader is also\nreferred to [20] for a comparison of results for the following problem using a different\nclass of moving mesh method.\nThe chemical reaction we consider is that given by\nU + 2V \u2192 3V,\nV \u2192 P,\nSGWMFE 461\nwhere U , V , and P are chemical species. The PDEs that model this process are\n(1.4)\nut = ru\u22072u\u2212 uv2 + f(1\u2212 u),\nvt = rv\u22072v + uv2 \u2212 (f + k)v,\nwhere u and v represent their concentrations, ru and rv are their diffusion rates, k\nrepresents the rate of conversion of V to P , and f represents the rate of the process\nthat feeds U and drains U , V , and P .\nThe initial conditions considered are block functions for each of the chemical\nconcentrations over the domain [0, 1]\u00d7 [0, 1]:\n(1.5) u(x, y, t) =\n{\n0.5, 0.3 \u2264 (x, y) \u2264 0.7\n1 elsewhere\n}\n,\n(1.6) v(x, y, t) =\n{\n0.25, 0.3 \u2264 (x, y) \u2264 0.7\n0 elsewhere\n}\n.\nThe coefficients chosen for this problem are ru = 8(10\n\u22125), rv = 4(10\u22125), f =\n0.024, and k = 0.06 with Dirichlet boundary conditions prescribed on all four bound-\naries of the domain.\n1.3. Shallow water equations. The nonlinear shallow water equations provide\na further model problem to test SGWMFE. It is also possible to compare the results\nwith those obtained from the GWMFE code used in [8]. In our shallow water problem,\na \u201chump\u201d of stationary water is released at time zero in the center of a square box.\nAs the hump subsides under gravity, a wave propagates away from the center, collides\nwith the reflective boundaries, and propagates back to the center of the box. As they\ntravel, a wave front steepens, forming a shock in the absence of viscosity. In this\nproblem a simulation should capture the shape of the wave front, the wave height,\nand the front speed.\nThe nonlinear shallow water equations studied here are, in nondimensional terms,\ngiven by\n(1.7)\nut = \u2212\u2207 \u00b7 f + \u0003\u22072u,\nvt = \u2212\u2207 \u00b7 g + \u0003\u22072v,\nwt = \u2212\u2207 \u00b7 h+ \u0003\u22072w.\nThe physical domain is given by 0 \u2264 x \u2264 5, 0 \u2264 y \u2264 5, time t \u2265 0, u is the height of\nthe fluid from the flat bottom, v is the fluid momentum in the x direction, and w is\nthe fluid momentum in the y direction.\nThe vector functions in (1.7) are\n(1.8) f = (v, w), g =\n(\nv2\nu\n+\nu2\n2\n,\nvw\nu\n)\n, h =\n(\nvw\nu\n,\nw2\nu\n+\nu2\n2\n)\n.\nThe initial conditions assigned are\nu = 0.2 + e\u2212((x\u22122.5)\n2+(y\u22122.5)2),(1.9)\nv = 0,(1.10)\nw = 0.(1.11)\nOn the south and north of the domain, the boundary conditions are that uy = 0,\nvy = 0, and w = 0. On the east and west of the domain, the boundary conditions are\nthat ux = 0, wx = 0, and v = 0.\n462 A. WACHER AND I. SOBEY\n2. Formulation of SGWMFE in multiple dimensions. We consider a sys-\ntem of n PDEs in k dimensions with independent variables x = (x1, . . . , xk) and\ndependent variables u = (u1, . . . , un) satisfying\n(2.1)\n\u2202ul\n\u2202t\n= Ll(u1, . . . , un), l = 1, . . . n,\nwhere the differential operators Ll are first or second order nonlinear differential\noperators in space.\nThe solution u can be considered as an n-dimensional manifold in (n + k)-\ndimensional space; that is,\n(2.2) s = (x1, . . . , xk, u1, . . . , un)\nT.\nConsider a parameterization of the manifold \u03be = (\u03be1, . . . , \u03bek) so that the solution\nmanifold is described by\n(2.3) s(\u03be, t) = (xm(\u03be, t),m = 1 . . . k, ul(xj(\u03be, t), j = 1 . . . k, t), l = 1 . . . n)\nT.\nThe velocity of the manifold, s\u02d9, is not computed directly; rather, the normal compo-\nnent of the velocity, s\u02d9n (not to be confused with the rate of change of the normal to\nthe manifold, so that s\u02d9n \u2261 [s\u02d9]n), is calculated, and normal movement of the manifold\nis deduced from that velocity. Tangential movement of the manifold is not considered\nsince the location of the nodes is not affected.\nIn order to compute the normal velocity it is necessary to be able to evaluate the\nnormal component of vectors on the manifold. This can be done by defining k tangent\nvectors to the manifold Xm = (0 . . . 1 . . . 0,\n\u2202ul\n\u2202xm\n, l = 1 . . . n)T, m = 1, . . . , k, where the\nunit value occurs in the mth row. These tangent vectors are always nonparallel and\nnonzero. Define matrices\nX = [X1, . . . ,Xk], V = (X\nT\nl Xm) = X\nTX,\nand the properties of the component vectors (nonzero and nonparallel) will guarantee\nthat V \u22121 will exist. Define D by\n(2.4) D = det(V ).\nLemma 2.1. The normal sn to the manifold s is given by\n(2.5) sn = P s,\nwhere the matrix P is given by\n(2.6) P = I \u2212XV \u22121XT.\nProof. If sn = s \u2212\n\u2211k\nl=1 alXl = s \u2212Xa then choosing a so that sn \u00b7Xm = 0 for\nm = 1, . . . , k gives a = V \u22121XTs and hence the equation for P .\nNote that PXm = 0 for m = 1, . . . , k trivially as the tangent vectors have no\nnormal component.\nHaving identified the normal component of a vector on the manifold, the normal\nvelocity can be determined. To do this, use\n(2.7) x\u02d9m =\n\u2202xm(\u03be, t)\n\u2202t\n, m = 1, . . . , k,\nSGWMFE 463\nand\n(2.8) u\u02d9l =\n\u2202ul\n\u2202t\n+\nk\u2211\nj=1\n\u2202ul\n\u2202xj\nx\u02d9j , l = 1, . . . , n,\nand rearrangement gives that, if\n(2.9) R =\n(\n0k\u00d7k 0k\u00d7n\n[\u2212ul,m]n\u00d7k In\u00d7n\n)\n,\nwhere 0k\u00d7n is a k-row, n-column matrix of zeros, In\u00d7n is an n by n identity matrix,\nand [\u2212ul,m] is an n-row, k-column matrix with entries \u2212 \u2202ul\u2202xm , then\n(2.10) Rs\u02d9 =\n\u239b\n\u239c\u239c\u239c\u239c\u239c\u239c\u239c\u239c\u239d\n0\n...\n0\n\u2202u1\n\u2202t\n...\n\u2202un\n\u2202t\n\u239e\n\u239f\u239f\u239f\u239f\u239f\u239f\u239f\u239f\u23a0\n.\nLemma 2.2. The matrices P and R satisfy\n(2.11) PR = P.\nProof. The matrix R is rewritten as R = I \u2212 [X1 \u00b7 \u00b7 \u00b7Xk0 \u00b7 \u00b7 \u00b70], and then we use\nPXm = 0.\nThus we obtain\n(2.12) s\u02d9n = P s\u02d9 = PRs\u02d9 = P\n\u239b\n\u239c\u239c\u239c\u239c\u239c\u239c\u239c\u239c\u239d\n0\n...\n0\n\u2202u1\n\u2202t\n...\n\u2202un\n\u2202t\n\u239e\n\u239f\u239f\u239f\u239f\u239f\u239f\u239f\u239f\u23a0\n= P\n\u239b\n\u239c\u239c\u239c\u239c\u239c\u239c\u239c\u239c\u239d\n0\n...\n0\nL1\n...\nLn\n\u239e\n\u239f\u239f\u239f\u239f\u239f\u239f\u239f\u239f\u23a0\n= PL,\nwith L = (0, . . . , 0, L1, . . . , Ln)\nT. Thus the normal motion of the manifold is deter-\nmined by\n(2.13) P\n[\ns\u02d9\u2212 L] = 0.\nThis system is central to the solution method since the original n PDEs have been\nreplaced by n + k equations for the manifold velocities (x\u02d91, . . . , x\u02d9k, u\u02d91, . . . , u\u02d9n) and\nupon space discretization, these will become n+ k nonlinear ODEs in time.\n3. Implementation of SGWMFE in two dimensions. Having considered\nthe very general formulation, in this section we look at the details of implementing\nthe method for a system of two PDEs in two dimensions. For simplicity, denote the\nindependent variables x and y and the dependent variables u and v, and let them be\ngoverned by\n(3.1) ut = L1(u, v), vt = L2(u, v).\n464 A. WACHER AND I. SOBEY\nThe solution (u, v) can be considered as a two-dimensional manifold in four-\ndimensional space; that is,\n(3.2) s = (x, y, u, v)T.\nTwo tangent vectors to the manifold will beXT = (1, 0, ux, vx) andY\nT = (0, 1, uy, vy),\nand the determinant D is\n(3.3) D = |X|2|Y|2 \u2212 (X \u00b7Y)2 = (|X||Y|| sin(\u03b8)|)2,\nwhere \u03b8 is the angle between X and Y.\nThe normal sn to the manifold s is given by\n(3.4) sn = P s\n(see (2.5)), where the matrix P from (2.6) is given by\n(3.5) P = I \u2212 1\nD\n[|Y|2(XXT )\u2212 (X \u00b7Y)(XYT ) + |X|2(YYT )\u2212 (X \u00b7Y)(YXT )].\nThe matrix R is\n(3.6) R =\n\u239b\n\u239c\u239c\u239d\n0 0 0 0\n0 0 0 0\n\u2212ux \u2212uy 1 0\n\u2212vx \u2212vy 0 1\n\u239e\n\u239f\u239f\u23a0\nso that\n(3.7) Rs\u02d9 = R\n\u239b\n\u239c\u239c\u239d\nx\u02d9\ny\u02d9\nu\u02d9\nv\u02d9\n\u239e\n\u239f\u239f\u23a0 =\n\u239b\n\u239c\u239c\u239d\n0\n0\nut\nvt\n\u239e\n\u239f\u239f\u23a0 .\nAs in the general case, obtain\n(3.8) s\u02d9n = P s\u02d9 = PRs\u02d9 = P\n\u239b\n\u239c\u239c\u239d\n0\n0\nut\nvt\n\u239e\n\u239f\u239f\u23a0 = P\n\u239b\n\u239c\u239c\u239d\n0\n0\nL1\nL2\n\u239e\n\u239f\u239f\u23a0 = PL,\nwith L = (0, 0, L1, L2)\nT. Thus, as before, the normal motion of the manifold is\ndetermined by\n(3.9) P\n[\ns\u02d9\u2212 L] = 0.\nDiscretization of this system can be cast in a finite element framework by using\nappropriate test functions\u2014in this case the piecewise linear basis functions which are\nused also to discretize the solutions for (u, v) at time varying (x, y) nodal locations. If\nthe basis functions are denoted \u03b1i then the discrete equations for the normal motion\nof the manifold are\n(3.10)\n\u222b\nmanifold\nP (s\u02d9\u2212 L)\u03b1idS = 0,\nSGWMFE 465\nx\ny \nl\nl\nl1\n2\n0\n0\n1\n2\nA\nFigure 3.1. Triangle T , showing the orientation of nodes 0, 1, and 2, the projected x\u2212 y area\nA, and the edge lengths \u00020, \u00021, and \u00022.\nwhere dS is an element of the manifold and the superscript i ranges over the basis\nfunctions. In two dimensions, a triangular cell T can be used, as in Figure 3.1, and\nthen, after piecewise linear discretization, ux, vx, uy, vy, and hence also P are constant\non each cell. The parameterization used for the implementation of SGWMFE is \u03be1 = x\nand \u03be2 = y, so that two infinitesimal vectors Xdx and Ydy span a parallelogram in\n4\u2212D of area\n(3.11) dS = |Xdx||Ydy|| sin(\u03b8)| =\n\u221a\nDdxdy.\nIt can also be noted that this SGWMFE formulation is equivalent to a variational\nformulation which chooses to minimize the functional\n(3.12) \u03c8 =\n\u222b\n||P (s\u02d9\u2212 L)||2dS,\nwith respect to the nodal velocities s\u02d9i = (x\u02d9i, y\u02d9i, u\u02d9i, v\u02d9i).\nIn order to solve the discrete system of ODEs, an algorithm such as the well-\nknown backward differentiation formula 2 (BDF2) found in [3] can be used. The\nBDF2 integrator is a robust stiff integrator which is necessary for the stiff systems\narising in SGWMFE; however, any robust stiff integrator may be used. The BDF2\nintegration code developed and made available by Carlson and Miller was used for\nthe results in this paper. A detailed outline of the BDF2 integrator routine is in [8].\n3.1. Implementation. The implementation of SGWMFE requires some nota-\ntion for the average value of a scalar or vector valued function f on a cell or an edge.\nAn element of area on the manifold, dS, is related to the projected x\u2212y area by (3.11),\nand since D is constant on each element, the projected area A of an element with\narea S is related by S =\n\u221a\nDA. Hence the average of a function f over a triangular\ncell T is given by\n(3.13) [f ]T =\n1\nA\n\u222b\nT\nfdxdy =\n1\nS\n\u222b\nT\nfdS.\nWe will also assume that the three nodes of the triangle T are labeled 0, 1, 2, as in\nFigure 3.1.\nThe average of f over an edge E of length \t is given by\n(3.14) [f ]E =\n1\n\t\n\u222b\nE\nfds,\nwhere the integrand is with respect to the infinitesimal length along the edge: ds =\u221a\ndx2 + dy2.\n466 A. WACHER AND I. SOBEY\n3.2. Time derivative terms. As P is constant on an element, the components\nof the system for time derivatives on a triangular cell T are given by\n(3.15)\n\u222b\nT\nP s\u02d9\u03b10dS = P\n\u222b\nT\ns\u02d9\u03b10dS.\nSimilar contributions will occur for nodes 1 and 2 of the cell. Since the s\u02d9 and \u03b10\nare linear functions of the two-dimensional parameter \u03be, the integrand in (3.15) is\nquadratic in the components of \u03be and hence can be evaluated by the \u201cedge-midpoint\nrule\u201d which is exact for quadratic functions.\n3.3. Flux terms. Since many systems of interest contain a flux term, consider\nthe case where L1 = \u2207\u00b7 f . For the given triangular cell T , the contributions from this\nflux term from the cell onto its 0 node are\n(3.16)\n\u222b\nT\nP\n\u239b\n\u239c\u239c\u239d\n0\n0\n\u2212\u2207 \u00b7 f\n0\n\u239e\n\u239f\u239f\u23a0\u03b10dS = \u221aDP\n\u239b\n\u239c\u239c\u239d\n0\n0\n1\n0\n\u239e\n\u239f\u239f\u23a0\n\u222b\nT\n(\u2212\u2207 \u00b7 f)\u03b10dxdy,\nwhere, again, the constancy of P and D on each cell enables these to be taken out of\nthe integral. The scalar integral expression may be integrated by parts, as in [9]:\n(3.17)\n\u222b\nT\n\u2212\u2207 \u00b7 f\u03b10dxdy =\n\u222b\nT\nf \u00b7 \u2207\u03b10dxdy \u2212\n\u222b\nE1\n\u03b10f \u00b7 \u03bd\u03021ds\u2212\n\u222b\nE2\n\u03b10f \u00b7 \u03bd\u03022ds,\nwhere E1 and E2 are edges adjacent to node 0 and \u03bd\u03021, \u03bd\u03022 are outward normals to\nthose edges (\u03b10 is zero on the third edge).\nThis component can be simplified by using average values. Defining \ti as the\nx \u2212 y projected lengths of the corresponding edge Ei, (3.17) is rewritten in terms of\naverage values as\n(3.18)\n\u222b\nT\n\u2212\u2207 \u00b7 f\u03b10dxdy = A\u2207\u03b10 \u00b7 [f ]T \u2212 l1\u03bd\u03021 \u00b7 [\u03b10f ]E1 \u2212 l2\u03bd\u03022 \u00b7 [\u03b10f ]E2 .\n3.4. Constant coefficient diffusion terms. Another common component of\nthe differential operators L1 and L2 is a diffusion term. We consider first the case of\nconstant diffusion; the second case of nonconstant or nonlinear diffusion is considered\nlater. In order to evaluate the integrals of the Laplacian terms, mollification is used.\nFor piecewise linear approximations, the Laplacian is singular at an edge. In order\nto overcome this, consider the integrals in neighborhoods of each edge and assume\nthat the piecewise linear approximation is the limit of an approximation which can\nbe differentiated twice; that is, the piecewise linear representations of the solution\nvariables need to be mollified so that the first derivatives vary smoothly from cell to\ncell in a neighborhood whose thickness will be allowed to vanish. The principle here\nis the same as in the two-dimensional paper of [9]. To do this, some of the same labels\nas in that paper are used to define cells, edges, endpoints, and unit normal vectors.\nWithout loss of generality, assume that the 0 to 1 edge E is aligned in the y\ndirection as shown in Figure 3.2. This is done so that the unit outward normal vector\nto E is \u03bd\u0302 = x\u0302, and the unit tangent vector to E is \u03c4\u0302 = y\u0302. Then on crossing the edge,\nthe values uy and vy stay constant, but ux and vx are functions of x, which increase\nby 2a and 2b, respectively, with mean values mu and mv. Now assume all three are\nSGWMFE 467\n \n 1\n0\n x\ny\nFigure 3.2. Mollification of edge of two triangles.\nx\n\u03c3=\u22121\n\u03c3=1\nFigure 3.3. \u03c3(x).\nmollified equally; that is, the \u201cX\u201d tangent vector to the two-dimensional manifold in\nfour dimensions is\n(3.19) X(x) = M+ \u03c3(x)A =\n\u239b\n\u239c\u239c\u239d\n1\n0\nux\nvx\n\u239e\n\u239f\u239f\u23a0 =\n\u239b\n\u239c\u239c\u239d\n1\n0\nmu\nmv\n\u239e\n\u239f\u239f\u23a0+\n\u239b\n\u239c\u239c\u239d\n0\n0\na\nb\n\u239e\n\u239f\u239f\u23a0\u03c3(x),\nwhere \u03c3(x) varies from \u22121 to 1 in the neighborhood of the edge as shown in Figure\n3.3. Thus the Laplacian contribution is\n(3.20) L \u2261\n\u239b\n\u239c\u239c\u239d\n0\n0\nuxx + uyy\nvxx + vyy\n\u239e\n\u239f\u239f\u23a0 =\n\u239b\n\u239c\u239c\u239d\n0\n0\na\nb\n\u239e\n\u239f\u239f\u23a0\u03c3\u2032(x).\nThe \u201cY\u201d tangent vector to the two-dimensional manifold is the constant vector\n(3.21) Y =\n\u239b\n\u239c\u239c\u239d\n0\n1\nuy\nvy\n\u239e\n\u239f\u239f\u23a0 .\nNote that the integrals are considered only in a small neighborhood nbd of the edge\u2014\nthat is, the neighborhood of the x\u2212 y projection of edge E. This is because uxx and\nvxx are identically zero away from the edge neighborhood where the rapid variation\noccurs. First use the same approach as in the section on constant coefficient diffusion\nterms\u2014that of assuming the edge E is aligned with the y axis and then rotating\nthe results accordingly. We note that \u03b10 is equivalent to a function of y alone in an\ninfinitesimal neighborhood of the edge E. Now take the integral\n\u222b \u222b\nPL\u03b10dS over\nthe neighborhood nbd to get\n468 A. WACHER AND I. SOBEY\n(3.22)\n\u222b \u222b\nnbd\nP\n\u239b\n\u239c\u239c\u239d\n0\n0\nuxx\nvxx\n\u239e\n\u239f\u239f\u23a0\u03b10(y)dS =\n\u222b \u222b\nnbd\n\u221a\nDP\n\u239b\n\u239c\u239c\u239d\n0\n0\na\nb\n\u239e\n\u239f\u239f\u23a0\u03c3\u2032(x)\u03b10(y)dxdy\n=\n\u222b y=\u000301\ny=0\n\u239b\n\u239c\u239c\u239d\n\u222b\nxnbd\n\u221a\nDP\n\u239b\n\u239c\u239c\u239d\n0\n0\na\nb\n\u239e\n\u239f\u239f\u23a0\u03c3\u2032(x)dx\n\u239e\n\u239f\u239f\u23a0\u03b10(y)dy\n=\n\t01\n2\n\u222b \u03c3=1\n\u03c3=\u22121\n\u221a\nD(\u03c3)P (\u03c3)Ad\u03c3,\nwhere \t01 is the length of the edge joining node 0 and node 1, as in Figure 3.2. Further,\nonce the matrix P (\u03c3) has been postmultiplied through by the vector A (defined in\n(3.19)) and by\n\u221a\nD(\u03c3), then\n(3.23)\n\u221a\nD(\u03c3)P (\u03c3)A =\n1\u221a\nD(\u03c3)\n[D(\u03c3)A\u2212D1(\u03c3)X(\u03c3)\u2212D2(\u03c3)Y],\nwhere the vector X(\u03c3) and variables D(\u03c3), D1(\u03c3), and D2(\u03c3) are functions of \u03c3:\n(3.24)\nX(\u03c3) = M+A\u03c3,\nD(\u03c3) = |X(\u03c3)|2|Y|2 \u2212 (X(\u03c3) \u00b7Y)2,\nD1(\u03c3) = (X(\u03c3) \u00b7A)|Y|2 \u2212 (Y \u00b7A)(Y \u00b7X(\u03c3)),\nD2(\u03c3) = (Y \u00b7A)|X(\u03c3)|2 \u2212 (X \u00b7A)(X(\u03c3) \u00b7Y).\nSimplifying, the expression D(\u03c3)A \u2212 D1(\u03c3)X(\u03c3) \u2212 D2(\u03c3)Y is linear in \u03c3 as\nquadratic terms cancel and may be written as G + H\u03c3, where G and H are con-\nstant vectors in \u03c3. Also notice that D(\u03c3) is quadratic in \u03c3 and may be written as\nc1 + c2\u03c3 + c3\u03c3\n2, where c1, c2, and c3 are constants in \u03c3. Using this information, the\nintegral\n\u222b 1\n\u22121\n\u221a\nD(\u03c3)P (\u03c3)Ad\u03c3 may thus be written as\n(3.25) G\n\u222b 1\n\u22121\n1\u221a\nc1 + c2\u03c3 + c3\u03c32\nd\u03c3 +H\n\u222b 1\n\u22121\n\u03c3\u221a\nc1 + c2\u03c3 + c3\u03c32\nd\u03c3.\nIn the one-dimensional theory of SGWMFE both the integrals multiplied by G\nand H, respectively, were expressed analytically in [19] and [17], since they were\nnecessary for the calculation of the contributions from the Laplacian terms in one\ndimension; however, sixteen point Gauss quadrature is used for the integrals for the\nstudies carried out for this paper. Once the terms of the vector have been calculated,\nit is necessary to rotate the x and y components to the correct orientation, since the\ncalculations were made based on the assumption that the x\u2212y projection of the edge\nE was aligned with the y axis.\nThis rotation is done by replacing the first two components of the vector (corre-\nsponding to its x and y components) and multiplying by a rotation matrix:\n(3.26)\n\u239b\n\u239c\u239c\u239d\ndy\n\ti\ndx\n\ti\n\u2212dx\n\ti\ndy\n\ti\n\u239e\n\u239f\u239f\u23a0 .\nSGWMFE 469\n3.5. Source terms. The contributions over a cell from a source term, say,\nS1(u, v) in L1 onto its 0th node, are obtained as follows:\n(3.27)\n\u222b\nT\nP\n\u239b\n\u239c\u239c\u239d\n0\n0\nS1(u, v)\n0\n\u239e\n\u239f\u239f\u23a0\u03b10dS = \u221aDP\n\u239b\n\u239c\u239c\u239d\n0\n0\n1\n0\n\u239e\n\u239f\u239f\u23a0\n\u222b\nT\nS1(u, v)\u03b1\n0dxdy,\nresulting in the equivalent compact form\n(3.28)\n\u222b\nT\nS1(u, v)\u03b1\n0dxdy = A[\u03b10S1(u, v)]T .\n3.6. Nonuniform diffusion terms in conservative form. Consider a non-\nconstant or nonlinear diffusion term of the form L1 = \u2207\u00b7(a\u2207u), where a = a(x, y, u, v).\nThe contributions from this term in the cell onto its 0th node are obtained as follows:\n(3.29)\n\u222b\nT\nP\n\u239b\n\u239c\u239c\u239d\n0\n0\n\u2207 \u00b7 (a\u2207u)\n0\n\u239e\n\u239f\u239f\u23a0\u03b10dS =\n\u222b\nT\nP\n\u239b\n\u239c\u239c\u239d\n0\n0\na\u22072u\n0\n\u239e\n\u239f\u239f\u23a0\u03b10dS +\n\u222b\nT\nP\n\u239b\n\u239c\u239c\u239d\n0\n0\n\u2207a \u00b7 \u2207u\n0\n\u239e\n\u239f\u239f\u23a0\u03b10dS.\nConsider the first integral on the right-hand side, noting that the term \u22072u is zero\non each cell not including the edges. So the contributions from this first integral need\nonly be considered in the \u03b4-neighborhood of the edges in the support of \u03b10, as is the\ncase for the constant coefficient Laplacian, as discussed in the section about constant\ncoefficient diffusion terms. It will suffice to express the integral here for one edge E.\nAgain we use the same approach as in the section on constant coefficient diffusion\nterms\u2014that of assuming the edge E is aligned with the y axis and then rotating the\nresults accordingly. As in [9] we note that, like \u03b10, a(x, y, u, v) is equivalent to a\nfunction of y alone in an infinitesimal neighborhood of the edge E. Thus\n(3.30)\n\u222b\nT\nP\n\u239b\n\u239c\u239c\u239d\n0\n0\na\u22072u\n0\n\u239e\n\u239f\u239f\u23a0\u03b10dS =\n\u222b y=\u000301\ny=0\n\u239b\n\u239c\u239c\u239d\n\u222b\nxnbd\n\u221a\nDP\n\u239b\n\u239c\u239c\u239d\n0\n0\n\u22072u\n0\n\u239e\n\u239f\u239f\u23a0dx\n\u239e\n\u239f\u239f\u23a0 a(y)\u03b10(y)dy,\nand the integral thus becomes (using the notation from (3.14))\n(3.31) \t01[a\u03b1\n0]E\n\u239b\n\u239c\u239c\u239d\n\u222b\nxnbd\n\u221a\nDP\n\u239b\n\u239c\u239c\u239d\n0\n0\n\u22072u\n0\n\u239e\n\u239f\u239f\u23a0dx\n\u239e\n\u239f\u239f\u23a0 .\nThe integral over the xnbd is identical to the one derived for the Laplacian in (3.22),\nand thus the details will not be repeated here. The second integral in (3.29) can be\ntreated as a source term:\n(3.32)\n\u222b\nP\n\u239b\n\u239c\u239c\u239d\n0\n0\n\u2207a \u00b7 \u2207u\n0\n\u239e\n\u239f\u239f\u23a0\u03b10dS.\n470 A. WACHER AND I. SOBEY\nSince P is constant over each cell and the term \u2207a \u00b7 \u2207u is assumed bounded on each\ncell (u is constant on each cell and a is assumed continuous and bounded), then it is\nonly necessary to consider the integral over each cell. For each cell T , use the theory\nderived for source terms with S1(u, v) = \u2207a \u00b7\u2207u, and similarly if there are equivalent\nterms in the second PDE S2(u, v) = \u2207a \u00b7 \u2207v.\n3.7. Regularization. As in the one-dimensional SGWMFE approach it may be\nnecessary to add regularization terms in order to remove any degeneracies which may\noccur in the discrete system of ODEs. The regularization terms used here are similar\nto the terms introduced as pressure regularization in [8], as opposed to the internodal\nviscosity regularization terms more commonly known. As in the one-dimensional\ncase, the need for regularization may arise when the solution has two consecutive\ncells with the same slope or when two nodes run into each other or overlap causing a\ndegeneracy in the system of equations (see [17] for one-dimensional analysis). In order\nto remove the possibility of this happening, in [12] and [8] it was shown that adding\nregularization terms which are proportional to nodal velocities (described by Miller\nas internodal viscosities) is successful in two dimensions. These internodal viscosities\nare not needed for the porous medium equation; however, in some instances when the\nsolution has an infinite slope it is necessary to use the pressure regularization terms\nas suggested by [13], added to keep nodes from overlapping.\nThe pressure terms used are derived from a quality functional. That is, the terms\nadded are a constant times the negative gradient of a mesh quality functional Q,\nwhere the gradient is with respect to the discrete nodal velocities [x\u02d9i, y\u02d9i, u\u02d9i, v\u02d9i]. The\nquality functional used here is\nQ =\nP 2\n\u0394S\n,(3.33)\non each cell T , where P is the perimeter of the triangular cell and \u0394S is the area of\nthe triangle in the four-dimensional space as introduced in (3.11). Thus for a four-\ndimensional set of ODEs resulting from the SGWMFE discretization, the pressure\nterms added to the equations at each node is\n(3.34) \u2212C2\n\u239b\n\u239c\u239c\u239c\u239c\u239c\u239c\u239c\u239c\u239c\u239c\u239c\u239c\u239d\ndQ\ndxi\ndQ\ndyi\ndQ\ndui\ndQ\ndvi\n\u239e\n\u239f\u239f\u239f\u239f\u239f\u239f\u239f\u239f\u239f\u239f\u239f\u239f\u23a0\n.\nThe solutions are not very sensitive to the value of the pressure regularization pa-\nrameter C2, so long as C2 is much smaller than the error tolerance, that is, so that\nthe regularization terms added are well below the order of accuracy required. For\nthe porous medium equation when the pressure terms are not needed, the addition\nof these terms makes no difference to the solution within the error tolerance. These\nterms are not needed for the case when m = 1 in the porous medium equation. How-\never, as explained later, there are some cases when these terms are needed and the\nC2 is set to (tol\/10)2, where tol is the local truncation error tolerance of the time\nintegrator.\nSGWMFE 471\n4. Results.\n4.1. Porous medium equation. The parameter m in (1.1) determines the\nstrength of the nonlinearity in the diffusion. In this paper we consider two cases,\nm = 1 and m = 3. For both cases the problem is started with an initial condition\nof r0 = 1\/2 and the initial profile is obtained from the similarity solution using this\ninformation. It is worthwhile noting that the choice of m is not limited; while not\nall possible integer values for m > 0 were tested, some integer values larger than 3\nwere tested, such as the problem with m = 5, which produced results in agreement\nwith (1.2), as in the cases presented in this paper. The key point that makes the\ncases m = 1 and m > 1 different is that for the first case the slopes of the solutions\nare finite over the domain for this problem, and for cases m > 1 the solutions have\ninfinite slopes at the moving boundary. In all cases, SGWMFE performs well.\nThe results illustrated in Figures 4.1 and 4.2 show the differences between the\ncases m = 1, which clearly diffuses faster, and m = 3, which has infinite slope near\nthe moving boundary. The solutions were computed in the first quadrant using a\ntwo-dimensional SGWMFE code and the graphs show the solutions reflected onto the\nthree remaining quadrants. This is because the problem is axially symmetric. The\nmesh plots are on the actual computational domain (see Figures 4.3 and 4.4), where\nit is seen that the SGWMFE code does indeed produce axially symmetric results.\nThe speed of the spreading of the solutions can also be seen more clearly from the\nmesh plots. For both problems (m = 1 and m = 3) the initial conditions begin with\nan arced domain of radius 1\/2. However, in the case m = 1, the solution boundary\nreaches a radius of almost 1.5, and in the case m = 3, the radius reaches a value of\naround 0.8 in the same amount of time. It is interesting that, regardless of the initial\nmesh chosen, for the porous medium equation, the meshes converge almost instantly,\nso that at any particular later time, the meshes will be the same; i.e., the mesh acts\nas an attractor. This can be seen in Figures 4.5 and 4.6.\nIt is worth mentioning that the case of m = 3 required use of pressure regu-\nlarization terms. This is because the slopes are infinite and in the two-dimensional\ncase (as in the one-dimensional case found in [17, 18]) the nodes tend to bunch up\n\u20131\n0\n1\n\u20131\n0\n1\n0\n0.5\n1\nSurface elevation at T = 0\n\u20131\n0\n1\n\u20131\n0\n1\n0\n0.5\n1\nSurface elevation at T = 0.5\n\u20131\n0\n1\n\u20131\n0\n1\n0\n0.5\n1\nSurface elevation at T = 1\n\u20131\n0\n1\n\u20131\n0\n1\n0\n0.5\n1\nSurface elevation at T = 2\nFigure 4.1. SGWMFE solutions for the porous medium equation with m = 1. Solutions\nwere obtained with 136 nodes initially distributed uniformly. Viscous (A2) regularization terms and\npressure (C2) regularization terms were not needed for this problem.\n472 A. WACHER AND I. SOBEY\n\u20131\n0\n1\n\u20131\n0\n1\n0\n0.5\n1\nSurface elevation at T = 0\n\u20131\n0\n1\n\u20131\n0\n1\n0\n0.5\n1\nSurface elevation at T = 0.5\n\u20131\n0\n1\n\u20131\n0\n1\n0\n0.5\n1\nSurface elevation at T = 1\n\u20131\n0\n1\n\u20131\n0\n1\n0\n0.5\n1\nSurface elevation at T = 2\nFigure 4.2. SGWMFE solutions for the porous medium equation with m = 3. Solutions\nwere obtained with 136 nodes initially distributed uniformly. Pressure regularization terms of C2 =\n(10)\u221210 were used for this problem. Viscous (A2) regularization terms were not needed for this\nproblem.\n0 0.5 1 1.5\n0\n0.5\n1\n1.5\nMesh at T = 0\n0 0.5 1 1.5\n0\n0.5\n1\n1.5\nMesh at T = 0.5\n0 0.5 1 1.5\n0\n0.5\n1\n1.5\nMesh at T = 1\n0 0.5 1 1.5\n0\n0.5\n1\n1.5\nMesh at T = 2\nFigure 4.3. SGWMFE meshes corresponding to solutions for the porous medium equation\nwith m = 1. Solutions were obtained with 136 nodes initially distributed uniformly. Viscous (A2)\nregularization terms and pressure (C2) regularization terms were not needed for this problem.\ntoward the infinite slope. In this case, it is so severe that the regularization pressure\nterms are needed in order to keep the nodes from overlapping and thus maintaining a\nwell-defined mesh. The regularization pressure terms used for this problem are very\nsmall\u2014much smaller than the time integrator tolerance used for this problem, which\nwas chosen at 10\u22124. Also this is the only problem presented in this paper where\nregularization terms were not needed, regardless of the value of m and regardless\nof the dimension in which the problem was solved. This is because the problem is\ndiffusive and has its own natural diffusivity in the nonlinear terms, thus keeping the\nsolution smooth. This is different from the shallow water equations because artificial\nviscosity was added for the purpose of maintaining a smooth solution in the numerical\ncalculation.\nSGWMFE 473\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1\nMesh at T = 0\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1\nMesh at T = 0.5\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1\nMesh at T = 1\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1\nMesh at T = 2\nFigure 4.4. SGWMFE meshes corresponding to solutions for the porous medium equation\nwith m = 3. Solutions were obtained with 136 nodes initially distributed uniformly. Pressure\nregularization terms of C2 = (10)\u221210 were used for this problem. Viscous (A2) regularization terms\nwere not needed for this problem.\n0 0.5\n0\n0.2\n0.4\n(a)\n0 0.5 1\n0\n0.5\n1\n0 0.5 1\n0\n0.5\n1\nMesh plots for 2D PME with m = 1 with different starting meshes\n0 0.5 1\n0\n0.5\n1\n0 0.5\n0\n0.2\n0.4\n(b)\n0 0.5 1\n0\n0.5\n1\n0 0.5 1\n0\n0.5\n1\n0 0.5 1\n0\n0.5\n1\n0 0.5\n0\n0.2\n0.4\n(c)\n0 0.5 1\n0\n0.5\n1\n0 0.5 1\n0\n0.5\n1\n0 0.5 1\n0\n0.5\n1\nFigure 4.5. SGWMFE meshes corresponding to solutions for the porous medium equation with\nm = 1. Solutions were obtained with 136 nodes at times T = 0, 0.5, 1, 2 shown from left to right.\nIn (a) the initial mesh is one with nodes clustered toward the origin, (b) shows an initial mesh\nwhich is uniform, and (c) shows nodes initially clustered toward the moving boundary. Viscous (A2)\nregularization terms and pressure (C2) regularization terms were not needed for this problem.\nConvergence results for SGWMFE applied to the porous medium equation in\ntwo dimensions are shown. In the two-dimensional cases (regardless of the value of\nm) the slopes of the convergence lines for all the times shown are close to 1. Since\nthe relation between N and the average mesh parameter h is h =\n\u221a\narea(\u03a9)\/N , or\nN \u223c h\u22122 (where \u03a9 is the area of the computational domain), this result corresponds\nto an h2 rate of convergence, which is optimal for linear finite elements.\nThe L\u221e norm is chosen here for simplicity and to avoid introducing error from\nthe numerical calculation of the L1 norm over the nonuniform moving triangular grid.\nThe L\u221e error norms are shown in Figures 4.7 and 4.8. As expected from the results\nshown in the one-dimensional cases in [17, 18], the convergence rates are the same\n474 A. WACHER AND I. SOBEY\n0 0.5\n0\n0.2\n0.4\n(a)\n0 0.5\n0\n0.2\n0.4\n0.6\n0 0.5\n0\n0.2\n0.4\n0.6\nMesh plots for 2D PME with m = 3 with different starting meshes\n0 0.5\n0\n0.2\n0.4\n0.6\n0 0.5\n0\n0.2\n0.4\n(b)\n0 0.5\n0\n0.2\n0.4\n0.6\n0 0.5\n0\n0.2\n0.4\n0.6\n0 0.5\n0\n0.2\n0.4\n0.6\n0 0.5\n0\n0.2\n0.4\n(c)\n0 0.5\n0\n0.2\n0.4\n0.6\n0 0.5\n0\n0.2\n0.4\n0.6\n0 0.5\n0\n0.2\n0.4\n0.6\n0.8\nFigure 4.6. SGWMFE meshes corresponding to solutions for the porous medium equation with\nm = 3. Solutions were obtained with 136 nodes at times T = 0, 0.5, 1, 2 shown from left to right.\nIn (a) the initial mesh is one with nodes clustered toward the origin, (b) shows an initial mesh\nwhich is uniform, and (c) shows nodes initially clustered toward the moving boundary. Viscous (A2)\nregularization terms were not needed for this problem. Pressure regularization terms of C2 = (10)\u221210\nwere used for this problem.\n\u20132.7 \u20132.6 \u20132.5 \u20132.4 \u20132.3 \u20132.2 \u20132.1 \u20132 \u20131.9 \u20131.8 \u20131.7\n\u20136\n\u20135\n\u20134\n\u20133\n\u20132\n\u20131\nlog((1\/nnodes)1\/2)\nlo\ng(L\n\u221e\n \no\nf e\nrro\nr i\nn \nso\nlu\ntio\nn \nm\nax\nim\num\n) Porous Media equation in two dimensions with m = 1, T = 2\nNumerical data\nSlope = 1\n\u20132.7 \u20132.6 \u20132.5 \u20132.4 \u20132.3 \u20132.2 \u20132.1 \u20132 \u20131.9 \u20131.8 \u20131.7\n\u20134\n\u20133.5\n\u20133\n\u20132.5\n\u20132\n\u20131.5\nlog((1\/nnodes)1\/2)\nlo\ng(L\n\u221e\n \no\nf e\nrro\nr i\nn \nra\ndi\nus\n)\nPorous Media equation in two dimensions with m = 1, T = 2\nNumerical data\nSlope = 1\nFigure 4.7. Errors in SGWMFE solutions for the two-dimensional porous medium equation\nwith parameter m = 1. The solutions were obtained using meshes with a varying number of nodes\nat time T = 2. Viscous (A2) regularization terms and pressure (C2) regularization terms were not\nneeded for this problem. nnodes = number of nodes.\nregardless of the time to which the problem is solved. Thus only the convergence\nresults for solutions calculated at time T = 2 are presented here.\nThe results in Figure 4.8 show more data results, from solving the problem using\nmore nodes, than used to produce Figure 4.7 since originally it was not clear if the\norder of convergence of the radius was the same as the error over the entire solution\nSGWMFE 475\n\u20133 \u20132.8 \u20132.6 \u20132.4 \u20132.2 \u20132 \u20131.8 \u20131.6\n\u20135\n\u20134.5\n\u20134\n\u20133.5\n\u20133\n\u20132.5\n\u20132\n\u20131.5\nlog((1\/nnodes)1\/2)\nlo\ng(L\n\u221e\n \no\nf e\nrro\nr i\nn \nso\nlu\ntio\nn \nm\nax\nim\num\n) Porous Media equation in two dimensions with m = 3, T = 2\nNumerical data\nSlope = 1\n\u20133 \u20132.8 \u20132.6 \u20132.4 \u20132.2 \u20132 \u20131.8 \u20131.6\n\u20138\n\u20137\n\u20136\n\u20135\n\u20134\n\u20133\n\u20132\n\u20131\nlog((1\/nnodes)1\/2)\nlo\ng(L\n\u221e\n \no\nf e\nrro\nr i\nn \nra\ndi\nus\n)\nPorous Media equation in two dimensions with m = 3, T = 2\nNumerical data\nSlope = 1\nFigure 4.8. Errors in SGWMFE solutions for the two-dimensional porous medium equation\nwith parameter m = 3. The solutions were obtained using meshes with a varying number of nodes\nat time T = 2. Viscous (A2) regularization terms were not needed for this problem and pressure\nregularization terms of C2 = (10)\u221210 were used for this problem. nnodes = number of nodes.\ndomain, or if it was better for the case when m = 3. The extra data was needed since\nfrom the graph of the convergence rate, Figure 4.8, shows a higher order convergence\nrate than the case when m = 1 as the number of nodes are increased. However,\nsince the error tolerance used for this problem is 10\u22124, using more nodes than used to\nproduce the convergence results will not be more conclusive, since the results shown\nare already of the same order as the error tolerance. If all the data were to be\nreproduced with a lower truncation error tolerance, this would lead to more accurate\nsolutions, though the results would not necessarily show convergence rates that are\nsignificantly different.\n4.2. Gray Scott equations. First we examine the convergence of the method\non the Gray Scott equations. Since an analytic solution is not available, we construct\na reference solution (to be regarded as the \u201cexact solution\u201d) by using an extremely\nfine discretization\u2014much finer than that used for the actual computation. Solutions\nwith variable nodes are compared pointwise to solutions on a fine reference mesh with\n55 by 55 nodes. We then define the error measure in the component u as\n(4.1) E = \u2016 uref \u2212 u \u2016 \/ \u2016 uref \u2016,\nwhere u is the actual SGWMFE solution, uref is the reference solution, and \u2016 \u00b7 \u2016 is\nthe discrete L2 norm. Note that the values used for calculating the norms in (4.1) are\nmapped onto a fixed uniform fine mesh (using the linear shape functions) in order to\nenable objective comparison of the various meshes. Figure 4.9 shows the convergence\ncurves of E(N) on a log-log scale, where N is the total number of nodal points,\nshowing that the solutions with a variable number of nodes converge to the solution\non the finest mesh. Similar results have been obtained when applying this procedure\nto the shallow water equations.\n476 A. WACHER AND I. SOBEY\n\u201314 \u201312 \u201310\n\u20136\n\u20135\n\u20134\nlog((1\/nnodes)1\/2)\nlo\ng(E\n)\nT = 1\n\u201314 \u201312 \u201310\n\u20133.6\n\u20133.4\n\u20133.2\n\u20133\nlog((1\/nnodes)1\/2)\nlo\ng(E\n)\nT = 20\n\u201314 \u201312 \u201310\n\u20133.6\n\u20133.4\n\u20133.2\n\u20133\nlog((1\/nnodes)1\/2)\nlo\ng(E\n)\nT = 40\nFigure 4.9. SGWMFE convergence in u for the Gray Scott equations at times (from left to\nright): T = 1, 20, and 40. The error tolerance used is 10\u22124. The corresponding viscous regulariza-\ntion terms of A2 = 5(10)\u22128 and pressure regularization terms of C2 = (10)\u22128 were used for this\nproblem. nnodes = number of nodes.\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1 T = 30\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1 T = 40\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1 T = 50\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1 T = 60\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1 T = 70\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1 T = 80\nFigure 4.10. SGWMFE meshes produced when solving the Gray Scott equations with 35 by\n35 nodes. The error tolerance used is 10\u22124. The corresponding viscous regularization terms of\nA2 = 5(10)\u22128 and pressure regularization terms of C2 = (10)\u22128 were used for this problem.\nNext we show mesh plots at several times for SGWMFE solutions of the Gray\nScott equations using 35 by 35 nodes, much fewer nodes than for the solution plots\nfollowing, for the sake of clarity of the figure. It is clear in Figure 4.10 that the\nmesh is attracted to the reaction fronts. See Figures 4.11 and 4.12 for contours of\nthe solutions of the component u at corresponding times. The patterns observed in\nthe solution figures are similar to those found in [20]. However, the meshes obtained\nfor SGWMFE as compared to those shown in [20] are quite different, noting that for\nSGWMFE there is a much richer concentration of the nodes at the reaction front in\ncomparison to the meshes produced by the method in [20].\n4.3. Shallow water equations. Figure 4.13 shows SGWMFE results for the\nshallow water equations in two dimensions. The mesh plots are shown on the com-\nputational domain in order to make clearer comparisons between the mesh produced\nby SGWMFE and those produced by GWMFE. All of the numerical results for this\nproblem conserve \u201cmass\u201d (the integral of the variable u over the domain) within the\nerror tolerance. SGWMFE solutions are visually the same in comparison to the re-\nsults obtained using GWMFE, though the meshes produced by each method differ.\nSGWMFE 477\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1\nT = 20\n0.4\n0.6\n0.8\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1\nT = 40\n0.3\n0.4\n0.5\n0.6\n0.7\n0.8\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1\nT = 50\n0.3\n0.4\n0.5\n0.6\n0.7\n0.8\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1\nT = 60\n0.4\n0.6\n0.8\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1\nT = 70\n0.4\n0.5\n0.6\n0.7\n0.8\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1\nT = 80 \n0.4\n0.5\n0.6\n0.7\n0.8\nFigure 4.11. SGWMFE solutions produced when solving the Gray Scott equations with 45 by\n45 nodes. The error tolerance used is 10\u22124. The corresponding viscous regularization terms of\nA2 = 5(10)\u22128 and pressure regularization terms of C2 = (10)\u22128 were used for this problem.\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1\nT = 30\n0.4\n0.6\n0.8\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1\nT = 40\n0.3\n0.4\n0.5\n0.6\n0.7\n0.8\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1\nT = 50\n0.4\n0.6\n0.8\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1\nT = 60\n0.4\n0.5\n0.6\n0.7\n0.8\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1\nT = 70\n0.4\n0.5\n0.6\n0.7\n0.8\n0 0.5 1\n0\n0.2\n0.4\n0.6\n0.8\n1\nT = 80\n0.4\n0.5\n0.6\n0.7\n0.8\nFigure 4.12. SGWMFE solutions produced when solving the Gray Scott equations with 55 by\n55 nodes. The error tolerance used is 10\u22124. The corresponding viscous regularization terms of\nA2 = 5(10)\u22128 and pressure regularization terms of C2 = (10)\u22128 were used for this problem.\nThe results shown here are calculated to the user-chosen tolerance, which was chosen\nto be 10\u22123 in this case. The solutions were in agreement with those obtained with\nthe GWMFE code used in [9]. Further noting that the solutions are in agreement\nwith GWMFE, it is worth discussing the uniqueness of the meshes produced. The\nmeshes obtained for the shallow water equations are not \u201cunique.\u201d In Figures 4.14\nand 4.15, it is shown that with different initial meshes for solving the two-dimensional\nshallow water equations (with the same artificial viscosity), at various times, different\n478 A. WACHER AND I. SOBEY\n0\n5\n0\n5\n0\n0.5\n1\n(a) 0\n5\n0\n5\n0\n0.5\n1\n(b) 0\n5\n0\n5\n0\n0.5\n1\n(c)\n0\n5\n0\n5\n0\n0.5\n1\n(d) 0\n5\n0\n5\n0\n0.5\n1\n(e) 0\n5\n0\n5\n0\n0.5\n1\n(f)\nFigure 4.13. SGWMFE solutions for the shallow water equations with artificial viscosity\n\u0004 = (10)\u22122 at times T = 0, 1, 2, 3, 4, 5. Solutions were obtained with 289 nodes using the viscous\nregularization terms A2 = 5(10)\u22125. Regularization pressure terms were not needed for this problem.\n0 2 4\n0\n1\n2\n3\n4\n5\nMesh plots for SGWMFE with different starting meshes\n0 2 4\n0\n1\n2\n3\n4\n5\n0 2 4\n0\n1\n2\n3\n4\n5\n0 2 4\n0\n1\n2\n3\n4\n5\n0 2 4\n0\n1\n2\n3\n4\n5\n0 2 4\n0\n1\n2\n3\n4\n5\n0 2 4\n0\n1\n2\n3\n4\n5\n0 2 4\n0\n1\n2\n3\n4\n5\n0 2 4\n0\n1\n2\n3\n4\n5\n0 2 4\n0\n1\n2\n3\n4\n5\n0 2 4\n0\n1\n2\n3\n4\n5\n0 2 4\n0\n1\n2\n3\n4\n5\nFigure 4.14. SGWMFE meshes corresponding to solutions for the shallow water equations\nwith artificial viscosity \u0004 = (10)\u22122 at times T = 0, 2, 4, 5. Solutions were obtained with 289 nodes\nusing the viscous regularization terms A2 = 5(10)\u22125. Pressure regularization terms were not needed\nfor this problem.\nmeshes are obtained (although the methods converge to solutions within the same\naccuracy, regardless of the initial mesh). It can also be seen in Figures 4.14 and 4.15,\nas expected, that the GWMFE and SGWMFE produce different meshes. This is true\nfor both the one-dimensional and two-dimensional formulations of the shallow water\nequations. This could have been shown using results obtained for the one-dimensional\nshallow water equations; however, the results in two dimensions, presented here, are\nmore demonstrative of the differences.\nSGWMFE 479\n0 2 4\n0\n1\n2\n3\n4\n5\nMesh plots for GWMFE with different starting meshes\n0 2 4\n0\n1\n2\n3\n4\n5\n0 2 4\n0\n1\n2\n3\n4\n5\n0 2 4\n0\n1\n2\n3\n4\n5\n0 2 4\n0\n1\n2\n3\n4\n5\n0 2 4\n0\n1\n2\n3\n4\n5\n0 2 4\n0\n1\n2\n3\n4\n5\n0 2 4\n0\n1\n2\n3\n4\n5\n0 2 4\n0\n1\n2\n3\n4\n5\n0 2 4\n0\n1\n2\n3\n4\n5\n0 2 4\n0\n1\n2\n3\n4\n5\n0 2 4\n0\n1\n2\n3\n4\n5\nFigure 4.15. GWMFE meshes corresponding to solutions for the shallow water equations with\nartificial viscosity \u0004 = (10)\u22122 at times T = 0, 2, 4, 5. Solutions were obtained with 289 nodes using\nthe viscous regularization terms A2 = 5(10)\u22125. Pressure regularization terms were not needed for\nthis problem.\n5. Conclusions. The equations for SGWMFE have been presented using a pro-\njection matrix, making the underlying formulation easy to understand. The result-\ning equations resulting for SGWMFE are an elegant extension to existing gradient\nweighted methods. A convergence study of the method was carried out for the porous\nmedium equation in two dimensions. The results show accurate solutions that corre-\nspond to an h2 rate of convergence, which is optimal for linear finite elements. Further\nresults were shown for the Gray Scott equations agreeing with results of a different\nmoving mesh method and solutions of the nonlinear shallow water equations for both\nSGWMFE and GWMFE, obtaining equally accurate results on the different meshes\nproduced by each corresponding method.\nIn [17] further calculations are given for the shallow water equations in both one\nand two dimensions, as well as for reaction diffusion equations in one dimension. In\neach case SGWMFE was straightforward to implement and gave reliable solutions for\nrelatively little computational effort.\nIn conclusion, derivation and implementation of SGWMFE is straightforward\nand the formulation is easily generalized for arbitrary systems of PDEs in multiple\ndimensions. The method has proved to solve the problems presented here with steep\nmoving fronts and a chemical reaction diffusion problem with pattern formation, both\nof which are difficult numerical problems. For such problems, SGWMFE can produce\naccurate results efficiently with respect to the number of nodes used as well as the\ncalculation time.\n6. Acknowledgments. This work has been motivated and to some extent,\nguided, by Keith Miller, whose pioneering work on gradient weighted methods con-\ntains the origins of SGWMFE, and we are immensely grateful to him for his help and\nadvice. We are also very grateful to Andy Wathen and Mike Baines for discussions\nabout moving finite element methods and to Mike Baines for suggesting a study of\nthe porous medium equation.\n480 A. WACHER AND I. SOBEY\nREFERENCES\n[1] M. Baines, Moving Finite Elements, Oxford University Press, New York, 1994.\n[2] M. Baines, M. Hubbard, and P. Jimack, A moving mesh finite element algorithm for the\nadaptive solution of time-dependent partial differential equations with moving boundaries,\nAppl. Numer. Math., 54 (2005), pp. 450\u2013469.\n[3] R. E. Bank, W. C. Coughran, Jr., W. Fichtner, E. Grosse, D. Rose, and R. Smith,\nTransient simulation of silicon devices and circuits, IEEE Trans. CAD, 4 (1985), pp. 436\u2013\n451.\n[4] G. I. Barenblatt, Scaling, Cambridge Texts In Applied Mathematics, Cambridge University\nPress, Cambridge, UK, 2003.\n[5] C. Budd, R. Carretero-Gonzlez, and R. Russell, Precise computations of chemotactic\ncollapse using moving mesh methods, J. Comput. Phys., 202 (2005), pp. 463\u2013487.\n[6] C. J. Budd, G. Collins, W. Huang, and R. Russell, Self-similar numerical solutions of the\nporous-medium equation using moving mesh methods, Phil. Trans. Roy. Soc. London Ser.\nA, 357 (1999), pp. 1047\u20131077.\n[7] C. J. Budd and M. Piggott, The geometrix integration of scale-invariant ordinary and partial\ndifferential equations, J. Comput. Appl. Math., 128 (2001), pp. 399\u2013422.\n[8] N. N. Carlson and K. Miller, Design and application of a gradient-weighted moving finite\nelement code I: In one dimension, SIAM J. Sci. Comput., 19 (1998), pp. 728\u2013765.\n[9] N. N. Carlson and K. Miller, Design and application of a gradient-weighted moving finite\nelement code II: In two dimensions, SIAM J. Sci. Comput., 19 (1998), pp. 766\u2013798.\n[10] J. L. Kyoung, W. McCormick, Q. Ouyang, and H. L. Swinney, Pattern formation by\ninteracting chemical fronts, Science, 261 (1993), pp. 192\u2013194.\n[11] R. Li, W. Liu, and H. Ma, Moving mesh method with error-estimator-based monitor and its\napplications to static obstacle problem, J. Sci. Comput., 21 (2004), pp. 31\u201355.\n[12] K. Miller, A geometrical-mechanical interpretation of gradient-weighted moving finite ele-\nments, SIAM J. Numer. Anal., 34 (1997), pp. 67\u201390.\n[13] K. Miller, private communication, 2002.\n[14] K. Miller and R. N. Miller, Moving finite elements. I, SIAM J. Numer. Anal., 18 (1981),\npp. 1019\u20131032.\n[15] Z. Tan, Z. Zhang, Y. Huang, and T. Tang, Moving mesh methods with locally varying time\nsteps, J. Comput. Phys., 200 (2004), pp. 347\u2013367.\n[16] T. Tang, Moving Mesh Methods for Computational Fluid Dynamics, CSCAMM-05-04, Center\nfor Scientific Computation and Mathematical Modeling, University of Maryland, College\nPark, MD, 2005.\n[17] A. Wacher, String Gradient Weighted Moving Finite Elements For Systems of Partial Dif-\nferential Equations, Ph.D. thesis, Oxford University, Oxford, UK, 2004.\n[18] A. Wacher, Mmpde vs. Sgwmfe, Experiments in One Dimension, Tech. report, Oxford Com-\nputing Laboratory, Oxford, UK, 2005.\n[19] A. Wacher, I. Sobey, and K. Miller, String Gradient Weighted Moving Finite Elements for\nSystems of Partial Differential Equations, Tech. report, Oxford Computing Laboratory,\nOxford, UK, 2003.\n[20] P. A. Zegeling and H. P. Kok, Adaptive moving mesh computations for reaction\u2013diffusion\nsystems, J. Comput. Appl. Math., 168 (2004), pp. 519\u2013528.\n"}