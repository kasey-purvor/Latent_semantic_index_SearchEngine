{"doi":"10.1088\/1367-2630","coreId":"68769","oai":"oai:eprints.lancs.ac.uk:31239","identifiers":["oai:eprints.lancs.ac.uk:31239","10.1088\/1367-2630"],"title":"Recovering \u2018lost\u2019 information in the presence of noise: application to rodent\u2013predator dynamics.","authors":["Smelyanskiy, V. N.","Luchinsky, D. G.","Millonas, M. M.","McClintock, P. V. E."],"enrichments":{"references":[{"id":917467,"title":"A","authors":[],"date":"2007","doi":"10.1109\/AERO.2007.352950","raw":null,"cites":null},{"id":916849,"title":"A and Rohani P","authors":[],"date":"2000","doi":"10.1016\/S0140-6736(05)74604-3","raw":"Earn D J D, Levin S A and Rohani P 2000 Coherence and conservation Science 290 1360\u20134","cites":null},{"id":915318,"title":"Bayesian Statistical Modelling (Wiley","authors":[],"date":"2001","doi":null,"raw":"Congdon P 2001 Bayesian Statistical Modelling (Wiley Series in Probability and Statistics) (Chichester: Wiley)","cites":null},{"id":913622,"title":"Breto C and King A A","authors":[],"date":"2006","doi":null,"raw":"Ionides E L, Breto C and King A A 2006 Inference for nonlinear dynamical systems Proc. Natl Acad. Sci. USA 103 18438\u201343","cites":null},{"id":915713,"title":"Covariant formulation of nonequilibrium statistical thermodynamics Z.","authors":[],"date":"1977","doi":null,"raw":"Graham R 1977 Covariant formulation of nonequilibrium statistical thermodynamics Z. Phys. B 26 397\u2013405","cites":null},{"id":913080,"title":"Cyclic dynamics in a simple vertebrate predator\u2013prey community","authors":[],"date":"2003","doi":null,"raw":"Gilg O, Hanski I and Sittler B 2003 Cyclic dynamics in a simple vertebrate predator\u2013prey community Science 302 866\u20138","cites":null},{"id":914469,"title":"Fast Bayesian reconstruction of chaotic dynamical systems via extended Kalman \ufb01ltering Phys.","authors":[],"date":"2001","doi":null,"raw":"Meyer R and Christensen N 2001 Fast Bayesian reconstruction of chaotic dynamical systems via extended Kalman \ufb01ltering Phys. Rev. E 65 016206 New Journal of Physics 11 (2009) 053012 (http:\/\/www.njp.org\/)10","cites":null},{"id":916254,"title":"for Population Ecology,","authors":[],"date":"1999","doi":null,"raw":"NERC Centre for Population Ecology, Imperial College 1999 The Global Population Dynamics Database Record 3987 http:\/\/www.sw.ic.ac.uk\/cpb\/gpdd.html","cites":null},{"id":16707935,"title":"HanskiI,TurchinP,Korpim\u00e4kiEandHenttonenH1993Populationoscillationsofborealrodents\u2014regulation by muscelid predators leads to chaos","authors":[],"date":null,"doi":null,"raw":"HanskiI,TurchinP,Korpim\u00e4kiEandHenttonenH1993Populationoscillationsofborealrodents\u2014regulation by muscelid predators leads to chaos Nature 364 232\u20135","cites":null},{"id":913355,"title":"Helioseismology Rev.","authors":[],"date":"2002","doi":null,"raw":"Christensen-Dalsgaard J 2002 Helioseismology Rev. Mod. Phys. 74 1073\u2013129","cites":null},{"id":915469,"title":"I and Wentzel A D","authors":[],"date":"1984","doi":null,"raw":"Freidlin M I and Wentzel A D 1984 Random Perturbations in Dynamical Systems (New York: Springer)","cites":null},{"id":914666,"title":"Incorporating multiple sources of stochasticity into dynamic population models","authors":[],"date":"2003","doi":null,"raw":"Calder C, Lavine M, M\u00fcller P and Clark J S 2003 Incorporating multiple sources of stochasticity into dynamic population models Ecology 84 1395\u2013402","cites":null},{"id":916031,"title":"Large \ufb02uctuations and \ufb02uctuational transitions in systems driven by colored Gaussian noise\u2014a high frequency noise Phys.","authors":[],"date":"1990","doi":null,"raw":"Dykman M I 1990 Large \ufb02uctuations and \ufb02uctuational transitions in systems driven by colored Gaussian noise\u2014a high frequency noise Phys. Rev. A 42 2020\u20139","cites":null},{"id":913816,"title":"Likelihood-based estimation of continuous-time epidemic models from time-series data: application to measles transmission in London","authors":[],"date":"2008","doi":null,"raw":"Cauchemez S and Ferguson N M 2008 Likelihood-based estimation of continuous-time epidemic models from time-series data: application to measles transmission in London J. R. Soc. Interface 5 885\u201397","cites":null},{"id":912844,"title":"Living on the edge of chaos: population dynamics of Fennoscandian voles","authors":[],"date":"2000","doi":null,"raw":"Turchin P and Ellner S P 2000 Living on the edge of chaos: population dynamics of Fennoscandian voles Ecology 81 3099\u2013116","cites":null},{"id":915017,"title":"Nonlinear dynamical system identi\ufb01cation from uncertain and indirect measurements","authors":[],"date":"2004","doi":null,"raw":"Voss H U, Timmer J and Kurths J 2004 Nonlinear dynamical system identi\ufb01cation from uncertain and indirect measurements Int. J. Bifurcation Chaos 14 1905\u201333","cites":null},{"id":911762,"title":"Ocean circulation and climate during the past 120 000 years","authors":[],"date":"2002","doi":null,"raw":null,"cites":null},{"id":16707934,"title":"Ocean circulation and climate during the past 120000 years","authors":[],"date":"2002","doi":null,"raw":"Rahmstorf S 2002 Ocean circulation and climate during the past 120000 years Nature 419 207\u201314","cites":null},{"id":16707984,"title":"OsipovVV,LuchinskyDG,SmelyanskiyVNandTimucinDA2007Casebreachfaultmodelanddiagnostic for the solid rocket AIAA 2007-5823,","authors":[],"date":"2007","doi":null,"raw":"OsipovVV,LuchinskyDG,SmelyanskiyVNandTimucinDA2007Casebreachfaultmodelanddiagnostic for the solid rocket AIAA 2007-5823, 2007 43rd AIAA\/ASME\/SAE\/ASEE Joint Propulsion Conf. and","cites":null},{"id":914155,"title":"Parameter estimation in continuous-time dynamic models using principal differential analysis Comput.","authors":[],"date":"2006","doi":null,"raw":"Poyton A A, Varziri M S, McAuley K B, McLellan P J and Ramsay J O 2006 Parameter estimation in continuous-time dynamic models using principal differential analysis Comput. Chem. Eng. 30 698\u2013708","cites":null},{"id":912582,"title":"Population cycles of mammals\u2014evidence for a ratio-dependent predation hypothesis Ecol.","authors":[],"date":"1992","doi":null,"raw":"Akcakaya H R 1992 Population cycles of mammals\u2014evidence for a ratio-dependent predation hypothesis Ecol. Monogr. 62 119\u201342","cites":null},{"id":912018,"title":"Population oscillations of boreal rodents\u2014regulation by muscelid predators leads to chaos","authors":[],"date":"1993","doi":null,"raw":null,"cites":null},{"id":912255,"title":"Small-rodent dynamics and predation","authors":[],"date":"2001","doi":null,"raw":"Hanski I, Henttonen H, Korpima\u00e4ki E, Oksanen L and Turchin P 2001 Small-rodent dynamics and predation Ecology 82 1505\u201320","cites":null},{"id":917157,"title":"Stefanovska A and McClintock","authors":[],"date":"2005","doi":"10.1103\/PhysRevLett.94.098101","raw":"Smelyanskiy V N, Luchinsky D G, Stefanovska A and McClintock P V E 2005 Inference of a nonlinear stochastic model of the cardiorespiratory interaction Phys. Rev. Lett. 94 098101","cites":null},{"id":914933,"title":"The case for chaos in childhood epidemics. II. Predicting historical epidemics from mathematical models","authors":[],"date":"1993","doi":null,"raw":"Tidd C W, Olsen L F and Schaffer W M 1993 The case for chaos in childhood epidemics. II. Predicting historical epidemics from mathematical models Proc. R. Soc. B 254 257\u201373","cites":null},{"id":914169,"title":"Timuchin D A and Bandrivskyy A","authors":[],"date":"2005","doi":null,"raw":"Smelyanskiy V N, Luchinsky D G, Timuchin D A and Bandrivskyy A 2005 Reconstruction of stochastic nonlinear dynamical models from trajectory measurements Phys. Rev. E 72 026202","cites":null},{"id":916529,"title":"Vole stranglers and lemming cycles","authors":[],"date":"2003","doi":"10.1126\/science.1092366","raw":"Hudson P J and Bjornstad O N 2003 Vole stranglers and lemming cycles Science 302 797\u20138","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2009-05","abstract":"A Hamiltonian approach is introduced for the reconstruction of trajectories and models of complex stochastic dynamics from noisy measurements. The method converges even when entire trajectory components are unobservable and the parameters are unknown. It is applied to reconstruct nonlinear models of rodent\u2013predator oscillations in Finnish Lapland and high-Arctic tundra. The projected character of noisy incomplete measurements is revealed and shown to result in a degeneracy of the likelihood function within certain null-spaces. The performance of the method is compared with that of the conventional Markov chain Monte Carlo (MCMC) technique","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/68769.pdf","fullTextIdentifier":"http:\/\/eprints.lancs.ac.uk\/31239\/1\/NJP2009LostInfo.pdf","pdfHashValue":"98c99955e9615a5032088c65b3162add51b9f6cd","publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lancs.ac.uk:31239<\/identifier><datestamp>\n      2018-01-24T02:55:04Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D51:5143<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        Recovering \u2018lost\u2019 information in the presence of noise: application to rodent\u2013predator dynamics.<\/dc:title><dc:creator>\n        Smelyanskiy, V. N.<\/dc:creator><dc:creator>\n        Luchinsky, D. G.<\/dc:creator><dc:creator>\n        Millonas, M. M.<\/dc:creator><dc:creator>\n        McClintock, P. V. E.<\/dc:creator><dc:subject>\n        QC Physics<\/dc:subject><dc:description>\n        A Hamiltonian approach is introduced for the reconstruction of trajectories and models of complex stochastic dynamics from noisy measurements. The method converges even when entire trajectory components are unobservable and the parameters are unknown. It is applied to reconstruct nonlinear models of rodent\u2013predator oscillations in Finnish Lapland and high-Arctic tundra. The projected character of noisy incomplete measurements is revealed and shown to result in a degeneracy of the likelihood function within certain null-spaces. The performance of the method is compared with that of the conventional Markov chain Monte Carlo (MCMC) technique.<\/dc:description><dc:date>\n        2009-05<\/dc:date><dc:type>\n        Journal Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/eprints.lancs.ac.uk\/31239\/1\/NJP2009LostInfo.pdf<\/dc:identifier><dc:relation>\n        http:\/\/dx.doi.org\/10.1088\/1367-2630\/11\/5\/053012<\/dc:relation><dc:identifier>\n        Smelyanskiy, V. N. and Luchinsky, D. G. and Millonas, M. M. and McClintock, P. V. E. (2009) Recovering \u2018lost\u2019 information in the presence of noise: application to rodent\u2013predator dynamics. New Journal of Physics, 11, 05. ISSN 1367-2630<\/dc:identifier><dc:relation>\n        http:\/\/eprints.lancs.ac.uk\/31239\/<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/dx.doi.org\/10.1088\/1367-2630\/11\/5\/053012","http:\/\/eprints.lancs.ac.uk\/31239\/"],"year":2009,"topics":["QC Physics"],"subject":["Journal Article","PeerReviewed"],"fullText":"T h e  o p e n \u2013 a c c e s s  j o u r n a l  f o r  p h y s i c s\nNew Journal of Physics\nRecovering \u2018lost\u2019 information in the presence of\nnoise: application to rodent\u2013predator dynamics\nV N Smelyanskiy1,5, D G Luchinsky2,3, M M Millonas4\nand P V E McClintock3\n1 NASA Ames Research Center, MS 269-2, Moffett Field, CA 94035, USA\n2 Mission Critical Technologies Inc., 2041 Rosecrans Ave. Suite 225\nEl Segundo, CA 90245, USA\n3 Department of Physics, Lancaster University, Lancaster LA1 4YB, UK\n4 CardioPrint Biometrics Inc., 170 Boulder Brook Dr., Boulder Creek,\nCA 95006, USA\nE-mail: Vadim.N.Smelyanskiy@nasa.gov, d.luchinsky@lancaster.ac.uk,\nmillonas@cardioprint.com and p.v.e.mcclintock@lancaster.ac.uk\nNew Journal of Physics 11 (2009) 053012 (10pp)\nReceived 17 February 2009\nPublished 27 May 2009\nOnline at http:\/\/www.njp.org\/\ndoi:10.1088\/1367-2630\/11\/5\/053012\nAbstract. A Hamiltonian approach is introduced for the reconstruction\nof trajectories and models of complex stochastic dynamics from noisy\nmeasurements. The method converges even when entire trajectory components\nare unobservable and the parameters are unknown. It is applied to reconstruct\nnonlinear models of rodent\u2013predator oscillations in Finnish Lapland and high-\nArctic tundra. The projected character of noisy incomplete measurements is\nrevealed and shown to result in a degeneracy of the likelihood function within\ncertain null-spaces. The performance of the method is compared with that of the\nconventional Markov chain Monte Carlo (MCMC) technique.\n5 Author to whom any correspondence should be addressed.\nNew Journal of Physics 11 (2009) 053012\n1367-2630\/09\/053012+10$30.00 \u00a9 IOP Publishing Ltd and Deutsche Physikalische Gesellschaft\n2Contents\n1. Introduction 2\n2. A problem in ecology 3\n3. Hamiltonian formalism for dynamical inference 4\n3.1. General solution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4\n3.2. Application to the ecological problem . . . . . . . . . . . . . . . . . . . . . . 5\n4. Validation of the new dynamical inference approach 7\n5. Conclusion 8\nAcknowledgments 9\nReferences 9\n1. Introduction\nMeasurements of complex (multidimensional, nonlinear) stochastic dynamical systems are\noften missing essential information about the dynamical model and system trajectory\n(hidden variables). For historic time series where measurements cannot be repeated, missing\ninformation can be considered \u2018lost\u2019. Examples include: reconstruction of hidden variables\nof climate evolution [1] from observable isotope concentrations; fluctuations in predator\u2013prey\ncommunities [2]\u2013[6]; and coupled matter radiation systems [7]. How to reconstruct missing\ninformation about a stochastic dynamical model, including the full system trajectory, from\nincomplete noisy measurements is an unresolved scientific conundrum of long standing.\nRecently, this problem has received considerable attention. A particle filter approach [8]\nand the Markov chain Monte Carlo (MCMC) approach [9] were applied successfully to\nreconstruct the model parameters alone. A simplified version, with all the dynamical variables\nmeasured directly, was considered in [10]\u2013[13] using Bayesian and log-likelihood approaches.\nIn the absence of measurement noise, attractor reconstruction [14] in time-delayed variables was\nused [5] to infer model parameters; in the absence of dynamical noise, shooting and recursive\napproaches were applied to reconstruct both the parameters and the trajectory [15]. The problem\nhas remained unresolved, however, for the practically important case where hidden dynamical\nvariables, measurement noise and dynamical noise all coexist together. In this case, unknown\ndynamical model parameters are trading against hidden trajectory components within certain\nnull-spaces leading to a quasi-degenerate likelihood function with a very complex \u2018landscape\u2019\nand numerous local minima (cf [15]).\nIn what follows, we present a solution of this general problem based on a novel Hamiltonian\nformalism derived from the first principles of stochastic dynamics [16]\u2013[19] within the\nmaximum likelihood estimation (MLE) framework. The key result is the discovery of the\nHamiltonian equations underlying the MLE problem, by analogy with the Wentzel\u2013Friedlin\ntheory [17] of large fluctuations. It reveals the complex structure of the likelihood and provides\nfor robust convergence. We apply it to the analysis of an archetypical problem in nonlinear\ndynamics and statistics: noise-driven rodent\u2013predator oscillations [2, 3, 5, 6] for which the\npredator population could not in practice be observed. We show that, contrary to earlier\nbeliefs [2, 3, 5, 6], noise-corrupted measurements of the prey dynamics alone are a sufficient\nbasis for computing both the likelihood of the predator population and the ecological model\nparameters. We compare the performance of the method with that of the conventional [12, 13]\nNew Journal of Physics 11 (2009) 053012 (http:\/\/www.njp.org\/)\n31955 1965 1975 1985\n0\n10\n20\n30\n40\nYear\nN\n\u2032 (\nha\n   \n)\n\u2212\n1\n(a) \n1955 1965 1975 1985\n0\n0.1\n0.2\n0.3\n0.4\n0 0.05 0.1\n0\n20\n40\nPopulation\nD\nis\ntr\nib\nut\nio\nn\n(b) \nP\n (\nha\n  \n)\n\u2212\n1\nYear\nFigure 1. (a) Measured population dynamics of small rodents in Finnish\nLapland, 1952\u20131992 [20] (yellow dots) and the solution of the optimization\nproblem (dashed line). (b) The hidden dynamics of the specialist predator\npopulation, recovered by use of (1). The inset shows a cross section of the\nweighted distribution of dynamical trajectories for 1956 (arrow in main figure).\nMCMC technique. Our formalism promises to be useful, not only for the analysis of population\ndynamics with hidden variables (see e.g. several thousand time series in the database [20]), but\nalso in many other disciplines and contexts.\n2. A problem in ecology\nFigure 1(a) plots N (t) time-series data (points) for a rodent (prey) population density in\nFinnish Lapland [20]. Such cyclic behavior among small mammalian species has preoccupied\npopulation ecologists for decades. Perhaps on account of its stochastic multiannual quasi-\nperiodicity, and difficulties in measuring predator numbers, there is still no agreement on the\nmechanisms of oscillation, nor of the reasons why some populations are cyclic and others are not\n(e.g. noncyclic lemming populations in Arctic Canada [2, 3, 21]). In these settings, the ability to\ndiscriminate between various models by inferring both the model and the unobserved population\nis especially useful. In the example we consider here, the problem is to use a limited number (80)\nof noise-corrupted measurements to recover both the unmeasured predator population density\nP(t) and the underlying nonlinear stochastic dynamical model. To solve it, we introduce a\nHamiltonian approach. In doing so, we chose from among the various predation models [2, 3]\none that distinguishes between the specialist and generalist predators that respectively promote\nand suppress the cyclic behavior. This particular model explains many observed features of\nrodent\u2013predator dynamics and can be written as [2, 3, 5]\n\u02d9N = r N fn(\u03c3n, t)\u2212 r N\n2\nk\n\u2212 g N\n2\nN 2 + h2\n\u2212 c N P\nN + d\n,\n\u02d9P = s P f p(\u03c3p, t)\u2212 s q P2 N\u22121.\n(1)\nFunctions fn,p(\u03c3n,p, t)= (1\u2212 en,p sin(2pi t +\u03c6n,p)+ \u03c3n,p\u03ben,p(t)) in (1) represent the modulation\nof the birth rate by periodic (seasonal) and stochastic forcing with amplitudes en,p and \u03c3n,p\nrespectively, and \u03c6n,p are unknown phase shifts of periodic forcing. \u03ben,p(t) are mutually\nNew Journal of Physics 11 (2009) 053012 (http:\/\/www.njp.org\/)\n4uncorrelated zero-mean white Gaussian dynamical noise sources; r and s are, respectively,\nthe intrinsic rates of prey and predator growth; k is the habitat\u2019s prey-carrying capacity, which\ndetermines the saturation level of the prey population in the absence of predators. The effect\nof generalist predators (e.g. foxes) whose population does not change with N is encapsulated\nwithin the term \u221d N 2 with coefficient g (maximum mortality rate). The effect of the specialist\npredators (small mustelids) believed to maintain the oscillatory prey dynamics is described by\nthe term \u221d N P , with maximum killing rate c. However, the predator population is notoriously\ndifficult to study in the field, so that the corresponding density P(t) is an unmeasured (hidden)\nvariable. The measured rodent density N \u2032(t) is related to the actual (unknown) value N (t) via\nN \u2032 = Ne\u03c3 obs\u03b7(t) where \u03b7(t) is white Gaussian measurement noise of unit intensity.\nThe precise functional forms are known neither for predation nor for the predator\nresponse, and some modifications of equations (1) have been considered [5]. By a change of\nvariables x1(t)= log(N (t)\/k \u2032), x2(t)= log(q \u2032P\/k \u2032) (for known nominal values of the scaling\ncoefficients k \u2032 and q \u2032) the predator\u2013prey and the measurement equations are transformed into a\nstandard [8]\u2013[15] form with noise entering the equations only additively\nx\u02d9i(t)= Ki(x(t), c)+ \u03bei(t), ym =\nL\u2211\ni=1\nBmi xi +\u03b2m. (2)\nHere x(t)={xi(t)}Li=1 and {ym(t)}Mm=1 are the state vector trajectory and observed time series,\nrespectively. The existence of hidden variables implies that M < L (L = 2 and M = 1 in (1)).\n{Ki}Li=1 are components of a drift vector field with (unknown) model parameters c =\n{c1, . . .} and Bmi is an M \u00d7 L measurement matrix. \u03bei(t) and {\u03b2m(t)} are zero-mean\ncomponents of white Gaussian processes characterized by L \u00d7 L and M \u00d7 M correlation\nmatrixes D\u02c6 and N\u02c6, respectively (M 6 L). The stochastic model (2) is characterized by\nthe full set of unknown parameters M\u2261 {c, B\u02c6, D\u02c6, N\u02c6}. For our particular problem M=\n{r, s, e1, e2, k, g, c, q, h, d, \u03c6n, \u03c6p, \u03c3n, \u03c3p, \u03c3obs}, the measurement matrix Bi j = \u03b4i1\u03b4 j1, and the\nvector fields are\nK1 = r fn(\u03c3n, t)\u2212 rk\n\u2032\nk\nex1 \u2212 (g\/k\n\u2032) ex1\ne2x1 + (h\/k \u2032)2\n\u2212 (c\/q\n\u2032) ex2\nex1 + d\/k \u2032\n, K2 = s f p(\u03c3p, t)\u2212 s qq \u2032 e\nx\u2212x1 .\nThe standard form (2) represents a generalization that can be applied to a great variety of\nstochastic dynamical model reconstruction problems with hidden variables.\n3. Hamiltonian formalism for dynamical inference\n3.1. General solution\nWe now formulate the general inference problem of finding unknown model parametersM and\nunobserved trajectory components (here x2(t)) in probabilistic terms. A key statistical quantity\nis the likelihood probability density functional (LPDF), which is proportional (within the MLE\nframework) to the posterior distribution PY[x(t);M] representing the joint probability density\nthat the system trajectory is x(t) and that the system parameter values are M, conditioned\non the observed time series Y = {y(tm), tm = m h}Km=1. It can be written as PY[x(t);M] =\nAY exp (\u2212SY[x(t);M]), where AY is a normalization constant. A negative log-likelihood\nNew Journal of Physics 11 (2009) 053012 (http:\/\/www.njp.org\/)\n5functional SY[x(t);M] can then be found using the path-integral approach to fluctuational\ndynamics [18, 19], as\nSY = 12\n\u222b T\n0\ndt\n(Lyx +Lx)+ K2 ln det D\u02c6N\u02c6. (3)\nHere Lyx = [y\u2212 B\u02c6 x]T N\u02c6\u22121[y\u2212 B\u02c6 x] and Lx = [x\u02d9\u2212K(x, c)]T D\u02c6\u22121[x\u02d9\u2212K(x, c)] + \u2202K(x,c)\u2202x with\nx = x(t), y = y(t). Also T = Kh where K is the number of data points, h is the sampling time,\nand M 6 L implying the existence of hidden variables. Despite the hidden dynamical variables\nnot being measured directly, the functional SY (3) contains the dynamical coupling between\nthe variables via the force fields Ki(x1, x2). If the measurements provide information sufficient\nto pin down both the key model parameters of the system and its trajectory, the joint LPDF\nPY will be well localized in the vicinity of its maximum, thus revealing the most probable\ntrajectory x\u2217(t) and the parameter valuesM\u2217 that minimize the functional SY for a given set of\nmeasurements Y .\nWe solve this variational problem by introducing a new paradigm in which SY is viewed\nas the mechanical action of an auxiliary Hamiltonian system with coordinate x, momentum\np = D\u02c6\u22121(x\u02d9(t)\u2212K) and a Hamiltonian function H(x,p)\nH(x,p)=\u2212(1\/2)\n[\n(y\u2212 B\u02c6 x)T N\u02c6\u22121(y\u2212 B\u02c6 x)\u2212 \u2202K\/\u2202x + 2Kp + pT D\u02c6 p\n]\n. (4)\nThe extremum of SY in the joint space (x(t),M) is then found by solving the coupled\nvariational problems\n\u03b4SY\/\u03b4x(t)= 0, \u2202SY\/\u2202M= 0. (5)\nThe first condition corresponds to a solution of the boundary value problem (BVP) for the\nHamiltonian equations\nx\u02d9 = K + D\u02c6p,\np\u02d9 = 1\n2\n\u22022K\n\u2202x2\n\u2212 \u2202K\n\u2202x\np\u2212 (y\u2212 B\u02c6 x)T N\u02c6\u22121B\u02c6\n(6)\nsatisfying the boundary conditions p(0)= p(t)= 0. This BVP can be solved very efficiently\nusing, e.g. the results of [22]. An interesting general property of this solution is that the\ndifference between measured data y(t) and x(t) is fedback in the last term of the second equation\nin (6). This term effectively acts as a \u2018control force\u2019 of an amplitude inversely proportional to\nthe measurement noise intensity driving the x(t) towards its most probable value at a fixed M.\nWe then fix the inferred trajectory x(t) and update the values of the parameters in the set M,\nusing an analytic solution [11] of the second variational problem, \u2202SY\n\u2202M = 0. This procedure\nis iterated until the desired convergence is achieved. The outcome is the most probable\nsystem trajectory x\u2217(t) and set of model parameters M\u2217 providing a minimum of the action\nfunctional SY . It corresponds to a point p\u2217=(x\u2217(t),M\u2217) in the joint trajectory\u2013parameter space.\n3.2. Application to the ecological problem\nNote that the accuracy of the presentation (3) depends strongly on the sampling rate 1\/h.\nFor the particular ecological problem (1), it was possible to simulate densely-sampled data by\nNew Journal of Physics 11 (2009) 053012 (http:\/\/www.njp.org\/)\n60\n5\n10\n\u221210\n\u22125\n0\n0\n0.2\n0.4\nrk \u2032\/k\nr\n\u03c1(\nr,\nrk\n\u2032\/k\n)\n(a)\n\u22120.2\n0.8\n1.8\n2.5\n\u22122.5\n\u22121.5\n\u22120.5\n0.5\n0\n10\n20\nsq\/q \u2032\nsq\/q \u2032\ns\n\u03c1(\ns,\nsq\n\/q\n\u2032) (b)\n0\n5\n10\n\u221210\n\u22125\n0\n0\n500\n1000\n\u2212rk \u2032\/kr\nS\nY\n(r\n,r\nk\u2032\n\/k\n)\n(c)\n0\n1\n2\n\u22122\n\u22121\n0\n0\n40\n80\ns\nS\nY\n(s\n,s\nq\n\/q\n\u2032) (d)\nFigure 2. Weighted distributions of the inferred values of the model parameters:\n(a) r and rk \u2032\/k and (b) s and sq\/q \u2032, and the corresponding action functions\n(c) SY(r, rk \u2032\/k) and (d) SY(s, sq\/q \u2032). Their likelihood distributions are well\nlocalized around expected values r = 5.69\u00b1 0.49, k = 76\u00b1 17, s = 1.08\u00b1 0.31,\nq = 43\u00b1 22, g = 0.12\u00b1 0.3, e1 = 1.4\u00b1 0.4, e2 = 1.0\u00b1 0.5 which are close to\nthe values considered in the earlier ecological research. The projections of the\npoints p\u2217 onto the two-dimensional (2D) parameter planes are shown in the top\nplanes of (a) and (b) by black dots.\nintroducing a spline interpolation of the experimental points. Convergence was guaranteed by\nthe fact that the data set has nine points per period of oscillation.\nNext, we note that in the presence of hidden variables slight changes in the model\nparameters can lead to significant changes in the system\u2019s trajectory, giving rise to a complex\nshape for SY . This is the case for the problem in hand because, with a periodic driving force,\n(1) can undergo a transition to chaos as the system parameters vary [2, 5]. To investigate the\nshape of SY we define a window of possible values for each model parameter within the set\nof plausible parameter ranges elucidated in earlier research [2, 3, 5, 6]. For many parameters\nthe windows are very broad. We show some of them as rectangular planes in figure 2. Starting\nfrom a random point inside the predefined range we find a point p\u2217 corresponding to one of the\nsolutions of the dual variational problem (5). Random restarts are needed if there is (as in our\ncase) more than one solution p\u2217. Projections of the points p\u2217 onto the 2D parameter plains and\ncorresponding 3D plots of the LPDF and SY are shown in figure 2.\nNew Journal of Physics 11 (2009) 053012 (http:\/\/www.njp.org\/)\n7For example figure 2(a) shows the projection of the LPDF on the plane of parameters\n(r, rk \u2032\/k). In this figure, all the parameters except parameters r and rk \u2032\/k are kept fixed\nat their mean values. Parameters (r, rk \u2032\/k) are then chosen from the uniform distribution\nshown in the background of the figure. After one step of the double optimization procedure\ndescribed above, the optimal values of the trajectory and parameters r and rk \u2032\/k are obtained\np\u2217 = (x\u2217(t), r\u2217, (rk \u2032\/k)\u2217) and the corresponding value of the cost function S\u2217Y(p\u2217) is calculated.\nThe procedure is repeated N = 20 000 times. Then the projection of the LPDF surface on the\n(r, rk \u2032\/k) plane (figure 2(a)) is found as follows:\nP\u2217Y,i j =\n\u03c1i j exp(\u2212S\u2217Y,i j)\u2211I,J\ni, j=1 \u03c1i j exp(\u2212S\u2217Y,i j)dri d(rk \u2032\/k) j\n,\n\u03c1i j exp(\u2212S\u2217Y,i j)=\nNi j\u2211\nm=1\nexp(\u2212S\u2217Y(p\u2217,m)),\n(7)\nwhere \u03c1i j is the density of points in the bin (i j), S\u2217Y,i j is the mean value of the cost function\nin this bin, Ni j is the subset of N found in the bin (i j), I = 60 and J = 40 are the number of\nbins in r and rk \u2032\/k directions, and dri d(rk\/k \u2032j) is the size (area) of the bin. The corresponding\nprojection of the cost function (figure 2(c)) is found as\nS\u2217Y,i j(p\u2217)=\n\u03c1i j(p\u2217)S\u2217Y,i j(p\u2217)\n\u2212 log\n(\u2211I,J\ni, j=1 \u03c1i j(p\u2217) exp(\u2212S\u2217Y,i j(p\u2217))dri d(rk \u2032\/k) j\n) ,\n\u03c1i j S\u2217Y,i j =\nNi j\u2211\nm=1\nS\u2217Y(p\u2217,m).\n(8)\nProjections of the LPDF and cost functions on the plane (s, sq\/q \u2032) (figures 2(b) and (d)) are\nfound in a similar way.\nIt can be seen in the density plots that the LPDF has a very steep localized ridge\nwhose top forms a \u2018line\u2019 R= {p`\u2217} = {(x`\u2217(t),M`\u2217} in the joint parameter\u2013trajectory space.\nFluctuations along R are large and non-Gaussian, while fluctuations transverse to the ridge top\nare strongly suppressed (figure 2). The mechanical action along R varies slightly, each point\non R corresponding approximately to a solution of (5). This difference in scales of fluctuations\nand the quasi-degenerate forms of SY and LPDF can be attributed to the projective character\nof the measurements with M < L: they are incapable of resolving certain tradeoffs between\nthe parameters and hidden trajectory components. The different points along R correspond to\nquite different time traces of the hidden trajectory component (predator oscillations shown in\nfigure 1(b)) but they all fit very well to the set of prey population observations. Such tradeoffs are\nintrinsic to any given model and their understanding is crucial for experts applying the technique\nfor data interpretation and model discovery.\n4. Validation of the new dynamical inference approach\nNext, we validate the approach by applying it to the inference of population dynamics in a\nstoat\u2013lemming community [6] and by comparing it to the MCMC method. The corresponding\ndata (figure 3) are similar to the earlier set [5] but with an important difference: the dynamics\nof both populations, prey N (t) and predator P(t), were recorded. We assume initially, however,\nNew Journal of Physics 11 (2009) 053012 (http:\/\/www.njp.org\/)\n81988 1992 1996\n4\n8\n12\n(a) \nLe\nm\nm\nin\ng \n(in\ndi\nvi\ndu\nal\ns \nha\n\u20131\n)\nYear 1988 1992 1996\n0\n0.02\n0.04\n0.06\n(b) \nS\nto\nat\n (\nin\ndi\nvi\ndu\nal\ns \nha\n\u20131\n) \nYear \nFigure 3. Populations of (a) lemmings and (b) stoats (individuals ha\u22121) observed\nin the high-Arctic tundra (1988\u20132002) [6] are shown by yellow ellipses. Jagged\nthin solid lines show the initial guesses for each population. Dash-dot (red)\nlines show the population dynamics inferred from (1) using the Hamiltonian\napproach and assuming that only the lemming population was recorded, with\na measurement error of 0.1, while the stoat dynamics remained hidden. Dashed\n(blue) lines are from MCMC after 40 000 iterations of the whole trajectory, under\nthe same assumption.\nthat only the prey population was measured, and subsequently compare the inferred predator\npopulation with the measured one. The dynamical model [6] for this community is rather\nelaborate. However, given the close similarity between the two communities it is instructive\nto perform such a comparison treating (1) as a simplified model. Our results are shown in\nfigure 3: the measured predator trajectory is reproduced, including the correct slope and scale\nof the oscillations, unlike the earlier simulations [6]. With sufficient care, the MCMC using a\nGibbs sampler with the Metropolis\u2013Hastings steps method can show comparable performance.\nWe have found for a number of models, however, that convergence of the Hamiltonian method\nis faster and more robust with respect to the initial conditions due to the existence of local\nminima corresponding to nonsmooth time functions P\u2217(t). These local minima slow down the\nconvergence of the MCMC algorithm (see e.g. dashed blue curve in figure 3), but are excluded\nfrom the start in our Hamiltonian approach (4)\u2013(6).\n5. Conclusion\nIn conclusion, our Hamiltonian approach facilitates inference of parameters and hidden\n(unobserved) trajectory components of a nonlinear dynamical model in the presence of\ndynamical noise and measurement errors. The application of the method to ecological problems\nleads to the conclusion that a lack of observational data for predator populations need no longer\nconstitute a fundamental obstacle to the inference of hidden population dynamics and ecological\nparameters from noisy measurements [2, 3, 5, 6]. The key limitation of the proposed method\nis that it relies on the Euler approximation in derivation of the cost function. Correspondingly,\nthe accuracy of this approximation depends strongly on the sampling rate, which has to be\ndense enough. Here, we simulated dense sampling by spline interpolation and convergence\nNew Journal of Physics 11 (2009) 053012 (http:\/\/www.njp.org\/)\n9was guaranteed by the data set having nine periods of population oscillation with nine points\nper period. Note, however, that the convergence of the BVP solution does not require dense\nsampling and in the future the restrictions on the sampling density can be relaxed. In general,\nthe dependence of the uncertainty of inference on the number of data points is nontrivial in\ncharacter and will be discussed in detail elsewhere. The method has allowed us to reveal a\nquasi-degeneracy of the log-likelihood along a hyperplane R in the joint parameters\u2013trajectory\nspace. The existence and shape of R reflects tradeoffs between parameters r and k \u2032\/k (s and\nq\/q \u2032) on one hand, and hidden trajectory components on the other. Importantly, our procedure,\nunlike MCMC, avoids sampling in the trajectory space. Instead, it relies on a continuous-in-time\nsolution of the deterministic auxiliary problem (6), thereby exploiting recent advances [22] in\ntackling the BVP. The method will also be applicable quite generally to cases where some\nstate variables could not be recorded, e.g. those mentioned in the introduction [1, 23]. It\ncould be particularly useful in the context of physiological measurements relating difficult-\nto-access parameters to noninvasively measured data [24], and to cases where dynamical\nvariables are intrinsically hidden and cannot be measured experimentally, even in principle:\ne.g. flow parameters in aerospace applications [25] and susceptible and exposed populations in\nepidemiology [23].\nAcknowledgments\nWe acknowledge support from NASA and the Engineering and Physical Sciences Research\nCouncil (UK).\nReferences\n[1] Rahmstorf S 2002 Ocean circulation and climate during the past 120 000 years Nature 419 207\u201314\n[2] Hanski I, Turchin P, Korpim\u00e4ki E and Henttonen H 1993 Population oscillations of boreal rodents\u2014regulation\nby muscelid predators leads to chaos Nature 364 232\u20135\n[3] Hanski I, Henttonen H, Korpima\u00e4ki E, Oksanen L and Turchin P 2001 Small-rodent dynamics and predation\nEcology 82 1505\u201320\n[4] Akcakaya H R 1992 Population cycles of mammals\u2014evidence for a ratio-dependent predation hypothesis\nEcol. Monogr. 62 119\u201342\n[5] Turchin P and Ellner S P 2000 Living on the edge of chaos: population dynamics of Fennoscandian voles\nEcology 81 3099\u2013116\n[6] Gilg O, Hanski I and Sittler B 2003 Cyclic dynamics in a simple vertebrate predator\u2013prey community Science\n302 866\u20138\n[7] Christensen-Dalsgaard J 2002 Helioseismology Rev. Mod. Phys. 74 1073\u2013129\n[8] Ionides E L, Breto C and King A A 2006 Inference for nonlinear dynamical systems Proc. Natl Acad. Sci.\nUSA 103 18438\u201343\n[9] Cauchemez S and Ferguson N M 2008 Likelihood-based estimation of continuous-time epidemic models\nfrom time-series data: application to measles transmission in London J. R. Soc. Interface 5 885\u201397\n[10] Poyton A A, Varziri M S, McAuley K B, McLellan P J and Ramsay J O 2006 Parameter estimation in\ncontinuous-time dynamic models using principal differential analysis Comput. Chem. Eng. 30 698\u2013708\n[11] Smelyanskiy V N, Luchinsky D G, Timuchin D A and Bandrivskyy A 2005 Reconstruction of stochastic\nnonlinear dynamical models from trajectory measurements Phys. Rev. E 72 026202\n[12] Meyer R and Christensen N 2001 Fast Bayesian reconstruction of chaotic dynamical systems via extended\nKalman filtering Phys. Rev. E 65 016206\nNew Journal of Physics 11 (2009) 053012 (http:\/\/www.njp.org\/)\n10\n[13] Calder C, Lavine M, M\u00fcller P and Clark J S 2003 Incorporating multiple sources of stochasticity into dynamic\npopulation models Ecology 84 1395\u2013402\n[14] Tidd C W, Olsen L F and Schaffer W M 1993 The case for chaos in childhood epidemics. II. Predicting\nhistorical epidemics from mathematical models Proc. R. Soc. B 254 257\u201373\n[15] Voss H U, Timmer J and Kurths J 2004 Nonlinear dynamical system identification from uncertain and indirect\nmeasurements Int. J. Bifurcation Chaos 14 1905\u201333\n[16] Congdon P 2001 Bayesian Statistical Modelling (Wiley Series in Probability and Statistics) (Chichester:\nWiley)\n[17] Freidlin M I and Wentzel A D 1984 Random Perturbations in Dynamical Systems (New York: Springer)\n[18] Graham R 1977 Covariant formulation of nonequilibrium statistical thermodynamics Z. Phys. B 26 397\u2013405\n[19] Dykman M I 1990 Large fluctuations and fluctuational transitions in systems driven by colored Gaussian\nnoise\u2014a high frequency noise Phys. Rev. A 42 2020\u20139\n[20] NERC Centre for Population Ecology, Imperial College 1999 The Global Population Dynamics Database\nRecord 3987 http:\/\/www.sw.ic.ac.uk\/cpb\/gpdd.html\n[21] Hudson P J and Bjornstad O N 2003 Vole stranglers and lemming cycles Science 302 797\u20138\n[22] Ascher U M, Mattheij R M M and Russel R D 1995 Numerical Solutions of Boundary Value Problems for\nOrdinary Differential Equations (Classics in Applied Mathematics) 2nd edn (Philadelphia: SIAM)\n[23] Earn D J D, Levin S A and Rohani P 2000 Coherence and conservation Science 290 1360\u20134\n[24] Smelyanskiy V N, Luchinsky D G, Stefanovska A and McClintock P V E 2005 Inference of a nonlinear\nstochastic model of the cardiorespiratory interaction Phys. Rev. Lett. 94 098101\n[25] Osipov V V, Luchinsky D G, Smelyanskiy V N and Timucin D A 2007 Case breach fault model and diagnostic\nfor the solid rocket AIAA 2007-5823, 2007 43rd AIAA\/ASME\/SAE\/ASEE Joint Propulsion Conf. and\nExhibit (8\u201311 July 2007, Cincinnati, OH)\nNew Journal of Physics 11 (2009) 053012 (http:\/\/www.njp.org\/)\n"}