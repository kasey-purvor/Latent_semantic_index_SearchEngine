{"doi":"10.1186\/1471-2288-11-4","coreId":"195984","oai":"oai:lra.le.ac.uk:2381\/8131","identifiers":["oai:lra.le.ac.uk:2381\/8131","10.1186\/1471-2288-11-4"],"title":"Assessing methods for dealing with treatment switching in randomised controlled trials: a simulation study.","authors":["Morden, James P.","Lambert, Paul C.","Latimer, Nicholas","Abrams, Keith R.","Wailoo, Allan J."],"enrichments":{"references":[{"id":44733776,"title":"A class of multivariate failure time distributions. Biometrika","authors":[],"date":"1986","doi":"10.2307\/2336531","raw":"Hougaard P: A class of multivariate failure time distributions. Biometrika 1986, 73(3):671-678.","cites":null},{"id":44733782,"title":"Additive and multiplicative covariate regression models for relative survival incorporating fractional polynomials for time-dependent effects. Statistics in Medicine","authors":[],"date":"2005","doi":"10.1002\/sim.2399","raw":"Lambert P, Smith L, Jones D, Botha J: Additive and multiplicative covariate regression models for relative survival incorporating fractional polynomials for time-dependent effects. Statistics in Medicine 2005, 24:3871-3885.","cites":null},{"id":44733760,"title":"Adherence to treatment and health outcomes. Arch Intern Med","authors":[],"date":"1993","doi":"10.1001\/archinte.1993.00410160017001","raw":"Horwitz R, Horwitz S: Adherence to treatment and health outcomes. Arch Intern Med 1993, 153:1863-1868. Morden et al. BMC Medical Research Methodology 2011, 11:4 http:\/\/www.biomedcentral.com\/1471-2288\/11\/4 Page 19 of 20","cites":null},{"id":44733753,"title":"Adjusting treatment comparisons to account for non-randomized interventions: an example from an angina trial. Statistics in Medicine","authors":[],"date":"2003","doi":"10.1002\/sim.1369","raw":"White IR, Carpenter J, Pocock SJ, Henderson RA: Adjusting treatment comparisons to account for non-randomized interventions: an example from an angina trial. Statistics in Medicine 2003, 22(5):781-793.","cites":null},{"id":44733775,"title":"AG: Parametric randomization-based methods for correcting for treatment changes in the assessment of the causal effect of treatment. Statistics in Medicine","authors":[],"date":"2004","doi":"10.1002\/sim.1618","raw":"Walker AS, White IR, Babiker AG: Parametric randomization-based methods for correcting for treatment changes in the assessment of the causal effect of treatment. Statistics in Medicine 2004, 23(4):571-590.","cites":null},{"id":44733751,"title":"Analysis as-randomized and the problem of nonadherence - An example from the Veterans Affairs randomized trial of coronary-artery bypass-surgery. Statistics in Medicine","authors":[],"date":"1993","doi":"10.1002\/sim.4780121302","raw":"Peduzzi P, Wittes J, Detre K: Analysis as-randomized and the problem of nonadherence - An example from the Veterans Affairs randomized trial of coronary-artery bypass-surgery. Statistics in Medicine 1993, 12(13):1185-1195.","cites":null},{"id":44733757,"title":"Analysis of clinical trials by treatment actually received: is it really an option? Stat Med","authors":[],"date":"1991","doi":"10.1002\/sim.4780101011","raw":"Lee Y, Ellenberg J, Hirtz D, Nelson K: Analysis of clinical trials by treatment actually received: is it really an option? Stat Med 1991, 10:1595-1605.","cites":null},{"id":44733771,"title":"Babiker A: strbee: Randomization-based efficacy estimator.","authors":[],"date":"2002","doi":null,"raw":"White IR, Walker S, Babiker A: strbee: Randomization-based efficacy estimator. The Stata Journal 2002, 2(Number 2):140-150.","cites":null},{"id":44733777,"title":"Bivariate survival models induced by frailties.","authors":[],"date":"1989","doi":"10.1080\/01621459.1989.10478795","raw":"Oakes D: Bivariate survival models induced by frailties. Journal of the American Statistical Association 1989, 84(406):487-493.","cites":null},{"id":44733789,"title":"Comparison of Dynamic Treatment Regimes via Inverse Probability Weighting. Basic and Clinical Pharmacology and Toxicology","authors":[],"date":"2006","doi":"10.1111\/j.1742-7843.2006.pto_329.x","raw":"Hernan M, Lanoy E, Costagliola D, Robins J: Comparison of Dynamic Treatment Regimes via Inverse Probability Weighting. Basic and Clinical Pharmacology and Toxicology 2006, 98:237-242.","cites":null},{"id":44733781,"title":"De Stavola B: Cancer survival trends in England and Wales, 1971-1995: deprivation and NHS region Office of National Statistics;","authors":[],"date":"1999","doi":null,"raw":"Coleman M, Babb P, Damieckil P, Grosclaude P, Honjo S, Jones J, Knerer G, Pitard A, Quinn M, Sloggett A, De Stavola B: Cancer survival trends in England and Wales, 1971-1995: deprivation and NHS region Office of National Statistics; 1999.","cites":null},{"id":44733773,"title":"Estimating a treatment effect in survival studies in which patients switch treatment. Statistics in Medicine","authors":[],"date":"2002","doi":"10.1002\/sim.1219","raw":"Branson M, Whitehead J: Estimating a treatment effect in survival studies in which patients switch treatment. Statistics in Medicine 2002, 21:2449-2463.","cites":null},{"id":44733779,"title":"Gemcitabine for the treatment of metastatic breast cancer,","authors":[],"date":"2005","doi":"10.1016\/s0305-7372(05)80003-9","raw":"NICE: Gemcitabine for the treatment of metastatic breast cancer, (TA 116). TA 116 2005 [http:\/\/guidance.nice.org.uk\/TA116].","cites":null},{"id":44733780,"title":"Generating survival times to simulate Cox proportional hazards models. Statistics in Medicine","authors":[],"date":"2005","doi":"10.1002\/sim.2059","raw":"Bender R, Augustin T, Blettner M: Generating survival times to simulate Cox proportional hazards models. Statistics in Medicine 2005, 24:1713-1723.","cites":null},{"id":44733764,"title":"Goetghebeur E: A causal proportional hazards estimator for the effect of treatment actually received in a randomized trial with all-ornothing compliance. Biometrics","authors":[],"date":"2003","doi":"10.1111\/1541-0420.00012","raw":"Loeys T, Goetghebeur E: A causal proportional hazards estimator for the effect of treatment actually received in a randomized trial with all-ornothing compliance. Biometrics 2003, 59:100-105.","cites":null},{"id":44733761,"title":"JH: Impact of treatment changes on the interpretation of the Concorde trial. Aids","authors":[],"date":"1997","doi":"10.1097\/00002030-199708000-00008","raw":"White IR, Walker S, Babiker AG, Darbyshire JH: Impact of treatment changes on the interpretation of the Concorde trial. Aids 1997, 11(8):999-1006.","cites":null},{"id":44733762,"title":"Kaldor JM: Survival analyses of randomized clinical trials adjusted for patients who switch treatments. Statistics in Medicine","authors":[],"date":"1996","doi":"10.1002\/(sici)1097-0258(19961015)15:19<2069::aid-sim347>3.0.co;2-v","raw":"Law MG, Kaldor JM: Survival analyses of randomized clinical trials adjusted for patients who switch treatments. Statistics in Medicine 1996, 15:2069-2076.","cites":null},{"id":44733785,"title":"Letter to the editor: Estimating treatment effects in randomized trials with treatment switching.","authors":[],"date":null,"doi":"10.1002\/sim.2453","raw":"White IR: Letter to the editor: Estimating treatment effects in randomized trials with treatment switching. Statistics in Medicine 2006, 25:1619-1622.","cites":null},{"id":44733763,"title":"Letters to the editor: Survival analyses of randomized clinical trials adjusted for patients who switch treatments. Statistics in Medicine","authors":[],"date":"1997","doi":"10.1002\/(sici)1097-0258(19971130)16:22<2619::aid-sim699>3.0.co;2-x","raw":"White IR: Letters to the editor: Survival analyses of randomized clinical trials adjusted for patients who switch treatments. Statistics in Medicine 1997, 16:2619-2625.","cites":null},{"id":44733759,"title":"Loeys T: Beyond intention to treat. Epidemiologic Reviews","authors":[],"date":"2002","doi":"10.1093\/epirev\/24.1.85","raw":"Goetghebeur E, Loeys T: Beyond intention to treat. Epidemiologic Reviews 2002, 24:85-90.","cites":null},{"id":44733791,"title":"McNamee R: Performance of statistical methods for analysing survival data in the presence of non-random compliance. Statistics in Medicine","authors":[],"date":"2010","doi":"10.1002\/sim.4070","raw":"Odondi L, McNamee R: Performance of statistical methods for analysing survival data in the presence of non-random compliance. Statistics in Medicine 2010, 29:2994-3003.","cites":null},{"id":44733768,"title":"Model misspecification sensitivity analysis in estimating causal effects of interventions with non-compliance. Statistics in Medicine","authors":[],"date":"2002","doi":"10.1002\/sim.1267","raw":"Jo B: Model misspecification sensitivity analysis in estimating causal effects of interventions with non-compliance. Statistics in Medicine 2002, 21:3161-3181.","cites":null},{"id":44733769,"title":"Modelling survival data in medical research Chapman and Hall;","authors":[],"date":null,"doi":"10.1017\/s1357321700001173","raw":"Collett D: Modelling survival data in medical research Chapman and Hall;","cites":null},{"id":44733766,"title":"More powerful randomization-based p-values in double-blind trials with non-compliance. Statistics in Medicine","authors":[],"date":"1998","doi":"10.1002\/(sici)1097-0258(19980215)17:3<371::aid-sim768>3.0.co;2-o","raw":"Rubin D: More powerful randomization-based p-values in double-blind trials with non-compliance. Statistics in Medicine 1998, 17:371-385.","cites":null},{"id":44733778,"title":"on the use of capecitabine for the treatment of locally advanced or metastatic breast cancer,","authors":[],"date":"2003","doi":null,"raw":"NICE: Guidance on the use of capecitabine for the treatment of locally advanced or metastatic breast cancer, (TA 62). TA 62 2003 [http:\/\/ guidance.nice.org.uk\/TA62].","cites":null},{"id":44733787,"title":"Oxaliplatin and Raltitrexed for Advanced Colorectal Cancer (review of TA33).","authors":[],"date":"2005","doi":null,"raw":"NICE: Irinotecan, Oxaliplatin and Raltitrexed for Advanced Colorectal Cancer (review of TA33). TA 93 2005 [http:\/\/guidance.nice.org.uk\/TA93].","cites":null},{"id":44733786,"title":"Pocock SJ: Statistical reporting of clinical trials with individual changes from allocated treatment. Statistics in Medicine","authors":[],"date":"1996","doi":"10.1002\/(sici)1097-0258(19960215)15:3<249::aid-sim160>3.0.co;2-j","raw":"White IR, Pocock SJ: Statistical reporting of clinical trials with individual changes from allocated treatment. Statistics in Medicine 1996, 15(3):249-262.","cites":null},{"id":44733758,"title":"Post-randomisation exclusions: the intention to treat principle and excluding patients from analysis. BMJ","authors":[],"date":"2002","doi":"10.1136\/bmj.325.7365.652","raw":"Fergusson D, Aaron SD, Guyatt G, Herbert P: Post-randomisation exclusions: the intention to treat principle and excluding patients from analysis. BMJ 2002, 325:652-654.","cites":null},{"id":44733788,"title":"Principal Stratification in Causal Inference. Biometrics","authors":[],"date":"2002","doi":"10.1111\/j.0006-341x.2002.00021.x","raw":"Frangakis C, Rubin D: Principal Stratification in Causal Inference. Biometrics 2002, 58:21-29.","cites":null},{"id":44733772,"title":"Randomization-based methods for correcting for treatment changes: Examples from the Concorde trial. Statistics in Medicine","authors":[],"date":"1999","doi":"10.1002\/(sici)1097-0258(19991015)18:19<2617::aid-sim187>3.0.co;2-e","raw":"White IR, Babiker AG, Walker S, Darbyshire JH: Randomization-based methods for correcting for treatment changes: Examples from the Concorde trial. Statistics in Medicine 1999, 18(19):2617-2634.","cites":null},{"id":44733783,"title":"RL: The design of simulation studies in medical statistics. Statistics in Medicine","authors":[],"date":"2006","doi":"10.1002\/sim.2673","raw":"Burton A, Altman DG, Royston P, Holder RL: The design of simulation studies in medical statistics. Statistics in Medicine 2006, 25:4279-4292.","cites":null},{"id":44733752,"title":"S: Methodological issues in the economic analysis of cancer treatments.","authors":[],"date":"2006","doi":"10.1016\/j.ejca.2006.08.010","raw":"Tappenden P, Chilcott J, Ward S, Eggington S, Hind D, Hummel S: Methodological issues in the economic analysis of cancer treatments. European Journal of Cancer 2006, 42(17):2867-2875.","cites":null},{"id":44733792,"title":"sorafenib (first- and second-line), sunitinib (second-line) and temsirolimus (first-line) for the treatment of advanced and\/or metastatic renal cell carcinoma.","authors":[],"date":"2009","doi":"10.1016\/s1098-3015(10)73269-1","raw":"NICE: Bevacizumab (first-line), sorafenib (first- and second-line), sunitinib (second-line) and temsirolimus (first-line) for the treatment of advanced and\/or metastatic renal cell carcinoma. (TA 178). TA 178 2009 [http:\/\/ guidance.nice.org.uk\/TA178]. Pre-publication history The pre-publication history for this paper can be accessed here: http:\/\/www.biomedcentral.com\/1471-2288\/11\/4\/prepub","cites":null},{"id":44733767,"title":"Stata software","authors":[],"date":"2009","doi":null,"raw":"White IR: Stata software 2009 [http:\/\/www.mrc-bsu.cam.ac.uk\/Software\/stata. html].","cites":null},{"id":44733790,"title":"Statistical inference for cancer trials with treatment switching. Statistics in Medicine","authors":[],"date":"2005","doi":"10.1002\/sim.2128","raw":"Shao J, Chang M, Chow S: Statistical inference for cancer trials with treatment switching. Statistics in Medicine 2005, 24:1783-1790.","cites":null},{"id":44733784,"title":"Survival analysis part II: Mulitvariate data analysis - an introduction to concepts and methods.","authors":[],"date":"2003","doi":"10.1038\/sj.bjc.6601119","raw":"Bradburn M, Clark T, Love S, Altman D: Survival analysis part II: Mulitvariate data analysis - an introduction to concepts and methods. British Journal of Cancer 2003, 89:431-436.","cites":null},{"id":44733754,"title":"The clinical effectiveness and cost effectiveness of trastuzumab for breast cancer.","authors":[],"date":"2002","doi":"10.5353\/th_b4517380","raw":"NICE: The clinical effectiveness and cost effectiveness of trastuzumab for breast cancer. TA 34 2002 [http:\/\/guidance.nice.org.uk\/TA34].","cites":null},{"id":44733774,"title":"Tibshirini R: An introduction to the bootstrap Monographs on Statistics and Applied Probability. Chapman and Hall London;","authors":[],"date":"1993","doi":null,"raw":"Efron B, Tibshirini R: An introduction to the bootstrap Monographs on Statistics and Applied Probability. Chapman and Hall London; 1993.","cites":null},{"id":44733770,"title":"Tsiatis AA: Correcting for non-compliance in randomized trials using rank preserving structural failure time models.","authors":[],"date":"1991","doi":"10.1080\/03610929108830654","raw":"Robins JM, Tsiatis AA: Correcting for non-compliance in randomized trials using rank preserving structural failure time models. Communications in Statistics-Theory and Methods 1991, 20(8):2609-2631.","cites":null},{"id":44733756,"title":"Uses and limitations of randomization-based efficacy estimators.","authors":[],"date":"2005","doi":"10.1191\/0962280205sm406oa","raw":"White IR: Uses and limitations of randomization-based efficacy estimators. Statistical Methods in Medical Research 2005, 14(4):327-347.","cites":null},{"id":44733755,"title":"Wailoo A: Bevacizumab, sorafenib, sunitinib and temsirolimus for renal cell carcinoma. Decision Support Unit Report","authors":[],"date":"2008","doi":null,"raw":"Abrams K, Palmer S, Wailoo A: Bevacizumab, sorafenib, sunitinib and temsirolimus for renal cell carcinoma. Decision Support Unit Report 2008 [http:\/\/www.nice.org.uk\/nicemedia\/pdf\/ RenalCellCarcinomaExtraWorkPreparedByDSU.pdf].","cites":null},{"id":44733765,"title":"White IR: Compliance-adjusted intervention effects in survival data.","authors":[],"date":"2004","doi":null,"raw":"Kim LG, White IR: Compliance-adjusted intervention effects in survival data. The Stata Journal 2004, 4(Number 3):257-264.","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2011-01-11","abstract":"Background: We investigate methods used to analyse the results of clinical trials with survival outcomes in which\\ud\nsome patients switch from their allocated treatment to another trial treatment. These included simple methods\\ud\nwhich are commonly used in medical literature and may be subject to selection bias if patients switching are not\\ud\ntypical of the population as a whole. Methods which attempt to adjust the estimated treatment effect, either\\ud\nthrough adjustment to the hazard ratio or via accelerated failure time models, were also considered. A\\ud\nsimulation study was conducted to assess the performance of each method in a number of different scenarios.\\ud\nResults: 16 different scenarios were identified which differed by the proportion of patients switching, underlying\\ud\nprognosis of switchers and the size of true treatment effect. 1000 datasets were simulated for each of these and\\ud\nall methods applied. Selection bias was observed in simple methods when the difference in survival between\\ud\nswitchers and non-switchers were large. A number of methods, particularly the AFT method of Branson and\\ud\nWhitehead were found to give less biased estimates of the true treatment effect in these situations.\\ud\nConclusions: Simple methods are often not appropriate to deal with treatment switching. Alternative\\ud\napproaches such as the Branson & Whitehead method to adjust for switching should be considered.Peer reviewedPublisher Versio","downloadUrl":"http:\/\/creativecommons.org\/licenses\/by\/2.0),","fullTextIdentifier":"https:\/\/lra.le.ac.uk\/bitstream\/2381\/8131\/3\/1471-2288-11-4%5b1%5d.pdf","pdfHashValue":"cd7ac5e0a36fe1a0134b79b8440b6662a1d39bcc","publisher":"BioMed Central Ltd","rawRecordXml":"<record><header><identifier>\n        \n            \n                oai:lra.le.ac.uk:2381\/8131<\/identifier><datestamp>\n                2013-11-08T11:56:46Z<\/datestamp><setSpec>\n                com_2381_57<\/setSpec><setSpec>\n                com_2381_9550<\/setSpec><setSpec>\n                col_2381_58<\/setSpec>\n            <\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:doc=\"http:\/\/www.lyncode.com\/xoai\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n            \nAssessing methods for dealing with treatment switching in randomised controlled trials: a simulation study.<\/dc:title><dc:creator>\nMorden, James P.<\/dc:creator><dc:creator>\nLambert, Paul C.<\/dc:creator><dc:creator>\nLatimer, Nicholas<\/dc:creator><dc:creator>\nAbrams, Keith R.<\/dc:creator><dc:creator>\nWailoo, Allan J.<\/dc:creator><dc:description>\nBackground: We investigate methods used to analyse the results of clinical trials with survival outcomes in which\\ud\nsome patients switch from their allocated treatment to another trial treatment. These included simple methods\\ud\nwhich are commonly used in medical literature and may be subject to selection bias if patients switching are not\\ud\ntypical of the population as a whole. Methods which attempt to adjust the estimated treatment effect, either\\ud\nthrough adjustment to the hazard ratio or via accelerated failure time models, were also considered. A\\ud\nsimulation study was conducted to assess the performance of each method in a number of different scenarios.\\ud\nResults: 16 different scenarios were identified which differed by the proportion of patients switching, underlying\\ud\nprognosis of switchers and the size of true treatment effect. 1000 datasets were simulated for each of these and\\ud\nall methods applied. Selection bias was observed in simple methods when the difference in survival between\\ud\nswitchers and non-switchers were large. A number of methods, particularly the AFT method of Branson and\\ud\nWhitehead were found to give less biased estimates of the true treatment effect in these situations.\\ud\nConclusions: Simple methods are often not appropriate to deal with treatment switching. Alternative\\ud\napproaches such as the Branson & Whitehead method to adjust for switching should be considered.<\/dc:description><dc:description>\nPeer reviewed<\/dc:description><dc:description>\nPublisher Version<\/dc:description><dc:date>\n2010-07-01T13:12:29Z<\/dc:date><dc:date>\n2010-07-01T13:12:29Z<\/dc:date><dc:date>\n2011-01-11<\/dc:date><dc:type>\nArticle<\/dc:type><dc:identifier>\nBMC Medical Research Methodology, 2011, 11 : 4<\/dc:identifier><dc:identifier>\nhttp:\/\/hdl.handle.net\/2381\/8131<\/dc:identifier><dc:identifier>\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4<\/dc:identifier><dc:identifier>\n10.1186\/1471-2288-11-4<\/dc:identifier><dc:identifier>\n1471-2288<\/dc:identifier><dc:language>\nen<\/dc:language><dc:rights>\nCopyright \u00a9 2011 the Authors.  This is an Open Access article distributed under the terms of the Creative Commons Attribution License (http:\/\/creativecommons.org\/licenses\/by\/2.0), which permits unrestricted use, distribution, and reproduction in any medium, provided the original work is properly cited.<\/dc:rights><dc:publisher>\nBioMed Central Ltd<\/dc:publisher>\n<\/oai_dc:dc>\n<\/metadata>\n        <\/record>","journals":[{"title":null,"identifiers":["1471-2288","issn:1471-2288"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2011,"topics":[],"subject":["Article"],"fullText":"RESEARCH ARTICLE Open Access\nAssessing methods for dealing with treatment\nswitching in randomised controlled trials:\na simulation study\nJames P Morden1,2*, Paul C Lambert2, Nicholas Latimer3, Keith R Abrams2, Allan J Wailoo3\nAbstract\nBackground: We investigate methods used to analyse the results of clinical trials with survival outcomes in which\nsome patients switch from their allocated treatment to another trial treatment. These included simple methods\nwhich are commonly used in medical literature and may be subject to selection bias if patients switching are not\ntypical of the population as a whole. Methods which attempt to adjust the estimated treatment effect, either\nthrough adjustment to the hazard ratio or via accelerated failure time models, were also considered. A simulation\nstudy was conducted to assess the performance of each method in a number of different scenarios.\nResults: 16 different scenarios were identified which differed by the proportion of patients switching, underlying\nprognosis of switchers and the size of true treatment effect. 1000 datasets were simulated for each of these and all\nmethods applied. Selection bias was observed in simple methods when the difference in survival between\nswitchers and non-switchers were large. A number of methods, particularly the AFT method of Branson and\nWhitehead were found to give less biased estimates of the true treatment effect in these situations.\nConclusions: Simple methods are often not appropriate to deal with treatment switching. Alternative approaches\nsuch as the Branson & Whitehead method to adjust for switching should be considered.\nBackground\nRandomized controlled trials (RCTs) are widely used to\nassess the effects of a new treatment or procedure com-\npared to a control treatment. Survival outcomes are\ncommonly used, particularly in the cancer setting, with\nthe time to an event such as death or disease progres-\nsion analysed. In advanced disease trials are often\ndesigned with progression free survival as the primary\nendpoint, and overall survival as a secondary endpoint.\nIt is common for patients to switch from the treat-\nment to which they are randomised, either to the other\ntrial treatment, a non-trial treatment or to stop receiving\ntreatment altogether. Trial protocols often attempt to\ncontrol these switches while maintaining a degree of\nflexibility over the treatment a patient can receive,\nalthough this varies greatly between trials, and switching\nremains common. Switches may occur for a number of\nreasons, many of which are related to an individual\u2019s\nprognosis. Most commonly patients will switch from the\ncontrol arm to the intervention arm. A clinician may\ndecide that a patient is responding poorly to their allo-\ncated treatment and it is therefore unethical to let them\ncontinue on this regime. Alternatively, a patient may\nswitch because of treatment related side effects. Most\noften patients are allowed to switch to the new therapy\nat the point of disease progression. The estimate of the\ntreatment effect on progression-free survival is unbiased\nif a patient\u2019s sole reason for switching treatments is\ntheir progression. However, the estimate of the treat-\nment effect on overall survival is biased due to switching\nfrom control to the new therapy at progression. The\nquestion of interest is what would have been the overall\nsurvival treatment effect had no patients in the control\narm switched?\nPolicy decisions (such as whether a health-care provi-\nder will fund a new treatment) increasingly rely on judg-\nments of both clinical and cost effectiveness, both of\nwhich are heavily determined by the estimated survival\n* Correspondence: James.Morden@icr.ac.uk\n1ICR-CTSU, The Institute of Cancer Research, Sir Richard Doll Building,\nCotswold Road, Sutton, Surrey, UK, SM2 5NG\nFull list of author information is available at the end of the article\nMorden et al. BMC Medical Research Methodology 2011, 11:4\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4\n\u00a9 2011 Morden et al; licensee BioMed Central Ltd. This is an Open Access article distributed under the terms of the Creative Commons\nAttribution License (http:\/\/creativecommons.org\/licenses\/by\/2.0), which permits unrestricted use, distribution, and reproduction in\nany medium, provided the original work is properly cited.\ngains of a technology. If there is crossover then\nindividuals may receive treatments that are not consis-\ntent with the policy being evaluated. For example, if\nindividuals switch from a standard treatment to a new\ntreatment then they are not adhering to the policy of\nretaining standard care. Thus, failure to appropriately\naccount for switching in deriving an estimate of treat-\nment effect may lead to incorrect policy decisions and\nreduced efficiency of the health-care system as a whole.\nAn intention-to-treat (ITT) approach is often used\nwhere patients are analysed dependent on the treatment\nthey are randomised to, regardless of whether they actu-\nally went on to receive this treatment for the entire\nfollow-up period. This pragmatic approach is said to\nreflect the overall effectiveness of a treatment policy if it\nwere introduced on a wider scale [1]. However, this is\nonly the case where switching treatments is a feasible\noption. If the treatment is not currently available then\ntreatment switching may not be an option in practice. It\nis often of interest to estimate the effectiveness of the\nexperimental treatment alone, in the absence of switch-\ning. This appropriate policy effectiveness is especially\nimportant when assessing the cost-effectiveness of a\ntreatment, something which is increasingly used as an\ninput to drug reimbursement decisions [2].\nAppropriate policy effectiveness is often quantified\nusing a per-protocol (PP) approach which measures how\nwell a patient fares dependent on the treatment they\nactually receive, regardless of which treatment arm they\nwere randomised to. Patients who switch from their ran-\ndomised treatment are therefore excluded from the ana-\nlysis or censored at the time of their switch. This\napproach can lead to severe selection bias if those\nexcluded differ in prognosis from those retained in the\nanalysis, which is likely in this setting as patients often\nswitch treatments because their condition has deterio-\nrated [3].\nThe National Institute for Health and Clinical Excel-\nlence (NICE) has considered several drugs where cross-\nover has been a feature of the key clinical trials. In the\nappraisal of trastuzumab for the treatment of metastatic\nbreast cancer [4], 75% of patients randomised to control\ntreatment in the key trial eventually switched to the\nexperimental arm. These patients were excluded com-\npletely from the analysis and a median survival gain of\n17.9 months was found. However, if all control patients\nhad been included, this median survival gain was greatly\nreduced to just 7 months. The true median survival gain\nfrom the treatment is likely to be somewhere between\nthese two values.\nCrossover was also a feature of trials used in the\nrecent appraisal of renal cell carcinoma therapies where\nthe impact of alternative approaches on estimates of\ncost-effectiveness was highlighted [5]. For sunitinib, an\nanalysis of overall survival which excluded all patients\nwho received any subsequent therapy led to an Incre-\nmental Cost-Effectiveness Cost Ratio (ICER) of \u00a359, 819\ncompared to standard care (interferon), based on a\nhazard ratio of 0.65. However if these patients were not\nexcluded from the analysis, the overall hazard ratio is\nincreased to 0.82, increasing the ICER to \u00a3118,005. In\nreality, the ICER is likely to lie somewhere in between\nthese two estimates.\nVarious methods have been proposed to evaluate the\nappropriate policy effectiveness of a treatment taking\ninto account deviations from the randomised treatment\ngroup. These range from relatively simple methods,\nsuch as per protocol analysis, to methods that account\nfor switching using either a proportional hazards or\naccelerated failure time model. As it unclear how the\nvarious methods perform in different situations we eval-\nuate them using a simulation study.\nMethods\nThe different approaches considered in this investigation\ncan be grouped into simple methods (those which are\ncurrently widely used), and more sophisticated methods\nwhich make adjustments to the hazard ratio or use\naccelerated failure time models.\nSimple methods\nVarious methods have been used in existing literature in\nsituations where patients depart from their randomised\ntreatment. We refer to them here as simple methods\nwhich tend to involve only small adjustments to stan-\ndard survival techniques. This section will focus on four\nof these, intention-to-treat, excluding or censoring\npatients if they switch treatments and modelling treat-\nment as a time-varying covariate.\nIntention-to-treat\nMany authors take the pragmatic approach and use an\nintention-to-treat (ITT) analysis. Patients are analysed\ndepending on which treatment arm they were rando-\nmised to. An important feature of an ITT analysis is\nthat data from all randomised patients is utilised, with\ncensoring used in time-to-event analysis for patients\nwho are lost to follow-up to ensure this.\nThe results from an ITT analysis should always be\ngiven regardless of whether the effectiveness of the\ntreatment is of interest as it reflects the design and con-\nduct of the study. While analysis of this type is perfectly\nvalid, it may underestimate the appropriate policy effec-\ntiveness of a treatment [6]. For example, if the experi-\nmental treatment truly is superior to the control\ntreatment, and some patients have switched from con-\ntrol to experimental, and are therefore receiving the\nbenefits of this, using an ITT analysis will make\nthe treatments appear more similar than they really are.\nMorden et al. BMC Medical Research Methodology 2011, 11:4\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4\nPage 2 of 20\nThe benefit of this type of analysis is that randomisation\nbalance between groups is maintained, reducing the pos-\nsibility of bias affecting the results [7-9].\nPer-protocol (excluding switchers or censoring at switch)\nA per-protocol (PP) or as-treated approach involves ana-\nlysing patients according to the treatment they actually\nreceived rather than that to which they were rando-\nmised. This is commonly used to supplement an inten-\ntion-to-treat analysis [6].\nHere we define a per-protocol approach as an attempt\nto estimate the policy effectiveness by censoring patients\nat the point at which they switch, or completely exclud-\ning any switching patients from the analysis. Therefore\nunlike the ITT analysis described previously, not all\navailable patient data is utilised. Whereas ITT uses ran-\ndomisation to ensure treatment arms are balanced in all\naspects other than that of treatment, PP analysis may be\nsubject to selection bias as groups may no longer be\nbalanced after a patient is censored or excluded [7].\nThis type of bias is particularly likely if a patient\u2019s prob-\nability of switching treatments is strongly related to\ntheir underlying prognosis [10].\nTreatment as a time-varying covariate\nAn extension of the Cox proportional hazards model is\nto include treatment as a time-varying covariate to\nassess the effect of treatment actually received by a\npatient. The model takes the form:\n\uf06c \uf06c \uf062i it t X t( ) = ( ) ( )( )0 exp (1)\nwhere l0(t) is the baseline hazard function and Xi(t)\ntakes a value of zero while a patient is receiving the\ncontrol and 1 while they are receiving the experimental\ntreatment. However, like the PP methods presented\nabove, this method can break the randomisation balance\nand is therefore subject to selection bias if switching is\nrelated to prognosis [11].\nAdjusted hazard ratio methods\nThe two methods described here make adjustments to\nthe hazard ratio in order to take into account patients\nswitching from one treatment arm to the other.\nAdjusted Cox model (Law and Kaldor, 1996)\nLaw and Kaldor [12] propose a method of adjusting the\nstandard Cox model to take into account patients who\ndepart from their randomised treatment. The method\ncan be used in situations where patients switch both\nfrom control to experimental treatment and\/or in the\nopposite direction.\nThe method works on the principle that patients can\nbe divided into four groups depending on their switch-\ning pattern. So given an RCT comparing two treatments\n(A and B), patients are classified as being in Group AA\nor BB if they were allocated to A or B and did not\nswitch treatments, or to Group AB or BA if they\nswitched from their allocated treatment to the other\ntreatment. The hazard rates in each group are assumed\nproportional. A Cox model is then fitted with a time-\nvarying covariate for switching time. Full details of the\nmethod can be found in the paper itself [12].\nThe method makes a number of assumptions which\nmay not be appropriate in all situations. The assumption\nthat the underlying hazard rates of switchers and non-\nswitchers allocated to each treatment can be expressed\nas multiplicative factors may not be appropriate and is\nnot testable. Also, it is assumed that switching onto a\nnew treatment will cause an instantaneous improve-\nment, which may be important, but would be difficult to\ntest in reality. The method also makes the assumption\nthat the treatment effect for patients switching on to a\ntreatment will be the same as for those initially allocated\nto receive it. This assumption is unlikely to be true in a\nreal trial setting for a number of reasons, the most\nimportant of which may be that patients switching onto\na treatment will typically be at a more advanced stage of\ntheir disease than those in the treatment arm were at\nthe start of the trial. This assumption could be tested\nfor a real dataset by comparing the survival times of\npatients from their switch with the survival times of\ntreatment arm patients, although analysis of this type\nwould itself be subject to bias.\nProblems with this method have been raised by White\n[13]. Patients are grouped as described above according\nto future events, i.e. a treatment switch which has not\nyet occurred. So for example, subjects in group AB are\nsaid to have a certain hazard function before they\nswitch. However, in reality they have a hazard of zero\nup to the point at which they switch treatment, as they\ncannot die before this point or they would be in group\nAA. White states that this is likely to bias the estimated\nhazard ratio towards the null.\nCausal proportional hazards estimator (Loeys and\nGoetghebeur, 2003)\nLoeys and Goethebeur [14] present a method for calcu-\nlating the true treatment efficacy in situations where all\npatients take their allocated treatment in one arm and\ncompliance is \u201call-or-nothing\u201d in the other arm. This\nmeans that if a patient in this arm switches, the switch\nis assumed to have happened at time zero, and the\npatient is assumed to have only received the treatment\nthey switched onto and none of their allocated treat-\nment. The method and its implementation in the Stata\npackage are described further by Kim and White [15].\nThe authors consider a clinical trial in which patients\nare randomised to receive either a control treatment or\nan experimental treatment. The method works on the\nassumption that all patients in the control arm comply\nfully, and patients in the experimental arm may either\nMorden et al. BMC Medical Research Methodology 2011, 11:4\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4\nPage 3 of 20\ncomply fully (complier) or not at all (non-complier).\nPatients in the control arm are also classed as either\nbeing a complier or non-complier depending on how\nthey would have behaved if they had been randomised\nto the experimental arm. The proportion of non-\ncompliers is assumed to be the same in both arms due\nto randomisation (often referred to as the exclusion\nrestriction [16]).\nThe method then makes use of Kaplan-Meier survival\nestimates and the assumed relationship between control\nand experimental compliers to find an estimate of the\nhazard ratio. Loeys and Goetghebeur [14] give full\ndetails of the methodology used. The method was\napplied in this investigation using the Stata program\nstcomply as described by Kim and White [15,17].\nThe all-or nothing compliance assumption is a very\nimportant limitation of this method as this type of compli-\nance is only likely to occur in very specific scenarios, such\nas a trial to investigate a new screening program where\npatients may be allocated to attend screening but may not\nattend. As mentioned previously the method also makes\nthe important exclusion restriction assumption, which\nalthough untestable, we feel is likely to hold in most set-\ntings. The implications of a violation of this assumption\nhas been discussed elsewhere [16,18], and may be reduced\nby incorporating covariates that predict compliance.\nAccelerated failure time model methods\nThe methods in this section make use of accelerated\nfailure time (AFT) models, an alternative form of survi-\nval model to the commonly used proportional hazards\nmodel. A proportional hazards model assumes that cov-\nariates multiply the hazard by a constant, whereas\nan AFT model assumes that a covariate multiplies the\npredicted event time by a constant [19].\nThese methods have been referred to as randomisa-\ntion-based efficacy estimators (RBEEs) [6], as they com-\npare groups as randomised and therefore are intended\nto reduce biases which may be introduced by comparing\ngroups as-treated. The method of Loeys & Goetghebeur\n[14] described previously is also an RBEE as it preserves\nthe randomisation balance and the significance level\nfrom an ITT analysis.\nRank preserving structural failure time models (Robins and\nTsiatis, 1991)\nRobins and Tsiatis [20] describe the use of AFT models\nto estimate the true efficacy of a treatment. A patient\u2019s\nobserved event time is related to their counterfactual\nevent time, that which would have been observed for a\nparticular patient if they had not received any treatment.\nThese models are referred to as rank preserving as they\nmake the assumption that given two patients i and j, if i\nfailed before j when both were on one treatment, then i\nwould also fail before j if both patients took the same\nalternative treatment. Consider a randomised trial with\ntwo arms, a control arm (A) receiving no treatment, and\nan experimental arm (B). Each patient i has an observed\ntime to event or censoring Ti. Ri = A or B is the\npatient\u2019s randomised treatment arm.\nEach patient also has a counterfactual event time Ui\nwhich is the event time which would have been\nobserved if no treatment had been received. Patients in\nthe control arm who do not switch treatment will have\nTi = Ui, so their counterfactual event time will be\nobserved. Ui is unobserved for all other patients. The\nassumption is made that Ui is independent of Ri due to\nrandomisation balance.\nConsider the observed event time Ti as being made up\nof a patient\u2019s time on the control treatment TAi and their\ntime on the experimental treatment TBi, so Ti = TAi + TBi.\nFor patients who did not switch treatments, either TAi or\nTBi will be equal to zero. Ti is related to the counterfactual\nevent time Ui by the following causal model:\nU T e Ti Ai Bi= +\n\u2212\uf079 0 (2)\ne\uf079 0 is often called the acceleration factor, the amount\nby which a patient\u2019s expected time to event is increased\nby treatment. A value of e\uf079 0 1> indicates a beneficial\ntreatment effect whereas e\uf079 0 1< suggests treatment has\na detrimental effect, increasing the speed at which a\npatient moves towards their event. e\uf079 0 is perhaps easier\nto interpret than e \u2212\uf079 0 so results will be presented in\nthis form.\nBy defining a binary process Xi(t) which equals 1\nwhen a patient is on experimental treatment and 0\notherwise, equation (2) can be rewritten as:\nU X t dti i\nTi\n= ( )\u23a1\u23a3 \u23a4\u23a6\u222b exp \uf0790 (3)\nFor a given value of \u03c8, the hypothesis \u03c80 = \u03c8 can be\ntested by first calculating Ui(\u03c8) using equation (2). Z(\u03c8)\nis then calculated as the test statistic for the hypothesis\nU(\u03c8)\u2568R, i.e. a patient\u2019s counterfactual event time is inde-\npendent of the treatment arm to which they were\nrandomised.\nA number of different tests could be used to calculate\nZ(\u03c8). We considered four different statistical tests in\nthis investigation: the logrank, Cox, exponential and\nWeibull tests. The value of \u03c8 for which Z(\u03c8) = 0 is\ntaken as the point estimate. This is the value for which\nU is balanced between treatment arms.\nThe method has been extended and implemented in\nStata (through the strbee program) by White et al\n[21,22] as follows. Define Ci as the administrative censor-\ning time which corresponds to the end of follow-up. Using\nequation (3), the censoring time for Ui(\u03c8) is given by:\nMorden et al. BMC Medical Research Methodology 2011, 11:4\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4\nPage 4 of 20\nD X t dti i\nCi\uf079 \uf079( ) = ( )\u23a1\u23a3 \u23a4\u23a6\u222b exp0 (4)\nHowever, because switching may be related to prog-\nnosis, both Xi and Di may also depend on prognosis and\ntherefore the censoring of Ui(\u03c8) may be informative, and\nthus including censoring in this way can result in biased\nestimates as shown by White et al [22]. They suggest this\nbias could be avoided by recensoring counterfactual sur-\nvival times so that the censoring time equals the mini-\nmum of the administrative censoring time (Ci) and Ci\nexp \u03c8. Then the counterfacutal survival time Ui(\u03c8) is\nreplaced by the censoring time of the counterfactual\nevent times Di\n* \uf079( ) if D Ui i* \uf079 \uf079( ) < ( ) .\nAn interval bisection process can be used to find the\npoint estimate and confidence interval for \u03c8. Further\ndetails of this can be found in the discussion of the\nstrbee program [21].\nThe Robins & Tsiatis method makes a number of\nassumptions. As mentioned previously the models are\nrank-preserving, which may not be plausible with certain\npatients likely to see more or less benefit than others on\ndifferent types of treatments due to biological factors.\nHowever testing for any violations of this assumption in\nreal data may not be possible. The method also assumes\nan equal treatment effect for patients switching to a\ntreatment as for those initially allocated to receive it as\ndiscussed previously for the Law & Kaldor method\nIterative parameter estimation algorithm (Branson and\nWhitehead, 2002)\nBranson and Whitehead [23] build on the method devel-\noped by Robins and Tsiatis [20] by replacing the test-\nbased estimation of \u03c8 with a likelihood-based analysis.\nAn iterative parameter estimation (IPE) algorithm is\nused. This retains all patients to the treatment group to\nwhich they were initially randomised. Using the same\nnotation as used in the previous section, consider the\nmodel relating counterfactual and observed event times\nseen previously.\nAn initial estimate for e\u03c8 is obtained by comparing the\ntreatment arms as randomised using an parametric fail-\nure time model (equivalent to an intention-to-treat\napproach). A number of parametric distributions could\nbe chosen for this such as log-logistic, log-normal or\ngamma. We use a Weibull distribution as it has the\nadvantage of having both AFT model and proportional\nhazards model parameterisations [19].\nGiven this initial estimate, the observed survival times\nof patients who switched from control to experimental\ntreatment are transformed using the current estimate\nfor e\u03c8 and equation (2). Groups are compared again,\ngiving an updated estimate for e\u03c8. The process is then\nrepeated until the latest value of e\u03c8 becomes sufficiently\nclose to its value from the previous iteration, at which\npoint the process is said to have converged. Further\nexplanation of the algorithm can be found in the origi-\nnal paper [23].\nIf the algorithm projects a patient\u2019s survival time\nbeyond the administrative censoring time Ci, the patient\nis considered censored and their projected survival time\nis replaced by Ci. This recensoring is restricted only to\npatients in the control arm who switch treatments,\nunlike the recensoring implemented to the Robins and\nTsiatis method by White et al [22].\nStandard errors can be calculated by either taking the\nstandard error from the final regression in the algorithm\nor by using bootstrapping [24]. The authors discuss how\nthe standard error from the final regression may be too\nsmall meaning bootstrapping may be preferable. This is\nbecause the covariance matrix from the final iteration of\nthe IPE does not does not take into account the fact\nthat control arm patients have had their survival time\nadjusted by the algorithm.\nThis method makes all the assumptions of the Robins\nand Tsiatis method, and in addition assumes that survi-\nval times take a certain parametric form (although the\nrelationship between a patient\u2019s prognosis and their\nswitching pattern is still not modelled). This is an\nimportant additional assumption, with a violation having\na potential impact on the estimation of an adjusted\ntreatment effect. The authors suggest that given a real\ndataset, a parametric form is chosen which fits the\nobserved data most closely.\nParametric randomisation-based methods (Walker et al,\n2004)\nIn the previous two methods \u03c8 is chosen to balance the\ncounterfactual event time, U, between treatment arms.\nHowever as discussed previously, and by Robins and\nTsiatis [20], these methods can be associated with a loss\nof information through recensoring and arbitrary differ-\nences from the results of ITT analysis. Walker et al [25]\npresent an extension to these semi-parametric methods\nwhich involve full parametric modelling of the relation-\nship between U and the treatment a patient actually\nreceives Z. Again we consider a trial with control (A)\nand experimental (B) arms where some patients who are\nrandomised to control actually switch to receive the\nexperimental treatment at some point during follow-up.\nConsider Ui as a patient\u2019s counterfactual event time and\nZi as the time at which they start receiving experimental\ntreatment. The authors propose specifying a joint para-\nmetric model for Ui and Zi which is made up of three\nparts:\n1. A causal model relating Ui to a patient\u2019s\nobserved failure time Ti. This is the AFT model\nseen in previous sections.\nMorden et al. BMC Medical Research Methodology 2011, 11:4\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4\nPage 5 of 20\n2. A model for the association between U and Z.\nThis is a bivariate frailty model. Either a positive\nstable [26] or gamma [27] frailty are suggested.\nThese models include a parameter j which describes\nthe level of association between U and Z.\n3. Models for the marginal cumulative hazards.\nHu(u) and Hz(z) are the marginal cumulative hazards\nof U and Z respectively.\nFitting this model using maximum-likelihood techni-\nques would only ensure the original randomisation\nbalance is preserved if all models are correctly specified.\nParameter estimates will therefore be very sensitive to\ninaccuracies in the model specification. To deal with\nthis, the authors suggest an alternative approach to\nmaximum likelihood to estimate parameters. They use\nan augmented model to maintain the randomisation bal-\nance between groups which corresponds to the Cox\nmodel based test statistic in the semi-parametric\napproach of Robins & Tsiatis. The model has the form:\nH u e H uu\nR\nu\n* ( ) = ( )\uf072 (5)\nAn estimate of \u03c8 can be found so that an estimate of\nr would be equal to zero, indicating there is no relation-\nship between a patient\u2019s underlying survival time and\nthe treatment arm they are randomised to so randomi-\nsation balance is maintained. Full details of the estima-\ntion process are described by Walker et al [25]. The\nmethod is implemented here through the gparmee\nprogram in Stata [17].\nThis method makes the same assumptions as the\nRobins & Tsiatis method, and in addition makes assump-\ntions about the parametric form of the data. The authors\nsuggest distributions chosen could be based on the\nobserved data, although choosing an appropriate frailty\ndistribution could be difficult. However the authors sug-\ngest that the method is robust to model misspecifications\nwhen the estimating equations approach is used.\nSimulation study design\nTo formally assess the various methods, a simulation\nstudy was conducted. Independent datasets were simu-\nlated with the true difference between each treatment\u2019s\neffect on survival known and each method applied to\nthe data to see how well they performed in terms of\nbias, variability and coverage. The simulated data was\ndesigned to reflect data which is obtained from real clin-\nical trials based on a review of recent submissions to\nNICE. This section contains details of the design of the\nsimulation study.\nUnderlying survival times\nThe starting point for simulating data was to generate a\nnumber of patients with an underlying survival time. A\nsample size of 500 was chosen, with 250 patients allo-\ncated each to receive control or experimental treatment.\nThis sample size reflects what is often seen in large can-\ncer trials [4,28,29]. Survival times for these patients were\nthen generated from a Weibull distribution as described\nby Bender et al [30]. The shape parameter g was set at\n0.5 which assumes mortality rate is decreasing over\ntime, a situation often observed in cancer data [31,32].\nThe scale parameter l was chosen so that approximately\n90% of patients who receive no treatment had died after\nthree years of follow-up.\nEntry and exit times\nPatients were assumed to have entered the study at\nsome point during a one-year period, with their entry\ntime generated from a uniform distribution between\ntime zero and 1 year. Patients were then censored at 3\nyears to represent the end of the follow-up period.\nTherefore all patients were followed up for between 2\nand 3 years, dependent on their entry time, representing\nwhat is often seen in a real trial setting.\nPatient prognosis\nAs described previously, bias can often occur when\npatients with different underlying prognoses have differ-\nent probabilities of switching between treatment arms.\nTo investigate this, patients were split into two groups,\nthose with a \u2018good\u2019 prognosis and those with a \u2018poor\u2019\nprognosis. The probability of a patient being in the\n\u2018good\u2019 prognosis group was set at either 30% or 75%.\nPatients allocated to the \u2018good\u2019 prognosis group were\nassumed to have their previously generated underlying\nsurvival time multiplied by an inflation factor. Values of\n1.2 and 3 were chosen to represent relatively small and\nlarge differences between the prognostic groups. Rando-\nmisation should ensure the proportion with \u2018good\u2019 and\n\u2018bad\u2019 prognosis was balanced between treatment arms.\nSwitching probability\nThe probability of a patient switching was then set,\ndependent on their prognosis group. Only switching\nfrom the control to the experimental treatment was con-\nsidered. The assumption was made that patients in the\n\u2018poor\u2019 prognosis group were more likely to crossover, as\nis often the case with the experimental treatment consid-\nered as a \u201crescue\u201d measure. Two sets of probabilities\nwere considered; probabilities of switching 10% and 25%\nfor \u2018good\u2019 and \u2018poor\u2019 prognosis groups respectively to\nrepresent a relatively small proportion of patients switch-\ning treatments or 50% and 75% for \u2018good\u2019 and \u2018poor\u2019\ngroups respectively to represent a trial with a large pro-\nportion of control patients switching. These probabilities\nwere then used to generate a binary variable indicating\nwhether or not a patient switches treatments.\nSwitching time\nFor patients who switched treatments, a switching time\nwas generated which occurred between their entry into\nMorden et al. BMC Medical Research Methodology 2011, 11:4\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4\nPage 6 of 20\nthe study and their exit (through either death or censor-\ning). Switching times were generated using a uniform\ndistribution. This assumes that a patient is equally likely\nto switch at any point between their entry into the\nstudy and death or censoring.\nAdjusting survival times for treatment received\nThe next step is to adjust survival times based on the\namount of treatment a patient actually receives. For\neach patient, survival time is made up of time on con-\ntrol TAi and time on experimental treatment TBi.\nPatients randomised to control who do not switch treat-\nments will have TBi = 0. All patients randomised to\nexperimental treatment will have TAi = 0 as no patients\nfrom this arm are allowed to switch treatments.\nAdjusted patient survival time Ti\n* is then calculated\nusing the formula for the causal accelerated failure time\nmodel as described by Walker et al [25]:\nT T e Ti Ai Bi\n*\n= + \uf079 (6)\nwhere e\u03c8 is the true effect of treatment. Patient times\nare therefore extended beyond the time that they spend\non control. If a patient\u2019s survival time is extended\nbeyond three years they are censored at three years.\nTreatment effect\nInitial treatment effect hazard ratios of 0.9 and 0.7 were\nchosen to represent situations with a smaller and larger\ntrue difference between treatments, with the experiment\ntreatment considered beneficial.\nAs the values l of and g used to simulate the underly-\ning survival times are known, the hazard ratios\nb described above can be converted into e\u03c8 form\nrequired by equation (6) by using the formula described\nby Collett [19]:\n\uf079 \uf062\uf067=\n\u2212 ln\n(7)\nFor example, a hazard ratio of 0.7, with g = 0.5\nequates to \u03c8 = 0.7133 and therefore e\u03c8 = 2.04.\nTable 1 gives a summary of all variables considered\nwhen simulating patient data and the values chosen for\nthese.\nApplying the methods\nBy considering all possible combinations of the variables\ndescribed in Table 1, 16 scenarios were identified. For\neach of these, data was generated as described above,\nand the various methods applied to this dataset. This\nprocess was repeated 1000 times for each scenario. For\neach method the mean treatment effect \uf062\uf0b5 and its stan-\ndard error SE( \uf062\uf0b5 ) over the 1000 simulations were calcu-\nlated. The means of the standard error and 95%\nconfidence limits from each method were also calcu-\nlated. No standard errors are given by the Loeys &\nGoetghebeur or Robins & Tsiatis methods. For the\nBranson & Whitehead method, standard errors were\ntaken from the final regression of the algorithm rather\nthan bootstrapping due to the large computing time\nbootstrapping for each simulated dataset would require.\nPerformance measures\nMeasures which can be used to assess the methods pre-\nsented were calculated as described by Burton et al [33].\nThe bias of each method \u03b4 was calculated as:\n\uf064 \uf062 \uf062= \u2212\u02c6 (8)\nwhere b is the true initial treatment effect for that\nparticular scenario.\nThe mean square error (MSE) is a useful measure of\nthe overall accuracy of a method as it includes both\nmeasures of bias and of the variability of estimates given\nby a method [33]. The MSE is calculated as:\nMSE SE= \u2212( ) + ( )( )\u02c6 \u02c6\uf062 \uf062 \uf0622 2 (9)\nAlso calculated was the coverage of each method. This\nis the defined as the proportion of times the 95% confi-\ndence interval for a particular method contains the true\ntreatment effect, b. Coverage should be approximately\nequal to 95%, indicating that around 95% of the confi-\ndence intervals include the true value. As some methods\nmay not successfully converge in certain situations, the\nproportion of times each method successfully gave a\nparameter estimate was also calculated. Methods which\nare unsuccessful for a large number of simulated datasets\nmay be of little practical use.\nResults\nTable 2 shows details of the parameter values used in each\nof the 16 scenarios and the table in which the results for\nthis scenario can be found. Results from scenarios 3, 4, 7,\n8, 11, 12, 15 and 16 can be found in [Additional files 1, 2,\n3 and 4]. A selection of results are presented in this\nsection.\nFor figures in this section, method names were abbre-\nviated as follows: Intention-to-Treat (ITT), Exclude\nswitchers (PP-EXC), Censor at switch (PP-CENS),\nTreatment as time-varying covariate (TVC), Law & Kal-\ndor (LK), Loeys & Goetghebeur (LG), Robins & Tsiatis\nwith logrank test (RT-LR), with Cox test (RT-COX),\nwith exponential test (RT-EXP), with Weibull test (RT-\nWB), Branson & Whitehead (BW) and Walker et al\nparametric method (WALK).\nPrognosis and bias\nWe will first focus on four particular scenarios, 2, 6, 10\nand 14. Each of these has 30% of patients with \u2018good\u2019\nMorden et al. BMC Medical Research Methodology 2011, 11:4\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4\nPage 7 of 20\nprognosis, a true treatment difference of b = 0.7 on the\nhazard ratio scale or e\u03c8 = 2.04 on the AFT scale.\nThe scenarios vary in the difference in survival\nbetween \u2018good\u2019 and \u2018poor\u2019 prognosis groups, with \u2018good\u2019\nprognosis patient\u2019s survival multiplied by 1.2 in scenar-\nios 2 and 6 and by 3 in scenarios 10 and 14. The sce-\nnarios also differ in the probabilities of switching in\n\u2018good\u2019 and \u2018poor\u2019 prognosis groups, with probabilities of\n10% and 25% respectively in scenarios 2 and 10 and of\n50% and 75% respectively in scenarios 6 and 14. Full\nresults from these scenarios can be found in Tables 3, 4,\n5 and 6.\nFigure 1 shows mean estimates and mean upper and\nlower confidence intervals for four simple methods\n(ITT, PP-EXC, PP-CENS, and TVC) and two adjusted\nhazard ratio methods (LK, LG). Figure 2 shows\nmean estimates and mean upper and lower confidence\nintervals for three simple methods (ITT, PP-EXC,\nPP-CENS) and for six accelerated failure time model\nmethods (RT-LR, RT-COX, RT-EXP, RT-WB, BW, and\nWALK).\nAs expected, the ITT approach underestimated the\ntrue treatment effect in each of these four scenarios.\nThis under-estimation was relatively small in the scenar-\nios with a small proportion of switchers (2 and 10),\naround 0.03 - 0.04 on the hazard ratio scale in both\ncases. This increased to around 0.11 in scenarios 6 and\n14 with a large proportion of control patients switching.\nExcluding switchers from the analysis produced rela-\ntively small bias in scenarios 2, 6 and 10. However, in\nscenario 14, where the difference between \u2018good\u2019 and\n\u2018poor\u2019 prognosis groups and the proportion of switchers\nwere both large, significant bias was seen (0.08 on the\nhazard ratio scale). The results from this approach are\nperhaps better than expected with many estimates very\nclose to the true treatment effect, particularly in\nTable 1 Summary of simulation variables\nVariable Scenarios Details\nSample size 1 500 patients, 250 in each treatment arm\nWeibull shape parameter g 1 0.5, to represent mortality rate decreasing over time\nWeibull scale parameter l 1 1.33, chosen such that 90% of patients have died after 3 years of follow-up\nProbability of patient having \u2018good\u2019 prognosis 2 30% or 75%\nDifference in survival between \u2018good\u2019 and \u2018poor\u2019\nPrognosis groups\n2 Survival times of \u2018good\u2019 prognosis group multiplied by a factor of either 1.2 or 3\nProbability of switching treatment dependent on\nprognosis group\n2 10% (\u2019good\u2019 prognosis) and 25% (\u2019poor\u2019 prognosis) or 50% (\u2019good\u2019 prognosis) and\n75% (\u2019poor\u2019 prognosis)\nSwitching time 1 Generated from a Uniform distribution\nInitial treatment effect 2 Hazard ratio of 0.9 or 0.7\nTable 2 List of scenarios\nScenario\nNumber\nTreatment\neffect (HR)\n% with \u2018good\u2019\nPrognosis\n\u2019Good\u2019 prognosis Survival Crossover probabilities\n(\u2019good\u2019 and \u2018poor\u2019 prognosis)\nTable\nNumber\n0.9 0.7 30% 75% \u00d71.2 \u00d73 10% and 25% 50% and 75%\n1 \u221a \u221a \u221a \u221a 3\n2 \u221a \u221a \u221a \u221a 3\n3 \u221a \u221a \u221a \u221a Additional file 1\n4 \u221a \u221a \u221a \u221a Additional file 1\n5 \u221a \u221a \u221a \u221a 4\n6 \u221a \u221a \u221a \u221a 4\n7 \u221a \u221a \u221a \u221a Additional file 2\n8 \u221a \u221a \u221a \u221a Additional file 2\n9 \u221a \u221a \u221a \u221a 5\n10 \u221a \u221a \u221a \u221a 5\n11 \u221a \u221a \u221a \u221a Additional file 3\n12 \u221a \u221a \u221a \u221a Additional file 3\n13 \u221a \u221a \u221a \u221a 6\n14 \u221a \u221a \u221a \u221a 6\n15 \u221a \u221a \u221a \u221a Additional file 4\n16 \u221a \u221a \u221a \u221a Additional file 4\nMorden et al. BMC Medical Research Methodology 2011, 11:4\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4\nPage 8 of 20\nscenarios where only a small proportion of patients\nswitch treatments. This is possibly explained by the fact\nthat patients who switch treatments have a number of\nmechanisms acting on them which might cancel each\nother out. This will be investigated further by comparing\nbiases in scenarios with a smaller and larger true treat-\nment effect in the next section.\nPerhaps the most striking results from these scenarios\nrelate to the methods which give particularly large biases,\nsuggesting they are very sensitive to the differences in prog-\nnosis between switchers and non-switchers. Of the hazard\nratio methods, censoring patients at the time of switching\nand considering treatment as a time-dependent covariate\nboth produced large biases, particularly when a large\nTable 3 Scenarios 1 & 2: 30% \u2018good\u2019 prognosis, \u00d71.2 \u2018good\u2019 prognosis survival, 10% and 25% switching probabilities,\n100% treatment effect for switchers, uniform distribution for switching times\nTrue HR\nand e\u03c8\nMethod Mean\nestimate\nMean\nSE\nSE of\nmean\n95% Confidence\ninterval\nBias MSE Coverage\n(%)\nSuccessful\nestimation (%)\nLower Upper\nHazard ratio methods\nITT 0.9120 0.0884 0.0882 0.7542 1.1027 0.0120 0.0079 94.6 100.0\nPP - Exclude switchers 0.9053 0.0932 0.0929 0.7399 1.1076 0.0053 0.0087 94.3 100.0\nPP - Censor at switch 1.0589 0.1091 0.1086 0.8653 1.2957 0.1589 0.0370 67.5 100.0\nTime-dependent\ncovariate\n1.1998 0.1189 0.1211 0.9880 1.4570 0.2998 0.1046 19.1 100.0\nLaw and Kaldor 0.9168 0.1136 0.1132 0.7192 1.1688 0.0168 0.0131 94.7 100.0\nLoeys and Goethebeur 0.8900 - 0.1086 0.6999 1.1354 -0.0100 0.0119 94.8 100.0\n0.9 & 1.23 AFT methods\nITT 1.2357 0.2392 0.2423 0.8457 1.8060 0.0011 0.0587 94.6 100.0\nPP - Exclude switchers 1.2586 0.0932 0.2616 0.8415 1.8830 0.0240 0.0690 94.3 100.0\nPP - Censor at switch 0.9214 0.1864 0.1897 0.6199 1.3700 -0.3132 0.1341 66.3 100.0\nRobins and Tsiatis -\nLogrank\n1.2715 - 0.2852 0.8244 1.9604 0.0370 0.0827 94.7 100.0\nRobins and Tsiatis - Cox 1.2703 - 0.2806 0.8199 1.9888 0.0357 0.0800 95.2 97.2\nRobins and Tsiatis -\nExponential\n1.2781 - 0.2820 0.9712 1.7776 0.0436 0.0814 83.0 99.7\nRobins and Tsiatis -\nWeibull\n1.2714 - 0.2845 0.8278 1.9933 0.0369 0.0823 95.0 99.7\nBranson and Whitehead 1.2681 0.2455 0.2745 0.8678 1.8536 0.0335 0.0765 92.7 100.0\nWalker et al 2.2108 1.1659 1.1869 0.8323 1218.7190 0.9763 2.3617 76.6 99.4\nHazard ratio methods\nITT 0.7315 0.0731 0.0743 0.6014 0.8897 0.0315 0.0065 93.6 100.0\nPP - Exclude switchers 0.7050 0.0744 0.0776 0.5733 0.8669 0.0050 0.0060 94.3 100.0\nPP - Censor at switch 0.8215 0.0868 0.0886 0.6678 1.0106 0.1215 0.0226 69.2 100.0\nTime-dependent\ncovariate\n0.9364 0.0950 0.0982 0.7675 1.1424 0.2364 0.0655 18.8 100.0\nLaw and Kaldor 0.7376 0.0957 0.0968 0.5720 0.9511 0.0376 0.0108 93.6 100.0\nLoeys and Goethebeur 0.6733 - 0.0876 0.5220 0.8672 -0.0267 0.0084 93.2 100.0\n0.7 & 2.04 AFT methods\nITT 1.9259 0.3858 0.3992 1.3007 2.8524 -0.1150 0.1726 93.5 100.0\nPP - Exclude switchers 2.0825 0.0744 0.4676 1.3766 3.1516 0.0417 0.2204 94.3 100.0\nPP - Censor at switch 1.5194 0.3140 0.3241 1.0136 2.2786 -0.5214 0.3769 66.5 100.0\nRobins and Tsiatis -\nLogrank\n2.1014 - 0.5024 1.3483 3.3204 0.0606 0.2561 94.5 100.0\nRobins and Tsiatis - Cox 2.0969 - 0.4977 1.3303 73.7821 0.0561 0.2508 94.9 93.5\nRobins and Tsiatis -\nExponential\n2.1041 - 0.5090 1.4957 3.1128 0.0633 0.2631 87.1 100.0\nRobins and Tsiatis -\nWeibull\n2.1017 - 0.5024 1.3497 3.4566 0.0609 0.2561 94.9 100.0\nBranson and Whitehead 2.0889 0.4188 0.4770 1.4104 3.0949 0.0481 0.2299 92.2 100.0\nWalker et al 3.6507 1.8935 1.5878 1.3852 92.4403 1.6099 5.1127 79.5 93.1\nMorden et al. BMC Medical Research Methodology 2011, 11:4\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4\nPage 9 of 20\nproportion of patients switched treatments (Scenarios 6 and\n14) with mean hazard ratio estimates of 1.68 and 1.77 for\ncensoring at switch and 2.42 and 2.58 for treatment as a\ntime-varying covariate. These large biases are reflective of\nwhat was seen throughout the simulation study for these\nmethods and suggest they may be inappropriate for use due\ntheir large sensitivity to even a relatively weak relationship\nbetween switching and prognosis.\nThe parametric method of Walker et al over-estimated\nthe true treatment effect in all four scenarios presented\nhere. This over-estimation was particularly significant in\nscenarios with a large difference in survival between\nTable 4 Scenarios 5 & 6: 30% \u2018good\u2019 prognosis, \u00d71.2 \u2018good\u2019 prognosis survival, 50% and 75% switching probabilities,\n100% treatment effect for switchers, uniform distribution for switching times\nTrue HR and\ne\u03c8\nMethod Mean\nestimate\nMean\nSE\nSE of\nmean\n95%\nConfidence\ninterval\nBias MSE Coverage\n(%)\nSuccessful\nestimation (%)\nLower Upper\nHazard ratio methods\nITT 0.9364 0.0909 0.0909 0.7741 1.1328 0.0364 0.0096 93.6 100.0\nPP - Exclude switchers 0.9204 0.1275 0.1278 0.7016 1.2074 0.0204 0.0167 96.0 100.0\nPP - Censor at switch 2.1663 0.3018 0.2975 1.6488 2.8466 1.2663 1.6921 0.0 100.0\nTime-dependent\ncovariate\n3.0639 0.4065 0.4054 2.3625 3.9740 2.1639 4.8466 0.0 100.0\nLaw and Kaldor 0.9396 0.1168 0.1144 0.7364 1.1987 0.0396 0.0147 94.2 100.0\nLoeys and Goethebeur 0.8435 - 0.2725 0.4578 1.8486 -0.0565 0.0774 92.8 99.9\n0.9 & 1.23 AFT methods\nITT 1.1732 0.2280 0.2311 0.8018 1.7173 -0.0613 0.0572 93.2 100.0\nPP - Exclude switchers 1.2492 0.1275 0.3479 0.7276 2.1475 0.0146 0.1212 95.9 100.0\nPP - Censor at switch 0.2373 0.0665 0.0663 0.1371 0.4115 -0.9973 0.9989 0.0 100.0\nRobins and Tsiatis -\nLogrank\n1.2882 - 0.3862 0.6906 2.2552 0.0536 0.1521 93.8 100.0\nRobins and Tsiatis - Cox 1.2855 - 0.3874 0.6868 2.2531 0.0509 0.1527 93.9 96.3\nRobins and Tsiatis -\nExponential\n1.3036 - 0.3693 0.9172 1.9617 0.0691 0.1412 83.6 100.0\nRobins and Tsiatis -\nWeibull\n1.2879 - 0.3857 0.6988 2.2550 0.0534 0.1516 94.5 100.0\nBranson and Whitehead 1.2841 0.2497 0.3619 0.8772 1.8802 0.0495 0.1334 83.7 100.0\nWalker et al 2.1037 0.7802 0.7791 1.0276 4.4146 0.8692 1.3624 70.0 99.8\nHazard ratio methods\nITT 0.8073 0.0812 0.0814 0.6629 0.9833 0.1073 0.0181 71.5 100.0\nPP - Exclude switchers 0.7179 0.1009 0.1019 0.5451 0.9457 0.0179 0.0107 94.8 100.0\nPP - Censor at switch 1.6825 0.2388 0.2454 1.2740 2.2223 0.9825 1.0256 0.0 100.0\nTime-dependent\ncovariate\n2.4211 0.3257 0.3396 1.8602 3.1516 1.7211 3.0776 0.0 100.0\nLaw and Kaldor 0.8110 0.1064 0.1046 0.6271 1.0488 0.1110 0.0233 81.2 100.0\nLoeys and Goethebeur 0.5248 - 0.1728 0.2544 1.0233 -0.1752 0.0606 83.8 99.0\n0.7 & 2.04 AFT methods\nITT 1.5845 0.3208 0.3294 1.0657 2.3569 -0.4563 0.3167 72.2 100.0\nPP - Exclude switchers 2.0610 0.1009 0.6062 1.1886 3.5793 0.0202 0.3679 94.4 100.0\nPP - Censor at switch 0.3894 0.1088 0.1126 0.2254 0.6742 -1.6514 2.7398 0.0 100.0\nRobins and Tsiatis -\nLogrank\n2.1120 - 0.6624 1.1204 3.8159 0.0712 0.4439 94.8 100.0\nRobins and Tsiatis - Cox 2.1062 - 0.6612 1.1095 3.8198 0.0654 0.4415 95.1 92.6\nRobins and Tsiatis -\nExponential\n2.1121 - 0.6636 1.3323 3.3923 0.0713 0.4455 87.4 100.0\nRobins and Tsiatis -\nWeibull\n2.1128 - 0.6631 1.1249 3.8301 0.0719 0.4449 94.9 100.0\nBranson and Whitehead 2.0536 0.4177 0.6096 1.3787 3.0601 0.0127 0.3718 83.0 100.0\nWalker et al 3.6581 1.3293 1.2498 1.8098 7.5537 1.6172 4.1774 63.9 98.0\nMorden et al. BMC Medical Research Methodology 2011, 11:4\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4\nPage 10 of 20\n\u2018good\u2019 and \u2018poor\u2019 prognosis groups (10 and 14), with\nmean treatment effects of 4.20 and 4.25 over double the\ntrue treatment effect of 2.04.\nThe Law & Kaldor and Loeys & Goetghebeur methods\nboth gave biased estimates in these four scenarios.\nThese biases were particularly large in scenarios with a\nhigh proportion of switchers (6 and 14). The Law &\nKaldor method seems to underestimate the true treat-\nment effect in all scenarios which is likely to be due to\nthe way in which the method conditions on future\nTable 5 Scenarios 9 & 10: 30% \u2018good\u2019 prognosis, \u00d73 \u2018good\u2019 prognosis survival, 10% and 25% switching probabilities,\n100% treatment effect for switchers, uniform distribution for switching times\nTrue HR and\ne\u03c8\nMethod Mean\nestimate\nMean\nSE\nSE of\nmean\n95%\nConfidence\ninterval\nBias MSE Coverage\n(%)\nSuccessful\nestimation (%)\nLower Upper\nHazard ratio methods\nITT 0.9136 0.0911 0.0926 0.7515 1.1107 0.0136 0.0088 94.8 100.0\nPP - Exclude switchers 0.9235 0.0979 0.0968 0.7504 1.1367 0.0235 0.0099 94.6 100.0\nPP - Censor at switch 1.0721 0.1137 0.1128 0.8709 1.3197 0.1721 0.0424 63.7 100.0\nTime-dependent\ncovariate\n1.2253 0.1249 0.1254 1.0035 1.4962 0.3253 0.1215 15.2 100.0\nLaw and Kaldor 0.9121 0.1173 0.1223 0.7088 1.1737 0.0121 0.0151 94.1 100.0\nLoeys and Goethebeur 0.8933 - 0.1137 0.6975 1.1444 -0.0067 0.0130 95.3 100.0\n0.9 & 1.23 AFT methods\nITT 1.2399 0.2523 0.2519 0.8323 1.8479 0.0054 0.0635 94.7 100.0\nPP - Exclude switchers 1.2159 0.0979 0.2580 0.7959 1.8583 -0.0187 0.0669 94.9 100.0\nPP - Censor at switch 0.8983 0.1911 0.1890 0.5922 1.3632 -0.3363 0.1488 64.4 100.0\nRobins and Tsiatis -\nLogrank\n1.2838 - 0.3018 0.8085 2.0389 0.0492 0.0935 94.6 100.0\nRobins and Tsiatis - Cox 1.2854 - 0.3020 0.8073 2.0820 0.0508 0.0938 94.7 95.2\nRobins and Tsiatis -\nExponential\n1.2895 - 0.2934 0.9593 1.8561 0.0549 0.0891 84.8 99.8\nRobins and Tsiatis -\nWeibull\n1.2836 - 0.3003 0.8153 2.0802 0.0490 0.0926 94.5 99.8\nBranson and Whitehead 1.2713 0.2589 0.2823 0.8530 1.8954 0.0368 0.0810 92.9 100.0\nWalker et al 2.9706 1.4458 1.4409 1.1904 20.7004 1.7360 5.0898 57.0 98.6\nHazard ratio methods\nITT 0.7390 0.0760 0.0777 0.6041 0.9041 0.0390 0.0076 92.0 100.0\nPP - Exclude switchers 0.7267 0.0791 0.0800 0.5872 0.8995 0.0267 0.0071 93.8 100.0\nPP - Censor at switch 0.8418 0.0918 0.0938 0.6798 1.0422 0.1418 0.0289 60.1 100.0\nTime-dependent\ncovariate\n0.9698 0.1012 0.1054 0.7904 1.1899 0.2698 0.0839 14.8 100.0\nLaw and Kaldor 0.7397 0.0998 0.1027 0.5679 0.9637 0.0397 0.0121 92.8 100.0\nLoeys and Goethebeur 0.6840 - 0.0908 0.5243 0.8886 -0.0160 0.0085 95.5 100.0\n0.7 & 2.04 AFT methods\nITT 1.9110 0.4010 0.4163 1.2669 2.8838 -0.1298 0.1901 92.5 100.0\nPP - Exclude switchers 1.9836 0.0791 0.4501 1.2841 3.0655 -0.0573 0.2059 94.7 100.0\nPP - Censor at switch 1.4612 0.3165 0.3284 0.9560 2.2344 -0.5796 0.4438 59.4 100.0\nRobins and Tsiatis -\nLogrank\n2.1150 - 0.5430 1.3172 3.4305 0.0742 0.3004 94.7 100.0\nRobins and Tsiatis - Cox 2.1140 - 0.5395 1.2935 27.2997 0.0732 0.2964 94.9 92.2\nRobins and Tsiatis -\nExponential\n2.1112 - 0.5439 1.4578 3.1966 0.0704 0.3008 87.4 100.0\nRobins and Tsiatis -\nWeibull\n2.1150 - 0.5434 1.3189 3.5350 0.0742 0.3008 94.8 100.0\nBranson and Whitehead 2.0643 0.4343 0.4923 1.3670 3.1186 0.0235 0.2430 92.2 100.0\nWalker et al 4.1987 2.1153 1.6132 1.6252 17.0861 2.1579 7.2589 68.2 75.4\nMorden et al. BMC Medical Research Methodology 2011, 11:4\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4\nPage 11 of 20\nevents as described by White [13]. Therefore the\nassumptions made for this method are not met and\nbiases given are likely to be less predictable for a real\ndataset. The Loeys & Goetghebeur method consistently\noverestimates the true treatment effect which is perhaps\nsurprising given the method makes the assumption of\nall-or-nothing compliance, and therefore assumes that a\nswitching patient receives more of the experimental\ntreatment than they actually do. This means that any\npositive treatment effect seen will actually be due to a\nsmaller amount of treatment than accounted for by the\nmethod, so an underestimation of the true treatment\neffect might be expected. The Robins and Tsiatis\nmethod when used with all tests gave very similar mean\nTable 6 Scenarios 13 & 14: 30% \u2018good\u2019 prognosis, \u00d73 \u2018good\u2019 prognosis survival, 50% and 75% switching probabilities,\n100% treatment effect for switchers, uniform distribution for switching times\nTrue HR and\ne\u03c8\nMethod Mean\nestimate\nMean\nSE\nSE of\nmean\n95%\nConfidence\ninterval\nBias MSE Coverage\n(%)\nSuccessful\nestimation (%)\nLower Upper\nHazard ratio methods\nITT 0.9406 0.0940 0.0965 0.7733 1.1442 0.0406 0.0110 92.2 100.0\nPP - Exclude switchers 1.0018 0.1448 0.1472 0.7547 1.3300 0.1018 0.0320 89.6 100.0\nPP - Censor at switch 2.2865 0.3323 0.3282 1.7198 3.0403 1.3865 2.0301 0.0 100.0\nTime-dependent\ncovariate\n3.2815 0.4544 0.4520 2.5017 4.3050 2.3815 5.8757 0.0 100.0\nLaw and Kaldor 0.9508 0.1230 0.1263 0.7379 1.2251 0.0508 0.0185 93.7 100.0\nLoeys and Goethebeur 0.8548 - 0.2874 0.4414 1.7657 -0.0452 0.0847 93.6 99.9\n0.9 & 1.23 AFT methods\nITT 1.1696 0.2386 0.2446 0.7843 1.7447 -0.0650 0.0640 92.6 100.0\nPP - Exclude switchers 1.0631 0.1448 0.3143 0.5983 1.8922 -0.1715 0.1282 90.0 100.0\nPP - Censor at switch 0.2100 0.0626 0.0640 0.1172 0.3769 -1.0246 1.0539 0.0 100.0\nRobins and Tsiatis -\nLogrank\n1.2876 - 0.4161 0.6611 2.3440 0.0530 0.1759 94.4 100.0\nRobins and Tsiatis - Cox 1.2835 - 0.4156 0.6581 2.3451 0.0489 0.1751 94.4 95.9\nRobins and Tsiatis -\nExponential\n1.3120 - 0.3923 0.9033 2.0554 0.0774 0.1599 84.0 99.7\nRobins and Tsiatis -\nWeibull\n1.2898 - 0.4125 0.6781 2.3512 0.0553 0.1732 94.5 99.8\nBranson and Whitehead 1.2789 0.2613 0.3755 0.8571 1.9090 0.0443 0.1429 82.6 100.0\nWalker et al 2.6653 0.9576 0.9545 1.3297 5.5524 1.4307 2.9579 46.7 99.9\nHazard ratio methods\nITT 0.8109 0.0842 0.0843 0.6616 0.9939 0.1109 0.0194 71.4 100.0\nPP - Exclude switchers 0.7834 0.1147 0.1158 0.5880 1.0437 0.0834 0.0204 89.7 100.0\nPP - Censor at switch 1.7695 0.2612 0.2559 1.3250 2.3634 1.0695 1.2092 0.0 100.0\nTime-dependent\ncovariate\n2.5841 0.3613 0.3598 1.9647 3.3991 1.8841 3.6791 0.0 100.0\nLaw and Kaldor 0.8147 0.1113 0.1125 0.6233 1.0649 0.1147 0.0258 81.4 100.0\nLoeys and Goethebeur 0.5287 - 0.1897 0.2352 1.0444 -0.1713 0.0653 86.9 96.9\n0.7 & 2.04 AFT methods\nITT 1.5826 0.3351 0.3379 1.0452 2.3973 -0.4582 0.3242 72.8 100.0\nPP - Exclude switchers 1.7560 0.1147 0.5427 0.9817 3.1462 -0.2849 0.3757 90.5 100.0\nPP - Censor at switch 0.3494 0.1032 0.1020 0.1961 0.6240 -1.6914 2.8712 0.0 100.0\nRobins and Tsiatis -\nLogrank\n2.1469 - 0.7376 1.0853 4.0598 0.1061 0.5552 95.7 100.0\nRobins and Tsiatis - Cox 2.1363 - 0.7256 1.0640 4.0757 0.0955 0.5356 95.9 92.4\nRobins and Tsiatis -\nExponential\n2.1549 - 0.7419 1.3002 3.6453 0.1140 0.5635 88.4 100.0\nRobins and Tsiatis -\nWeibull\n2.1472 - 0.7359 1.0961 4.0901 0.1064 0.5528 95.6 100.0\nBranson and Whitehead 2.0328 0.4340 0.6210 1.3380 3.0899 -0.0080 0.3857 82.6 100.0\nWalker et al 4.2491 1.5202 1.2616 2.1208 8.6357 2.2083 6.4681 45.3 88.3\nMorden et al. BMC Medical Research Methodology 2011, 11:4\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4\nPage 12 of 20\nestimates of e\u03c8 , not differing by any more than 0.02, on\nthe hazard ratio scale, in these four scenarios. In all\ncases the mean estimate of e\u03c8 was greater than the true\ntreatment effect of 2.04, suggesting the method is con-\nsistently over-adjusting for treatment switching. The\nmean upper confidence limits given by the Cox model\ntest based method were erratic, suggesting they were\nbeing unduly influenced by a few large values. There\nwere also some estimation problems with this method,\nparticularly in scenario 14 with 7.6% of simulations\nunsuccessful when estimating either e\u03c8 or its upper or\nlower confidence limits.\nVery small biases were observed from the Branson and\nWhitehead method, less than any other AFT method in\nscenarios 6, 10 and 14. The method also appears to be\nvery robust to more extreme simulated datasets, with\n100% successful estimation. Coverage for this method\nwas lower than expected, as low as 82.6% in scenario 14.\nHowever, as discussed previously, standard errors calcu-\nlated from the final regression in the algorithm tend to\nbe too small, giving unduly narrow confidence intervals\nand therefore lower coverage.\nThe relationships between point estimates from each\nmethod in scenario 14 were further investigated through\npairwise scatter plots which can be seen in Figures 3\nand 4. Vertical and horizontal reference lines show the\ntrue treatment effect of b = 0.7 for adjusted hazard ratio\nmethods in Figure 3 or e\u03c8 = 2.04 for AFT methods in\nFigure 4.\nThe relationship between ITT and PP estimates\nappears to be fairly weak, reflecting the unpredictabil-\nity of estimates due to biases in this particular sce-\nnario. The plots also further illustrate dilution of the\ntrue treatment effect when analysing patients as-\nrandomised.\nThe scatter plot for AFT methods shows the strong\nrelationship between estimates from the Robins &\nTsiatis method when using logrank, Cox, exponential or\nWeibull tests. Relationships between these estimates and\nthose from the Branson & Whitehead method are also\nstrong, although less so than between the Robins &\nTsiatis methods themselves. This is to be expected as\nthe model used by Branson & Whitehead takes the\nsame form as that presented by Robins & Tsiatis, differ-\ning only by the way in which the estimate of \u03c8 is found.\nScatter plots for scenarios 2, 6 and 10 showed similar\nrelationships between parameter estimates.\nSize of true treatment effect\nAll scenarios focussed on up to this point have had a\nlarge true treatment effect (a hazard ratio b = 0.7 or e\u03c8\n= 2.04). As seen previously, biases seen from excluding\nITT\nLK\nLG\nTVC\nPP\u2212EXC\nPP\u2212CENS\nM\net\nho\nd\n.6 .8 1 1.2\nHazard ratio\nScenario 2\nITT\nLK\nLG\nTVC\nPP\u2212EXC\nPP\u2212CENS\nM\net\nho\nd\n1 2 3 4\nHazard ratio\nScenario 6\nITT\nLK\nLG\nTVC\nPP\u2212EXC\nPP\u2212CENS\nM\net\nho\nd\n.6 .8 1 1.2\nHazard ratio\nScenario 10\nITT\nLK\nLG\nTVC\nPP\u2212EXC\nPP\u2212CENS\nM\net\nho\nd\n1 2 3 4\nHazard ratio\nScenario 14\nFigure 1 Mean estimates and confidence limits for adjusted hazard ratio methods from Scenarios 2, 6, 10 and 14. Note: Mean upper\nconfidence limits truncated at b = 4. Vertical lines show true treatment effect (b = 0.7).\nMorden et al. BMC Medical Research Methodology 2011, 11:4\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4\nPage 13 of 20\nITT\nRT\u2212LR\nRT\u2212COX\nRT\u2212EXP\nRT\u2212WB\nBW\nWALK\nPP\u2212EXC\nPP\u2212CENS\nM\net\nho\nd\n1 2 3 4 5\nexp(psi)\nScenario 2\nITT\nRT\u2212LR\nRT\u2212COX\nRT\u2212EXP\nRT\u2212WB\nBW\nWALK\nPP\u2212EXC\nPP\u2212CENS\nM\net\nho\nd\n1 2 3 4 5\nexp(psi)\nScenario 6\nITT\nRT\u2212LR\nRT\u2212COX\nRT\u2212EXP\nRT\u2212WB\nBW\nWALK\nPP\u2212EXC\nPP\u2212CENS\nM\net\nho\nd\n1 2 3 4 5\nexp(psi)\nScenario 10\nITT\nRT\u2212LR\nRT\u2212COX\nRT\u2212EXP\nRT\u2212WB\nBW\nWALK\nPP\u2212EXC\nPP\u2212CENS\nM\net\nho\nd\n1 2 3 4 5\nexp(psi)\nScenario 14\nFigure 2 Mean estimates and confidence limits for AFT methods from Scenarios 2, 6, 10 and 14. Note: Mean upper confidence limits\ntruncated at e\u03c8 = 5 Vertical lines show true treatment effect (e\u03c8 = 2.04).\nITT\nPP\u2212EXC\nPP\u2212CENS\nRT\u2212LR\nRT\u2212COX\nRT\u2212EXP\nRT\u2212WB\nBW\nWALK\n1\n2\n3\n1 2 3\n1\n2\n3\n1 2 3\n1\n2\n3\n1 2 3\n1\n2\n3\n1 2 3\n1\n2\n3\n1 2 3\n1\n2\n3\n1 2 3\n1\n2\n3\n1 2 3\n1\n2\n3\n1 2 3\n1\n2\n3\n1 2 3\nFigure 3 Scatter plot matrix of hazard ratio method point estimates from Scenario 14.\nMorden et al. BMC Medical Research Methodology 2011, 11:4\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4\nPage 14 of 20\nall switching patients from the analysis were perhaps not\nas large as expected. The way in which simulated data-\nsets were generated meant that patients who switch\ntreatments should in general have worse prognosis than\nthose who do not, so excluding these patients from the\nanalysis should make the control group have better sur-\nvival in general and therefore reduce the observed differ-\nence between control and experimental groups.\nHowever, these switching patients also go on to receive\na beneficial treatment, perhaps meaning their survival is\napproximately similar to the control patients who do\nnot switch treatments. If this was the case, excluding\nthese patients would have a relatively small effect on the\nestimate of the true treatment effect.\nTo investigate the competing factors acting upon\npatients who switch treatments in these simulations, we\nconsider scenarios 9 and 13, which are identical to\nscenarios 10 and 14 respectively except with a smaller\ntrue treatment effect of b = 0.9 or e\u03c8 = 1.23. Scenarios 9\nand 10 have probabilities of 10% and 25% of switching\ntreatments in \u2018good\u2019 and \u2018poor\u2019 prognosis groups\nwhereas 13 and 14 have switching probabilities of 50%\nand 75%. Full details of these scenarios can be found in\nTable 2. Full results can be found in Tables 5 and 6.\nIn general, biases observed were greater in scenarios with\na larger true treatment effect than a small effect. A notable\nexception to this can be seen when comparing scenarios 13\nand 14 (Table 6). The bias when excluding switchers was\ngreater in scenario 13 with a small treatment effect. This\nmay be because patients in this scenario who switch treat-\nment have worse prognosis but this is \u201ccorrected\u201d to a les-\nser extent by the treatment they switch onto, making the\ncontrol arm switchers and non-switchers less similar than\nin scenario 14 with a larger true treatment effect.\nThe Branson & Whitehead method also seems to have\nlarger bias in scenarios with a smaller treatment effect.\nHowever, these biases are still small, with the mean esti-\nmate of e\u03c8 closer to the true value than when excluding\nswitchers in both scenarios 13 and 14. There also\nappears to be a greater difference between estimates\ngiven by the various Robins & Tsiatis methods when the\ntrue treatment effect is smaller as in scenario 13,\nalthough estimates are still strongly related.\nSuccessful estimation\nMost of the methods investigated successfully gave an\nestimate of the treatment effect in all scenarios. How-\never some of the methods experienced problems in\ncertain situations.\nThe Walker et al parametric method was particularly\nunsuccessful in scenarios with a large difference in sur-\nvival between \u2018good\u2019 and \u2018poor\u2019 prognosis groups and a\nITT\nPP\u2212EXC\nPP\u2212CENS\nTVC\nLK\nLG\n.4\n.7\n1\n.4 .7 1\n.4\n.7\n1\n.4 .7 1\n.4\n.7\n1\n.4 .7 1\n.4\n.7\n1\n.4.7 1\n.4\n.7\n1\n.4 .7 1\n.4\n.7\n1\n.4 .7 1\nFigure 4 Scatter plot matrix of AFT method point estimates from Scenario 14.\nMorden et al. BMC Medical Research Methodology 2011, 11:4\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4\nPage 15 of 20\nlarge true treatment effect, most notably in scenario 12\nwhere the method was successful for only 43.9% of\nsimulated datasets. These problems may have been due\nto the way the method was implemented in Stata, where\nattempts to find a maximum likelihood estimate failed\nto converge. This is further evidence that the method\nmay not be suitable for use, especially given the true\ntreatment effect would not be known in real life.\nSome estimation problems were also seen with the\nRobins & Tsiatis methods when used with a Cox,\nWeibull or exponential test. Given the similarities\nbetween estimates with each test, the logrank test would\nseem to be the most appropriate choice for this method\nas it was 100% successful for all scenarios.\nExtension of the Branson & Whitehead method\nAs seen previously, the method of Branson & White-\nhead performed well, giving particularly small biases in\nscenarios with a large difference in survival between\n\u2018good\u2019 and \u2018poor\u2019 prognosis groups and a large propor-\ntion of switchers, scenarios which other methods gave\nvery biased estimates for (see Tables 4, 5 and 6).\nOne of the limitations of this method and its practical\nuse is that estimates are given in the AFT model form\nwhich is less commonly seen in medical literature than\nhazard ratios from a proportional hazards model [34].\nHowever, as seen previously if the shape parameter of\nthe Weibull model g is known, hazard ratios can be con-\nverted to the AFT parameter \u03c8.\nRearranging (7) gives the following expression for the\nhazard ratio b in terms of \u03c8 and g :\n\uf062 \uf079= \u2212exp( )\u03b3 (10)\nBy taking the value of g estimated in the final iteration\nof the IPE algorithm, a hazard ratio b can be estimated\nfrom the method using (10). The standard error of b\ncan be calculated using the Delta method as described\nby Collett [19]. However, these standard errors are likely\nto be too small as the standard errors of \u03c8 and g from\nwhich they are calculated are also too small, as\ndescribed previously. Note that this conversion to a\nhazard ratio would not be possible for the other AFT\nmethods presented here as they do not directly estimate\na shape parameter, g, from the data.\nTo investigate this extension to the Branson and\nWhitehead method further, simulations for the scenarios\nfocused on previously (2, 6, 10 and 14) were repeated,\nwith g estimated from the last iteration of the Branson\n& Whitehead method and used to calculate a hazard\nratio and its corresponding standard error as described\nabove. This was compared to hazard ratios from both\nintention-to-treat and per-protocol approaches for the\nsame simulated data. Table 7 shows mean estimates,\nbias and the mean standard error for each of the four\nscenarios.\nAs seen previously, estimates from the ITT approach\nare biased towards the null in all four scenarios. This\nbias is particularly large in scenarios 6 and 14 which\nhave a higher proportion of patients switching from the\ncontrol arm.\nThere is very little difference between the mean\nhazard ratios for the PP and Branson & Whitehead\nmethods in scenarios 2 and 6, with the PP approach giv-\ning relatively unbiased estimates due to the small differ-\nence in survival between \u2018good\u2019 and \u2018poor\u2019 prognosis\npatients. However, when this difference is increased in\nscenarios 10 and 14, the bias from the PP method\nincreases, most notably in scenario 14 where the differ-\nence between prognosis groups is coupled with a large\nproportion of patients switching. The Branson & White-\nhead method gives estimates close to the true treatment\neffect for all four scenarios. The method copes particu-\nlarly well with the large potential biases in scenario 14,\ngiving a mean hazard ratio of 0.73 compared to 0.78\nand 0.81 from the PP and ITT approaches respectively.\nTable 7 Comparison of mean hazard ratios from the Branson & Whitehead method and ITT and PP approaches\nScenario Method Mean HR Bias Mean SE\n2 ITT 0.7346 0.0346 0.0734\n(\u00d71.2 \u2019Good\u2019 prognosis survival, 10% and 25% switching probabilities) PP - Exclude switchers 0.7071 0.0071 0.0746\nBranson and Whitehead 0.7077 0.0077 0.0708\n6 ITT 0.8030 0.1030 0.0808\n(\u00d71.2 \u2019Good\u2019 prognosis survival, 50% and 75% switching probabilities) PP - Exclude switchers 0.7153 0.0153 0.1004\nBranson and Whitehead 0.7172 0.0172 0.0724\n10 ITT 0.7411 0.0411 0.0763\n(\u00d73 \u2019Good\u2019 prognosis survival, 10% and 25% switching probabilities) PP - Exclude switchers 0.7280 0.0280 0.0793\nBranson and Whitehead 0.7165 0.0165 0.0738\n14 ITT 0.8121 0.1121 0.0843\n(\u00d73 \u2019Good\u2019 prognosis survival, 50% and 75% switching probabilities) PP - Exclude switchers 0.7810 0.0810 0.1142\nBranson and Whitehead 0.7325 0.0325 0.0762\nMorden et al. BMC Medical Research Methodology 2011, 11:4\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4\nPage 16 of 20\nThe Branson & Whitehead method seems to be robust\nand to correct for treatment switching most successfully\nof all methods investigated in situations where a\npatient\u2019s switching pattern is strongly related to their\nprognosis. The fact that the method can give hazard\nratios providing g is estimated from the final iteration of\nthe algorithm is a further advantage if the method were\nto be more widely used in the analysis of clinical trials.\nDiscussion\nAs expected, adopting an ITT approach underestimated\nthe known treatment effect, most notably in scenarios\nwhere a high proportion of patients switched treatments.\nResults of the ITT analysis are important as they reflect\nthe overall effectiveness of a treatment policy if it were\nintroduced on a wider scale, but in some situations\nmeasures of appropriate policy effectiveness are needed\nin order to answer the relevant policy question.\nCommonly adopted approaches of censoring patients\nat their switching time or considering treatment as a\ntime-dependent covariate were found to be particularly\ninappropriate, giving biased estimates of the true treat-\nment effect in situations where a patient\u2019s switching pat-\ntern is strongly related to their underlying prognosis.\nExcluding switching patients from the analysis alto-\ngether gave relatively small biases in situations with a\nlow proportion of switchers, but selection bias increased\nas switching probabilities increased. Biases from this\napproach were fairly predictable in this simulation\nstudy, but they are likely to be far less so if the approach\nwas applied to real life trials where the underlying prog-\nnosis of each patient, and the true treatment effect, are\nnot known.\nThe Loeys & Goetghebeur method generally gave\nbiased estimates which may be due to the fact that\nsimulations conducted here assumed patients received\nat least some of their initial treatment, making the\n\u201call-or-nothing\u201d assumption inappropriate.\nLaw & Kaldor\u2019s method gave fairly small biases in\nsome scenarios, although the direction of these was dif-\nficult to predict. In addition, questions remain about the\nway in which the method conditions on future events\nwhich may bias results towards the null [13,22].\nThe method of Branson & Whitehead gave the smal-\nlest biases of all methods in situations where the poten-\ntial for selection bias was high. The method performed\nparticularly well when the difference in survival between\n\u2018good\u2019 and \u2018poor\u2019 prognosis patients was high, which\nmeant patients who switched had worse underlying sur-\nvival than those who did not. The method was also par-\nticularly robust in scenarios with a high proportion of\npatients who switched, and successfully gave a para-\nmeter estimate for all simulated datasets in all of the\nscenarios presented here. The method did not suffer any\nconvergence problems unlike some of the other meth-\nods investigated. It was also demonstrated how the esti-\nmates of e\u03c8 can be converted to a hazard ratio scale,\novercoming one of the main problems with the method\nbeing adopted on a wider scale for the analysis of clini-\ncal trials with switching patients. In addition, decision\nmodels are usually designed in such a way that treat-\nment effects are incorporated using hazard ratios The\nmethod of Robins & Tsiatis also gave estimates close to\nthe true treatment effect, but biases were larger than\nthose from the Branson & Whitehead method. The\ninterval bisection method used is more computationally\nintensive than the IPE algorithm used in the Branson &\nWhitehead method. Concerns have been raised pre-\nviously about how the Branson & Whitehead method\ndeals with censoring, with the recensoring used as part\nof the Robin & Tsiatis method said to be more appro-\npriate [35]. Further investigations into situations with a\nhigher proportion of censored observations are needed.\nProblems were seen with the Walker parametric\nmethod which gave biased estimates and had estimation\nproblems, most notably in scenarios with a high propor-\ntion of switchers. These estimation problems may be\ndue to the way the method was implemented in Stata\nwhere convergence to a maximum likelihood estimate\nwas often not achieved. It may be possible for a single\ndataset to try different initial values and estimating\nmethods, but this was not feasible in our simulation\nstudy.\nLimitations\nThere is a limit to the number of possible scenarios that\ncan be looked at in any simulation study. Clearly there\nis a need for further simulation work involving many\ninteresting trial variables whose spread of values, indivi-\ndually and in combination could be explored. Most\nimportant is the need to assess the performance of\nmethods seen to be successful here in scenarios which\nviolate their model assumptions. It may have been of\ninterest to consider scenarios with even greater potential\nfor selection bias and see how well each method per-\nformed. An even greater difference in survival between\n\u2018good\u2019 and \u2018poor\u2019 prognosis groups could have been\nintroduced which should ensure that patients who\nswitch and those who do not differ greatly in their\nunderlying survival. In addition, the scenarios consid-\nered all reflect broadly patients with advanced disease,\ni.e. events are relatively common; how well the various\nmethods perform in patient populations with less severe\ndisease and therefore fewer events would also be of\ninterest.\nOnly two true treatment effects were looked at, hazard\nratios of 0.9 and 0.7 to represent relatively small and\nlarge treatment effects. More values could be\nMorden et al. BMC Medical Research Methodology 2011, 11:4\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4\nPage 17 of 20\ninvestigated, possibly an even larger true effect such as a\nhazard ratio of 0.5, or a scenario where the treatment\nwhich patients were switching onto actually had a nega-\ntive effect, so a hazard ratio of greater than 1 (or e\u03c8 <1).\nThe second of these scenarios would involve a patient\u2019s\nobserved survival time being shorter than their underly-\ning event time, a situation in which the recensoring\nused by the Branson & Whitehead method could be\nadapted [35].\nThe method of Branson & Whitehead involves fitting\nparametric models to the data. In this paper a Weibull\ndistribution was used for this, which allowed the conver-\nsion to hazard ratios as described previously. Other\nparametric distributions commonly used with AFT\nmodels could also be used to find an estimate of \u03c8\nalthough the same conversion to the hazard ratio scale\nwould not be possible. For example the log-logistic\ndistribution could be used which can deal with non-\nmonotonic hazard functions unlike the Weibull [19].\nBranson & Whitehead suggest that a distribution is cho-\nsen which best fits the experimental data [23]. A limita-\ntion of this work may be that we used a Weibull\ndistribution for our application of the Branson & White-\nhead method, and also used a Weibull to generate our\nsimulated data. Potentially, this could make the Branson\n& Whitehead method appear artificially successful.\nFurther work could be done to investigate how well the\nmethod would perform with different choices of distri-\nbution, or when applied to data generated from a differ-\nent distribution.\nIn simulated datasets patient\u2019s switching times were gen-\nerated from a uniform distribution meaning they were\nequally likely to switch at any point during their follow-up.\nThis assumption may not be valid in all trial settings and\nit would be of interest to investigate other switching time\ndistributions, perhaps where the probability of switching is\nexpressed as a function of time since randomisation.\nAs discussed previously, standard errors given from the\nlast iteration of the IPE algorithm in the Branson &\nWhitehead method may be too small, with bootstrapping\nrequired to give standard errors of the correct size. Given\nthe large number of scenarios considered, and the fact\nthat each of these required 1000 simulations, it was not\npossible to perform bootstrapping for every one of these.\nAn initial investigation into this was made by repeating\nsimulations for scenario 14 (for which the Branson &\nWhitehead method previously gave a relatively low cov-\nerage of 82.6%) with confidence intervals calculated from\n100 bootstrapped samples using the normal approxima-\ntion method. When using bootstrapping coverage\nimproved to 94.1%.\nThe simulation study presented only considered the\nsituation where patients switch from the control arm to\nreceive experimental treatment. In reality patients may\nswitch in both directions. For example, some patients\nmay suffer severe side-effects from the experimental\ntreatment and be advised to switch to the control arm.\nThe method of Robins & Tsiatis as implemented through\nthe strbee program in Stata does allow switches in both\ndirections to be adjusted for. Branson & Whitehead also\nstate their method can be extended to deal with switch-\ning in both directions, although this is yet to be imple-\nmented. Further investigation could be done into the way\nthese methods perform in this more complex situation.\nWe have not covered adjusting for baseline covariates,\nwhich can be used to control for imbalances between\ntreatment arms (although this is unlikely in large rando-\nmised trials) [36]. Differences in baseline covariates may\nalso account for some of the differences in switching pat-\ntern between patients, for example patients of a certain\nage may be more or less likely to switch treatment groups.\nAdjusting for these baseline covariates could therefore\nreduce the biases seen when using some of the simple\nmethods. Branson & Whitehead describe how their\nmethod is easily extended by simply including variables in\nthe models fitted as part of the IPE algorithm. Investiga-\ntions could be performed into this and the extent to which\nadjusting for baseline covariates can reduce the selection\nbias observed from the simple methods.\nAll methods presented give one overall treatment\neffect and are therefore not necessarily suitable in situa-\ntions where the treatment effect for patients who switch\nonto a treatment is not the same as for those who were\ninitially allocated to the experimental treatment arm.\nThis may be particularly important in disease areas such\nas cancer where treatment switching typically occurs\nupon disease progression. For example, a recent NICE\nappraisal of treatments for colorectal cancer [37] found\ntreatment to be around half as effective for patients who\nswitched onto the treatment compared to those who\nreceived it from the start of the trial. To properly deal\nwith this situation, new methodology may be needed\nwhich gives two different estimates of treatment effect\ndependent on the time from randomisation or stage of\ndisease at commencement of treatment.\nFurther methods for dealing with treatment switching\nwhich have been published in medical literature were not\ninvestigated. A large body of work into causal inference\nto adjust for post-treatment variables (of which treatment\nswitching would be a special case) has been conducted\n[38], which may merit further investigation. Hernan et al\n[39] put forward a method in which patients are censored\nat the point of their treatment switch but then use\ninverse probability weighting to adjust for the selection\nbias this may introduce. Shao et al [40] build on the work\nof Branson and Whitehead by allowing the causal effect\nof treatment to differ between patients, although con-\ncerns have been raised about their method of estimation\nMorden et al. BMC Medical Research Methodology 2011, 11:4\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4\nPage 18 of 20\n[35]. Further investigation may be needed to compare\nthese methods with those presented in this paper.\nA recent simulation study by Odondi and McNamee\n[41] also compared methods for adjusting for non-\nrandom complicance, including the Loeys & Goetghe-\nbeur and Robins & Tsiatis methods considered here.\nThey concluded that all the methods they considered\ngave small biases, with the Robins & Tsiatis method per-\nforming the best in terms of bias and coverage. However\ntheir study differs from ours in the way data were simu-\nlated and in some of the outcome measures considered.\nAnother approach to the analysis of a trial of this sort\nwould be to make use of any external information there\nis about a treatment. Patients in the control group who\nswitch treatments could have their survival adjusted\nusing this prior information to estimate the survival time\nthey may have experienced if they had not switched.\nComparisons between treatment groups could then be\nmade as usual. This would, of course, depend on the\navailability and quality of external information about the\ntreatment and also the way in which switching had been\ndealt with in the previous studies, if relevant [42].\nConclusions\nWe have illustrated the problem of analysing data from\ntrials in which patients switch treatments and why the\nITT approach may not always be sufficient if the appro-\npriate policy effectiveness of a treatment is of interest.\nThe susceptibility of simple methods to selection bias\nwas also seen, particularly if patients who switch treat-\nments were not representative of all patients in the trial.\nGiven a trial in which a significant proportion of\npatients switch treatments, a method to adjust for this\nswitching could be used to find an improved estimate of\nthe appropriate policy effectiveness of the treatment.\nWhen reporting a trial with treatment crossover, the\nauthors should report the proportion of switchers, a sum-\nmary of the distribution of switching times and any evi-\ndence of a relationship between switching and relevant\nprognostic variables. Of the methods investigated here,\nthe Branson & Whitehead method gave the smallest bias\nand was seen to be robust in a variety of scenarios.\nFurther advantages of this method include the conversion\nof AFT estimates to hazard ratios and its possible exten-\nsion to trials in which patients switch in both directions\nbetween treatment arms, thus easily enabling inclusion of\nthe results into an economic decision model.\nAdditional material\nAdditional file 1: A pdf file containing Table A1: Results of\nScenarios 3 and 4.\nAdditional file 2: A pdf file containing Table A2: Results of\nScenarios 7 and 8.\nAdditional file 3: A pdf file containing Table A3: Results of\nScenarios 11 and 12.\nAdditional file 4: A pdf file containing Table A4: Results of\nScenarios 15 and 16.\nAcknowledgements\nWe would like to thanks Ian White for his advice on applying the methods\nin Stata and Judith Bliss for helpful comments on an earlier draft of this\npaper. JPM completed part of this work as part of an MSc at the University\nof Leicester funded by the EPSRC. We are grateful for financial support from\nthe NICE Decision Support Unit (DSU). NICE had no responsibility or control\nover the content of this paper. KRA is partly funded by the UK National\nInstitute for Health Research (NIHR) as a Senior Investigator (NF-SI-0508-\n10061).\nAuthor details\n1ICR-CTSU, The Institute of Cancer Research, Sir Richard Doll Building,\nCotswold Road, Sutton, Surrey, UK, SM2 5NG. 2Centre for Biostatistics and\nGenetic Epidemiology, Department of Health Sciences University of Leicester,\n2nd Floor Adrian Building, University Road, Leicester, UK, LE1 7RH. 3Health\nEconomics and Decision Science, ScHARR, University of Sheffield, Regent\nCourt, 30 Regent Street, Sheffield, UK, S1 4DA.\nAuthors\u2019 contributions\nKRA, PCL, AJW and NL conceived the project, and KRA and PCL guided JPM\nin conducting the project. KRA, AJW and NL sought funding for the study.\nAll authors participated in the design of the simulation study, and JPM\ncarried out the statistical analyses. All authors participated in interpretation\nof the study results. JPM drafted the paper, which was later revised by all\nco-authors through substantial contributions to the contents of the paper.\nAll authors read and approved the final version of the manuscript for\npublication.\nCompeting interests\nThe authors declare that they have no competing interests.\nReceived: 2 February 2010 Accepted: 11 January 2011\nPublished: 11 January 2011\nReferences\n1. Peduzzi P, Wittes J, Detre K: Analysis as-randomized and the problem of\nnonadherence - An example from the Veterans Affairs randomized trial\nof coronary-artery bypass-surgery. Statistics in Medicine 1993,\n12(13):1185-1195.\n2. Tappenden P, Chilcott J, Ward S, Eggington S, Hind D, Hummel S:\nMethodological issues in the economic analysis of cancer treatments.\nEuropean Journal of Cancer 2006, 42(17):2867-2875.\n3. White IR, Carpenter J, Pocock SJ, Henderson RA: Adjusting treatment\ncomparisons to account for non-randomized interventions: an example\nfrom an angina trial. Statistics in Medicine 2003, 22(5):781-793.\n4. NICE: The clinical effectiveness and cost effectiveness of trastuzumab for\nbreast cancer. TA 34 2002 [http:\/\/guidance.nice.org.uk\/TA34].\n5. Abrams K, Palmer S, Wailoo A: Bevacizumab, sorafenib, sunitinib and\ntemsirolimus for renal cell carcinoma. Decision Support Unit Report 2008\n[http:\/\/www.nice.org.uk\/nicemedia\/pdf\/\nRenalCellCarcinomaExtraWorkPreparedByDSU.pdf].\n6. White IR: Uses and limitations of randomization-based efficacy\nestimators. Statistical Methods in Medical Research 2005,\n14(4):327-347.\n7. Lee Y, Ellenberg J, Hirtz D, Nelson K: Analysis of clinical trials by treatment\nactually received: is it really an option? Stat Med 1991, 10:1595-1605.\n8. Fergusson D, Aaron SD, Guyatt G, Herbert P: Post-randomisation\nexclusions: the intention to treat principle and excluding patients from\nanalysis. BMJ 2002, 325:652-654.\n9. Goetghebeur E, Loeys T: Beyond intention to treat. Epidemiologic Reviews\n2002, 24:85-90.\n10. Horwitz R, Horwitz S: Adherence to treatment and health outcomes. Arch\nIntern Med 1993, 153:1863-1868.\nMorden et al. BMC Medical Research Methodology 2011, 11:4\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4\nPage 19 of 20\n11. White IR, Walker S, Babiker AG, Darbyshire JH: Impact of treatment\nchanges on the interpretation of the Concorde trial. Aids 1997,\n11(8):999-1006.\n12. Law MG, Kaldor JM: Survival analyses of randomized clinical trials\nadjusted for patients who switch treatments. Statistics in Medicine 1996,\n15:2069-2076.\n13. White IR: Letters to the editor: Survival analyses of randomized clinical\ntrials adjusted for patients who switch treatments. Statistics in Medicine\n1997, 16:2619-2625.\n14. Loeys T, Goetghebeur E: A causal proportional hazards estimator for the\neffect of treatment actually received in a randomized trial with all-or-\nnothing compliance. Biometrics 2003, 59:100-105.\n15. Kim LG, White IR: Compliance-adjusted intervention effects in survival\ndata. The Stata Journal 2004, 4(Number 3):257-264.\n16. Rubin D: More powerful randomization-based p-values in double-blind\ntrials with non-compliance. Statistics in Medicine 1998, 17:371-385.\n17. White IR: Stata software 2009 [http:\/\/www.mrc-bsu.cam.ac.uk\/Software\/stata.\nhtml].\n18. Jo B: Model misspecification sensitivity analysis in estimating causal\neffects of interventions with non-compliance. Statistics in Medicine 2002,\n21:3161-3181.\n19. Collett D: Modelling survival data in medical research Chapman and Hall;\n2003.\n20. Robins JM, Tsiatis AA: Correcting for non-compliance in randomized trials\nusing rank preserving structural failure time models. Communications in\nStatistics-Theory and Methods 1991, 20(8):2609-2631.\n21. White IR, Walker S, Babiker A: strbee: Randomization-based efficacy\nestimator. The Stata Journal 2002, 2(Number 2):140-150.\n22. White IR, Babiker AG, Walker S, Darbyshire JH: Randomization-based\nmethods for correcting for treatment changes: Examples from the\nConcorde trial. Statistics in Medicine 1999, 18(19):2617-2634.\n23. Branson M, Whitehead J: Estimating a treatment effect in survival studies\nin which patients switch treatment. Statistics in Medicine 2002,\n21:2449-2463.\n24. Efron B, Tibshirini R: An introduction to the bootstrap Monographs on\nStatistics and Applied Probability. Chapman and Hall London; 1993.\n25. Walker AS, White IR, Babiker AG: Parametric randomization-based\nmethods for correcting for treatment changes in the assessment of the\ncausal effect of treatment. Statistics in Medicine 2004, 23(4):571-590.\n26. Hougaard P: A class of multivariate failure time distributions. Biometrika\n1986, 73(3):671-678.\n27. Oakes D: Bivariate survival models induced by frailties. Journal of the\nAmerican Statistical Association 1989, 84(406):487-493.\n28. NICE: Guidance on the use of capecitabine for the treatment of locally\nadvanced or metastatic breast cancer, (TA 62). TA 62 2003 [http:\/\/\nguidance.nice.org.uk\/TA62].\n29. NICE: Gemcitabine for the treatment of metastatic breast cancer, (TA\n116). TA 116 2005 [http:\/\/guidance.nice.org.uk\/TA116].\n30. Bender R, Augustin T, Blettner M: Generating survival times to simulate\nCox proportional hazards models. Statistics in Medicine 2005, 24:1713-1723.\n31. Coleman M, Babb P, Damieckil P, Grosclaude P, Honjo S, Jones J, Knerer G,\nPitard A, Quinn M, Sloggett A, De Stavola B: Cancer survival trends in\nEngland and Wales, 1971-1995: deprivation and NHS region Office of National\nStatistics; 1999.\n32. Lambert P, Smith L, Jones D, Botha J: Additive and multiplicative\ncovariate regression models for relative survival incorporating fractional\npolynomials for time-dependent effects. Statistics in Medicine 2005,\n24:3871-3885.\n33. Burton A, Altman DG, Royston P, Holder RL: The design of simulation\nstudies in medical statistics. Statistics in Medicine 2006, 25:4279-4292.\n34. Bradburn M, Clark T, Love S, Altman D: Survival analysis part II:\nMulitvariate data analysis - an introduction to concepts and methods.\nBritish Journal of Cancer 2003, 89:431-436.\n35. White IR: Letter to the editor: Estimating treatment effects in\nrandomized trials with treatment switching. Statistics in Medicine 2006,\n25:1619-1622.\n36. White IR, Pocock SJ: Statistical reporting of clinical trials with individual\nchanges from allocated treatment. Statistics in Medicine 1996,\n15(3):249-262.\n37. NICE: Irinotecan, Oxaliplatin and Raltitrexed for Advanced Colorectal\nCancer (review of TA33). TA 93 2005 [http:\/\/guidance.nice.org.uk\/TA93].\n38. Frangakis C, Rubin D: Principal Stratification in Causal Inference. Biometrics\n2002, 58:21-29.\n39. Hernan M, Lanoy E, Costagliola D, Robins J: Comparison of Dynamic\nTreatment Regimes via Inverse Probability Weighting. Basic and Clinical\nPharmacology and Toxicology 2006, 98:237-242.\n40. Shao J, Chang M, Chow S: Statistical inference for cancer trials with\ntreatment switching. Statistics in Medicine 2005, 24:1783-1790.\n41. Odondi L, McNamee R: Performance of statistical methods for analysing\nsurvival data in the presence of non-random compliance. Statistics in\nMedicine 2010, 29:2994-3003.\n42. NICE: Bevacizumab (first-line), sorafenib (first- and second-line), sunitinib\n(second-line) and temsirolimus (first-line) for the treatment of advanced\nand\/or metastatic renal cell carcinoma. (TA 178). TA 178 2009 [http:\/\/\nguidance.nice.org.uk\/TA178].\nPre-publication history\nThe pre-publication history for this paper can be accessed here:\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4\/prepub\ndoi:10.1186\/1471-2288-11-4\nCite this article as: Morden et al.: Assessing methods for dealing with\ntreatment switching in randomised controlled trials: a simulation study.\nBMC Medical Research Methodology 2011 11:4.\nSubmit your next manuscript to BioMed Central\nand take full advantage of: \n\u2022 Convenient online submission\n\u2022 Thorough peer review\n\u2022 No space constraints or color figure charges\n\u2022 Immediate publication on acceptance\n\u2022 Inclusion in PubMed, CAS, Scopus and Google Scholar\n\u2022 Research which is freely available for redistribution\nSubmit your manuscript at \nwww.biomedcentral.com\/submit\nMorden et al. BMC Medical Research Methodology 2011, 11:4\nhttp:\/\/www.biomedcentral.com\/1471-2288\/11\/4\nPage 20 of 20\n"}