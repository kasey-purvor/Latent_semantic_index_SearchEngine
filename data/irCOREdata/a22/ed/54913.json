{"doi":"10.1109\/TVT.2004.842461","coreId":"54913","oai":"oai:eprints.lincoln.ac.uk:2333","identifiers":["oai:eprints.lincoln.ac.uk:2333","10.1109\/TVT.2004.842461"],"title":"Nonlinear observers for predicting state-of-charge and state-of-health of lead-acid batteries for hybrid-electric vehicles","authors":["Bhangu, B","Bentley, P","Stone, D A","Bingham, Chris"],"enrichments":{"references":[{"id":18444372,"title":"[13] V.H.Johnson,A.A.Pesaran,andT.Sack,\u201cTemperature-dependentbattery models for high-power lithium-ion batteries,\u201d presented at the Proc.","authors":[],"date":"1965","doi":null,"raw":"Autom. Control, vol. AC-10, no. 1, pp. 118\u2013119, Jan. 1965. [13] V.H.Johnson,A.A.Pesaran,andT.Sack,\u201cTemperature-dependentbattery models for high-power lithium-ion batteries,\u201d presented at the Proc.","cites":null},{"id":18444370,"title":"A new approach to linear \ufb01ltering and prediction problems,\u201d Trans.","authors":[],"date":null,"doi":"10.1115\/1.3662552","raw":"[11] R. E. Kalman, \u201cA new approach to linear \ufb01ltering and prediction problems,\u201d Trans. ASME, ser. D, pp. 35\u201345, 1982. [12] R. Bucy, R. Kalman, and I. Selin, \u201cComment on the Kalman \ufb01lter and nonlinear estimates of multivariate normal processes,\u201d IEEE Trans.","cites":null},{"id":18444355,"title":"A review of impedance measurements for determination of the state-of-charge or state of health of secondary batteries,\u201d","authors":[],"date":"1998","doi":"10.1016\/s0378-7753(97)02665-7","raw":"[5] F. Huet, \u201cA review of impedance measurements for determination of the state-of-charge or state of health of secondary batteries,\u201d J. Power Sources, vol. 70, pp. 59\u201369, 1998.","cites":null},{"id":18444358,"title":"A review of state-of-charge indication of batteries by means of a.c. impedance measurements,\u201d","authors":[],"date":"2000","doi":"10.1016\/s0378-7753(99)00351-1","raw":"[6] S. Rodrigues, N. Munichandraiah, and A. K. Shukla, \u201cA review of state-of-charge indication of batteries by means of a.c. impedance measurements,\u201d J. Power Sources, vol. 87, pp. 12\u201320, 2000.","cites":null},{"id":18444352,"title":"An optimized state of charge algorithm for lead-acid batteries in electric vehicles,\u201d in ElectricVehicleSymp.,vol.EVS-15,Brussels,Belgium,Sep-Oct.30\u20133,","authors":[],"date":"1998","doi":null,"raw":"[3] O. Caumont, Ph. Le Moigne, P. Lenain, andC. Rombaut, \u201cAn optimized state of charge algorithm for lead-acid batteries in electric vehicles,\u201d in ElectricVehicleSymp.,vol.EVS-15,Brussels,Belgium,Sep-Oct.30\u20133, 1998. Proceedings on CD-ROM.","cites":null},{"id":18444375,"title":"Bhangu (M\u201903) received the B.Eng. degree in electrical and electronic engineering from Nottingham University,","authors":[],"date":"1998","doi":null,"raw":"B. S. Bhangu (M\u201903) received the B.Eng. degree in electrical and electronic engineering from Nottingham University, Nottingham, U.K., in 1998 and the MSc. degree in control systems and the Ph.D. degree for his work on sensorless control of brushless-AC machines for power assisted steering systems from the University of Shef\ufb01eld, Shef\ufb01eld, U.K., in 1999 and 2004, respectively. He currently holds a postdoctoral research post at the University of Shef\ufb01eld. His research interests includesensorlesscontrolofbrushlessmachinesforautomotive and aerospace applications and modeling of hybrid-electric vehicles and battery-management techniques.","cites":null},{"id":18444380,"title":"Bingham (M\u201900) received the B.Eng. degree in electronic systems and control engineering from Shef\ufb01eld City Polytechnic,","authors":[],"date":"1989","doi":null,"raw":"C. M. Bingham (M\u201900) received the B.Eng. degree in electronic systems and control engineering from Shef\ufb01eld City Polytechnic, Shef\ufb01eld, U.K., in 1989, the M.Sc. (Eng.) degree in control systems engineering from the University of Shef\ufb01eld, Shef\ufb01eld, U.K., in 1990, and Ph.D. degree from Cran\ufb01eld University, U.K., in 1994, for research on control systems to accommodate nonlinear dynamic effects in aerospace \ufb02ight\u2013surface actuators.","cites":null},{"id":18444366,"title":"d\u2019Alch\u00e9-Buc, \u201cNeural network adaptive modeling of battery discharge behavior,\u201d","authors":[],"date":"1997","doi":"10.1007\/bfb0020299","raw":"[9] G. O. Patillon and J. N. d\u2019Alch\u00e9-Buc, \u201cNeural network adaptive modeling of battery discharge behavior,\u201d in Arti\ufb01cial Neural Networks ICANN\u201997 7th Int. Conf., vol. 1327, Lecture Notes in Computer Science. Berlin, Germany, 1997, pp. 1095\u20131100.","cites":null},{"id":18444350,"title":"Early results from a systems approach to improving the performance and lifetime of lead acid batteries,\u201d","authors":[],"date":"2003","doi":"10.1016\/s0378-7753(02)00714-0","raw":"[1] M. J. Kellaway, P. Jennings, D. Stone, E. Crowe, and A. Cooper, \u201cEarly results from a systems approach to improving the performance and lifetime of lead acid batteries,\u201d J. Power Sources, vol. 116, pp. 110\u2013117, 2003.","cites":null},{"id":18444353,"title":"Lead Acid Batteries.","authors":[],"date":"1977","doi":"10.2172\/7113385","raw":"[4] H. Bode, Lead Acid Batteries. New York: Wiley, 1977.","cites":null},{"id":18444373,"title":"Lifetime extension of Valve regulated lead acid (VRLA) batteries under hybrid vehicle duty,\u201d in","authors":[],"date":"2004","doi":"10.1049\/cp:20040258","raw":"[14] P. Bentley and D. A. Stone, \u201cLifetime extension of Valve regulated lead acid (VRLA) batteries under hybrid vehicle duty,\u201d in Proc. 2nd Int. Power Electronics Machines and Drives Conf. (PEMD\u201904), vol. 1, Edinburgh, U.K., 2004, pp. 49\u201354.","cites":null},{"id":18444351,"title":"Methods for state-of-charge determinationandtheirapplications,\u201dJ.PowerSources,vol.96,pp.113\u2013120,","authors":[],"date":"2001","doi":"10.1016\/s0378-7753(01)00560-2","raw":"[2] S. Piller, M. Perrin, and A. Jossen, \u201cMethods for state-of-charge determinationandtheirapplications,\u201dJ.PowerSources,vol.96,pp.113\u2013120, 2001.","cites":null},{"id":18444368,"title":"Neural Network based energy storage system modeling for hybrid electric vehicles. Nat. Renewable Energy Lab.,","authors":[],"date":"1999","doi":"10.2172\/935117","raw":"[10] S. R. Bhatikar, R. L. Mahajan, K. Wipke, and V. Johnson. (1999, Aug.) Neural Network based energy storage system modeling for hybrid electric vehicles. Nat. Renewable Energy Lab., Golden, CO. [Online] www.ctts.nrel.gov\/analysis\/reading_room.","cites":null},{"id":18444374,"title":"Overcoming negative-plate capacity loss in VRLA batteries cycled under partial state-of-charge duty,","authors":[],"date":"2001","doi":null,"raw":"[15] D. A. Hollenkamp, D. A. Baldsing, and D. A. Lim et al., Overcoming negative-plate capacity loss in VRLA batteries cycled under partial state-of-charge duty, in Advanced Lead Acid Battery Consortium (ALABC) Invest. Rep. ET\/IR398R, Research Triangle Park, NC, 2001.","cites":null},{"id":18444376,"title":"received the BSc. degree in engineering physics from Shef\ufb01eld Hallam University, Shef\ufb01eld, U.K., and the Ph.D. for the dynamic characterization and modeling of battery technologies for all\/more electric vehicles from the","authors":[],"date":"1998","doi":null,"raw":"P. Bentley received the BSc. degree in engineering physics from Shef\ufb01eld Hallam University, Shef\ufb01eld, U.K., and the Ph.D. for the dynamic characterization and modeling of battery technologies for all\/more electric vehicles from the University of Shef\ufb01eld, Shef\ufb01eld, U.K., in 1998 and 2004, respectively. He currently is a Research Associate with the UniversityofShef\ufb01eld.Hisresearchinterestsincludeenergy storage components for hybrid and electric vehicle drive-trains.","cites":null},{"id":18444378,"title":"Stone received the B.Eng. degree in electronic engineering from the University of Shef\ufb01eld, Shef\ufb01eld, U.K., and the Ph.D. degree from","authors":[],"date":"1984","doi":null,"raw":"D. A. Stone received the B.Eng. degree in electronic engineering from the University of Shef\ufb01eld, Shef\ufb01eld, U.K., and the Ph.D. degree from Liverpool University, Liverpool, U.K., in 1984 and 1989, respectively. He is with the University of Shef\ufb01eld as a Member of Academic Staff, specializing in power electronics and machine drive systems. His current research interests include hybrid-electric vehicles, battery charging, EMC, and novel lamp ballasts for low-pressure \ufb02uorescent lamps.","cites":null},{"id":18444360,"title":"The available capacity computation model based on arti\ufb01cial neural network for lead acid batteries in electric vehicles,\u201d","authors":[],"date":"2000","doi":"10.1016\/s0378-7753(99)00502-9","raw":"[7] C. C. Chan, E. W. C. Lo, and S. Weixiang, \u201cThe available capacity computation model based on arti\ufb01cial neural network for lead acid batteries in electric vehicles,\u201d J. Power Sources, vol. 87, pp. 201\u2013204, 2000. [8] P. Singh, C. Fennie, D. E. Reisner, and A. Salkind, \u201cA fuzzy logic approach to state-of-charge determination in high performance batteries with applications to electric vehicles,\u201d in Electric Vehicle Symp., vol.","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2005-05","abstract":"Abstract\u2014This paper describes the application of state-estimation\\ud\ntechniques for the real-time prediction of the state-of-charge\\ud\n(SoC) and state-of-health (SoH) of lead-acid cells. Specifically,\\ud\napproaches based on the well-known Kalman Filter (KF) and\\ud\nExtended Kalman Filter (EKF), are presented, using a generic\\ud\ncell model, to provide correction for offset, drift, and long-term\\ud\nstate divergence\u2014an unfortunate feature of more traditional\\ud\ncoulomb-counting techniques. The underlying dynamic behavior\\ud\nof each cell is modeled using two capacitors (bulk and surface) and\\ud\nthree resistors (terminal, surface, and end), from which the SoC\\ud\nis determined from the voltage present on the bulk capacitor. Although\\ud\nthe structure of the model has been previously reported for\\ud\ndescribing the characteristics of lithium-ion cells, here it is shown\\ud\nto also provide an alternative to commonly employed models of\\ud\nlead-acid cells when used in conjunction with a KF to estimate\\ud\nSoC and an EKF to predict state-of-health (SoH). Measurements\\ud\nusing real-time road data are used to compare the performance\\ud\nof conventional integration-based methods for estimating SoC\\ud\nwith those predicted from the presented state estimation schemes.\\ud\nResults show that the proposed methodologies are superior to\\ud\nmore traditional techniques, with accuracy in determining the\\ud\nSoC within 2% being demonstrated. Moreover, by accounting\\ud\nfor the nonlinearities present within the dynamic cell model, the\\ud\napplication of an EKF is shown to provide verifiable indications of\\ud\nSoH of the cell pack","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/54913.pdf","fullTextIdentifier":"http:\/\/eprints.lincoln.ac.uk\/2333\/1\/bhangu_nonlinear_observers.pdf","pdfHashValue":"bfbed02e4e4ee0d382c58c3d33a15355358119ee","publisher":"Institution of Electronic and Electrical Engineers","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lincoln.ac.uk:2333<\/identifier><datestamp>\n      2014-08-28T09:24:56Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D6A6163735F48:6A6163735F48363030<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/eprints.lincoln.ac.uk\/2333\/<\/dc:relation><dc:title>\n        Nonlinear observers for predicting state-of-charge and state-of-health of lead-acid batteries for hybrid-electric vehicles<\/dc:title><dc:creator>\n        Bhangu, B<\/dc:creator><dc:creator>\n        Bentley, P<\/dc:creator><dc:creator>\n        Stone, D A<\/dc:creator><dc:creator>\n        Bingham, Chris<\/dc:creator><dc:subject>\n        H600 Electronic and Electrical Engineering<\/dc:subject><dc:description>\n        Abstract\u2014This paper describes the application of state-estimation\\ud\ntechniques for the real-time prediction of the state-of-charge\\ud\n(SoC) and state-of-health (SoH) of lead-acid cells. Specifically,\\ud\napproaches based on the well-known Kalman Filter (KF) and\\ud\nExtended Kalman Filter (EKF), are presented, using a generic\\ud\ncell model, to provide correction for offset, drift, and long-term\\ud\nstate divergence\u2014an unfortunate feature of more traditional\\ud\ncoulomb-counting techniques. The underlying dynamic behavior\\ud\nof each cell is modeled using two capacitors (bulk and surface) and\\ud\nthree resistors (terminal, surface, and end), from which the SoC\\ud\nis determined from the voltage present on the bulk capacitor. Although\\ud\nthe structure of the model has been previously reported for\\ud\ndescribing the characteristics of lithium-ion cells, here it is shown\\ud\nto also provide an alternative to commonly employed models of\\ud\nlead-acid cells when used in conjunction with a KF to estimate\\ud\nSoC and an EKF to predict state-of-health (SoH). Measurements\\ud\nusing real-time road data are used to compare the performance\\ud\nof conventional integration-based methods for estimating SoC\\ud\nwith those predicted from the presented state estimation schemes.\\ud\nResults show that the proposed methodologies are superior to\\ud\nmore traditional techniques, with accuracy in determining the\\ud\nSoC within 2% being demonstrated. Moreover, by accounting\\ud\nfor the nonlinearities present within the dynamic cell model, the\\ud\napplication of an EKF is shown to provide verifiable indications of\\ud\nSoH of the cell pack.<\/dc:description><dc:publisher>\n        Institution of Electronic and Electrical Engineers<\/dc:publisher><dc:date>\n        2005-05<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/eprints.lincoln.ac.uk\/2333\/1\/bhangu_nonlinear_observers.pdf<\/dc:identifier><dc:identifier>\n          Bhangu, B and Bentley, P and Stone, D A and Bingham, Chris  (2005) Nonlinear observers for predicting state-of-charge and state-of-health of lead-acid batteries for hybrid-electric vehicles.  IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, 54  (3).   pp. 783-794.  ISSN 0018-9545  <\/dc:identifier><dc:relation>\n        http:\/\/dx.doi.org\/10.1109\/TVT.2004.842461<\/dc:relation><dc:relation>\n        10.1109\/TVT.2004.842461<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/eprints.lincoln.ac.uk\/2333\/","http:\/\/dx.doi.org\/10.1109\/TVT.2004.842461","10.1109\/TVT.2004.842461"],"year":2005,"topics":["H600 Electronic and Electrical Engineering"],"subject":["Article","PeerReviewed"],"fullText":"IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 54, NO. 3, MAY 2005 783\nNonlinear Observers for Predicting State-of-Charge\nand State-of-Health of Lead-Acid Batteries for\nHybrid-Electric Vehicles\nB. S. Bhangu, Member, IEEE, P. Bentley, D. A. Stone, and C. M. Bingham, Member, IEEE\nAbstract\u2014This paper describes the application of state-estima-\ntion techniques for the real-time prediction of the state-of-charge\n(SoC) and state-of-health (SoH) of lead-acid cells. Specifically,\napproaches based on the well-known Kalman Filter (KF) and\nExtended Kalman Filter (EKF), are presented, using a generic\ncell model, to provide correction for offset, drift, and long-term\nstate divergence\u2014an unfortunate feature of more traditional\ncoulomb-counting techniques. The underlying dynamic behavior\nof each cell is modeled using two capacitors (bulk and surface) and\nthree resistors (terminal, surface, and end), from which the SoC\nis determined from the voltage present on the bulk capacitor. Al-\nthough the structure of the model has been previously reported for\ndescribing the characteristics of lithium-ion cells, here it is shown\nto also provide an alternative to commonly employed models of\nlead-acid cells when used in conjunction with a KF to estimate\nSoC and an EKF to predict state-of-health (SoH). Measurements\nusing real-time road data are used to compare the performance\nof conventional integration-based methods for estimating SoC\nwith those predicted from the presented state estimation schemes.\nResults show that the proposed methodologies are superior to\nmore traditional techniques, with accuracy in determining the\nSoC within 2% being demonstrated. Moreover, by accounting\nfor the nonlinearities present within the dynamic cell model, the\napplication of an EKF is shown to provide verifiable indications of\nSoH of the cell pack.\nIndex Terms\u2014Batteries, Kalman Filter, observers, state-of-\ncharge, state-of-health.\nI. INTRODUCTION\nPEAK power buffers of hybrid-electric vehicles (HEVs) are,by their very nature, subject to large dynamic transients\nin current and power demand. An example is the RHOLAB\ndriving cycle requirements, introduced in Section V-C, which\nshows road data collected from a Honda Insight HEV, where\npeak charge- and discharge-current demands of 60 A and\n100 A, respectively, are required from the battery pack when\nsubjected to a series of vehicle driving tests [1]. The accom-\nmodation of such operating conditions requires that the man-\nManuscript received October 1, 2004; revised November 19, 2004. This work\nwas supported by the United Kingdom\u2019s Department of Trade and Industry\n(DTI) Foresight Vehicle Link Program and by the United Kingdom\u2019s Engi-\nneering and Physical Sciences Research Council (EPSRC), who funded the Re-\nliable Highly Optimized Lead Acid Battery (RHOLAB) project jointly with the\nEuropean Advanced Lead Acid Battery Consortium, and Hawker Batteries, as\nwell as by the other partners in the project, namely, Provector, Ltd., the Univer-\nsity of Warwick, and Hawker Batteries (now part of Enersys Inc.). The review\nof this paper was coordinated by Prof. A. Emadi.\nThe authors are with the Department of Electronic and Electrical\nEngineering, University of Sheffield, Sheffield S1 3JD, U.K. (e-mail:\nb.bhangu@sheffield.ac.uk).\nDigital Object Identifier 10.1109\/TVT.2004.842461\nagement system have accurate knowledge of the peak power\nbuffer\u2019s state of charge (SoC) to facilitate safe and efficient oper-\nation. Failure to control SoC, leading to under- or over-charging\nconditions, can degrade the ability of the pack to source\/sink\nsubsequent power transients.\nVarious electric equivalent circuit models have been applied\nto lead-acid batteries to determine SoC. However, the complex\nnonlinear electrochemical processes that occur during power\ntransfer to\/from the battery has, in the past, proven difficult to\naccurately describe dynamically. These processes include the\nflow of ions, amount of stored charge, ability to deliver instan-\ntaneous power, and the effects of temperature and internal pres-\nsure, to name a few. An accurate determination of SoC is re-\nquired, in particular, for the efficient utilization of the battery\nfor HEVs to optimize performance, extend the lifetime, and pre-\nvent progressive permanent damage to the battery. Although, in\ntheory, the SoC of a battery can be determined from terminal\nquantities in conjunction with an appropriate battery model, in-\naccuracies and measurement noise ultimately introduce errors\nthat can become significant over time. Increased accuracy in the\nestimation of SoC, therefore, facilitates safe and efficient oper-\nation of the battery under HEV driving duties.\nA variety of techniques have been proposed to measure or\nmonitor the SoC of a cell or battery, each having its relative\nmerits, as reviewed by Piller et al. [2]. Charge counting or cur-\nrent integration is, at present, the most commonly used tech-\nnique, requiring dynamic measurement of the cell\/battery cur-\nrent, the time integral of which is considered to provide a direct\nindication of SoC [3]. However, due to the reliance on integra-\ntion, errors in terminal measurements due to noise, resolution,\nand rounding are cumulative and large SoC errors can result. A\nreset or recalibration action is, therefore, required at regular in-\ntervals\u2014in all electric vehicles (EVs). This may be carried out\nduring a full charge or conditioning discharge, but is less ap-\npropriate for standard HEV operation where full SoC is rarely\nachieved. Other factors that ultimately influence the accuracy of\nSoC estimates, and create additional complications for the tra-\nditional integration-based techniques, are the variation of cell\ncapacity with discharge rate, temperature, and Coulombic effi-\nciency losses.\nWhen considering flooded lead-acid cells, the specific gravity\nof the electrolyte is known to be a good measure of SoC. How-\never, estimates of SoC are complicated when using valve regu-\nlated lead-acid (VRLA) cells due to the nominal amount of elec-\ntrolyte being immobilized in the glass fiber separator mat or gel.\nNevertheless, since the open-circuit terminal voltage of a VRLA\n0018-9545\/$20.00 \u00a9 2005 IEEE\n784 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 54, NO. 3, MAY 2005\nFig. 1. Open circuit voltage versus SoC.\nbattery varies almost linearly over the majority of the battery\u2019s\nSoC [4] (see Fig. 1), it has been used in many SoC estimators.\nFor the method to be effective, however, corrections must be\nmade for temperature and electrolyte concentration gradients\n(concentration polarization) formed during high-rate charge and\ndischarges (long settling times may be required to allow such\nconcentration gradients to disperse prior to making an open cir-\ncuit voltage reading [4]). More commonly, therefore, the mea-\nsured open-circuit voltage is used to periodically correct the es-\ntimated SoC derived from other charge integration techniques.\nHowever, as with measurements of specific gravity, suitable pe-\nriods of operational inactivity may not occur frequently enough\nin HEV driving duties for this to be successfully utilized.\nCell-impedance measurements have also been reported as\na useful technique for resetting or adjusting SoC estimates\nfrom integration-based methods. However, from results of\nvarious studies undertaken to identify the impedance variation\nof cells\/batteries, with SoC [5], [6], contradictory views to their\nusefulness in practical systems currently remain unresolved [2].\nOther reported methods for estimating SoC have been based\non artificial neural networks [7] and fuzzy logic [8] principles,\nalthough the latter was reported to have relative poor perfor-\nmance. Although such techniques incur large computation over-\nhead on the battery pack controller, which would in the past have\nled to problems for online implementation, the increasing com-\nputational power of digital signal processing chips and the ac-\ncompanying fall in device costs may, in the near future, make\ntheir application an attractive alternative. Neural networks, in\nparticular, have been used to avoid the need for the large number\nof empirically derived parameters required by other methods.\nIndeed, for application to the less demanding task of prediction\nof SoC in portable equipment, a neural network modeling ap-\nproach has been shown to give mean errors of 3% [9]. Also,\na neural network model for predicting battery power capacity\nduring driving cycles has been added to the ADVISOR EV and\nHEV modeling environments [10].\nUltimately, manufacturers of HEVs would like predictions\nof the state-of-health (SoH) or state-of-function (SoF) of a bat-\ntery pack, since the increasing reliance on drive-by-wire tech-\nnologies is making the battery a key safety-critical component\nof the vehicle. Knowledge of whether a battery will fail when\nsubjected to high transient loadings, as may be experienced in\nemergency braking, for instance, is therefore essential. How-\never, SoH monitoring techniques are currently in their infancy,\nwith little being reported to date.\nFig. 2. RC battery model schematic.\nHere then, model-based state-estimation techniques are pro-\nposed for predicting the states of a cell that would normally be\ndifficult or expensive to measure, or are subject to the signif-\nicant problems described previously\u2014the SoC being the key\nstate in this case. Using an error-correction mechanism, the ob-\nservers provide real-time predictions of SoC. Specifically, the\nwell-known Kalman filter (KF), developed during the 1960s to\nprovide a recursive solution to optimal linear filtering, for both\nstate observation and prediction problems [11], [12], is used for\nthis study; a unique feature of the KF is that it optimally (min-\nimum variance) estimates states affected by broadband noise\ncontained within the system bandwidth, i.e., that cannot other-\nwise be filtered out using classical techniques, and enables em-\npirical tradeoffs between modeling errors and the influence of\nnoise.\nFurthermore, the model is extended to accommodate SoH via\nthe real-time estimation of bulk capacitance. Due to the resulting\nnonlinearities of the underlying dynamic model, an EKF is con-\nsidered for real-time estimation to monitor bulk capacitance\nwhile cycling a cell. Experimental results ultimately show the\nability of the EKF to compensate for inaccuracies in the initial\nestimates of cell model bulk capacitance and to track changes\nin the value of the bulk capacitance that can be considered as a\nmeasure of the cell\u2019s capacity.\nII. BATTERY MODEL\nA dynamic model of the battery, in the form of state variable\nequations, is necessary to predict the SoC or SoH. Here, a\ngeneric model [13] consisting of a bulk capacitor to\ncharacterize the ability of the battery to store charge, a capacitor\nto model surface capacitance and diffusion effects within the\ncell , a terminal resistance , surface resistance\nand end resistance , is used\u2014see Fig. 2. The voltage across\nthe bulk and surface capacitors are denoted and ,\nrespectively.\nInitial parameters of the cell are precalculated from ex-\nperimental data, where open-circuit voltage (OCV) tests are\nperformed upon successive discharges of the battery, by the\napplication of current pulses. An initial estimate of is\nobtained by analyzing the amount of stored energy in the\ncell, while a provisional value of relies on calculating\nthe time constant of the cell in response to high-frequency\nexcitation. Complete derivation details, along with the initial\nparameters for the cells considered, are given in Appendix A,\nfor completeness.\nBHANGU et al.: NONLINEAR OBSERVERS FOR PREDICTING STATE-OF-CHARGE AND STATE-OF-HEALTH OF LEAD-ACID BATTERIES 785\nIII. STATE VARIABLE DESCRIPTION OF BATTERY MODEL\nA. State Variables , , and\nVoltages and currents describing the characteristics of the net-\nwork shown in Fig. 2, are given by (note: by convention, current\nflowing into the cell is considered positive)\n(1)\n(2)\nEquating the two voltage equations and, after some algebraic\nmanipulation, yields\n(3)\nFrom Kirchoff\u2019s laws, and from (3)\n(4)\nSince (assuming a relatively slow varying\n), (4) can be rearranged to give\n(5)\nThrough a similar derivation, the rate of change of the surface\ncapacitor voltage is obtained from (1) and (2) as\n(6)\nA state variable description relating the voltages and currents\nis therefore\n(7)\nand the output voltage, as a function of terminal current, is given\nfrom (1) and (2) by\n(8)\nTaking the time derivative of the output voltage and assuming\n(the rate of change of terminal current, per sampling\ninterval when implemented digitally, is negligible) gives\n(9)\nSolving for from (8) and substituting into (9) provides\nthe complete state variable description of the network as\n(10)\nB. Observability of the RC Battery Model\nObservability of the linear system is investigated from con-\nstruction of the observability matrix\n(11)\nwhere and is given by the first term on the right-\nhand side (RHS) of (10). When expanded, is [see (12) at the\nbottom of the page]. Under mild conditions, the observability\nmatrix is always of full rank.\n(12)\n786 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 54, NO. 3, MAY 2005\nFig. 3. High-power cell test bench schematic.\nFig. 4. (a) Test chamber. (b) 8 Ah sealed lead-acid cell.\nIV. VERIFICATION OF THE BATTERY MODEL\nA. High-Power Cell Test Bench\nA high-power cell test bench has been constructed to allow\ncontinuous cycling of individual cells using custom power and\ncurrent profiles, thereby permitting the characterization of indi-\nvidual cells over closely managed operating duties. The cells are\ncontained within a thermally controlled environmental chamber\nto provide known environmental conditions. A schematic of one\nchannel of the test bench is shown in Fig. 3.\nPower for cell charging is supplied from a rectified , 500 A\npower supply via a smoothing capacitor bank. The charge\/dis-\ncharge circuits employ an analog PI controller driving two par-\nallel arrays of MOSFET power devices, acting as variable re-\nsistors. One array of MOSFETs controls the charging current to\nthe cell, while the other, the discharge current, where both are\nforced air cooled. The demand signal is provided via a PC-based\nLabVIEW, National Instrumentation Corporation, Austin, TX,\nhardware-development platform, the current cycle for the cell\nbeing defined within a text file, with cell current, temperature,\nand voltage being continuously logged at 1 kHz. The test facility\nmeasures the cell current with Hall-effect current transducers\nthat are auto calibrated at the start of each test. Control signals\nare generated at 100 Hz and the analog circuitry has a bandwidth\nof 6 kHz. A photograph of the test facility is given in Fig. 4(a).\nFurthermore, a dSPACE system is employed in parallel with the\nLabVIEW hardware. Measurements of the cell voltages and cur-\nrents are fed into 16-bit ADCs, from which the observer algo-\nrithms estimate SoC (and, ultimately, SoH).\nThe cell tested in this paper is a novel, spiral-wound, 8 Ah\nsealed lead-acid cell, with terminals on either end, developed\nby Hawker (ENERSYS, Inc., Reading, PA), for the RHOLAB\nproject [Fig. 4(b)]. The double terminal encapsulation is in-\ntroduced to lower grid currents and, hence, thermal gradients,\nand thereby promotes efficient utilization of the active mate-\nrials in the cell, thus leading to a battery that is optimized for\nthe high-power duties typical of hybrid driving cycles.\nB. Evaluation of the RC Model\nThe validity of the proposed model is tested prior to the design\nof the KF. A discharge pulse of 1.53 A is applied to both the cell\nand model and a comparison of the output voltage and bulk-\nand surface-capacitor voltages is made. The results are given in\nFig. 5. Although some discrepancy exists between the measured\nand modeled voltages, the underlying dynamic characteristics\nare essentially the same, with the principle difference being the\nvoltage response between discharge pulses. The offset and drift\nare due to errors in initial condition estimates and the effect of\nemploying the model in an open-loop state over a long time\nperiod.\nBHANGU et al.: NONLINEAR OBSERVERS FOR PREDICTING STATE-OF-CHARGE AND STATE-OF-HEALTH OF LEAD-ACID BATTERIES 787\nFig. 5. Dynamic behavior of RC battery model in response to discharge\npulses of 1.53 A. (a) Current and voltage of cell. (b) Measured and modeled\ncell voltage. (c) Modeled voltages across bulk and surface capacitors.\nV. FORMULATION OF KF FOR SoC ESTIMATION\nA continuous time-invariant linear system can be described\nin state-variable form by\n(13)\nwhere\nvector of applied inputs;\nstate vector;\nvector of measured outputs;\ndynamics matrix (time invariant);\ninput matrix (time invariant);\nis the measurement matrix (time invariant).\nFig. 6. Discrete system model subject to random disturbances \u001b and \u0016 .\nAssuming the applied input is constant during each sam-\npling interval, a discrete-time equivalent model of the system is\ngiven by\n(14)\nwhere\n(15)\nand is the sampling period. The system is now assumed to\nbe corrupted by stationary Gaussian white noise, via the additive\nvectors and \u2014the former being used to represent system\ndisturbances and model inaccuracies and the latter representing\nthe effects of measurement noise. Both and are consid-\nered to have a zero mean value, for all , with the following\ncovariance matrices ( denoting the expectation operator):\nfor all\nfor all (16)\nThe resulting system is, therefore, described by\n(17)\nwhere\nvector of measured outputs after being corrupted by\nnoise;\ncoupling matrix that governs the influence of the dis-\nturbance\/modeling inputs on each state\nand is shown diagrammatically in Fig. 6.\nFor notational purposes, represents an estimate of at\nstep based on all the information up to, and including, time\nstep . A property of the KF is that the estimated state vector\nof the system, at time , minimizes the sum-of-\nsquared errors between the actual and estimated states\n(18)\nFor recursive implementation, the KF estimate\nis calculated from the previous state estimate , the input\n, and the measurement signals . The available input\/output\ndata at each sample step is, therefore, considered to be\n788 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 54, NO. 3, MAY 2005\nFig. 7. Recursive KF algorithm.\nand . The recur-\nsive KF algorithm is obtained with the predictor\/corrector\nstages being explicitly identified in Fig. 7.\nA. Online Implementation of the KF\nThe stochastic principles underpinning the KF are appealing\nfor this investigation, since it is recognized that the presence of\ndisturbances stemming from sensor noise on the cell terminal\nmeasurements, and the use of non-ideal dynamic models, make\nit impossible to predict with certainty the states of the system\nover prolonged time periods\u2014a statistical predictor\/corrector\nformulation thereby providing obvious advantages.\nSince only terminal quantities of the battery can be measured,\nthe input is defined as and the measured output is\n. Assuming, for now, that cell parameters are time-invariant\nquantities, the recursive KF algorithm (Fig. 7) is applied, where\nwhere\n(19)\nAlthough no formal stability and tuning methods are avail-\nable for initializing the KF, and recourse to empirical tuning is\nnormally required, its use is nevertheless widespread. Informa-\ntion about the system noise contribution is contained in matrices\nand and, in essence, the selection of and determine\nthe accuracy of the filter\u2019s performance, since they mutually de-\ntermine the action of the KF gain matrix and estimation\nerror covariance matrix . The covariance matrix rep-\nresenting measurement noise can be estimated from knowl-\nedge of the battery terminal voltage. The variance is obtained\nfrom the square of the root-mean-square (rms) noise on each\ncell, and is assumed to be Gaussian distributed and independent.\nInitialization of the covariance matrix describing distur-\nbances on the plant is complicated by the fact that knowledge\nof model inaccuracies and system disturbances is limited, par-\nticularly as each cell has different characteristics. A judicious\nchoice of is, therefore, obtained from experimental studies\nunder the simplifying assumption that there is no correlation\nbetween the elements of and the noise present on each cell\u2019s\nvoltage transducer, thereby leading to a diagonal . The initial\ncovariance matrix , together with and , are ultimately\ntherefore chosen to be\n(20)\nB. Application of the KF\nA discharge pulse of 1.53 A, as described in Section IV-B, is\napplied to both the experimental test battery and to the real-time\nKF, with feedback of terminal current as its input. A compar-\nison of the actual and estimated output voltage, and the volt-\nages across the bulk and surface capacitors, are shown in Fig. 8,\nwhere excellent convergence can be seen, particularly of output\nvoltage in Fig. 8(a), where the error is negligible except during\ntransients.\nIt is notable that, for linear systems, after several iterations,\nconverges to a constant matrix and, in such cases,\nBHANGU et al.: NONLINEAR OBSERVERS FOR PREDICTING STATE-OF-CHARGE AND STATE-OF-HEALTH OF LEAD-ACID BATTERIES 789\nFig. 8. Dynamic behavior of KF estimator to discharge pulses of 1.53 A.\n(a) Actual and estimated cell voltage and voltage error. (b) Estimated bulk and\nsurface capacitor voltages.\ncan be precalculated offline, thereby presenting significant sav-\nings in computational load at the expense of potentially incur-\nring a loss of accuracy during transients. Experimental studies\nreveal that converges to a constant value within 4 s to\n(21)\nFig. 9 shows the difference between using a static and dy-\nnamic Kalman correction gain matrix. The results demonstrate\nthat a significant computational saving, typically by a factor of\n1.5, can be obtained by employing the static gain with a neg-\nligible loss of state convergence accuracy.\nThe impact of the covariance matrix on the estimation\nperformance of the KF is shown in Fig. 10, where it is seen\nthat although significant noise is present on the cell terminal\nvoltage measurements, careful selection of can provide esti-\nmates with enhanced noise immunity.\nC. Comparison of SoC Estimation Techniques\nThe KF is applied to the real-time estimation of SoC of a\nsingle cell that is subject to a RHOLAB driving cycle [1] (see\nFig. 11). The initial cell SoC is set to 0.8, this being the defined\noperating point for partial SoC on the HEV driving profile. Note\nthat SoC is a normalized value used to define a fully charged\ncell. Fig. 12 shows the SoC estimated by charge integration and\nFig. 9. Convergence of output voltage using Kalman correction gain. (a) Static\ngain. (b) Dynamic gain.\nFig. 10. Impact of the covariance matrix (R = 1,R = 0:001,R = 10) on\nthe states of the KF.\nthe KF, upon initially discharging the cell from a SoC of 1 to\n0.8. The RHOLAB driving cell-current profile, Fig. 11, is sub-\nsequently applied to the cell. Results using conventional SoC\nestimation, by the integration of current method, with charging\nefficiency fixed at 0.97 [1], and those from the proposed KF\nscheme are given, respectively, in Figs. 13 and 14. Having been\nsubjected to a RHOLAB driving cycle, at , the tests\nare terminated and the remnant charge in the cell is measured\nusing a 1.53 A discharge, to a terminal voltage of 1.7 V and\nnoting the remaining Ampere hours (Fig. 15). This corresponds\n790 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 54, NO. 3, MAY 2005\nFig. 11. (a) Typical RHOLAB [1] driving cycle cell current. (b) RHOLAB\nHonda Insight HEV employed to gather test data.\nFig. 12. Discharging a cell from SoC of 1\u20130.8.\nto a final SoC of the cell of 0.167. From Fig. 14, it can be seen\nthat the performance of the KF is excellent and, although both\nSoC estimation techniques follow the correct profile, the inte-\ngration-based method demonstrates significant drift over time,\nwith an error of 15% ensuing, whereas the KF consistently\nprovides estimates within 2% of the measured values.\nVI. IMPORTANCE OF THE SoH OF A CELL\nSoH is the ability of a cell to store energy, source and sink\nhigh currents, and retain charge over extended periods, relative\nto its initial or nominal capabilities. The available charge stored\nwithin a fully charged cell is expected to fall with cell usage, as\nFig. 13. Implementation of KF on cells subjected to RHOLAB cycle.\n(a) Measured and estimated cell voltage. (b) Cell voltage error. (c) Estimated\nbulk and surface capacitor voltage.\nactive material on the cell plates gradually degrades by mecha-\nnisms such as loss of plate active surface area due to repeated\ndissolution and recrystallization, loss of electrical contact be-\ntween metallic grids and active materials, and growth of large\ninactive crystals of lead sulphate. Such capacity-loss mecha-\nnisms generally occur slowly in VRLA batteries that are cycled\nat low rates over their full SoC range. However, when operated\nas a peak power buffer, in a HEV system, the cells are oper-\nated at a partial state-of-charge (PSoC), i.e., the cell is never cy-\ncled over its full SoC range and is subjected to both high charge\nand discharge currents. Studies have shown that this PSoC op-\neration can lead to truncated service life in VRLA cells due to\nthe buildup of sulphate within the plate structures, as a result of\ninefficient recharge of plate material [14], [15]. Such capacity\nBHANGU et al.: NONLINEAR OBSERVERS FOR PREDICTING STATE-OF-CHARGE AND STATE-OF-HEALTH OF LEAD-ACID BATTERIES 791\nFig. 14. Comparison of determination of SoC by conventional means by\nintegration of current and from estimated bulk capacitor voltage.\nFig. 15. Cell discharge characteristic to 0% SoC.\nloss can be deemed a loss of cell SoH. Early detection of SoH\ndegradation would allow a \u201csmart\u201d battery pack to take reme-\ndial action, such as the application of conditioning routines to\nthe cell, to remove small sulphate crystals before they form large\ninactive crystals, thereby restoring the cells capacity. Measuring\ncell capacity by the standard means of a low current discharge\nis impractical for HEV applications; online techniques that uti-\nlize only cell terminal measurements, made while the HEV is\ndriven, are, therefore, required.\nA. EKF-Based Estimation of SoH\nA means of estimating bulk capacitance requires\nadding an extra state into the observer structure\n(10) and assuming the rate of change of , over a sampling\ninterval, is negligible. Since the derivatives of and\nare coupled by nonlinear elements, an EKF is now required\nfor effective estimation of state variables. It should be noted,\nhowever, that the realization results in an increase in order\nof the resulting Jacobians, covariance, noise, and disturbance\nmatrices, witha consequential increase in computationoverhead.\nThe proposed nonlinear battery model is written in the form\n(22)\nwhere is given by\nand\n(23)\nThe EKF requires a small-signal model of the system, at each\nsample step, by linearizing (23) about the current operating\npoint , . From a Taylor series expansion, (ignoring the\npresence of noise)\n(24)\nwhere [see (25) at the bottom of the next page].\nThe resulting small signal model, about the operating point\n, , is given by\n(26)\n(where ) that can be discretized, to give\n(27)\nand used in the KF algorithm described previously in Fig. 7.\nB. Online Implementation of SoH Monitoring\nThe SoH of known cells has previously been evaluated\n[14] by performing continuous power cycling tests [using the\nRHOLAB profile shown in Fig. 11(a)], on two separate battery\npacks, each consisting of 18 cells. Results of the tests have\ndemonstrated similar pack lifetimes in each case, over 77 and\n74 power cycles, respectively. During the tests, the cells of\nboth packs suffered a measurable mean loss in cell capacity of\n0.01 Ah, per power cycle [14]. While performing the tests,\nthe EKF is employed and the variation of is estimated.\nThe results, shown in Fig. 16(a), demonstrate the ability of the\n792 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 54, NO. 3, MAY 2005\nstate observer scheme to estimate , over time, ultimately\nindicating a reduction of 10% during the tests, corresponding\nto an average loss of cell capacity of 0.8 Ah for a nominal 8 Ah\ncell. This, therefore, compares well to the measured loss of\ncapacity of 0.77 Ah from the packs under test.\nA characteristic of the results shown in Fig. 16(a) is the initial\nrise in the estimated cell capacity at the start of cell cycling. Var-\nious reasons contribute to this feature. First, it is recognized that\nit is difficult to accurately predict initial conditions for the state\nestimates. In reality, only a mean value of initial bulk capaci-\ntance can realistically be employed; hence, the results include\nan initial period of dynamic convergence to the \u201ctrue\u201d values.\nMoreover, from Fig. 16(b), which shows the voltage profile, a\ncorresponding rise in voltage is displayed over the first few cy-\ncles, as a consequence of a rise in the internal cell temperature,\ncorresponding to internal Joule and chemical heating within the\ncell. After 10 cycles thermal equilibrium is achieved and the\nvoltage profile displays a near constant envelope. A further con-\ntributory factor may be insufficient preconditioning of the cell\nprior to testing, leading to an initial gain in cell capacity during\nthe first few cycles as active plate materials are cycled through\ncharge\/discharge, leading to a fine highly reactive plate crystal\nstructure of a large surface area.\nVII. CONCLUSION\nThis paper has presented an alternative approach to esti-\nmating the SoC of a cell pack by the application of a KF. It is\nshown that, when using a generic model (recently applied to\nlithium-ion cells) to describe the dynamic behavior of lead-acid\ncells, large state errors can develop over time. However, rather\nthan increasing the complexity of the cell model to closely\nFig. 16. EKF employed to predict SoH of the cell pack. (a) Estimated bulk\ncapacitance C . (b) Cell terminal voltage.\nmatch the real system, the application of a KF, with its inherent\npredictor-corrector mechanism, is shown to accommodate such\ninadequacies. In particular, a comparison of SoC estimates\n(25)\nBHANGU et al.: NONLINEAR OBSERVERS FOR PREDICTING STATE-OF-CHARGE AND STATE-OF-HEALTH OF LEAD-ACID BATTERIES 793\nFig. 17. Cell terminal voltage when discharge current pulses of 1.53 A are\napplied.\nusing the presented KF technique and the more conventional\nintegration of current method is undertaken using \u201croad data\u201d\ncollected from a Honda Insight HEV driven on a test track. The\npresented results show a significant improvement in SoC esti-\nmation from the proposed KF methodology, when compared to\nmore traditional integration of charge methods.\nFurthermore, extensions for SoH monitoring, by employing\nan EKF, have also been presented\u2014using only measurements\nof cell terminal quantities as input. Such data is extremely im-\nportant for the ultimate prediction of SoF, which describes the\nability of a cell to perform adequately under HEV demands and\nis related to both SoC and SoH information. SoF will give a\nprediction of available capacity, and discharge and recharge ca-\npability, thereby allowing a \u201csmart\u201d battery to forecast the re-\nsponse of the cell to driving demands, leading to optimal uti-\nlization of the battery pack with regard to performance and life-\ntime and, therefore, better overall energy management within\nthe vehicle.\nIt is notable that, while the presented work has focused on a\nspecific battery model, ultimately, due to presented benefits, it is\nexpected that similar state-estimation schemes will be adopted\nfor other model structures and cell chemistries.\nAPPENDIX\nA. Calculation of Initial Parameters\nInitial parameters required for the battery model are deter-\nmined from experimental data, where OCV tests are performed\nupon successive discharge of battery by injection of current\npulses.\n1) Capacitor : The capacitance is determined by an-\nalyzing the amount of stored energy. Fig. 17 shows the OCV\nwhen discharge current pulses of 1.53 A are applied for 1800 s\nat 3600-s intervals.\nThe energy stored in is determined from the OCV at\n0% SOC and 100% SOC, using the following expression:\n(28)\nFig. 18. Cell terminal voltage when a discharge current of 10 A pulse is applied\nat 500-ms intervals.\nis equivalent to the rated Amp-sec capacity of the\nbattery, giving:\nRated(AmpSec) (29)\n2) Capacitor : An initial value of relies on\nresults of high-frequency excitation of the cell to determine the\ntime constant given by the surface capacitor and its associated\nresistance. As before, OCV tests are performed. Discharge\npulses of 10 A are applied at 500-ms intervals, thereby isolating\nthe results from the effects of .\nFrom Fig. 18, it is seen that\nThe time constant is approximated using the following rela-\ntionship:\n(30)\nand solving for gives\n(31)\nThe time constant is described by\n(32)\nHence, the initial estimate of surface capacitor, is determined\nas\n(33)\n794 IEEE TRANSACTIONS ON VEHICULAR TECHNOLOGY, VOL. 54, NO. 3, MAY 2005\nTABLE I\nINITIAL PARAMETERS FOR THE CELL MODEL\n3) Battery Resistance: The internal resistance of the battery\nis measured as 4.6 . It is assumed that and are equiv-\nalent and account for 75% of total resistance. Hence, is\n(34)\nA summary of initial values is given in Table I.\nREFERENCES\n[1] M. J. Kellaway, P. Jennings, D. Stone, E. Crowe, and A. Cooper, \u201cEarly\nresults from a systems approach to improving the performance and life-\ntime of lead acid batteries,\u201d J. Power Sources, vol. 116, pp. 110\u2013117,\n2003.\n[2] S. Piller, M. Perrin, and A. Jossen, \u201cMethods for state-of-charge deter-\nmination and their applications,\u201d J. Power Sources, vol. 96, pp. 113\u2013120,\n2001.\n[3] O. Caumont, Ph. Le Moigne, P. Lenain, and C. Rombaut, \u201cAn optimized\nstate of charge algorithm for lead-acid batteries in electric vehicles,\u201d in\nElectric Vehicle Symp. , vol. EVS-15, Brussels, Belgium, Sep-Oct. 30\u20133,\n1998. Proceedings on CD-ROM.\n[4] H. Bode, Lead Acid Batteries. New York: Wiley, 1977.\n[5] F. Huet, \u201cA review of impedance measurements for determination of\nthe state-of-charge or state of health of secondary batteries,\u201d J. Power\nSources, vol. 70, pp. 59\u201369, 1998.\n[6] S. Rodrigues, N. Munichandraiah, and A. K. Shukla, \u201cA review of\nstate-of-charge indication of batteries by means of a.c. impedance\nmeasurements,\u201d J. Power Sources, vol. 87, pp. 12\u201320, 2000.\n[7] C. C. Chan, E. W. C. Lo, and S. Weixiang, \u201cThe available capacity com-\nputation model based on artificial neural network for lead acid batteries\nin electric vehicles,\u201d J. Power Sources, vol. 87, pp. 201\u2013204, 2000.\n[8] P. Singh, C. Fennie, D. E. Reisner, and A. Salkind, \u201cA fuzzy logic\napproach to state-of-charge determination in high performance batteries\nwith applications to electric vehicles,\u201d in Electric Vehicle Symp., vol.\nEVS-15, Brussels, Belgium, Sep.-Oct. 30\u20133, 1998. Proceedings on\nCD-ROM.\n[9] G. O. Patillon and J. N. d\u2019Alch\u00e9-Buc, \u201cNeural network adaptive\nmodeling of battery discharge behavior,\u201d in Artificial Neural Networks\nICANN\u201997 7th Int. Conf., vol. 1327, Lecture Notes in Computer Sci-\nence. Berlin, Germany, 1997, pp. 1095\u20131100.\n[10] S. R. Bhatikar, R. L. Mahajan, K. Wipke, and V. Johnson. (1999, Aug.)\nNeural Network based energy storage system modeling for hybrid\nelectric vehicles. Nat. Renewable Energy Lab., Golden, CO. [Online]\nwww.ctts.nrel.gov\/analysis\/reading_room.\n[11] R. E. Kalman, \u201cA new approach to linear filtering and prediction prob-\nlems,\u201d Trans. ASME, ser. D, pp. 35\u201345, 1982.\n[12] R. Bucy, R. Kalman, and I. Selin, \u201cComment on the Kalman filter and\nnonlinear estimates of multivariate normal processes,\u201d IEEE Trans.\nAutom. Control, vol. AC-10, no. 1, pp. 118\u2013119, Jan. 1965.\n[13] V. H. Johnson, A. A. Pesaran, and T. Sack, \u201cTemperature-dependent bat-\ntery models for high-power lithium-ion batteries,\u201d presented at the Proc.\nEVS 17, Montreal, PQ, Canada, 2000.\n[14] P. Bentley and D. A. Stone, \u201cLifetime extension of Valve regulated\nlead acid (VRLA) batteries under hybrid vehicle duty,\u201d in Proc. 2nd\nInt. Power Electronics Machines and Drives Conf. (PEMD\u201904), vol. 1,\nEdinburgh, U.K., 2004, pp. 49\u201354.\n[15] D. A. Hollenkamp, D. A. Baldsing, and D. A. Lim et al., Overcoming\nnegative-plate capacity loss in VRLA batteries cycled under partial\nstate-of-charge duty, in Advanced Lead Acid Battery Consortium\n(ALABC) Invest. Rep. ET\/IR398R, Research Triangle Park, NC, 2001.\nB. S. Bhangu (M\u201903) received the B.Eng. degree\nin electrical and electronic engineering from Not-\ntingham University, Nottingham, U.K., in 1998\nand the MSc. degree in control systems and the\nPh.D. degree for his work on sensorless control of\nbrushless-AC machines for power assisted steering\nsystems from the University of Sheffield, Sheffield,\nU.K., in 1999 and 2004, respectively.\nHe currently holds a postdoctoral research post at\nthe University of Sheffield. His research interests in-\nclude sensorless control of brushless machines for au-\ntomotive and aerospace applications and modeling of hybrid-electric vehicles\nand battery-management techniques.\nP. Bentley received the BSc. degree in engineering\nphysics from Sheffield Hallam University, Sheffield,\nU.K., and the Ph.D. for the dynamic characterization\nand modeling of battery technologies for all\/more\nelectric vehicles from the University of Sheffield,\nSheffield, U.K., in 1998 and 2004, respectively.\nHe currently is a Research Associate with the Uni-\nversity of Sheffield. His research interests include en-\nergy storage components for hybrid and electric ve-\nhicle drive-trains.\nD. A. Stone received the B.Eng. degree in elec-\ntronic engineering from the University of Sheffield,\nSheffield, U.K., and the Ph.D. degree from Liverpool\nUniversity, Liverpool, U.K., in 1984 and 1989,\nrespectively.\nHe is with the University of Sheffield as a\nMember of Academic Staff, specializing in power\nelectronics and machine drive systems. His current\nresearch interests include hybrid-electric vehicles,\nbattery charging, EMC, and novel lamp ballasts for\nlow-pressure fluorescent lamps.\nC. M. Bingham (M\u201900) received the B.Eng. degree\nin electronic systems and control engineering from\nSheffield City Polytechnic, Sheffield, U.K., in 1989,\nthe M.Sc. (Eng.) degree in control systems engi-\nneering from the University of Sheffield, Sheffield,\nU.K., in 1990, and Ph.D. degree from Cranfield\nUniversity, U.K., in 1994, for research on control\nsystems to accommodate nonlinear dynamic effects\nin aerospace flight\u2013surface actuators.\nHe was a Postdoctoral Researcher with Cranfield\nUniversity until taking a research position at the Uni-\nversity of Sheffield. He was appointed Lecturer in the Department of Electronic\nand Electrical Engineering, University of Sheffield, in 1998 and Senior Lecturer\nin 2003. His current research interests include traction control\/antilock braking\nsystems for electric vehicles, electromechanical actuation of flight control sur-\nfaces, control of active magnetic bearings for high-speed machines, sensorless\ncontrol of brushless machines, and the high-speed modeling, analysis, and de-\nsign of resonant power converters.\n"}