{"doi":"10.1017\/S0022112007005605","coreId":"97039","oai":"oai:generic.eprints.org:631\/core69","identifiers":["oai:generic.eprints.org:631\/core69","10.1017\/S0022112007005605"],"title":"Numerical solutions of the unsteady Fanno model for compressible pipe flow","authors":["Ockendon, J. R.","Ockendon, H.","Novikovs, A."],"enrichments":{"references":[{"id":846574,"title":"Analysis of Turbulent Boundary Layers","authors":[],"date":"1974","doi":"10.1115\/1.3423784","raw":null,"cites":null},{"id":847905,"title":"Equivalence of the Euler and Lagrangian equations of gas dynamics for weak solutions.","authors":[],"date":"1987","doi":"10.1016\/0022-0396(87)90188-4","raw":null,"cites":null},{"id":847062,"title":"Laws of flow in rough pipes.","authors":[],"date":"1950","doi":"10.1680\/iicep.1976.3342","raw":null,"cites":null},{"id":847316,"title":"The Fanno model for turbulent compressible flow.","authors":[],"date":"2001","doi":"10.1017\/S0022112001005584","raw":null,"cites":null},{"id":847743,"title":"Time-dependent boundary conditions for hyperbolic systems,","authors":[],"date":"1990","doi":"10.1016\/0021-9991(90)90152-Q","raw":null,"cites":null},{"id":847527,"title":"Time-dependent boundary conditions for hyperbolic systems.","authors":[],"date":"1987","doi":"10.1016\/0021-9991(87)90041-6","raw":null,"cites":null},{"id":846838,"title":"University of the Witwatersrand, Piston effect due to cock clllapse, problem description.","authors":[],"date":"2005","doi":null,"raw":null,"cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2007","abstract":"This paper presents numerical results on the evolution of the solutions of the Fanno model for compressible pipe flow. The principal results concern the large-time behaviour when nonlinear effects are appreciable throughout the evolution. Our computations show that compression waves can be expected to evolve into travelling waves for large times whereas expansion waves cannot","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/97039.pdf","fullTextIdentifier":"http:\/\/eprints.maths.ox.ac.uk\/631\/1\/jfm-papernovikovs07.pdf","pdfHashValue":"f9dca72d156be24c3a8dec44770c0496705c2666","publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:generic.eprints.org:631<\/identifier><datestamp>\n      2015-05-29T18:25:40Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D4F5A:4D3335<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/eprints.maths.ox.ac.uk\/631\/<\/dc:relation><dc:title>\n        Numerical solutions of the unsteady Fanno model for compressible pipe flow<\/dc:title><dc:creator>\n        Ockendon, J. R.<\/dc:creator><dc:creator>\n        Ockendon, H.<\/dc:creator><dc:creator>\n        Novikovs, A.<\/dc:creator><dc:subject>\n        Partial differential equations<\/dc:subject><dc:description>\n        This paper presents numerical results on the evolution of the solutions of the Fanno model for compressible pipe flow. The principal results concern the large-time behaviour when nonlinear effects are appreciable throughout the evolution. Our computations show that compression waves can be expected to evolve into travelling waves for large times whereas expansion waves cannot.<\/dc:description><dc:date>\n        2007<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/eprints.maths.ox.ac.uk\/631\/1\/jfm-papernovikovs07.pdf<\/dc:identifier><dc:identifier>\n          Ockendon, J. R. and Ockendon, H. and Novikovs, A.  (2007) Numerical solutions of the unsteady Fanno model for compressible pipe flow.  Journal of Fluid Mechanics, 579 .   pp. 493-507.      <\/dc:identifier><dc:relation>\n        10.1017\/S0022112007005605<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/eprints.maths.ox.ac.uk\/631\/","10.1017\/S0022112007005605"],"year":2007,"topics":["Partial differential equations"],"subject":["Article","PeerReviewed"],"fullText":"J. Fluid Mech. (2007), vol. 579, pp. 493\u2013507. c\u00a9 2007 Cambridge University Press\ndoi:10.1017\/S0022112007005605 Printed in the United Kingdom\n493\nNumerical solutions of the unsteady Fanno\nmodel for compressible pipe flow\nA. NOVIKOVS, H. OCKENDON AND J. R. OCKENDON\nOCIAM, Mathematical Institute, 24-29 St Giles\u2019, Oxford OX1 3LB, UK\n(Received 1 September 2006 and in revised form 12 January 2007)\nThis paper presents numerical results on the evolution of the solutions of the Fanno\nmodel for compressible pipe flow. The principal results concern the large-time beha-\nviour when nonlinear effects are appreciable throughout the evolution. Our computa-\ntions show that compression waves can be expected to evolve into travelling waves\nfor large times whereas expansion waves cannot.\n1. Introduction\nAs described in Ockendon, Ockendon & Falle (2001), the dimensionless Fanno\nmodel for turbulent gas flow in a rough pipe of constant cross-section in which the\ncharacteristic velocity, pressure and density are u0, p0 and \u03c10 is\nd\u03c1\ndt\n+ \u03c1\n\u2202u\n\u2202x\n= 0, (1.1)\ndu\ndt\n+\n1\n\u03c1\n\u2202p\n\u2202x\n= \u2212u|u|, (1.2)\nd\ndt\n(\np\n(\u03b3 \u2212 1)\u03c1 +\n1\n2\nu2\n)\n\u2212 1\n\u03c12\n(\n1\n(\u03b3 \u2212 1)M20 + p\n)\nd\u03c1\ndt\n+\nu\n\u03c1\n\u2202p\n\u2202x\n= 0, (1.3)\nwhere \u03b3 > 1 is the ratio of specific heats, d\/dt = \u2202\/\u2202t + u\u2202\/\u2202x and M0 = u0\/a0, where\na20 = \u03b3p0\/\u03c10; the term involving M0 in (1.3) appears because the difference between\nthe pressure and p0 has been non-dimensionalized with \u03c10u\n2\n0. This model only differs\nfrom the inviscid model in the right-hand side of (1.2), which represents the effect\nof friction at the pipe wall. However, while the characteristics are unaffected by the\npresence of this term, it does render the flow non-isentropic and there are no Riemann\ninvariants.\nThe model can be validated from the mean turbulent flow equations for two-\ndimensional flow in a thin channel with velocity vector (u, v) as derived in Cebeci &\nSmith (1974):\n\u2202\u03c1\u00af\n\u2202t\n+\n\u2202\n\u2202x\n(\u03c1\u00afu\u00af) +\n\u2202\n\u2202y\n(\u03c1v) = 0, (1.4)\n\u2202\n\u2202t\n(\u03c1\u00afu\u00af) +\n\u2202\n\u2202x\n(\u03c1\u00afu\u00afu\u00af) +\n\u2202\n\u2202y\n(\u03c1vu\u00af) +\n\u2202p\u00af\n\u2202x\n=\n\u2202\u03c4\u00af\n\u2202y\n, (1.5)\n\u2202\n\u2202t\n(\np\u00af\n\u03b3 \u2212 1 + \u03c1\u00af\nu\u00af2\n2\n)\n+\n\u2202\n\u2202x\n(\nu\u00af\n(\n\u03b3 p\u00af\n\u03b3 \u2212 1 + \u03c1\u00af\nu\u00af2\n2\n))\n+\n\u2202\n\u2202y\n(\n\u03c1v\n(\n\u03b3 p\u00af\n(\u03b3 \u2212 1)\u03c1\u00af +\nu\u00af2\n2\n))\n=\n\u2202\n\u2202y\n(u\u00af\u03c4\u00af ),\n(1.6)\n494 A. Novikovs, H. Ockendon and J. R. Ockendon\nwhere the barred quantities are time-averaged over the largest turbulent time scale.\nThe assumption that the flow is nearly unidirectional allows the stress, which com-\nprises both viscous and Reynolds stresses, to be approximated by \u03c4\u00af and also allows\napproximations such as \u03c1u= \u03c1\u00afu\u00af, whereas \u03c1v \u0002= \u03c1\u00afv\u00af.\nAssuming the channel is of constant width l, we integrate equations (1.4)\u2013(1.6) with\nrespect to y from \u2212l\/2 to l\/2 using no-slip boundary conditions. Setting \u222b l\/2\u2212l\/2 u\u00afdy = lu\netc., and \u03c4\u00af =\u00b1\u03c4w at the channel walls \u00b1l\/2, we obtain the dimensional form of the\nFanno flow equations (1.1)\u2013(1.3) under the assumption that the dimensional turbulent\nshear stress at the wall is \u03c4w =\u2212 12\u03c1u|u|f . This formula was discussed extensively in\nthe famous experimental work of Nikuradse (1950). There he elucidated how the\nfriction factor f at the wall of a pipe in which the flow is turbulent depends on\nthe wall roughness and the Reynolds number Re=Ul\/\u03bd, where U is the typical\nvelocity of fluid, \u03bd is the kinematic viscosity. These studies were recently confirmed\ntheoretically by Gioia & Chakraborty (2006). They predict that, for large Re, the\nfriction factor is a function of roughness only and, for many commonly occurring\nrough pipes, f \u223c O(10\u22123). However, we emphasize that all this experimental evidence\nonly underpins the Fanno model for steady flow and it is merely a reasonable\nhypothesis for flows that are unsteady on a sufficiently long time scale.\nThe main aim of this paper is to present a reliable numerical procedure for solving\n(1.1)\u2013(1.3) in two situations where there is analytical evidence for at least some of the\nfeatures of the solution.\nOne class of problems to be addressed concerns flow in a semi-infinite pipe when\nthe end pressure is suddenly increased or decreased. For small pressure changes\nrelative to ambient, characterized by a dimensionless parameter \u0006 \u0004 1, these problems\nare susceptible to asymptotic analysis, as described in Ockendon et al. (2001). The\nfollowing temporal sequence emerges:\n(i) for dimensional times of O(l\/a0f ) friction is negligible to lowest order;\n(ii) for times of O(l\/\u0006a0f ), the velocity is governed by a nonlinear damped wave\nequation of the form\n\u22022u\n\u2202t2\n\u2212 \u2202\n2u\n\u2202x2\n= \u22122|u|\u2202u\n\u2202t\nin suitable variables;\n(iii) for even larger times of O(l\/\u00062a0f ), the flow lags further and further behind\nthe leading characteristic propagating from the end of the pipe, and the velocity\nsatisfies the parabolic equation\n\u22022u\n\u2202x2\n= 2|u|\u2202u\n\u2202t\n,\nagain in suitable variables.\nAnother class of problems concerns piston motion in an infinitely long pipe, where\nasymptotic results are again available when the piston velocity is of O(\u0006a0), where\n\u0006 \u0004 1. The sequence of events is the same as for the pressure impulse problem, with\nthe model becoming parabolic in nature over times of O(l\/\u00062a0f ). However, for times\nof O(l\/\u00063a0f ) or longer, the pressure and density variations grow to be of the order\nof their ambient values and the flow is then modelled by the degenerate hyperbolic\nsystem\n\u2202\u03c1\n\u2202t\n+\n\u2202\n\u2202x\n(\u03c1u) = 0,\n\u2202p\n\u2202x\n+ \u03b3\u03c1u|u| = 0, \u2202p\n\u2202t\n+ \u03b3\n\u2202\n\u2202x\n(pu) = 0.\nNumerical solutions of the Fanno model for pipe flow 495\n0\n0\n0\n(a)\n(c)\n(b)\nx\nx\nx\nu\nu\nu\nus\nus\nu0\nu0\nu0\nFigure 1. Piston problem: travelling wave solutions for different Mach number flows\ndescribed in the text.\nIt was suggested in Ockendon et al. (2001) that a compressive piston motion eventually\nsets up a travelling wave in which a slug of gas moves with the piston velocity, the\nleading edge of this slug having a velocity \u03b3 times the piston velocity; ahead of this\nslug, the gas is effectively at rest. For piston motions that expand the gas, a similar\nconfinement occurs in the vicinity of the initial piston position, where a dissipative\nexpansion wave describes the regime in which the flow is spatially varying.\nThese two situations will be analysed numerically in \u00a7 2 and \u00a7 3, in cases where \u0006 is\nof O(1) or smaller. One of our key results will be an assessment of another suggestion\nmade in Ockendon et al. (2001), namely that there exists a solution of (1.1)\u2013(1.3)\nwhich is a fully nonlinear wave of permanent form whose profile depends sensitively\non the Mach number Mw of the wave, defined as the ratio of the speed of the wave\nto the ambient sound speed ahead of the wave:\n(i) if Mw < 1, smooth compressive waves are possible with speed \u03b3 u0, where u0 is\nthe speed behind the wave (figure 1a);\n(ii) if 1<Mw <\n\u221a\n2\u03b3 \/(\u03b3 \u2212 1), the only possible travelling waves contain a shock,\nalso moving with speed \u03b3 u0 (figure 1b);\n(iii) if Mw >\n\u221a\n2\u03b3 \/(\u03b3 \u2212 1), scenario (ii) applies except that the velocity increases as\nthe shock is approached from downstream (figure 1c).\n496 A. Novikovs, H. Ockendon and J. R. Ockendon\nThe only expansion wave of permanent form that was proposed in Ockendon et al.\n(2001) described the flow behind a withdrawn piston moving with velocity precisely\n\u03b3 u0, where u0 is the speed of the gas at x =\u2212\u221e. The validity of this scenario for\ntravelling waves will be discussed in \u00a7 3.\nSince all the problems we will study have both initial and boundary conditions, our\nnumerical procedure will use the characteristic-based method presented in Thompson\n(1987, 1990). The key idea of this method is to identify outgoing and incoming waves\nat the boundary and then satisfy the correct boundary conditions in terms of these\nwaves. Moreover, since all the problems have a moving boundary, we will transform\nthem into a Lagrangian frame (\u03be, t) where the boundary is fixed, at \u03be =0.\nTo perform the characteristic analysis we need the primitive form of the hyperbolic\nsystem we study, namely\n\u2202u\n\u2202t\n+ A\n\u2202u\n\u2202\u03be\n= c, (1.7)\nand which also may be written as\nS\n\u2202u\n\u2202t\n+ L = Sc, (1.8)\nwhere the rows of S are the left eigenvectors l (i) corresponding to the eigenvalues \u03bb(i)\nof matrix A; the components L(i) of vector L are defined as\nL(i) \u2261 \u03bb(i)l (i) \u2202u\n\u2202\u03be\n. (1.9)\nThe eigenvalues \u03bb(i) are the slopes d\u03be\/dt of the characteristics of the hyperbolic system\n(1.7), and (1.8) are differential relations along the characteristics. Depending on the\ndirection of the characteristics at the boundary these relations represent incoming or\noutgoing waves\u2020. In particular, for problems posed in a semi-infinite region \u03be \u0001 0,\nthe incoming waves at \u03be =0 are those with \u03bb(i) < 0 and they carry information from\nearlier times. Thus, as long as the boundary is not a characteristic, the variables\nassociated with incoming waves can be found numerically using the definition of\nL(i) in (1.9). The numerical approximation of (1.8) will be based on one-sided finite\ndifference approximations involving only interior and boundary points, \u03be \u0001 0.\nWe will also encounter Goursat problems, when the boundary coincides with one of\nthe characteristic paths, along which (1.8) becomes an ordinary differential equation\nin time. In this case, the outgoing waves with \u03bb(i) > 0 at \u03be =0 depend on data on the\nboundary. For these waves L(i) have to be found from (1.8) using the given boundary\nconditions at \u03be =0.\nIn any case, the problem of implementing boundary conditions is reduced to the\nproblem of computing the appropriate values for the L(i) terms in (1.8)\u2013(1.9). Once all\nthe boundary values are computed, it is possible to use higher-order finite difference\napproximations for (1.8) in the interior of the domain when \u03be > 0 to improve the\nglobal convergence.\n\u2020 The words incoming and outgoing do not have universal interpretations in the literature. By\nincoming we will mean a wave corresponding to a characteristic that impinges the boundary from\nearlier times from within the field of flow.\nNumerical solutions of the Fanno model for pipe flow 497\n0\n(a) (b)\nPiston path\nShock\nt t\nxp = u = 0, \u03c1 = 1 p = u = 0, \u03c1 = 1\nu = 1\nu = 1\n0\nPiston path\n\u03be\nShock\nFigure 2. The characteristic structure for the compressive piston problem: \u2014\u2013, positive\ncharacteristics; \u00b7 \u00b7 \u00b7 , negative characteristics; - - - , particle path. (a) Fixed space coordinate,\n(b) Lagrangian frame.\n2. Piston problems\n2.1. Compressive waves\nWe consider a piston moved impulsively with constant non-dimensional velocity u=1\ninto a quiescent gas occupying x\u0001 0, so that initial conditions are\nu = p = 0, \u03c1 = 1 in x > 0, (2.1)\nand u=1 at the piston x = t for all t > 0. Therefore we can also assume non-negative\nvelocity u throughout the flow.\nThe particle path dx\/dt = u is one of the characteristics of the Fanno model\n(1.1)\u2013(1.3), and the one that starts at t =0, x =0 coincides with the piston path as\nshown in figure 2(a). Thus, we have a well-posed Goursat problem. To transform the\nmoving-boundary value problem into a problem with fixed boundary we introduce a\nLagrangian coordinate\n\u03be =\n\u222b x\nx(t)\n\u03c1(s, t) ds, (2.2)\nwhere x(t) is a particle path. Then equations (1.1)\u2013(1.3) can be transformed into the\nconservative Lagrangian form\n\u2202\n\u2202t\n(\n1\n\u03c1\n)\n\u2212 \u2202u\n\u2202\u03be\n= 0, (2.3)\n\u2202u\n\u2202t\n+\n\u2202p\n\u2202\u03be\n= \u2212u2, (2.4)\n\u2202e\n\u2202t\n+\n\u2202\n\u2202\u03be\n(\nu\n(\np +\n1\n(\u03b3 \u2212 1)M20\n))\n= 0, (2.5)\nwhere e=p\/(\u03b3 \u22121)\u03c1 +u2\/2; in primitive variables the energy equation (2.5) becomes\n\u2202p\n\u2202t\n+ \u03b12\n\u2202u\n\u2202\u03be\n= (\u03b3 \u2212 1)\u03c1u3, (2.6)\nwhere \u03b12 = \u03b3p\u03c1+\u03c1\/M20 . It is not difficult to show by using the chain rule and product\nrule the equivalence of the Euler and Lagrangian equations for classical solutions.\nAlso, Wagner (1987), using techniques from measure theory, has proved that there\nis a one-to-one correspondence between bounded and measurable weak solutions of\n498 A. Novikovs, H. Ockendon and J. R. Ockendon\nthe Euler equations and weak solutions for the same problem written in Lagrangian\ncoordinates.\nThe initial conditions in the moving frame become\nu = p = 0, \u03c1 = 1 in \u03be > 0 at t = 0, (2.7)\nwhile, at the boundary \u03be =0, we have u=1 for t > 0. The inverse transformation of\nthe Lagrangian coordinate is\nx = x0(t) +\n\u222b \u03be\n0\n1\/\u03c1(s, t) ds, (2.8)\nand x0(t) satisfies the equation\ndx0\ndt\n= u(0, t).\nIn our case the piston path is known and therefore x0(t)= t .\nFor (2.3)\u2013(2.4) and (2.6) the eigenvalues are\n\u03bb(1) = \u2212\u03b1, \u03bb(2) = 0, \u03bb(3) = \u03b1, (2.9)\nand the corresponding left eigenvectors are\nl (1) = [0, \u2212\u03b1, 1], l (2) = [\u03b12, 0, 1], l (3) = [0, \u03b1, 1]. (2.10)\nFrom (1.9) with u =[1\/\u03c1, u, p]T we obtain\nL(1) = \u03bb(1)\n(\n\u2212\u03b1\u2202u\n\u2202\u03be\n+\n\u2202p\n\u2202\u03be\n)\n, L(2) = 0, L(3) = \u03bb(3)\n(\n\u03b1\n\u2202u\n\u2202\u03be\n+\n\u2202p\n\u2202\u03be\n)\n. (2.11)\nAfter inverting these definitions and substituting for \u2202u\/\u2202\u03be in terms of L in (2.3)\u2013(2.4),\n(2.6) we end up with the primitive equations (1.8), written as\n\u2202\n\u2202t\n(\n1\n\u03c1\n)\n\u2212 1\n2\u03b12\n(\nL(3) + L(1)\n)\n= 0,\n\u2202u\n\u2202t\n+\n1\n2\u03b1\n(L(3) \u2212 L(1)) = \u2212u2,\n\u2202p\n\u2202t\n+\n1\n2\n(\nL(3) + L(1)\n)\n= (\u03b3 \u2212 1)\u03c1u3.\n\u23ab\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23ac\n\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23ad\n(2.12)\nSince \u03bb(1) is always negative, it corresponds to an incoming characteristic at the\nboundary \u03be =0 as in figure 2(b). Therefore, the corresponding value of L(1) has to be\ncomputed from its definition in (1.9) using the one-sided difference approximation\n\u2202\n\u2202\u03be\nu0,n =\n1\n\t\u03be\n(u1,n \u2212 u0,n) + O(\t\u03be ) for n \u0001 1, (2.13)\nthe computational domain being defined as (\u03bej , tn)\u2261 (j\t\u03be, n\tt), j \u2208 [0, N ]. The\ncharacteristic corresponding to \u03bb(3) is outgoing from the boundary \u03be =0 and the value\nof L(3) is specified from the boundary condition \u2202u\/\u2202t =0 at \u03be =0. This condition is\nsatisfied if L(3) =L(1) \u2212 2\u03b1, which, together with (2.12), gives the pressure and density\nat the piston. To approximate the time derivative at the boundary we use the one-step\nforward Euler method.\nFor the numerical solution of the interior problem (j, n\u0001 1) we will solve the con-\nservative Lagrangian system (2.3)\u2013(2.5), thereby ensuring the approximate satisfaction\nof the Rankine\u2013Hugoniot conditions for any shock that appears. The eigenvalues of\nNumerical solutions of the Fanno model for pipe flow 499\nthis system are again given by (2.9) but the left eigenvectors are now\nl\u02dc (1) = [p\/(\u03b3 \u2212 1), u + \u03b1\/(\u03b3 \u2212 1)\u03c1, \u22121],\nl\u02dc (2) = [p + 1\/(\u03b3 \u2212 1)M20 , \u2212u, 1],\nl\u02dc (3) = [p\/(\u03b3 \u2212 1), u \u2212 \u03b1\/(\u03b3 \u2212 1)\u03c1, \u22121].\n\u23ab\u23aa\u23ac\n\u23aa\u23ad (2.14)\nAfter multiplying equations (2.3)\u2013(2.5) by the matrix S\u02dc of left eigenvectors l\u02dc (i), the\nrelations along the characteristics are\nS\u02dc\u2202u\n\u2202t\n+ S\u02dc \u2202\n\u2202\u03be\nf (u) = S\u02dcc, (2.15)\nwith\nu = [1\/\u03c1, u, e]T , f (u) = [\u2212u, p, u(p + 1\/(\u03b3 \u2212 1)M20)]T , c = [0, \u2212u2, 0]T .\nSince \u03bb(3) is always positive, we use a first-order upwind scheme to approximate the\nspatial derivative in the corresponding component of equation (2.15). Similarly, we\nuse a one-step downwinding stencil in the equation along the negative characteristic\ncorresponding to \u03bb(1). For the time discretization, the forward Euler method again\nwill be applied. Rewriting (2.15) in a discrete form, we then need to solve\nl\u02dc (1)j,nLuj,n = \u2212l\u02dc (1)j,nL+ f (uj,n) \u2212 u2j,n\n(\nuj,n \u2212 \u03bb\n(1)\nj,n\n(\u03b3 \u2212 1)\u03c1j,n\n)\n, (2.16)\nl\u02dc (2)j,nLuj,n = u3j,n, (2.17)\nl\u02dc (3)j,nLuj,n = \u2212l\u02dc (3)j,nL\u2212 f (uj,n) \u2212 u2j,n\n(\nuj,n \u2212 \u03bb\n(3)\nj,n\n(\u03b3 \u2212 1)\u03c1j,n\n)\n, (2.18)\nfor j, n\u0001 1; the time step \tt is chosen to satisfy the CFL condition that the characteri-\nstic through a point must lie within the domain of dependence at that point, and the\nfinite difference operators are defined as\nLu = uj,n+1 \u2212 uj,n\n\tt\n, L+u = uj+1,n \u2212 uj,n\n\t\u03be\n, L\u2212u = uj,n \u2212 uj\u22121,n\n\t\u03be\n.\nThe above discretization has been chosen because of its ability to predict large-time\nsolutions to Fanno problems. Unfortunately, this scheme is not fully conservative\nand numerical dissipation may be expected when strong shocks occur. To check\nthis possibility, we have tested the code against exact solutions for piston problems\nwithout the Fanno term. The results are shown in figure 3, which gives us confidence\nthat even when the piston Mach number is M0 = 1.4, the error in the shock position\nat t =100 is still less than 5%.\nAll the numerical computations were performed on a grid of length 120, divided\ninto 1600 subintervals (N =1600,\t\u03be =0.075). The ratio of specific heats \u03b3 was taken\nto be 1.4 throughout. For the first test, in the light of the predictions in Ockendon\net al. (2001), the Mach number is small enough to satisfy Mw = \u03b3M0 < 1, so we\nchoose M0 = \u0006 =0.1. In this case we expect a smooth travelling wave solution to exist\nwhen time becomes t \u0001O(\u0006\u22122). Figure 4 shows the comparison of the numerical and\nasymptotic solutions when t =O(\u0006\u22123); this situation was also indicated schematically\nin figure 1(a).\nIn the hope of obtaining a travelling wave solution as in figure 1(b), we next choose\nthe Mach number M0 to be in the interval (1\/\u03b3,\n\u221a\n2\/\u03b3 (\u03b3 \u2212 1)). The computed velocity\n500 A. Novikovs, H. Ockendon and J. R. Ockendon\n20 40 60 80 100 120 140 160 180 200\n0\n0.2\n0.4\n0.6\n0.8\n1.0\n1.2\nx\nV\nel\noc\nit\ny\nFigure 3. Comparison of numerical (solid line) with exact (dot-dashed line) solution of\ninviscid gas flow for compressive piston motion at times t =20, 40, 60, 80, 100, and M0 = 1.4.\n40 50 60 70 80 90 100\n0\n0.2\n0.4\n0.6\n0.8\n1.0\nx\/100\nV\nel\noc\nit\ny\nFigure 4. Comparison of numerical (solid line) with asymptotic (dashed line) solution for\ncompressive piston motion when t =3000 and M0 = \u0006 =0.1.\nprofiles at different time steps and the asymptotic solution are shown in figure 5(a, b)\nwhen M0 = 1.4. We observe a shock, which was correctly captured by the numerical\nscheme, moving at the predicted speed \u03b3 .\nFor even larger Mach numbers with M0\u0001\n\u221a\n2\/\u03b3 (\u03b3 \u2212 1), travelling wave solutions\nalso exist, as in figure 1(c). The solutions for u at t =20, 40, 60, 80, 100 and M0 = 3.5\nare shown in figure 5(c, d). As expected, the velocity grows spatially until it reaches the\nconstant velocity us at the shock position x = \u03b3 t . Figure 5(d) shows the comparison\nbetween the numerical and asymptotic solutions near the shock. The numerical\nsolution gives us =1.1189 in comparison with the predicted value (2\u03b3 \/\u03b3 + 1)(1 \u2212\n1\/\u03b3 2M20 )= 1.1181 from Ockendon et al. (2001).\nWe also present the corresponding pressure profiles when M0 = 1.4 and M0 = 3.5\nin figure 6 in order to emphasize the strong qualitative difference between inviscid\nshocks and shocks in the Fanno model.\nNumerical solutions of the Fanno model for pipe flow 501\n4 6 8 10 12 14 16 18 20\n0\n0.2\n0.4\n0.6\n0.8\n1.0\n1.2\nV\nel\noc\nit\ny\n(a)\n10 11 12 13 14 15 16\n0.80\n0.86\n0.92\n0.98\n1.04\n1.10\n(b)\nus\nus\nx\/10 x\/10\n(c)\n0.90\n0.96\n1.02\n1.08\n1.14\n1.20\n(d)\n4 6 8 10 12 14 16 18 20\n0\n0.2\n0.4\n0.6\n0.8\n1.0\n1.2\nV\nel\noc\nit\ny\n10 11 12 13 14 15 16\nFigure 5. Numerical (solid line) and asymptotic (dashed line) solutions for the compressive\npiston problem when (a, b) M0 = 1.4 and (c, d) M0 = 3.5. Computed velocity profiles at times\nt =20, 40, 60, 80, 100, and asymptotic velocity profile at t =100. (b) Magnification of (a) in the\nrange x \u2208 [100, 160]. (d) Magnification of (c) in the range x \u2208 [100, 165].\n4 6 8 10 12 14 16 18 20\n0\n40\n80\n120\n160\nx\/10\nP\nre\nss\nur\ne\n(a)\n0\n100\n200\n300\n400\n(b)\n4 6 8 10 12 14 16 18 20\nx\/10\nFigure 6. Computed pressure profiles (solid line) for the compressive piston problem at times\nt =20, 40, 60, 80, 100 for different Mach numbers: (a) M0 = 1.4, (b) M0 = 3.5. The comparison\nwith asymptotic solutions (dashed line) corresponds to t =100.\n2.2. Expansion waves\nNow we suppose that gas initially occupies the region x < 0 but flows in the positive\nx-direction behind a piston at x = t . In this case we again can assume that the\nvelocity of the gas u is non-negative throughout the flow. As in the compression case\n502 A. Novikovs, H. Ockendon and J. R. Ockendon\n\u2013300 \u2013250 \u2013200 \u2013150 \u2013100 \u201350 0 40\n0\n0.2\n0.4\n0.6\n0.8\n1.0\nV\nel\noc\nit\ny\n(a)\n\u2013250 \u2013200 \u2013150 \u2013100 \u201350 0 40\n\u201360\n\u201350\n\u201340\n\u201330\n\u201320\n\u201310\n0\n\u2013100 \u201380 \u201360 \u201340 \u201320 0 20 40\n0\n0.2\n0.4\n0.6\n0.8\n1.0\nx\/10\nV\nel\noc\nit\ny\n(b)\n\u2013100 \u201380 \u201360 \u201340 \u201320 0 20 40\n\u20130.7\n\u20130.6\n\u20130.5\n\u20130.4\n\u20130.3\n\u20130.2\n\u20130.1\n0\nx\/10\nP\nre\nss\nur\ne\nP\nre\nss\nur\ne\nFigure 7. Velocity and pressure profiles of the expanding piston problem at times t =80, 160,\n240, 320, 400 for different Mach number flows: (a) M0 = 0.1, (b) M0 = 1. Note, that both\nvelocity and pressure profiles become less steep as time increases.\nwe transform the problem into a Lagrangian frame in which the initial and boundary\nconditions are\nu = p = 0, \u03c1 = 1 in \u03be < 0 at t = 0, (2.19)\nu = 1 in t > 0 at \u03be = 0. (2.20)\nAfter the withdrawal of the piston, expansion waves start propagating in the region\n\u03be < 0 and these are associated with the characteristics of negative slope. At the piston\n\u03be =0, the positive characteristics represent incoming waves, so the characteristic-\nbased boundary conditions become different from those in compressive piston case.\nIn particular, the value of L(3) at \u03be =0 must be computed from its definition in (1.9)\nusing only the interior and boundary points of the computational domain defined as\n(\u03bej , tn)\u2261 (\t\u03be (j \u2212N), n\tt), j \u2208 [0, N]. From (2.12) we see that the boundary condition\n\u2202u\/\u2202t =0 at \u03be =0 is satisfied if L(1) =L(3) + 2\u03b1. Putting this back into (2.12), we can\ndetermine 1\/\u03c1 and p at the piston. To approximate the time derivative, we again use\nthe forward Euler method and, to compute the interior problem when j, n\u0001 1, the\nnumerical procedure is the same as for compressive motion.\nThe computed velocities and pressures are shown in figure 7 at different times and\nfor different Mach number flows. Note that none of these expansion waves appears\nto tend to a travelling wave for large times and we will discuss the reason for this\nin \u00a7 3.\nNumerical solutions of the Fanno model for pipe flow 503\n0\nContact discontinuity\n(a)\nShock\nt\nxp = u = 0, \u03c1 = 1 p = u = 0, \u03c1 = 1\np = 1\u2014M0\np = 1\u2014M0\n0\nContact discontinuity\n(b)\n\u03be\nShock\nt\nFigure 8. The characteristic structure for the compressive pressure-jump problem: \u2014, positive\ncharacteristics; \u00b7 \u00b7 \u00b7 , negative characteristics; - - - , particle path. (a) Fixed space coordinate,\n(b) Lagrangian frame.\n3. Pressure-jump problems\n3.1. Compressive waves\nIn this section, we consider gas flow in a semi-infinite tube x\u0001 0 produced by a sudden\nchange in pressure at the end x =0, the gas being at rest with dimensional pressure p0\nand density \u03c10 at t =0. Such problems are motivated by the application of (1.1)\u2013(1.3)\nto flows in pressure transducers and mine shafts (Mathematics in Industry Study\nGroup 2005), which can be modelled by prescribing a pressure jump precisely at the\nend of the tube, x =0. However, the resulting characteristic diagram in figure 8(a)\nreveals that there are two outgoing characteristic families from the boundary x =0;\nthey have slopes \u00b5=dx\/dt = u, u + c, where c=\n\u221a\n\u03b3p\/\u03c1 is the speed of sound.\nTherefore, we expect to prescribe two conditions on x =0 rather than just pressure\nto obtain well-posedeness. In practice, however, the end pressure will be controlled\nby gas flowing into or out of the pipe from the region x < 0, so that it is realistic on\nphysical grounds to impose the pressure on the gas particle path corresponding to\ndx\/dt = u with x(0)= 0 rather than at the fixed boundary. In order to be fully realistic\nwe would have to introduce a contact discontinuity x = xc(t) defined as dxc\/dt = u\nwith xc(0)= 0 and solve equations behind this discontinuity as well as ahead of it.\nTaking pressure to be constant on this particle path is equivalent to assuming the\nexternal flow comes from a large reservoir. We will discuss the implication of contact\ndiscontinuities in the conclusion.\nWith prescribed pressure on the initial particle path, the problem becomes a Goursat\nproblem for which it is natural to introduce a material coordinate as in (2.2), leading\nto the non-dimensional Lagrangian equations (2.3)\u2013(2.5). The initial conditions are\nu = p = 0, \u03c1 = 1 when \u03be > 0, t = 0. (3.1)\nIn order to write down the boundary condition, we must remember that the scalings\nleading to (1.1)\u2013(1.3) correspond to dimensional pressures p0+\u03c10u\n2\n0p=p0(1+\u03b3M\n2\n0p).\nMoreover, in order to maintain consistency with our use of M0 in \u00a7 \u00a7 1 and 2, we\nwrite the dimensional pressure applied to the end of the tube as p0(1 + \u03b3M0), which\ndetermines M0 for this problem. Hence, even though larger dimensional applied\npressures lead to larger Mach numbers, our non-dimensional boundary condition is\np =\n1\nM0\nat \u03be = 0, t > 0. (3.2)\n504 A. Novikovs, H. Ockendon and J. R. Ockendon\n1 2 3 4 5 6 7 80\n0.04\n0.08\n0.12\n0.16\n\u03be\/104\nV\nel\noc\nit\ny\n1 2 3 4 5 6 7 80\n0.2\n0.4\n0.6\n0.8\n1.0\n\u03be\/104\nP\nre\nss\nur\ne\nFigure 9. Computed velocity and pressure profiles (solid line) for the compressive\npressure-jump problem at times t =100, 200, 300, 500, 700 when M0 = 0.01; pressure is scaled\nwith 0.01. The comparison with asymptotic solutions (dashed line) corresponds to t =700.\nAs in (2.13), the structure of characteristics at the boundary \u03be =0 suggests the use of\na first-order downwind scheme to approximate spatial derivatives in the definition of\nL(1) in (2.11), see figure 8(b). At the boundary \u03be =0, the condition is \u2202p\/\u2202t =0, which\nimplies L(3) =\u2212L(1) + 2(\u03b3 \u2212 1)u3\u03c1. Having computed L(1) and L(3) in the primitive\nequations (2.12) we can find u and \u03c1 on \u03be =0 for all t > 0. To find the solution inside\nthe domain \u03be, t > 0 we use the same method as for the piston problems in \u00a7 2.\nFigure 9 compares the numerical and asymptotic solutions for M0 = 0.01 when time\nhas reached t =O(M\u221220 ). We see good agreement between the velocities and pressures\nas expected for t \u0001O(M\u221210 ). For Mach number of O(1) and larger the velocity and\npressure profiles at different time steps are plotted in figure 10. This figure contrasts\nstrongly with figure 6 because, in the pressure-jump problems, there is no mechanism\ngenerating the high pressures associated with \u2018Fanno shocks\u2019.\n3.2. Expansion waves\nNow we consider the case when expansion waves occur due to a sudden pressure\ndrop at one end of the tube. The initial conditions are still (3.1) but, at the boundary\nx =0, we have a sudden decrease in pressure\np(0, t) =\n{\n0, t < 0\n\u22121\/M0, t > 0. (3.3)\nAs in the corresponding piston problem, an expansion fan is again formed by the\npositive outgoing characteristics from the discontinuity \u03be = t =0. Hence, the velocity\nand density are completely determined at \u03be =0 by the negative and zero-slope\ncharacteristics for all times t > 0. Indeed, we can follow all the steps in the numerical\nmethod described above for compressive motion, except that, since u< 0, the term\nu|u| in the Fanno model should be replaced by \u2212u2 throughout the computations.\nFigure 11(a, b) shows the velocity and pressure solution profiles at different times and\nfor different values of Mach number M0.\nAs in \u00a7 2, we again note that none of the expansion waves appear to tend to a\ntravelling wave for large times. This is despite the theoretical possibility that such a\ntravelling wave exists when \u03b3M0 =\n\u221a\n2\u03b3 \/(\u03b3 \u2212 1) in Ockendon et al. (2001).\nIn order to investigate this possibility we have used the expansion wave profile in\nOckendon et al. (2001) as the initial condition for a Fanno flow on \u2212\u221e <x < \u221e and\nNumerical solutions of the Fanno model for pipe flow 505\n1 2 3 4 5 6 7 80\n0.02\n0.04\n0.06\n0.08\n0.10\n0.12\n0.14\nV\nel\noc\nit\ny\n(a)\n1 2 3 4 5 6 7 80\n0.2\n0.4\n0.6\n0.8\n1.0\nP\nre\nss\nur\ne\n0.4 0.8 1.2 1.6 2.00\n0.01\n0.02\n0.03\n0.04\n0.05\n0.06\n0.07\n0.08\n\u03be\/100\nV\nel\noc\nit\ny\n(b)\n0.4 0.8 1.2 1.6 2.00\n0.02\n0.04\n0.06\n0.08\n0.10\n\u03be\/100\nP\nre\nss\nur\ne\nFigure 10. Velocity and pressure profiles of the compressive pressure-jump problem at times\nt =100, 200, 300, 500, 700 for different Mach number flows: (a) M0 = 1, (b) M0 = 10.\nunphysical oscillations appeared very rapidly for all the time steps we used. Hence,\nwe endorse the conjecture in Ockendon et al. (2001) that such expansion waves are\nunstable.\n4. Conclusions\nThis paper has shown how discretizations based on the method of characteristics\ncan be applied to the Fanno model of compressible pipe flow. We have emphasized\nthe use of the method over long time intervals, so that its predictions can be validated\nagainst analytical results for weakly nonlinear flows. In particular, we have considered\ncompression and expansion waves driven by pistons and by step-function pressure\nchanges. Our results suggest that in all compressive flows into a quiescent region,\ndispersed or partially dispersed shocks will emerge but that they will eventually decay\nunless energy is continually supplied to the gas. Expansion into a quiescent region\nis qualitatively different from the predictions of inviscid expansion waves and, even\nthough a travelling wave of expansion is theoretically possible for the Fanno model\nin a special case, our computations have revealed it to be unstable. Further evidence\nis provided by figure 12 which displays the velocity profile for the expansion wave\nproduced by a piston withdrawn at speed \u03b3 , corresponding to M0 =\n\u221a\n2\/(\u03b3 \u2212 1)\u03b3 .\nComparison with figure 7 suggests that this value of M0 is in no way exceptional.\nOur investigations have revealed one interesting open question, namely the evolution\nof a contact discontinuity under the Fanno model. Preliminary results suggest that it\n506 A. Novikovs, H. Ockendon and J. R. Ockendon\n0 1 2 3 4 5 6 7 8\n\u20130.14\n\u20130.12\n\u20130.10\n\u20130.08\n\u20130.06\n\u20130.04\n\u20130.02\n0\n\u03be\/104 \u03be\/104\nV\nel\noc\nit\ny\n(a)\n0 1 2 3 4 5 6 7 8\n\u2013100\n\u201380\n\u201360\n\u201340\n\u201320\n0\nP\nre\nss\nur\ne\n0 1 2 3 4 5 6 7 8\n\u20130.30\n\u20130.25\n\u20130.20\n\u20130.15\n\u20130.10\n\u20130.05\n0\n\u03be\/100\nV\nel\noc\nit\ny\n(b)\n0 1 2 3 4 5 6\n\u20131.0\n\u20130.8\n\u20130.6\n\u20130.4\n\u20130.2\n0\n\u03be\/100\nP\nre\nss\nur\ne\nFigure 11. Velocity and pressure profiles of the expansive pressure-jump problem at times\nt =200, 400, 500, 600, 700 for different Mach number flows: (a) M0 = 0.01, (b) M0 = 1. Note,\nas time increases both velocity and pressure profiles get less steep.\n\u201380 \u201360 \u201340 \u201320 0 20 40 60\n0\n0.2\n0.4\n0.6\n0.8\n1.0\n1.2\n1.4\nx\/10\nV\nel\noc\nit\ny\n\u201360 \u201340 \u201320 0 20 40 60\n\u20130.20\n\u20130.16\n\u20130.12\n\u20130.08\n\u20130.04\n0\nx\/10\nP\nre\nss\nur\ne\nFigure 12. Computed velocity and pressure profiles of the expanding piston problem at\ntimes t =80, 160, 240, 320, 400 when M0 =\n\u221a\n2\/(\u03b3 \u2212 1)\u03b3 =1.8898.\nis the speed rather than the strength of contact discontinuities that is most affected\nby the wall friction.\nThe authors would like to acknowledge the valuable advice given by P. J. Dellar.\nAlso A. Novikovs was partially supported by the EPSRC and received an Alan Poole\nscholarship from St Catherine\u2019s College, Oxford.\nNumerical solutions of the Fanno model for pipe flow 507\nREFERENCES\nCebeci, T. & Smith, A. M. O. 1974 Analysis of Turbulent Boundary Layers . Academic.\nGioia, G. & Chakraborty, P. 2006 Turbulent friction in rough pipes and the energy spectrum of\nthe phenomenological theory. Phys. Rev. Lett. 96, 044502.\nMathematics in Industry Study Group 2005 University of the Witwatersrand, Piston effect due\nto cock clllapse, problem description. http:\/\/www.wits.ac.za\/misgsa2005\/.\nNikuradse, J. 1950 Laws of flow in rough pipes. Reprinted in English in NACA Tech. Memo. 1292.\nOckendon, H., Ockendon, J. R. & Falle, S. A. E. G. 2001 The Fanno model for turbulent\ncompressible flow. J. Fluid Mech. 445, 187\u2013206.\nThompson, K. W. 1987 Time-dependent boundary conditions for hyperbolic systems. J. Comput.\nPhys. 68(1), 1\u201324.\nThompson, K. W. 1990 Time-dependent boundary conditions for hyperbolic systems, II. J. Comput.\nPhys. 89(2), 439\u2013461.\nWagner, D. H. 1987 Equivalence of the Euler and Lagrangian equations of gas dynamics for weak\nsolutions. J. Diffl Equat. 68, 118\u2013136.\n"}