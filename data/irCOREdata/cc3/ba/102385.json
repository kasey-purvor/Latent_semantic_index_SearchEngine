{"doi":"10.1109\/TSP.2006.890883","coreId":"102385","oai":"oai:epubs.surrey.ac.uk:1844","identifiers":["oai:epubs.surrey.ac.uk:1844","10.1109\/TSP.2006.890883"],"title":"Estimation of carrier frequency offset for multicarrier CDMA uplink","authors":["Ma, Y","Tafazolli, R"],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2007-06-01","abstract":null,"downloadUrl":"","fullTextIdentifier":null,"pdfHashValue":null,"publisher":"IEEE-INST ELECTRICAL ELECTRONICS ENGINEERS INC","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:epubs.surrey.ac.uk:1844<\/identifier><datestamp>\n      2017-10-31T14:03:20Z<\/datestamp><setSpec>\n      74797065733D61727469636C65<\/setSpec><setSpec>\n      6469766973696F6E733D656E67616E64706879736963616C736369656E636573:656C656374726F6E6963656E67696E656572696E67:63637372<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/epubs.surrey.ac.uk\/1844\/<\/dc:relation><dc:title>\n        Estimation of carrier frequency offset for multicarrier CDMA uplink<\/dc:title><dc:creator>\n        Ma, Y<\/dc:creator><dc:creator>\n        Tafazolli, R<\/dc:creator><dc:publisher>\n        IEEE-INST ELECTRICAL ELECTRONICS ENGINEERS INC<\/dc:publisher><dc:date>\n        2007-06-01<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/epubs.surrey.ac.uk\/1844\/1\/fulltext.pdf<\/dc:identifier><dc:identifier>\n          Ma, Y and Tafazolli, R  (2007) Estimation of carrier frequency offset for multicarrier CDMA uplink   IEEE TRANSACTIONS ON SIGNAL PROCESSING, 55 (6).  pp. 2617-2627.      <\/dc:identifier><dc:relation>\n        10.1109\/TSP.2006.890883<\/dc:relation><dc:language>\n        English<\/dc:language><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/epubs.surrey.ac.uk\/1844\/","10.1109\/TSP.2006.890883"],"year":2007,"topics":[],"subject":["Article","PeerReviewed"],"fullText":"IEEE TRANSACTIONS ON SIGNAL PROCESSING, VOL. 55, NO. 6, JUNE 2007 2617\nEstimation of Carrier Frequency Offset for\nMulticarrier CDMA Uplink\nYi Ma, Member, IEEE, and Rahim Tafazolli\nAbstract\u2014This paper presents a training-based estimation\nmethod of carrier frequency offset (CFO) for multicarrier code-\ndivision multiple-access (MC-CDMA) uplink. The basic assump-\ntion is the same as in Morellis\u2019 work (OFDMA), i.e., active users\nin the network are classified into two categories: reference (syn-\nchronized) users (RUs) and new (asynchronized) users (NUs). But,\nwe consider the system that RUs use CDMA to share the wireless\nmedium. NUs employ time-division multiple-access (TDMA) for\nthe training purpose. Our major idea is to perform the CFO\nestimation in the desired signal subspace that is orthogonal to\nthe RU subspace. The proposed approach is investigated both\nin the subband and interleaved MC-CDMA systems. It is shown\nthat implementation of the CFO estimation together with the\ntraining-pattern design could be relatively simple when users\ndo not experience the considerable frequency-selective fade.\nIn the highly frequency-selective fading scenario, an adaptive\ntraining-scheme is proposed to make the CFO estimator ro-\nbust. We also consider NUs operating in the frequency-division\nmultiple-access (FDMA) training mode. Due to the presence\nof inter-NU-interference, the estimation performance may be\nnot as good as in the TDMA training mode. The performance\ndegradation may be severe when RUs operate in the interleaved\nMC-CDMA. In this case, we propose an inter-NU-interference\nself-canceling training-pattern and use simulations to demonstrate\nits impact on the estimation performance.\nIndex Terms\u2014Carrier frequency offset (CFO), multicarrier\ncode-division multiple-access (MC-CDMA), singular-value de-\ncomposition (SVD), symbol timing offset, uplink.\nI. INTRODUCTION\nESTIMATION of carrier frequency offset (CFO) for mul-ticarrier (MC) systems has been intensively investigated\nin recent years. Most of CFO estimation approaches reported\nso far were proposed for the downlink (single-user equivalent\nscenario) (e.g., [1] and [2]). Applying MC technique in wireless\nnetworking or cellular radio calls for the CFO estimation for\nthe uplink (multi-user scenario), where each user has its own\nCFO. The pioneer research on the CFO estimation for the MC\nuplink might be conducted by van de Beek et al. (see [3]). Their\nwork focused on orthogonal frequency-division multiple-access\n(OFDMA) system. The major idea was to combine the cyclic\nprefix (CP)-based blind estimation approach (see [4]) with the\nManuscript received April 10, 2006; revised July 13, 2006. This work was\nsupported by the European Commission under IST 4More Project IST-2002-\n507039. The associate editor coordinating the review of this manuscript and\napproving it for publication was Dr. Erchin Serpedin.\nThe authors are with the Center for Communication Systems Research,\nUniversity of Surrey, Surrey GU2 7XH, U.K. (e-mail: y.ma@surrey.ac.uk;\nr.tafazolli@surrey.ac.uk).\nThe associate editor coordinating the review of this paper and approving it\nfor publication was Dr. Erchin Serpedin.\nDigital Object Identifier 10.1109\/TSP.2006.890883\nbandpass-filterbank-based user separation. Recently, a sub-\nspace-based blind approach was proposed for the interleaved\nOFDMA, which exploits the time-domain cyclo-stationarity\nof the signal structure (see [5]). Besides the blind approaches,\nthe training-based approaches are practically used in wireless\nsystems. The recent result on this aspect was reported by Morelli\nin [6] that also focused on the OFDMA uplink. It was assumed\nthat the active users in the network can be classified into refer-\nence (synchronized) users (RUs) and new (asynchronized) users\n(NUs).NUsdonot share thecommonOFDMblockat the training\nstage to avoid the inter-NU-interference. Since RUs do not inter-\nfere NUs in the frequency domain, the CFO estimation algorithm\nfor the single-user scenario (as in [1]) can be directly applied in\nthe NU subspace. To protect the assumption, the CFO, as well\nas the timing offset, must be compensated at the transmitter.\nThe question is, can we apply the existing approaches (up-\nlink) into the MC system that users use the linear precoding (or\ncalled code spreading) technique? A good summary of the MC\nsystem with the linear precoder (LP), so called generalized MC\nsystem, can be found in [7]. Early work on the MC-LP system\nwas documented in [8] and [9] that proposed several typical\nframeworks, namely MC-SS-MA, MC-DS-CDMA as well as\nMC-CDMA. Actually, MC-SS-MA is an upgraded version of\nthe OFDMA, where users do not share the common subcarriers.\nTherefore, the CFO estimation approaches for the OFDMA up-\nlink can be directly (or with minor modification) applied in the\nMC-SS-MA system. The others either spread the user data along\nthe time-direction (MC-DS-CDMA) or along the frequency-di-\nrection (MC-CDMA). Their common feature is that users share\nthe common subcarriers. In this case, the introduced blind or\ntraining-based approaches relying on the OFDMA structure are\nnot applicable.\nIn this paper, we propose a training-based CFO estimation ap-\nproach for the MC-CDMA uplink, where RUs\u2019 data are spread\nover all subcarriers. In the inter-NU-interference free case, the\ntraining sequences sent by NUs may occupy all subcarriers. At\nthe receiving end, the training sequences are superimposed onto\nthe RUs\u2019 data. It is assumed that the uplink receiver knows the\neffective RU signatures.1 Thanks to the precoding redundancy,\nwe can perform the singular-value decomposition (SVD) on\nthe RU signature matrices to find the desired subspace which\nis orthogonal to the RU subspace. Then, the CFO estimation\ncan be carried out in the desired subspace. The basic idea here\ncan be regarded as the generalization of Morelli\u2019s approach.\nHowever, the CFO identifiability needs to be carefully inves-\ntigated in the MC-CDMA system. We find that the implemen-\n1This is a reasonable assumption, since the effective RU signatures are needed\nfor the signal detection.\n1053-587X\/$25.00 \u00a9 2007 IEEE\nAuthorized licensed use limited to: University of Surrey. Downloaded on April 12,2010 at 08:56:57 UTC from IEEE Xplore.  Restrictions apply. \n2618 IEEE TRANSACTIONS ON SIGNAL PROCESSING, VOL. 55, NO. 6, JUNE 2007\nFig. 1. Block diagram of the MC-CDMA uplink.\ntation of the CFO estimation as well as the training-pattern de-\nsign could be relatively simple in the subband MC-CDMA. In\nthe highly frequency-selective scenario, such as the interleaved\nMC-CDMA, we propose an adaptive training scheme to make\nthe estimator robust. The mean-square error (MSE) bound as\nwell as Modified Cram\u00e9r\u2013Rao bound (MCRB) is given to ex-\namine the estimation performance. The final BER is examined\nvia simulations with the CFO compensation at the transmitting\nend. We also investigate the CFO estimation in the inter-NU-in-\nterference context, where NUs use FDMA to share the common\nOFDM block. It is observed that the estimation performance\nmay not be as good as in the inter-NU-interference free case. To\ncope with the inter-NU-interference, we borrow the idea from\n[10] and propose an interference self-canceling training pattern.\nThe inter-NU-interference canceling capability of the proposed\ntraining pattern is carefully investigated in the Gaussian channel\nwith the presence of timing offset. Computer simulations are\nused to show the improved estimation performance.\nThe rest of this paper is organized as follows. Section II\ngives the system model of MC-CDMA uplink. The CFO es-\ntimation in the inter-NU-interference free case is presented\nin Section III. Section IV considers the CFO estimation in\nthe presence of inter-NU-interference. Simulation results are\nprovided in Section V. Section VI draws the conclusion.\nII. MC-CDMA UPLINK SYSTEM\nA. MC-CDMA System\nWe consider a CP-OFDM system with subcarriers\nand accommodating a maximum of active users. As de-\npicted in Fig. 1, each user transmits the symbols\n( for user index), the output of the CDMA generator,\nover all subcarriers.2 Prior to transmission, the symbols\nare first grouped into blocks\n( for\ntranspose). These blocks are fed into the CP-OFDM modulator\nto produce\n(1)\n2An OFDM system usually employs some virtual carriers (see [2]). Here, we\nignore this technical point for convenience.\nwhere stands for block index, for subcarrier index, for\nsample index, and for the number of samples in CP. Then,\ngoes through the communication channel with the\nupper bound of channel order , and experiences the\nfrequency offset as well as the propagation delay . The\nreceived discrete-time equivalent signal is (see [6])\n(2)\nwhere is the signal from the th user\n(3)\nthe zero-mean Gaussian noise, the normalized version\nof , i.e., ( for sampling period), and\nthe integer part of timing offset ( the\ninteger floor). The fraction part of is incorporated\ninto (see [6] for reasons).\nWe assume, but only here, that all active users are well syn-\nchronized, i.e., , .\nThe receiver discards the CP part and performs the discrete\nFourier-transform (DFT) on\n, to obtain the frequency-domain version of the received\nsignal\n(4)\nwhere and the\nfrequency-domain version of the noise. We can see that the re-\nceived signal is the superposition of all active users. Symbol\ndetection on (4) needs the channel state information as well as\na proper design of .\nB. CDMA Generator and Subcarrier Mapping\nCDMA generator together with subcarrier (frequency)\nmapping strategy relates the information symbols\nto the blocks . We first consider that each active user\nonly transmits one information symbol over out of\nsubcarriers ( is an integer). The\nspreading code\nis drawn from the Walsh\u2013Hadamard matrix [11].\nUsers do not use identical spreading code. There are two typ-\nical subcarrier mapping methods. One is \u201csubband\u201d mapping\napproach that allocates the result on the subcarriers\n, , the\nother is \u201cinterleaved\u201d mapping approach that allocates\non the subcarriers . The later\none turns out to be the optimal mapping approach [12].\nWe can see the amount of subcarriers are divided into sub-\nsets. Each user can transmit symbols per block over these\nAuthorized licensed use limited to: University of Surrey. Downloaded on April 12,2010 at 08:56:57 UTC from IEEE Xplore.  Restrictions apply. \nMA AND TAFAZOLLI: ESTIMATION OF CARRIER FREQUENCY OFFSET FOR MULTICARRIER CDMA UPLINK 2619\nsubsets. The received signal in the th subset (for both subband\nand interleaved approaches) has the unified formula\n(5)\nwhere the subscript denotes the subset index, collects\nthe channel information for the th user in the th subset, i.e.,\nfor the subband approach, or\nfor the interleaved approach,\nthe corresponding noise, the diagonal matrix with\nin its diagonal. Let denote the effective\nuser signature, and define and\n. We can rewrite (5)\ninto the following matrix form:\n(6)\nWith the knowledge of , we can carry out the zero-forcing\n(ZF) equalization\n(7)\n(8)\nwhere denotes pseudo inverse. (8) holds only when has the\nfull column rank, i.e., is necessary. Next, we use (6)\nto formulate the received RUs signal, and investigate the CFO\nestimation for NUs.\nIII. CFO ESTIMATION WITHOUT INTER-NU-INTERFERENCE\nA. Training Scheme\nWe consider RUs already in the network. An NU\nwith the user index just enters the network and sends iden-\ntical training blocks for the CFO estimation. In this context, the\nreceived time-domain signal is the superposition of the RUs and\nthe NU signal\n(9)\nLet be the input to the OFDM demodulator,\nthe output is [13]\n(10)\n(11)\nwhere\n(12)\ndenotes the training symbols, the signal term, the\ninter-carrier interference (ICI). Then, the output of OFDM de-\nmodulator with the input is the superposition of (4)\nand (10)\n(13)\nThe received signal within the th subset is expressible as\n(14)\nHere, the size of is , and\nfor the subband MC-CDMA, or\nfor the interleaved MC-CDMA.\nOur objective is to estimate with the knowledge of\navailable at the receiver.\nB. CFO Estimation\nWe start from the SVD of [14]\n(15)\nwhere is the unitary matrix, the central matrix\non the right hand is diagonal, and the diagonal\nmatrix . Therefore, we have a matrix formed by\nthe last columns of , which fulfills\n(16)\nMultiplying with filters out the reference users\n(17)\nDefine vectors\n, and relate them into\n(18)\nGiven and , we can see the vector , for\n, is Gaussian and independent, with\nthe mean and covariance matrix\n( denotes the noise variance and\nAuthorized licensed use limited to: University of Surrey. Downloaded on April 12,2010 at 08:56:57 UTC from IEEE Xplore.  Restrictions apply. \n2620 IEEE TRANSACTIONS ON SIGNAL PROCESSING, VOL. 55, NO. 6, JUNE 2007\nthe identity matrix with the size ).\nThe maximum-likelihood estimate of is\n(19)\nwhere denotes the Frobenius norm. However, as men-\ntioned in [6], solving (19) needs the joint estimation of\nand may be impractical due to its high com-\nputation-complexity. The suboptimal solution is usually used\nto estimate , which is based on the correlation\n(20)\nwhere is the residual noise, and . Based on (20),\nthe best linear unbiased estimation of is given by [1], [6]\n(21)\nwhere stands for the angle,\n(22)\nGiven , and , the suboptimum estimator\nachieves the minimum MSE (MMSE) for (see [6]\nand [15])\n(23)\nThis bound has been computed considering that the received\nsignal power is , and the noise power is\n( for expectation). The estimation range is\nlimited to . The performance loss of the sub-\noptimum estimator can be observed by comparing (23) with the\nMCRB given by [16]\n(24)\nwhere .\nC. Training Pattern and CFO Identifiability\nSeen from (23), the CFO estimation performance depends\non . The optimal training pattern design is to maximize\nto achieve the MMSE. However, the optimality needs the\nknowledge of at the transmitter, that is impractical\nat the CFO estimation procedure. Here, we propose a simple\ntraining-pattern design, which targets on the CFO identifiability.\nConsider the vector as the following form:\n(25)\nwhere , and or is formed by col-\nlecting or [see (11)] in the th subset. We\nthen define\n, and express as\n(26)\nSince dominates the CFO estimation performance particu-\nlarly for the estimation of small CFO,3 our training-pattern de-\nsign is to assure the condition: C1) .\nOne possibility of breaking the condition C1) is ,\nfor . This case would happen only when\nall nonzero pilot symbols were corrupted by the channel zeros\n(deep fades). Since the communication channel (with the order\n) has at most channel zeros, we can avoid this case by em-\nploying at least nonzero pilot symbols in the training\nblock. However, this is not sufficient to guarantee the condi-\ntion C1), because the filtering matrix does not have the full\ncolumn rank, and is possible even when .\nTo solve this problem, we propose an adaptive training scheme\n(ATS) as follows.\n1) ATS: The proposed training scheme is based on two as-\nsumptions: A1) each subset within one training block has\nnonzero pilot symbols and A2)\nto combat the channel zeros. Then, we should have\n(27)\nwhere collects components in corresponding to\nnonzero pilot symbols, and collects the corresponding\ncolumn vectors in . Therefore, can be adaptively\nchanged according to the placement of nonzero pilot sym-\nbols. Since has the full row rank, i.e.,\n, we can always find an with the full\ncolumn rank. In this case, the condition C1) does hold for\n, which is protected\nby A2). Hence, we can use adaptive placement of nonzero\npilot symbols to guarantee the CFO identifiability. The pilot\nplacement information is the feedback from the uplink receiver.\nWe then consider the extreme case that . The\nassumptions A1) and A2) lead to\n(28)\nSince the system setup should be independent of the\nuser-loading condition, we have to use (28) to guarantee\nthe CFO identifiability for arbitrary case. Using the setup (28),\nbecomes a scalar denoted by , and becomes an\nvector denoted by . Then, the pilot place-\nment should guarantee . We are quite interested in the\n3In the small CFO case, the ICI term \u0016\f does not contribute considerably\nto the CFO estimation. Therefore, the robust training-pattern design should not\nrely on the contribution from the ICI.\nAuthorized licensed use limited to: University of Surrey. Downloaded on April 12,2010 at 08:56:57 UTC from IEEE Xplore.  Restrictions apply. \nMA AND TAFAZOLLI: ESTIMATION OF CARRIER FREQUENCY OFFSET FOR MULTICARRIER CDMA UPLINK 2621\nsmall CFO scenario that the ICI does not affect the estimation\nperformance considerably, i.e.,\n(29)\nEquation (29) achieves the maximum when is selected to\nhave the maximum norm among all column vectors in . This\nis the criterion to determine the placement of the nonzero pilot\nsymbol in each subset.\nBased on the previous discussion, we conclude that the pro-\nposed estimator can offer the robust CFO estimation by em-\nploying the ATS under the condition (28). On the other hand,\nthe ATS needs frequent feedback from the uplink receiver if\nthe RU channel as well as the user-loading condition is rapidly\nchanging.\n2) Nonadaptive Training Scheme: This training scheme is\nproposed only for the subband MC-CDMA. Consider an ex-\nample that the channel fades in the th subset (subband) are\nalmost identical (see [17]), i.e., . This would\nhappen if the channel is not considerably time dispersive (see\nexample in simulations). The effective RU signatures are ex-\npressible as\n(30)\nwhere , and\n. Since is part of the\nWalsh\u2013Hadamard matrix, we can form a filtering matrix\n, which fulfills\nand is independent of the subset index . We\ncan see that column vectors in have the identical norm\n. Then, is given by [follow (29)]\n(31)\nIf the nonzero pilot symbols have the identical power , and\nare placed over subcarriers with the equal spacing, then (31)\ncan be further expressed as\n(32)\nUnfortunately, (30) might not hold when the channel becomes\nmore time dispersive. However, the non-ATS may be still valid\nif is sufficiently large that the probability of is\nvery small.\nIV. CFO ESTIMATION WITH INTER-NU-INTERFERENCE\nThe system we considered so far, as depicted in Fig. 2(a),\ndoes not allow NUs to send the training blocks simultaneously.\nThis restriction effectively avoids the inter-NU-interference,\nand turns the multiuser scenario into the single-user equivalent\nscenario while the RUs are filtered out. In this section, we\nFig. 2. Training pattern for MC-CDMA uplink. (a) Example for inter-NU-in-\nterference free case. (b) Example with inter-NU-interference.\nconsider the system that several NUs are allowed to send\ntraining blocks simultaneously in the FDMA fashion [see an\nexample in Fig. 2(b)]. The frequency band is divided into\nNU areas denoted by . Each NU area only\naccommodates one NU.\nA. System Model\nWe consider the system accommodating RUs as well as\nNUs . The received time domain signal is\nexpressible as\n(33)\nAs in Section III, we feed into the OFDM demodulator\nand obtain\n(34)\nAuthorized licensed use limited to: University of Surrey. Downloaded on April 12,2010 at 08:56:57 UTC from IEEE Xplore.  Restrictions apply. \n2622 IEEE TRANSACTIONS ON SIGNAL PROCESSING, VOL. 55, NO. 6, JUNE 2007\nWe only consider the received signal within the desired NU area\n(denoted by )\n(35)\nwhere is the inter-NU-interference term\n(36)\nIt is observed that the inter-NU-interference may help the CFO\nestimation when NUs have the identical CFO. On the other\nhand, we usually need to cope with distinct CFOs that the\ninter-NU-interference degrades the estimation performance\nconsiderably. The blind approach proposed in [5] supports\ndistinct CFOs indeed but only for the interleaved OFDMA. We\nalso notice that very few training-based approaches have been\nreported so far in this regard. This motivates us to investigate\nthe inter-NU-interference cancellation in the training-based\nCFO estimation.\nB. Interference-Canceling Training Scheme\nThe inter-NU-interference cancellation relies on the training-\npattern design. It is based on the assumptions: A3) subcarriers\nwithin each NU area are grouped into clusters, and each\ncluster consists of two adjacent subcarriers and A4) channel\nfades within each cluster are close. The training symbols within\nthe th cluster of the th NU obeys the following criterion:\n(37)\nWe apply A3) and A4) as well as (37) in (36) and obtain\n(38)\nwhere\n(39)\nThe idea of using (37) for interference cancellation is not new.\nIt is first proposed by Zhao and Haggman (see [10]) for the ICI\nself-canceling data-transmission in AWGN downlink channel.\nOne of their major results is\n(40)\nHere, we borrow the idea for the training-pattern design.\nTo see the inter-NU-interference canceling capability of\nthe training pattern (37), we need to setup a baseline, i.e.,4\ntraining symbol is pseudo random and statistically indepen-\ndent with zero mean and the constant amplitude . Then,\n4The pseudo-random training pattern is employed in many practical systems.\nThe receiver knows the training sequence and can easily make the training se-\nquences to be identical by adjusting the phase.\nthe inter-NU-interference power on the th subcarrier can be\ncomputed from (36)\n(41)\n(42)\nEquation (42) is based on the assumption A4) and\n(see [10]). Using the training pattern (37), the\ntraining symbols within each cluster are fully correlated, but\nuncorrelated for different clusters. Then, we can compute the\ninter-NU-interference for (38)\n(43)\nAssume NUs do not suffer timing offset, i.e., for\n. We have and\ncan use (40) to obtain the ratio\n(44)\nThe proposed training pattern shows the strong inter-NU-inter-\nference canceling capability. In the presence of timing offset,\nwe consider as follows:\n(45)\n(46)\n(47)\nIt is observed that is an even function and monotonically\nincreasing for . Define a timing offset fulfilling\n, (43) is upper bounded by\n(48)\nThen, the ratio (43)\/(42) is upper bounded by\n(49)\nWe study an example and use (49) to obtain\n(50)\nComparing (50) with (44), we can see the interference canceling\ncapability of the proposed training pattern is sensitive to the\ntiming offset. But, the performance is still acceptable for small\ntiming offset.\nAuthorized licensed use limited to: University of Surrey. Downloaded on April 12,2010 at 08:56:57 UTC from IEEE Xplore.  Restrictions apply. \nMA AND TAFAZOLLI: ESTIMATION OF CARRIER FREQUENCY OFFSET FOR MULTICARRIER CDMA UPLINK 2623\nC. Training-Pattern Design and CFO Estimation\nWe study the training-pattern design for the interleaved\nMC-CDMA and the subband MC-CDMA respectively, because\nit is difficult to offer an unified design for both systems.\n1) Interleaved MC-CDMA: We assume to be even5 and\ngive the following training-pattern design.\nD1) Each subset is shared by all NUs.\nD2) The th NU only has one nonzero pilot symbol within\nthe th subset (denoted by ). is placed on\nthe position corresponding to the th element\nin .\nD3) .\n2) Subband MC-CDMA: We give the training-pattern design\nas follows.\nD4) Each subset accommodates up to\nNUs ( for integer ceiling).\nD5) Each NU occupies subsets, and has\nnonzero pilot symbols within each subset.\nD6) The two nonzero pilot symbols are placed on the po-\nsition corresponding to the th and th\nelements in and fulfill the relationship (37).\nIt is easy to see that the previous designs meet the assumption\nA3) and (37), and thus, has the inter-NU-interference canceling\ncapability.\n3) CFO Estimation: Although the training-pattern design for\nthe MC-CDMA systems is different, the CFO estimation al-\ngorithms are almost identical. We consider the received signal\nwithin the th subset, which accommodates NUs (\nfor the interleaved MC-CDMA)\n(51)\nwhere denotes the inter-NU-interference within\nthe th subset, and\n. Then, we use to filter out the\nRUs and obtain\n(52)\nFor the interleaved MC-CDMA, the training-pattern design D2)\nleads to\n(53)\nwhere is the diagonal matrix formed by the first\nrows of , and the matrix formed by\nthe first columns of . Assuming A5) has full-column\nrank, we multiply with (52) and obtain\n(54)\n5If Q is odd, then we use Q \u0000 1 subsets.\nThen, the CFO estimation for NUs can be carried out indi-\nvidually by employing the CFO estimator developed for the\ninter-NU-interference free case. For the subband MC-CDMA,\nwe can use D6) to find the relationship (53). But, here, is a\nmatrix. Under the assumption A5), (54) is still valid\nfor the subband MC-CDMA.\nWe can see that the CFO identifiability needs the assumption\nA5). However, the ATS is not applicable here to protect this\nassumption. Therefore, we expect to be sufficiently large so\nthat we could have at least one valid subset.\nV. SIMULATIONS AND DISCUSSIONS\nComputer simulations used MSE, , to evaluate the\nproposed CFO estimation approach, and bit-error-rate (BER) to\nexamine the impact on the overall system performance. The re-\nsults were obtained by averaging over 500 independently gen-\nerated multiuser channels with the maximum delay of 2.51 s,\nwhich comply with the 3GPP Vehicular A model specified by\n[18]. The near-far effect ([19]) was assumed to be well com-\npensated via power control at the user end. The signal-to-noise\nratio (SNR) was defined by the average received signal energy to\nnoise. The setup of MC-CDMA system was given by:\nsubcarriers, and each CP has samples\n. The user signatures were drawn from the\nWalsh\u2013Hadamard matrix, i.e., and . The infor-\nmation-bearing symbols were drawn from the QPSK constella-\ntion with the equal probability. The timing offset for each NU\nwere randomly generated according to the uniform distribution\nwith . Throughout the simulations, each NU\nsent training blocks for the CFO estimation. We divide\nthe simulations into the following four concrete experiments.\nExperiment 1 (Subband MC-CDMA, Inter-NU-Interference\nFree): The objective of this experiment is to evaluate the pro-\nposed CFO estimation approach together with the training-pat-\ntern design in the subband MC-CDMA system that only one NU\nis allowed to enter the network. The OFDM block duration (ex-\nclusive CP) is set to be 80 or 40 s. The normalized CFO is con-\nsidered (the small-CFO case) or (the\nlarge-CFO case). There are three RUs already in the network.\nTo show the significance of the training-pattern design, we also\ninvestigate the estimation performance that the pilot power is\nuniformly allocated over all subcarriers (called uniform pilot\nplacement (UPP) for convenience).\nWe first study the estimation performance for the OFDM\nblock duration of 80 s that each subset does not experience\nthe considerably frequency-selective fade. The MSE results for\nare illustrated in Fig. 3. It is observed that the\nUPP training-pattern does not offer the successful CFO estima-\ntion. This is because the improperly designed training-pattern,\ne.g., UPP, cannot guarantee the CFO identifiability and offer\nthe robust CFO estimation. The same result is obtained in other\nsimulations in the subband MC-CDMA system. When the\nproposed training patterns (ATS and non-ATS) are employed,\nFig. 3 shows that the MSE bounds for both training patterns are\nalmost identical. The simulation results converge to the MSE\nbounds in the high-SNR range (e.g., dB). The non-ATS\nshows faster convergence than the ATS, and thus, offers better\nestimation performance in the medium-SNR range. We also\nAuthorized licensed use limited to: University of Surrey. Downloaded on April 12,2010 at 08:56:57 UTC from IEEE Xplore.  Restrictions apply. \n2624 IEEE TRANSACTIONS ON SIGNAL PROCESSING, VOL. 55, NO. 6, JUNE 2007\nFig. 3. MSE versus SNR in inter-NU-interference free case, subband\nMC-CDMA, \u0017 = \u00000:01.\nFig. 4. MSE versus SNR in inter-NU-interference free case, subband\nMC-CDMA, \u0017 = 0:2.\nplot the results for in Fig. 4. It is shown that the\nnon-ATS outperforms the ATS in both the estimation perfor-\nmance and the convergence. It means that the ICI power shows\nthe positive impact on the CFO identifiability.\nWe then shorten the OFDM block duration to 40 s (equiva-\nlent to double the subcarrier spacing). The channel within each\nsubset becomes more frequency selective. The MSE results are\nplotted in Figs. 5 and 6 regarding the different CFO setup. For\nthe case of (see Fig. 5), the ATS slightly im-\nproves the estimation performance in comparison to the non-\nATS. However, the non-ATS outperforms the ATS for the case\nof . It is also observed that both training schemes\nhave the close convergence-rate to the MSE bounds.\nAs a summary, we have shown that both ATS and non-ATS\nmay offer the robust CFO estimation in the sub-band\nMC-CDMA. On the other hand, the ATS is preferred here\ndue to its avoiding the feedback as well as the relatively fast\nconvergence to the MSE bound.\nFig. 5. MSE versus SNR in inter-NU-interference free case, subband\nMC-CDMA, \u0017 = \u00000:01.\nFig. 6. MSE versus SNR in inter-NU-interference free case, subband\nMC-CDMA, \u0017 = 0:2.\nExperiment 2 (Interleaved MC-CDMA, Inter-NU-Interfer-\nence Free): In this experiment, the RUs use the interleaved\nMC-CDMA as the air-interface. As mentioned in Sections II\nand III, each subset experiences the severe frequency-selective\nfade. Starting from this experiment, the OFDM block dura-\ntion is fixed to 40 s. Other parameters are the same as in\nExperiment 1. We first examine the estimation performance\nfor , and plot the MSE results in Fig. 7. It is\ninteresting to see that the UPP works, but shows the worst\nperformance (around 4 dB loss to the non-ATS and 12 dB\nloss to the ATS). The MSE bounds together with the simula-\ntion results show that the ATS can significantly improve the\nestimation performance in comparison to the non-ATS (6 dB\nimprovement in the MSE bound). The ATS converges to the\nMSE bound for SNR 16 dB. The non-ATS does not offer the\nclose performance to the MSE bound even for SNR 24 dB.\nWe then consider the case of and plot the results in\nFig. 8. It is observed from the MSE bounds that the difference\nAuthorized licensed use limited to: University of Surrey. Downloaded on April 12,2010 at 08:56:57 UTC from IEEE Xplore.  Restrictions apply. \nMA AND TAFAZOLLI: ESTIMATION OF CARRIER FREQUENCY OFFSET FOR MULTICARRIER CDMA UPLINK 2625\nFig. 7. MSE versus SNR in inter-NU-interference free case, interleaved\nMC-CDMA, \u0017 = \u00000:01.\nFig. 8. MSE versus SNR in inter-NU-interference free case, interleaved\nMC-CDMA, large CFO.\nbetween ATS and non-ATS is reduced to 4 dB. The non-ATS\nconverges to its MSE bound for SNR 21 dB. In order to ob-\nserve whether the difference can be further reduced with the in-\ncrease of CFO, we also plot the MSE bounds for .\nIt can be seen that the reduction of the difference is small (\n1 dB).\nWe summarize that the non-ATS does not offer the robust\nCFO estimation in the interleaved MC-CDMA particularly for\nthe small-CFO case. The ATS approach is much suitable here\nfor its considerable MSE gain.\nExperiment 3 (Final Ber Performance): The objective of this\nexperiment is to examine the final BER performance with the\nCFO and timing-offset compensation at the transmitter. It might\nbe interesting to see in the interleaved MC-CDMA whether\nthe MSE gain obtained from the ATS approach considerably\nimproves the final BER performance. We consider there are\nthree active-users in the network with the normalized CFOs\nof , and , respectively. The uplink receiver has\nFig. 9. Final BER versus SNR in inter-NU-interference free case, subband\nMC-CDMA.\nFig. 10. Final BER versus SNR in inter-NU-interference free case, interleaved\nMC-CDMA.\nthe perfect channel knowledge and employs the ZF equalizer\n(7) for the multi-user channel equalization. Each user has the\nperfect knowledge of the timing offset. The CFO knowledge\nat the user-end is the CFO estimate fed back by the uplink\nreceiver. The baseline for the performance comparison is the\ncase of null CFO. It is observed that the BER performance for\nthe three users is almost identical. Therefore, we only plot the\nsimulation results for the user with as an example.\nFig. 9 illustrates the final BER in the subband MC-CDMA\nsystem. We can see that both ATS and non-ATS offer almost\nidentical BER. Their performance converges to the baseline for\ndB. The non-ATS shows slightly BER improve-\nment for SNR 12 dB. Therefore, in the viewpoint of BER,\nwe also suggest to use the non-ATS approach in the subband\nMC-CDMA.\nFig. 10 illustrates the final BER in the interleaved\nMC-CDMA system. It shows that the ATS outperforms\nthe non-ATS. The performance improvement is around 2 dB\nAuthorized licensed use limited to: University of Surrey. Downloaded on April 12,2010 at 08:56:57 UTC from IEEE Xplore.  Restrictions apply. \n2626 IEEE TRANSACTIONS ON SIGNAL PROCESSING, VOL. 55, NO. 6, JUNE 2007\nFig. 11. MSE versus SNR in inter-NU-interference case, subband MC-CDMA.\nfor the typical SNR ( 12 dB). The ATS offers the almost\nidentical performance to the baseline for SNR 14 dB. On the\nother hand, the non-ATS offers the comparable performance to\nthe ATS as well as the baseline for SNR 18 dB. Therefore,\nthe non-ATS may be the suitable approach in the high-SNR\nscenario for its avoiding the frequent feedback.\nExperiment 4 (Inter-NU-Interference Scenario): The\nobjective of this experiment is to examine the proposed\ninter-NU-interference canceling training pattern. We consider\nthe simulation example that two RUs already in the network.\nTwo NUs send the training blocks simultaneously for the CFO\nestimation. We only consider the CFO estimation for the de-\nsired NU whose normalized CFO is set to be 0.2. The other NU\nis considered the interfering NU whose normalized CFO is ran-\ndomly generated according to the uniform distribution within\nthe range of . We also consider two baselines\nfor the performance comparison. The first baseline is based\non the pseudo-random training pattern. The second baseline\nalso uses the pseudo-random training pattern, but the CFO for\nthe interfering NU is zero. Therefore, the second baseline is\nactually the single-NU case.\nFig. 11 illustrates the MSE results in the subband MC-CDMA\nsystem. We can see that the pseudo-random training pattern\nshows the worst performance. An error-floor is observed for\nSNR 12 dB. The performance loss in comparison to the MSE\nbound is up to 14 dB. It means that the inter-NU-interference\nseverely affects the CFO estimation. We can also see that the\nproposed training pattern offers very close performance to\nthe single-NU case. The performance loss in comparison to\nthe MSE bound is up to 1 dB (in the high-SNR range). The\nconsiderable MSE gain is due to the inter-NU-interference\ncanceling capability of the proposed training pattern.\nFig. 12 illustrates the MSE results in the interleaved\nMC-CDMA system. Again, the pseudo-random training pattern\nshows the worst performance (or does not offer the successful\nCFO estimation). The proposed training pattern offers the com-\nparable performance to the single-NU case for SNR 14 dB.\nHowever, an error floor is observed in the high-SNR range.\nFig. 12. MSE versus SNR in inter-NU-interference case, interleaved\nMC-CDMA.\nVI. CONCLUSION\nIn this paper, we have presented a novel training-based CFO\nestimation method for the MC-CDMA uplink. The proposed\napproach exploited the SVD to find the desired subspace\nthat was orthogonal to the RU subspace. The optimum or\nsuboptimum CFO estimation algorithm could be applied in\nthe desired subspace. We have investigated the proposed ap-\nproach both in the subband and the interleaved MC-CDMA\nsystems, and shown that the CFO identifiability need the proper\ntraining-pattern (or training scheme) design. Then, both ATS\nand non-ATS training schemes were proposed and carefully\ninvestigated via both theoretical and simulation analysis. It\nhas been shown that the non-ATS is suitable for the subband\nMC-CDMA system or the interleaved MC-CDMA system in\nthe high-SNR scenario. The ATS is suitable for the interleaved\nMC-CDMA in the small and medium-SNR range.\nWe also investigated the proposed CFO estimation approach\nin the inter-NU-interference scenario. It has been shown that\nthe inter-NU-interference severely affected the CFO esti-\nmation. Therefore, we proposed the inter-NU-interference\nself-canceling training pattern and investigated its interference\ncanceling capability in the Gaussian channel. Simulation results\nhave shown that, in the subband MC-CDMA, the proposed\ntraining pattern could offer the comparable performance to the\nsingle-NU case. In the interleaved MC-CDMA, it demonstrated\nthe comparable performance to the single-NU case in the small\nand medium-SNR range.\nACKNOWLEDGMENT\nThe authors would like to thank the Associate Editor,\nProf. E. Serpedin, and the reviewers for the efficient review\nprocess and constructive comments.\nREFERENCES\n[1] U. Mengali and M. Morelli, \u201cData-aided frequency estimation for burst\ndigital transmission,\u201d IEEE Trans. Commun., vol. 45, no. 1, pp. 23\u201325,\nJan. 1997.\nAuthorized licensed use limited to: University of Surrey. Downloaded on April 12,2010 at 08:56:57 UTC from IEEE Xplore.  Restrictions apply. \nMA AND TAFAZOLLI: ESTIMATION OF CARRIER FREQUENCY OFFSET FOR MULTICARRIER CDMA UPLINK 2627\n[2] X. Ma, C. Tepedelenlioglu, and G. B. Giannakis, \u201cNon-data-aided car-\nrier offset estimator for OFDM with null subcarriers: Identifiability, al-\ngorithms, and performance,\u201d IEEE J. Select. Areas Commun., vol. 19,\nno. 12, pp. 2504\u20132515, Dec. 2001.\n[3] J. J. van de Beek, \u201cA time and frequency synchronization scheme for\nmultiuser OFDM,\u201d IEEE J. Select. Areas Commun., vol. 17, no. 11, pp.\n1900\u20131914, Nov. 1999.\n[4] J. J. van de Beek, M. Sandell, and P. O. Borjesson, \u201cML estimation of\ntiming and frequency offset in OFDM systems,\u201d IEEE Trans. Signal\nProcess., vol. 45, no. 7, pp. 1800\u20131805, Jul. 1997.\n[5] Z. Cao, U. Tureli, and Y. Yao, \u201cDeterministic multiuser carrier fre-\nquency offset estimation for interleaved OFDMA uplink,\u201d IEEE Trans.\nCommun., vol. 52, no. 9, pp. 1585\u20131594, Sep. 2004.\n[6] M. Morelli, \u201cTiming and frequency synchronization for uplink of an\nOFDMA system,\u201d IEEE Trans. Commun., vol. 52, no. 2, pp. 296\u2013306,\nFeb. 2004.\n[7] Z. Wang and G. B. Giannakis, \u201cWireless multicarrier communications:\nWhere Fourier meets Shannon,\u201d IEEE Signal Process. Mag., vol. 17,\nno. 3, pp. 29\u201348, May 2000.\n[8] S. Kaiser and K. Fazael, \u201cA flexible spread-spectrum multi-carrier\nmultiple-access system for multi-media applications,\u201d in Proc. IEEE\nPIMRC, 1997, pp. 100\u2013104.\n[9] S. Hara and R. Prasad, \u201cOverview of multicarrier CDMA,\u201d IEEE\nCommun. Mag., vol. 35, no. 12, pp. 126\u2013133, Dec. 1997.\n[10] Y. Zhao and S. G. Haggman, \u201cIntercarrier interference self-cancella-\ntion scheme for OFDM mobile communication systems,\u201d IEEE Trans.\nCommun., vol. 49, no. 7, pp. 1185\u20131191, Jul. 2001.\n[11] J. Proakis, Digital Communications, 4th ed. New York: McGraw-\nHill, 2001.\n[12] X. Cai, S. Zhou, and G. B. Giannakis, \u201cGroup-orthogonal multicarrier\nCDMA,\u201d IEEE Trans. Commun., vol. 52, no. 1, pp. 90\u201399, Jan. 2004.\n[13] T. Pollet, M. V. Bladel, and M. Moeneclaey, \u201cBER sensitivity of\nOFDM systems to carrier frequency offset and Wiener phase noise,\u201d\nIEEE Trans. Commun., vol. 43, no. 2, pp. 191\u2013193, Feb. 1995.\n[14] G. H. Golub and C. F. Van Loan, Matrix Computations, 3rd ed.\nLondon, U.K.: Johns Hopkins Univ. Press, 1996.\n[15] M. Morelli, \u201cAn improved frequency offset estimator for OFDM ap-\nplication,\u201d IEEE Commun. Lett., vol. 3, no. 3, pp. 75\u201377, Mar. 1999.\n[16] A. N. D\u2019Andrea, U. Mengali, and R. Reggiannini, \u201cThe modified\nCram\u00e9r-Rao bound and its application to synchronization problems,\u201d\nIEEE Trans. Commun., vol. 42, no. 2, pp. 1391\u20131399, Feb.\/Apr. 1994.\n[17] X. Gui and T. S. Ng, \u201cPerformance of asynchronous orthogonal mul-\nticarrier CDMA system in frequency selective fading channel,\u201d IEEE\nTrans. Commun., vol. 47, no. 7, pp. 1084\u20131091, Jul. 1999.\n[18] 3rd Generation Partnership Project; Technical Specification Group\nRadio Access Network; Spatial Channel Model for Multiple Input\nMultiple Output (MIMO) Simulations (Release 6), 3GPP TR 25.996\nv6.1.0, Sep. 2003.\n[19] T. S. Rappaport, Wireless Communications: Principles and Practice.\nEnglewood Cliffs, NJ: Prentice-Hall, 1996.\nYi Ma (M\u201904) is currently a Postdoctoral Research\nFellow at the Centre for Communication Systems\nResearch (CCSR), the University of Surrey, Surrey,\nU.K. His research interests include statistical signal\nprocessing, modulation, estimation, detection and\nsynchronization theory in wireless communications,\nnetwork information theory, and random matrix\ntheory.\nRahim Tafazolli is a Professor of Mobile\/Personal\ncommunication and Head of Mobile Communica-\ntions Research Group and is also the Director of\nResearch in the School of EEITM, the University of\nSurrey, Surrey, U.K. He has been active in research\nfor 20 years and has authored and co-authored more\nthan 300 papers in referred international journals\nand conferences. He has been consultant to many\nmobile companies, lectured and chaired a number\nof IEE Summer schools and IEEE workshops and\nconferences. He has carried out many consultancies\nfor mobile companies, Home Office, and European Union all in the field of\nmobile communications. He is the Founder and Chairman of IEE International\nConference on Third Generation Mobile Communications.\nAuthorized licensed use limited to: University of Surrey. Downloaded on April 12,2010 at 08:56:57 UTC from IEEE Xplore.  Restrictions apply. \n"}