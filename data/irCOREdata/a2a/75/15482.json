{"doi":"10.1109\/TPWRS.2009.2037506","coreId":"15482","oai":"oai:dro.dur.ac.uk.OAI2:7150","identifiers":["oai:dro.dur.ac.uk.OAI2:7150","10.1109\/TPWRS.2009.2037506"],"title":"Electricity tracing in systems with and without circulating flows : physical insights and mathematical proofs.","authors":["Achayuthakan,  C.","Dent,  C. J.","Bialek,  J. W.","Ongsakul,  W."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2010-05-01","abstract":"This paper provides new insights into the electricity tracing methodology, by representing the inverted tracing upstream and downstream distribution matrices in the form of matrix power series and by applying linear algebra analysis. The n th matrix power represents the contribution of each node to power flows in the other nodes through paths of length exactly n in the digraph of flows. Such a representation proves the link between graph-based and linear equation-based approaches for electricity tracing. It also makes it possible to explain an earlier observation that circulating flows, which result in a cyclic directed graph of flows, can be detected by appearance of elements greater than one on the leading diagonal of the inverted tracing distribution matrices. Most importantly, for the first time a rigorous mathematical proof of the invertibility of the tracing distribution matrices is given, along with a proof of convergence for the matrix power series used in the paper; these proofs also allow an analysis of the conditioning of the tracing distribution matrices. Theoretical results are illustrated throughout using simple network examples","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/15482.pdf","fullTextIdentifier":"http:\/\/dro.dur.ac.uk\/7150\/1\/7150.pdf","pdfHashValue":"cef89585574f2b34913aed902db472b719efc041","publisher":"IEEE","rawRecordXml":"<record><header><identifier>\n  \n    \n      oai:dro.dur.ac.uk.OAI2:7150<\/identifier><datestamp>\n      2010-09-13T13:44:42Z<\/datestamp><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        Electricity tracing in systems with and without circulating flows : physical insights and mathematical proofs.<\/dc:title><dc:creator>\n        Achayuthakan,  C.  <\/dc:creator><dc:creator>\n        Dent,  C. J.  <\/dc:creator><dc:creator>\n        Bialek,  J. W.  <\/dc:creator><dc:creator>\n        Ongsakul,  W. <\/dc:creator><dc:description>\n        This paper provides new insights into the electricity tracing methodology, by representing the inverted tracing upstream and downstream distribution matrices in the form of matrix power series and by applying linear algebra analysis. The n th matrix power represents the contribution of each node to power flows in the other nodes through paths of length exactly n in the digraph of flows. Such a representation proves the link between graph-based and linear equation-based approaches for electricity tracing. It also makes it possible to explain an earlier observation that circulating flows, which result in a cyclic directed graph of flows, can be detected by appearance of elements greater than one on the leading diagonal of the inverted tracing distribution matrices. Most importantly, for the first time a rigorous mathematical proof of the invertibility of the tracing distribution matrices is given, along with a proof of convergence for the matrix power series used in the paper; these proofs also allow an analysis of the conditioning of the tracing distribution matrices. Theoretical results are illustrated throughout using simple network examples.<\/dc:description><dc:subject>\n        Power system economics<\/dc:subject><dc:subject>\n         Power transmission economics.<\/dc:subject><dc:publisher>\n        IEEE<\/dc:publisher><dc:source>\n        IEEE transactions on power systems. , 2010, Vol.25(2), pp.1078-1087 [Peer Reviewed Journal]<\/dc:source><dc:date>\n        2010-05-01<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:identifier>\n        dro:7150<\/dc:identifier><dc:identifier>\n        issn:0885-8950<\/dc:identifier><dc:identifier>\n        doi:10.1109\/TPWRS.2009.2037506 <\/dc:identifier><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/7150\/<\/dc:identifier><dc:identifier>\n        http:\/\/dx.doi.org\/10.1109\/TPWRS.2009.2037506   <\/dc:identifier><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/7150\/1\/7150.pdf<\/dc:identifier><dc:rights>\n        \u00a92010 IEEE. Personal use of this material is permitted. However, permission to reprint\/republish this material for advertising or promotional purposes or for creating new collective works for resale or redistribution to servers or lists, or to reuse any copyrighted component of this work in other works must be obtained from the IEEE.<\/dc:rights><dc:accessRights>\n        info:en-repo\/semantics\/openAccess<\/dc:accessRights><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["0885-8950","issn:0885-8950"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2010,"topics":["Power system economics","Power transmission economics."],"subject":["Article","PeerReviewed"],"fullText":"Durham Research Online\nDeposited in DRO:\n13 September 2010\nVersion of attached file:\nPublished Version\nPeer-review status of attached file:\nPeer-reviewed\nCitation for published item:\nAchayuthakan, C. and Dent, C. J. and Bialek, J. W. and Ongsakul, W. (2010) \u2019Electricity tracing in systems\nwith and without circulating flows : physical insights and mathematical proofs.\u2019, IEEE transactions on power\nsystems., 25 (2). pp. 1078-1087.\nFurther information on publisher\u2019s website:\nhttp:\/\/dx.doi.org\/10.1109\/TPWRS.2009.2037506\nPublisher\u2019s copyright statement:\n2010 IEEE. Personal use of this material is permitted. However, permission to reprint\/republish this material for\nadvertising or promotional purposes or for creating new collective works for resale or redistribution to servers or lists,\nor to reuse any copyrighted component of this work in other works must be obtained from the IEEE.\nAdditional information:\nUse policy\nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without prior permission or charge, for\npersonal research or study, educational, or not-for-profit purposes provided that:\n\u2022 a full bibliographic reference is made to the original source\n\u2022 a link is made to the metadata record in DRO\n\u2022 the full-text is not changed in any way\nThe full-text must not be sold in any format or medium without the formal permission of the copyright holders.\nPlease consult the full DRO policy for further details.\nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom\nTel : +44 (0)191 334 3042 \u2014 Fax : +44 (0)191 334 2971\nhttp:\/\/dro.dur.ac.uk\n1078 IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 25, NO. 2, MAY 2010\nElectricity Tracing in Systems With and\nWithout Circulating Flows: Physical Insights\nand Mathematical Proofs\nChira Achayuthakan, Chris J. Dent, Member, IEEE, Janusz W. Bialek, Senior Member, IEEE, and\nWeerakorn Ongsakul, Member, IEEE\nAbstract\u2014This paper provides new insights into the electricity\ntracing methodology, by representing the inverted tracing up-\nstream and downstream distribution matrices in the form of\nmatrix power series and by applying linear algebra analysis. The\nth matrix power represents the contribution of each node to\npower flows in the other nodes through paths of length exactly\nin the digraph of flows. Such a representation proves the link\nbetween graph-based and linear equation-based approaches for\nelectricity tracing. It also makes it possible to explain an earlier\nobservation that circulating flows, which result in a cyclic directed\ngraph of flows, can be detected by appearance of elements greater\nthan one on the leading diagonal of the inverted tracing distri-\nbution matrices. Most importantly, for the first time a rigorous\nmathematical proof of the invertibility of the tracing distribution\nmatrices is given, along with a proof of convergence for the matrix\npower series used in the paper; these proofs also allow an analysis\nof the conditioning of the tracing distribution matrices. Theo-\nretical results are illustrated throughout using simple network\nexamples.\nIndex Terms\u2014Power system economics, power transmission\neconomics.\nI. INTRODUCTION\nE VER since electricity supply systems throughout theworld started to be liberalized in the early 1990s, trans-\nmission pricing has proved to be a contentious issue. The main\nreason for this is that a proper transmission pricing regime\nshould satisfy a number of requirements which are in tension\n[1]. Two main apparently conflicting requirements are that\ncompetition should be promoted by presenting the network\nuser with a predictable, stable and practically applicable frame-\nwork of charges, and that transmission prices should provide\nsignals toward the efficient use, operation and expansion of the\nnetwork. Many transmission pricing methodologies have been\nproposed in the literature, with each of them putting a different\nemphasis on one or other of the requirements.\nManuscript received April 15, 2009; revised July 08, 2009, September 16,\n2009. First published February 22, 2010; current version published April 21,\n2010. This work was supported in part by the Queen Sirikit HRD Project, En-\nergy Policy and Planning Office (EPPO), Ministry of Energy, Thailand. The\nwork of C. J. Dent was supported through the EPSRC Supergen V, UK Energy\nInfrastructure (AMPerES) grant in collaboration with UK electricity network\noperators working under Ofgem\u2019s Innovation Funding Incentive scheme\u2014full\ndetails on http:\/\/www.supergen-amperes.org\/. Paper no. TPWRS-00273-2009.\nC. Achayuthakan and W. Ongsakul are with Energy Field of Study,\nAsian Institute of Technology (AIT), Pathumthani 12120, Thailand (e-mail:\nst104252@ait.ac.th; Ongsakul@ait.ac.th).\nJ. W. Bialek and C. J. Dent are with the School of Engineering and Com-\nputing Sciences, Durham University, Durham DH1 2PE, U.K. (e-mail: Janusz.\nBialek@durham.ac.uk; chris.dent@durham.ac.uk)\nDigital Object Identifier 10.1109\/TPWRS.2009.2037506\nOne of the more popular approaches to transmission pricing\nis based on application of the tracing methodology [2]. Tracing\nis a simple and transparent methodology that attempts to trace\nthe flow of electricity in the network from individual generators\nto individual loads by following the directed graph (digraph) of\nflows, assuming that at any node the inflows are proportionally\ndistributed among the outflows. The proportionality assumption\nis intuitively reasonable yet it cannot be proved. However, it can\nbe rationalized using cooperative game theory and information\ntheory, by showing that the proportionality assumption results\nin the optimal cost allocation regardless of the form of the cost\nfunction [3]. Electricity tracing is used in the Northeast China\npower system [4] and it is being considered as a candidate for\nInter-TSO Compensation in Europe [5]. Electricity tracing tends\nto result in lower price differentials than marginal pricing, and\nhence it might be more easily accepted in countries with power\nindustries in a transitional phase [6]. It should be noted that first\nattempts to develop a tracing methodology were undertaken by\nthe New Zealand utility TransPower in the late 1980s; however,\nno publications are publicly available.\nTwo main approaches to electricity tracing have been pro-\nposed in the past: an approach based on the solution of simul-\ntaneous linear equations [2], [7], and a graph-based approach\nwhich results in an iterative algorithm [8], [9]. The linear equa-\ntions-based algorithm is able to calculate contributions of all in-\ndividual nodes even in the presence of circulating flows which\ncreate cycles in the digraph of flows. On the other hand the\ngraph-based algorithm is not able to differentiate between the\ncontributions of any node in the cycle [10]. Other variations of\nthe tracing methodology have also been proposed, e.g., [11] or\n[6], where generalized tracing was formulated as a linear con-\nstrained multi-commodity network flow optimization problem.\nIn this paper the inverted upstream and downstream tracing\ndistribution matrices, originally derived in [2], are represented\nin the form of matrix power series. This allows us to make three\nimportant contributions. Firstly, it provides an additional insight\ninto the tracing methodology, by explaining the link between the\nlinear equation-based and graph-based approaches to tracing.\nThe th matrix power represents the contribution of each node\nto power flows in the other nodes through paths of length exactly\n, i.e., through intermediate nodes in the digraph of flows,\nhence making explicit the link between the two main approaches\nto tracing. Secondly, the matrix power series formulation allows\nus to explain an earlier observation [12] that circulating flows,\nwhich cause cycles in the digraph of flows, can be detected by\nthe appearance of elements greater than one on the leading di-\nagonal of the inverted tracing distribution matrices.\n0885-8950\/$26.00 \u00a9 2010 IEEE\nACHAYUTHAKAN et al.: ELECTRICITY TRACING IN SYSTEMS WITH AND WITHOUT CIRCULATING FLOWS 1079\nThe third, and perhaps most important, contribution of the\npaper is in analyzing the existence, uniqueness of solution\nand conditioning of the matrices which must be inverted in\nthe tracing problem. We provide, for the first time, a rigorous\nmathematical proof of invertibility of the tracing distribution\nmatrices in systems with and without circulating flows. We\ndemonstrate that a unique tracing solution exists for any phys-\nically valid power flow and that the tracing problem has no\nsolution only in some special cases when subsystems in an\ninterconnected network are aggregated to form supernodes.\nThe results are important both from theoretical and practical\npoints of view, as they improve understanding of, and confi-\ndence in, the tracing methodology. The considerations are il-\nlustrated using simple network examples.\nII. LOSSLESS NETWORK WITHOUT CIRCULATING FLOWS\nTracing of power flows in a network can be executed up-\nstream, i.e., from the loads to the generators, or downstream,\ni.e., from the generators to the loads [2]. To concentrate atten-\ntion, in this paper mainly the lossless downstream version of\nthe methodology will be considered. Clearly, the upstream ver-\nsion can be considered in a similar way, and the influence of\ntransmission losses could also be included easily by considering\ngross or net versions of the methodology [2]. Gross flows will\ninclude all transmission losses accumulated as tracing proceeds\ndownstream from the generators to the loads, while net flows\nwill exclude all the transmission losses as tracing proceeds up-\nstream from the loads to the generators. The methodology can\nalso be extended easily to trace the flow of reactive power [2] by\n(e.g.) establishing additional, fictitious, \u201cline nodes\u201d responsible\nfor the reactive power loss in each line. Note that tracing reactive\npower independently from active power has to be treated with\ncare because a substantial portion of the reactive power flows is\ndue to reactive losses caused by active power flows.\nAlternative approaches to dealing with losses and reactive\npower have been suggested, e.g., in [7]. Modification of the\nmethodology presented in this paper to employ any of those\nmethods is relatively simple, and will not be discussed here due\nto lack of space.\nTracing can be applied to power flows in a full line-by-line\ntransmission network model, or alternatively it can be used to as-\nsess how cross-border trades are distributed in a reduced model\nof an interconnected network; in the latter case, each subsystem\nis represented by a supernode, whose generation and demand\nare equal to the total generation and demand in the subsystem\n[13]. The examples used in this paper illustrate the latter appli-\ncation as it is far easier to construct simple examples and in-\ncorporate circulating flows in a reduced model of an intercon-\nnected network rather than in a full network model. However\nthe methodology presented in this paper is equally well appli-\ncable to tracing electricity in a full model of a single network\nwith each line explicitly represented.\nA. Topological Properties of Tracing Matrices\nThe tracing methodology was originally derived in [2] using\nthe proportional sharing principle in order to derive the down-\nstream and upstream distribution matrices and . Here the\nsame matrices will be derived using formal matrix manipula-\ntions. The main aim will be to show a link between the adjacency\nmatrix and the downstream and upstream distribution matrices\nintroduced in [2].\nConsider a network consisting of nbus nodes and branches\nand define as vector of nodal flows (i.e., the sum\nof nodal inflows or outflows including local generation and de-\nmand, respectively), as vector of nodal gener-\nations, as vector of nodal demands, and as\nvector of branch flows. Fig. 1 shows an example of a\nnetwork with power flows, generations and demands where\nThe incidence matrix is\n(1)\nwhere 1 corresponds to the start of a line (as denoted by the\ndirection of flow) and denotes the end of a line. This matrix\ncan be split into matrix consisting of \u2019s and consisting\nof 1\u2019s, i.e.\n(2)\nThe adjacency matrix of a digraph is defined as\nmatrix with if there is a flow from node\nto node . The adjacency matrix can be calculated as\n, and for the network in Fig. 1 it is\n(3)\n1080 IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 25, NO. 2, MAY 2010\nFig. 1. Simple example system.\nLet us now define matrix such that its\nelement is equal to the flow in line towards node (i.e.,\ndownstream). can be calculated as\n(4)\nwhere the operator denotes a diagonal matrix con-\nstructed from a vector. Clearly has the same structure as the\nadjacency matrix . For the network shown in Fig. 1\n(5)\nThe vector of nodal flows can be defined as the sum of nodal\noutflows or inflows\n(6)\nwhere 1 is vector of ones. Substituting (4) into (6)\n(7)\n(8)\nassuming that nodes with no nodal flows, i.e., those for which\n, have been removed from the digraph so that\nexists.\nMatrices and are referred to as the downstream and\nupstream distribution matrices and are equal to\n(9)\nComparing (3) with (9) shows that has the same structure as\nthe adjacency matrix , with addition of a diagonal, while the\nstructure of is the transpose of the structure of .\nObviously and can also be formed directly from\nthe line flows, without using the formal matrix manipulations\nshown in (9). Their elements are simply equal to\n(10)\nwhere is the flow in the line linking nodes and is\nthe nodal power at node is the set of downstream nodes\nsupplied directly from node and is the set of upstream nodes\nsupplying directly node . For the network shown in Fig. 1, we\nsee\n(11)\n(12)\nEquations (7) and (8) make it possible to trace how power\nflows in the network from individual generators or to individual\ndemands using\n(13)\nassuming that and exist. The question of invertibility\nof and will be considered later.\nNote that (13) has been derived by mathematical manipula-\ntion of the Kirchhoff\u2019s Current Law expressed by (6). Hence\n(13) does not represent a causal relationship between nodal\npowers and generations and demands, but it can still be used\nfor transmission cost allocation purposes.\nThe proportion of the nodal flow coming from the local\ngeneration is equal to . Hence the nodal genera-\ntion can be expressed, using the first equation of (13), as\na linear combination of components supplied to individual de-\nmands\n(14)\nSimilarly, as the proportion of the nodal flow coming from\npower flowing in the line supplying it is , branch\nflows can be expressed as a linear combination of components\nsupplied to individual demands\n(15)\nThe influence of transmission losses can be accounted for by\nconsidering gross and net network flows [2]. To obtain the net\nflows, the vector used to calculate in (9) must be replaced\nby the vector of flows at the receiving end of each line. To obtain\nthe gross flows, the flow vector used to calculate in (9)\nmust be replaced by the vector of flows at the sending end of\neach line.\nACHAYUTHAKAN et al.: ELECTRICITY TRACING IN SYSTEMS WITH AND WITHOUT CIRCULATING FLOWS 1081\nFig. 2. Digraphs of\u0000 for \u0000 \u0000 \u0002 to 5.\nB. Direct and Indirect Contributions of Nodal Power\nto Other Nodes\nElectricity tracing as defined by (7) and (8) is based\non solving linear equations, while the graph-based tracing\nmethodology [8], [9] is based on finding all possible paths\nbetween any two nodes in the digraph. Now the link between\nthe graph-based and the linear equations-based approaches\nto electricity tracing will be explored by using a well-known\nproperty of the adjacency matrix , namely that the value of\nelement of the power of the adjacency matrix, ,\ngives the number of paths of length between nodes and\n[14]. Due to space limitations we will concentrate on the down-\nstream distribution matrix , but all the properties discussed\nin this paper can equally well be applied to matrix using\nsymmetry arguments.\nNow define matrix as\n(16)\nObviously , so has\nthe same structure as the adjacency matrix , and\nits th element expresses the share of which is supplied\ndirectly from node (i.e., through line )\n(17)\nThe digraph corresponding to matrix is shown in the\ntop-left diagram in Fig. 2. Comparison with Fig. 1 shows that\neach line flow has been divided by the value of nodal power\nat the receiving end of the line in order to express a share in\nthe nodal flow. For simplicity, generations and demands have\nbeen omitted in Fig. 2. The sum of the nodal shares for each\nnode, i.e., the sum of elements in each column , must add up\nto 1 when there is no generation connected to a node; see, e.g.,\nnodes III, V and VI in Fig. 2. On the other hand, when there\nis a local generator connected to a node, e.g., in nodes II and\nIV in Fig. 2, this generator also contributes to the nodal power.\nIt follows that the shares provided by other nodes, i.e., the\nelements in a column corresponding to the node in question,\nadd up to less than one. This property of is important for the\nproof of invertibility of the tracing distribution matrices\u2014see\nSection IV.\nAs mentioned earlier, the value of element of the th\npower of the adjacency matrix, , gives the number of\npaths of length between nodes and . Note that has the\nsame structure as the adjacency matrix , but its elements are\nequal to the share of that is supplied directly from node .\nHence it follows that the value of element of the th power\nof , will give the share of which is supplied from\nnode through paths of length exactly between nodes and\n. To understand this let us consider matrix in (18) at the\nbottom of the next page.\nThe element expresses the pro-\nportion of the nodal power at node that is supplied from node\nindirectly through any single intermediate node . For example\nelement shows that node V is supplied from node II in-\ndirectly via nodes III and IV and the respective shares of the\nsupply to V are 1 10\/25 and (15\/30)(15\/25). The latter share\nis made up of 15\/30, due to connection II\u2013IV, multiplied by\n(15\/25) due to connection IV\u2013V. A digraph corresponding to\nmatrix is also shown in Fig. 2. Clearly all the direct connec-\ntions (i.e., the paths of length one) between any two nodes have\nbeen eliminated, and the resulting elements correspond to the\npaths of length two between any two nodes.\nSimilarly let us now consider matrices , and :\n(19)\nThe corresponding digraphs are shown in Fig. 2. Ele-\nment and the corresponding digraph show the pro-\nportion of nodal power at node that is supplied from\nnode indirectly through paths of length 3, i.e., through\n1082 IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 25, NO. 2, MAY 2010\ntwo intermediate nodes. For example shows that\nnode V is supplied from node I by two parallel routes:\nvia nodes II and III and via nodes II and IV. The share is\n.\nThe corresponding digraph shows that the paths of length two\n( in Fig. 2) have been eliminated. A similar interpretation\ncan be associated with matrices and and their corre-\nsponding digraphs.\nGenerally, an element and the corresponding digraph\nshow the proportion of the nodal power at node that is sup-\nplied from node indirectly through paths of length , i.e., when\npower flows through intermediate nodes.\nThe maximum nonzero matrix power has equal to the\nheight of the original digraph, i.e., the longest path between\nany two nodes. In the example system, Fig. 1, the height of the\ngraph is 5 as the longest path is (I\u2013II\u2013III\u2013IV\u2013V\u2013VI). Hence the\ncorresponding has only one nonzero element, and is\nobviously zero.\nNow let us consider matrix :\n(20)\nIn our example, we see (21) at the bottom of the page.\nElement shows the share of the nodal power at\nnode which is supplied from node through all interme-\ndiate connections. For example consist of 0 from\nfrom from\nfrom , and 0.0091 from . This means that node I supplies\nnode VI in three ways: 0.2727 of the nodal power at node VI\ncomes through paths including 1 intermediate node, 0.0636\nis supplied through paths including 2 intermediate nodes and\n0.0091 from paths including 4 intermediate nodes. In total,\nnode I supplies of the\nnodal power at node VI. The diagonal elements of are all\none, as all power flowing through a node must obviously come\nfrom that node.\nFig. 3. Power supplied over different path lengths for 118-node IEEE system.\nIt is interesting to study how far power travels in a typical net-\nwork, or in other words what the maximum path length (height\nof the digraph) is. Fig. 3 shows the shares of power supplied\nfrom individual generators to individual loads over paths of dif-\nferent lengths obtained for the standard 118-node IEEE test\nsystem [15]. The system has 186 lines, 19 generator buses, and\n99 load points (ten out of them are on buses having a generator).\nPower supplied by a generator to a load over path length can\nbe quantified using (14) with replacing . The shares in\nFig. 3 are expressed as percentages of the system load of 4242\nMW. Zero path length corresponds to a generator connected to\na load at the same bus. The maximum path length in the net-\nwork is 11 but 92% of power is supplied over path lengths not\nexceeding 4 and 99% of power is supplied over path lengths not\nexceeding 6. This shows that (as identified by tracing) generally\npower does not travel very far in a network.\nC. Connection With the Original Tracing\nDistribution Matrices\nWe will now show the connection between the downstream\ndistribution matrix and matrix introduced in this paper.\nA connection between the upstream distribution matrix and\n(18)\n(21)\nACHAYUTHAKAN et al.: ELECTRICITY TRACING IN SYSTEMS WITH AND WITHOUT CIRCULATING FLOWS 1083\nFig. 4. Simple three-node network with circulating flow.\nmatrix can be derived in a similar way ( is formed in a\nsimilar way as but looking at upstream shares.)\nPre-multiplying both sides of (20) by gives\n(22)\nNote that for greater than the height of the graph.\nSubtracting (22) from (20) gives\n(23)\nAs \u2014see (16)\u2014we finally obtain that\n(24)\nassuming that is nonsingular and hence invertible. Equation\n(24) can also be derived using matrix Taylor series expansion of\n[16].\nEquation (24) proves the link between the graph-based and\nlinear equation-based approaches to electricity tracing, by\nshowing that each element of matrix is equal\nto the sum of contributions to the nodal flows traced back to\ndifferent nodes in the digraph.\nThe inverted tracing distribution matrix can be\ncalculated in two ways: either by adding consecutive powers of\nmatrix as in (20), or by inverting . It should\nbe emphasized that we do not suggest using the matrix power\nseries form for practical implementation of tracing, as inverting\nis obviously computationally more efficient. The point is\nthat the matrix power series formulation provides a powerful in-\nsight into the physical meaning of the inverted downstream dis-\ntribution matrix . This finding will be further explored\nin the rest of the paper.\nIII. LOSSLESS NETWORK WITH CIRCULATING FLOWS\nUsually power flows in a network can be represented by an\nacyclic digraph, such as that shown in Fig. 1. However there are\nsome instances when the digraph of flows contains cycles be-\ncause of the presence of circulating flows. Such flows may ap-\npear due to the use of multiple uncoordinated phase angle reg-\nulators [16], or when network nodes in some areas are aggre-\ngated for transmission pricing purposes [13]. Cycles are more\ncommon in reactive power flows when they may appear due\nto off-nominal voltage ratios of transformers [16]. The linear\nequations-based tracing algorithm is able to calculate contribu-\ntions of all individual nodes even in the presence of circulating\nflows which create cycles in the digraph of flows. On the other\nFig. 5. Digraphs corresponding to consecutive powers of matrix\u0000 .\nhand the graph-based algorithm is not able to differentiate be-\ntween the contributions of different nodes in a cycle [10]. In this\nsection we will provide a further insight into this problem by\ncapitalizing on the matrix power representation of the inverted\ntracing distribution matrices.\nFig. 4 shows a simple example of a system with a circulating\nflow. Matrix and its powers are shown below while the cor-\nresponding digraphs are shown in Fig. 5:\n(25)\nEach matrix power shows the nodal contributions corre-\nsponding to the connections of path length between any two\nnetwork nodes. When circulating flows are absent, the height\nof a digraph is finite, and hence all the connections are elimi-\nnated after steps so that for . When circulating\nflows are present, the height of the graph is infinite and the al-\ngorithm finds connections of any length, however large. In the\ncase considered here, the length of the cycle is 3 as it consists of\nthree nodes. For matrices and the eliminations initially\nappear similar to the case without circulating flows; however,\nthe number of nonzero elements in the matrix is not decreasing.\nFor path length 3 (equal to the cycle length), represents the\ncontribution of each node to itself through one complete cycle.\nThis is shown by the appearance of nonzero values on the di-\nagonal of , and by loops appearing in the digraph. Starting\n1084 IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 25, NO. 2, MAY 2010\nFig. 6. Six-node lossless network with circulating flows.\nfrom the fourth step the pattern repeats itself, but with matrices\ngetting smaller as increases, until for all the elements\nare smaller than 0.001. The final value of matrix can be cal-\nculated either by adding more matrices in the series, or in one\nstep by inverting\n(26)\nA. Detection of Circulating Flows\nCirculating flows can be easily identified by inspection in a\nsmall network but their identification in large networks may not\nbe easy. It was suggested in [12] that nodes participating in cir-\nculating flows can be identified through the appearance of ele-\nments greater-than-one on the leading diagonal of the inverted\nupstream and downstream distribution matrices:\nand . Here we will provide a physical justification\nfor this observation based on the inspection of the matrices .\nEach matrix power shows nodal contributions corre-\nsponding to indirect connection between any two nodes through\npaths of length . In the absence of circulating flows, the di-\nagonal elements of are all zero, as it is impossible to trace\nback a connection from a node to itself in an acyclic digraph.\nHowever, in the presence of circulating flows the digraph has\ncycles, and any node involved in a cycle can be traced back\nto itself through other nodes. In the example studied, Fig. 4,\nnonzero diagonal elements appeared in because the length\nof the cycle is 3. Hence for path length of 3, the algorithm\ncalculates the contribution of each node to itself. Obviously\nnonzero diagonal elements of cause the diagonal elements\nof to be greater than one, as\nobserved originally in [12].\nB. Example of Interacting Flows\nNow let us assume that the interconnected network shown\npreviously in Fig. 1 contains interacting circulating flows (which\ncause cycles to appear in the digraph) as shown in Fig. 6. There\nare three interacting cycles in the digraph: (II\u2013IV\u2013V\u2013VI\u2013II),\n(II\u2013III\u2013V\u2013VI\u2013II), and (II\u2013III\u2013IV\u2013V\u2013VI\u2013II). The length of the\nfirst two cycles is 4 while the length of the last cycle is 5.\nThe consecutive powers can be calculated as before with\nthe corresponding digraphs shown in Fig. 7 for\nand 8. The interpretation of the results is similar to the case\nshown in Fig. 4. Because the length of the shortest cycle is 4,\nnonzero elements start to appear on the main diagonal of the\nFig. 7. Digraphs of \u0000 (\u0000 \u0000 \u0002\u0000 \u0003\u0000 \u0004\u0000 and 8) for the six-node system with\ncirculating flows.\nmatrices starting from . This is illustrated in the digraphs by\nappearance of local loops in the nodes involved in the cycles.\nThe consecutive powers tend towards zero for high .\ncan be of course calculated directly as\n(27)\nNode I does not participate in any of the cycles so the corre-\nsponding diagonal element of is one. As nodes II, V, VI par-\nticipate in all three cycles (II\u2013IV\u2013V\u2013VI\u2013II), (II\u2013III\u2013V\u2013VI\u2013II),\nand (II\u2013III\u2013IV\u2013V\u2013VI\u2013II), their corresponding diagonal ele-\nments in are the same and equal 1.08. Node IV participates\nin the first two cycles so the corresponding diagonal element\nis different and equals 1.02. Node III participates in the first\nand third cycle so the corresponding diagonal element is again\ndifferent and equals 1.065.\nIV. PROOF OF INVERTIBILITY AND MATRIX POWER\nSERIES CONVERGENCE RESULTS IN SYSTEMS WITH\nAND WITHOUT CIRCULATING FLOWS\nIn this section, we provide rigorous mathematical proofs of\nthe convergence of the matrix power series (20) in systems with\nand without circulating flows, and also of the invertibility of\nthe downstream distribution matrix . This is of fundamental\nimportance for a practical implementation of tracing as it\nproves the existence and uniqueness of a solution to the tracing\nproblem. For these proofs, the following properties of are\nrequired.\n\u2022 All column sums are less than or equal to 1.\n\u2022 For at least one column, labeled , the column sum is\nstrictly less than 1.\n\u2022 All elements are nonnegative.\nACHAYUTHAKAN et al.: ELECTRICITY TRACING IN SYSTEMS WITH AND WITHOUT CIRCULATING FLOWS 1085\nThe first and the third assumptions follow directly from the def-\ninition of ; the second assumption is due to a property of\nexplained in Section II-B. A generator connected to a node\nmeans that less than 100% of that node\u2019s supply is from pre-\nvious nodes in the network so that the sum of the nodal shares,\ni.e., the elements in the corresponding column of , is less\nthan 1. The second assumption therefore implies that there is at\nleast one source in the network, which is required for a physi-\ncally realistic power flow.\nA. Theorem: All Eigenvalues of Have Magnitude Less\nThan 1\nSuppose that has an eigenvector with eigenvalue . By\ndefinition\n(28)\nEquivalently\n(29)\nFor convenience, the elements of are written without\nthe subscript . It follows that\n(30)\nTaking column out of the sum over\n(31)\nBy the assumptions above, the first term on the right-hand\nside is strictly less than and the second is no greater than\n. It follows that\n(32)\nDividing (32) by , the proof is complete.\nB. Corollary: The Matrix Power Series (20) Converges\nAll eigenvalues having magnitude strictly less than 1 is a suf-\nficient condition for the power series to be convergent [16].\nC. Corollary: Is Invertible\nSuppose that is singular. It follows that an eigenvector\nexists with\n(33)\nand that\n(34)\nAs all eigenvalues of have magnitude less than 1, it follows\nthat cannot be singular, and that it is therefore invertible.\nFig. 8. Possible problems with aggregation of nodes. (a) Original digraph.\n(b) Aggregated nodes but without netting out of generations\/demands.\n(c) Aggregated nodes with netted out generations\/demands.\nThe above rigorous mathematical proof has an intuitive re-\nlationship with the engineering problem. The matrix is invert-\nible and therefore a unique solution to the tracing problem ex-\nists when there is at least one source (and therefore also a sink)\nin the network.\nD. Example of Non-Invertible\nDespite its apparently unphysical nature, it is interesting to\nconsider a network with no generation (i.e., a pure circulating\nflow) when elements in each column of add up to one. This\nmay in principle arise when nodes are aggregated either to sim-\nplify large network diagrams or when individual areas in an in-\nterconnected network are aggregated into supernodes.\nConsider the acyclic digraph of flows for a full network shown\nin Fig. 8(a). Fig. 8(b) shows a reduced digraph when two pairs\nof nodes have been aggregated. This creates a circulating flow,\nbut the tracing solutions still exists as the reduced digraph has\nsources and sinks. However if the generations and demands are\nnetted out, as shown in Fig. 8(c), the tracing matrices are sin-\ngular and the problem has no solution. Each of the nodes shown\nin Fig. 8(c) represents an area with perfectly balanced internal\ngeneration and demand; their net injections are zero but circu-\nlating flows appear due to geographical imbalance of genera-\ntion\/demand pattern within each area. Note that such a situation\ncannot arise when the internal generation and demand in each\narea is explicitly considered, as we have assumed in Figs. 1 and\n8(b).\nTo prove that the solution for the digraph shown in Fig. 8(c)\ndoes not exist consider the first five powers of\n(35)\n1086 IEEE TRANSACTIONS ON POWER SYSTEMS, VOL. 25, NO. 2, MAY 2010\nNote that the sum of all elements in each column of is equal\nto 1 as there are no generators in the system. The power series\n(20) is clearly non-convergent, as the powers of are periodic,\nand thus do not tend to zero. Obviously, it is also clear that\nis singular (adding rows shows that they are linearly\ndependent.)\nIt is easy to check that the eigenvalues of are 1 and\n, all of which have magnitude . This is the conse-\nquence of all columns adding up to one. Consequently the con-\nditions required for the proofs above that (20) converges and\nis invertible are not satisfied.\nE. Conditioning of\nThe above considerations make it also possible to analyze\nhow well-conditioned matrix is. If system generations are\nsmall compared to the nodal flows, the nodal shares provided\nby those generations are small. It follows from the arguments\nabove that in this case has an eigenvalue close to zero, and\nhence might be ill-conditioned and hard to invert numerically.\nThere is an important practical implication of the above\nfinding. As discussed in Section IV-D, internal networks in\nan interconnected system may be aggregated by netting out\nthe internal injections. Care should be exercised here, as if\nall countries have roughly balanced generation and demand,\nnet injections would be small while there could be still large\ncross-border flows due to a geographical imbalance of genera-\ntion\/demand in each area. In the extreme case of net zero nodal\ninjections this would give rise to a pure circulating flow and\nnon-invertible tracing matrices, as discussed in Section IV-D\nand illustrated in Fig. 8(c).\nV. CONCLUSION\nThis paper has provided an additional insight into the tracing\nmethodology, by representing the inverted original upstream\nand downstream distribution matrices, and , in\nthe form of matrix power series and by analysing the existence,\nuniqueness of solution and conditioning of the matrices which\nmust be inverted in the tracing problem.\nFor the downstream version, , where\n. Element of the th term in the power se-\nries, and the corresponding digraph, show the proportion of the\nnodal power which is supplied from node indirectly through\npaths of length exactly , i.e., when power flows through\nintermediate nodes. For acyclic flows, the highest nonzero ma-\ntrix power has equal to the height of the original digraph, i.e.,\nthe longest path between any two nodes.\nThe matrix power series representation provides an additional\ninsight into the physical meaning of the inverted tracing distribu-\ntion matrices. Firstly it proves the link between the graph-based\nand linear equation-based approaches to electricity tracing, by\nshowing that each element of is equal to the sum of\ncontributions to the nodal flows traced back to different nodes\nin the digraph. Secondly, the matrix power series representation\nmakes it possible to explain an earlier observation that circu-\nlating flows, which cause cycles in the digraph of flows, can\nbe detected by appearance of elements greater-than-one on the\nleading diagonal of the inverted tracing distribution matrices.\nThe third contribution is probably the most important, as for\nthe first time invertibility of the tracing distribution matrices has\nbeen proved rigorously. This is of fundamental importance for\na practical implementation of tracing as it proves the existence\nand uniqueness of a solution to the tracing problem. The proof\nrequires only the presence of generation and demand in the net-\nwork; systems which do not satisfy this may appear only in some\nspecial cases when subsystems in an interconnected network\nare aggregated to form supernodes. This result implies that the\ntracing distribution matrices become ill-conditioned when gen-\nerations are small compared to nodal flows; equivalently, the\nmatrix power series would then converge more slowly.\nACKNOWLEDGMENT\nJ. W. Bialek would like to thank Prof. F. F. Wu for his support\nduring sabbatical leave at the University of Hong Kong in 2008,\nwhen this paper was written.\nREFERENCES\n[1] R. Green, \u201cElectricity transmission pricing: An international compar-\nison,\u201d Util. Policy, vol. 6, no. 3, pp. 177\u2013184, 1997.\n[2] J. Bialek, \u201cTracing the flow of electricity,\u201d Proc. Inst. Elect. Eng., Gen.,\nTransm., Distrib., vol. 143, no. 4, pp. 313\u2013320, Jul. 1996.\n[3] J. W. Bialek and P. Kattuman, \u201cProportional sharing assumption in\ntracing methodology,\u201d Proc. Inst. Elect. Eng., Gen., Transm., Distrib.,\nvol. 151, no. 4, pp. 526\u2013532, Jul. 2004.\n[4] H. X. Wang, R. Liu, W. D. Li, and C. H. Zhao, \u201cPower flow tracing with\nconsideration of the electrical distance,\u201d in Proc. Asia Pacific Power\nand Energy Engineering Conf. (APPEEC), Wuhan, China, Mar. 28\u201331,\n2009.\n[5] L. Olmos and I. J. P\u00e9rez-Arriaga, \u201cEvaluation of three methods pro-\nposed for the computation of inter-TSO payments in the Internal Elec-\ntricity Market of the European Union,\u201d IEEE Trans. Power Syst., vol.\n22, no. 4, pp. 1507\u20131522, Nov. 2007.\n[6] A. R. Abhyankar, S. A. Soman, and S. A. Khaparde, \u201cOptimization ap-\nproach to real power tracing: An application to transmission fixed cost\nallocation,\u201d IEEE Trans. Power Syst., vol. 21, no. 3, pp. 1350\u20131361,\nAug. 2006.\n[7] M. Pantos\u02c7, G. Verbiec\u02c7, and F. Gubina, \u201cModified topological genera-\ntion and load distribution factors,\u201d IEEE Trans. Power Syst., vol. 20,\nno. 4, pp. 1998\u20132005, Nov. 2005.\n[8] D. Kirschen, R. Allan, and G. Strbac, \u201cContributions of individual gen-\nerators to loads and flows,\u201d IEEE Trans. Power Syst., vol. 12, no. 1, pp.\n52\u201360, Feb. 1997.\n[9] F. F. Wu, Y. X. Ni, and P. Wei, \u201cPower transfer allocation for open\naccess using graph theory\u2014Fundamental and applications in sys-\ntems without loopflow,\u201d IEEE Trans. Power Syst., vol. 15, no. 3, pp.\n923\u2013929, Aug. 2000.\n[10] J. W. Bialek and S. Ziemianek, \u201cTracing-based transmission pricing of\ncross-border trades: Fundamentals and circular flows,\u201d in Proc. IEEE\nBologna Power Tech. Conf., Bologna, Italy, Jun. 23\u201326, 2003.\n[11] K. G. Xie, J. Q. Zhou, and W. Y. Li, \u201cAnalysis model and algorithm for\ntracing active power flow based on extended incidence matrix,\u201d Elect.\nPower Syst. Res., vol. 79, no. 2, pp. 399\u2013405, Feb. 2009.\n[12] S. Ziemianek and J. W. Bialek, \u201cIdentification of circular flows in trans-\nmission networks using the electricity tracing methodology,\u201d in Proc.\n16th Power Systems Computation Conf. (PSCC 2008), Glasgow, U.K.\n[13] J. W. Bialek, S. Ziemianek, and R. Wallace, \u201cA methodology for al-\nlocating transmission losses due to cross-border trades,\u201d IEEE Trans.\nPower Syst., vol. 19, no. 3, pp. 1255\u20131262, Aug. 2004.\n[14] S. Skiena, Implementing Discrete Mathematics: Combinatorics and\nGraph Theory With Mathematica. Reading, MA: Addison-Wesley,\n1990.\n[15] [Online]. Available: http:\/\/www.ee.washington.edu\/research\/pstca\/.\n[16] G. H. Golub and C. F. Van Loan, Matrix Computations. Baltimore,\nMD: John Hopkins Univ. Press, 1983, ch. 11.\n[17] P. Wei, Y. X. Ni, and F. F. Wu, \u201cLoad flow tracing in power systems\nwith circulating power,\u201d Int. J. Elect. Power Energy Syst., vol. 24, no.\n10, pp. 807\u2013813, Dec. 2002.\nACHAYUTHAKAN et al.: ELECTRICITY TRACING IN SYSTEMS WITH AND WITHOUT CIRCULATING FLOWS 1087\nChira Achayuthakan received the B.Eng. degree\nin 1995 from Chulalongkorn University, Bangkok,\nThailand, and the M.Eng. degree in 1997 from the\nAsian Institute of Technology (AIT), Pathumthani,\nThailand, where he is currently pursuing the Ph.D.\ndegree in energy field of study.\nBefore he joined the Electricity Generating Au-\nthority of Thailand (EGAT), he worked as O&M\nShift Charge for Independent Power (Thailand)\nCompany or IPT, one of the IPP pioneers in Thai-\nland. IPT holds a 700-MW combined cycle power\nplant. His research interests include energy economics, and deregulated electric\nsupply industry.\nChris J. Dent (M\u201908) received the B.A. degree\nin mathematics from Cambridge University, Cam-\nbridge, U.K., in 1997, the Ph.D. degree in theoretical\nphysics from Loughborough University, Lough-\nborough, U.K., in 2001, and the M.Sc. degree in\noperational research from the University of Edin-\nburgh, Edinburgh, U.K., in 2006.\nHe is a Senior Research Associate in the School\nof Engineering and Computing Sciences, Durham\nUniversity, Durham, U.K. From 2007\u20132009, he was\nwith the University of Edinburgh. His research inter-\nests lie power system optimization, risk modelling, economics, and renewables\nintegration.\nDr. Dent is a Chartered Physicist, an Associate of the OR Society, and a\nmember of the Institution of Engineering and Technology, the Operational Re-\nsearch Society, and Cigre.\nJanusz W. Bialek (SM\u201908) received the M.Eng.\nand Ph.D. degrees from Warsaw University of\nTechnology, Warsaw, Poland, in 1977 and 1981,\nrespectively.\nHe is a Professor of electrical power and control\nat Durham University, Durham, U.K. In 1981\u20131989,\nhe was with Warsaw University of Technology,\nin 1989\u20132002 with Durham University, and in\n2003\u20132009 with the University of Edinburgh. He\ncoauthored two books and over 100 technical pa-\npers. His research interests include power system\neconomics, power system dynamics, and sustainable energy systems.\nWeerakorn Ongsakul (S\u201989\u2013M\u201995) received the\nB.Eng. degree from Chulalongkorn University,\nBangkok, Thailand, in 1988 and the M.S. and Ph.D.\ndegrees in electrical engineering from Texas A&M\nUniversity, College Station, in 1991 and 1994,\nrespectively.\nHe is currently an Associate Professor of energy\nfield of study and Dean of the School of Environ-\nment, Resources, and Development, Asian Institute\nof Technology, Pathumthani, Thailand. His research\ninterests are in computer applications to power sys-\ntems, parallel processing applications, AI applications to power system, and\npower system deregulation.\n"}