{"doi":"10.1109\/TCSI.2008.916442","coreId":"54160","oai":"oai:eprints.lincoln.ac.uk:2704","identifiers":["oai:eprints.lincoln.ac.uk:2704","10.1109\/TCSI.2008.916442"],"title":"Optimal PWM control of switched-capacitor DC\/DC power converters via model transformation and enhancing control techniques","authors":["Ho, Charlotte Yuk-Fan","Ling, Bingo Wing-Kuen","Liu, Yan-Qun","Tam, Peter Kwong-Shun","Teo, Kok-Lay"],"enrichments":{"references":[{"id":923864,"title":"A compact switched-capacitor regulated charge pump power supply,\u201d","authors":[],"date":"2006","doi":"10.1109\/JSSC.2006.875303","raw":"B. Robert Gregoire, \u201cA compact switched-capacitor regulated charge pump power supply,\u201d IEEE Journal of Solid-State Circuits, vol. 41, no. 8, pp. 1944-1953, 2006.","cites":null},{"id":923738,"title":"A new approach to reducing output ripple in switched-capacitor-based step-down","authors":[],"date":"2006","doi":"10.1109\/tpel.2006.882973","raw":"Jifeng Han, Annette von Jouanne and G\u00e1bor C. Temes, \u201cA new approach to reducing output ripple in switched-capacitor-based step-down DC-DC converters,\u201d IEEE Transactions on Power Electronics, vol. 21, no. 6, pp. 1548-1555, 2006.","cites":null},{"id":916984,"title":"A new design of power supplies for pocket computer systems,\u201d","authors":[],"date":"1998","doi":"10.1109\/41.681221","raw":"Jian Liu, Zhiming Chen and Zhong Du, \u201cA new design of power supplies for pocket computer systems,\u201d IEEE Transactions on Industrial Electronics, vol. 45, no. 2, pp. 228-235, 1998.","cites":null},{"id":921172,"title":"A unified computational approach to optimal control problems,","authors":[],"date":"1991","doi":"10.1016\/0005-1098(88)90003-9","raw":"K. L. Teo, C. J. Goh and K. H. Wong, A unified computational approach to optimal control problems, vol. 55, Pitman Monographs and Surveys in Pure and Applied Mathematics (Longman Scientific and Technical, England, 1991).","cites":null},{"id":920169,"title":"An improved LQR-based controller for switching DC-DC converters,\u201d","authors":[],"date":"1993","doi":"10.1109\/41.238013","raw":"Frank H. F. Leung, Peter K. S. Tam and C. K. Li, \u201cAn improved LQR-based controller for switching DC-DC converters,\u201d IEEE Transactions on Industrial Electronics, vol. 40, no. 5, pp. 521-528, 1993.","cites":null},{"id":923509,"title":"An SC voltage doubler with pseudo-continuous output regulation using a three-stage switchable Opamp,\u201d","authors":[],"date":"2007","doi":"10.1109\/JSSC.2007.897133","raw":"Hoi Lee and Philip K. T. Mok, \u201cAn SC voltage doubler with pseudo-continuous output regulation using a three-stage switchable Opamp,\u201d  IEEE Journal of Solid-State Circuits, vol. 42, no. 6, pp. 1216-1229, 2007.","cites":null},{"id":18450566,"title":"Applying resonant parametric perturbation to control chaos in the buck DC\/DC converter with phase shift and frequency mismatch considerations,\u201d","authors":[],"date":"2003","doi":"10.1142\/s0218127403008685","raw":"Yufei Zhou, Chi K. Tse, Shui-Sheng Qiu and Francis C. M. Lau, \u201cApplying resonant parametric perturbation to control chaos in the buck DC\/DC converter with phase shift and frequency mismatch considerations,\u201d International Journal of Bifurcation and Chaos, vol. 13, no. 11, pp. 3459-3471, 2003.","cites":null},{"id":916744,"title":"Area-efficient CMOS charge pumps for LCD drivers,\u201d","authors":[],"date":"2003","doi":"10.1109\/jssc.2003.817596","raw":"TianRui Ying, Wing-Hung Ki and Mansun Chan, \u201cArea-efficient CMOS charge pumps for LCD drivers,\u201d IEEE Journal of Solid-State Circuits, vol. 38, no. 10, pp. 1721-1725, 2003.","cites":null},{"id":917255,"title":"Bal\u00e1zs Buti and Istv\u00e1n Nagy, \u201cStability analysis of a feedback-controlled resonant DC-DC converter,\u201d","authors":[],"date":"2003","doi":"10.1109\/tie.2002.804983","raw":"Octavian Dranga, Bal\u00e1zs Buti and Istv\u00e1n Nagy, \u201cStability analysis of a feedback-controlled resonant DC-DC converter,\u201d IEEE Transactions on Industrial Electronics, vol. 50, no. 1, pp. 141-152, 2003.","cites":null},{"id":918428,"title":"Border\u23afcollision bifurcations in the buck converter,\u201d","authors":[],"date":"1998","doi":"10.1109\/81.703837","raw":"Guohui Yuan, Soumitro Banerjee, Edward Ott and James A. Yorke, \u201cBorder\u23afcollision bifurcations in the buck converter,\u201d IEEE Transactions on Circuits and Systems\u23afI: Fundamental Theory and Applications, vol. 45, no. 7, pp. 707-716, 1998.","cites":null},{"id":919417,"title":"Chaos study and parameter-space analysis of the DC-DC buck-boost converter,\u201d","authors":[],"date":"2003","doi":"10.1049\/ip-epa:20030228","raw":"K. W. E. Cheng, M. Liu and J. Wu, \u201cChaos study and parameter-space analysis of the DC-DC buck-boost converter,\u201d IEE Proceedings. B, Electric Power Applications, vol. 150, no. 2, pp. 126-138, 2003.","cites":null},{"id":920687,"title":"Control of DC-DC converters with linear optimal feedback and nonlinear feedforward,\u201d","authors":[],"date":"1994","doi":"10.1109\/63.334776","raw":"Francesco Garofalo, Pompeo Marino, Stefano Scala and Francesco Vasca, \u201cControl of DC-DC converters with linear optimal feedback and nonlinear feedforward,\u201d IEEE Transactions on Power Electronics, vol. 9, no. 6, pp. 607-615, 1994.","cites":null},{"id":923190,"title":"DC-to-DC converter with no magnetic elements and enhanced regulation,\u201d","authors":[],"date":"1997","doi":"10.1109\/7.575889","raw":"Guangyong Zhu and Adrian Ioinovici, \u201cDC-to-DC converter with no magnetic elements and enhanced regulation,\u201d IEEE Transactions on Aerospace and Electronic Systems, vol. 33, no. 2, pp. 499-506, 1997.","cites":null},{"id":18450565,"title":"Design of feedback gain vector of two-state basic PWM multifeedback regulators for large-signal stability,\u201d","authors":[],"date":"1997","doi":"10.1109\/81.611262","raw":"Henry Chung and Adrian Ioinovici, \u201cDesign of feedback gain vector of two-state basic PWM multifeedback regulators for large-signal stability,\u201d IEEE Transactions on Circuits and Systems\u23afI: Fundamental Theory and Applications, vol. 44, no. 8, pp. 676-683, 1997.","cites":null},{"id":922836,"title":"Development of a switched-capacitor DC\/DC boost converter with continuous input current waveform,\u201d","authors":[],"date":"1999","doi":"10.1109\/81.768834","raw":"Henry Chung and Y. K. Mok, \u201cDevelopment of a switched-capacitor DC\/DC boost converter with continuous input current waveform,\u201d IEEE Transactions on Circuits and Systems\u23afI: Fundamental Theory and Applications, vol. 46, no. 6, pp. 756-759, 1999.","cites":null},{"id":918652,"title":"Discrete-time maps for the analysis of bifurcations and chaos","authors":[],"date":"2000","doi":"10.1109\/81.828567","raw":"Mario di Bernardo and Francesco Vasca, \u201cDiscrete-time maps for the analysis of bifurcations and chaos in DC\/DC converters,\u201d IEEE Transactions on Circuits and Systems\u23afPart I: Fundamental Theory and Applications, vol. 47, no. 2, pp. 130-143, 2000.","cites":null},{"id":18450568,"title":"Emilio Figueres and Antonio Mochol\u00ed, \u201cNovel three-controller average current mode control of DC-DC PWM converters with improved robustness and dynamic response,\u201d","authors":[],"date":"2000","doi":"10.1109\/63.844512","raw":"Gabriel Garcer\u00e1, Emilio Figueres and Antonio Mochol\u00ed, \u201cNovel three-controller average current mode control of DC-DC PWM converters with improved robustness and dynamic response,\u201d IEEE Transactions on Power Electronics, vol. 15, no. 3, pp. 516-528, 2000.","cites":null},{"id":919196,"title":"Experimental confirmation of chaos in a current-programmed \u0106uk converter,\u201d","authors":[],"date":"1996","doi":"10.1109\/81.508184","raw":"C. K. Tse, S. C. Fung and M. W. Kwan, \u201cExperimental confirmation of chaos in a current-programmed \u0106uk converter,\u201d IEEE Transactions on Circuits and Systems\u23afI: Fundamental Theory and Applications, vol. 43, no. 7, pp. 605-608, 1996.","cites":null},{"id":918776,"title":"Experimental study of bifurcation and chaos in the buck-boost converter,\u201d","authors":[],"date":"2003","doi":"10.1049\/ip-epa:20030056","raw":"K. W. E. Cheng, M. Liu and J. Wu, \u201cExperimental study of bifurcation and chaos in the buck-boost converter,\u201d IEE Proceedings. B, Electric Power Applications, vol. 150, no. 1, pp. 45-61, 2003.","cites":null},{"id":919489,"title":"Imma Massana and Alicia Miralles, \u201cLyapunov exponents for bilinear systems. Application to the buck converter,\u201d","authors":[],"date":"2003","doi":"10.1142\/s0218127403006868","raw":"Carles Batlle, Imma Massana and Alicia Miralles, \u201cLyapunov exponents for bilinear systems. Application to the buck converter,\u201d International Journal of Bifurcation and Chaos, vol. 13, no. 3, pp. 713-722, 2003.","cites":null},{"id":917725,"title":"Large-signal stability-oriented design of boost regulators based on a Lyapunov criterion with nonlinear integral,\u201d","authors":[],"date":"2002","doi":"10.1109\/tcsi.2002.803350","raw":"Yefim Berkovich and Adrian Ioinovici, \u201cLarge-signal stability-oriented design of boost regulators based on a Lyapunov criterion with nonlinear integral,\u201d IEEE Transactions on Circuits and Systems\u23afI: Fundamental Theory and Applications, vol. 49, no. 11, pp. 1610-1619, 2002.","cites":null},{"id":920943,"title":"Licia Pinola and Vincenzo Varoli, \u201cOptimal feed-forward compensation for PWM DC\/DC converters with \u201clinear\u201d and \u201cquadratic\u201d conversion ratio,\u201d","authors":[],"date":"1992","doi":"10.1109\/63.136253","raw":"Luigi Calderone, Licia Pinola and Vincenzo Varoli, \u201cOptimal feed-forward compensation for PWM DC\/DC converters with \u201clinear\u201d and \u201cquadratic\u201d conversion ratio,\u201d IEEE Transactions on Power Electronics, vol. 7, no. 2, pp. 349-355, 1992.","cites":null},{"id":922547,"title":"MISER3: Solving optimal control problems\u23afan update,\u201d","authors":[],"date":"1991","doi":"10.1016\/0961-3552(91)90016-W","raw":"L. S. Jennings, M. E. Fisher, K. L. Teo and C. J. Goh, \u201cMISER3: Solving optimal control problems\u23afan update,\u201d Advances in Engineering Software, vol. 13, pp. 190-196, 1991.","cites":null},{"id":918222,"title":"Modeling of chaotic DC-DC converters by iterated nonlinear mappings,\u201d","authors":[],"date":"1992","doi":"10.1109\/63.124574","raw":"David C. Hamill, Jonathan H. B. Deane and David J. Jefferies, \u201cModeling of chaotic DC-DC converters by iterated nonlinear mappings,\u201d IEEE Transactions on Power Electronics, vol. 7, no. 1, pp. 25-36, 1992.","cites":null},{"id":919981,"title":"Multirate modeling and control design for switched-mode power converters,\u201d","authors":[],"date":"1994","doi":"10.1109\/9.317110","raw":"Alireza Khayatian and David G. Taylor, \u201cMultirate modeling and control design for switched-mode power converters,\u201d IEEE Transactions on Automatic Control, vol. 39, no. 9, pp. 1848-1852, 1994.","cites":null},{"id":923263,"title":"Noise-shaping techniques applied to switched-capacitor voltage regulators,\u201d","authors":[],"date":"2005","doi":"10.1109\/jssc.2004.840986","raw":"Arun Rao, William McIntyre, Un-Ku Moon and G\u00e1bor C. Temes, \u201cNoise-shaping techniques applied to switched-capacitor voltage regulators,\u201d  IEEE Journal of Solid-State Circuits, vol. 40, no. 2, pp. 422-429, 2005.","cites":null},{"id":917943,"title":"Nonlinear modeling and bifurcations in the boost converter,\u201d","authors":[],"date":"1998","doi":"10.1109\/63.662832","raw":"Soumitro Banerjee and Krishnendu Chakrabarty, \u201cNonlinear modeling and bifurcations in the boost converter,\u201d IEEE Transactions on Power Electronics, vol. 13, no. 2, pp. 252-260, 1998.","cites":null},{"id":922081,"title":"On a class of optimal control problems with state jumps,\u201d","authors":[],"date":"1998","doi":null,"raw":"Y. Liu, K. L. Teo, L. S. Jennings and S. Wang, \u201cOn a class of optimal control problems with state jumps,\u201d Journal of Optimization Theory and Applications, vol. 98, no. 1, pp. 65-82, 1998.","cites":null},{"id":920914,"title":"Series and parallel transformer resonant DC-DC converter using optimal digital servo and repetitive learning control schemes,\u201d","authors":[],"date":"1999","doi":"10.1049\/ip-epa:19990157","raw":"J. Sun, H. Takano and M. Nakaoka, \u201cSeries and parallel transformer resonant DC-DC converter using optimal digital servo and repetitive learning control schemes,\u201d IEE Proceedings. B, Electric Power Applications, vol. 146, no. 5, pp. 530-538, 1999.","cites":null},{"id":918971,"title":"Study of bifurcations in current-programmed DC\/DC boost converters: from quasi-periodicity to period-doubling,\u201d","authors":[],"date":"1997","doi":"10.1109\/81.645154","raw":"William C. Y. Chan and Chi K. Tse, \u201cStudy of bifurcations in current-programmed DC\/DC boost converters: from quasi-periodicity to period-doubling,\u201d  IEEE Transactions on Circuits and Systems\u23afI: Fundamental Theory and Applications, vol. 44, no. 12, pp. 1129-1142, 1997.","cites":null},{"id":919729,"title":"Subharmonics and chaos in a controlled switched-mode power converter,\u201d","authors":[],"date":"1988","doi":"10.1109\/31.1858","raw":"David C. Hamill and David J. Jeffries, \u201cSubharmonics and chaos in a controlled switched-mode power converter,\u201d IEEE Transactions on Circuits and Systems, vol. 35, no. 8, pp. 1059-1061, 1988.","cites":null},{"id":920410,"title":"The control of switching","authors":[],"date":"1991","doi":null,"raw":"Frank H. F. Leung, Peter K. S. Tam and C. K. Li, \u201cThe control of switching DC-DC converters\u23afA general LQR problem,\u201d IEEE Transactions on Industrial Electronics, vol. 38, no. 1, pp. 65-71, 1991.","cites":null},{"id":921636,"title":"The control parameterization enhancing transform for constrained optimal control problems,\u201d","authors":[],"date":"1999","doi":"10.1017\/S0334270000010936","raw":"K. L. Teo, L. S. Jennings, H. W. J. Lee and V. Rehbock, \u201cThe control parameterization enhancing transform for constrained optimal control problems,\u201d Journal of Australian Mathematical Society, Series B, vol. 40, pp. 314-335, 1999.","cites":null},{"id":917489,"title":"Theoretical and experimental investigation of the fast- and slow-scale instabilities of a DC-DC converter,\u201d","authors":[],"date":"2001","doi":"10.1109\/63.911144","raw":"Sudip K. Mazumder, Ali H. Nayfeh and Dushan Boroyevich, \u201cTheoretical and experimental investigation of the fast- and slow-scale instabilities of a DC-DC converter,\u201d IEEE Transactions on Power Electronics, vol. 16, no. 2, pp. 201-216,  2001.","cites":null},{"id":18450567,"title":"Two-dimensional bifurcation diagrams. Background pattern of fundamental DC-DC converters with PWM control,\u201d","authors":[],"date":"2003","doi":"10.1142\/s0218127403006728","raw":"L. Benadero, A. El Aroudi, G. Olivar, E. Toribio and E. G\u00f3mez, \u201cTwo-dimensional bifurcation diagrams. Background pattern of fundamental DC-DC converters with PWM control,\u201d International Journal of Bifurcation and Chaos, vol. 13, no. 2, pp. 427-451, 2003. This article has been accepted for inclusion in a future issue.","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2008-06","abstract":"Abstract\u2014This paper presents an efficient and effective method\\ud\nfor an optimal pulse width modulated (PWM) control of\\ud\nswitched-capacitor DC\/DC power converters. Optimal switching\\ud\ninstants are determined based on minimizing the output ripple\\ud\nmagnitude, the output leakage voltage and the sensitivity of the\\ud\noutput load voltage with respect to both the input voltage and the\\ud\nload resistance. This optimal PWM control strategy has several\\ud\nadvantages over conventional PWM control strategies: 1) It does\\ud\nnot involve a linearization, so a large signal analysis is performed.\\ud\n2) It guarantees the optimality. The problem is solved via both the\\ud\nmodel transformation and the optimal enhancing control\\ud\ntechniques. A practical example of the PWM control of a\\ud\nswitched-capacitor DC\/DC power converter is presented","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/54160.pdf","fullTextIdentifier":"http:\/\/eprints.lincoln.ac.uk\/2704\/1\/Optimal_PWM_Control_of_Switched-Capacitor_DC_DC_Power_Converters_via_Model.pdf","pdfHashValue":"fd975a5374553e7f1b8e665088c6aca30edafefb","publisher":"IEEE","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lincoln.ac.uk:2704<\/identifier><datestamp>\n      2013-03-13T08:39:56Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D6A6163735F48:6A6163735F48363630<\/setSpec><setSpec>\n      7375626A656374733D6A6163735F48:6A6163735F48363030<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/eprints.lincoln.ac.uk\/2704\/<\/dc:relation><dc:title>\n        Optimal PWM control of switched-capacitor DC\/DC power converters via model transformation and enhancing control techniques<\/dc:title><dc:creator>\n        Ho, Charlotte Yuk-Fan<\/dc:creator><dc:creator>\n        Ling, Bingo Wing-Kuen<\/dc:creator><dc:creator>\n        Liu, Yan-Qun<\/dc:creator><dc:creator>\n        Tam, Peter Kwong-Shun<\/dc:creator><dc:creator>\n        Teo, Kok-Lay<\/dc:creator><dc:subject>\n        H660 Control Systems<\/dc:subject><dc:subject>\n        H600 Electronic and Electrical Engineering<\/dc:subject><dc:description>\n        Abstract\u2014This paper presents an efficient and effective method\\ud\nfor an optimal pulse width modulated (PWM) control of\\ud\nswitched-capacitor DC\/DC power converters. Optimal switching\\ud\ninstants are determined based on minimizing the output ripple\\ud\nmagnitude, the output leakage voltage and the sensitivity of the\\ud\noutput load voltage with respect to both the input voltage and the\\ud\nload resistance. This optimal PWM control strategy has several\\ud\nadvantages over conventional PWM control strategies: 1) It does\\ud\nnot involve a linearization, so a large signal analysis is performed.\\ud\n2) It guarantees the optimality. The problem is solved via both the\\ud\nmodel transformation and the optimal enhancing control\\ud\ntechniques. A practical example of the PWM control of a\\ud\nswitched-capacitor DC\/DC power converter is presented.<\/dc:description><dc:publisher>\n        IEEE<\/dc:publisher><dc:date>\n        2008-06<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/eprints.lincoln.ac.uk\/2704\/1\/Optimal_PWM_Control_of_Switched-Capacitor_DC_DC_Power_Converters_via_Model.pdf<\/dc:identifier><dc:identifier>\n          Ho, Charlotte Yuk-Fan and Ling, Bingo Wing-Kuen and Liu, Yan-Qun and Tam, Peter Kwong-Shun and Teo, Kok-Lay  (2008) Optimal PWM control of switched-capacitor DC\/DC power converters via model transformation and enhancing control techniques.  IEEE Transactions on Circuits and Systems I: Regular Papers, 55  (5).   1382 -1391.  ISSN 1549-8328  <\/dc:identifier><dc:relation>\n        http:\/\/dx.doi.org\/10.1109\/TCSI.2008.916442<\/dc:relation><dc:relation>\n        10.1109\/TCSI.2008.916442<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/eprints.lincoln.ac.uk\/2704\/","http:\/\/dx.doi.org\/10.1109\/TCSI.2008.916442","10.1109\/TCSI.2008.916442"],"year":2008,"topics":["H660 Control Systems","H600 Electronic and Electrical Engineering"],"subject":["Article","PeerReviewed"],"fullText":"This article has been accepted for inclusion in a future issue. \n \n \n1\n1\n \nAbstract\u2014This paper presents an efficient and effective method \nfor an optimal pulse width modulated (PWM) control of \nswitched-capacitor DC\/DC power converters. Optimal switching \ninstants are determined based on minimizing the output ripple \nmagnitude, the output leakage voltage and the sensitivity of the \noutput load voltage with respect to both the input voltage and the \nload resistance. This optimal PWM control strategy has several \nadvantages over conventional PWM control strategies: 1) It does \nnot involve a linearization, so a large signal analysis is performed. \n2) It guarantees the optimality. The problem is solved via both the \nmodel transformation and the optimal enhancing control \ntechniques. A practical example of the PWM control of a \nswitched-capacitor DC\/DC power converter is presented. \n \nIndex Terms\u2014Optimal PWM control, switched-capacitor \nDC\/DC power converters, model transformation technique, \noptimal enhancing control technique. \nI. INTRODUCTION \nANY consumer and industrial electronic products, such as \nLCD drivers [1], pocket computer systems [2], etc, \nrequire more than one voltage sources. Hence, DC\/DC power \nconverters are required for these applications. For some \napplications, DC\/DC power converters require both low EMI \nand EMC. In these cases, inductors are not recommended to be \nManuscript received February 1, 2006; revised June 28, 2007. This work \nwas supported by a research grant (project number G-YD26) from The Hong \nKong Polytechnic University, the Centre for Multimedia Signal Processing, \nThe Hong Kong Polytechnic University, the CRGC grant (project number \nPolyU 5105\\01E) from the Research Grants Council of Hong Kong, as well as a \nresearch grant from Australian Research Council. \nCharlotte Yuk-Fan Ho is with the School of Mathematical Sciences, Queen \nMary, University of London (e-mail: c.ho@qmul.ac.uk). \nBingo Wing-Kuen Ling is with the department of Electronic Engineering, \nKing\u2019s College London (e-mail: wing-kuen.ling@kcl.ac.uk). \nYan-Qun Liu is with the Department of Mathematics and Statistics, Royal \nMelbourne Institute of Technology (e-mail: yanqun.liu@rmit.edu.au). \nPeter Kwong-Shun Tam is with the Department of Electronic and \nInformation Engineering, The Hong Kong Polytechnic University (e-mail: \nenptam@eie.polyu.edu.hk). \nKok-Lay Teo is with the Department of Mathematics and Statistics, Curtin \nUniversity of Technology (e-mail: HTK.L.Teo@curtin.edu.au TH). \nCopyright (c) 2007 IEEE. Personal use of this material is permitted. \nHowever, permission to use this material for any other purposes must be \nobtained from the IEEE by sending an email to pubs-permission@ieee.org. \nemployed for the realization. Capacitors are used instead. \nThese DC\/DC power converters are called switched-capacitor \nDC\/DC power converters or inductorless DC\/DC power \nconverters. As they could achieve both low EMI and EMC \nrequirements for many consumer and industrial electronic \nproducts, solving unaddressed problems on switched-capacitor \nDC\/DC power converters would be beneficial to the \ncommunity. \nSwitched-capacitor DC\/DC power converters consist of \nsome switches and capacitors, in which the capacitors are \nenergy storage components. At certain switching instants, some \nof the capacitors are switched to an input energy source so that \nenergy is stored in these capacitors. At the same time, another \nset of capacitors are switched to the output load and deliver \nenergy. When the switches turn on and turn off alternatively, \nthose capacitors which have released energy before, are now \nswitched to the input energy source and charged up, whilst, \nthose capacitors which have stored energy before, are now \nswitched to the output load and deliver energy. Because of this \noperating principle, ripples usually occur at the output load \nvoltage, while the ripple magnitude of the output load voltage is \ndependent on the capacitances of the capacitors, the resistance \nof the load, and the switching instants. Since almost all the \napplications require a steady voltage for their operations, the \noutput ripple magnitude should be minimized. \nSimultaneously, reverse-recovery currents of the diodes and \nthe transistors, as well as their parasitic capacitances, would \nmake the output load voltage jumping at the switching instants. \nSuch jumps at the output load voltage are called the output \nleakage voltage. Similarly, the output leakage voltage should \nalso be minimized. \nAt the same time, the load resistance would affect the time \nconstant of the discharging circuit, and the input voltage would \naffect the voltages across the capacitors in the charging circuit, \nboth the load resistance and the input voltage would affect the \noutput load voltage. From the practical point of view, the \noutput load voltage should remain unchanged even though the \nload resistance and the input voltage are changed. Hence, it is \npreferred to have a low sensitivity of the output load voltage \nwith respect to both the input voltage and the load resistance. \nOptimal PWM Control of Switched-Capacitor \nDC\/DC Power Converters via Model \nTransformation and Enhancing Control \nTechniques \nCharlotte Yuk-Fan Ho P1 P, Student Member, IEEE, Bingo Wing-Kuen LingP2 P, Yan-Qun Liu P3 P, Peter \nKwong-Shun TamP4 P, and Kok-Lay Teo P5 P, Senior Member, IEEE \nM \nThis article has been accepted for inclusion in a future issue. \n \n \n2\n2\nTherefore, the sensitivity of the output load voltage with \nrespect to both the input voltage and the load resistance should \nalso be minimized. \nThere are some existing methods for minimizing the output \nripple magnitude of a switched-capacitor DC\/DC power \nconverter, such as multirate control method [16], LQR control \nmethods [17]-[19], intelligent control method [20], and PWM \ncontrol methods [21]-[25], etc. On the other side, some \nmethods have been proposed for regulating the output load \nvoltage, such as PWM control method [32], noise shaping \nmethod [33], pseudo-continuous control method [34], \ninterleaved discharging method [35], and constant frequency \ncharge pump method [36], etc. Among them, PWM control \nmethods are the common method for both minimizing the \noutput ripple magnitude and regulating the output load voltage \nsubject to the change in the input voltage and the load \nresistance. This is because these methods exploit both the \nswitching and the nonlinear phenomena of the \nswitched-capacitor DC\/DC power converters [21]-[25], [32]. \nThe implementations of the PWM control methods can also be \nsimple [23]. However, there is one fundamental question for \nthe PWM control methods: How to determine the switching \ninstants so that the output ripple magnitude, the output leakage \nvoltage and the sensitivity of the output load voltage with \nrespect to both the input voltage and the load resistance are \nminimized? This problem is not trivial and has not been \ncompletely solved yet. The conventional PWM control \nmethods [21]-[25] are based on small signal approximation. \nThat is, the switched-capacitor DC\/DC power converter is \nmodeled as a linear time invariant system via perturbating the \nequations around a fixed point or employing a state space \naveraging model. Nevertheless, these approaches are only a \nlocal approximation of the problem and the obtained switching \ninstants are not guaranteed to be optimal. For conventional \noptimal control methods [17]-[19], optimal control signals are \ndetermined so that a smooth cost function is minimized subject \nto some smooth constraints. Note that this optimal PWM \ncontrol is different from the conventional optimal control. The \ngoal for this optimal PWM control is to determine the optimal \nswitching instants, but not to determine the optimal control \ninput signals. Moreover, the switched-capacitor DC\/DC power \nconverter switches among different topologies, so the \nswitched-capacitor DC\/DC power converter is actually \ntime-varying. Furthermore, initial conditions of the circuit \ncorresponding to each topology are non-zero at the steady state, \nso the switched-capacitor DC\/DC power converter is nonlinear. \nAn inadequate selection of the switching instants and the \nnonlinear time-varying nature of the switched-capacitor \nDC\/DC power converters may result to instability problems \n[3]-[5] or the occurrence of chaotic behaviors [6]-[15]. \nThe paper is organized as follows. The system model and the \nproblem formulation are presented in, respectively, Section II \nand Section III. A solution method is discussed in Section IV. A \npractical example of PWM control of a switched-capacitor \nDC\/DC power converter is presented in Section V. Finally, a \nconclusion is drawn in Section VI. \nII. SYSTEM MODEL \nConsider a switched-capacitor DC\/DC power converter in \nwhich it switches among different topologies with the \ndynamics of the circuit corresponding to each topology is \ncharacterized by an affine linear time invariant model. Without \nloss of generality, we assume that there are totally N  \ntopologies and 1\u2212N  switching instants within a time period, \ndenoted as [ )T,0 . Those switching instants are denoted as it  for \n1,,2,1 \u2212= Ni L . Denote 00 =t  and TtN = . During the iPthP time \ninterval [ )ii tt ,1\u2212  for Ni ,,2,1 L= , let the state space \nrepresentation of the circuit corresponding to the iPthP topology be \n( )iiiii DCBA ,,,S =  as follows: ( ) ( ) ( )tt\ndt\ntd\nii uBxA\nx += , (1a) \n( ) ( ) ( )ttty ii uDxC += , (1b) \nwhere nni\n\u00d7\u211c\u2208A , pni \u00d7\u211c\u2208B , ni \u00d7\u211c\u2208 1C  and pi \u00d7\u211c\u2208 1D , in which \nqk\u00d7\u211c  represents the set of qk \u00d7  real matrices, the state vector \n( ) 1\u00d7\u211c\u2208 ntx  represents the voltages across the capacitors, \n( ) \u211c\u2208ty  and ( ) 1\u00d7\u211c\u2208 ptu  represent the voltage across the load \nresistor and the input voltages of the switched-capacitor \nDC\/DC power converter, respectively, where n\u211c  and \u211c  \ndenote the sets of n -dimensional real vectors and real numbers, \nrespectively. \nIII. PROBLEM FORMULATION \nThe output ripple magnitude of the switched-capacitor \nDC\/DC power converter at the iPthP time interval [ )ii tt ,1\u2212  for \nNi ,,2,1 L=  is [ ) ( ) [ ) ( )tyty iiii tttttt ,, 11 minmax \u2212\u2212 \u2208\u2208 \u2212 . Hence, the output ripple \nmagnitude of the switched-capacitor DC\/DC power converter \ncan be defined as \n[ ) ( ) [ ) ( )\u239f\u23a0\u239e\u239c\u239d\u239b \u2212 \u2212\u2212 \u2208\u2208\u2264\u2264 tyty iiii ttttttNi ,,1 11 minmaxmax . For a \nswitched-capacitor DC\/DC power converter, it is preferred to \nhave small values of the output ripple magnitude. Hence, \n[ ) ( ) [ ) ( )\u239f\u23a0\u239e\u239c\u239d\u239b \u2212 \u2212\u2212 \u2208\u2208\u2264\u2264 tyty iiii ttttttNi ,,1 11 minmaxmax  should be minimized. \nAt the iPthP switching instant, where 1,,2,1 \u2212= Ni L , a state \nleakage voltage, denoted as ( )0\u2212\u0394 itx , is expected. Without \nloss of generality, it can be expressed as: \n( ) ( ) ( ) ( )( ) ( )0000 \u2212\u2212\u2212=\u2212\u2212=\u2212\u0394 iiiiii ttttt xx\u03c6xxx , (2) \nwhere i\u03c6  for 1,,2,1 \u2212= Ni L  is supposed to be a continuously \ndifferentiable function. In general, the state leakage voltage is \ntoo complicated to be represented mathematically. Instead, we \napproximate i\u03c6  for 1,,2,1 \u2212= Ni L  experimentally. Firstly, \ncapacitors are charged up to different voltages. Then these \ncapacitors are detached from the switched-capacitor DC\/DC \npower converter and the voltage changes across these \ncapacitors are recorded instantaneously. The voltage changes \nand the voltages across these capacitors correspond to the \nvalues of ( )0\u2212\u0394 itx  and ( )0\u2212itx , respectively. By fitting a \nThis article has been accepted for inclusion in a future issue. \n \n \n3\n3\npolynomial to approximate the relationship between ( )0\u2212\u0394 itx  \nand ( )0\u2212itx , an approximation of i\u03c6  for 1,,2,1 \u2212= Ni L  \ncould be obtained accordingly. And the output load voltage at \nthe switching instants is: ( ) ( )( ) ( ) ( ) ( )000 \u2212\u0394+\u2212=+\u2212= iiiiiiii tytyttty uDx\u03c6C  \nfor 1,,2,1 \u2212= Ni L . The output leakage voltage at the iPthP \nswitching instant for 1,,2,1 \u2212= Ni L  is ( ) ( )0\u2212\u2212 ii tyty , so the \noutput leakage voltage of the switched-capacitor DC\/DC power \nconverter can be defined as ( ) ( )0max\n11\n\u2212\u2212\n\u2212\u2264\u2264 iiNi\ntyty , where \u22c5  \ndenotes the absolute operator. Similarly, it is preferred to have \nsmall values of the output leakage voltage. Hence, \n( ) ( )0max\n11\n\u2212\u2212\n\u2212\u2264\u2264 iiNi\ntyty  should be minimized. \nDenote the load resistance as LR  and the gradient operator as \n\u2207 . Then, the sensitivity of the output load voltage with respect \nto the load resistance and the input voltage at a particular time \ninstant t  within the iPthP time interval [ )ii tt ,1\u2212  for Ni ,,2,1 L=  \nare, respectively, ( )\nLdR\ntdy  and ( ) ( )\u221e\u2207 tytu . Hence, the sensitivity \nof the output load voltage with respect to the load resistance \nand the input voltage can be defined as, respectively, \n[ )\n( )\nL\ntttNi dR\ntdy\nii ,1 1\nmaxmax\n\u2212\u2208\u2264\u2264\n and \n[ ) ( ) ( )\u221e\u2208\u2264\u2264 \u2207\u2212 tyttttNi ii u,1 1maxmax . As discussed in \nSection I, these two terms should be minimized. \nLet [ ] 1121 ,,, \u2212\u2212 \u211c\u2208= NTNttt L\u03be , and { }NNN ttttt \u2264\u2264\u2264\u2264\u2264\u211c\u2208=\u2111 \u2212\u2212 12101 : L\u03be . (3) \nThe optimal PWM control problem becomes the determination \nof the optimal switching instants \u2111\u2208\u03be  so that the output ripple \nmagnitude, the output leakage voltage and the sensitivity of the \noutput load voltage with respect to both the load resistance and \nthe input voltage are minimized. This problem is a \nmultiple-objectives optimization problem. The most common \nmethod for solving a multiple-objectives optimization problem \nis to convert it to a single-objective optimization problem with \nthe cost function being a weighted combination of these \nmultiple objectives. Denote i\u03b2 \u2032  for  4,,2,1 L=i  as the weights \nfor combining these multiple objectives. Then the problem can \nbe expressed as follows: \nProblem (P) \n( ) [ ) ( ) [ ) ( ) ( ) ( )\n[ )\n( )\n[ ) ( ) ( )\u221e\u2208\u2264\u2264\u2208\u2264\u2264\n\u2212\u2264\u2264\u2208\u2208\u2264\u2264\u2111\u2208\n\u2207\u2032+\u2032+\n\u2212\u2212\u2032+\u239f\u23a0\n\u239e\u239c\u239d\n\u239b \u2212\u2032=\n\u2212\u2212\n\u2212\u2212\nty\ndR\ntdy\ntytytytyJ\nttttNi\nL\ntttNi\niiNittttttNi\niiii\niiii\nu\n\u03be\n\u03be\n,14,13\n112,,11\n11\n11\nmaxmaxmaxmax\n0maxminmaxmaxmin\n\u03b2\u03b2\n\u03b2\u03b2 ,(4a) \nsubject to ( ) ( ) ( )tt\ndt\ntd\nii uBxA\nx +=  for [ )ii ttt ,1\u2212\u2208  and for Ni ,,2,1 L= , (4b) \n( ) ( ) ( )ttty ii uDxC +=  for [ )ii ttt ,1\u2212\u2208  and for Ni ,,2,1 L= , (4c) \n( ) 00 xx =t , (4d) \nand \n( ) ( )( ) ( ) ( )000 \u2212\u0394+\u2212=\u2212= iiiii tttt xxx\u03c6x  for 1,,2,1 \u2212= Ni L .(4e) \nIV. SOLUTION METHOD \nA. Model transformation method \nProblem (P) is a min-max problem, which involves a \nnon-differentiable cost function. To address this problem, since \n1) minimizing the maximum value of a function ( )u,tf  over \nthe index set \u03a9  is equivalent to minimizing a parameter v  \nsubject to all functional values over the index set being smaller \nthan or equal to v , that is ( )u\nu\n,maxmin tf\nt \u03a9\u2208\n is equivalent to \nu\nmin  \nv  subject to ( ) vtf \u2264u,  \u03a9\u2208\u2200t , and 2) maximizing the \nminimum value of a function over the index set is equivalent to \nminimizing a parameter v  subject to the negative of all \nfunctional values over the index set being smaller than or equal \nto v , that is ( )u\nu\n,minmax tf\nt \u03a9\u2208\n is equivalent to \nu\nmin  v  subject to \n( ) vtf \u2264\u2212 u,  \u03a9\u2208\u2200t , minimizing the maximum absolute value \nof a function over the index set is equivalent to minimizing a \nparameter v  subject to both the positive and the negative of all \nfunctional values over the index set being smaller than or equal \nto v , that is ( )u\nu\n,maxmin tf\nt \u03a9\u2208\n is equivalent to \nu\nmin  v  subject to \nboth ( ) vtf \u2264u,  \u03a9\u2208\u2200t  and ( ) vtf \u2264\u2212 u,  \u03a9\u2208\u2200t . Also, \nminimizing the difference between the maximum and minimum \nvalues of a function over the index set is equivalent to \nminimizing a parameter 1v  subject to all functional values over \nthe index set being smaller than or equal to 1v  and minimizing a \nparameter 2v  subject to the negative of all functional values \nover the index set being smaller than or equal to 2v , that is \n( ) ( )( )uu\nu\n,min,maxmin tftf\ntt \u03a9\u2208\u03a9\u2208\n\u2212  is equivalent to \nu\nmin  1v  subject to \n( ) 1, vtf \u2264u  \u03a9\u2208\u2200t  and \nu\nmin  2v  subject to ( ) 2, vtf \u2264\u2212 u  \u03a9\u2208\u2200t . \nHence, Problem (P) can be converted into a smooth continuous \nconstrained optimization problem. Denote the set of the fifth \ndimensional real vectors as 5\u211c . Let [ ]Tvvvvv 54321\u2261v  \nbe a vector in 5\u211c . Similarly, denote i\u03b2  for  5,,2,1 L=i  as the \nweights for combining the multiple objectives. Denote \n( ) ( ) ( )[ ]Tp tutut L1\u2261u . Then Problem (P) is equivalent to the \nfollowing problem: \nProblem (Q) \n5,\nmin\n\u211c\u2208\u2111\u2208 v\u03be\n ( ) \u2211\n=\n=\n5\n1\n,\u02c6\ni\niivJ \u03b2v\u03be , (5a) \nsubject to ( ) 1vty \u2264  [ )ii ttt ,1\u2212\u2208\u2200  and for Ni ,,2,1 L= , (5b) \n( ) 2vty \u2264\u2212  [ )ii ttt ,1\u2212\u2208\u2200  and for Ni ,,2,1 L= , (5c) \n( ) ( ) 30 vtyty ii \u2264\u2212\u2212  for 1,,2,1 \u2212= Ni L , (5d) \n( ) ( ) 30 vtyty ii \u2264\u2212\u2212  for 1,,2,1 \u2212= Ni L , (5e) ( )\n4vdR\ntdy\nL\n\u2264  [ )ii ttt ,1\u2212\u2208\u2200  and for Ni ,,2,1 L= , (5f) \n( )\n4vdR\ntdy\nL\n\u2264\u2212  [ )ii ttt ,1\u2212\u2208\u2200  and for Ni ,,2,1 L= , (5g) \n( )\n( ) 5vtu\nty\nk\n\u2264\u2202\n\u2202  [ )ii ttt ,1\u2212\u2208\u2200 , for Ni ,,2,1 L=  and for pk ,,2,1 L= ,(5h) \nThis article has been accepted for inclusion in a future issue. \n \n \n4\n4\n( )\n( ) 5vtu\nty\nk\n\u2264\u2202\n\u2202\u2212  [ )ii ttt ,1\u2212\u2208\u2200 , for Ni ,,2,1 L=  and for pk ,,2,1 L= ,(5i) \n( ) ( ) ( )tt\ndt\ntd\nii uBxA\nx +=  for [ )ii ttt ,1\u2212\u2208  and for Ni ,,2,1 L= , (5j) \n( ) ( ) ( )ttty ii uDxC +=  for [ )ii ttt ,1\u2212\u2208  and for Ni ,,2,1 L= , (5k) \n( ) 00 xx = , (5l) \nand \n( ) ( )( ) ( ) ( )000 \u2212\u0394+\u2212=\u2212= iiiii tttt xxx\u03c6x  for 1,,2,1 \u2212= Ni L .(5m) \nThis approach for solving optimization problems with a \nmin-max cost function is called the model transformation \nmethod [26]. \nB. Enhancing control method \nSince the switching instants are generally located \nnonuniformly in the switching period, it is required to map the \noriginal time instant t  to a transformed time instant s  so that \nthere is a one-to-one correspondence between t  and s , and the \ntransformed switching instants are uniformly located in the real \nnumber line. To achieve this goal, we need the original \nswitching instants it  for 1,,2,1 \u2212= Ni L  being mapped to the \nconsecutive integer instants i , and [ )ii ttt ,1\u2212\u2208\u2200 , t  being \nmapped linearly to [ )iis ,1\u2212\u2208 . First, denote \n[ )( ) [ )\u23a9\u23a8\n\u23a7 \u2212\u2208=\u2212 otherwise\niis\nsii 0\n,11\n,1\u03c7  for Ni ,,2,1 L=  as a unit square \npulse with the time support located at the time interval [ )ii ,1\u2212  . \nDefine the switching durations as 1\u2212\u2212\u2261 iii tt\u03c4  for Ni ,,2,1 L= . \nDefine a vector [ ]TN\u03c4\u03c4\u03c4 ,,, 21 L=\u03c4 . Define \n( ) [ ) \u211c\u2192\u22c5 N,0:| \u03c4\u03bc  as a rectangular pulse train with the \nmagnitude of the pulse train within the time interval [ )ii ,1\u2212  \nbeing constant and equal to i\u03c4  for Ni ,,2,1 L= , that is: \n( ) [ )( )\u2211\n=\n\u2212=\nN\ni\niii ss\n1\n,1| \u03c7\u03c4\u03bc \u03c4 . (6) \nLet ( ) \u23ad\u23ac\n\u23ab\n\u23a9\u23a8\n\u23a7 ==\u2265\u22c5=\u039b \u2211\n=\nTNi\nN\ni\nii\n1\n and ,,1for  0:| \u03c4\u03c4\u03bc L\u03c4 . Define \n( )\u03c4\u03c4 |: \u22c5\u03bcaU  as follows: \n( ) \u03bc=\u03c4U . (7) \nU  is a function that maps the vector \u03c4  to the rectangular pulse \ntrain function ( )\u03c4|s\u03bc . It is worth noting that the switching \ninstants of ( )\u03c4|s\u03bc  are uniformly located at the consecutive \ninteger instants 1,,2,1 \u2212= Ns L . The original switching \ndurations i\u03c4  for Ni ,,2,1 L=  are the magnitudes of the \nfunction ( )\u03c4|s\u03bc  for [ )iis ,1\u2212\u2208 , that is ( ) is \u03c4\u03c4\u03bc =|  for [ )iis ,1\u2212\u2208  and for Ni ,,2,1 L= . However, ( )\u03c4|s\u03bc  is not \ncontinuous and the relationship between t  and s  is not \ninvertible. To address this problem, define \n( ) [ ) [ )TNt ,0,0:| \u2192\u22c5 \u03bc  as a piecewise linear function with the \nslope of the function in the time interval [ )ii ,1\u2212  being constant \nand equal to i\u03c4  for Ni ,,2,1 L= , that is: \n( ) ( )\u222b= s dst 0 || \u03b8\u03b8\u03bc\u03bc \u03c4 . (8) \nNoting that the switching instants of ( )\u03bc|st  are also uniformly \nlocated at the consecutive integer instants 1,,2,1 \u2212= Ns L , the \noriginal switching instants it  for 1,,2,1 \u2212= Ni L  are the value \nof ( )\u03bc|st  at the switching instants 1,,2,1 \u2212= Ns L , that is \n( ) itit =\u03bc|  for 1,,2,1 \u2212= Ni L , ( )\u03bc|st  is continuous and there \nis a linear relationship between any time instant [ )ii ttt ,1\u2212\u2208  and \na nonnegative real number [ )iis ,1\u2212\u2208  for Ni ,,2,1 L= . Let \n( )\u03bc|sz  and ( )\u03bc|sw  be, respectively, the transformed state \nvector and the transformed output, in which the switching \ninstants of both ( )\u03bc|sz  and ( )\u03bc|sw  are uniformly located at \nthe consecutive integer instants, that is ( ) ( )( )\u03c4xz ||| \u03bc\u03bc sts =  \nand ( ) ( )( )\u03c4y ||| \u03bc\u03bc stsw = . Since ( ) ( )\u03c4|| sst\nds\nd \u03bc\u03bc =  for \nisi <<\u22121  and for Ni ,,2,1 L= , define the following problem: \nProblem (R) \n5,\nmin\n\u211c\u2208\u2111\u2208 v\u03be\n ( ) \u2211\n=\n=\n5\n1\n,~\ni\niivJ \u03b2v\u03be , (9a) \nsubject to ( )( ) 1| vstw \u2264\u03bc  for [ )iis ,1\u2212\u2208  and for Ni ,,2,1 L= ,(9b) ( )( ) 2| vstw \u2264\u2212 \u03bc  for [ )iis ,1\u2212\u2208  and for Ni ,,2,1 L= , (9c) ( )( ) ( )( ) 3|0| vitwitw \u2264\u2212\u2212 \u03bc\u03bc  for 1,,2,1 \u2212= Ni L , (9d) \n( )( ) ( )( ) 3||0 vitwitw \u2264\u2212\u2212 \u03bc\u03bc  for 1,,2,1 \u2212= Ni L , (9e) ( )( )\n4\n| v\ndR\nstdw\nL\n\u2264\u03bc  for [ )iis ,1\u2212\u2208  and for Ni ,,2,1 L= , (9f) \n( )( )\n4\n| v\ndR\nstdw\nL\n\u2264\u2212 \u03bc  for [ )iis ,1\u2212\u2208  and for Ni ,,2,1 L= , (9g) \n( )( )\n( )( ) 5|\n| v\nstu\nstw\nk\n\u2264\u2202\n\u2202\n\u03bc\n\u03bc  for [ )iis ,1\u2212\u2208 , for Ni ,,2,1 L=  and for \npk ,,2,1 L= , (9h) \n( )( )\n( )( ) 5|\n| v\nstu\nstw\nk\n\u2264\u2202\n\u2202\u2212 \u03bc\n\u03bc  for [ )iis ,1\u2212\u2208 , for Ni ,,2,1 L=  and for \npk ,,2,1 L= , (9i) \n( ) ( ) ( )( ) ( )( )( )\u03bc\u03bc\u03bc\u03bc |||| ststss\nds\nd\nii uBzA\u03c4z +=  for [ )iis ,1\u2212\u2208  \nand for Ni ,,2,1 L= , (9j) \n( )( ) ( )( ) ( )( )\u03bc\u03bc\u03bc ||| stststw ii uDzC +=  for [ )iis ,1\u2212\u2208  and for \nNi ,,2,1 L= , (9k) \n( )( ) 0|0 xz =\u03bct , (9l) \nand \n( )( ) ( )( )( ) ( )( ) ( )( )\u03bc\u03bc\u03bc\u03bc |0|0|0| \u2212\u0394+\u2212=\u2212= itititit i zzz\u03c6z  for \n1,,2,1 \u2212= Ni L . (9m) \nTheorem 1 \nProblem (Q) and Problem (R) are equivalent in the sense that ( )\u2217\u2217 v\u03be ,  is a solution of Problem (Q) if and only if ( )\u2217\u2217 v,\u03bc  is a \nsolution of Problem (R), where ( ) \u2217\u2217 = \u03bc\u03c4U , in which \n[ ]TN\u2217\u2217\u2217\u2217 = \u03c4\u03c4\u03c4 ,,, 21 L\u03c4 , [ ]TNttt \u2217 \u2212\u2217\u2217\u2217 = 121 ,,, L\u03be and \u2217\u2212\u2217\u2217 \u2212= 1iii tt\u03c4 . \nFurthermore, ( ) ( )\u2217\u2217\u2217\u2217 = vv\u03be ,~,\u02c6 \u03bcJJ . \nProof: \nThis article has been accepted for inclusion in a future issue. \n \n \n5\n5\nIt is clear that ( )\u2217\u2217 v\u03be ,  satisfies (5b)-(5m) if and only if ( ) \u2217\u2217 = \u03bc\u03c4U . Hence, ( )\u2217\u2217 v\u03be ,  is a solution of Problem (Q) if and \nonly if ( )\u2217\u2217 v,\u03bc  is a solution of Problem (R). Furthermore, from \n(5a) and (9a), we can easily verify that ( ) ( )\u2217\u2217\u2217\u2217 = vv\u03be ,~,\u02c6 \u03bcJJ . \u0084 \nThis method is called the enhancing control method \n[26]-[28]. \nC. Solving state jump problem \nThe discontinuities of the state variables are handled by \ncomputing the state variables segment by segment [29]. The \nvalue of the initial condition of the current segment can be \ncomputed by the value of the state variables at the end of the \nprevious segment. To find ( )( )\u03bc|itz  for 1,,2,1 \u2212= Ni L , we \nfirst compute the value of ( )( )\u03bc|01\u2212tz  using the initial \ncondition ( )( )\u03bc|0tz . Then ( )( )\u03bc|1tz  can be evaluated by the \nequation ( )( ) ( )( )( )\u03bc\u03bc |01|1 1 \u2212= tt z\u03c6z . Similarly, ( )( )\u03bc|02 \u2212tz  \ncan be computed using ( )( )\u03bc|1tz , and ( )( )\u03bc|2tz  can be \nevaluated by the equation ( )( ) ( )( )( )\u03bc\u03bc |02|2 2 \u2212= tt z\u03c6z . These \nprocedures are repeated until all the values of ( )( )\u03bc|itz  for \n1,,2,1 \u2212= Ni L  are computed. \nD. Evaluation of the sensitivity of the output load voltage \nSince the response of the circuit corresponding to each \ntopology depends on the matrix exponential and it is difficult to \nevaluate the sensitivity of the output load voltage with respect \nto both the input voltage and the load resistance based on the \nmatrix exponential, the Cayley Hamilton Theorem is applied. \nSuppose that iA  for Ni ,,2,1 L=  are diagonalizable. Denote \nthe eigenvalues of iA  as ki ,\u03bb  for nk ,,2,1 L=  and for \nNi ,,2,1 L= . Define \n( )\n( ) \u23a5\u23a5\n\u23a5\n\u23a6\n\u23a4\n\u23a2\u23a2\n\u23a2\n\u23a3\n\u23a1\n\u23a5\u23a5\n\u23a5\n\u23a6\n\u23a4\n\u23a2\u23a2\n\u23a2\n\u23a3\n\u23a1\n\u2261\n\u23a5\u23a5\n\u23a5\n\u23a6\n\u23a4\n\u23a2\u23a2\n\u23a2\n\u23a3\n\u23a1 \u2212\n\u2212\n\u2212\nt\nt\nn\nni\nn\ni\nni\ni\nni\ni\ne\ne\nt\nt\n,\n1,\n1\n1\n,\n1\n1,\n,\n1,\n1\n1\n\u03bb\n\u03bb\n\u03bb\n\u03bb\n\u03b1\n\u03b1\nM\nL\nMOM\nL\nM  \nand \n1\n1\n,\n1\n1,\n,,1,,\n,1,1,1,\n1\n1\n\u2212\n\u2212\n\u2212\n\u23a5\u23a5\n\u23a5\n\u23a6\n\u23a4\n\u23a2\u23a2\n\u23a2\n\u23a3\n\u23a1\n\u2261\n\u23a5\u23a5\n\u23a5\n\u23a6\n\u23a4\n\u23a2\u23a2\n\u23a2\n\u23a3\n\u23a1\nn\nni\nn\ni\nnnini\nnii\n\u03bb\n\u03bb\n\u03ba\u03ba\n\u03ba\u03ba\nL\nMOM\nL\nL\nMOM\nL\n \nfor [ )ii ttt ,1\u2212\u2208  and for Ni ,,2,1 L= . Then by the Cayley \nHamilton Theorem, \n( ) \u2211\u2211\u2211\n= =\n\u2212\n=\n\u2212 ==\nn\nj\nn\nk\nj\ni\nt\nkji\nn\nj\nj\niji\nt kii ete\n1 1\n1\n,,\n1\n1\n,\n, AAA \u03bb\u03ba\u03b1  \nfor [ )ii ttt ,1\u2212\u2208  and for Ni ,,2,1 L= . Hence, \n( ) ( ) ( )\n( ) ( )\u222b \u2211\u2211\n\u2211\u2211\n\u2212\n\u2212\n= =\n\u2212\u2212\n= =\n\u2212\n\u2212\u2212 +=\nt\nt\nn\nj\nn\nk\ni\nj\ni\nt\nkji\nn\nj\nn\nk\ni\nj\ni\ntt\nkji\ni\nki\niki\nde\ntet\n1\n,\n1,\n1 1\n1\n,,\n1 1\n1\n1\n,,\n\u03c4\u03c4\u03ba\n\u03ba\n\u03c4\u03bb\n\u03bb\nuBA\nxAx\n \nand \n( ) ( ) ( )\n( ) ( ) ( )tde\ntety\ni\nt\nt\nn\nj\nn\nk\ni\nj\ni\nt\nkjii\nn\nj\nn\nk\ni\nj\ni\ntt\nkjii\ni\nki\niki\nuDuBAC\nxAC\n+\n+=\n\u222b \u2211\u2211\n\u2211\u2211\n\u2212\n\u2212\n= =\n\u2212\u2212\n= =\n\u2212\n\u2212\u2212\n1\n,\n1,\n1 1\n1\n,,\n1 1\n1\n1\n,,\n\u03c4\u03c4\u03ba\n\u03ba\n\u03c4\u03bb\n\u03bb\n \nfor [ )ii ttt ,1\u2212\u2208  and for Ni ,,2,1 L= . Consequently, \n( ) ( ) ( )\n( ) ( )\u222b \u2211\u2211\n\u2211\u2211\n\u2212\n= =\n\u2212\u2212\n= =\n\u2212\n\u2212\u2212\n\u2212\n\u2212 +=\u2212\n0\n1 1\n1\n,,\n1 1\n1\n1\n,,\n1\n,\n1,0\ni\ni\niki\niiki\nt\nt\nn\nj\nn\nk\ni\nj\ni\nt\nkji\nn\nj\nn\nk\ni\nj\ni\ntt\nkjii\nde\ntet\n\u03c4\u03c4\u03ba\n\u03ba\n\u03c4\u03bb\n\u03bb\nuBA\nxAx\n \nand \n( ) ( ) ( )\n( ) ( ) ( )0\n0\n0\n1 1\n1\n,,\n1 1\n1\n1\n,,\n1\n,\n1,\n\u2212+\n+=\u2212\n\u222b \u2211\u2211\n\u2211\u2211\n\u2212\n= =\n\u2212\u2212\n= =\n\u2212\n\u2212\u2212\n\u2212\n\u2212\nii\nt\nt\nn\nj\nn\nk\ni\nj\ni\nt\nkjii\nn\nj\nn\nk\ni\nj\ni\ntt\nkjiii\ntde\ntety\ni\ni\niki\niiki\nuDuBAC\nxAC\n\u03c4\u03c4\u03ba\n\u03ba\n\u03c4\u03bb\n\u03bb\n \nfor 1,,2,1 \u2212= Ni L . Denote \n( ) ( ) ( )[ ] ( )\u222b \u2211\u2211\u2212 = = \u2212\u2212\u2261\u2261 tt\nn\nj\nn\nk\ni\nj\ni\nt\nkjii\nT\npiii\ni\nki detdtdt\n1\n,\n1 1\n1\n,,,1,\n~~~ \u03c4\u03ba \u03c4\u03bb BACD L  \nfor [ )ii ttt ,1\u2212\u2208  and for Ni ,,2,1 L= , and denote [ ]Tpiii dd ,1, L\u2261D  for Ni ,,2,1 L= . \nThen ( )\n( ) ( ) kikik dtdtu\nty\n,,\n~ +\u2248\u2202\n\u2202  [ )ii ttt ,1\u2212\u2208\u2200 , for Ni ,,2,1 L=  and for \npk ,,2,1 L= . (10a) \nDenote \n\u23a5\u23a5\n\u23a5\n\u23a6\n\u23a4\n\u23a2\u23a2\n\u23a2\n\u23a3\n\u23a1\n\u2261\n\u2212\u2212\n\u2212\u2212\n\u2212\n1,\n,\n1,\n1,\n1,\n,1\n1,\n1,1\n1\nji\nnn\nji\nn\nji\nn\nji\nj\ni\naa\naa\nL\nMOM\nL\nA  for Ni ,,2,1 L=  and for \nnj ,,2,1 L= . Denote \n\u23a5\u23a5\n\u23a5\n\u23a6\n\u23a4\n\u23a2\u23a2\n\u23a2\n\u23a3\n\u23a1\n\u2261\npnini\npii\ni\nbb\nbb\n,,1,,\n,1,1,1,\nL\nMOM\nL\nB , [ ]niii cc ,1, L\u2261C  \nand ( ) ( ) ( )[ ]Tiniiiii txtxt 1,11,1 \u2212\u2212\u2212 \u2261 Lx  for Ni ,,2,1 L= . Then: \n( ) ( ) ( ) ( )\u2211\u2211\u2211\u2211\u2211\u2211\n= = = =\n\u2212\n\u2212\u2212\n= =\n\u2212\n\u2212\u2212 \u2212\u2212 =\nn\nm\nn\nl\nn\nj\nn\nk\nimi\nji\nml\ntt\nkjili\nn\nj\nn\nk\ni\nj\ni\ntt\nkjii txaecte ikiiki\n1 1 1 1\n1,\n1,\n,,,,\n1 1\n1\n1\n,,\n1,1, \u03bb\u03bb \u03ba\u03ba xAC , \n( ) ( )\n( ) ( )\u2211\u2211\u2211\u2211\u2211\u222b\n\u222b \u2211\u2211\n= = = = =\n\u2212\u2212\n= =\n\u2212\u2212\n\u2212\n\u2212\n=\np\nq\nn\nm\nn\nl\nn\nj\nn\nk\nt\nt qqmi\nji\nml\nt\nkjili\nt\nt\nn\nj\nn\nk\ni\nj\ni\nt\nkjii\ni\nki\ni\nki\ndubaec\nde\n1 1 1 1 1\n,,\n1,\n,,,,\n1 1\n1\n,,\n1\n,\n1\n,\n\u03c4\u03c4\u03ba\n\u03c4\u03c4\u03ba\n\u03c4\u03bb\n\u03c4\u03bb uBAC\n, \nand ( ) ( )\u2211\n=\n=\np\nq\nqqi tudt\n1\nuD  [ )ii ttt ,1\u2212\u2208\u2200  and for Ni ,,2,1 L= . \nHence, \n( ) ( )\n( ) ( )\n( ) ( ) ( )+\u239f\u239f\u23a0\n\u239e\n\u239c\u239c\u239d\n\u239b\n\u2202\n\u2202\u2212\n+\u239f\u239f\u23a0\n\u239e\n\u239c\u239c\u239d\n\u239b\n\u2202\n\u2202\n=\u2202\n\u2202\n\u2211\u2211\u2211\u2211\n\u2211\u2211\u2211\u2211\n\u2211\u2211\n= = = =\n\u2212\n\u2212\u2212\n\u2212\n= = = =\n\u2212\n\u2212\n\u2212\n= =\n\u2212\n\u2212\u2212\n\u2212\n\u2212\n\u2212\nn\nm\nn\nl\nn\nj\nn\nk\nimi\nji\nml\ntt\nL\nki\nikjili\nn\nm\nn\nl\nn\nj\nn\nk\nimi\nL\nji\nmltt\nkjili\nn\nj\nn\nk\ni\nj\ni\ntt\nkjii\nL\ntxae\nR\nttc\ntx\nR\na\nec\nte\nR\niki\niki\niki\n1 1 1 1\n1,\n1,\n,\n,\n1,,,\n1 1 1 1\n1,\n1,\n,\n,,,\n1 1\n1\n1\n,,\n1,\n1,\n1,\n\u03bb\n\u03bb\n\u03bb\n\u03bb\u03ba\n\u03ba\n\u03ba xAC\n \nThis article has been accepted for inclusion in a future issue. \n \n \n6\n6\n( ) ( )\n( ) ( )\u2211\u2211\u2211\u2211\n\u2211\u2211\u2211\u2211\n= = = =\n\u2212\n\u2212\u2212\n= = = =\n\u2212\n\u2212\u2212\n\u2212\n\u2212\n\u239f\u239f\u23a0\n\u239e\n\u239c\u239c\u239d\n\u239b\n\u2202\n\u2202\n+\u239f\u239f\u23a0\n\u239e\n\u239c\u239c\u239d\n\u239b\n\u2202\n\u2202\nn\nm\nn\nl\nn\nj\nn\nk\nimi\nji\nml\ntt\nkji\nL\nli\nn\nm\nn\nl\nn\nj\nn\nk\nimi\nji\nml\ntt\nL\nkji\nli\ntxae\nR\nc\ntxae\nR\nc\niki\niki\n1 1 1 1\n1,\n1,\n,,,\n,\n1 1 1 1\n1,\n1,\n,\n,,\n,\n1,\n1,\n\u03bb\n\u03bb\n\u03ba\n\u03ba\n, \n( ) ( )\n( ) ( )\n( ) ( )\n( ) ( ) ( )\n( ) ( )\n( ) ( )\u2211\u2211\u2211\u2211\u2211\u222b\n\u2211\u2211\u2211\u2211\u2211\u222b\n\u2211\u2211\u2211\u2211\u2211\u222b\n\u2211\u2211\u2211\u2211\u2211\u222b\n\u2211\u2211\u2211\u2211\u2211\u222b\n\u222b \u2211\u2211\n= = = = =\n\u2212\u2212\n= = = = =\n\u2212\n\u2212\n= = = = =\n\u2212\u2212\n= = = = =\n\u2212\u2212\n= = = = =\n\u2212\u2212\n= =\n\u2212\u2212\n\u2212\n\u2212\n\u2212\n\u2212\n\u2212\n\u2212\n\u239f\u239f\u23a0\n\u239e\n\u239c\u239c\u239d\n\u239b\n\u2202\n\u2202\n+\u239f\u239f\u23a0\n\u239e\n\u239c\u239c\u239d\n\u239b\n\u2202\n\u2202\n+\u239f\u239f\u23a0\n\u239e\n\u239c\u239c\u239d\n\u239b\n\u2202\n\u2202\u2212\n+\u239f\u239f\u23a0\n\u239e\n\u239c\u239c\u239d\n\u239b\n\u2202\n\u2202\n+\u239f\u239f\u23a0\n\u239e\n\u239c\u239c\u239d\n\u239b\n\u2202\n\u2202\n=\u2202\n\u2202\np\nq\nn\nm\nn\nl\nn\nj\nn\nk\nt\nt q\nL\nqmiji\nml\nt\nkjili\np\nq\nn\nm\nn\nl\nn\nj\nn\nk\nt\nt qqmi\nL\nji\nmlt\nkjili\np\nq\nn\nm\nn\nl\nn\nj\nn\nk\nt\nt qqmi\nji\nml\nt\nL\nki\nkjili\np\nq\nn\nm\nn\nl\nn\nj\nn\nk\nt\nt qqmi\nji\nml\nt\nL\nkji\nli\np\nq\nn\nm\nn\nl\nn\nj\nn\nk\nt\nt qqmi\nji\nml\nt\nkji\nL\nli\nt\nt\nn\nj\nn\nk\ni\nj\ni\nt\nkjii\nL\ni\nki\ni\nki\ni\nki\ni\nki\ni\nki\ni\nki\ndu\nR\nb\naec\ndub\nR\na\nec\ndubae\nR\ntc\ndubae\nR\nc\ndubae\nR\nc\nde\nR\n1 1 1 1 1\n,,1,\n,,,,\n1 1 1 1 1\n,,\n1,\n,\n,,,\n1 1 1 1 1\n,,\n1,\n,\n,\n,,,\n1 1 1 1 1\n,,\n1,\n,\n,,\n,\n1 1 1 1 1\n,,\n1,\n,,,\n,\n1 1\n1\n,,\n1\n,\n1\n,\n1\n,\n1\n,\n1\n,\n1\n,\n\u03c4\u03c4\u03ba\n\u03c4\u03c4\u03ba\n\u03c4\u03c4\u03bb\u03c4\u03ba\n\u03c4\u03c4\u03ba\n\u03c4\u03c4\u03ba\n\u03c4\u03c4\u03ba\n\u03c4\u03bb\n\u03c4\u03bb\n\u03c4\u03bb\n\u03c4\u03bb\n\u03c4\u03bb\n\u03c4\u03bb uBAC\n, \nand ( ) ( )\u2211\n= \u239f\n\u239f\n\u23a0\n\u239e\n\u239c\u239c\u239d\n\u239b\n\u2202\n\u2202=\u2202\n\u2202 p\nq\nq\nL\nq\ni\nL\ntu\nR\nd\nt\nR 1\nuD  [ )ii ttt ,1\u2212\u2208\u2200  and for \nNi ,,2,1 L= . Consequently, we have: \n( ) ( ) ( )\n( ) ( ) ( )\n( ) ( )\n( ) ( )\n( ) ( )\n( ) ( )\n( ) ( ) ( )\n( ) ( )\n( ) ( )\n( )\u2211\n\u2211\u2211\u2211\u2211\u2211\u222b\n\u2211\u2211\u2211\u2211\u2211\u222b\n\u2211\u2211\u2211\u2211\u2211\u222b\n\u2211\u2211\u2211\u2211\u2211\u222b\n\u2211\u2211\u2211\u2211\u2211\u222b\n\u2211\u2211\u2211\u2211\n\u2211\u2211\u2211\u2211\n\u2211\u2211\u2211\u2211\n\u2211\u2211\u2211\u2211\n=\n= = = = =\n\u2212\u2212\n= = = = =\n\u2212\n\u2212\n= = = = =\n\u2212\u2212\n= = = = =\n\u2212\u2212\n= = = = =\n\u2212\u2212\n= = = =\n\u2212\n\u2212\u2212\n= = = =\n\u2212\n\u2212\u2212\n= = = =\n\u2212\n\u2212\u2212\n\u2212\n= = = =\n\u2212\n\u2212\n\u2212\n\u239f\u239f\u23a0\n\u239e\n\u239c\u239c\u239d\n\u239b\n\u2202\n\u2202\n+\u239f\u239f\u23a0\n\u239e\n\u239c\u239c\u239d\n\u239b\n\u2202\n\u2202\n+\u239f\u239f\u23a0\n\u239e\n\u239c\u239c\u239d\n\u239b\n\u2202\n\u2202\n+\u239f\u239f\u23a0\n\u239e\n\u239c\u239c\u239d\n\u239b\n\u2202\n\u2202\u2212\n+\u239f\u239f\u23a0\n\u239e\n\u239c\u239c\u239d\n\u239b\n\u2202\n\u2202\n+\u239f\u239f\u23a0\n\u239e\n\u239c\u239c\u239d\n\u239b\n\u2202\n\u2202\n+\u239f\u239f\u23a0\n\u239e\n\u239c\u239c\u239d\n\u239b\n\u2202\n\u2202\n+\u239f\u239f\u23a0\n\u239e\n\u239c\u239c\u239d\n\u239b\n\u2202\n\u2202\n+\u239f\u239f\u23a0\n\u239e\n\u239c\u239c\u239d\n\u239b\n\u2202\n\u2202\u2212\n+\u239f\u239f\u23a0\n\u239e\n\u239c\u239c\u239d\n\u239b\n\u2202\n\u2202=\u2202\n\u2202\n\u2212\n\u2212\n\u2212\n\u2212\n\u2212\n\u2212\n\u2212\n\u2212\n\u2212\np\nq\nq\nL\nq\np\nq\nn\nm\nn\nl\nn\nj\nn\nk\nt\nt q\nL\nqmiji\nml\nt\nkjili\np\nq\nn\nm\nn\nl\nn\nj\nn\nk\nt\nt qqmi\nL\nji\nmlt\nkjili\np\nq\nn\nm\nn\nl\nn\nj\nn\nk\nt\nt qqmi\nji\nml\nt\nL\nki\nkjili\np\nq\nn\nm\nn\nl\nn\nj\nn\nk\nt\nt qqmi\nji\nml\nt\nL\nkji\nli\np\nq\nn\nm\nn\nl\nn\nj\nn\nk\nt\nt qqmi\nji\nml\nt\nkji\nL\nli\nn\nm\nn\nl\nn\nj\nn\nk\nimi\nji\nml\ntt\nkji\nL\nli\nn\nm\nn\nl\nn\nj\nn\nk\nimi\nji\nml\ntt\nL\nkji\nli\nn\nm\nn\nl\nn\nj\nn\nk\nimi\nji\nml\ntt\nL\nki\nikjili\nn\nm\nn\nl\nn\nj\nn\nk\nimi\nL\nji\nmltt\nkjili\nL\ntu\nR\nd\ndu\nR\nb\naec\ndub\nR\na\nec\ndubae\nR\ntc\ndubae\nR\nc\ndubae\nR\nc\ntxae\nR\nc\ntxae\nR\nc\ntxae\nR\nttc\ntx\nR\na\nec\nR\nty\ni\nki\ni\nki\ni\nki\ni\nki\ni\nki\niki\niki\niki\niki\n1\n1 1 1 1 1\n,,1,\n,,,,\n1 1 1 1 1\n,,\n1,\n,\n,,,\n1 1 1 1 1\n,,\n1,\n,\n,\n,,,\n1 1 1 1 1\n,,\n1,\n,\n,,\n,\n1 1 1 1 1\n,,\n1,\n,,,\n,\n1 1 1 1\n1,\n1,\n,,,\n,\n1 1 1 1\n1,\n1,\n,\n,,\n,\n1 1 1 1\n1,\n1,\n,\n,\n1,,,\n1 1 1 1\n1,\n1,\n,\n,,,\n1\n,\n1\n,\n1\n,\n1\n,\n1\n,\n1,\n1,\n1,\n1,\n\u03c4\u03c4\u03ba\n\u03c4\u03c4\u03ba\n\u03c4\u03c4\u03bb\u03c4\u03ba\n\u03c4\u03c4\u03ba\n\u03c4\u03c4\u03ba\n\u03ba\n\u03ba\n\u03bb\u03ba\n\u03ba\n\u03c4\u03bb\n\u03c4\u03bb\n\u03c4\u03bb\n\u03c4\u03bb\n\u03c4\u03bb\n\u03bb\n\u03bb\n\u03bb\n\u03bb\n \n[ )ii ttt ,1\u2212\u2208\u2200  and for Ni ,,2,1 L= . (10b) \nBy substituting (10) into Problem (R), the problem can be \nsolved efficiently via many CAD tools, such as MISER3 [30]. \nV. ILLUSTRATIVE EXAMPLE \nSince few works have been done on the determination of the \nswitching instants based on minimizing the output ripple \nmagnitude, the output leakage voltage and the sensitivity of the \noutput load voltage with respect to both the input voltage and \nthe load resistance, it is difficult to have a fair comparison. This \nis because it is unfair if we compare this optimal PWM control \nmethod to those control methods with different control \nstrategies (such as those methods which do not determine the \noptimal switching instants, but determine the optimal control \ninput signals), non-optimal control methods (such as those \nmethods in which the switching instants are not optimal), or \noptimal control methods with different cost functions and \nconstraints (such as those methods in which the switching \ninstants are optimized based on other criteria, but not on the \nminimization of the output ripple magnitude, the output leakage \nvoltage and the sensitivity of the output load voltage with \nrespect to both the input voltage and the load resistance). In \norder to illustrate the effectiveness of this optimal PWM \ncontrol method, we consider a switched-capacitor DC\/DC \npower converter discussed in [31] as an illustrative example. \nThis switched-capacitor DC\/DC power converter [31] is \nchosen because of its simplicity and having practical \napplications in industries. \nReferring to the example in [31] which switches between \ntwo topologies, the circuit corresponding to each topology is \ncharacterized by an affine linear time invariant state space \nmodel as follows: \n( )\n\u23a5\u23a5\n\u23a5\u23a5\n\u23a5\u23a5\n\u23a5\n\u23a6\n\u23a4\n\u23a2\u23a2\n\u23a2\u23a2\n\u23a2\u23a2\n\u23a2\n\u23a3\n\u23a1\n++\u2212\n+\u2212\n+\u2212\n=\n0\n2\n0\n22\n0\n11\n1\n1\n1\n20\n0\n00\n2\n1\nC\nRRR\nC\nR\nC\nR\nC\nRR\nRRC\nonCLL\nLCL\nonC\n\u03b1\n\u03b1A\n,(11a) \n( )\n\u23a5\u23a5\n\u23a5\u23a5\n\u23a5\u23a5\n\u23a5\n\u23a6\n\u23a4\n\u23a2\u23a2\n\u23a2\u23a2\n\u23a2\u23a2\n\u23a2\n\u23a3\n\u23a1\n++\u2212\n+\u2212\n+\u2212\n=\n0\n1\n0\n22\n2\n11\n0\n2\n2\n20\n0\n2\n0\n0\n1\nC\nRRR\nC\nR\nRRC\nC\nR\nC\nRR\nonCLL\nonC\nLCL\n\u03b1\n\u03b1A\n,(11b) \n( )\nT\nLCL\nonC C\nR\nC\nRR\nRRC \u23a5\u23a6\n\u23a4\u23a2\u23a3\n\u23a1 +\u2212+= 02\n0\n11\n1\n1\n1 2\n1 \u03b1\n\u03b1B\n, (11c) \n( )\nT\nL\nonC\nCL\nC\nR\nRRCC\nRR \u23a5\u23a6\n\u23a4\u23a2\u23a3\n\u23a1\n+\n+\u2212=\n022\n2\n1\n0\n2\n2 2\n1 \u03b1\n\u03b1B\n, (11d) \n( )[ ]onCLCL RRRRR 201 20\n1\n1 += \u03b1C\n, (11e) \n( )[ ]onCLCL RRRRR 201 10\n2\n2 += \u03b1C\n, (11f) \n1\n0\n1 \u03b1\nLC RRD = , (11g) \nand \n2\n0\n2 \u03b1\nLC RRD = , (11h) \nwhere \nThis article has been accepted for inclusion in a future issue. \n \n \n7\n7\n( )( )0201 2 CLonCLC RRRRRR +++=\u03b1 , (12a) \nand \n( )( )0102 2 CLonCLC RRRRRR +++=\u03b1 . (12b) \nIn this example, 2=N . Figure 1 shows the circuit schematics \ncorresponding to each topology. The values of the resistors and \ncapacitors, as well as the input voltage, are shown in the circuit \nschematic, where \u03a9= 01.0onR  for all the diodes and transistors. \nWe operate the circuit with switching frequency equal to \n550 kHz, that is 6108182.1 \u2212\u00d7== NtT s. We select this \nswitching frequency because there will be a strong electronic \nmagnetic interference and large ripple magnitudes if we operate \nthe circuit at higher or lower switching frequencies. We assume \nthat the circuit is initially at rest, that is ( ) 0x =0 , as the usual \ncase in the real situation. All the weights for combining the \nmultiple-objectives are chosen to be 1 to avoid having bias on a \nparticular objective. Since the output leakage voltage is smaller \nthan the output ripple magnitude, we neglect the effect of the \noutput leakage voltage in the cost function, that is, \n( ) ( )011 \u2212= tyty . By applying this optimal PWM control method, \nwe found that 61 101.5209\n\u2212\u00d7=t s and the output ripple \nmagnitude is 4103.6242 \u2212\u00d7 V. The corresponding duty cycle is \n8365.0 . Although 21 CC =  and 21 CC RR = , it is worth noting that \nthe optimal duty cycle does not operate at 5.0 . This is because \nthe charging time constant is different from the discharging \ntime constant due to the non-zero load resistance as well as \nparasitic switch resistance and capacitance. Both the transient \nand steady state responses of all capacitors, as well as the \noutput load voltages are shown in Figure 2. It can be seen from \nthe figure that the steady state voltages across 0C , 1C , 2C  and \nLR  are approximately, 3.6V, 1.8V, 1.8V and 3.6V, \nrespectively. Hence, the circuit behaves normally as a voltage \ndoubler. \nVI. CONCLUSIONS \nIn this paper, we apply the model transformation and the \nenhancing control methods to determine the optimal switching \ninstants for PWM control of switched-capacitor DC\/DC power \nconverters. The advantages of applying this optimal PWM \ncontrol method are to avoid the process of a linearization and \nguarantee the optimality. Compared to the existing PWM \ncontrol methods, these methods are only a local approximation \nof the problem and do not solve the problem completely. \nREFERENCES \n[1] TianRui Ying, Wing-Hung Ki and Mansun Chan, \u201cArea-efficient CMOS \ncharge pumps for LCD drivers,\u201d IEEE Journal of Solid-State Circuits, \nvol. 38, no. 10, pp. 1721-1725, 2003. \n[2] Jian Liu, Zhiming Chen and Zhong Du, \u201cA new design of power supplies \nfor pocket computer systems,\u201d IEEE Transactions on Industrial \nElectronics, vol. 45, no. 2, pp. 228-235, 1998. \n[3] Octavian Dranga, Bal\u00e1zs Buti and Istv\u00e1n Nagy, \u201cStability analysis of a \nfeedback-controlled resonant DC-DC converter,\u201d IEEE Transactions on \nIndustrial Electronics, vol. 50, no. 1, pp. 141-152, 2003. \n[4] Sudip K. Mazumder, Ali H. Nayfeh and Dushan Boroyevich, \u201cTheoretical \nand experimental investigation of the fast- and slow-scale instabilities of a \nDC-DC converter,\u201d IEEE Transactions on Power Electronics, vol. 16, no. \n2, pp. 201-216,  2001. \n[5] Yefim Berkovich and Adrian Ioinovici, \u201cLarge-signal stability-oriented \ndesign of boost regulators based on a Lyapunov criterion with nonlinear \nintegral,\u201d IEEE Transactions on Circuits and Systems\u23afI: Fundamental \nTheory and Applications, vol. 49, no. 11, pp. 1610-1619, 2002. \n[6] Soumitro Banerjee and Krishnendu Chakrabarty, \u201cNonlinear modeling \nand bifurcations in the boost converter,\u201d IEEE Transactions on Power \nElectronics, vol. 13, no. 2, pp. 252-260, 1998. \n[7] David C. Hamill, Jonathan H. B. Deane and David J. Jefferies, \u201cModeling \nof chaotic DC-DC converters by iterated nonlinear mappings,\u201d IEEE \nTransactions on Power Electronics, vol. 7, no. 1, pp. 25-36, 1992. \n[8] Guohui Yuan, Soumitro Banerjee, Edward Ott and James A. Yorke, \n\u201cBorder\u23afcollision bifurcations in the buck converter,\u201d IEEE \nTransactions on Circuits and Systems\u23afI: Fundamental Theory and \nApplications, vol. 45, no. 7, pp. 707-716, 1998. \n[9] Mario di Bernardo and Francesco Vasca, \u201cDiscrete-time maps for the \nanalysis of bifurcations and chaos in DC\/DC converters,\u201d IEEE \nTransactions on Circuits and Systems\u23afPart I: Fundamental Theory and \nApplications, vol. 47, no. 2, pp. 130-143, 2000. \n[10] K. W. E. Cheng, M. Liu and J. Wu, \u201cExperimental study of bifurcation \nand chaos in the buck-boost converter,\u201d IEE Proceedings. B, Electric \nPower Applications, vol. 150, no. 1, pp. 45-61, 2003. \n[11] William C. Y. Chan and Chi K. Tse, \u201cStudy of bifurcations in \ncurrent-programmed DC\/DC boost converters: from quasi-periodicity to \nperiod-doubling,\u201d IEEE Transactions on Circuits and Systems\u23afI: \nFundamental Theory and Applications, vol. 44, no. 12, pp. 1129-1142, \n1997. \n[12] C. K. Tse, S. C. Fung and M. W. Kwan, \u201cExperimental confirmation of \nchaos in a current-programmed \u0106uk converter,\u201d IEEE Transactions on \nCircuits and Systems\u23afI: Fundamental Theory and Applications, vol. 43, \nno. 7, pp. 605-608, 1996. \n[13] K. W. E. Cheng, M. Liu and J. Wu, \u201cChaos study and parameter-space \nanalysis of the DC-DC buck-boost converter,\u201d IEE Proceedings. B, \nElectric Power Applications, vol. 150, no. 2, pp. 126-138, 2003. \n[14] Carles Batlle, Imma Massana and Alicia Miralles, \u201cLyapunov exponents \nfor bilinear systems. Application to the buck converter,\u201d International \nJournal of Bifurcation and Chaos, vol. 13, no. 3, pp. 713-722, 2003. \n[15] David C. Hamill and David J. Jeffries, \u201cSubharmonics and chaos in a \ncontrolled switched-mode power converter,\u201d IEEE Transactions on \nCircuits and Systems, vol. 35, no. 8, pp. 1059-1061, 1988. \n[16] Alireza Khayatian and David G. Taylor, \u201cMultirate modeling and control \ndesign for switched-mode power converters,\u201d IEEE Transactions on \nAutomatic Control, vol. 39, no. 9, pp. 1848-1852, 1994. \n[17] Frank H. F. Leung, Peter K. S. Tam and C. K. Li, \u201cAn improved \nLQR-based controller for switching DC-DC converters,\u201d IEEE \nTransactions on Industrial Electronics, vol. 40, no. 5, pp. 521-528, 1993. \n[18] Frank H. F. Leung, Peter K. S. Tam and C. K. Li, \u201cThe control of \nswitching DC-DC converters\u23afA general LQR problem,\u201d IEEE \nTransactions on Industrial Electronics, vol. 38, no. 1, pp. 65-71, 1991. \n[19] Francesco Garofalo, Pompeo Marino, Stefano Scala and Francesco \nVasca, \u201cControl of DC-DC converters with linear optimal feedback and \nnonlinear feedforward,\u201d IEEE Transactions on Power Electronics, vol. 9, \nno. 6, pp. 607-615, 1994. \n[20] J. Sun, H. Takano and M. Nakaoka, \u201cSeries and parallel transformer \nresonant DC-DC converter using optimal digital servo and repetitive \nlearning control schemes,\u201d IEE Proceedings. B, Electric Power \nApplications, vol. 146, no. 5, pp. 530-538, 1999. \n[21] Henry Chung and Adrian Ioinovici, \u201cDesign of feedback gain vector of \ntwo-state basic PWM multifeedback regulators for large-signal stability,\u201d \nIEEE Transactions on Circuits and Systems\u23afI: Fundamental Theory and \nApplications, vol. 44, no. 8, pp. 676-683, 1997. \n[22] Yufei Zhou, Chi K. Tse, Shui-Sheng Qiu and Francis C. M. Lau, \n\u201cApplying resonant parametric perturbation to control chaos in the buck \nDC\/DC converter with phase shift and frequency mismatch \nconsiderations,\u201d International Journal of Bifurcation and Chaos, vol. 13, \nno. 11, pp. 3459-3471, 2003. \n[23] L. Benadero, A. El Aroudi, G. Olivar, E. Toribio and E. G\u00f3mez, \n\u201cTwo-dimensional bifurcation diagrams. Background pattern of \nfundamental DC-DC converters with PWM control,\u201d International \nJournal of Bifurcation and Chaos, vol. 13, no. 2, pp. 427-451, 2003. \nThis article has been accepted for inclusion in a future issue. \n \n \n8\n8\n[24] Gabriel Garcer\u00e1, Emilio Figueres and Antonio Mochol\u00ed, \u201cNovel \nthree-controller average current mode control of DC-DC PWM converters \nwith improved robustness and dynamic response,\u201d IEEE Transactions on \nPower Electronics, vol. 15, no. 3, pp. 516-528, 2000. \n[25] Luigi Calderone, Licia Pinola and Vincenzo Varoli, \u201cOptimal \nfeed-forward compensation for PWM DC\/DC converters with \u201clinear\u201d \nand \u201cquadratic\u201d conversion ratio,\u201d IEEE Transactions on Power \nElectronics, vol. 7, no. 2, pp. 349-355, 1992. \n[26] K. L. Teo, C. J. Goh and K. H. Wong, A unified computational approach \nto optimal control problems, vol. 55, Pitman Monographs and Surveys in \nPure and Applied Mathematics (Longman Scientific and Technical, \nEngland, 1991). \n[27] K. L. Teo, L. S. Jennings, H. W. J. Lee and V. Rehbock, \u201cThe control \nparameterization enhancing transform for constrained optimal control \nproblems,\u201d Journal of Australian Mathematical Society, Series B, vol. 40, \npp. 314-335, 1999. \n[28] X. Q. Yang, A. I. Mees, M. E. Fisher and L. S. Jennings, Progress in \nOptimization II Contributions from Australasia. \n[29] Y. Liu, K. L. Teo, L. S. Jennings and S. Wang, \u201cOn a class of optimal \ncontrol problems with state jumps,\u201d Journal of Optimization Theory and \nApplications, vol. 98, no. 1, pp. 65-82, 1998. \n[30] L. S. Jennings, M. E. Fisher, K. L. Teo and C. J. Goh, \u201cMISER3: Solving \noptimal control problems\u23afan update,\u201d Advances in Engineering \nSoftware, vol. 13, pp. 190-196, 1991. \n[31] Henry Chung and Y. K. Mok, \u201cDevelopment of a switched-capacitor \nDC\/DC boost converter with continuous input current waveform,\u201d IEEE \nTransactions on Circuits and Systems\u23afI: Fundamental Theory and \nApplications, vol. 46, no. 6, pp. 756-759, 1999. \n[32] Guangyong Zhu and Adrian Ioinovici, \u201cDC-to-DC converter with no \nmagnetic elements and enhanced regulation,\u201d IEEE Transactions on \nAerospace and Electronic Systems, vol. 33, no. 2, pp. 499-506, 1997. \n[33] Arun Rao, William McIntyre, Un-Ku Moon and G\u00e1bor C. Temes, \n\u201cNoise-shaping techniques applied to switched-capacitor voltage \nregulators,\u201d IEEE Journal of Solid-State Circuits, vol. 40, no. 2, pp. \n422-429, 2005. \n[34] Hoi Lee and Philip K. T. Mok, \u201cAn SC voltage doubler with \npseudo-continuous output regulation using a three-stage switchable \nOpamp,\u201d IEEE Journal of Solid-State Circuits, vol. 42, no. 6, pp. \n1216-1229, 2007. \n[35] Jifeng Han, Annette von Jouanne and G\u00e1bor C. Temes, \u201cA new approach \nto reducing output ripple in switched-capacitor-based step-down DC-DC \nconverters,\u201d IEEE Transactions on Power Electronics, vol. 21, no. 6, pp. \n1548-1555, 2006. \n[36] B. Robert Gregoire, \u201cA compact switched-capacitor regulated charge \npump power supply,\u201d IEEE Journal of Solid-State Circuits, vol. 41, no. 8, \npp. 1944-1953, 2006. \n \nFigure 1. Circuit schematics of each topology of the \nswitched-capacitor DC\/DC power converter [31]. (a) Topology \n1. (b) Topology 2. \n0 0.2 0.4 0.6 0.8 1\nx 10\n-4\n0\n0.5\n1\n1.5\n2\n2.5\n3\n3.5\n4\nTime t (s)\nO\nut\npu\nt V\nol\nta\nge\n y\n(t)\n (V\n)\nOutput Voltage\n0 0.2 0.4 0.6 0.8 1\nx 10\n-4\n0\n0.2\n0.4\n0.6\n0.8\n1\n1.2\n1.4\n1.6\n1.8\nTime t (s)\nS\nta\nte\n v\nol\nta\nge\n a\ncc\nro\nss\n C\n1 \nV\nC\n1(\nt) \n(V\n)\nState voltage accross C1\n \n0 0.2 0.4 0.6 0.8 1\nx 10\n-4\n-1\n-0.5\n0\n0.5\n1\n1.5\n2\nTime t (s)\nS\nta\nte\n v\nol\nta\nge\n a\ncc\nro\nss\n C\n2 \nV\nC\n2(\nt) \n(V\n)\nState voltage accross C2\n0 0.2 0.4 0.6 0.8 1\nx 10\n-4\n0\n0.5\n1\n1.5\n2\n2.5\n3\n3.5\n4\nTime t (s)\nS\nta\nte\n v\nol\nta\nge\n a\ncc\nro\nss\n C\n0 \nV\nC\n0(\nt) \n(V\n)\nState voltage accross C0\n \n8.9 8.95 9 9.05 9.1\nx 10\n-5\n3.5831\n3.5831\n3.5832\n3.5832\n3.5833\n3.5833\n3.5834\n3.5834\n3.5835\n3.5835\nTime t (s)\nS\nte\nad\ny \nS\nta\nte\n O\nut\npu\nt V\nol\nta\nge\n y\n(t)\n (V\n)\nSteady State Output Voltage\n8.9 8.95 9 9.05 9.1\nx 10\n-5\n1.7961\n1.7962\n1.7963\n1.7964\n1.7965\n1.7966\n1.7967\n1.7968\n1.7969\n1.797\nTime t (s)\nS\nte\nad\ny \nS\nta\nte\n V\nol\nta\nge\n a\ncc\nro\nss\n C\n1 \nV\nC\n1(\nt) \n(V\n)\nSteady State Voltage accross C1\n \n(a) \nC1 RC1\n(b) \nC1 RC1\nThis article has been accepted for inclusion in a future issue. \n \n \n9\n9\n8.9 8.95 9 9.05 9.1\nx 10\n-5\n1.7845\n1.785\n1.7855\n1.786\n1.7865\n1.787\n1.7875\n1.788\n1.7885\nTime t (s)\nS\nte\nad\ny \nS\nta\nte\n V\nol\nta\nge\n a\ncc\nro\nss\n C\n2 \nV\nC\n2(\nt) \n(V\n)\nSteady State Voltage accross C2\n8.9 8.95 9 9.05 9.1\nx 10\n-5\n3.5827\n3.5828\n3.5829\n3.583\n3.5831\n3.5832\n3.5833\n3.5834\n3.5835\nTime t (s)\nS\nte\nad\ny \nS\nta\nte\n V\nol\nta\nge\n a\ncc\nro\nss\n C\n0 \nV\nC\n0(\nt) \n(V\n)\nSteady State Voltage accross C0\n \nFigure 2. Transient and steady state voltages across capacitors \nand the load resistor of the switched-capacitor DC\/DC power \nconverter [31].\nThis article has been accepted for inclusion in a future issue. \n \n \n10\n10\n \n"}