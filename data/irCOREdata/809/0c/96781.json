{"doi":"10.1016\/j.jtbi.2004.09.016","coreId":"96781","oai":"oai:generic.eprints.org:354\/core69","identifiers":["oai:generic.eprints.org:354\/core69","10.1016\/j.jtbi.2004.09.016"],"title":"Cluster formation for multi-strain infections with cross-immunity","authors":["Clavez, V.","Korobeinikov, A.","Maini, P. K."],"enrichments":{"references":[{"id":767580,"title":"Analysis of clustered firing patterns in synaptically coupled networks of oscillators.","authors":[],"date":"2000","doi":"10.1007\/s002850000065","raw":null,"cites":null},{"id":766439,"title":"Antigenic diversity and the transmission dynamics of Plasmodium falciparum.","authors":[],"date":"1994","doi":null,"raw":null,"cites":null},{"id":765929,"title":"Dynamics and selection of many-strain pathogens.","authors":[],"date":"2002","doi":null,"raw":null,"cites":null},{"id":767051,"title":"Dynamics of influenza A drift: the linear three-strain model.","authors":[],"date":"1999","doi":null,"raw":null,"cites":null},{"id":767840,"title":"Dynamics of two mutually coupled slow inhibitory neurons.","authors":[],"date":"1998","doi":"10.1016\/S0167-2789(97)00312-6","raw":null,"cites":null},{"id":767366,"title":"Geometric analysis of population rhythms in synaptically coupled neuronal networks.","authors":[],"date":"2000","doi":"10.1162\/089976600300015727","raw":null,"cites":null},{"id":767228,"title":"Hemagglutinin sequence clusters and the antigenic evolution of influenza A virus.","authors":[],"date":"2002","doi":"10.1073\/pnas.082110799","raw":null,"cites":null},{"id":765172,"title":"Nonlinear Dynamics of Chaotic and Stochastic Systems.","authors":[],"date":"2002","doi":null,"raw":null,"cites":null},{"id":767762,"title":"Partial synchronization in a network of neural oscillators.","authors":[],"date":"1997","doi":"10.1137\/S0036139994278925","raw":null,"cites":null},{"id":766885,"title":"Persistence, and evolution of strain structure in antigenically diverse infectious agents.","authors":[],"date":"1998","doi":null,"raw":null,"cites":null},{"id":766199,"title":"Population structure of pathogens: the role of immune selection.","authors":[],"date":"1999","doi":null,"raw":null,"cites":null},{"id":765545,"title":"Spatial Aspects of Influenza Epidemics.","authors":[],"date":"1986","doi":null,"raw":null,"cites":null},{"id":764733,"title":"The dynamics of cocirculating influenza strains conferring partial cross-immunity.","authors":[],"date":"1997","doi":null,"raw":null,"cites":null},{"id":766662,"title":"The maintenance of strain structure in populations of recombining infectious agents.","authors":[],"date":"1996","doi":null,"raw":null,"cites":null},{"id":765754,"title":"The onset of oscillatory dynamics in models of multiple disease strains.","authors":[],"date":"2002","doi":null,"raw":null,"cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2005","abstract":"Many infectious diseases exist in several pathogenic variants, or strains, which interact via cross-immunity. It is observed that strains tend to self-organise into groups, or clusters. The aim of this paper is to investigate cluster formation. Computations demonstrate that clustering is independent of the model used, and is an intrinsic feature of the strain system itself. We observe that an ordered strain system, if it is sufficiently complex, admits several cluster structures of different types. Appearance of a particular cluster structure depends on levels of cross-immunity and, in some cases, on initial conditions. Clusters, once formed, are stable, and behave remarkably regularly (in contrast to the generally chaotic behaviour of the strains themselves). In general, clustering is a type of self-organisation having many features in common with pattern formation","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/96781.pdf","fullTextIdentifier":"http:\/\/eprints.maths.ox.ac.uk\/354\/1\/178.pdf","pdfHashValue":"0a84a60c54a665433af198839d2ffe811c2449fb","publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:generic.eprints.org:354<\/identifier><datestamp>\n      2015-05-29T18:20:42Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D4143:4D3932<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/eprints.maths.ox.ac.uk\/354\/<\/dc:relation><dc:title>\n        Cluster formation for multi-strain infections with cross-immunity<\/dc:title><dc:creator>\n        Clavez, V.<\/dc:creator><dc:creator>\n        Korobeinikov, A.<\/dc:creator><dc:creator>\n        Maini, P. K.<\/dc:creator><dc:subject>\n        Biology and other natural sciences<\/dc:subject><dc:description>\n        Many infectious diseases exist in several pathogenic variants, or strains, which interact via cross-immunity. It is observed that strains tend to self-organise into groups, or clusters. The aim of this paper is to investigate cluster formation. Computations demonstrate that clustering is independent of the model used, and is an intrinsic feature of the strain system itself. We observe that an ordered strain system, if it is sufficiently complex, admits several cluster structures of different types. Appearance of a particular cluster structure depends on levels of cross-immunity and, in some cases, on initial conditions. Clusters, once formed, are stable, and behave remarkably regularly (in contrast to the generally chaotic behaviour of the strains themselves). In general, clustering is a type of self-organisation having many features in common with pattern formation.<\/dc:description><dc:date>\n        2005<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/eprints.maths.ox.ac.uk\/354\/1\/178.pdf<\/dc:identifier><dc:identifier>\n          Clavez, V. and Korobeinikov, A. and Maini, P. K.  (2005) Cluster formation for multi-strain infections with cross-immunity.  Journal of Theoretical Biology, 233  (1).   pp. 75-83.      <\/dc:identifier><dc:relation>\n        10.1016\/j.jtbi.2004.09.016<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/eprints.maths.ox.ac.uk\/354\/","10.1016\/j.jtbi.2004.09.016"],"year":2005,"topics":["Biology and other natural sciences"],"subject":["Article","PeerReviewed"],"fullText":"ARTICLE IN PRESS0022-5193\/$ - se\ndoi:10.1016\/j.jtb\n\u0001Correspond\nHokkaido, N12\nfax: +8111 706\nE-mail addr\nes.hokudai.ac.jp\n(P.K. Maini).\n1VC thank D\nand for providi\n2AK is supp\nTechnology of\n3PKM was su\nGrant No. PHY\nBarbara for theJournal of Theoretical Biology 233 (2005) 75\u201383\nwww.elsevier.com\/locate\/yjtbiCluster formation for multi-strain infections with cross-immunity\nV. Calveza,1, A. Korobeinikovb,\u0001,2, P.K. Mainib,3\naEcole Normale Supe\u00b4rieure, 45 rue d\u2019Ulm, Paris 75005, France\nbCentre for Mathematical Biology, Mathematical Institute, University of Oxford, 24-29 St Giles\u2019, Oxford OX1 3LB, UK\nReceived 7 October 2003; received in revised form 21 September 2004; accepted 23 September 2004\nAvailable online 30 November 2004Abstract\nMany infectious diseases exist in several pathogenic variants, or strains, which interact via cross-immunity. It is observed that\nstrains tend to self-organise into groups, or clusters. The aim of this paper is to investigate cluster formation. Computations\ndemonstrate that clustering is independent of the model used, and is an intrinsic feature of the strain system itself. We observe that\nan ordered strain system, if it is sufficiently complex, admits several cluster structures of different types. Appearance of a particular\ncluster structure depends on levels of cross-immunity and, in some cases, on initial conditions. Clusters, once formed, are stable, and\nbehave remarkably regularly (in contrast to the generally chaotic behaviour of the strains themselves). In general, clustering is a type\nof self-organisation having many features in common with pattern formation.\nr 2004 Elsevier Ltd. All rights reserved.\nMSC: primary 92D30; 34D20\nKeywords: Mathematical modelling; Infectious disease; Cross-immunity; Self-organisation; Cluster1. Introduction\nMany pathogens have several different antigenic\nvariants, or strains, present in a host population\nsimultaneously. The classic example is influenza (An-\ndreasen et al., 1997; Lin et al., 1999; Plotkin et al., 2002;\nGog and Grenfell, 2002; Cliff et al., 1986), where there\nare several circulating subtypes, with many minor\nvariants within each subtype. Other important examplese front matter r 2004 Elsevier Ltd. All rights reserved.\ni.2004.09.016\ning author. Current address: RIES, University of\nW6 Sapporo, 060-0812, Japan. Tel.: +81 11 706 2891;\n4966.\nesses: vincent.calvez@ens.fr (V. Calvez), andrei@nsc.\n(A. Korobeinikov), maini@maths.ox.ac.uk\nr. S. Gupta and Mr. M. Recker for helpful discussions\nng a preprint.\norted by the Foundation for Research, Science and\nNew Zealand, through Project Contract UOXX0101.\npported in part by National Science Foundation under\n99-07949. PKM would like to thank KITP, UC Santa\nir kind hospitality.are meningitis (Gupta et al., 1996; Gupta and Anderson,\n1999), dengue (Gog and Grenfell, 2002) and malaria\n(Gupta et al., 1994).\nBecause of similarities in, for example, their mechan-\nisms of infection, strains may interact with each other\n(Gupta et al., 1996). Infection with one strain may\npartially protect the host against infection with other\nstrains. Cross-immunity is included in different ways in\ndifferent models, but the general idea is the same:\ninfection with one strain of the disease produces a\nlasting immune memory in the host which acts to\nprotect against subsequent infection by other strains.\nThat is, for two sufficiently close strains A and B,\ninfection by strain A reduces the chance of a secondary\ninfection by strain B: For instance, in the case of\ninfluenza, the surface protein hemagglutinin seems to be\nunder strong positive selection because it is the target of\nthe immune response, and therefore it presents high\nantigenic diversity in the virus population (Andreasen\net al., 1997; Lin et al., 1999; Plotkin et al., 2002; Gog\nand Grenfell, 2002). This immune response may be\nARTICLE IN PRESS\nV. Calvez et al. \/ Journal of Theoretical Biology 233 (2005) 75\u20138376enhanced because of a previous infection with a close\nvariant.\nThere are different approaches to the cross-immunity\nproblem (Gog and Swinton, 2002). For instance, we can\nassume that a fraction, say gBA; of individuals infected\nwith strain A gain complete immunity to strain B;\nalternatively, all the individuals infected with strain A\nmay be assumed to acquire partial immunity against B\n(with a consequence that the force of secondary B-\ninfection is reduced by a factor gBA). Another possible\nhypothesis is that the secondary infection is weaker and\nthus less transmissible by the infective host. These\ndifferences in the approaches to cross-immunity lead to\na variety of models which can provide controversial\noutcomes. Under such circumstances it is reasonable to\nlook for such features of the multi-strain system which\nare intrinsic to this system and are robust irrespective of\nmodel choice.\nA system of multiple strains interacting via host cross-\nimmunity tends to self-organise into groups, or clusters.\nThe tendency for strains to occur in clusters reflects the\nobserved influenza dynamics (Gog and Grenfell, 2002;\nPlotkin et al., 2002). Cluster formation was observed\nand discussed by Gupta et al. (1996, 1998). The\nphenomenon of clustering appears to be typical for\nmany systems with internal order and may occur in such\nsystems as multi-species predator\u2013prey systems. For\nexample, it was observed in neuronal networks (Rubin\nand Terman, 2000a,b; Terman and Lee, 1997; Terman\net al., 1998).\nIn this paper we consider formation of clusters in\nordered multi-strain systems. We show that for complex\nsystems several different types of cluster structure may\narise. We also demonstrate that cluster structures are\nnot specific to a particular model\u2014on the contrary, they\nappear to be intrinsic to the given strain system. In\ngeneral, cluster formation is a self-organisation phe-\nnomenon bearing many similarities to pattern forma-\ntion. A remarkable feature of clusters is that they exhibit\nexceptional regularity even when the dynamics of every\nstrain is chaotic.2. Model\nDue to different approaches to cross-immunity, a\nvariety of models of multi-strain infections has been\ndeveloped. These models sometimes lead to different\noutcomes. It is important, therefore, to find such\nindicators which are characteristic to the system itself\nand robust to choice of model.\nWe start from a comparatively simple model of a\nmulti-strain infection suggested by Gupta et al. (1998).\nThis model is composed of only three compartments\n(and, respectively, three differential equations) for each\nstrain. If zi\u00f0t\u00de is the fraction of individuals who havebeen or are infected with the strain i (either they are\ninfectious or not), yi\u00f0t\u00de is the fraction of the infectious\nindividuals with the strain, and wi\u00f0t\u00de is the fraction of\nindividuals who have been infected (or are infected) by\nany strain sufficiently close to the strain i including i\nitself (that is wi \u00bc [j\u0005izj), then the model equations are:\ndzi\ndt\n\u00bc biyi\u00f01\u0006 zi\u00de \u0006 mzi;\ndwi\ndt\n\u00bc\nX\nj\u0005i\nbjyj\u00f01\u0006 wi\u00de \u0006 mwi;\ndyi\ndt\n\u00bc biyi\u00bd\u00f01\u0006 wi\u00de \u00fe \u00f01\u0006 g\u00de\u00f0wi \u0006 zi\u00de\t \u0006 \u00f0m\u00fe si\u00deyi: \u00f01\u00de\nFor this model, cross-protection does not affect\nsusceptibility but reduces transmissibility by a factor\n1\u0006 g (where the parameter g measures the degree of\ncross-protection between two strains). Here, j \u0005 i means\nthat the jth strain is related to the ith strain and can\ninduce cross-protection (that is if j \u0005 i then gija0). The\nparameters 1=m and 1=s are, respectively, host life\nexpectancy and average period of infectiousness, b is\ntransmission rate. We refer to this model as Gupta\u2019s\nmodel. This simple model has been analysed in Gupta\net al. (1998) and provided important insights into\npathogen formation and the genetic organisation of\nstrains.\nTo study the phenomenon of clustering we need to\nconsider several levels of cross-protection. Whereas the\noriginal model implies only one level of cross-protection\n(g if two strains are related, or zero if they are not) and\nneglects possible multiple infections by strains related\nto i. We relax these assumptions below to make the\nmodel more generally applicable, while striving to keep\nthe model simple. We assume that the probability of\ncross-protection between strains i and j is gij (that is,\ninfection by the strain j reduces the probability that the\nhost will be infected by the strain i by a factor gij), and\nconsider the barycentre of gij ; defined as\nGi \u00bc\nX\nj\u0005i;jai\ngijbjyj\n ! X\nj\u0005i;jai\nbjyj\n !,\n: (2)\nWe replace the coefficient g in the system (1) with the\nbarycentre Gi: Substituting the barycentre Gi into (1)\nand using the variables V i \u00bc 1\u0006 zi; X i \u00bc 1\u0006 wi; Y i \u00bc\nbi\nm yi and t \u00bc mt; we obtain the system\ndVi\ndt\n\u00bc 1\u0006 \u00f01\u00fe Y i\u00deV i;\ndX i\ndt\n\u00bc 1\u0006 1\u00fe\nX\nj\u0005i\nY j\n !\nX i;\nei\ndY i\ndt\n\u00bc \u00f0\u00f01\u0006 Gi\u00deV i \u00fe GiX i \u0006 ri\u00deY i: \u00f03\u00de\nHere ei \u00bc m=bi and ri \u00bc \u00f0m\u00fe si\u00de=bi: Obviously, Gi \n g\nfor Gupta\u2019s model (when gij is either g; or zero).\nARTICLE IN PRESS\n(2,2,1) (2,2,2)\n(2,1,2)\n(2,1,1)\nV. Calvez et al. \/ Journal of Theoretical Biology 233 (2005) 75\u201383 77Furthermore, computations show that for this model the\nfunction Gi\u00f0t\u00de mostly takes one of a few constant values,\nwith rapid shifting between these values (see Fig. 4(b));\nthis justifies the use of the function Gi\u00f0t\u00de:2\n2\n1\n(1,2,1)\n(1,1,2)\n\u03b3\u03b3\n\u03b3\n(1,2,2)\n(1,1,1)\nFig. 2. Strain space of an eight-strain system: three loci with two\nalleles possible at each locus. Here, for instance, \u00f02; 2; 1\u00de means that the\nsecond, the second and the first alleles are, respectively, at the first, the\nsecond and the third locus.3. Structure of a strain set\nSystems of strains were formed as a result of a genetic\nprocess, and they generally inherited some internal order\nassociated with this process. Having this intrinsic order,\na system of strains may be organised in an ordered set,\nor a discrete strain space every point of which represents\na strain. The idea of the strain space allows us to use the\nconcept of \u2018\u2018immunological distance\u2019\u2019. The immunolo-\ngical distance between two strains may be assumed\nto depend inversely on their mutual level of cross-\nprotection.\nThe structure of the strain space depends on under-\nlying immunological and genetic processes. For in-\nstance, Gog and Grenfell (2002) considered the simplest\npossible strain space: a linear strain space. In this case\nstrains are arranged in a line, and they postulated gij \u00bc\nexp\u00f0\u0006\u00f0i\u0006j\nd\n\u00de2\u00de; where d is a constant. A multi-dimensional\nstrain space may be organised in the same way, with\nimmunological distance defined, for example, as the sum\nof horizontal and vertical distances. Dawes and Gog\n(2002) and Gog and Swinton (2002) considered a system\nof four strains arranged in a circle. In this case, each\nstrain is assumed to interact more strongly with its\nadjacent neighbours than with the strain opposite.\nStudying the maintenance of strain structure in a\nrecombining virus population, Gupta et al. (1996) have\nintroduced a simple framework where strains are\norganised as follows: each strain is characterised by a\ncombination of alleles at loci which are of immunolo-\ngical interest. Strains induce cross-immunity if they\nshare at least one allele. For example, in the case of two\nloci and two possible alleles at each locus (say a or b forx y\n(bx) (by)\n(ay)(ax)\n\u03b3\n\u03b3\nx y\na\nb\na\nb\nFig. 1. Strain space of a four-strain system: two loci and two possible\nalleles at each locus (see text for details).the first locus, and x or y for the second one,\nrespectively) there are four different strains: the original\nstrains ax and by, and the recombinant strains ay\nand bx. To visualise such a strain structure we will use a\nmulti-dimensional graph where a dimension corre-\nsponds to a locus, and vertices represent strains. Fig. 1\nillustrates the structure of the above mentioned four-\nstrain system (two loci and two possible alleles at each\nlocus). Fig. 2 shows the strain space of an eight-strain\nsystem organised on three loci with two alleles at each\nlocus.4. Results\nCross-immunity may structure a set of strains into\ngroups, or clusters. These groups can behave at least in\nthree ways: remain in homogeneous equilibrium when\nno structure is observed (Fig. 3a), oscillate when the\nclusters alternate recurrently in succession (Fig. 3b), or\none group may dominate with the others driven below\nsurvival level (Fig. 3c) (Gupta et al., 1996, 1998). The\nphenomenon of clustering is conserved for all suffi-\nciently large levels of cross-protection. Of course, when\ng! 0; the equations are decoupled, and the clustering\ndisappears.\nIn the case of the four-strain system shown in Fig. 1 it\nis natural to expect the formation of two clusters of non-\noverlapping (or discordant) strains, namely ax groups\nwith by, and ay groups with bx (in Fig. 1 we,\nrespectively, mark the strains by squares and circles).\nIndeed, such clustering has been observed (Gog and\nSwinton, 2002; Dawes and Gog, 2002; Gupta et al.,\n1996, 1998). Fig. 3 illustrates the strain dynamics: it is\neasy to see the formation of two clusters.\nHowever, a multi-strain system with only one level of\ncross-protection which is the same for all related strains,\nis hardly realistic. As the number of strains grows, and\nARTICLE IN PRESS\n0 100 200 300\n0\n0.2\n0.4\n0.6\n0.8\n1\n\u03b5=5e\u22124, \u03b3=0.5\nFr\nac\ntio\nns\n o\nf i\nm\nm\nun\ne\n(a)\n0 100 200 300\n0.1\n0.3\n0.5\n0.7\n0.9\nFr\nac\ntio\nns\n o\nf i\nm\nm\nun\ne\n(b)\n\u03b5=5e\u22124, \u03b3=0.75\n0 100 200 300\n0\n0.2\n0.4\n0.6\n0.8\n\u03b5=5e\u22124, \u03b3=0.9\nTime\nFr\nac\ntio\nns\n o\nf i\nm\nm\nun\ne \n(c)\nFig. 3. Dynamics of the four-strain system shown in Fig. 1. Here (b)\nand (c) illustrate formation of two clusters each consisting of two\nstrains; in (a) the system is in homogeneous equilibrium, and no\ndefinite clustering can be observed.\nV. Calvez et al. \/ Journal of Theoretical Biology 233 (2005) 75\u20138378especially if there are several different levels of\ncross-protection, the self-organisation of the system\nmay be more complicated. Furthermore, it may\nbe different for different levels of cross-protection.\nFor instance, for the eight-strain system shown in\nFig. 2 at least two different types of clustering are\npossible. From now on we will use the terms cluster\nstructure and type of cluster structure. The difference\nbetween these objects is that different cluster structures\nmay be of the same type. Below we will show this using\nan example.\nFor a system of eight strains organised in three loci\nwith two alleles each (Fig. 2) we assume two levels of\ncross-protection: namely g1 if the strains share one allele,\nor g2 if they share two alleles. Naturally, g1pg2: For this\nsystem one can expect formation of a structure of four\nclusters with two discordant strains each (Gupta et al.,\n1998). Every cluster of such structure corresponds to\none of the four main diagonals of the cube in Fig. 2.However, this type of cluster structure was observed\nonly when g1 and g2 are sufficiently close. As the\ndifference between g1 and g2 grows, a new type of cluster\nstructure appears: now there are two clusters, a and b;\nwith four strains each (a is composed of the strains\n\u00f01; 1; 1\u00de; \u00f01; 2; 2\u00de; \u00f02; 1; 2\u00de and \u00f02; 2; 1\u00de; and b of \u00f02; 2; 2\u00de;\n\u00f02; 1; 1\u00de; \u00f01; 2; 1\u00de and \u00f01; 1; 2\u00de). In Fig. 2 the strains of\nthese \u2018\u2018tetrahedral\u2019\u2019 clusters are marked, respectively, by\ncircles and squares. This second type of clustering can\nhardly be expected a priori. However, this cluster\nstructure exists for a much wider range of g1 and g2\nthan the first type. Fig. 4 illustrates the dynamics of the\nsecond type of clustering. Here, the logarithm of the\nforce of infection log Y i\u00f0t\u00de (Fig. 4(a)) and the effective\ncross-protection Ga\u00f0t\u00de (Fig. 4(b)) are shown for e \u00bc\n5\f 10\u00063 (left column) and 5\f 10\u00064 (right column).\nNote that the function Ga\u00f0t\u00de remains constant most of\nthe time, with rapid shifting between two constant\nvalues. Also note the remarkable regularity of the\nfunction Ga\u00f0t\u00de in contrast to the chaotic behaviour of\nthe forces of infection. The function Gb\u00f0t\u00de is qualitatively\nthe same.\nFig. 5 shows the results of stochastic perturbation of\nthe system. Here we assume that 1=e \u00bc 200\u00fe d\u00f0t\u00de; where\nd\u00f0t\u00de is a Gaussian-distributed noise of magnitude 1 (a),\n10 (b) and 20 (c). It is easy to see that the cluster\nstructure is robust to such stochastic perturbations.\nA cluster structure may be qualitatively defined by the\nclustering matrix M: we set mij equal to 1 if the strains i\nand j belong to the same cluster, and mij \u00bc 0 otherwise.\nNaturally, the matrix is symmetric and mii \u00bc 1: For\ninstance, if the vertices of the cube in Fig. 2 are ordered\nas follows:\nthen the clustering matrices for the first and second\ntypes of clustering are\nMI \u00bc\n1 0 0 0 0 0 0 1\n0 1 0 0 0 0 1 0\n0 0 1 0 0 1 0 0\n0 0 0 1 1 0 0 0\n0 0 0 1 1 0 0 0\n0 0 1 0 0 1 0 0\n0 1 0 0 0 0 1 0\n1 0 0 0 0 0 0 1\n0\nBBBBBBBBBBBBBBBBB@\n1\nCCCCCCCCCCCCCCCCCA\nand\nARTICLE IN PRESS\n(a) 0 5 10\n10 10\n1015 20-10\n-8\n-6\n-4\n-2\n0\n2\n4\nlo\ng \nof\n fo\nrc\nes\n o\nf i\nnf\nec\ntio\nn\n0 5 15 20\n-80\n-60\n-40\n-20\n0\nlo\ng \nof\n fo\nrc\nes\n o\nf i\nnf\nec\ntio\nn\n(b)\n0 5 15 200\n0.2\n0.4\n0.6\n0.8\n1\n\u03b5=5.10-3\nTime\n\u0393\n(t)\n0 5 15 200\n0.2\n0.4\n0.6\n0.8\n1\n\u03b5 = 5.10-4\nTime\n\u03b1 \u0393\n(t)\n\u03b1\nFig. 4. Dynamics of the logarithm of the forces of infection Y i\u00f0t\u00de (a) and the effective cross-protection Ga\u00f0t\u00de (b) for the \u2018\u2018tetrahedric\u2019\u2019 cluster structure\n(two clusters with four strains each). The bold lines in (a) are for the forces of infection of the four strains of the cluster a: Here e \u00bc 5\f 10\u00063 (left\ncolumn) and 5\f 10\u00064 (right column); g1 \u00bc 0:4 and g2 \u00bc 0:8: Note the remarkable synchronisation of the forces of infection for each cluster for\ne \u00bc 5\f 10\u00063 and regularity of the function Ga\u00f0t\u00de contrasting to the chaotic behaviour of the forces of infection for e \u00bc 5\f 10\u00064:\nV. Calvez et al. \/ Journal of Theoretical Biology 233 (2005) 75\u201383 79MII \u00bc\n1 0 1 0 1 0 1 0\n0 1 0 1 0 1 0 1\n1 0 1 0 1 0 1 0\n0 1 0 1 0 1 0 1\n1 0 1 0 1 0 1 0\n0 1 0 1 0 1 0 1\n1 0 1 0 1 0 1 0\n0 1 0 1 0 1 0 1\n0\nBBBBBBBBBBBBBBBBB@\n1\nCCCCCCCCCCCCCCCCCA\n;\nrespectively. The idea of clustering matrix allows\nus to define the concepts of cluster structure and type\nof cluster structure rigorously. The cluster structures\nare of the same type if their clustering matrices\ncan be transformed one into another by row and\ncolumn permutations. We also define the effective\ncorrelation matrix R with the coefficients (Anishchenko\net al., 2002)\nRij \u00bc\nhY i\u00f0t\u00de; Y j\u00f0t\u00deiT \u0006 hY i\u00f0t\u00deiT hY j\u00f0t\u00deiTffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n\u00f0hY i\u00f0t\u00de2iT \u0006 hY i\u00f0t\u00dei2T \u00de\u00f0hY j\u00f0t\u00de2iT \u0006 hY j\u00f0t\u00dei2T \u00de\nq :Here hY \u00f0t\u00deiT is the mean average\nhY \u00f0t\u00deiT \u00bc\n1\nT\nZ\nI\nY \u00f0t\u00dedt:\nThe time interval I should be sufficiently long\nand exclude the transient regime. The correlation\ncoefficient Rij is a measure of synchronisation of the\ntime series for the forces of infection; Rij \u00bc 1 when\ncomplete synchronization occurs, and Rij \u00bc \u00061 when\nthe strains are in antiphase. Naturally, Rii \u00bc 1: For\nexample, for the case shown in Fig. 4, Rij is equal to 1\nfor the strains of the same cluster and to \u00060:6 otherwise\nwhen e \u00bc 5\f 10\u00063 (left column), and Rij is between 0:75\nand 1 for the strains in the same cluster and between\n\u00060:45 and \u00060:19 otherwise when e \u00bc 5\f 10\u00064 (right\ncolumn).\nIt is thereby a fairly straightforward procedure\nto relate the coefficients Rij to the coefficients of\nclustering mij : For instance, a threshold function\nof the form H\u00f0r\u00de \u00bc exp\u00f0a\u00f0r\u0006a\u00de\u00de\n1\u00feexp\u00f0a\u00f0r\u0006a\u00de\u00de; where a40 is suffi-\nciently large and 0pao1; can be applied to the\nelements of the matrix R. Fig. 6 illustrates the\nEuclidean distance between the effective correlation\nmatrix H\u00f0R\u00de and the second type clustering\nARTICLE IN PRESS\n(a) 0 5 10 15 20-8\n-6\n-4\n-2\n0\n2\n4\nlo\ng \nof\n fo\nrc\nes\n o\nf i\nnf\nec\ntio\nn\n(b) 0 5 10\n10\n15 20-8\n-6\n-4\n-2\n0\n2\n4\nlo\ng \nof\n fo\nrc\nes\n o\nf i\nnf\nec\ntio\nn\n(c)\n0 5 15 20-8\n-6\n-4\n-2\n0\n2\n4\nTime\nlo\ng \nof\n fo\nrc\nes\n o\nf i\nnf\nec\ntio\nn\nFig. 5. The logarithm of the forces of infection Y i\u00f0t\u00de for the\n\u2018\u2018tetrahedric\u2019\u2019 cluster structure with stochastic perturbations. Here\n1=e \u00bc 200\u00fe d\u00f0t\u00de; where d\u00f0t\u00de is the Gaussian-distributed noise of\nmagnitudes 1 (a), 10 (b) and 20 (c); r \u00bc 0:25; g1 \u00bc 0:5 and g2 \u00bc 0:8:\nThe bold lines are for the strains of the first cluster.\n0.4 0.5 0.8 0.9\n0.4\n0.5\n0.8\n0.9\n\u03b31\n\u03b3 2\nFig. 6. Euclidean distance D between the effective correlation matrix\nH\u00f0R\u00de and the clustering matrix MII as a function of g1 and g2: In the\nblack area D \u00bc 1; that is the matrix H\u00f0R\u00de coincides with MII : In the\ngrey area D \u00bc 0; the first type of clustering occurs in this area. The\nwhite area corresponds to the biologically unfeasible case g14g2 (the\nthird type of clustering, mentioned in the text, occurs in this area).\n4Here and through this paper, by the term \u2018\u2018chaos\u2019\u2019 we imply\ndeterministic chaos.\nV. Calvez et al. \/ Journal of Theoretical Biology 233 (2005) 75\u20138380matrix MII ;\nD \u00bc kH\u00f0R\u00de \u0006 MIIk2 \u00bc\nX\ni;j\n\u00f0Rij \u0006 Mij\u00de2\n !1\n2\n;\nfor different values of g1 and g2: (Here a \u00bc 20 and\na \u00bc 0:7:) It is easy to see that when g1 \u0010 g2; the rapid\nshift between the two types of clustering occurs.\nIn some cases, for instance when the system is near an\nequilibrium state, calculation of the coefficients Rij may\nbe difficult. Then a similarity matrix with the coefficients\nS2ij \u00bc\nh\u00f0Y i\u00f0t\u00de \u0006 Y j\u00f0t\u00de\u00de2iTffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nhY i\u00f0t\u00de2iT hY j\u00f0t\u00de2iT\nq\nmay be calculated.New types of clustering may be obtained by breaking\nthe natural constraint g1pg2 or by introducing a\nnon-zero level of cross-protection g0 between the\ndiscordant strains. For instance, the extremal case\ng25g1 generates a new type of cluster structure: four\nclusters of two neighbouring strains. Three different\ncluster structures,\n1 1 0 0 0 0 0 0\n1 1 0 0 0 0 0 0\n0 0 1 1 0 0 0 0\n0 0 1 1 0 0 0 0\n0 0 0 0 1 1 0 0\n0 0 0 0 1 1 0 0\n0 0 0 0 0 0 1 1\n0 0 0 0 0 0 1 1\n0\nBBBBBBBBBBBBB@\n1\nCCCCCCCCCCCCCA\n;\n1 0 0 1 0 0 0 0\n0 1 1 0 0 0 0 0\n0 1 1 0 0 0 0 0\n1 0 0 1 0 0 0 0\n0 0 0 0 1 0 0 1\n0 0 0 0 0 1 1 0\n0 0 0 0 0 1 1 0\n0 0 0 0 1 0 0 1\n0\nBBBBBBBBBBBBB@\n1\nCCCCCCCCCCCCCA\nand\n1 0 0 0 0 1 0 0\n0 1 0 0 1 0 0 0\n0 0 1 0 0 0 0 1\n0 0 0 1 0 0 1 0\n0 1 0 0 1 0 0 0\n1 0 0 0 0 1 0 0\n0 0 0 1 0 0 1 0\n0 0 1 0 0 0 0 1\n0\nBBBBBBBBBBBBB@\n1\nCCCCCCCCCCCCCA\n;\nare possible for this type. (It is noteworthy that these\ncluster structures are in the same orbit under the action\nof cube rotations.)\nFor a multi-strain system, the dynamics of a single\nstrain is sometimes chaotic4 (Gupta et al., 1998).\nHowever, under the same conditions which cause\nARTICLE IN PRESS\nV. Calvez et al. \/ Journal of Theoretical Biology 233 (2005) 75\u201383 81chaotic strain dynamics, clusters usually behave in a\nsurprisingly regular fashion. This regularity is hardly to\nbe expected a priori. To describe the cluster dynamics,\nfor each cluster, e.g. a; we define the relative force of\ninfection Ya\u00f0t\u00de of the cluster as\nYa\u00f0t\u00de \u00bc\nX\nj2a\nY j\nXn\ni\u00bc1\nY i\n,\n:\nNaturally, 0pYap1; Ya ! 1 when the cluster a\ndominates, and it tends to zero when one of the other\nclusters dominates. Fig. 7 illustrates the dynamics of the\ncluster a of the eight-strain system: it is easy to see that\nthe evolution of the relative force of infection of the\ncluster Ya\u00f0t\u00de is notably regular, while the dynamics of\nsingle strains is chaotic. The behaviour of the cluster b is\nqualitatively the same.\nThe tendency of the strains to self-organise into\nclusters, and the remarkable regularity of the dynamics\nof these clusters, contrasting to the chaotic behaviour of\na single strain, remains as the number of strains grows.\nWith an increasing number of strains, the number of\ncluster structures possible for the system grows as well,\nand new types of cluster structures appear. The 16-strain\nsystem, such that for each strain there are four loci with0 4 8 12 16 20\n0\n5\n10\n15\n20\n25\n30\nFo\nrc\nes\n o\nf i\nnf\nec\ntio\nn\n\u03b5=1e-3,\n\u03b31=0.64,\n\u03b32=0.8\nCluster \u03b1\n0 4 8 12 16 20\n0\n0.2\n0.4\n0.6\n0.8\n1\n\u03b5=1e-3,\n\u03b31=0.64,\n\u03b32=0.8\nTime\n\u2126\n\u03b1\n \nFig. 7. Dynamics of forces of infection and relative force of infection\nYa\u00f0t\u00de of the cluster a of the eight-strain system (Fig. 2) for the second\ntype of clustering. (Here e \u00bc 1\f 10\u00063; g1 \u00bc 0:64 and g2 \u00bc 0:8:) Note\nthat while the dynamics of each single strain is chaotic, the cluster as a\nwhole behaves remarkably regularly.two alleles possible at each locus, may be visualised as a\nfour-dimensional cube. We assume three levels of cross-\nprotection for this system: g1 if the strains share one\nallele, g2 if the strains share two alleles and g3 for the\nstrains sharing three alleles (naturally, g1pg2pg3). At\nleast six cluster structures of three different types are\npossible for this system. Particularly, if g3; g2 and g1 are\napproximately equal, a structure of eight clusters with\ntwo discordant strains each appears (each cluster\ncorresponds to a main diagonal of the four-dimensional\ncube; strains of a cluster are the ends of the diagonal). If\ng3 is sufficiently large compared with g1 and g2; then the\nsystem self-organises into two clusters of eight strains\neach. In this case the strains of a cluster share either no\nallele at all, or two alleles; there is no cluster with strains\nsharing one allele in this case. If both g3 and g2 are large\ncompared with g1; then a new stable type of cluster\nstructure appears. In this case eight clusters with two\nstrains each form. A structure of this type differs from\nthe above mentioned structure of the first type (eight\nclusters with two discordant strains each) as follows: in\nthis case the strains of each cluster share one allele which\nis at the same locus for every cluster of the structure.\nThat is for this cluster structure, the strains belong to the\ndiagonal of the three-dimensional sides of the four-\ndimensional cube whereas for the cluster structure of the\nfirst type the strains are those on the main diagonal of\nthe four-dimensional cube. Since there are four loci for\nthis system, four different structures of this type are\npossible.\nFor this system one may also expect formation of a\ncluster structure of four clusters with four strains each.\nHowever, such a cluster structure was not found for\nbiologically feasible coefficients g (that is for\ng1pg2pg3). We have been able to generate this cluster\nstructure only for g2 larger than g1 and g3:\nSelf-organisation of strains into clusters is not a\nparticular feature of the model considered. Computa-\ntions show that, for an ordered strain system given,\nthe same cluster structures arise for other models,\neven if the dynamics of these clusters differ. It appears\nthat a cluster structure is intrinsic to an ordered strain\nsystem.\nFor comparison purposes, we considered the models\nsuggested by Gog and Grenfell (2002), and Gog and\nSwinton (2002). The Gog and Grenfell model is a\ncomparatively simple SIR model composed for 2n\nclasses and purposed to investigate the role of cross-\nimmunity in antigenic drift with a large number of\nstrains. The model equations are\ndSi\ndt\n\u00bc m\u0006 Si\nXn\nj\u00bc1\ngijbjI j \u0006 mSi;\nd I i\ndt\n\u00bc biI iSi \u0006 riI i; \u00f04\u00de\nARTICLE IN PRESS\nV. Calvez et al. \/ Journal of Theoretical Biology 233 (2005) 75\u20138382where Si and I i are, respectively, the fractions of\nsusceptibles and infectives for the ith strain, and gii is\npostulated to be equal to one. In contrast, the Gog and\nSwinton model is a very complex model comprising n \u00fe\n2n classes. If ZJ denotes the individuals who are immune\nto all the strains of the set J \u0012 f1; . . . ; ng (thus they are\nsusceptibles to all the strains which are not in the set J)\nthen the system equations are:\n_I i \u00bc biI i\nX\nJ:ieJ\nZJ \u0006 \u00f0m\u00fe si\u00deI i;\n_ZJ \u00bc\nX\ni;K\nC\u00f0K ; J; i\u00debiI iZK \u0006\nX\nieJ\nbiI iZJ\n\u0006 mZJ \u00fe mdJ;;: \u00f05\u00de\nThe term C\u00f0K ; J; i\u00de represent the effect of cross-\nimmunity. In fact, it is the rate of transfer from\ncompartment K to compartment J after infection by\nthe strain i.\nDespite the huge difference in model complexity, both\nmodels demonstrate similarities in cluster formation.\nThe behaviour of both these systems is somewhat\nsimpler than that of Gupta\u2019s model. Particularly, no\nalternation of clusters was observed for these models:\ndepending on the system parameters, the phase trajec-\ntories of the system converge towards one of the system\nequilibria with damped oscillations. Nevertheless, the\nsame cluster structures were formed for both of these\nmodels. These cluster structures coincide with those for\nthe modified Gupta\u2019s model (3), and the values of the\ncross-protection parameters at which the system shifts\nfrom one type of structure to another vary insignif-\nicantly from one model to the others. For instance, for\nthe eight-strain system Fig. 2, the type of cluster\nstructure formed depends on the comparative values of\ngij : As in the case of the system (3), a structure of four\nclusters with two discordant strains each appears when\ng1 and g2 are comparatively close and, as the difference\nbetween g2 and g1 grows, a shift to the structure of the\nsecond type (two clusters with four strains each) occurs.\nHowever, in contrast to the model (3), no regular\noscillation of the clusters was observed: for both types of\ncluster structures solutions of the models tend to an\nequilibrium state.5. Conclusion\nStrains of a multi-strain infection tend to self-organise\ninto groups, or clusters. For a complex strain system\nseveral different types of cluster structures are possible\nand may arise. Which cluster structure occurs in reality\ndepends mostly on levels of cross-protection and, in\nsome cases, on initial conditions. It is important to note\nthe distinction between the terms \u2018\u2018cluster structure\u2019\u2019 and\n\u2018\u2018type of cluster structure\u2019\u2019, as several structures of thesame type are possible for complex strain systems.\nCluster structures which are possible for a strain system\ndo not depend on the particular model used. In fact, the\nstructures are fairly robust to different models. It\nappears that cluster structures of a particular strain\nsystem depend on the structure of the strain space and\non levels of cross-protection.\nIt is not clear why some cluster structures arise while\nothers do not. While clustering in the four-strain system\nis transparent enough, it is already not so clear why in\nthe eight-strain system the cluster structure of second\ntype (two clusters of four strains) appears. More\ncomplex systems, such as the sixteen-strain system, raise\neven more questions. For instance, it is not clear why no\nstructure of four clusters with four strains each is\npossible for biologically feasible coefficients of cross-\nprotection. It is a challenge to provide an exhaustive list\nof type of clustering which may occur for a given set of\nstrain.\nOne possible interpretation of the phenomenon is that\ncross-immunity, suppressing some strains, forms nega-\ntive feedback between the corresponding vertices of the\ngraph (such as in Figs. 1 and 2). This, in turn, induces a\npositive feedback on other vertices. The phenomenon of\nself-organisation of elements of an ordered system into\nclusters does not only occur in epidemiology: for\ninstance, similar examples are observed in neural\nnetworks, and we believe that it may occur in other\napplications. In fact, it appears to be general for coupled\ndynamical systems. Clustering is a type of self-organisa-\ntion similar to pattern formation.\nThe most remarkable feature of the clusters is that\nthey behave remarkably regularly (at least for ordered\nstrain sets), in contrast to the generally chaotic\nbehaviour of isolated strains. Furthermore, a cluster\nstructure, once formed, appears to be exceptionally\nstable. This stability implies that in many cases we can\n(and even should) consider the dynamics of a few\nclusters, instead of the dynamics of multiple separate\nstrains, reducing in this way the system size.References\nAndreasen, V., Lin, J., Levin, S.A., 1997. The dynamics of cocirculat-\ning influenza strains conferring partial cross-immunity. J. Math.\nBiol. 35, 825\u2013842.\nAnishchenko, V.S., Astakhov, V.V., Neiman, A.B., Vadivasova, T.E.,\nSchimansky-Geier, L., 2002. Nonlinear Dynamics of Chaotic and\nStochastic Systems. Springer, Berlin.\nCliff, A.D., Haggett, P., Ord, J.K., 1986. Spatial Aspects of Influenza\nEpidemics. Pion, London.\nDawes, J.H.P., Gog, J.R., 2002. The onset of oscillatory dynamics in\nmodels of multiple disease strains. J. Math. Biol. 45, 471\u2013510.\nGog, J.R., Grenfell, B.T., 2002. Dynamics and selection of many-strain\npathogens. Proc. Natl Acad. Sci. 99, 17209\u201317214.\nGog, J.R., Swinton, J., 2002. A status-based approach to multiple\nstrain dynamics. J. Math. Biol. 44, 169\u2013184.\nARTICLE IN PRESS\nV. Calvez et al. \/ Journal of Theoretical Biology 233 (2005) 75\u201383 83Gupta, S., Anderson, R.M., 1999. Population structure of pathogens:\nthe role of immune selection. Parasitol. Today 15, 497\u2013501.\nGupta, S., Trenholme, K., Anderson, R.M., Day, K.P., 1994.\nAntigenic diversity and the transmission dynamics of Plasmodium\nfalciparum. Science 263, 961\u2013963.\nGupta, S., Maiden, M.C.J., Feavers, I.M., Nee, S., May, R.M.,\nAnderson, R.M., 1996. The maintenance of strain structure in\npopulations of recombining infectious agents. Nat. Med. 2,\n437\u2013442.\nGupta, S., Ferguson, N., Anderson, R.M., Chaos, 1998. Persistence,\nand evolution of strain structure in antigenically diverse infectious\nagents. Science 280, 912\u2013915.\nLin, J., Andreasen, V., Levin, S.A., 1999. Dynamics of influenza A\ndrift: the linear three-strain model. Math. Biosci. 162, 33\u201351.Plotkin, J.B., Dushoff, J., Levin, S.A., 2002. Hemagglutinin sequence\nclusters and the antigenic evolution of influenza A virus. Proc. Natl\nAcad. Sci. 99, 6263\u20136268.\nRubin, J., Terman, D., 2000a. Geometric analysis of population\nrhythms in synaptically coupled neuronal networks. Neural\nComput. 12, 597\u2013645.\nRubin, J., Terman, D., 2000b. Analysis of clustered firing patterns in\nsynaptically coupled networks of oscillators. J. Math. Biol. 41,\n513\u2013545.\nTerman, D., Lee, E., 1997. Partial synchronization in a network of\nneural oscillators. SIAM J. Appl. Math. 57, 252\u2013293.\nTerman, D., Kopell, N., Bose, A., 1998. Dynamics of two\nmutually coupled slow inhibitory neurons. Physica D 117,\n241\u2013275.\n"}