{"doi":"10.1109\/TAC.2003.822865","coreId":"100802","oai":"oai:epubs.surrey.ac.uk:199","identifiers":["oai:epubs.surrey.ac.uk:199","10.1109\/TAC.2003.822865"],"title":"Nonlinear H controllers for electromagnetic suspension systems","authors":["Sinha, PK","Pechev, AN"],"enrichments":{"references":[{"id":761794,"title":"Dissipative dynamical systems Part I: General theory,\u201d","authors":[],"date":"1972","doi":null,"raw":null,"cites":null},{"id":760537,"title":"Electromagnetic Suspension: Dynamics & Control.","authors":[],"date":"1987","doi":null,"raw":null,"cites":null},{"id":763616,"title":"Fault detection in electromagnetic suspension systems with state estimation methods,\u201d","authors":[],"date":"1993","doi":"10.1109\/20.280907","raw":null,"cites":null},{"id":764926,"title":"H -control for maglev vehicles,\u201d","authors":[],"date":"1998","doi":"10.1109\/37.710875","raw":null,"cites":null},{"id":762432,"title":"H control for nonlinear systems with output feedback,\u201d","authors":[],"date":"1993","doi":null,"raw":null,"cites":null},{"id":762955,"title":"H control via measurement feedback for general nonlinear systems,\u201d","authors":[],"date":"1995","doi":null,"raw":null,"cites":null},{"id":761240,"title":"L -gain analysis of nonlinear systems and nonlinear state feedbackH control,\u201d","authors":[],"date":"1992","doi":null,"raw":null,"cites":null},{"id":760568,"title":"Model reference adaptive control of a Maglev system with stable maximum descent criterion,\u201d","authors":[],"date":"1999","doi":null,"raw":null,"cites":null},{"id":763026,"title":"On the optimal stabilization of nonlinear systems,\u201d","authors":[],"date":"1962","doi":null,"raw":null,"cites":null},{"id":764271,"title":"State-space solutions to standard H and H control problems,\u201d","authors":[],"date":"1989","doi":"10.1109\/9.29425","raw":null,"cites":null},{"id":764961,"title":"synthesis of an electromagnetic suspension system,\u201d","authors":[],"date":"1995","doi":"10.1109\/9.376075","raw":null,"cites":null},{"id":759303,"title":"The Economist: \u201cThe New Age of the Train: A Better Way to Fly\u201d, The Economist,","authors":[],"date":"1998","doi":null,"raw":null,"cites":null},{"id":759894,"title":"The Shanghai-Pudon Airport Highspeed Link, Transrapid International,","authors":[],"date":"2001","doi":null,"raw":null,"cites":null},{"id":761826,"title":"The stability of nonlinear dissipative systems,\u201d","authors":[],"date":"1976","doi":null,"raw":null,"cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2004-04","abstract":"This note presents a unified framework to derive nonlinear H state and output feedback controllers for magnetically levitated (Maglev) vehicles with controlled dc electromagnets, referred to as electromagnetic suspension systems. The theoretical exposition, based on the Taylor series expansion solution to the Hamilton-Jacobi-Isaacs inequality, is followed by an assessment of some of the practical issues in realizing the nonlinear controllers with a digital signal processor and embedded hardware. A select set of experimental results from a single-degree-of-freedom suspension system is included to highlight the effectiveness of the proposed nonlinear state- and output-feedback H controllers to suppress guideway-induced disturbances","downloadUrl":"","fullTextIdentifier":null,"pdfHashValue":null,"publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:epubs.surrey.ac.uk:199<\/identifier><datestamp>\n      2017-10-31T13:57:08Z<\/datestamp><setSpec>\n      74797065733D61727469636C65<\/setSpec><setSpec>\n      6469766973696F6E733D656E67616E64706879736963616C736369656E636573:656C656374726F6E6963656E67696E656572696E67:535343<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/epubs.surrey.ac.uk\/199\/<\/dc:relation><dc:title>\n        Nonlinear H controllers for electromagnetic suspension systems<\/dc:title><dc:creator>\n        Sinha, PK<\/dc:creator><dc:creator>\n        Pechev, AN<\/dc:creator><dc:description>\n        This note presents a unified framework to derive nonlinear H state and output feedback controllers for magnetically levitated (Maglev) vehicles with controlled dc electromagnets, referred to as electromagnetic suspension systems. The theoretical exposition, based on the Taylor series expansion solution to the Hamilton-Jacobi-Isaacs inequality, is followed by an assessment of some of the practical issues in realizing the nonlinear controllers with a digital signal processor and embedded hardware. A select set of experimental results from a single-degree-of-freedom suspension system is included to highlight the effectiveness of the proposed nonlinear state- and output-feedback H controllers to suppress guideway-induced disturbances.<\/dc:description><dc:date>\n        2004-04<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/epubs.surrey.ac.uk\/199\/1\/fulltext.pdf<\/dc:identifier><dc:identifier>\n          Sinha, PK and Pechev, AN  (2004) Nonlinear H controllers for electromagnetic suspension systems   IEEE Transactions on Automatic Control, 49 (4).  pp. 563-568.      <\/dc:identifier><dc:relation>\n        10.1109\/TAC.2003.822865<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/epubs.surrey.ac.uk\/199\/","10.1109\/TAC.2003.822865"],"year":2004,"topics":[],"subject":["Article","PeerReviewed"],"fullText":"IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 49, NO. 4, APRIL 2004 563\nTechnical Notes and Correspondence_______________________________\nNonlinear Controllers for Electromagnetic\nSuspension Systems\nP. K. Sinha and A. N. Pechev\nAbstract\u2014This note presents a unified framework to derive nonlinear\nstate and output feedback controllers for magnetically levitated (Ma-\nglev) vehicles with controlled dc electromagnets, referred to as electromag-\nnetic suspension systems. The theoretical exposition, based on the Taylor\nseries expansion solution to the Hamilton\u2013Jacobi\u2013Isaacs inequality, is fol-\nlowed by an assessment of some of the practical issues in realizing the non-\nlinear controllers with a digital signal processor and embedded hardware.\nA select set of experimental results froma single-degree-of-freedom suspen-\nsion system is included to highlight the effectiveness of the proposed non-\nlinear state- and output-feedback controllers to suppress guideway-in-\nduced disturbances.\nIndex Terms\u2014 controllers, digital signal processors, electromagnetic\nsuspension systems, embedded control, Maglev, magnetic levitation, non-\nlinear systems.\nI. INTRODUCTION\nWith the construction of the Shanghai city-Pudon international air-\nport link in the Peoples Republic of China and the Hamburg\u2013Berlin\nintercity route in Germany, magnetic levitation (Maglev) using elec-\ntromagnetic suspension technology has come of age [1], [2]. The elec-\ntromagnetic suspension (EMS) provides noncontacting suspension by\nmeans of dc electromagnets in conjunction with a position regulator\nusing position (= airgap), velocity and acceleration feedback. Linear\ncontrol theories have provided much of the benchmark design proce-\ndures for numerous full-scale vehicles in large test facilities [3]. How-\never, due to constraints of linearization, the resulting time- and fre-\nquency-domain controllers have restricted capability to cope with sig-\nnificant changes in the suspended load (payload and disturbance force)\nor large variations in the guideway profile. An adaptive controller to\ncompensate for payload variations and external force disturbances has\nbeen presented earlier [4]. This note develops a unified account for the\nderivation of nonlinear H1 state and output feedback controllers to\nattenuate the effects of guideway-induced oscillations on suspension\nstability of the EMS system.\nII. NONLINEAR MODEL OF THE EMS SYSTEM\nA schematic of a single-degree-of-freedom suspension system with\na controlled dc electromagnet is shown in Fig. 1. The vehicle module,\nwith its suspension magnet and payload (total mass m), travels under\nthe fixed reaction surface (track or guideway); the linear propulsion\nManuscript received April 18, 2002; revised December 16, 2002. Recom-\nmended byAssociate Editor K.M.Grigoriadis. Equipment and software support\nfrom Analog Devices and financial support from Jupelier Technology during\nthis basic research project are gratefully acknowledged.\nP. K. Sinha is with theDepartment of Engineering, TheUniversity of Reading,\nReading RG6 6AY, U.K. (e-mail: p.k.sinha@rdg.ac.uk).\nA. N. Pechev is with the Cardiff School of Engineering, Cardiff University,\nCardiff CF24 0YF, U.K.\nDigital Object Identifier 10.1109\/TAC.2003.822865\nmotor is not shown in this illustration. Using the notations given in\nFig. 1, the vertical dynamics is described by [3]\nm\nd2z(t)\ndt2\n= \u0000 F (i; z; t) + fd+mg\n= \u0000\n\u00160N\n2am\n4\ni(t)\nz(t)\n2\n+fd+mg\ndi(t)\ndt\n=\ni(t)\nz(t)\ndz(t)\ndt\n\u0000\n2\n\u00160N2am\nz(t)(Rmi(t)\u0000u(t)): (1)\nDefining a state vector x(t) = [ z(t) _z(t) i(t) ]T 2 <n, n = 3 and\nan external disturbance vector w(t) = [w1(t) w2(t) ]T ;2 <l, l =\n2, (1) yields the following nonlinear state-spacemodel of the open-loop\nsuspension system:\n_x1(t)\n_x2(t)\n_x3(t)\n=\nx2(t)\n\u0000\n\u0016 N a\n4m\nx (t)\nx (t)\n2\n\u00002R\n\u0016 N a\nx1(t)x3(t) +\nx (t)x (t)\nx (t)\n+\n0 0\n1\nm\n\u000b1 0\n0 0\nw1(t)\nw2(t)\n+\n0\n0\n2\n\u0016 N a\nx1(t)\nu(t)\n_x(t) =A(x(t)) +B1(x(t))w(t)+B2(x(t))u(t) (2a)\ny(t) = [ 1 0 0 ]\nx1(t)\nx2(t)\nx3(t)\n+ [ 0 \u000b2 ]\nw1(t)\nw2(t)\n=C2x(t) +D21w(t) (2b)\nwith \u000b1 and \u000b2 as gains of the two disturbance inputs: w1(t) [=\nforce disturbance, fd] andw2(t) [= track or guide way disturbance,\nztrack(t)]. While a predefined stability margin around a nominal\noperating point (i0, z0) is readily provided by a linear state feedback\ncontrol law of the form (zref = reference airgap)\nu(t) = kpfx1(t)\u0000 zrefg+ kvx2(t) + kax3(t) (3)\nwhere kp influences the steady-state error and hence stiffness,\nkv controls suspension damping and ka overall stability margin,\nlinear controllers have limited ability to suppress guideway-induced\ndisturbances. The track oscillating mechanism in the experimental\nrig shown in Fig. 1 has specifically been added to emulate vertical\nmovement of the guideway as the vehicle travels along. The analytical\nderivations presented in this note demonstrate that the H1 control\nmethodology offers a convenient design framework to deal with the\neffects of such external disturbances with respect to a user-defined\npenalty vector q(t) 2 <n+1 (Fig. 2)\nq(t) =\nq1\nq2\nq3\nq4\n=\n\f1 0 0\n0 \f2 0\n0 0 \f3\n0 0 0\nx1\nx2\nx3\n+\n0\n0\n0\nWu\nu\n=C1x+D12u (4)\nwhere Wu is a weight on the control signal and C1 2 <(n+1)\u0002n is a\nscaling matrix chosen to define the relative influence of the state vari-\nable in the construction of the penalty vector. The objective of the non-\n0018-9286\/04$20.00 \u00a9 2004 IEEE\nAuthorized licensed use limited to: University of Surrey. Downloaded on June 5, 2009 at 09:16 from IEEE Xplore.  Restrictions apply.\n564 IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 49, NO. 4, APRIL 2004\nFig. 1. Magnet-guideway configuration of the experimental system used in this note. Guideway disturbance is introduced by the oscillating mechanism on the\ntop left corner. Notations: m = mass; f = force disturbance; g = gravitational acceleration;N = number of turns in the magnet winding; a =\nmagnet pole face area; R = magnet winding resistance.\nlinear design procedure developed here is to identify a class of feedback\ncontrollers that satisfies the L2-gain inequality [5]\nT\n0\nkq(t)k2dt \u0014 \r2\nT\n0\nkw(t)k2dt; 0 \u0014 \r \u0014 1 (5)\nby keeping the energy of the penalty vector q(t) bounded and smaller\nthan the energy of the disturbance inputw(t). Because of this bounded\nenergy notion, the concepts of dissipativity and storage function [6],\n[7] are adopted here. It has been established that the equilibrium point\nof a dissipative dynamical system is stable if for x(t)jt=0 = 0, there\nexists a nonnegative smooth storage function V (x(t)) that satisfies the\nHamilton\u2013Jacobi\u2013Isaacs (HJI) inequality [8], [9]\nVx(x)\nT [A(x) +B1(x)w+B2(x)u]\n+ [C1x+D12u]\nT [C1x +D12u]\u0000 \r\n2wTw \u0014 0 (6)\n(where Vx(x) = @V (x(t))=@x(t); for notational simplicity, time (t)\nis dropped in subsequent derivations). In subsequent derivations, the\nwhole left-hand side of the HJI inequality is denoted as the Hamiltonian\nfunction H[x; Vx(x); w; u]. The premise of the proposed algorithm is\nthat any feedback control law that satisfies the HJI inequality will yield\na stable closed-loop system; i.e., the closed-loop system is locally dissi-\npative with respect to its supply rate. As local dissipativity also implies\nthe existence of storage function, the H1 design in this context may\nbe recast as the problem of deriving a class of control laws and their\ncorresponding storage functions which satisfy (6)\nIII. NONLINEAR H1 STATE FEEDBACK\nThe general configuration of the closed-loop system is shown in\nFig. 2, where the unknown disturbance inputs w1 andw2 are force and\ntrack disturbances with the penalty vector q being defined in (4).\nAs the design criterion is to findu(x) that satisfies theHJI inequality,\nthe analytical derivations are focussed on finding a saddle point in the\nHamiltonian function such that\nH x; Vx(x); w;\n^\nu \u0014H x; Vx(x);\n_\nw\n^\nu \u0014H x; Vx(x);\n_\nw; u\n(7)\nwith _w as the worst disturbance input that maximizes H(\u000f) and ^u\nas the control input that minimizes H(\u000f). With D = DT12D12 and\nCT1 D12 = 0 for the Maglev model, these are given by [5], [8], [9]\n_\nw =\n_\nwfx; Vx(x)g =\n1\n2\n\r\u00002B1(x)\nTVx(x)\n^\nu =\n^\nufx; Vx(x)g = \u0000\n1\n2\nD\u00001B2(x)\nTVx(x): (8a)\nTo compute the unknown storage function V (x(t)) that satisfies the\nabove saddle point condition, (8a) is substituted into (6) to give the\nfollowing HJI inequality:\nH\u0003[x; Vx(x)]=Vx(x)\nTA(x)\u0000\n^\nu\nT\nD\n^\nu+xTCT1 C1x+\r\n2_w\nT _\nw\u00140:\n(8b)\nIn the absence of an analytical solution, (8b) is transformed into an\ninfinite sum inequality by Taylor series (originally proposed in [10])\nwith the kth power term as\nVx(x)\n[2]TA(x)[k] + \u0001 \u0001 \u0001+ Vx(x)\n[k+1]TAx[1] \u0000\n^\nu\n[1]T\nD\n^\nu\n[k]\n\u0000\u0001 \u0001 \u0001 \u0000\n^\nu\n[k]T\nD\n^\nu\n[1]\n+xTCT1 C1x\n+ \r2\n_\nw\n[1]T_\nw\n[k]\n+\u0001 \u0001 \u0001+\n_\nw\n[k]T_\nw\n[1]\n\u00140 (9)\nwhere Ax[1]; A(x)[2]; . . .A(x)[k] are the first, second, . . . ; kth terms\nin the Taylor series expansion ofA(x) in (2a). Application of the same\npower series expansion to (8a) gives the following generic relationships\nfor the worst disturbance vector and the input control signal for any kth\norder term\n_\nw\n[k]\n=\n1\n2\n\r\u00002 B\n[1]T\n1 Vx(x)\n[k+1] + \u0001 \u0001 \u0001+B1(x)\n[k]TVx(x)\n[2]\n^\nu\n[k]\n=\u0000\n1\n2\nD\u00001 B\n[1]T\n2 Vx(x)\n[k+1]+\u0001 \u0001 \u0001+B2(x)\n[k]TVx(x)\n[2] (10)\nwhere B[j]1 ; B\n[j]\n2 and Vx(x)[j+1]; j = 1; . . . k; are the Taylor series\nexpansion of the system in (1) and the storage function V (x). The\ngeneric properties of these power series provide a mechanism to build\nup higher order controllers cumulatively, as given as follows for first-\nand second-order controllers.\na) First-order controller, ^u = ^u [1], with ^u [1] given with k = 1\nin (10)\ncontrol input!\n^\nu\n[1]\n=\u0000\n1\n2\nD\u00001B\n[1]T\n2 Vx(x)\n[2]\n(11a)\nAuthorized licensed use limited to: University of Surrey. Downloaded on June 5, 2009 at 09:16 from IEEE Xplore.  Restrictions apply.\nIEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 49, NO. 4, APRIL 2004 565\nworst disturbance vector!\n_\nw\n[1]\n=\n1\n2\n\r\n\u00002\nB\n[1]T\n1 Vx(x)\n[2]\n(11b)\nHJI inequality!Vx(x)\n[2]T\nAx\n[1]\u00002\n^\nu\n[1]T\nD\n^\nu\n[1]\n+2\r2\n_\nw\n[1]T_\nw\n[1]\n+ xTCT1 C1x \u0014 0:\n(11c)\nb) Second-order controller,^u = ^u [1]+^u [2], where^u [2] is given\nwith k = 2 in (10)\n^\nu\n[2]\n= \u0000\n1\n2\nD\n\u00001\nB\n[1]\n2 Vx(x)\n[3] +B2(x)\n[2]T\nVx(x)\n[2] (12a)\n_\nw\n[2]\n=\n1\n2\n\r\n\u00002\nB\n[1]T\n1 Vx(x)\n[3] +B1(x)\n[2]T\nVx(x)\n[2] (12b)\nVx(x)\n[2]T\nA(x)[2] + Vx(x)\n[3]T\nAx\n[1] \u0000\n^\nu\n[1]T\nD\n^\nu\n[2]\n\u0000\n^\nu\n[2]T\nD\n^\nu\n[1]\n+ \r2\n_\nw\n[1]T_\nw\n[2]\n+\n_\nw\n[2]T_\nw\n[1]\n\u0014 0:\n(12c)\nA. Numerical Results\nTo derive the above nonlinear H1 state-feedback controllers, the\nTaylor-series-expansions for the Maglev system in (2) is derived as in\n(13a) for a nominal operating point z0 = 4:0\u0002 10\u00003 m, i0 = 3:13 A\nwithN = 280,m = 1:5 kg, am = 1:024\u000210\u00002m2 andRm = 1:1\n\nA(x)=Ax[1]+A(x)[2]\n=\n0 1 0\n\u0016 N a\n2m\ni\nz\n0 \u0000 \u0016 N a\n2m\ni\nz\n\u00002R\n\u0016 N a\n\u0000 _z\nz\ni0\ni\nz\n\u00002R\n\u0016 N a\n+ _z\nz\nx1\nx2\nx3\n+\n0\n\u0000\u0016 N a\n4m\n3i\nz\nx21+\n1\nz\nx23 \u0000\n4i\nz\nx1x3\n\u0000 i\nz\nx1x2+\n\u00002R\n\u0016 N a\n\u0000 _z\nz\nx1x3+\n1\nz\nx2x3+\n_z i\nz\nx21\nB1(x) =B\n[1]\n1 +B1(x)\n[2] =\n0 0\n1\nm\n\u000b1 0\n0 0\n+ 0;\nB2(x)=B\n[1]\n2 +B2(x)\n[2]=\n0\n0\n2\n\u0016 N a\nz0\n+\n0\n0\n2\n\u0016 N a\n[x1 \u0000 z0]\n;\nD =DT12D12 =W\n2\nu : (13a)\nIt can be shown that for a dissipative system to be stable, the storage\nfunction has the characteristic features of a Lyapunov function with\na strong local minimum at the equilibrium point [6]. To derive ^u [1],\nV (x)[2] is taken as the quadratic function V (x)[2] = xTPx, with P >\n0 being unknown, the HJI inequality in (11c) then holds good if P\nsatisfies the Riccati equation in (13b)\nH1\u0003 = A\n[1]T\nP + PA[1]\n+P \r\u00002B\n[1]\n1 B\n[1]T\n1 \u0000B\n[1]\n2 D\n\u00001\nB\n[1]T\n2 P + C\nT\n1 C1 = 0: (13b)\nAssigning the values \u000b1 = \u000b2 = 1, \f = I3,Wu = 0:12 and \r = 1\nin the series expansion matrices shown previously, a solution of (13)\n(using Matlab algebraic Riccati equation routine) gives\nP =\n5:5198\u0002 104 6:3994\u0002 102 \u00004:7601\n6:3994\u0002 102 7:5823 \u00005:2934\u0002 10\u00002\n\u00004:7601 \u00005:2934\u0002 10\u00002 1:0844\u0002 10\u00003\n:\nThe corresponding first-order control law and the disturbance signals\nare then derived from (11) and given in (14).\n^\nu\n[1]\n=262:13\u0002 102x1 + 291:5x2 \u0000 5:972x3 (14a)\n_\nw\n[1]\n=\n_\nw\n[1]\n1\n_\nw\n[2]\n2\n=\n4:647\u0002104x1+5:534x2\u00003:822\u000210\n\u00002x3\n0\n:\n(14b)\nTo derive the second-order controller, ^u = ^u\n[1]\n+\n^\nu\n[2]\n, V (x)[3] is\ndefined as the cubic polynomial V (x)[3] = c1x31+c2x21x2+c3x21x3+\n\u0001 \u0001 \u0001+c9x2x\n2\n3+c10x\n3\n3, where the unknown coefficients fcig ; i = 1::10;\nare to be derived from the second-order HJI equation in (12c), rewritten\nas (15) with V (x)[2],^u [1] and_w[1] taken from the first-order controller\nVx(x)\n[3]\nAx\n[1]+B\n[1]T\n1\n_\nw\n[1]\n+B\n[1]T\n2\n^\nu\n[1]\nx\n+Vx(x)\n[2]\nA(x)[2]+B1(x)\n[2]T_w\n[1]\n+B2(x)\n[2]T^u\n[1]\n=0:\n(15)\nEquating terms in (15) with equal powers leads to a set of ten equations.\nSolution of these equations using the Gauss\u2013Seidel elimination method\ngives the values for the unknown coefficients fcig ; i = 1; . . . ; 10\nand hence the unknown storage function V (x)[3]. With the parameters\ngiven earlier, the second-order controller in (11a) and (12a) becomes\n^\nu(x) = f\n^\nu\n[1]\ng+ f\n^\nu\n[2]\ng\n= f262:13\u0002 102x1 + 291:5x2 \u0000 5:972x3g\n\u0000f483:88\u0002 103x21 \u0000 574:38\u0002 10\n2\nx1x2 \u0000 4392:37x1x3\n\u0000 194:32x22 \u0000 31:80x2x3 + 0:403x\n2\n3g: (16)\nThis second-order controller has been implemented on the experi-\nmental single-degree-of-freedom system; the controller\u2019s performance\nin attenuating track disturbance is discussed in Section VI.\nIV. NONLINEAR H1 OUTPUT FEEDBACK\nAlthough all state variables are available for feedback in a Maglev\nvehicle suspension system, results Section III are extended to output\nfeedback for two reasons: a) use of H1 controllers to other applica-\ntions, such as magnetic bearings which usually employ only position\nsensors; and b) provide a basis for further work related to sensor fault\naccommodation [11]. The output feedback control law derived here\nuses a state estimator in conjunction with the same state-feedback con-\ntrol law in (16). For uniformity in the design procedure, the nonlinear\nstate estimator [(17)] is derived using the concept of local dissipation\ndescribed earlier [9].\n_~x =A(~x) +B1(~x)w +B2(~x)u+Q(~x)(y \u0000 ~y)\n~y =C2~x+D21w (17)\nwhere ~x is the estimator state vector and ~y is the estimator output.\nIn general, the unknown output gain Q(~x) has a nonlinear structure;\nan approximate solution maybe derived by using the same procedure\nbased on Taylor series expansions as in Section IV. The corresponding\nfirst-order solution for Q[1] is then derived as [9]\n(R\u0000 P )Q[1] = D21D\nT\n21\n\u00001\nD21B\n[1]T\n1 R+ \r\n2\nC\nT\n2 (18a)\nAuthorized licensed use limited to: University of Surrey. Downloaded on June 5, 2009 at 09:16 from IEEE Xplore.  Restrictions apply.\n566 IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 49, NO. 4, APRIL 2004\nFig. 2. (a) State-feedback and (b) output-feedback control configurations.\nwhere P defines the storage function V (x)[2] as computed in the state\nfeedback controller derivation and R is the solution of the following\nRiccati equation:\nA[1] \u0000B\n[1]\n1 D\nT\n21 D21D\nT\n21\n\u00001\nC2\nT\nR\n+R A[1] \u0000B\n[1]\n1 D\nT\n21 D21D\nT\n21\n\u00001\nC2\n+R \r\u00002B\n[1]\n1 B\n[1]T\n1 \u0000B\n[1]\n1 D\nT\n21 D21D\nT\n21\n\u00001\nD21B\n[1]T\n1 R\n+ CT1 C1 \u0000 \r\n2CT2 D21D\nT\n21\n\u00001\nC2 \u0000H1\u0003 = 0 (18b)\nwith H1 as defined on the left-hand side of (13b). For the Maglev\nsystem with parameters in Fig. 1 and the value of P as computed in\nSection III.A, the solutions for R and Q[1] are derived as\nR =\n9:6628\u0002 1011 \u00002:8380\u0002 107 \u00009:3912\u0002 108\n\u00002:8379\u0002 107 2:4514\u0002 104 \u00001:2372\u0002 105\n\u00009:3912\u0002 108 \u00001:2372\u0002 105 2:4921\u0002 106\nand\nQ[1] =\n8:1733\u0002 103\n33:401\u0002 106\n47:382\u0002 105\nwith the corresponding state estimator given by (19), as shown at the\nbottom of the page. Solution of these nonlinear equations gives the es-\ntimated state variables ~x1, ~x2 and ~x3 which are then used in (16) to\nimplement the output feedback controller using the configuration in\nFig. 2(b); performance of the resulting controller is discussed in Sec-\ntion VI.\nV. CONTROL HARDWARE\nAs part of a hardware design project for commercialMaglev vehicles\nand magnetic bearings, an Analog Devices Sharc 21 062 DSP-based\nembedded controller hardware has been manufactured by the authors\nand their industrial collaborators [12]. It integrates Ethernet\/TCP\/IP\ncommunication facilities and software functions for real-time commu-\nnication withMatlab\/SIMULINK environment. The sampling time has\nbeen chosen to be l ms for compatibility with the typical inductance\nvalues of the windings of suspensionmagnets and the cut-off frequency\nof the anti-aliasing filter set at 25 kHz [= (1=2) of per-channel sam-\npling rate of ADC]. The main tasks performed in each sample are: data\ncapture and conversion (including integration of the acceleration signal\nto generate velocity), execution of the control law, outputting of the\ncontrol signal and storing data for offline analysis (the embedded hard-\nware offers up to 4 Mbytes of onboard RAM). Each sample is inter-\nrupt-driven from the internal timer of the DSP. The software written\nin C\/assembler for SHARC DSP\u2019s offers facilities to serve host-based\nMatlab visualization. The analogue processing tasks consume 5% to\n8% of the sampling time and the nonlinear state-feedback ((16)) a fur-\nther 5%\u201340%, the remainder being used to serve the host.\nTo implement an output-feedback controller (state estimator + state-\nfeedback controller) on an embedded hardware, the classical linear\ncontrol would require a transformation from the continuous time-do-\nmain to a discrete time-domain. Because of the nonlinear nature of the\nobserver [(19)], this procedure is inapplicable. The scheme adopted\nhere to overcome this limitation is to include a Runge\u2013Kutta solver\nwithin the control loop. In doing so at every sample, the software on the\nDSP reads the most recent output of the system and multiplies it by the\noutput injection gain Q[1]. The set of first-order differential equations\nin (19) is then integrated by a dedicated Runge-Kutta-4 integration rou-\ntine. For satisfactory convergence of this integration process, experi-\nence suggested that around 50 steps, each of length h = 10\u00005, are\ntypically required for reasonable estimation of the state vector ~x50 =\n[ ~x1 ~x2 ~x3 ]\nT\n50. At the end of the 50th step, final values of these three\nstate variables are taken as the input to the nonlinear state-feedback\ncontroller ((16)). The full collection of software tasks for nonlinear\noutput-feedback control takes around 400 \u0016s per cycle; the remaining\n600 \u0016s of the sampling time is available to serve the host.\nVI. EXPERIMENTAL RESULTS\nThe oscillating mechanism in Fig. 1 is capable to introducing step\nchange as well as periodic motion of the guideway. The vertical\nprofile of the guideway is measured by a noncontacting position\nsensor mounted on a fixed datum. Fig. 3 shows responses of the\nsuspension system with a step change in the guideway position\n(ztrack) and a step change in the reference airgap (zref ) for three\ntypes of controllers: linear state-feedback, second order nonlinear\nstate-feedback and the nonlinear output-feedback. The first-order\nnonlinear state-feedback control law in (14a) was also implemented,\nbut as the corresponding step responses almost overlapped with those\nwith the linear state-feedback control law in (3), they are not included.\nThe responses in Fig. 3 indicate that the new nonlinear controllers\nimprove the overall settling time almost by a factor of two, compared\nwith the conventional linear state feedback controller. The reduction in\novershoots in Fig. 3 (curve-3) indicates that, within the definitions of\nlinear systems, peak amplitude in the sensitivity function will remain\nbelow the 0-dB boundary. To study this further, a series of experiments\nwas carried out with sinusoidal variations in the guideway position.\nAt each run, the system is suspended at a fixed zref , the track is\noscillated and the airgap and the guideway positions recorded. Fourier\nanalysis is then performed on these data to determine the fundamental\nfrequency of the guideway profile and the attenuation rate of the airgap\nerror (zref \u0000 z). Initially, these experiments were performed with a\nlinear state-feedback controller ((3)); the corresponding response for\nthe highest frequency is shown in Fig. 4 (top, with attenuation rates\nas given). These experiments were repeated over the whole of the\n_~x1\n_~x2\n_~x3\n=\n\u00008173:3~x1 + ~x2 + 8173:3y\n\u000033:4\u0002 106~x1 + 7:99~x2 + 159\u0002 10\n\u00003~x3 + 0:168\u0002 10\n\u00004 ~x\n~x\n+ 33:4\u0002 106y\n\u00004738:2\u0002 103~x1 + 0:7508\u0002 10\n7~x1~x2 \u0000 151:461\u0002 10\n7~x1~x3 + 0:5406\u0002 10\n9~x21 +\n~x ~x\n~x\n+ 47:382\u0002 105y\n: (19)\nAuthorized licensed use limited to: University of Surrey. Downloaded on June 5, 2009 at 09:16 from IEEE Xplore.  Restrictions apply.\nIEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 49, NO. 4, APRIL 2004 567\nFig. 3. Experimental and simulation transient responses. Top: step\nchange in airgap reference z from 2.75 mm to 2.0 mm with clamped\nguideway. (1) Linear state-feedback controller (3) with k = 207:923,\nk = 1:5 and k = 0:00424. (2) Experimental responses with nonlinear\nstate-feedback controller (16) and (2a) the corresponding simulation response.\n(3) Experimental response with nonlinear output-feedback controller (16)\nand (19) and (3a) the corresponding simulation response. Nominal operating\nconditions for all controllers are i = 3:13 A and z = 4:0 mm. Bottom:\nExperimental responses due to a step change in guideway position (z kept\nconstant at 2.5 mm) with controller parameters as above.\nfrequency range for which the system maintained a stable suspension\nand the corresponding sensitivity function (curve-1) is plotted in\nFig. 5; bandwidth of the closed-loop system with linear state feedback\ncontroller was observed to be around 9.5 Hz with the peak value\nof its sensitivity function being 6 dB. Consequently, disturbances\nwith frequencies \u0019 15 Hz will be amplified nearly by a factor of\ntwo, leading to an unacceptable operation (airgap error rising up to\ntwo times the guideway variation). Although there was insignificant\ndifference between the step responses of the linear state feedback and\nthe nonlinear first-order state feedback controllers, the latter was seen\nto have a narrower bandwidth but a lower peak (curve-2 in Fig. 5). The\nabove sequence of operations was also performed with the nonlinear\nsecond-order state-feedback controller and the nonlinear output-feed-\nback controller over the same range of frequencies. The corresponding\nresponses for 15.63 Hz are shown in Fig. 4 (middle and bottom). The\nrespective experimentally derived frequency responses are marked\nas curves 3 and 4 in Fig. 5. To provide a basis for comparison with\ntheoretical results, frequency responses with nonlinear state feedback\nand output feedback controllers from simulation studies have been\nincluded in Fig. 5 (dotted lines). These, along with the simulated step\nresponse in Fig. 3, underline the overall effectiveness of the proposed\ncontrol architecture.\nTwo specific observations may be made from the shapes of the sen-\nsitivity function (Fig. 5): a) bandwidth is increased, giving increased\nattenuation in the low-frequency range; and b) the increase in energy\non the output remains bounded by \r = 1 and hence the inequality in\n(5) is satisfied. Consequently, at low frequencies (< 10Hz) the magnet\nFig. 4. Experimental responses with sinusoidally oscillating track. Top: linear\nstate-feedback controller (3); middle: nonlinear second-order state-feedback\ncontroller (16); bottom: nonlinear output-feedback H controller (16) and\n(19).\nwill follow the guideway profile satisfactorily and at higher frequencies\nit would still remain below the amplitude of the guideway movement\n(measured from its datum line). As the permissible peak variation in the\nguideway is closely related to the mean operating airgap, this implies\nthat the second order state-feedback and the output-feedback nonlinear\nH1 controllers are capable of maintaining a stable suspension over a\nwider frequency range than their linear counterpart.\nVII. CONCLUSION\nWhile the linear state feedback controllers have successfully been\nused over the years, the new experimental results presented here\ndemonstrate the viability of using more computationally demanding\nnonlinear controllers for stabilization and control of electromagnetic\nsuspension systems. The superiority of the second-order state feedback\nand the output feedback controllers in tracking a moving guideway\nwith improved disturbance rejection properties has been illustrated.\nWhile both nonlinear controllers improve suspension characteristics,\nthe output feedback controller (which subsumes a nonlinear state\nestimator) has been observed to provide significant improvement over\nAuthorized licensed use limited to: University of Surrey. Downloaded on June 5, 2009 at 09:16 from IEEE Xplore.  Restrictions apply.\n568 IEEE TRANSACTIONS ON AUTOMATIC CONTROL, VOL. 49, NO. 4, APRIL 2004\nFig. 5. Experimental and simulation sensitivity functions of the closed-loop\nsystem. (1) Linear state-feedback controller (3), (2) first-order nonlinear\nstate-feedback controller (14a), (3) second order nonlinear state-feedback\ncontroller (16) and (4) nonlinear output-feedback controller (16) and (19).\n(3a) and (4a) represent the simulation responses corresponding to (3) and (4).\nThe value of W puts a penalty on the control signal; small values of W\nlead to faster transient response and, hence, wider bandwidth. In all responses\ncontained in this note \r andW = 0:12.\nthe now-classical linear state feedback controllers. The concept of\nlinear H1 [13] has been used for Maglev control [14], [15] earlier,\nhowever, direct application of nonlinear H1 to deal with track\ndisturbance in an EMS system is considered to be novel.\nAlthough several issues require careful assessment for the real-time\nimplementation of these nonlinearH1 controllers derived here, exten-\nsive range of experimental work carried out by the authors indicate that,\nproviding a reasonable care is taken in specifying the physical param-\neters of the suspension magnet, the analytically derived control laws,\nfor a given set of \u000b, \f, \r andWu, may directly be used in assessing the\nperformance of laboratory-scale demonstration systems. A key differ-\nence between the nonlinear state and the output feedback controllers is\nthe execution time of the control algorithms ((16) and (19)): 50 \u0016s for\nthe former and 400\u0016s for the latter (within a sampling interval of 1ms).\nIn multimagnet vehicles this may impose some operational constraints.\nTo overcome this, the embedded DSP hardware described in Section V\nprovides communication protocols between local control loops for in-\ndividual magnets and supervisory control functions to coordinate the\ndistribution of suspension force. The dynamics of these mechanically\ncoupled magnets on suspension stability and tracking properties are\ncurrently under investigation.\nREFERENCES\n[1] The Economist: \u201cThe New Age of the Train: A Better Way to Fly\u201d, The\nEconomist, London, U.K., 1998, pp. 23\u201325.\n[2] The Shanghai-Pudon Airport Highspeed Link, Transrapid International,\nBerlin, Germany, 2001.\n[3] P. K. Sinha, Electromagnetic Suspension: Dynamics & Con-\ntrol. London, U.K.: Peter Peregrinus, 1987.\n[4] P. K. Sinha and A. N. Pechev, \u201cModel reference adaptive control of a\nMaglev system with stable maximum descent criterion,\u201d Automatica,\nvol. 35, pp. 1457\u20131465, 1999.\n[5] A. J. van der Schaft, \u201cL -gain analysis of nonlinear systems and non-\nlinear state feedbackH control,\u201d in IEEE Trans. Automat. Contr., vol.\n37, June 1992, pp. 770\u2013784.\n[6] J. G. Willems, \u201cDissipative dynamical systems Part I: General theory,\u201d\nArch. Rational Mech. Anal., vol. 22, pp. 321\u2013351, 1972.\n[7] D. Hill and P. Moylan, \u201cThe stability of nonlinear dissipative systems,\u201d\nIEEE Trans. Automat. Contr., vol. AC-21, pp. 708\u2013711, June 1976.\n[8] J. A. Ball, J. Helton, and M. L. Walker, \u201cH control for nonlinear sys-\ntems with output feedback,\u201d IEEE Trans. Automat. Contr., vol. 38, pp.\n546\u2013559, May 1993.\n[9] A. Isidori and W. Kang, \u201cH control via measurement feedback for\ngeneral nonlinear systems,\u201d IEEE Trans. Automat. Contr., vol. 40, pp.\n466\u2013472, Mar. 1995.\n[10] E. G. Al\u2019brekht, \u201cOn the optimal stabilization of nonlinear systems,\u201d J.\nAppl. Math. Mech., vol. 25, pp. 1254\u20131266, 1962.\n[11] P. K. Sinha, F. B. Zhou, andR. S. Kutiyal, \u201cFault detection in electromag-\nnetic suspension systems with state estimation methods,\u201d IEEE Trans.\nMagn., vol. 29, pp. 2971\u20132973, Dec. 1993.\n[12] \u201cSharc DSP Board for Embedded Control\u201d Data Sheet, Jupelier Tech-\nnology, Hamm, Germany, 2000.\n[13] J. C. Doyle, K. Glover, P. Khargonekar, and B. Francis, \u201cState-space\nsolutions to standard H and H control problems,\u201d IEEE Trans. Au-\ntomat. Contr., vol. 34, pp. 831\u2013847, Aug. 1989.\n[14] A. Bittar and R. M. Sales, \u201cH and H -control for maglev vehicles,\u201d\nIEEE Control Syst. Mag., vol. 18, pp. 18\u201325, Jan. 1998.\n[15] M. Fujita, T. Namerikawa, F. Matsumura, and K. Uchida, \u201c\u0016-synthesis\nof an electromagnetic suspension system,\u201d IEEE Trans. Automat. Contr.,\nvol. 40, pp. 530\u2013536, Apr. 1995.\nRobust Stability and Stabilization of Discrete Singular\nSystems: An Equivalent Characterization\nShengyuan Xu and James Lam\nAbstract\u2014This note deals with the problems of robust stability and stabi-\nlization for uncertain discrete-time singular systems. The parameter uncer-\ntainties are assumed to be time-invariant and norm-bounded appearing in\nboth the state and input matrices. A new necessary and sufficient condition\nfor a discrete-time singular system to be regular, causal and stable is pro-\nposed in terms of a strict linear matrix inequality (LMI). Based on this, the\nconcepts of generalized quadratic stability and generalized quadratic sta-\nbilization for uncertain discrete-time singular systems are introduced. Nec-\nessary and sufficient conditions for generalized quadratic stability and gen-\neralized quadratic stabilization are obtained in terms of a strict LMI and a\nset of matrix inequalities, respectively. With these conditions, the problems\nof robust stability and robust stabilization are solved. An explicit expression\nof a desired state feedback controller is also given, which involves nomatrix\ndecomposition. Finally, an illustrative example is provided to demonstrate\nthe applicability of the proposed approach.\nIndex Terms\u2014Discrete-time systems, linear matrix inequality (LMI), pa-\nrameter uncertainty, robust stability, robust stabilization, singular systems.\nI. INTRODUCTION\nThe problems of robust stability analysis and robust stabilization of\nlinear state-space systems with parameter uncertainties have received\nmuch attention in the past decades [3], [23]. A great number of re-\nsults on these topics have appeared in the literature. Among the dif-\nferent approaches dealing with these problems, the methods based on\nthe concepts of quadratic stability and quadratic stabilizability have\nManuscript received March 28, 2003; revised July 17, 2003. Recommended\nby Associate Editor P. A. Iglesias. This work was supported in part by RGC\nHKU 7103\/01P, the Foundation for the Author of National Excellent Doctoral\nDissertation of China under Grant 200240, and the National Science Foundation\nunder Grants 60304001 and 60074007.\nS. Xu is with the Department of Automation, Nanjing University of Science\nand Technology, Nanjing 210094, P. R. China.\nJ. Lam is with the Department of Mechanical Engineering, University of\nHong Kong, Hong Kong.\nDigital Object Identifier 10.1109\/TAC.2003.822854\n0018-9286\/04$20.00 \u00a9 2004 IEEE\nAuthorized licensed use limited to: University of Surrey. Downloaded on June 5, 2009 at 09:16 from IEEE Xplore.  Restrictions apply.\n"}