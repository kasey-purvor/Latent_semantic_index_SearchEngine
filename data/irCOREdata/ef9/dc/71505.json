{"doi":"10.1016\/j.automatica.2006.08.023","coreId":"71505","oai":"oai:eprints.lancs.ac.uk:820","identifiers":["oai:eprints.lancs.ac.uk:820","10.1016\/j.automatica.2006.08.023"],"title":"Brief paper: Freeway traffic estimation within particle filtering framework","authors":["Mihaylova, Lyudmila","Boel, Ren\u00e9","Hegyi, Andreas"],"enrichments":{"references":[{"id":16344226,"title":"A compositional stochastic model for real-time freeway tra\u00b1c simulation.","authors":[],"date":"2006","doi":"10.1016\/j.trb.2005.05.001","raw":"Boel, R. and Mihaylova, L. (2006). A compositional stochastic model for real-time freeway tra\u00b1c simulation. Transportation Research B, 40(4):319{334.","cites":null},{"id":16344236,"title":"A novel approach to nonlinear\/ non-Gaussian Bayesian state estimation.","authors":[],"date":"1993","doi":"10.1049\/ip-f-2.1993.0015","raw":"Gordon, N., Salmond, D., and Smith, A. (1993). A novel approach to nonlinear\/ non-Gaussian Bayesian state estimation. IEE Proc. Radar & Signal Proc., 40:107{113.","cites":null},{"id":16344250,"title":"A particle \u00aflter for freewaytra\u00b1cestimation.","authors":[],"date":"2004","doi":null,"raw":"Mihaylova, L. and Boel, R. (2004). A particle \u00aflter for freewaytra\u00b1cestimation. In Proc.43rdIEEEConf.","cites":null},{"id":16344228,"title":"Bayesian \u00afltering: From Kalman \u00aflters toparticle\u00aflters,andbeyond. Tech.Rep.McMaster Univ.,","authors":[],"date":"2003","doi":null,"raw":"Chen, Z. (2003). Bayesian \u00afltering: From Kalman \u00aflters toparticle\u00aflters,andbeyond. Tech.Rep.McMaster Univ., Canada.","cites":null},{"id":16344256,"title":"Beyond the Kalman Filter: Particle Filters for Tracking Applications.","authors":[],"date":"2004","doi":"10.1155\/s1110865704405095","raw":"Ristic, B., Arulampalam, S., and Gordon, N. (2004). Beyond the Kalman Filter: Particle Filters for Tracking Applications. Artech House.","cites":null},{"id":16344258,"title":"Highway tra\u00b1c state estimation using improved mixture Kalman \u00aflters for e\u00aeective ramp metering control.","authors":[],"date":"2003","doi":"10.1109\/cdc.2003.1272322","raw":"Sun, X., Mu~ noz, L., and Horowitz, R. (2003). Highway tra\u00b1c state estimation using improved mixture Kalman \u00aflters for e\u00aeective ramp metering control. In Proc. 42th IEEE Conf. on Dec. and Contr., pages 6333{6338.","cites":null},{"id":16344254,"title":"Macroscopic modelling of tra\u00b1c \u00b0ow on the boulevard P\u00b6 eriph\u00b6 erique in Paris.","authors":[],"date":"1989","doi":null,"raw":"Papageorgiou, M. and Blosseville, J.-M. (1989). Macroscopic modelling of tra\u00b1c \u00b0ow on the boulevard P\u00b6 eriph\u00b6 erique in Paris. Transp. Res. B, 23(1):29{47.","cites":null},{"id":16344239,"title":"Model Predictive Control for Integrating Tra\u00b1c Control Measures.","authors":[],"date":"2004","doi":null,"raw":"Hegyi, A. (2004). Model Predictive Control for Integrating Tra\u00b1c Control Measures. PhD thesis, Delft University of Technology, the Netherlands.","cites":null},{"id":16344223,"title":"Modelling freeway networks by hybrid stochastic models.","authors":[],"date":"2004","doi":"10.1109\/ivs.2004.1336378","raw":"Boel, R. and Mihaylova, L. (2004). Modelling freeway networks by hybrid stochastic models. In Proc. IEEE Intelligent Vehicle Symp., pages 182{187.","cites":null},{"id":16344252,"title":"on Decision and Control,","authors":[],"date":null,"doi":"10.1109\/idc.2007.374580","raw":"on Decision and Control, pages 2106{2111.","cites":null},{"id":16344260,"title":"Real-time freeway tra\u00b1c state estimation based on extended Kalman \u00aflter: a general approach.","authors":[],"date":"2005","doi":"10.1016\/j.trb.2004.03.003","raw":"Wang, Y. and Papageorgiou, M. (2005). Real-time freeway tra\u00b1c state estimation based on extended Kalman \u00aflter: a general approach. Transp. Res. B, 39(2):141{167.","cites":null},{"id":16344233,"title":"Sequential Monte Carlo Methods in Practice.","authors":[],"date":"2001","doi":"10.1007\/978-1-4757-3437-9","raw":"Doucet, A., Freitas, N., and N. Gordon, E. (2001). Sequential Monte Carlo Methods in Practice. New York: Springer.","cites":null},{"id":16344244,"title":"State-of-the-art of vehicular tra\u00b1c \u00b0ow modelling.","authors":[],"date":"2001","doi":null,"raw":"Hoogendoorn, S. and Bovy, P. (2001). State-of-the-art of vehicular tra\u00b1c \u00b0ow modelling. Journal of Systems Control Engineer | Proceedings of the Institution of Mechanical Engineers, Part I, 215(14):283{303.","cites":null},{"id":16344230,"title":"The cell transmission model: A dynamic representation of highway tra\u00b1c consistent with the hydrodynamic theory.","authors":[],"date":"1994","doi":"10.1016\/0191-2615(94)90002-7","raw":"Daganzo, C. (1994). The cell transmission model: A dynamic representation of highway tra\u00b1c consistent with the hydrodynamic theory. Transp. Res. B, 28B(4):269{287.","cites":null},{"id":16344259,"title":"The Unscented Kalman Filter,","authors":[],"date":"2001","doi":"10.1002\/0471221546.ch7","raw":"Wan, E. and van der Merwe, R. (2001). The Unscented Kalman Filter, Ch. 7: Kalman Filtering and Neural Networks. Ed. by S. Haykin, pages 221{280. Wiley.","cites":null},{"id":16344248,"title":"Tra\u00b1c \u00b0ow modeling of large-scale motorway using the macroscopic modeling tool METANET.","authors":[],"date":"2002","doi":"10.1109\/tits.2002.806804","raw":"Kotsialos, A., Papageorgiou, M., Diakaki, C., Pavlis, Y., and Middelham, F. (2002). Tra\u00b1c \u00b0ow modeling of large-scale motorway using the macroscopic modeling tool METANET. IEEE Transactions on Intelligent Transportation Systems, 3(4):282{292.","cites":null},{"id":16344242,"title":"Tra\u00b1c and related self-driven manyparticle systems.","authors":[],"date":"2002","doi":null,"raw":"Helbing, D. (2002). Tra\u00b1c and related self-driven manyparticle systems. Rev. Modern Phys., 73:1067{1141.","cites":null},{"id":16344246,"title":"Unscented \u00afltering and nonlinear estimation.","authors":[],"date":"2004","doi":"10.1109\/jproc.2003.823141","raw":"Julier, S. and Uhlmann, J. (2004). Unscented \u00afltering and nonlinear estimation. Proceedings of the IEEE, 92(3):401{422.","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2007","abstract":"This paper formulates the problem of real-time estimation of traffic state in freeway networks by means of the particle filtering framework. A particle filter (PF) is developed based on a recently proposed speed-extended cell-transmission model of freeway traffic. The freeway is considered as a network of components representing different freeway stretches called segments. The evolution of the traffic in a segment is modelled as a dynamic stochastic system, influenced by states of neighbour segments. Measurements are received only at boundaries between some segments and averaged within possibly irregular time intervals. This limits the measurement update in the PF to only these time instants when a new measurement arrives, while in between measurement updates any simulation model can be used to describe the evolution of the particles. The PF performance is validated and evaluated using synthetic and real traffic data from a Belgian freeway. An unscented Kalman filter is also presented. A comparison of the PF with the unscented Kalman filter is performed with respect to accuracy and complexity","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/71505.pdf","fullTextIdentifier":"http:\/\/eprints.lancs.ac.uk\/820\/3\/Automatica_revised_final.pdf","pdfHashValue":"254bdefa41d270110f29d63eb1400d96eda07e01","publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lancs.ac.uk:820<\/identifier><datestamp>\n      2018-01-24T03:17:01Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D51:5141:51413735<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        Brief paper: Freeway traffic estimation within particle filtering framework<\/dc:title><dc:creator>\n        Mihaylova, Lyudmila<\/dc:creator><dc:creator>\n        Boel, Ren\u00e9<\/dc:creator><dc:creator>\n        Hegyi, Andreas<\/dc:creator><dc:subject>\n        QA75 Electronic computers. Computer science<\/dc:subject><dc:description>\n        This paper formulates the problem of real-time estimation of traffic state in freeway networks by means of the particle filtering framework. A particle filter (PF) is developed based on a recently proposed speed-extended cell-transmission model of freeway traffic. The freeway is considered as a network of components representing different freeway stretches called segments. The evolution of the traffic in a segment is modelled as a dynamic stochastic system, influenced by states of neighbour segments. Measurements are received only at boundaries between some segments and averaged within possibly irregular time intervals. This limits the measurement update in the PF to only these time instants when a new measurement arrives, while in between measurement updates any simulation model can be used to describe the evolution of the particles. The PF performance is validated and evaluated using synthetic and real traffic data from a Belgian freeway. An unscented Kalman filter is also presented. A comparison of the PF with the unscented Kalman filter is performed with respect to accuracy and complexity.<\/dc:description><dc:date>\n        2007<\/dc:date><dc:type>\n        Journal Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/eprints.lancs.ac.uk\/820\/3\/Automatica_revised_final.pdf<\/dc:identifier><dc:relation>\n        http:\/\/dx.doi.org\/10.1016\/j.automatica.2006.08.023<\/dc:relation><dc:identifier>\n        Mihaylova, Lyudmila and Boel, Ren\u00e9 and Hegyi, Andreas (2007) Brief paper: Freeway traffic estimation within particle filtering framework. Automatica, 43 (2). pp. 290-300. ISSN 0005-1098<\/dc:identifier><dc:relation>\n        http:\/\/eprints.lancs.ac.uk\/820\/<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/dx.doi.org\/10.1016\/j.automatica.2006.08.023","http:\/\/eprints.lancs.ac.uk\/820\/"],"year":2007,"topics":["QA75 Electronic computers. Computer science"],"subject":["Journal Article","PeerReviewed"],"fullText":"Brief paper\nFreewayTrafficEstimation\nWithinParticleFilteringFramework\nLyudmila Mihaylova \u2217,a,Rene\u00b4 Boel b, Andreas Hegyi c\naDepartment of Communication Systems, Lancaster University, South Drive, Lancaster LA1 4WA, UK\nbUniversity of Ghent, SYSTeMS Research Group, B-9052 Zwijnaarde, Belgium\ncDelft University of Technology, Delft Center for Systems and Control, Mekelweg 2, 2628 CD Delft, The Netherlands\nAbstract\nThis paper formulates the problem of real-time estimation of traffic state in freeway networks by means of particle filtering\nframework. A particle filter (PF) is developed based on a recently proposed speed-extended cell-transmission model of freeway\ntraffic. The freeway is considered as a network of components representing different freeway stretches called segments. The\nevolution of the traffic in a segment is modelled as a dynamic stochastic system, influenced by states of neighbour segments.\nMeasurements are received only at boundaries between some segments and averaged within possibly irregular time intervals.\nThis limits the measurement update in the PF to only these time instants when a new measurement arrives, with possibly many\nstate updates in between consecutive measurement updates. The PF performance is validated and evaluated using synthetic\nand real traffic data from a Belgian freeway. An Unscented Kalman filter is also presented. A comparison of the particle filter\nwith the Unscented Kalman filter is performed with respect to accuracy and complexity.\nKeywords: Bayesian estimation, particle filtering, macroscopic traffic models, stochastic systems, unscented Kalman filter\n1 Motivation\nTraffic state estimation and prediction is of paramount\nimportance for on-line road traffic management, effi-\nciency and safety. Vehicular traffic is characterised with\nhighly nonlinear behaviour (Helbing, 2002), with many\ninteractions between vehicles, and high complexity\nwhich makes this problem challenging. This behaviour\ncan be described by macroscopic models (Hoogendoorn\nand Bovy, 2001; Kotsialos et al., 2002; Helbing, 2002)\nthat are suitable for real-time problems in view the\nfact that they represent the average traffic behaviour in\nterms of aggregated variables (flow, density and speed\nat different locations). Most papers dealing with recur-\nsive traffic state estimation apply the Extended Kalman\nfilter (EKF) to such macroscopic models. For example\n(Wang and Papageorgiou, 2005) proposes an EKF to es-\ntimate the unknown parameters and states of a stochas-\ntic version of the macroscopic freeway traffic flow model\nMETANET (Papageorgiou and Blosseville, 1989) of\nfreeway traffic. These estimators have all the advantages\nand disadvantages of the EKF technique: presumably\ncomputationally cheap, but relying on a linearisation\nof the state and measurement models which can cause\n\u2217 Corresponding author\nEmail addresses: mila.mihaylova@ieee.org (Lyudmila\nMihaylova), rene.boel@ugent.be (Rene\u00b4 Boel),\na.hegyi@dcsc.tudelft.nl (Andreas Hegyi).\nfilter divergence. A powerful and scalable approach has\nrecently been developed, known under different names\nsuch as particle filters (PFs) (Doucet et al., 2001; Ristic\net al., 2004; Chen, 2003) and bootstrap method (Gordon\net al., 1993). All information about the states of interest\ncan be obtained from the conditional distribution of the\nstate given the past observations and the dynamics of\nthe system. It approximates the posterior density func-\ntion of the state by an empirical histogram obtained\nfrom samples generated by a Monte Carlo simulation.\nParticle filtering allows to cope with uncertainties and\nnonlinearities of different kinds, nonGaussian noises\nand hence is suitable for the traffic estimation problem.\nIn the present paper we formulate the traffic estimation\nproblem within this Bayesian framework and develop a\nparticle filter for freeway traffic flow estimation. This is\nan extension and generalisation of the results reported in\n(Mihaylova and Boel, 2004). The structure of the PF fits\nwell to the compositional traffic networks, and it allows\nfor parallelisation for different segments.\nIn (Sun et al., 2003) a solution to highway traffic es-\ntimation is proposed by a sequential Monte Carlo al-\ngorithm, the so-called mixture Kalman filtering. First-\norder traffic models represent the network, i.e. only the\ntraffic density is modelled, distinguishing between the\nfree-flow mode and congestion mode. In contrast to (Sun\net al., 2003), the traffic in the present paper is described\nPreprint submitted to Automatica\n  \n \n \n \n \nLi,k \nSegment i \nNi,k, vi,k Ni-1,k, vi-1,k Ni+1,k, vi+1,k \nQi-1,k Qi,k \nSensor measurements in tk \u2261 ts \n1 2 i-1 i i+1 n-1 n \nQk in, vk in Qk out, vk out \nn+1 \nz1,s zj,s zm,s \nFig. 1. Freeway segments and measurement points. Qi is the\naverage number of vehicles crossing the boundary between\nsegments i and i+ 1, Ni and vi are respectively the average\nnumber of vehicles and speed within segment i.\nby a second-order macroscopic model, and we develop a\nparticle filter that estimates both the traffic density and\nspeed. The traffic is described by the recently developed\nmodel (Boel andMihaylova, 2006) that is an extension to\nthe cell-transmission model (Daganzo, 1994). The free-\nway network is modelled as a sequence of segments (Fig.\n1). Sensors are available only at some boundaries be-\ntween segments. Technological limitations (such as lim-\nited bandwidth of communication channels) force one\nto average these measurements over regular or irregular\ntime intervals before they are transmitted to the centre\nwhere the Bayesian update of the conditional densities\nis carried out (for all segments concurrently).\nWe investigate the PF performance with respect to\naccuracy and complexity and we compare it with an-\nother method suitable for traffic flow estimation, the\nUnscented Kalman filter (UKF) (Julier and Uhlmann,\n2004; Wan and van der Merwe, 2001). The UKF is a\nderivative-free estimation method, that has proven to\noutperform the EKF. The UKF can be viewed as a\nmethod to approximate the first two moments of the\nstate: the mean and covariance. Unlike the EKF, the\nUKF does not require calculation of Jacobians and\nHessians. Deterministic sampling approach is used to\ncalculate the mean and covariance, by the so-called\nsigma points. Compared with the EKF\u2019s first-order\naccuracy, the estimation accuracy of the UKF is to\nthe third order (Taylor series expansion) for any non-\nlinearity. The EKF requires calculation of derivatives\nfor all traffic segments which for the traffic problem\nwith interconnected components is quite complicated.\nMoreover, divergence problems are not excluded. The\nUKF is much easier to implement and more accurate.\nHowever, the UKF often encounters the ill-conditioned\nproblem of the covariance matrix in practice (though\ntheoretically it is positive semi-definite). Methods for\nenhancing the numerical properties of the UKF (e.g. as\nbased on singular-value decomposition) can overcome\nthese numerical instabilities (Chen, 2003).\nThe added values and innovative aspects of this paper\nas compared to previous investigations include:\n1. A general stochastic macroscopic traffic flow model\nis presented together with measurement equations, suit-\nable for a PF real-time estimation and prediction.\n2. We demonstrate that PF can be efficiently and eas-\nily implemented for large compositional models and\nsparse measurements, received synchronously or asyn-\nchronously at intervals, bigger than the state-update\nsample time. The developed approach is general and\napplicable to freeway networks with different topologies.\n3. We compare the PF performance with respect to an\nUKF. We show that the PF estimates are more accu-\nrate than those of the UKF, nevertheless the PF is more\ncomputationally expensive.\nThe outline of the paper is as follows. Section 2 presents\na stochastic macroscopic traffic model for freeway\nstretches and a model for real-time traffic measure-\nments. Bayesian formulation of the traffic estimation\nproblem is given in Section 3. A PF framework for traffic\nstate estimation is developed in Section 4 which takes\nadvantage of the compositional traffic model. Section\n5 describes the UKF for traffic estimation that is com-\npared with the developed PF. The PF performance is\nevaluated in Section 6. Conclusions and future research\nissues are highlighted in Section 7.\n2 Freeway Traffic Flow Model\n2.1 Compositional Macroscopic Traffic Model\nTraffic states are estimated consecutively at discrete\ntime instants t1, t2, . . . , tk, . . ., possibly asynchronously,\nbased on all the incoming information up to the current\ntime transmitted by sensors to the filter. The overall\nstate vector xk = (xT1,k,x\nT\n2,k, . . . ,x\nT\nn,k)\nT at time tk con-\nsists of local state vectors xi,k = (Ni,k, vi,k)T , where\nNi,k, [veh], is the number of vehicles counted in segment\ni \u2208 I = {1, 2, . . . n}, and vi,k, [km\/h], is their average\nspeed. The traffic state evolution is described by the\nsystem of equations\nx1,k+1 = f1(Qink , v\nin\nk ,x1,k,x2,k,\u03b71,k), (1)\nxi,k+1 = fi(xi\u22121,k,xi,k,xi+1,k,\u03b7i,k), (2)\nxn,k+1 = fn(xn\u22121,k,xn,k, Qoutk , v\nout\nk ,\u03b7n,k), (3)\nwhere fi is specified by the traffic model, Qink is the\nnumber of vehicles entering segment 1 during the inter-\nval \u2206tk = tk+1 \u2212 tk with average speed vink , Qoutk is the\noutflow leaving a \u2018fictitious\u2019 segment n+ 1, with an av-\nerage speed voutk . \u03b7k is a disturbance vector, reflecting\nrandom fluctuations and the effect of modelling errors in\nthe state evolution. Note that Qink , v\nin\nk , and Q\nout\nk , v\nout\nk\nare respectively, inflow and outflow boundary variables.\nThey are not traffic states and are not estimated. They\n2\nare supplied by the traffic detectors. Hence, a chain of in-\nterconnected segments is considered, together with their\nboundary conditions.\nIn this paper the general state-space description (1)-\n(3) takes a particular form of the recently developed\ncompositional stochastic macroscopic traffic model\n(Boel and Mihaylova, 2006). This speed-extended cell-\ntransmission model describes the complex traffic be-\nhaviour with forward and backward propagation of traf-\nfic perturbations and is suitable for large networks and\nfor distributed processing. The forward and backward\ntraffic perturbations were characterised by (Daganzo,\n1994) through deterministic sending and receiving func-\ntions where piecewise affine representations are used.\nIn (Boel and Mihaylova, 2004; Boel and Mihaylova,\n2006) speed-dependent random sending and receiving\nfunctions are introduced that represent also the evolu-\ntion of the average speed in each segment. The model is\ngiven in concise form as Algorithm 1.\nThe sending function Si,k for each segment i, having\nlength Li, is calculated by (4). Si,k represents the vehi-\ncles that \u201cintend to leave\u201d segment i within \u2206tk. The re-\nceiving function Ri,k (6). expresses the maximum num-\nber of vehicles that are allowed to enter segment i+1. In\n(6) Nmaxi+1,k characterises the maximum number of vehi-\ncles that can simultaneously be present in segment i+1\nin \u2206tk. Nmaxi+1,k depends on the available space, Li+1 time\nthe number of lanes `i+1,k, in segment i+ 1, on the av-\nerage length A` of vehicles, the average speed vi+1,k and\nthe time distance td between two vehicles (in order to\nallow safe driving).\nThe evolution of Ni,k+1 is governed by the principle of\nconservation of vehicles (9). The traffic density \u03c1i,k+1,\n[veh\/km\/lane], is given by (10). The anticipated density\n\u03c1antici,k+1 is then obtained as a weighed average between the\ndensity of segment i and segment i + 1, (11). This cor-\nresponds to the drivers\u2019 tendency usually to look ahead\nwhen they change their speed. The average vehicle speed\nvi,k+1 is a function of the \u2018intermediate\u2019 speed vintermi,k+1 ,\ncalculated in step 5 of Algorithm 1, and of the equilib-\nrium speed satisfying a speed-density relation ve(\u03c1antici,k+1)\n(Kotsialos et al., 2002).\nDesign traffic parameters are: the free-flow speed vfree,\nthe critical density \u03c1crit (density below which the inter-\nactions between vehicles will be negligible), the density\nin jam, \u03c1jam, above which the vehicles do not move,\nand the minimum vehicle speed vmin, the parameters\n\u03b1 \u2208 (0, 1], 0 < \u03b2I < \u03b2II , a threshold density value\n\u03c1threshold. Other details for the model can be found in\n(Boel and Mihaylova, 2004; Boel and Mihaylova, 2006)\nwhere this extended cell-transmission model has been\nvalidated both against the well established METANET\nmodel (Papageorgiou and Blosseville, 1989; Kotsialos\net al., 2002), and over real traffic data.\nAlgorithm 1. The compositional traffic model.\n1. Forward wave : for i = 1, 2, . . . , n\nSi,k = max\n(\nNi,k\nvi,k.\u2206tk\nLi\n+ \u03b7Si,k, Ni,k\nvmin.\u2206tk\nLi\n)\n(4)\nand set Qi,k = Si,k. (5)\n2. Backward wave : for i = n, n\u2212 1, . . . , 1\nRi,k = N\nmax\ni+1,k \u2212Ni+1,k +Qi+1,k, (6)\nwhere Nmaxi+1,k = (Li+1`i+1,k)\/(A` + vi+1,ktd).\nif Si,k < Ri,k, Qi,k = Si,k, (7)\nelse Qi,k = Ri,k, vi,k = Qi,kLi\/(Ni,k\u2206tk), (8)\n3. Update the number of vehicles inside segments,\nfor i = 1, 2, . . . , n\nNi,k+1 = Ni,k +Qi\u22121,k \u2212Qi,k, (9)\n4. Update the density, for i = 1, 2, . . . , n\n\u03c1i,k+1 = Ni,k+1\/(Li`i,k+1), (10)\n\u03c1antici,k+1 = \u03b1\u03c1i,k+1 + (1\u2212 \u03b1)\u03c1i+1,k+1. (11)\n5. Update of the speed, for i = 1, 2, . . . , n\nvintermi,k+1 =\n{\nvi\u22121,kQi\u22121,k+vi,k(Ni,k\u2212Qi,k)\nNi,k+1\n, for Ni,k+1 6= 0,\nvf , otherwise,\nvintermi,k+1 = max(v\ninterm\ni,k+1 , vmin),\nvi,k+1 = \u03b2k+1v\ninterm\ni,k+1 + (1\u2212 \u03b2k+1)ve(\u03c1antici,k+1) + \u03b7vi,k+1,\nwhere\n\u03b2k+1 =\n{\n\u03b2I , if |\u03c1antici+1,k+1 \u2212 \u03c1antici,k+1| \u2265 \u03c1threshold,\n\u03b2II otherwise.\n2.2 Measurement Model\nSensors (magnetic loops, video cameras, radar detectors)\nare located at boundaries between some segments. Usu-\nally, measurements are collected at the entrance and at\nthe exit of the considered stretch of the road, at the on-\nramps and off-ramps, etc.\nLet us consider m sensors along the stretch. Traffic\nstates are measured at discrete time instants. The over-\nall measurement vector zs = (zT1,s, z\nT\n2,s, . . . , z\nT\nm,s)\nT\nat time ts consists of local measurement vectors\nzj,s = (Qj,s, vj,s)T , where j \u2208 J = {1, 2, . . . ,m}. Qj,s\nis the noisy measurement of the number of vehicles\ncrossing the boundaries between the corresponding\nsegment i and segment i + 1 during the time interval\n\u2206ts = ts+1 \u2212 ts, and vj,s is the measured mean speed\nof these vehicles. The intervals \u2206ts are typically several\ntimes longer than the intervals \u2206tk between q succes-\nsive state update steps, i.e. \u2206ts = q\u2206tk. Given the\nmeasurement equation\nzs = h(xs, \u03bes), (12)\nthe distribution p(x0) of the initial state vector x0, the\nstate update model (1)-(3) with noises \u03b7, \u03be, the traffic\nestimation problem can be formulated within Bayesian\n3\nframework. We consider the following particular form\nfor equation (12)\nzj,s =\n(\nQ\u00afj,s\nv\u00afj,s\n)\n+\u03bej,s, (13)\nwhere Q\u00afj,s is the sum of the number of vehicles (cal-\nculated by the state model) crossing the boundary\nbetween segments i and i + 1 within the interval \u2206ts,\nand v\u00afj,s is their average speed. Although Gaussian dis-\ntributions of the noise vector \u03bej,s = (\u03beQj ,s, \u03bevj ,s)\nT in\n(13) has been used previously in the literature (Wang\nand Papageorgiou, 2005), we propose a more realistic\nnoise model. This is another advantage of the PF: the\nknowledge of the noise distributions can be utilised for\na better state tracking. Based on statistical analysis of\ndifferent sets of traffic data we found that there are two\nkinds of measurement errors in the counted vehicles\nby the video cameras: errors due to false detections,\n\u03beQfalse\nj\n,s, and errors due to missed vehicles, \u03beQmissedj ,s.\nHence, the measurement error in the observation equa-\ntion (12) resp. (13) is of the form\n\u03bej,s = Qerrj,s = Q\nfalse\nj,s \u2212Qmissedj,s , (14)\nwhere the number of the vehicles that a detector j missed\nis denoted by Qmissedj,s , and the number of the false de-\ntections by Qfalsej,s . Analysis of data from video cameras\nhas shown that Qfalsej,s and Q\nmissed\nj,s can both be con-\nsidered independent Poisson random variables with pa-\nrameters \u03bb1 and \u03bb2. Based on our analysis we estimate\n\u03bb1 + \u03bb2 = 2, \u03bb1 = 4\/3, \u03bb2 = 2\/3. Then the PDF of the\nmeasurement noise \u03beQi,s is a convolution of the form\np(Qerrj,s = \u03bd\nerr\ni,s ) =\n\u221e\u2211\n\u03bdmissed\ni,s\n=0\n\u03bb\n(\u03bderri,s +\u03bd\nmissed\ni,s )\n1 e\n\u2212\u03bb1\n(\u03bderri,s + \u03bd\nmissed\ni,s )!\n.\n\u03bb\n\u03bdmissedi,s\n2 e\n\u2212\u03bb2\n\u03bdmissedi,s !\n. (15)\nEq. (15) represents the PF likelihood function of the\nobservations over the counted number of vehicles. We\nassume that the speed noises \u03bevj ,s are Gaussian. Under\nthe assumption that the vehicle counts are statistically\nindependent from the speed measurements, the entire\nlikelihood p(zs|xs) given the state xs is the product of\nthe likelihood of the measured counts with the likelihood\nof the measured speeds.\n3 Bayesian Estimation of Traffic Flows\nBayesian estimation evaluates the posterior probability\ndensity function (PDF) p(xk|Zk) of the state vector xk\nup to time instant tk given a set Zk = {z1, ..., zk} of\nsensor measurements available at time tk. Within the\nrecursive Bayesian framework (Ristic et al., 2004), the\nconditional density function p(xk|Zk\u22121) of the state xk\ngiven a set of measurementsZk\u22121 is recursively updated\naccording to\np(xk|Zk\u22121)=\n\u222b\nRnx\np(xk|xk\u22121)p(xk\u22121|Zk\u22121)dxk\u22121, (16)\np(xk|Zk) = p(zk|xk)p(xk|Z\nk\u22121)\np(zk|Zk\u22121)\n, (17)\nwhere p(zk|Zk\u22121) is a normalising constant. Therefore,\nthe recursive update of p(xk|Zk) is proportional to\np(xk|Zk) \u221d p(zk|xk)p(xk|Zk\u22121). (18)\nThe state prediction step (16) and the measurement up-\ndate step (17) use respectively the conditional density\nfunctions p(zk|xk) and p(xk|xk\u22121) that are defined by\nthe model from Section 2.1.\n4 Particle Filtering for Freeway Traffic\nEvaluating (16)-(18) is computationally very expensive.\nThe particle filter technique (Gordon et al., 1993; Doucet\net al., 2001) provides an approximate solution to (16)-\n(18) by a discrete-time recursive update of the posterior\nPDF p(xk|Zk) of the state given the measurements The\nparticle filter approximates p(xk|Zk) by the empirical\nhistogram corresponding to a collection of M particles\n(samples) {x(l)k }Ml=1. To each particle l a weight w(l)k is\nassigned at time tk (the sum of these weights must be\nnormalised to 1). The weight and the value of all parti-\ncles together define a histogram that approximates the\nconditional density function of the state vector xk. After\nthe arrival of a new observation vector zs, the particle\nfilter updates the weights according to (18). The cloud\nof particles evolves with time and depending on the ob-\nservations, so that the particles represent with sufficient\naccuracy the true PDF of the state (Doucet et al., 2001).\nA resampling procedure introduces variety in the parti-\ncles, by eliminating the particles with small weights and\nby replicating particles with larger weights.\nThe traffic estimation problem has particularities distin-\nguishing it from other estimation problems: i) the lim-\nited amount of available data from traffic detectors. The\nnumber of traffic variables to be estimated is much larger\nthan the number of the traffic variables that are directly\nobserved, and this \u201cinterpolation\u201d is an essential con-\ntribution to the freeway traffic estimation task. ii) the\nstate estimates are highly dependent on the inflow Qin,\nvin and random Qout, vout boundary variables.\nThe likelihood function p(zk|xk) is calculated from (13)\nonly when a measurement arrives, using the predicted\nstate values and the known measurement noise density\n4\nAlgorithm 2. A Particle Filter for Traffic Estimation.\nI. Initialisation: k = 0\nFor l = 1, . . . ,M, generate samples {x(l)0 } from\nthe initial distribution p(x0) and\ninitial weights w\n(l)\n0 = 1\/M.\nEnd For\nII. For k = 1, 2, . . . ,\n(1) Prediction step:\nFor l = 1, . . . ,M, sample x\n(l)\nk \u223c p(xk|x(l)k\u22121)\naccording to (4)-(11) for segments between\ntwo boundaries where measurements arrive\nEnd For\n(2) Measurement processing step (only for tk \u2261 ts,\non boundaries between the segments where\nmeasurements are available) compute the weights\nFor l = 1, . . . ,M\nw\n(l)\ns = w\n(l)\ns\u22121p(zs|x(l)s ),\nEnd For\nwhere the likelihood p(zs|x(l)s )\nis calculated by the model (13)\nfrom section 2.2.\nFor l = 1, . . . ,M\nNormalise the weights: w\u02c6\n(l)\ns = w\n(l)\ns \/\n\u2211M\nl=1 w\n(l)\ns .\nEnd For\n(3) Output: x\u02c6s =\n\u2211M\nl=1 w\u02c6\n(l)\ns x\n(l)\ns ,\n(4) Selection step (resampling) only for tk \u2261 ts:\nMultiply\/ Suppress samples x\n(l)\ns with high\/ low\nimportance weights w\u02c6\n(l)\ns , in order to obtain M\nrandom samples approximately distributed accor-\nding to p(x\n(l)\ns |Zs), e.g. by residual resampling.\n* For l = 1, . . . ,M, set w\n(l)\ns = w\u02c6\n(l)\ns = 1\/M, End For\n(5) k \u2190 k + 1 and return to step (1).\nfunction p(\u03bes). The cloud of weighted particles repre-\nsenting the posterior conditional PDF, is used to map\nintegrals to discrete sums: p(xk|Zk) is approximated by\np\u02c6(xk|Zk) \u2248\nM\u2211\nl=1\nw\u02dc\n(l)\nk \u03b4(xk \u2212 x(l)k ), (19)\nwhere \u03b4 is the delta-Dirac function and w\u02dc(l)k are the\nnormalised weights of the posterior conditional PDF.\nNew weights are calculated putting more weight on\nparticles that are important according to the posterior\nprobability density function (19). The random sam-\nples {x(l)k , l = 1, 2, . . . ,M} are drawn from p(xk|Zk).\nIt is often impossible to sample from the posterior\ndensity function p(xk|Zk). However, this difficulty is\ncircumvented by making use of the importance sam-\npling from a known proposal distribution pi(xk|Zk).\nThe transition prior is the most popular choice of the\nproposal distribution (Wan and van der Merwe, 2001):\npi(xk|Zk) = p(xk|xk\u22121), which in our solution to the\ntraffic problem is the traffic state model. Algorithm 2\npresents the PF developed in this paper.\n5 An Unscented Kalman Filter for Traffic Flow\nEstimation\nOther algorithms for approximating the posterior state\nPDF have been introduced. The Unscented Kalman fil-\nter (UKF) relies on the unscented transformation (Julier\nand Uhlmann, 2004; Wan and van der Merwe, 2001), a\nmethod for calculating the statistics of a random vari-\nable which undergoes a nonlinear transformation. Con-\nsider propagating a random variable x (with dimension\nnx) through a nonlinear transformation y = f(x) . As-\nsume that x has mean x\u02c6 and covariance matrix P . To\ncalculate the statistics of y, a matrixX of 2.nx+1 sigma\npoints Xi is formed. These sigma points are propagated\nthrough the time update. To compute the measurement\nupdate step, we propagate these sigma points through\nthe measurement function h and we get transformed\npoints Zi,k\/k\u22121 that form the matrix Zk\/k\u22121. Similarly\nto the Kalman filter, the Kalman gainK, the state esti-\nmate x\u02c6 and the corresponding covariance matrix P are\nupdated by (20)-(22). The UKF equations are given as\nAlgorithm 3. We implemented the UKF using an aug-\nmented state vector concatenating the original state and\nthe noise variables: xak = (x\nT\nk , \u03b7\nT\nk , \u03be\nT\nk )\nT (Wan and van\nder Merwe, 2001). The corresponding matrix with sigma\npoints is X a = ((X x)T , (X \u03b7)T , (X \u03be)T )T . Unlike the\nPF, the sigma points of the UKF are deterministically\nchosen so that they exhibit certain properties, e.g. have\na given mean and covariance. The UKF is formulated\nfor Gaussian distributions of the noises, whereas the PF\nhas the advantage to work with arbitrary distributions.\n6 Particle Filter Performance Evaluation\n6.1 Investigations with Synthetic Data\nThe PF performance is evaluated versus the UKF over\nof freeway stretch of 4 [km] consisting of eight segments,\nhaving periods of congestion. The data are generated\nby the compositional model (Boel and Mihaylova, 2006)\nwith independent measurement noises for different runs\nand with different initial state conditions. The conges-\ntion is due to variations in the inflow Qink and outflow\nQoutk (shown in Fig. 2) within the period 1.12 h - 1.7 h\nand due to the fall in the speed voutk within the inter-\nval 2.4 h-2.65 h. The measurements are generated, by\nadding measurement noises to the counted number of\nvehicles Qi,k and to the speed vi,k for segments 1 and 8.\nThesemeasurements are used in the filters also as inflow\/\n5\nAlgorithm 3. Unscented Kalman Filter Equations.\nI. Initialise with:\nx\u02c60 = E[x0], P 0 = E[(x0 \u2212 x\u02c60)(x0 \u2212 x\u02c60)T ],x\u02c6a0 = E[xa0 ],\nP a0 = E[(x\na\n0 \u2212 x\u02c6a0)(xa0 \u2212 x\u02c6a0)T ] = diag{P 0,P \u03b7,P \u03be}\nFor k = 1, 2, . . . ,\nII. Calculate sigma points :\nX ak\u22121 = [x\u02c6ak\u22121, x\u02c6ak\u22121 + \u03b3\n\u221a\nP ak\u22121, x\u02c6\na\nk\u22121 \u2212 \u03b3\n\u221a\nP ak\u22121],\nwhere\n\u221a\nP ak\u22121 is a Cholesky factor, \u03b3 =\n\u221a\nnx + \u03bb,\n\u03bb = \u03b12(nx + \u03ba)\u2212 nx, 1 \u2264 \u03b1 \u2264 1e\u2212 4, \u03ba = 3\u2212 nx\nIII. Time update :\nX xk\/k\u22121 = f(X xk\u22121,X \u03b7k\u22121),\nx\u02c6k\/k\u22121 =\n2nx\u2211\ni=0\nW\n(m)\ni X xi,k\/k\u22121,\nP k\/k\u22121 =\n2nx\u2211\ni=0\nW\n(c)\ni [X xi,k\/k\u22121 \u2212 x\u02c6k\/k\u22121][X xi,k\/k\u22121 \u2212 x\u02c6k\/k\u22121]T ,\nZk\/k\u22121 = h(X xk\/k\u22121,X \u03bek\u22121),\nz\u02c6k\/k\u22121 =\n2nx\u2211\ni=0\nW\n(m)\ni Zi,k\/k\u22121,\nIV. Measurement update equations:\nP zkzk =\n2nx\u2211\ni=0\nW\n(c)\ni [Zi,k\/k\u22121 \u2212 z\u02c6k\/k\u22121][Zi,k\/k\u22121 \u2212 z\u02c6k\/k\u22121]T ,\nP xkzk =\n2nx\u2211\ni=0\nW\n(c)\ni [X xi,k\/k\u22121 \u2212 x\u02c6k\/k\u22121][Zi,k\/k\u22121 \u2212 z\u02c6k\/k\u22121]T ,\nKk = P xkzkP\n\u22121\nzkzk , (20)\nx\u02c6k\/k = x\u02c6k\/k\u22121 +Kk(zk \u2212 z\u02c6k\/k\u22121), (21)\nP k\/k = P k\/k\u22121 \u2212KkP zkzkKTk , (22)\nwhere the weights are: W\n(m)\n0 = \u03bb\/(nx + \u03bb),\nW\n(c)\n0 = \u03bb\/(nx + \u03bb) + (1\u2212 \u03b12 + \u03b2),\nW\n(m)\ni =W\n(c)\ni = 1\/2(nx + \u03bb), i = 1, . . . , 2nx.\noutflow boundary conditions (for the state model). The\naugmented state vector is xk = (xT1,k,x\nT\n2,k, . . . ,x\nT\n8,k)\nT ,\ni.e. i = 1, 2, . . . , 8, and the measurement vector zs =\n(zT1,s,z\nT\n8,s)\nT . The per minute aggregated measurements\nare supplied to the PF and UKF as would be the case\nwith real data. The state prediction is performed also at\neach intermediate state update time step. We are esti-\nmating the states of all segments between two measure-\nments as one augmented state vector.\n1 1.5 2 2.5 3\n0\n2000\n4000\n6000\nFl\now\ns, \n[v\neh\n\/h]\nTime, [h]\n1\n2\n1 1.5 2 2.5 3\n0\n50\n100\n150\nSp\nee\nd,\n [k\nm\/\nh]\nTime, [h]\n1 2\nFig. 2. Boundary conditions: 1 - in, 2 - out\nThe filters\u2019 performance is evaluated by Root mean\nsquare errors (RMSEs) \u00b2(x\u02c6i,k) = [ 1r\n\u2211r\ni=1(\u03b5i,k)\nT (\u03b5i,k)]1\/2,\nfor the state errors, \u03b5i,k = xi,k \u2212 x\u02c6i,k, over r indepen-\ndent Monte Carlo runs, with respect to density, speed\nand flow. The initial particles for the PF are randomly\ngenerated by adding Gaussian noise to the actual states.\nTable 4 gives the parameters of the state model. The\nevolution of the flow and speed in time (for one realisa-\ntion) are given in Figures 3 and 4. We see the backward\nwave on the evolution of the speed and flow in time.\nThe flow-density and the speed-flow diagrams have the\ntypical bell-shaped forms. The filter performance is\nevaluated for r = 100 independent Monte Carlo runs.\nRMSEs calculated withM = 200 for segments 1, 5, and\n8 are presented in Fig. 5.\n1 1.5 2 2.5 3\n0\n1000\n2000\n3000\n4000\n5000\nFl\now\n, [\nve\nh\/h\n]\nTime, [h]\n1 1.5 2 2.5 3\n0\n20\n40\n60\n80\n100\n120\nSp\nee\nd,\n [k\nm\/\nh]\nTime, [h]\n \n \n8\n7\n6\n5\n1 2 3 4 5 6 7 8\nFig. 3. Diagrams based on the PF and UKF estimated states\n1 1.5 2 2.5 3\n0\n1000\n2000\n3000\n4000\n5000\nFl\now\n, [\nve\nh\/h\n]\nTime, [h]\n1 1.5 2 2.5 3\n0\n20\n40\n60\n80\n100\n120\nSp\nee\nd,\n [k\nm\/\nh]\nTime, [h]\n \n \n1 2 3 4 5 6 7 8\n8\n7\n6\n5\nFig. 4. Diagrams based on the PF and UKF estimated states\nWe see the influence of the backward wave on these RM-\nSEs. We observe that the RMSE values in segment 1\nare smaller than their values in the intermediate seg-\nment 5 (it is also due to the fact that there are no sensor\ndata in this segment). According to these results the PF\nestimates are more accurate than the UKF estimates.\nHowever, the PF complexity is more computationally\nexpensive than the UKF. The complexity of the PF is\nproportional to the the number of particles, times the\ndimension of the overall state vector, M.nx, whilst the\ncomplexity of the UKF is proportional to the number\n2.nx + 1 of sigma points. Note that nx is equal to the\nnumber of segments n times the number of states 2 in\na segment. We calculated the ratio between the PF and\nUKF computational time and it is: 2.8 (with M = 100\nparticles), 5.45 (with M = 200), 15 (with M = 500).\nThe PF more accurate performance compared to the\nUKF performance can be explained with the fact that\nthe PF approximates the state PDF function, whereas\nthe UKF propagates only the first two moments.\nWe have also a case with 12.5 km road length (25 seg-\nments) where we used the PF with 350 particles and we\nobtained accuracy comparable to the accuracy with 4\n6\nkilometers (with 200 particles). In general, the number\nof necessary particles is increasing with the increased\nnumber of states for reaching a certain accuracy, but not\nvery much. It is difficult to characterise in general the PF\naccuracy and complexity because they highly depend on\nthe road structure and the traffic conditions.\nTable 4. Parameters of the traffic model in the PF\nvfree = 120 [km\/h] , vmin = 7.4 [km\/h]\n\u03c1crit = 20.89 [veh\/km\/lane] , \u03c1jam = 180 [veh\/km]\n\u03b1 = 0.65 , \u03b2k+1 =\n{\n0.25, if |\u03c1antici+1,k+1 \u2212 \u03c1i,k+1| \u2265 2,\n0.75, otherwise.\n\u2206ti = 10 [sec], td = 2 [sec] , Li = 0.5 [km], i = 1, ..., 8,\nM = 200 particles, td = 2 [sec], A` = 0.01 [km], `i = 3\ncov{\u03b7Si,k} = (0.03Ni,kvi,k\u2206tk\/Li)2 [veh]2\ncov{\u03b7Qi} = 12 [veh]2, cov{\u03b7vi} = 3.52 [km\/h]2\ncov{\u03beQi} = 12 [veh]2, cov{\u03bevi} = 52 [km\/h]2\n1 2 3\n0\n2\n4\n6\n\u03c1 1\n1 2 3\n2\n4\n6\nv\n1\nRoot Mean Square Errors\n1 2 3\n100\n200\n300\n400\n500\nq 1\n1 2 3\n0\n2\n4\n6\n\u03c1 5\n1 2 3\n2\n4\n6\nv\n5\n1 2 3\n100\n200\n300\n400\n500\nq 5\n1 2 3\n0\n2\n4\n6\n\u03c1 8\nTime, [h]\n1 2 3\n2\n4\n6\nv\n8\nTime, [h]\n1 2 3\n100\n200\n300\n400\n500\nq 8\nTime, [h]\n \n \nUKF\nPF\nFig. 5. PF and UKF RMSEs of the density (for all lanes)\n[veh\/km], speed [km\/h] and flow [veh\/h] of segments 1, 5\nand 8 (with M = 200 for the PF)\n6.2 Application of the Particle Filter to Traffic Data\nfrom E17 Freeway in Belgium\nThe PF performance has also been evaluated with real\ndata, over a stretch of E17 (between CLOF and CLOA\non Fig. 6) freeway between the cities of Ghent and\nAntwerp, subject to frequent congestions. Measure-\nment data are available from video cameras installed\nat location CLOA, CLOB, CLOD, CLOE, and CLOF,\nincluding the total number of vehicles that cross the\nsensor location during each one minute interval, and the\naverage speed of these vehicles during that one minute\ninterval. We tested the PF and UKF using data mea-\nsured from September, 2001 from 6.4 [h] a.m. till 10.6\n[h] a.m. . This period includes heavy congestions.\n \n \n \nTRAVEL DIRECTION \nFig. 6. Schematic representation of the segmentation of the\nE17 case study freeway. The labels CLOF to CLO1 indicate\nthe locations of the traffic measurement cameras. The verti-\ncal arrows indicate the location of the used measurements.\nTable 5. Model parameters\nvfree = 120 [km\/h], vmin = 7.4 [km\/h]\n\u03b2k+1 =\n{\n0.3, if |\u03c1antici+1,k+1 \u2212 \u03c1i,k+1| \u2265 2,\n0.7, otherwise.\nL1 = L2 = L3 = 0.6 [km], L4 = L5 = 0.5 [km]\n\u2206ti = 10 [sec], td = 1.5 [sec], A` = 0.01 [km]\n\u03c1crit = 20.89 [veh\/km\/lane], \u03c1jam = 180 [veh\/km]\nM = 100 particles, \u03b1 = 0.65\nGaussian noises \u03b7Si,k , \u03b7vi,k with covariances:\ncov{\u03b7Si,k} = (0.035Ni,kvi,k\u2206tk\/Li)2 [veh]2\ncov{\u03b7Qi} = 12 [veh]2, cov{\u03b7vi} = 3.52 [km\/h]2,\ncov{\u03beQi} = 12 [veh]2, cov{\u03bevi} = 52 [km\/h]2\n0 50 100 150 200 250\n0\n1000\n2000\n3000\n4000\n5000\n6000\nFl\now\n,  \n  [\nve\nh\/h\n]\nDensity, [veh\/km]\nEstimated with PF\n0 50 100 150 200 250\n0\n1000\n2000\n3000\n4000\n5000\n6000\nFl\now\n,  \n  [\nve\nh\/h\n]\nDensity, [veh\/km]\nEstimated with UKF\nFig. 7. Diagrams based on the PF and UKF estimated states\n7 8 9 10\n0\n50\n100\n150\n200\n250\n\u03c1, \n[ve\nh\/k\nm]\n7 8 9 10\n0\n20\n40\n60\n80\n100\nv,\n [k\nm\/\nh]\n7 8 9 10\n0\n2000\n4000\n6000\nQ,\n [v\neh\n\/h]\nFig. 8. PF estimated states (solid line) versus measured\nstates in CLOD (dashed line)\n7 8 9 10\n0\n50\n100\n150\n200\n250\n\u03c1, \n[ve\nh\/k\nm]\n7 8 9 10\n0\n20\n40\n60\n80\n100\nv 3\n, \n[km\n\/h]\n7 8 9 10\n0\n2000\n4000\n6000\nQ, \n[ve\nh\/h\n]\nFig. 9. UKF estimated states (solid line) versus measured\nstates in CLOD (dashed line)\nThe data are available from two sensors installed at from\nCLOF and CLOA (Fig. 6). The link CLOF to CLOA\ncontains an off-ramp towards and an on-ramp from a\nparking lot, but we assume that the flow of vehicles us-\ning this parking lot is negligible so that the conserva-\ntion equation (9) remains valid in the state prediction\n7\nstep. The parameters of the models and of the filters are\ngiven in Table 5. The filters generate estimates of the\nstate of each segment in a link, and also of the speed and\ndensity (and hence also of the flow) at each boundary\nbetween segments. Figure 7 presents flow-density dia-\ngrams plotted based on the estimates. The bell-shaped\ndiagram shows nicely that the estimated states indeed\nhave properties as one can expect for traffic data. These\nestimates of the density, speed, and flow at the bound-\naries are compared with the measured data in the inter-\nmediate segment boundary CLOD (Figs. 8 and 9).\n7 Conclusions and Open Issues\nThis paper formulates the freeway traffic flow estimation\nwithin Bayesian recursive framework. A particle filter\nis developed using traffic and observation models with\naggregated variables. The traffic is modelled by a re-\ncently developed stochastic compositional traffic model\nwith interconnected states of neighbour segments. The\nPF and UKF performance is investigated and validated\nby simulated data and by real traffic data from a Bel-\ngian freeway. Both the results with simulated and real\ntraffic data confirm that the PF provides accurate track-\ning performance, better than the UKF. Both the PF\nand the UKF are suitable methods for real-time traf-\nfic estimation, and both are easy to implement because\nof the fact that they do not require linearisation. The\nestimation approach presented is straightforward, gen-\neral, easily executable to freeway and urban networks,\nwith different topologies, with any number of sensors,\nwith regularly or irregularly received data in space and\nin time. Both methods are suitable for distributed real-\nisation and parts of them \u2013 for parallel computations.\nBoth the PF and UKF can be used for on-line traffic con-\ntrol strategies, e.g. within the model predictive control\nframework (Sun et al., 2003; Hegyi, 2004). One could\ninterpret the results of this paper as follows. Particle fil-\ntering can successfully estimate and predict the state of\nall segments of a road link using only observations on\nthe inflow and the outflow of the link. This suggests that\nit will be possible to obtain efficient filters in large net-\nworks if a few intermediate measurements of the flow are\navailable, and moreover it suggests that these filters for\na large network will be nicely decomposable.\nAcknowledgments. Financial support by the project\nDWTC-CP\/40 \u201cSustainability effects of traffic manage-\nment\u201d, sponsored by the Belgian government is gratefully\nacknowledged, as well as by the Belgian Programme on\nInter-University Poles of Attraction initiated by the Belgian\nState, Prime Minister\u2019s Office for Science, Technology and\nCulture, and in part by projects I-1202\/02,I-1205\/02 with\nthe Bulgarian Science Fund. We also thank the \u201cVlaams\nVerkeerscentrum Antwerpen\u201d, Antwerp, Belgium for pro-\nviding the data used in this study.\nReferences\nBoel, R. and Mihaylova, L. (2004). Modelling freeway\nnetworks by hybrid stochastic models. In Proc.\nIEEE Intelligent Vehicle Symp., pages 182\u2013187.\nBoel, R. and Mihaylova, L. (2006). A compositional\nstochastic model for real-time freeway traffic simu-\nlation. Transportation Research B, 40(4):319\u2013334.\nChen, Z. (2003). Bayesian filtering: From Kalman filters\nto particle filters, and beyond. Tech. Rep.McMaster\nUniv., Canada.\nDaganzo, C. (1994). The cell transmission model: A dy-\nnamic representation of highway traffic consistent\nwith the hydrodynamic theory. Transp. Res. B,\n28B(4):269\u2013287.\nDoucet, A., Freitas, N., and N. Gordon, E. (2001). Se-\nquential Monte Carlo Methods in Practice. New\nYork: Springer.\nGordon, N., Salmond, D., and Smith, A. (1993). A novel\napproach to nonlinear\/ non-Gaussian Bayesian\nstate estimation. IEE Proc. Radar & Signal Proc.,\n40:107\u2013113.\nHegyi, A. (2004). Model Predictive Control for Inte-\ngrating Traffic Control Measures. PhD thesis, Delft\nUniversity of Technology, the Netherlands.\nHelbing, D. (2002). Traffic and related self-driven many-\nparticle systems. Rev. Modern Phys., 73:1067\u20131141.\nHoogendoorn, S. and Bovy, P. (2001). State-of-the-art of\nvehicular traffic flow modelling. Journal of Systems\nControl Engineer \u2014 Proceedings of the Institution\nof Mechanical Engineers, Part I, 215(14):283\u2013303.\nJulier, S. and Uhlmann, J. (2004). Unscented filtering\nand nonlinear estimation. Proceedings of the IEEE,\n92(3):401\u2013422.\nKotsialos, A., Papageorgiou, M., Diakaki, C., Pavlis, Y.,\nand Middelham, F. (2002). Traffic flow modeling of\nlarge-scale motorway using the macroscopic model-\ning tool METANET. IEEE Transactions on Intel-\nligent Transportation Systems, 3(4):282\u2013292.\nMihaylova, L. and Boel, R. (2004). A particle filter for\nfreeway traffic estimation. InProc. 43rd IEEEConf.\non Decision and Control, pages 2106\u20132111.\nPapageorgiou, M. and Blosseville, J.-M. (1989). Macro-\nscopic modelling of traffic flow on the boulevard\nPe\u00b4riphe\u00b4rique in Paris. Transp. Res. B, 23(1):29\u201347.\nRistic, B., Arulampalam, S., and Gordon, N. (2004). Be-\nyond the Kalman Filter: Particle Filters for Track-\ning Applications. Artech House.\nSun, X., Mun\u02dcoz, L., and Horowitz, R. (2003). High-\nway traffic state estimation using improved mixture\nKalman filters for effective ramp metering control.\nIn Proc. 42th IEEE Conf. on Dec. and Contr., pages\n6333\u20136338.\nWan, E. and van der Merwe, R. (2001). The Unscented\nKalman Filter, Ch. 7: Kalman Filtering and Neural\nNetworks. Ed. by S. Haykin, pages 221\u2013280. Wiley.\nWang, Y. and Papageorgiou, M. (2005). Real-time\nfreeway traffic state estimation based on extended\nKalman filter: a general approach. Transp. Res. B,\n39(2):141\u2013167.\n8\n"}