{"doi":"10.1080\/13504860903336429","coreId":"196195","oai":"oai:lra.le.ac.uk:2381\/8358","identifiers":["oai:lra.le.ac.uk:2381\/8358","10.1080\/13504860903336429"],"title":"Computation of Greeks and Multidimensional Density Estimation for Asset Price Models with Time-Changed Brownian Motion","authors":["Kawai, Reiichiro","Kohatsu-Higa, Arturo"],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2010-09","abstract":"The main purpose of this article is to propose computational methods for Greeks and the multidimensional density estimation for an asset price dynamics model defined with time-changed Brownian motions. Our approach is based on an application of the Malliavin integration-by-parts formula on the Gaussian space conditioning on the jump component. Some numerical examples are presented to illustrate the effectiveness of our results.Post prin","downloadUrl":"http:\/\/www.informaworld.com\/smpp\/content~db=all?content=10.1080\/13504860903336429.","fullTextIdentifier":"https:\/\/lra.le.ac.uk\/bitstream\/2381\/8358\/3\/malliavin.pdf","pdfHashValue":"e3387c54fa03b3dee610a4a5a22ae308a79e6665","publisher":"Taylor & Francis","rawRecordXml":"<record><header><identifier>\n        \n            \n                oai:lra.le.ac.uk:2381\/8358<\/identifier><datestamp>\n                2016-01-11T11:34:40Z<\/datestamp><setSpec>\n                com_2381_445<\/setSpec><setSpec>\n                com_2381_9549<\/setSpec><setSpec>\n                col_2381_3823<\/setSpec>\n            <\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:doc=\"http:\/\/www.lyncode.com\/xoai\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n            \nComputation of Greeks and Multidimensional Density Estimation for Asset Price Models with Time-Changed Brownian Motion<\/dc:title><dc:creator>\nKawai, Reiichiro<\/dc:creator><dc:creator>\nKohatsu-Higa, Arturo<\/dc:creator><dc:description>\nThe main purpose of this article is to propose computational methods for Greeks and the multidimensional density estimation for an asset price dynamics model defined with time-changed Brownian motions. Our approach is based on an application of the Malliavin integration-by-parts formula on the Gaussian space conditioning on the jump component. Some numerical examples are presented to illustrate the effectiveness of our results.<\/dc:description><dc:description>\nPost print<\/dc:description><dc:date>\n2010-08-04T14:21:21Z<\/dc:date><dc:date>\n2010-08-04T14:21:21Z<\/dc:date><dc:date>\n2010-09<\/dc:date><dc:type>\nArticle<\/dc:type><dc:identifier>\nApplied Mathematical Finance, 2010, 17 (4), pp. 301-321.<\/dc:identifier><dc:identifier>\n1350-486X<\/dc:identifier><dc:identifier>\nhttp:\/\/www.tandfonline.com\/doi\/abs\/10.1080\/13504860903336429<\/dc:identifier><dc:identifier>\nhttp:\/\/hdl.handle.net\/2381\/8358<\/dc:identifier><dc:identifier>\n10.1080\/13504860903336429<\/dc:identifier><dc:language>\nen<\/dc:language><dc:rights>\n\u00a9 2010 Taylor & Francis.  Deposited with reference to the publisher's archiving policy available on the SHERPA\/RoMEO website.<\/dc:rights><dc:rights>\nThis paper was published as Applied Mathematical Finance, 2010, 17 (4), pp. 301-321.  It is available from http:\/\/www.informaworld.com\/smpp\/content~db=all?content=10.1080\/13504860903336429.  Doi: 10.1080\/13504860903336429<\/dc:rights><dc:publisher>\nTaylor & Francis<\/dc:publisher>\n<\/oai_dc:dc>\n<\/metadata>\n        <\/record>","journals":[{"title":null,"identifiers":["issn:1350-486X","1350-486x"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2010,"topics":[],"subject":["Article"],"fullText":"Computation of Greeks and Multidimensional Density Estimation\nfor Asset Price Models with Time-Changed Brownian Motion\nREIICHIRO KAWAI\u0003 AND ARTURO KOHATSU-HIGA\u2020\nAbstract\nThe main purpose of this paper is to propose computational methods for Greeks and the multidimensional density\nestimation for an asset price dynamics model defined with time-changed Brownian motions. Our approach is based\non an application of the Malliavin integration-by-parts formula on the Gaussian space conditioning on the jump\ncomponent. Some numerical examples are presented to illustrate the effectiveness of our results.\nKeywords: Integration-by-parts formula, Malliavin calculus, normal inverse Gaussian process, time-changed Brown-\nian motion, variance gamma process.\n2000 Mathematics Subject Classification: 60H07, 60E07, 60G51, 91B70\n1 Introduction\nThe Malliavin integration-by-parts formula was established in the historic paper of Bismut [5], and served as a key\ntool to reveal the relation between the Ho\u00a8rmander condition on the hypoelliptic problem and the existence of smooth\ndensities for solutions to stochastic differential equations. Moreover, in his book [6], he studied the logarithmic gra-\ndient of the fundamental solution to the heat equation on a Riemaniann manifold. In mathematical finance, Malliavin\ncalculus on the Wiener space is applied in Fournie\u00b4 et al. [15] to the sensitivity analysis for the Black-Scholes asset\nprice dynamics model. Moreover, the so-called Malliavin-Thalmaier integration-by-parts formula was introduced in\nMalliavin and Thalmaier [21] with a view towards the computation of multidimensional probability density functions,\nof which numerical issues are studied in Kohatsu-Higa and Yasuda [19]. For stochastic differential equations driven\nby Brownian motion, the technique based on the integration-by-parts formula from Malliavin Calculus has become\nstandard.\nIt is then a natural question whether a similar approach can be obtained in the case of computation of Greeks and\nthe multidimensional density for jump processes. Concerning Malliavin calculus for jump processes, the existence\nof weights for the logarithmic gradient dates back to the work of Bichteler, Gravereaux, Jacod [4]. For practical\nconsiderations, it is important to derive explicit weights, in order to design an efficient Monte Carlo evaluation. In\nparticular, Davis and Johansson [12], and Cass and Friz [10] studied theMalliavin Greeks for jump diffusion processes.\nTheir approach consists of conditioning by the jump component and then performing the Malliavin calculus techniques\nwith respect to the Brownian motion component. In other words, their models are required to be a superposition of\nindependent jump and diffusion components, where the diffusion must be nondegenerate. On the other hand, El-\nKhatib and Privault [13] applied the calculus focused on the Poisson arrival times of Carlen and Pardoux [7], while\nBally et al. [1] took a unified approach considering the derivatives with respect to both the Poisson arrival times and\nthe amplitudes of the jumps. Takeuchi studied in [27] the same problem of solutions to stochastic differential equations\nwith jumps via the martingale approach, without using the approach introduced in [4]. Kawai and Takeuchi [17, 18]\nderive Greeks formulas for asset price dynamics described by gamma processes, based upon a scaling property of\ngamma processes with respect to the Esscher transform parameter. It seems that there is still no unified approach\nto the sensitivity analysis and also the multidimensional density estimation for random processes beyond the pure\ndiffusion cases.\nPublished in Applied Mathematical Finance (2010) 17(4) 301-321.\n\u0003Email address: reiichiro.kawai@gmail.com. Postal address: Department of Mathematics, University of Leicester, Leicester LE1 7RH, UK.\n\u2020Email address: kohatsu@sigmath.es.osaka-u.ac.jp. Postal address: Graduate School of Engineering Sciences, Osaka University, 560-8531,\nJapan.\n1\nThe main purpose of this paper is to obtain an expression for the calculation of Greek and the multidimensional\ndensity for an asset price dynamics model defined with time-changed Brownian motions. As will be illustrated later,\nour framework encompasses some Le\u00b4vy process models and stochastic volatility models. Our approach is based on an\napplication of the Malliavin integration-by-parts formula on the Gaussian space conditioning on the jump component.\nWe consider this approach best suited for actual financial models as we reflect in the examples that we have considered.\nThis approach has been taken in [10, 12]. Nevertheless they use the representation of the model as a stochastic\ndifferential equation while we use an expression as subordinated Wiener processes. In the Le\u00b4vy processes framework\nwith an expression as a time-changed Brownian motion, our results improve those of [1, 13] in the sense that our Le\u00b4vy\nprocesses are of more realistic infinite activity type. When restricted to the variance gamma model, our results can be\nrecovered from those of [17, 18].\nThe rest of this paper is organized as follows. We first introduce in Section 2 the time-changed Brownian motion\nand give three examples of time-changed Brownian motions of practical interest. In Section 3, we apply the Malliavin\nintegration-by-parts formula on the Gaussian space to derive unbiased estimators of various Greeks in our model\nsetting with a view towards efficient Monte Carlo evaluation. We next present in Section 4 that theMalliavin-Thalmaier\nintegration-by-parts formula can also be applied to the multidimensional density estimation in our framework. Finally,\nSection 5 concludes.\n2 Preliminaries\nLet us begin with general notations which will be used throughout the text. We let N be the set of positive integers. We\ndenote by Rd the d-dimensional Euclidean space with the norm k \u0001 k and the inner product by h\u0001; \u0001i. We fix (W;F ;P)\nas our underlying probability space. We mean by the time-changed Brownian motion the following stochastic process\nXt := mt+qYt +sWYt ; (2.1)\nwhere m 2R, q 2R, s > 0, and fWt : t \u0015 0g is a standard Brownian motion in R, and fYt : t \u0015 0g is a non-decreasing\nstochastic process in R, with Y0 = 0, a.s., independent of fWt : t \u0015 0g. For convenience, we define the characteristic\nexponent\nejYt (y) := E\n\u0002\neiyYt\n\u0003\n:\nIntuitively, one may regard the original clock ft : t \u0015 0g as calendar time, while the new random clock fYt : t \u0015 0g as\nbusiness time. A more active business day implies a faster business clock, and vice versa.\n2.1 Examples of Time-Changed Brownian Motion\nIf fYt : t \u0015 0g is a subordinator, that is, an one-sided Le\u00b4vy process, the above time-changed Brownian motion is a\nLe\u00b4vy process, which is often called Le\u00b4vy process of type G. (See, for example, Rosin\u00b4ski [24].) Moreover, unless it is\na deterministic subordinator (that is, Yt = at, a > 0), the time-changed Brownian motion becomes a pure-jump Le\u00b4vy\nprocess. In Example 2.1 and 2.2, we give two such examples.\nExample 2.1. (Variance gamma Le\u00b4vy processes) The stochastic process (2.1) is called a variance gamma (Le\u00b4vy)\nprocess of Madan, Carr and Chang [20], if we set fYt : t \u0015 0g to be a gamma process, whose characteristic exponent\nis given by jYt (y) =\u0000at ln(1\u0000 iy=b), while its marginal density is given in closed form by\nfYt (x) =\nbat\nG(at)\nxat\u00001e\u0000bx; x> 0; (2.2)\nwith a = b =: n\u00001 > 0. The model has attracted the attention of finance practitioners, and thus appears often in the\ncomputational finance literature (see for example, Carr and Madan [9] and Fu [16]). The characteristic function of\nXt = mt+qYt +sWYt is given by\nE\n\u0002\neiyXt\n\u0003\n= eiymt\n\u0012\n1\u0000 iyqn+ 1\n2\ns2ny2\n\u0013\u0000t=n\n:\nMoreover, it is also shown in [20] that the variance gamma process can be expressed as the difference of two indepen-\ndent gamma processes,\nXt = Yt;p\u0000Yt;n; (2.3)\n2\nwhere the gamma processes fYt;p : t \u0015 0g and fYt;n : t \u0015 0g can be characterized by (2.2) with (a;b) = (n\u00001;(mpn)\u00001)\nand (a;b) = (n\u00001;(mnn)\u00001) for some n > 0, where the parameters are given by mp = 12\np\nq 2+2s2=n + q=2 and\nmn = 12\np\nq 2+2s2=n\u0000q=2; respectively.\nExample 2.2. (Normal inverse Gaussian Le\u00b4vy processes) The normal inverse Gaussian process can be expressed\nas a time-changed Brownian motion by setting fYt : t \u0015 0g to be a Le\u00b4vy process induced by the inverse Gaussian\ndistribution, whose marginal at time t is identical in law to the first time that a Brownian motion with drift n reaches\nthe positive level t, that is,\nE\n\u0002\neyYt\n\u0003\n= exp\nh\n\u0000t\n\u0010p\n\u00002y+n2\u0000n\n\u0011i\n:\nThen, the normal inverse Gaussian process Xt = mt+qYt +sWYt has the characteristic function\nE\n\u0002\neiyXt\n\u0003\n= eiymt exp\n24\u0000ts\n0@s n2\ns2\n+\nq 2\ns4\n\u0000\n\u0012\nq\ns2\n+ iy\n\u00132\n\u0000 n\ns\n1A35 ;\nwhere n > 0. Conversely, set a =\np\nn2=s2+q 2=s4, b = q=s2, and d = s . Then, we get jb j< a , n = d\np\na2\u0000b 2,\nand\nXt = mt+bd 2Yt +dWYt :\nSee Barndorff-Nielsen [3], Carr et al.[8] and Schoutens [26] for more details.\nIt has been a general consensus that return volatilities vary stochastically over time. The concept of \u201ctime change\u201d\ncan also be applied to capture the evidence of stochastic volatility. That is, by the Gaussian scaling property, random\nchanges in volatility can be related to random time changes. The following is an illustrative example of the business\nclock, which is successfully applied in Carr et al.[8] to control the clock of pure-jump Le\u00b4vy processes.\nExample 2.3. (Brownian motion, time changed via integrated Cox-Ingersoll-Ross (CIR) square-root process) Let\nfzt : t \u0015 0g be a mean-reverting positive process defined via the stochastic differential equation\ndzt = k(h\u0000 zt)dt+lpztdWt ;\nwhere z0;k;h ;s are positive constants with 2kh > s2. The parameter h serves as the long run rate of time change,\nk is the mean reversion rate, while l is the volatility of the time change. This is often called the CIR square root\nprocess [11]. Taking the process fzt : t \u0015 0g as the instantaneous rate of time change, we define an increasing process\nYt :=\nR t\n0 zsds. It is well known that the characteristic function of Yt is given by\nft(y) := E\n\u0002\neiyYt\n\u0003\n= eA(t;y)z0B(t;y);\nwhere g :=\np\nk2\u00002l 2iy, A(t;y) := 2iy=(k+ g coth(gt)=2), and\nB(t;y) := exp\n\u0002\nk2ht=l 2\n\u0003\u0012\ncosh\n\u0010gt\n2\n\u0011\n+\nk\ng\nsinh\n\u0010gt\n2\n\u0011\u0013\u00002kh=l 2\n:\nUsing the above fact, the characteristic function of Xt = mt+qYt +sWYt can be derived as\nE\n\u0002\neiyXt\n\u0003\n= eiymtE\nh\ne(iyq\u0000y\n2s2=2)Yt\ni\n= eiymtft\n\u0000\nyq + iy2s2=2\n\u0001\n;\nwhere the computation is performed given Yt . For more details, we refer, for example, to Carr et al.[8] and Schoutens\n[26].\n2.2 Malliavin Calculus. Some notations and properties\nLet us next present some basic facts on the Malliavin calculus. For details and notation, we refer to the book of\nNualart [23]. Fix T > 0, d1 2 N, d2 2 N, and let fWt : t \u0015 0g be a standard Brownian motion in Rd1 , independent of\nfYt : t 2 [0;T ]g, with Wt := (W (1)t ; : : : ;W (d1)t )0. Throughout this study, the time-changing process fYt : t 2 [0;T ]g is\none-dimensional. Let (Ft)t2[0;T ] and (Gt)t\u00150 be the natural filtrations generated respectively by fYt : t 2 [0;T ]g and\n3\nfWYt : t \u0015 0g. Let F := (F1; : : : ;Fd2)0 be a random vector in Rd2 , measurable with respect to GT := s(WYt ; t 2 [0;T ]).\nWe denote by D(k)\u0001 the Malliavin derivative on the Gaussian space, conditionally on the time changing process, with\nrespect to the k-th component of the underlying Brownian motion. Define for each k = 1; : : : ;d2,\nDsFk :=\nh\nD(1)s Fk; : : : ;D\n(d1)\ns Fk\ni0\n:\nMoreover, we denote by dk the Skorohod integral over (0;YT ] given FT with respect to the k-th component of the\nunderlying Brownian motion, that is, for a suitable smooth stochastic process fGt : t \u0015 0g in Rd2 ,\ndk(G\u0001) :=\nZ YT\n0\nGsdW\n(k)\ns ;\nwhere the multivariate Skorohod integral is taken componentwise. Both the operators D and d are linked by the\nequality; for each k = 1; : : : ;d2;\ndk (hF;G\u0001i) = hdk (G\u0001) ;Fi\u0000\nZ YT\n0\nD\nD(k)t F;Gt\nE\ndt:\nMoreover, taking the conditional expectation, we get the duality; for each k = 1; : : : ;d2,\nE\n\u0014Z YT\n0\nD\nD(k)t F;Gt\nE\ndt\n\f\f\fFT\u0015= E\u0002hdk(G\u0001);Fi \f\fFT \u0003 : (2.4)\nHere, we have assumed that F 2 D1;2 and G 2 Dom(d ).\nWe next give an integration by parts formula in one dimension (the multidimensional case is introduced in Section\n4), which is our key tool to integrate the derivative in the following expectation for F 2C1b(R;R),\nE\n\u0002\nF0(X)Z\n\f\fFT \u0003= E[F(X)H\f\fFT ];\nwhere X , Z and H are suitable random variables. We follow the argument of Montero and Kohatsu-Higa [22]. By the\nchain rule of the Malliavin derivative, we have that givenFT and for t 2 [0;YT ],\n(DtF(X))Zht =F0(X)ZhtDtX ;\nwhere fht : t 2 [0;YT ]g is a suitable \u201dsmooth\u201d stochastic process such that the terms appearing below are well defined.\nIntegration over [0;YT ] leads to\nF0(X)Z =\nZ YT\n0\nDtF(X)\nZhtR YT\n0 hsDsXds\ndt:\nUsing the duality (2.4), we get\nE\n\u0002\nF0(X)Z\n\f\fFT \u0003= E\"Z YT\n0\nDtF(X)\nZhtR YT\n0 hsDsXds\ndt\n\f\f\fFT#= E\"F(X)d Zh\u0001R YT\n0 hsDsXds\n!\f\f\fFT# : (2.5)\nWe will often refer this relation to the (conditional) integration-by-parts formula in what follows.\n3 Computation of Greeks\nFix T > 0 and assume that fYt : t 2 [0;T ]g is such that\f\fjYt \u0000\u0000i\u0000q +s2=2\u0001\u0001\f\f<+\u00a5; t 2 [0;T ]: (3.1)\nWe first consider an one-dimensional asset dynamics driven by a time-changed Brownian motion,\nSt := S0ert\neXt\nE [eXt ]\n= S0ert exp\n\u0002\nqYt +sWYt \u0000jYt (\u0000i(q +s2=2))\n\u0003\n; (3.2)\nwhere the expectation is henceforth taken with respect to a risk neutral probability. With fYt : t 2 [0;T ]g in Example\n2.1, 2.2 and 2.3, the discounted stock price model (3.2) is clearly a martingale with respect to the risk neutral measure\nunder the integrability condition (3.1) due to the Markovian property of fYt : t 2 [0;T ]g.\nIf the business clock fYt : t 2 [0;T ]g is deterministic, then our framework simply reduces to the most basic Black-\nScholes model. To avoid such triviality, we rule out the deterministic clock a priori. Until Section 3.5, we work on\nthe above one-dimensional model, and thus suppress the scripts in the Malliavin derivative D(k) and in the Skorohod\nintegral dk.\n4\n3.1 Delta\nWe first derive an unbiased estimator of the so-called delta, which is the sensitivity index with respect to the initial\nvalue.\nProposition 3.1. Assume that E[S2T ] < +\u00a5. Let F : R! R be a measurable function such that E[F(ST )2] is locally\nuniformly bounded in S0 > 0. Moreover, assume that E[Y\u00002T ]<+\u00a5. Then, we have\n\u00b6\n\u00b6S0\nE [F(ST )] =\n1\nsS0\nE\n\u0014\nF(ST )\nWYT\nYT\n\u0015\n:\nProof. First, assume F 2C2b(R;R):We have\n\u00b6\n\u00b6S0\nE [F(ST )] = E\n\u0014\n\u00b6\n\u00b6S0\nF(ST )\n\u0015\n= E\n\u0014\nF0(ST )\n\u00b6ST\n\u00b6S0\n\u0015\n= S\u000010 E\n\u0002\nF0(ST )ST\n\u0003\n;\nwhere the interchange of the derivative and the expectation is justified by the dominated convergence theorem. In fact,\nas e # 0,\nF((1+ e=S0)ST )\u0000F(ST )\ne\n!F0(ST )STS0 ; a:s:;\nand by the Taylor theorem,\f\f\f\fE [F((1+ e=S0)ST )\u0000F(ST )]e\n\f\f\f\f\u0014 Z 10 E\n\u0014\f\f\f\fF0((1+de=S0)ST ) (1+de=S0)STS0\n\f\f\f\f\u0015dd ;\nwhich is clearly uniformly bounded in e .\nNext, givenFT , we can apply the conditional integration-by-parts formula (2.5) with ht \u0011 1 as\nE\n\u0002\nF0(ST )ST\n\f\fFT \u0003= E\"F(ST )d STR YT\n0 DsSTds\n!\f\fFT#= E\u0014F(ST )WYTsYT \f\fFT\n\u0015\n; (3.3)\nwhere the last equality holds since givenFT ,Z YT\n0\nDsSTds= sST\nZ YT\n0\n1(s\u0014 YT )ds= sSTYT : (3.4)\nTaking the expectation on the both sides, we get the desired result for F 2C2b(R;R).\nIt remains to remove the regularity assumption on F. To this end, let us come back to F such that E[F(ST )2] is\nlocally uniformly bounded in S0. We can always find a sequence fFngn2N of continuously differentiable functions,\nfrom R to R, with compact support such that limn\"+\u00a5E[jFn(ST )\u0000F(ST )j2] = 0. Hence, by the Cauchy-Schwartz\ninequality with E[jWYT =YT j2] = E[Y\u00001T ]<+\u00a5, we have that for each S0,\f\f\f\fE\u0014Fn(ST )WYTYT \u0000F(ST )WYTYT\n\u0015\f\f\f\f2 \u0014 EhjFn(ST )\u0000F(ST )j2iE\n\"\f\f\f\fWYTYT\n\f\f\f\f2\n#\n! 0;\nas n \"+\u00a5. Then, we obtain that\nE [Fn((1+ e=S0)ST )]\u0000E [Fn(ST )] =\nZ e\n0\nE\n\u0014\nFn((1+h=S0)ST )\nWYT\nYT\n\u0015\ndh: (3.5)\nThen, by taking limits with respect to n, we obtain that E[F((1+ e=S0)ST )] is continuous in S0. In a similar fashion,\nwe can prove that E[F(ST )WYT =YT ] is continuous in S0. Finally, by taking limits with respect to n in (3.5) and dividing\nby e , we obtain that E[F(ST )] is differentiable with respect to S0 and that the desired formula holds. The proof is\ncomplete.\n5\nRemark 3.2. The sensitivity with respect to the risk-free rate r and the drift parameter q can also be derived via the\nidentity (3.3), respectively as\n\u00b6\n\u00b6 r\nE [F(ST )] = E\n\u0014\nF0(ST )\n\u00b6\n\u00b6 r\nST\n\u0015\n= TE\n\u0002\nF0(ST )ST\n\u0003\n= S0T\n\u00b6\n\u00b6S0\nE [F(ST )] ;\nand\n\u00b6\n\u00b6q\nE [F(ST )] = E\n\u0014\nF0(ST )\n\u00b6\n\u00b6q\nST\n\u0015\n= E\n\u0002\nE\n\u0002\nF0(ST )ST jFT\n\u0003\nYT\n\u0003\n=\n1\ns\nE [F(ST )WYT ] ;\nwhere the interchanges of the derivative and the expectation can be justified as before. Moreover, note that the proof\nof Proposition 3.1 does not require the Markovian property of the time-changing process fYt : t 2 [0;T ]g.\n3.2 Vega\nIn our framework, we may naturally regard the parameter s as the volatility. The next formula is the so-called vega,\nwhich is the sensitivity of the premium with respect to the volatility parameter.\nProposition 3.3. Assume E[S2TW 2YT ] < +\u00a5. Let F : R! R be a measurable function such that E[F(ST )2] is locally\nuniformly bounded in S0 > 0. Assume further that E[Y\u00002T ]<+\u00a5. Then,\n\u00b6\n\u00b6s\nE [F(ST )] =\n1\ns\nE\n\"\nF(ST )\n \nW 2YT\nYT\n\u0000WYT\nYT\n\u00b6\n\u00b6s\njYT (\u0000i(q +s2=2))\u00001\n!#\nProof. As before, it suffices to show the result with F 2C2b(R;R). We have\n\u00b6\n\u00b6s\nE [F(ST )] = E\n\u0014\nF0(ST )\n\u00b6ST\n\u00b6s\n\u0015\n= E\n\u0014\nF0(ST )ST\n\u0012\nWYT \u0000\n\u00b6\n\u00b6s\njYT (\u0000i(q +s2=2))\n\u0013\u0015\n;\nwhere the interchange of the derivative and the expectation can be justified by the dominated convergence theorem in\na similar manner to the proof of Proposition 3.1.\nNext, in view of the delta formula in Proposition 3.1, it remains to work on E [F0(ST )STWYT ]. GivenFT , we apply\nthe conditional integration-by-parts formula (2.5) with ht \u0011 1 as\nE\n\u0002\nF0(ST )STWYT\n\u0003\n= E\n\"\nE\n\"\nF(ST )d\n \nSTWYTR YT\n0 DuSTdu\n!\f\f\fFT##= 1s E\n\"\nF(ST )\n \nW 2YT\nYT\n\u00001\n!#\n;\nwhere the last equality holds by (3.4). Finally, for the arguments to remove the smoothness on F, we need\nE\n\u0002\f\fF(ST )W 2YT =YT \f\f\u00032 \u0014 EhjF(ST )j2iE\u0002W 4YT =Y 2T \u0003= EhjF(ST )j2iE\u0002W 41 \u0003<+\u00a5;\nwhich concludes.\n3.3 Gamma\nNext, we consider the second-order sensitivity with respect to the initial value, that is, the delta of the delta. In the\nderivation, we literally take \u201cdelta\u201d of the delta formula of Proposition 3.1.\nProposition 3.4. Assume E[S2TW 2YT =Y\n2\nT ] < +\u00a5. Let F : R! R be a measurable function such that E[F(ST )2] < +\u00a5\nis locally uniformly bounded in S0 > 0. Assume further that E[Y\u00004T ]<+\u00a5. Then, we have\n\u00b6 2\n\u00b6S20\nE [F(ST )] =\n1\ns2S20\nE\n\"\nF(ST )\n1\nYT\n \nW 2YT\nYT\n\u0000sWYT \u00001\n!#\n:\n6\nProof. As before, it suffices to show the result with F 2C2b(R;R). In view of Proposition 3.1, we have\n\u00b6 2\n\u00b6S20\nE [F(ST )] =\n\u00b6\n\u00b6S0\n\u0012\n1\nsS0\nE\n\u0014\nF(ST )\nWYT\nYT\n\u0015\u0013\n:\nThen, by a similar argument to the previous proofs, we have\n\u00b6\n\u00b6S0\nE\n\u0014\nF(ST )\nWYT\nYT\n\u0015\n= E\n\u0014\n\u00b6\n\u00b6S0\nF(ST )\nWYT\nYT\n\u0015\n=\n1\nS0\nE\n\u0014\nF0(ST )\nSTWYT\nYT\n\u0015\n=\n1\nsS0\nE\n\u0014\nE\n\u0002\nF(ST )d (WYT )\n\f\fFT \u0003 1Y 2T\n\u0015\n=\n1\nsS0\nE\n\"\nF(ST )\nW 2YT \u0000YT\nY 2T\n#\n;\nwhere the interchange of the derivative and the expectation can be justified by the dominated convergence theorem.\nFinally, for the arguments to remove the smoothness on F, we need\nE\n\u0002\f\fF(ST )W 4YT =Y 4T \f\f\u00032 \u0014 E\u0002F(ST )2\u0003E\u0002Y\u00004T \u0003E\u0002W 81 \u0003<+\u00a5;\nwhich completes the proof.\n3.4 Delta of Asian\nNotice that by setting Yt = t, our formulas recover the counterparts in the Black-Scholes framework. We may say,\nand indeed as our intuition, that in the derivation of the logarithmic derivatives, it does not matter how the clock is\ngoverned, but matters only where the Brownian motion is at the end.\nA delta formula of the Asian options is derived below. Interestingly, even such a path dependent payoff yields a\nsimilar form to its counterpart in the Black-Scholes, which can be found in [22].\nProposition 3.5. Fix T > 0, and define\nF1 :=\nZ T\n0\nSudu; F2 :=\nZ T\n0\nSuYudu; F3 :=\nZ T\n0\nSuY 2u du:\nLet F : R! R be a measurable function such that E[F(F1=T )2] is locally uniformly bounded in S0 > 0. Assume\nfurther that fYt : t 2 [0;T ]g is a non-decreasing Le\u00b4vy process with Le\u00b4vy measure n defined on R+, and that there exist\np> 1 and s> 1 with q(s) := (1\u00001=s)\u00001 such thatZ\nz>1\ne4x zn(dz)<+\u00a5;\nwhere x := (4p2s2s2+ ps(0_q))_ (2p2q(s)2s2+ pq(s)(0_q)), and\nE\nh\nY\u00004pq(s)e e8p\n2q(s)2s2Ye\ni\n<+\u00a5;\nfor some e 2 (0;T ): Then, we have\n\u00b6\n\u00b6S0\nE [F(F1=T )] =\n1\nS0\nE\n\u0014\nF(F1=T )\n\u0012\nWYTF1\nsF2\n+\nF1F3\nF22\n\u00001\n\u0013\u0015\n:\nProof. As so far, we proceed with the proof in the case F 2C2b(R;R). First, observe that\n\u00b6\n\u00b6S0\nE [F(F1=T )] = E\n\u0014\n\u00b6\n\u00b6S0\nF(F1=T )\n\u0015\n=\n1\nS0\nE\n\u0002\nF0 (F1=T )F1=T\n\u0003\n;\n7\nwhere the interchange of the derivative and the expectation is justified by the dominated convergence theorem as before\nwith E[F21 ]<+\u00a5: To prove this, observe that\nE\n\u0002\nF21\n\u0003\u0014 E\u0014Z T\n0\nS2udu\n\u0015\n=\nZ T\n0\nE\n\u0002\nS2u\n\u0003\ndu\n\u0014 S20e2rT\nZ T\n0\nexp\n\u0002\nu\n\u0000\njY1\n\u0000\u00002i\u0000q \u0000s2\u0001\u0001\u0000jY1 \u0000\u0000i\u0000q +s2=2\u0001\u0001\u0001\u0003du<+\u00a5;\nwhere we have used the Cauchy-Schwarz inequality, the Fubini theorem, and the infinite divisibility of Le\u00b4vy processes\njYt = tjY1 .\nTo continue our proof, givenFT , note first thatZ YT\n0\nDsF1 ds= s\nZ T\n0\nZ YT\n0\nSu1(s\u0014 Yu)dsdu= sF2;\nand Z YT\n0\nDsF2 ds= s\nZ T\n0\nZ YT\n0\nSuYu1(s\u0014 Yu)dsdu= sF3;\nwhere the interchanges of the Malliavin derivative and the Lebesgue integral hold true. (See, for example, Property\nP2 of [15].) By using the identity\nd (F1) =WYTF1\u0000sF2;\nwe get\nd\n\u0012\nF1\nF2\n\u0013\n=\nd (F1)\nF2\n+\nF1\nR YT\n0 DsF2ds\nF22\n=\nWYTF1\nF2\n+s\nF1F3\nF22\n\u0000s :\nThe desired formula now follows from\nE\n\u0002\nF0 (F1=T )F1=T\n\f\fFT \u0003= E\"F(F1=T )d F1R YT\n0 DsF1ds\n! \f\f\fFT# ;\ndue to the conditional integration-by-parts formula (2.5) with ht \u0011 1.\nConcerning the integrability and the arguments to remove the smoothness ofF, by the Cauchy-Schwartz inequality\nwithE[F(F1=T )2]<+\u00a5; it suffices to guarantee the existence ofE[W 4YT (F1=F2)\n4] andE[(F1F3=F22 )4]. Since F3\u0014YTF2,\na:s:, it further suffices to check the existence of E[W 4YT (F1=F2)\n4] and E[Y 2T (F1=F2)4]. Let q(p) := (1\u00001=p)\u00001 so that\n(p;q(p)) are conjugate exponents. By the Ho\u00a8lder inequality, we have\nE\nh\nW 4YT (F1=F2)\n4\ni\n\u0014 E\nh\njWYT j4q(p)\ni1=q(p)\nE\nh\n(F1=F2)\n4p\ni1=p\n;\nand\nE\nh\nY 4T (F1=F2)\n4\ni\n\u0014 E\nh\nY 4q(p)T\ni1=q(p)\nE\nh\n(F1=F2)\n4p\ni1=p\n:\nHence, we investigate E[(F1=F2)4p]. By the Ho\u00a8lder inequality, we have\nE\n\u0002\n(F1=F2)4p\n\u0003\u0014 EhF4ps1 i1=sEhF\u00004pq(s)2 i1=q(s) :\nRecalling the formula\nP\n\"\nsup\nt2[0;T ]\nWt 2 B\n#\n=\nZ +\u00a5\n0\n1B(x)\n2p\n2pT\nexp\n\u0014\n\u0000 x\n2\n2T\n\u0015\ndx; B 2B(R+); (3.6)\nwhereB(R+) is the Borel s -field of R+, we get\nE\nh\nF4ps1\ni\n\u0014 T 4pse4psrTE\nh\ne4pssupt2[0;T ](qYt+sWYt+jYt (\u0000i(q+s\n2=2)))\ni\n\u0014 T 4pse4psrT e4pssupt2[0;T ]jYt (\u0000i(q+s2=2))E\nh\ne4pssupt2[0;T ](qYt )E\nh\ne4pss supt2[0;T ]WYt\n\f\f\fFT ii\n\u0014 2T 4pse4psrT e4pssupt2[0;T ]jYt (\u0000i(q+s2=2))E\nh\ne4pssupt2[0;T ](qYt )+16p\n2s2s2YT\ni\n\u0014 2T 4pse4psrT e4pssupt2[0;T ]jYt (\u0000i(q+s2=2))E\nh\ne(16p\n2s2s2+4ps(0_q))YT\ni\n:\n8\nHence, we get that E[F4ps1 ] < +\u00a5 if E[e\n(16p2s2s2+4ps(0_q))YT ] < +\u00a5. Next, we investigate E[F\u00004pq(s)2 ]. For ease in\nnotation, write t :=\u00004pq(s). Pick an arbitrary e 2 (0;T ). First, since P(St > 0) = P(Yt > 0) = 1 for each t 2 (0;T ],\nwe have E[Ft2 ]\u0014 (T \u0000 e)tE[Y te (inft2[e;T ] St)t ]; and\nE\n\u0014\nY te\n\u0012\ninf\nt2[e;T ]\nSt\n\u0013t\u0015\n\u0014 E\nh\nY te e\nt inft2[e;T ](qYt+jYt (\u0000i(q+s2=2)))E\nh\net inft2[Ye ;YT ]sWt\n\f\f\fFT ii :\nThen, by using the independence of increments and formula (3.6), we get\nE\nh\net inft2[Ye ;YT ](sWt )\n\f\f\fFT i= e 12 t2s2YeEhe\u0000ts supt2[Ye ;YT ](Wt\u0000WYe )\f\f\fFT i\u0014 2e 12 t2s2YT ;\nwhere the inequality holds by the fact P(YT \u0000Ye > 0) = 1. Hence, we get\nE\n\u0014\nY te\n\u0012\ninf\nt2[e;T ]\nSt\n\u0013t\u0015\n\u0014 2E\n\u0014\nY te exp\n\u0014\nt inf\nt2[e;T ]\n(qYt +jYt (\u0000i(q +s2=2)))+YT t2\ns2\n2\n\u0015\u0015\n\u0014 2et inft2[e;T ]jYt (\u0000i(q+s2=2))\n\u0002E\n\u0014\nY te exp\n\u0014\nt inf\nt2[e;T ]\n(q(Yt \u0000Ye))+(t2s2=2+ tq)Ye +(YT \u0000Ye)t2s\n2\n2\n\u0015\u0015\n= 2et inft2[e;T ]jYt (\u0000i(q+s\n2=2))E\nh\nY te e\n(t2s2=2+tq)Ye\ni\nE\nh\ne(t\n2s2=2\u0000(0^\u0000tq))YT\u0000e\ni\n;\nwhere the equality holds by the independence and the stationarity of increments of fYt : t 2 [0;T ]g. Hence, the expecta-\ntion E[Ft2 ] is well defined if there exists e 2 (0;T ) such that E[Y te et\n2s2=2Ye ]<+\u00a5 and if E[e(t2s2=2\u0000(0^\u0000tq))YT ]<+\u00a5.\nTheorem 25.3 of Sato [25] concludes the proof.\n3.5 Greeks for Baskets\nIn this subsection, we consider a basket of correlated asset prices, and its sensitivity with respect to the correlation\nparameter r , and its so-called cross-gamma, that is, (\u00b6 2=(\u00b6S(1)0 \u00b6S\n(2)\n0 )). We here restrict ourselves to a basket of only\ntwo assets, while our results can easily be extended to a higher dimension.\nFix r 2 (\u00001;1) and set h(r) :=\np\n1\u0000r2. Define\"\nX (1)t\nX (2)t\n#\n:=\n\"\nq1Yt +s1W\n(1)\nYt \u0000jYt (\u0000i(q1+s21 =2))\nq2Yt +s2\n\u0010\nrW (1)Yt +h(r)W\n(2)\nYt\n\u0011\n\u0000jYt (\u0000i(q2+s22 =2))\n#\n;\nand\n[F1;F2]\n0 :=\nh\nS(1)0 exp\n\u0010\nX (1)T\n\u0011\n;S(2)0 exp\n\u0010\nX (2)T\n\u0011i0\n;\nwhere S(1)0 and S\n(2)\n0 are positive constants. Set F := a1F1+a2F2, for some real a1 and a2. Then, we have the following.\nProposition 3.6. LetF :R 7!R be a measurable function such that E[F(F)2] is locally uniformly bounded in S(1)0 > 0\nand S(2)0 > 0. Then, it holds that\n\u00b6\n\u00b6r\nE [F(F)] =\n1\nh(r)\nE\n24F(F)W (1)YT W (2)YT \u0000 rh(r)\n\u0010\n(W (2)YT )\n2\u0000YT\n\u0011\nYT\n35 :\nIf E[Y\u00002T ]<+\u00a5, then it holds that\n\u00b6 2\n\u00b6S(1)0 \u00b6S\n(2)\n0\nE [F(F)] =\n1\nh(r)s1s2S\n(1)\n0 S\n(2)\n0\nE\n\u0014\nF(F)\n1\nY 2T\n\u0012\nW (1)YT W\n(2)\nYT \u0000\nr\nh(r)\n\u0010\n(W (2)YT )\n2\u0000YT\n\u0011\u0013\u0015\n:\n9\nProof. In a similar manner to the previous proofs, it suffices to assume F 2C2b(R;R).\nFor the sensitivity with respect to the correlation parameter, we proceed\n\u00b6\n\u00b6r\nE [F(F)] = a2s2E\n\u0014\nF0(F)F2\n\u0012\nW (1)YT \u0000\nr\nh(r)\nW (2)YT\n\u0013\u0015\n=\n1\nh(r)\nE\n24Z YT\n0\nD(2)s F(F)\nW (1)YT \u0000\nr\nh(r)W\n(2)\nYT\nYT\nds\n35\n=\n1\nh(r)\nE\n\u0014\n1\nYT\nE\n\u0014\nF(F)d2\n\u0012\nW (1)YT \u0000\nr\nh(r)\nW (2)YT\n\u0013\f\f\fFT\u0015\u0015\n=\n1\nh(r)\nE\n\u0014\n1\nYT\nE\n\u0014\nF(F)\n\u0012\nW (1)YT W\n(2)\nYT \u0000\nr\nh(r)\n\u0010\n(W (2)YT )\n2\u0000YT\n\u0011\u0013\f\f\fFT\u0015\u0015 ;\nwhere the interchange of the derivative and the expectation at the first equality can be justified by standard uniform\nintegrability arguments, where the second equality can be justified by D(2)s F(F) = F0(F)a2F2s2h(r), and where the\nthird equality holds by the conditional integration-by-parts formula (2.5) with ht \u0011 1.\nFor the cross-gamma, we start with deriving an expression for (\u00b6=\u00b6S(2)0 )E[F(F)], which can be done by\n\u00b6\n\u00b6S(2)0\nE [F(F)] =\na2\nS(2)0\nE\n\u0002\nF0(F)F2\n\u0003\n=\n1\nS(2)0 h(r)s2\nE\n\u0014\n1\nYT\nE\n\u0014Z YT\n0\nD(2)s F(F)ds\n\f\f\fFT\u0015\u0015\n=\n1\nS(2)0 h(r)s2\nE\n\"\nF(F)\nW (2)YT\nYT\n#\n;\nwhere the last equality holds by D(2)s F(F) = F0(F)a2F2s2h(r). With the identity D\n(1)\ns F(F) = F0(F)(a1s1F1 +\na2s2rF2), we have\nF0(F)a1s1F1 =\n1\nYT\n\u0012Z YT\n0\nD(1)s F(F)ds\u0000 rh(r)\nZ YT\n0\nD(2)s F(F)ds\n\u0013\n:\nUsing this identity, we proceed\n\u00b6 2\n\u00b6S(1)0 \u00b6S\n(2)\n0\nE [F(F)] =\na1\nS(1)0 S\n(2)\n0 h(r)s2\nE\n\"\nF0(F)F1\nW (2)YT\nYT\n#\n=\n1\nS(1)0 S\n(2)\n0 h(r)s1s2\nE\n\u0014\n1\nY 2T\nZ YT\n0\n\u0012\nD(1)s F(F)\u0000 rh(r)D\n(2)\ns F(F)\n\u0013\nW (2)YT ds\n\u0015\n;\nwhich yields the desired equality by the conditional integration-by-parts formula (2.5) with ht \u0011 1. The proof is\ncomplete. (In our setting, regardless of the order of the partial derivatives and the choice of the Skorohod integrals, we\narrive at the same formula.)\nRemark 3.7. For all the formulas of this section, we have imposed the assumptions on the L2(W)-integrability of the\npayoff and on the finite negative moment E[Y\u0000pT ] < +\u00a5, for some p > 0. As a matter of course, with a higher order\nintegrability of the payoff and with the use of the Ho\u00a8lder inequality (instead of the Cauchy-Schwarz inequality) just as\nin the proof of Proposition 3.5, we may decrease the order p of the negative moment to a certain extent. In particular,\nin the case of uniformly bounded payoffs, such as digital options (to be tested in our numerical experiments below),\nthe order p can be taken arbitrarily small. Moreover, the order p has been increased in order to remove the smoothness\nof the payoff function F. Hence, we can again decrease the order p when dealing with smooth Fs. For the reader\u2019s\nconvenience, let us here investigate the negative moments for the three candidates given in Example 2.1, 2.2, and 2.3.\nFor the gamma process, by using the density function (2.2), we can easily derive that E[Y\u0000pT ] < +\u00a5 if and only if\np 2 (0;aT ). Meanwhile, it is well known that the inverse Gaussian distribution has the density\nfYt (x) =\nd tedgtp\n2px3=2\nexp\n\u0014\n\u00001\n2\n\u0000\nd 2t2x\u00001+ g2x\n\u0001\u0015\n; x 2 (0;+\u00a5);\n10\nwhere parameters are the same as given in Example 2.2. Hence, E[Y\u0000pT ]<+\u00a5 for every p 2 (0;+\u00a5). Finally, for the\nintegrated CIR square root process, we use the identity\nE\nh\nY\u0000pT\ni\n=\n1\nG(p)\nZ +\u00a5\n0\nsp\u00001E\n\u0002\ne\u0000sYT\n\u0003\nds=\n1\nG(p)\nZ +\u00a5\n0\nsp\u00001eA(T;is)z0B(T; is)ds;\nwhere the functions are as given in Example 2.3. We can show that A(T; is)\u0018\u00002p2s=l , B(T; is)\u0018 e\u0000\np\n2skhT=l , and\nthus E[e\u0000sYT ] \u0018 e\u0000\np\n2s(2z0+khT )=l as s \" +\u00a5. This implies that the negative moment is well defined for every order.\nInterestingly, the above observations indicate that the inverse Gaussian process and the integrated CIR square root\nprocess cannot stay very low for long.\n3.6 Numerical Illustration\nWe test our formulas on a digital payoff F(x) = 1(x > K) with the normal inverse Gaussian model described in\nExample 2.2. In the numerical results given below, \u201cFD\u201d indicates the Monte Carlo convergence of the finite difference\ncounterparts. For the delta, the vega, the gamma, and the Asian delta, we set model parameters S0 = 100, K = 1:1S0,\na = 8, b = \u00003, and d = 0:2. For the baskets, we use the same inverse Gaussian process and set S(1)0 = S(2)0 = 100,\nr = 0:3, a1 = a2 = 1, and K = 2:2S\n(1)\n0 . We fix T = 1 and r = 0:05 throughout. The figures and the variance ratios\nevidently indicate a faster convergence of our Greeks formulae, compared to the finite difference approximations.\nNote that the finite difference approximations are in general biased.\n4 Multidimensional Density Estimation\nThis section treats the problem of obtaining aMonte Carlo estimation of the value of the density for a multidimensional\ntime-changed Brownian motion model. Let us begin with some additional notations on the Malliavin calculus. Fix\nT > 0, d1 2 N, and d2 2 N. Let fWt : t \u0015 0g be a standard Brownian motion in Rd1 and define by F := (F1; : : : ;Fd2)0\na random vector in Rd2 , measurable with respect to GT . We denote by gF the Malliavin matrix of F givenFT , whose\n(k1;k2)-entry is\n(gF)k1;k2 =\nZ YT\n0\n\n\nDsFk1 ;DsFk2\n\u000b\nds:\nDefine for k = 1; : : : ;d2,\nH(k)(F) :=\nd1\n\u00e5\nl=1\nd2\n\u00e5\nm=1\ndl\n\u0010\n(g\u00001F )k;mD\n(l)\n\u0001 Fm\n\u0011\n;\nand set\nH(F) := [H(1)(F); : : : ;H(d2)(F)]\n0:\nWe denote by ad the area of the unit sphere in Rd , and define c2 := a2 and cd := (d\u00002)ad for d \u0015 3. Moreover, for\neach d \u0015 2, define a map Qd : Rd 7! R by Q2(x) := a2 lnkxk; and for d \u0015 3, Qd(x) := \u0000adkxk2\u0000d : Then, we get for\nk = 1; : : : ;d,\n\u00d1Qd(x) = cd\nx\nkxkd :\nThe following is a key tool due to Malliavin and Thalmaier (our formulation follows from Bally and Caramellino\n[2]). We illustrate, in Example 4.2, how the algebra actually proceeds with numerical results.\nTheorem 4.1. (Kohatsu-Higa and Yasuda [19]) Assume that there exists p> 1 such that for every c> 0,\nsup\nkxk\u0014c\nE\nh\r\r\u00d1Qd2(F\u0000 x)\r\r pp\u00001 + \f\fQd2(F\u0000 x)\f\f pp\u00001 i<+\u00a5:\nThen, the density pF(\u0001) of F is given by\npF(x) = E\n\u0002\n\n\u00d1Qd2(F\u0000 x);H(F)\n\u000b\u0003\n:\n11\nThe idea of the above result is to use the fact that in the sense of generalized functions, one has that (see, for\nexample, Evans [14])\n\u00d1Qd2(y\u0000 x) = dx(y):\nTherefore, the above result can be understood as an application of the integration-by-parts formula.\nExample 4.2. Consider the two-dimensional model investigated in Section 3.5. Set\nF := [F1;F2]\n0 :=\nh\nS(1)0 exp\n\u0010\nX (1)T\n\u0011\n;S(2)0 exp\n\u0010\nX (2)T\n\u0011i0\n;\nwhere S(1)0 and S\n(2)\n0 are positive constants, as before. Then, givenFT , we have for s 2 [0;YT ],\nDsFk =\n(\ns1F1[1;0]0; if k = 1;\ns2F2 [r;h(r)]0 ; if k = 2;\nand\nDsF\u00001k =\u0000F\u00002k DsFk =\n(\n\u0000s1F\u000011 [1;0]0; if k = 1;\n\u0000s2F\u000012 [r;h(r)]0 ; if k = 2:\nHence, the Malliavin matrix gF of the random vector F givenFT is\ngF =\nZ YT\n0\n\u0014 kDsF1k2 hDsF1;DsF2i\nhDsF1;DsF2i kDsF2k2\n\u0015\nds= YT\n\u0014\ns21F21 s1s2F1F2r\ns1s2F1F2r s22F22\n\u0015\n;\nwhile its inverse almost surely exists and is given by\ng\u00001F =\n1\nYTs21s22F21 F22 h(r)2\n\u0014\ns22F22 \u0000s1s2F1F2r\n\u0000s1s2F1F2r s21F21\n\u0015\n:\nGivenFT , using the conditional integration-by-parts formula (2.5) with ht \u0011 1, we get\ndl\n\u0000\nF\u00001m\n\u0001\n= F\u00001m dl(1)\u0000\nZ YT\n0\nD(l)s F\u00001m ds=\n8>>>>><>>>>>:\nF\u000011\n\u0010\nW (1)YT \u0000s1YT\n\u0011\n; if (l;m) = (1;1);\nF\u000012\n\u0010\nW (1)YT \u0000s2rYT\n\u0011\n; if (l;m) = (1;2);\nF\u000011 W\n(2)\nYT ; if (l;m) = (2;1);\nF\u000012\n\u0010\nW (2)YT \u0000s2h(r)YT\n\u0011\n; if (l;m) = (2;2):\nHence, we get\nH(1)(F) =d1\n\u0010\n(g\u00001F )1;1D\n(1)\n\u0001 F1\n\u0011\n+d1\n\u0010\n(g\u00001F )1;2D\n(1)\n\u0001 F2\n\u0011\n+d2\n\u0010\n(g\u00001F )1;1D\n(2)\n\u0001 F1\n\u0011\n+d2\n\u0010\n(g\u00001F )1;2D\n(2)\n\u0001 F2\n\u0011\n=\nd1\n\u0000\nF\u000011\n\u0001\ns1YTh(r)2\n\u0000 r\n2d1\n\u0000\nF\u000011\n\u0001\ns1YTh(r)2\n+0\u0000 rd2\n\u0000\nF\u000011\n\u0001\ns1YTh(r)\n=\nW (1)YT \u0000\nr\nh(r)W\n(2)\nYT \u0000s1YT\nF1s1YT\n;\nand\nH(2)(F) =d1\n\u0010\n(g\u00001F )2;1D\n(1)\n\u0001 F1\n\u0011\n+d1\n\u0010\n(g\u00001F )2;2D\n(1)\n\u0001 F2\n\u0011\n+d2\n\u0010\n(g\u00001F )2;1D\n(2)\n\u0001 F1\n\u0011\n+d2\n\u0010\n(g\u00001F )2;2D\n(2)\n\u0001 F2\n\u0011\n=\u0000 rd1\n\u0000\nF\u000012\n\u0001\ns2YTh(r)2\n+\nrd1\n\u0000\nF\u000012\n\u0001\ns2YTh(r)2\n+0+\nd2\n\u0000\nF\u000012\n\u0001\ns2YTh(r)\n=\nW (2)YT \u0000s2YTh(r)\nF2s2YTh(r)\n:\n12\nHence, we get for x := (x1;x2)0 2 R2,\npF(x) = c2E\n\u0014\nE\n\u0014\u001c\nF\u0000 x\nkF\u0000 xk2 ;H(F)\n\u001d\f\fFT\u0015\u0015\n= c2E\n24 F1\u0000 x1\nkF\u0000 xk2\nW (1)YT \u0000\nr\nh(r)W\n(2)\nYT \u0000s1YT\nF1s1YT\n+\nF2\u0000 x2\nkF\u0000 xk2\nW (2)YT \u0000s2YTh(r)\nF2s2YTh(r)\n35 :\nWe can show that the above formula is well defined when there exists p> 1 and q> 0 such that\nE\nh\nY\u0000pT e\n2p((\u0000q1+q)_(\u0000q2+ps22 ))YT\ni\n<+\u00a5:\nNotice that as in the case of the Greeks formulas of European type, the Markov feature of the time control process is\nnot required in the derivation of the above estimator and we need only the sample of the marginal YT , but not the entire\nsample paths fYt : t 2 [0;T ]g. We present in Figure 2 and Figure 3 simulation results, respectively, of the variance\ngamma model and the normal inverse Gaussian model.\nFor two reasons, the above density estimation formulae outperforms the standard kernel density estimation, for\nexample, bph(x) := 1hd1 E\n\u0014\nK\n\u0012\nx\u0000ST\nh\n\u0013\u0015\n; x 2 Rd1 ;\nwhere K is a suitable kernel and where h is the bandwidth. First, the kernel density estimation is only asymptotically\nunbiased as h # 0, while in reality h can never be taken zero. On the other hand, our density estimators are intrinsically\nunbiased. Second, in the kernel density estimation, Monte Carlo summands provide almost no contribution to the\nconvergence ofMonte Carlo simulation unless realizations are very close to x. This problem turns out to be very serious\nwhen we set the bandwidth h to be extremely small. In our formula, meanwhile, all the Monte Carlo realizations make\nan equal contribution.\nA drawback of our formula is its infinite variance, due to the singularity of the denominator kF \u0000 xk2. To get\naround this issue, we may employ an approximation technique studied in Kohatsu-Higa and Yasuda [19] also in our\nframework, in exchange for the lost of the unbiasedness. In such a case, the method is similar to the kernel density\nestimation but the rates of bias and variance and smaller than in the classical method due to the use of the conditional\nintegration-by-parts formula.\n5 Concluding Remarks\nIn this paper, we have computed formulas for the Greeks and the multidimensional density estimation for an asset\nprice dynamics model defined with time-changed Brownian motions. Our approach is based on an application of\nMalliavin duality formulas on the Gaussian space conditioning on the jump component. We have noticed that the\nMarkov property of the time-changing process is not required and that our formulas may recover the counterparts with\nthe degenerate time clock.\nOn the sensitivity analysis for asset price models related to jump processes, a variety of different approaches have\nbeen proposed in the literature. In some cases, we may derive different formulas for a single object. For example,\nthe variance gamma model can also be in the framework of [17], where different formulas are obtained for delta,\ngamma, and vega. It would be interesting to somehow investigate how those distinct formulas should be compared,\nfor example, in terms of the Monte Carlo variance.\nAcknowledgements\nThe authors would like to thank Japan Society for the Promotion of Science for Grant-in-Aid for Scientific Research\n20740059 and 21340024. This work was largely carried out while RK was based at Center for the Study of Finance\nand Insurance, Osaka University.\n13\nReferences\n[1] Bally, V., Bavouzet, M. P., Messaoud, M. (2007) Integration by parts formula for locally smooth laws and\napplications to sensitivity computations, Annals of Applied Probability, 17(1) 33-66.\n[2] Bally, V., Caramellino, L. (2006) Lower bounds for the density of Ito processes under weak regularity condi-\ntions, working paper.\n[3] Barndorff-Nielsen, O.E. (1998) Processes of normal inverse Gaussian type, Finance and Stochastics, 2(1) 41-\n68.\n[4] Bichteler, K., Gravereaux, J. B., Jacod, J. (1987) Malliavin calculus for processes with jumps, Gordon and\nBreach Science Publishers, New York.\n[5] Bismut, J. M. (1981) Martingales, the Malliavin calculus and hypoellipticity under general Ho\u00a8rmander\u2019s condi-\ntions, Z. Wahrsch. Verw. Gebiete, 56(4) 469-505.\n[6] Bismut, J. M. (1984) Large deviations and the Malliavin calculus, Birkha\u00a8user, Boston.\n[7] Carlen, E., Pardoux, E. (1990) Differential calculus and integration by parts on Poisson space. In: Albeverio,\nS., Blanchard, Ph., Testard, D. (eds.) Stochastics, algebra and analysis in classical and quantum dynamics\n(Marseille, 1988) (Math. Appl., vol. 59). Dordrecht: Kluwer Acad. Publ., 63-73.\n[8] Carr, P., Geman, H., Madan, D., Yor, M. (2003) Stochastic Volatility for Le\u00b4vy processes,Mathematical Finance,\n13(3) 345-382.\n[9] Carr, P., Madan, D. (1999) Option pricing and the fast Fourier transform, Journal of Computational Finance,\n2(4) 61-73.\n[10] Cass, T. R., Friz, P. K. (2007) The Bismut-Elworthy-Li formula for jump-diffusions and applications to Monte\nCarlo methods in finance, available at arXiv:math\/0604311v3.\n[11] Cox, J.C., Ingersoll, J.E., Ross, S.A. (1985) A theory of the term structure of interest rates, Econometrica, 53(2)\n385-407.\n[12] Davis, M.H.A., Johansson, M.P. (2006) Malliavin Monte Carlo Greeks for jump diffusions, Stochastic Pro-\ncesses and their Applications, 116(1) 101-129.\n[13] El-Khatib, Y., Privault, N. (2004) Computations of Greeks in a market with jumps via the Malliavin calculus,\nFinance and Stochastics, 8(2) 161-179.\n[14] L. C. Evans (1998) Partial Differential Equations. Graduate Studies in Mathematics. Volume 19. American\nMathematical Society, 1998.\n[15] Fournie\u00b4, E., Lasry, J. M., Lebuchoux, J., Lions, P. L., Touzi, N. (1999) Applications of Malliavin calculus to\nMonte Carlo methods in finance, Finance and Stochastics, 3(4) 391-412.\n[16] Fu, M.C. (2007) Variance-Gamma and Monte Carlo, In: Advances in Mathematical Finance (eds. Fu, Jarrow,\nYen, Elliott), 21-35, Birkha\u00a8user.\n[17] Kawai, R., Takeuchi, A., Greeks formulae for an asset price model with gamma processes, Mathematical Fi-\nnance, to appear.\n[18] Kawai, R., Takeuchi, A. (2010) Sensitivity analysis for averaged asset price dynamics with gamma processes,\nStatistics and Probability Letters, 80(1) 42-49.\n[19] Kohatsu-Higa, A., Yasuda, K. (2009) Estimating multidimensional density functions using the Malliavin-\nThalmaier formula, SIAM Journal on Numerical Analysis, 47(2) 1546-1575.\n[20] Madan, D., Carr, P., Chang, E. (1998) The variance gamma process and option pricing, European Finance\nReview, 2, 79-105.\n14\n[21] Malliavin, A., Thalmaier, A. (2006) Stochastic Calculus of Variations in Mathematical Finance, Springer-\nVerlag, Berlin.\n[22] Montero, M., Kohatsu-Higa, A. (2003) Malliavin calculus applied to finance, Physica A, 320, 548-570.\n[23] Nualart, D. (2006) The Malliavin Calculus and Related Topics, Springer-Verlag, Berlin.\n[24] Rosin\u00b4ski, J. (1991) On a class of infinitely divisible processes represented as mixtures of Gaussian processes,\nIn: Stable Processes and Related Topics, Progress in Probability, 25, Birkha\u00a8user, Basel, 27-41.\n[25] Sato, K. (1999) Le\u00b4vy processes and infinitely divisible distributions, Cambridge University Press.\n[26] Schoutens, W. (2003) Le\u00b4vy processes in finance, Wiley.\n[27] Takeuchi, A., The Bismut-Elworthy-Li type formulae for stochastic differential equations with jumps, Journal\nof Theoretical Probability, to appear.\n15\n0 40000 80000 120000 160000 200000\n0.022\n0.024\n0.026\n0.028\n0.030\n0.032\nMC\nFD\n0 40000 80000 120000 160000 200000\n0.35\n0.40\n0.45\n0.50\nMC\nFD\n\u00b6\n\u00b6S0\nE[e\u0000rT1(ST > K)] \u00b6\u00b6s E[e\n\u0000rT\n1(ST > K)]\n(FD)\n(MC) = 589 and e = 5e-4.\n(FD)\n(MC) = 14 and e = 5e-3.\n0 40000 80000 120000 160000 200000\n2e\u22125\n4e\u22125\n6e\u22125\n8e\u22125\n1e\u22124\n1.2e\u22124\n1.4e\u22124\n1.6e\u22124 MCFD\n0 20000 40000 60000 80000 100000\n0.014\n0.018\n0.022\n0.026\n0.030\nMC\nFD\n\u00b6 2\n\u00b6S20\nE[e\u0000rT1(ST > K)] \u00b6\u00b6S0E\nh\ne\u0000rT1\n\u0010\n1\nT\nR T\n0 Sudu> K\n\u0011i\n(FD)\n(MC) = 130 and e = 2e-2.\n(FD)\n(MC) = 18 and e = 1e-4.\n0 40000 80000 120000 160000 200000\n\u22120.02\n\u22120.01\n0.00\n0.01\n0.02\n0.03\n0.04\n0.05\n0.06\n0.07\n0.08\nMC\nFD\n0 40000 80000 120000 160000 200000\n\u22126e\u22124\n\u22124e\u22124\n\u22122e\u22124\n0e+0\n2e\u22124\n4e\u22124\n6e\u22124\nMC\nFD\n\u00b6\n\u00b6rE[e\n\u0000rT\n1(F > K)] \u00b6\n2\n\u00b6S(1)0 \u00b6S\n(2)\n0\nE[e\u0000rT1(F > K)]\n(FD)\n(MC) = 42 and e = 1e-2.\n(FD)\n(MC) = 110 and e = 1e-2.\nFigure 1: (FD)(MC) indicates the variance ratios Var(FD)\/Var(MC). The quantity e is the increment for the finite difference\nestimation.\n16\n0.0006\n0.0012\n0\n100\n200\nF1\n040\n80120\n160200\nF2\n0.0006\n0.0012\n0\n40\n80\n120\n160\n200\nF1\n040\n80120\n160200\nF2\nr = 0 r = 0:5\nFigure 2: Variance gamma model; parameters are S(1)0 = S\n(2)\n0 = 100, r = 0:05, T = 1, s1 = s2 = 0:12, q1 = q2 = 0:1,\nand n = 1=6.\n0\n0.0004\n0.0008\n0\n40\n80\n120\n160\n200\nF1\n02040\n6080100\n120140160\n180200\nF2\n0\n0.0004\n0.0008\n0\n40\n80\n120\n160\n200\nF1\n02040\n6080100\n120140160\n180200\nF2\nr = 0 r = 0:5\nFigure 3: Normal inverse Gaussian model; parameters are S(1)0 = S\n(2)\n0 = 100, r= 0:05, T = 1, a = 8, b =\u00003, d = 0:2.\n17\n"}