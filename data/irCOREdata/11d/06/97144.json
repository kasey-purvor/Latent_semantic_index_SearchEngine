{"doi":"10.1103\/PhysRevE.78.026203","coreId":"97144","oai":"oai:generic.eprints.org:746\/core69","identifiers":["oai:generic.eprints.org:746\/core69","10.1103\/PhysRevE.78.026203"],"title":"A Comparison of Tests for Embeddings","authors":["Letellier, C.","Moroz, I. M.","Gilmore, R."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2008-08-06","abstract":"It is possible to compare results for the classical tests for embeddings of chaotic data with the results of a recently proposed test. The classical tests, which depend on real numbers (fractal dimensions, Lyapunov exponents) averaged over an attractor, are compared with a topological test that depends on integers. The comparison can only be done for mappings into three dimensions. We find that the classical tests fail to predict when a mapping is an embedding and when it is not. We point out the reasons for this failure, which are not restricted to three dimensions","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/97144.pdf","fullTextIdentifier":"http:\/\/eprints.maths.ox.ac.uk\/746\/3\/PhysRevE_78_026203.pdf","pdfHashValue":"976bb2cf9d625a4c2d1e3e54877bc0f9c46f641c","publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:generic.eprints.org:746<\/identifier><datestamp>\n      2015-05-29T18:27:48Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D4447:4D3337<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/eprints.maths.ox.ac.uk\/746\/<\/dc:relation><dc:title>\n        A Comparison of Tests for Embeddings<\/dc:title><dc:creator>\n        Letellier, C.<\/dc:creator><dc:creator>\n        Moroz, I. M.<\/dc:creator><dc:creator>\n        Gilmore, R.<\/dc:creator><dc:subject>\n        Dynamical systems and ergodic theory<\/dc:subject><dc:description>\n        It is possible to compare results for the classical tests for embeddings of chaotic data with the results of a recently proposed test. The classical tests, which depend on real numbers (fractal dimensions, Lyapunov exponents) averaged over an attractor, are compared with a topological test that depends on integers. The comparison can only be done for mappings into three dimensions. We find that the classical tests fail to predict when a mapping is an embedding and when it is not. We point out the reasons for this failure, which are not restricted to three dimensions.<\/dc:description><dc:date>\n        2008-08-06<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/eprints.maths.ox.ac.uk\/746\/3\/PhysRevE_78_026203.pdf<\/dc:identifier><dc:identifier>\n          Letellier, C. and Moroz, I. M. and Gilmore, R.  (2008) A Comparison of Tests for Embeddings.  Phys. Rev E, 78 .        <\/dc:identifier><dc:relation>\n        http:\/\/link.aps.org\/abstract\/PRE\/v78\/e026203<\/dc:relation><dc:relation>\n        DOI: 10.1103\/PhysRevE.78.026203<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/eprints.maths.ox.ac.uk\/746\/","http:\/\/link.aps.org\/abstract\/PRE\/v78\/e026203","DOI: 10.1103\/PhysRevE.78.026203"],"year":2008,"topics":["Dynamical systems and ergodic theory"],"subject":["Article","PeerReviewed"],"fullText":"Comparison of tests for embeddings\nC. Letellier,1 I. M. Moroz,2 and R. Gilmore1,3\n1Universit\u00e9 de Rouen, CORIA UMR 6614, BP 12, F-76801 Saint-Etienne du Rouvray cedex, France\n2Mathematical Institute, 24-29 St Giles\u2019, Oxford OX1 3LB, United Kingdom\n3Physics Department, Drexel University, Philadelphia, Pennsylvania 19104, USA\n\u0001Received 17 December 2007; published 6 August 2008\u0002\nIt is possible to compare results for the classical tests for embeddings of chaotic data with the results of a\nrecently proposed test. The classical tests, which depend on real numbers \u0001fractal dimensions, Lyapunov\nexponents\u0002 averaged over an attractor, are compared with a topological test that depends on integers. The\ncomparison can only be done for mappings into three dimensions. We find that the classical tests fail to predict\nwhen a mapping is an embedding and when it is not. We point out the reasons for this failure, which are not\nrestricted to three dimensions.\nDOI: 10.1103\/PhysRevE.78.026203 PACS number\u0001s\u0002: 05.45.\u0001a\nI. INTRODUCTION\nThe treatment of data generated by chaotic dynamical sys-\ntems involves two separate steps. The first is the search for\nan embedding of the data into a phase space of suitable di-\nmension. The second is an analysis of the reconstructed cha-\notic attractor once a suitable embedding has been found.\nAt the analysis stage, the embedded attractor can be stud-\nied using tools that can broadly be classified as geometric,\ndynamical, or topological. The geometric and dynamical\ntools can be applied to an attractor reconstructed in a phase\nspace of any dimension, but at present the topological tools\ncan be applied only to attractors embedded in a three-\ndimensional space. To compensate for this restriction, the\ntopological tools reveal the mechanism responsible for pro-\nducing chaotic behavior. In addition they are overdeter-\nmined, so that the results of an analysis can be rejected if\nwell-defined self-consistency criteria are not met. Geometric\nand dynamical analysis methods do not reveal mechanism.\nAt the embedding stage, tests to determine whether a\nmapping is an embedding or not have been of two types in\nthe past: geometric and dynamical. As for analyses, these\ntests for embeddings are applicable to any dimension. They\nall lack rejection criteria. We have recently proposed a topo-\nlogical test for embeddings \u00031\u0004. This topological test is ap-\nplicable only to three-dimensional mappings of data. How-\never, this test supports strong rejection criteria.\nThere have been many claims of successful embeddings\nof data based on geometric measures \u0001fractal dimensions,\nfalse near neighbors\u0002 or dynamical measures \u0001Lyapunov ex-\nponents and dimensions, predictability\u0002, but few independent\ntests of whether such claims are valid. For this reason, in the\npresent work we will compare the results of tests for embed-\ndings using the three different tools currently available in\nthree dimensions. We find that tests for embeddings based on\ngeometric measures and dynamical measures fail to distin-\nguish between mappings that are embeddings and those that\nare not. We discuss sources for such failures and the impact\nof noise on these tests. In view of our results in three dimen-\nsions where the topological test is available to test claims\nbased on geometric and dynamical methods, we suggest that\nall claims for successful embeddings into three or higher\ndimensions, based on geometric or dynamical methods, be\ntreated with the greatest skepticism.\nThis work is organized as follows. In Sec. II we review\nthe tests for embeddings that have been proposed. In Sec. III\nwe describe the two sets of data used for this comparison. In\nSecs. IV\u2013VI we present the results of the geometric, dynami-\ncal, and topological tests for the mappings of these data sets.\nThe real measures involved in the classical tests undergo\nintrinsic fluctuations from one data set to another. The statis-\ntics of these fluctuations are discussed in Sec. VII. In Sec.\nVIII we describe why the classical tests, depending on real\nmeasures averaged over the mapped attractor, can be insen-\nsitive to whether the mapping is or is not an embedding.\nEach test depends on values of one or more parameters that\nmust be set before the test is implemented. Test results could\ndepend on these parameter values. The parameters intrinsic\nto each type of test are discussed in Sec. IX. We compare the\nrelative computational load for these three types of test in\nSec. X. The effects of noise on the robustness of these tests is\ndiscussed in Sec. XI. In Sec. XII we summarize our findings:\nall assertions that a mapping is an embedding based on geo-\nmetric or dynamical tests should be treated as provisional\nand regarded with skepticism until independent tests either\nreject or fail to reject such claims.\nII. REVIEW OF EMBEDDING TESTS\nThe first step in the analysis of chaotic data is a search for\na suitable embedding \u00032\u20134\u0004. An embedding is a mapping of\nthe data into a phase space RD without self-intersections, so\nthat each point in the attractor has a unique future and deter-\nminism is preserved \u00035\u0004. An embedding creates a diffeomor-\nphism between the original attractor and the reconstructed\nattractor. If the data are chaotic, D\u00023 \u00036\u0004.\nMappings of scalar time series into RD take the form\nm\u0001t\u0002\u2192 (x1\u0001t\u0002 ,x2\u0001t\u0002 ,x3\u0001t\u0002 , . . . ,xD\u0001t\u0002), where the coordinates\nxi\u0001t\u0002 are functions of the observables. A number of mappings\nhave been proposed. The default is the time delay mapping,\nin which xi\u0001t\u0002=m\u0003t\u2212 \u0001i\u22121\u0002\u0003\u0004, where \u0003 is the time delay\n\u00032\u20134\u0004. Another very useful mapping is the differential map-\nping, in which xi\u0001t\u0002=d\u0001i\u22121\u0002m\u0001t\u0002 \/dt\u0001i\u22121\u0002 \u00037\u0004. Other useful map-\npings take the form of mixtures of these two types\u2014for\nPHYSICAL REVIEW E 78, 026203 \u00012008\u0002\n1539-3755\/2008\/78\u00012\u0002\/026203\u000111\u0002 \u00a92008 The American Physical Society026203-1\nexample, m\u0001t\u0002\u2192 (m\u0001t\u0002 ,dm\u0001t\u0002 \/dt ,m\u0001t\u2212\u0003\u0002), singular value de-\ncomposition \u0001SVD\u0002 mappings, and Hilbert transform pairs.\nClasses of mappings have been reviewed in \u00038\u201312\u0004. Projec-\ntions of various types, involving Fourier or SVD decompo-\nsitions, are particularly useful for vector time series. Projec-\ntion of data from higher into lower dimensions \u000313\u0004 is similar\nin spirit to reductions of partial differential equations to sets\nof ordinary differential equations \u000314,15\u0004.\nLow-dimensional differential embeddings, when they can\nbe found, offer a strong advantage over other types of em-\nbeddings. The advantage comes in the next natural step in\nthe analysis. This is the construction of a model, a set of\nordinary differential equations, that simulates the process\ngenerating the data. When a differential embedding is avail-\nable, the derivative of each variable is the next variable\n\u0001dxi \/dt=xi+1\u0002, so it is only necessary to model the dynamics\nof the last variable: dxn \/dt= f\u0001x1 ,x2 , . . . ,xn\u0002. For a time delay\nembedding it is necessary to construct n functions, each of n\nvariables: dxi \/dt= f i\u0001x1 ,x2 , . . . ,xn\u0002, i=1,2 , . . . ,n.\nOnce observed data have been mapped into a\nD-dimensional phase space it is necessary to determine\nwhether the mapping is an embedding. A number of embed-\nding tests have been used extensively in the past. They all\nshare a common feature: they are implemented as a function\nof increasing dimension, a real statistic is averaged over the\nimage of the attractor, and a mapping is declared an embed-\nding when a threshold is reached. These classical tests are of\ntwo broad types: geometric and dynamical. Each type has\nmany variants. The earliest test was geometric. It depended\non computing geometric invariants \u000316\u0004 such as fractal di-\nmensions and looking for \u201csaturation of fractal dimensions\u201d\nas a function of increasing dimension \u000317\u201319\u0004. In principle,\nfractal dimensions are invariants under diffeomorphisms, so\nthat they saturate at constant values with increasing dimen-\nsion. In practice, this test was difficult to implement. As early\nas 1990, Ruelle cautioned about undue reliance on these un-\nreliable measures \u000320\u0004. Then in 1992 Lefranc and colleagues\nshowed that correlation dimension estimates of experimental\ndata were in practice not invariant under a simple logarith-\nmic transformation \u000321\u0004.\nEmbedding tests depending on fractal dimension esti-\nmates were largely superseded in practice by the \u201cfalse near\nneighbor\u201d test \u000322\u0004. This test looks at two points near each\nother in some mapping and determines whether they remain\nnear each other as the dimension increases. If \u201cyes,\u201d the two\npoints are assumed near each other in the original attractor\nthat generated the data. If \u201cno,\u201d the two points are considered\nfalse near neighbors. A mapping is declared an embedding\nwhen a sufficiently small percentage of point pairs are deter-\nmined to be false near neighbors.\nDynamical tests are similar in spirit. If a mapping is an\nembedding, then a point in RD has a unique future. Predict-\nability of the future from the present was implemented in the\n\u201cbad prediction\u201d test \u000323\u0004. This same property was imple-\nmented in another way as a \u201ctest for determinism\u201d \u000324\u0004. In\nthis test the phase space was decimated in each dimension\nand the uniqueness of the flow direction in each\nD-dimensional cube was estimated by computing inner prod-\nucts of tangent vectors to all trajectories passing through\neach cube. Both these dynamical tests declare a mapping to\nbe an embedding when the relevant statistic reaches an ap-\npropriate value. Data requirements for the test for determin-\nism grow exponentially with dimension D and decimation\ndegree. To average n points per box in a D-dimensional map-\nping with decimation degree d, ndD points are required.\nIn part because of large data requirements, this class of\ntests was largely supplanted by tests depending on Lyapunov\nexponent estimates \u00035,25\u201329\u0004 and Lyapunov dimension esti-\nmates \u000330\u0004 that are derived from them. The basic idea is that\nas the dimension increases, estimates of the largest Lyapunov\nexponent become reliable when and after an embedding is\nachieved. A major problem is that the number of Lyapunov\nexponents is equal to the dimension of the mapping. Above\nthe correct embedding dimension there are spurious expo-\nnents, and these can be larger than the largest Lyapunov ex-\nponent \u000331,32\u0004. We concentrate our study on Lyapunov ex-\nponent tests with the understanding that other dynamical\ntests for embeddings are in principle still possible.\nThe topological test is applicable to families of three di-\nmensional mappings. The essential idea is that for the map-\nping to be an embedding, each point must have a unique\nfuture: self-intersections are forbidden. If the chaotic attrac-\ntor undergoes self-intersections as some parameter in the\nfamily varies, then the unstable periodic orbits that exist in\nabundance in the attractor will also undergo intersections.\nWhen two unstable periodic orbits undergo a self-\nintersection, the minimum distance between these orbits goes\nto zero. In such cases, a plot of the minimum distance be-\ntween two orbits as a function of the mapping parameter\nshows a dip towards zero, followed by a rise from zero after\nthe crossing. We call such events \u201czero crossings.\u201d The zero\ncrossing may be resolution limited. In such cases, the zero\ncrossing can be confirmed by computing an important topo-\nlogical index. The Gauss linking number changes by \u00041 at a\nzero crossing, or at an intersection of two unstable periodic\norbits \u00037,11,12,33\u0004.\nThe basic idea of and algorithm for the new topological\ntest for embedding is simple to state \u00031\u0004. \u0001i\u0002 Search through\nthe time series for unstable periodic orbits. This can be done\nby the method of close returns before any embedding is at-\ntempted \u000311,12,34\u0004. \u0001ii\u0002 Choose a family of mappings de-\npending on some parameter and map these orbits into R3.\n\u0001iii\u0002 Compute the minimum distance between each pair of\nmapped orbits in the parameter range. The mapping cannot\nbe an embedding where any of these minima show zero\ncrossings. If a zero crossing is uncertain \u0001cf, Fig. 12 below\u0002,\ncompute the linking number \u000311,12,33\u0004 of the two orbits on\neach side of the apparent crossing. At a real crossing the\nlinking number changes by \u00041. In parameter regions where\nthe linking numbers of two or more orbit pairs change\nfrequently\u2014that is, where many zero crossings occur\u2014we\ncan reject the hypothesis that the mapping is an embedding.\nWhere there are no zero crossings, the linking numbers re-\nmain unchanged and it is not possible to reject the hypothesis\nthat the mapping is not an embedding \u0001in friendlier words,\nthe mapping could be an embedding\u0002.\nConfirming that the mapping is an embedding follows\nfrom a topological analysis of the mapped attractor. This type\nof analysis can even be applied to a single mapping not\nbelonging to a family of mappings, to determine whether it is\nLETELLIER, MOROZ, AND GILMORE PHYSICAL REVIEW E 78, 026203 \u00012008\u0002\n026203-2\nan embedding or not. Details are available in \u00037,11,12\u0004.\nBehind all these tests lurk the embedding theorems. These\nguarantee that if the dynamics is produced by an\nn-dimensional dynamical system, the data describing the dy-\nnamics can always be embedded in RD for D sufficiently\nlarge. These theorems are based on the idea that if the di-\nmension is sufficiently large, there is enough room in phase\nspace so that self-intersections typically \u0001\u201cgenerically\u201d\u0002 do\nnot occur. The simplest estimate D\u00022n+1, based on ge-\nnericity, was reduced to D\u00022n by Whitney \u000335\u0004 and reduced\nonce again to D\u00052dA \u000336\u0004, where dA is an appropriate frac-\ntal dimension. For the Lorenz attractor \u000315\u0004 with dA=2.06 for\n\u0001R ,\u0006 ,b\u0002= \u000128.0,10,8 \/3\u0002, these theorems guarantee that an\nembedding into RD with D\u00025 can always be found. As\npointed out by Abarbanel and collaborators \u00038,9,22\u0004, for\nthose interested in knowing the minimum \u0001necessary\u0002 dimen-\nsion for having an embedding, to have a sufficient condition\nis useless. If the dynamics is three dimensional, we need an\nalgorithm for constructing a three-dimensional embedding\nrather than a theorem stating that a five-dimensional embed-\nding exists.\nOnce a suitable embedding has been determined, the em-\nbedded data can be analyzed. The analysis procedures are of\nthree broad types: geometric \u000318\u0004, dynamical \u000325\u0004, and topo-\nlogical \u00037\u0004. Geometrical analyses focus on computing the\nspectra of fractal dimensions or the fraction of false near\nneighbors. Dynamical analyses focus on estimating\nLyapunov exponents and predictability indices. These calcu-\nlations can be carried out for any value of the dimension D.\nThe results are real numbers with no underlying statistical\ntheory to provide believable error estimates \u0001error bars are\n\u201ceducated guesses\u201d \u000319\u0004\u0002 and no information about the\nmechanism that generates chaotic behavior. Topological\nanalyses can be carried out only when D=3. The results are\noverdetermined and therefore contain their own rejection cri-\nteria \u00037,11\u0004, an assertion that cannot be made for the other\ntwo analysis methods. Further, these analyses reveal the na-\nture of the bending and folding mechanism \u000337\u0004 or the\nstretching and squeezing mechanism \u000338\u0004 responsible for\ngenerating chaotic behavior.\nIII. COMPARISON DATA SETS\nWe use two data sets to compare the three types of tests\nfor embedding. In neither case do we employ a standard time\ndelay embedding. For this reason the standard types of\nanalyses employed with geometric and dynamical tests\u2014\nsaturation of some real measure\u2014are not available.\nData taken during a fluid experiment in a Benard-\nMarangoni configuration \u000339\u0004 were analyzed \u000340\u0004 and mod-\neled as a periodically driven Takens-Bogdanov oscillator\n\u000341\u0004 in the following form:\nx\u02d9 = y ,\ny\u02d9 = \u0001\u0007x + \by\u0002f\u0001\t\u0002 \u2212 x3 + x2y ,\n\t\u02d9 = \n , \u00011\u0002\nwhere f\u0001\t\u0002=1+\u000b cos\u0001\t\u0002. The parameter values were taken\nas \u0001\u0007 ,\b ,\u000b ,\n\u0002= \u00011.0434,\u22121.0,0.45,0.399\u0002. A single scalar\ntime series x\u0001t\u0002 was produced by this model and mapped\nfrom R1 into R3 a with mixed differential-delay type map-\nping that was explicitly x\u0001t\u0002\u0001R1\u2192 (x\u0001t\u0002 ,dx\u0001t\u0002 \/dt ,x\u0001t\u2212\u0003\u0002)\n\u0001R3 \u000341\u0004. The mapping parameter is the single time delay \u0003.\nFor some values of the delay the mapping is an embedding\nwhile for others it is not. The analysis leading to these con-\nclusions has been described in \u000342\u0004 and will be reviewed in\nSec. VI.\nA three-dimensional differential embedding x\u0001t\u0002\n\u2192 \u0001x , x\u02d9 , x\u00a8\u0002 would have been preferable for reasons given\nabove, but was not used because of noise involved in com-\nputing x\u00a8 \u00037,39\u0004. A standard time delay embedding xi\u0001t\u0002=x\u0003t\n\u2212 \u0001i\u22121\u0002\u0003\u0004 would have involved determination of three forc-\ning functions dxi \/dt= f i\u0001x1 ,x2 ,x3\u0002. For this reason the mixed\ndifferential-delay embedding was adopted \u000341\u0004.\nPrevious study \u000340,42\u0004 has shown that the one-parameter\nfamily of mappings depending on the single time delay \u0003 is\nan embedding for some values of \u0003 and not for others. We\nshow below that the topological test can distinguish between\nvalues of \u0003 for which the mapping is an embedding and for\nwhich it is not, while the geometric and dynamical tests fail\nto make this distinction.\nThe second data set that we used to compare the three\nmethods of testing for embedding is a four-vector time series\nproduced by the dynamical system \u000343\u0004:\nX\u02d9 = \u0006\u0001\u2212 X + Y\u0002 \u2212 7.1111\fU ,\nY\u02d9 = \u0001R\/\b\u0002X \u2212 Y \u2212 XZ ,\nZ\u02d9 = \u2212 \bZ + XY ,\nU\u02d9 = \u2212 \rU + X . \u00012\u0002\nThis system is a modification of the Malkus-Robbins dy-\nnamo equations \u0003involving only \u0001X ,Y ,Z\u0002\u0004 which were origi-\nnally introduced to model the action of a self-exciting dy-\nnamo \u000344\u201346\u0004. The extension is to include the variable U,\nwhich represents the angular speed of the motor of the dy-\nnamo \u000345\u0004. For \f=0 there is no feedback from the U sub-\nsystem into the \u0001X ,Y ,Z\u0002 subsystem, which behaves like a\nLorenz attractor. The dynamics was studied for \u0001\u0006 ,\b ,R\u0002\n= \u000110,8 \/3,74.667\u0002, where the Lorenz equations generate a\nchaotic attractor and \r=3.2. In the range 0\u000e\f\u000f7.9, Eq. \u00012\u0002\ngenerates a chaotic attractor with Lyapunov dimension dL\n\u00052.2 \u000343\u0004. A boundary crisis destroys the attractor at \f\n\u00057.9.\nIn this case all four time series (X\u0001t\u0002 ,Y\u0001t\u0002 ,Z\u0001t\u0002 ,U\u0001t\u0002) are\navailable. This is not usual for experimental systems. The\nquestion that drives this analysis is one of reducing complex-\nity. Is it possible to simplify the study of this dynamical\nsystem by projecting the attractors into a lower- \u0001three-\u0002 di-\nmensional space? In this case we do not have a single attrac-\ntor and a family of mappings into R3. Rather, there is a\none-parameter \u0001\f\u0002 family of attractors, and we seek to deter-\nCOMPARISON OF TESTS FOR EMBEDDINGS PHYSICAL REVIEW E 78, 026203 \u00012008\u0002\n026203-3\nmine whether the projection into some R3 subspace is an\nembedding for all, some, or no values of the parameter \f\n\u000343\u0004.\nWe used topological tests for embeddings and topological\nanalyses to determine under what conditions the two projec-\ntion mappings \u0001X ,Y ,Z ,U\u0002\u2192 \u0001X ,Y ,Z\u0002 and \u0001X ,Y ,Z ,U\u0002\n\u2192 \u0001X ,Y ,U\u0002 were or were not embeddings. We found the first\nprojection failed to be an embedding in the range 0.6\u000f\f\n\u000f5.4. In this parameter range the projected attractor under-\ngoes self-intersections \u0001cf. Fig. 15 below\u0002 and the unstable\nperiodic orbits in the attractor undergo many zero crossings.\nThe second projection \u0001X ,Y ,Z ,U\u0002\u2192 \u0001X ,Y ,U\u0002 was an em-\nbedding for all values of the parameter \f. The attractor un-\ndergoes no self-intersections as a function of \f in this pro-\njection. The analysis leading to these conclusions has been\ndescribed in \u000343\u0004 will be reviewed in Sec. VI.\nThe two sets of time series studied below have been pro-\nduced by Eqs. \u00011\u0002 and \u00012\u0002.\nIV. GEOMETRIC TESTS\nTwo types of geometric tests were carried out. One de-\npends on estimating the fraction of false near neighbors as a\nfunction of the appropriate parameter. The other involves\nestimating the correlation dimension, also as a function of\nthe mapping parameter.\nA. False near neighbors\nThe false nearest neighbors \u0001FNN\u0002 test was applied fol-\nlowing the usual procedure \u000322\u0004. A point x\u0001i\u0002 is chosen, and\nall points x\u0001j\u0002 are searched over whose first k coordinates are\nwithin a distance \u000b of each other: \u0006xr\u0001i\u0002\u2212xr\u0001j\u0002\u0006\u000f\u000b, r\n=1,2 , . . . ,k. For each such x\u0001j\u0002 the k+1st coordinates of x\u0001i\u0002\nand x\u0001j\u0002 are compared and the points at i and j are declared\ntrue neighbors if \u0006xk+1\u0001i\u0002\u2212xk+1\u0001j\u0002\u0006\u000f5\u000b and false neighbors\notherwise. The number of true and false neighbors is com-\nputed for each point x\u0001i\u0002 and the ratio of false neighbors to\nthe total number of its neighbors is computed. As k increases,\nthis ratio decreases, and when it gets \u201csmall enough,\u201d an\nembedding is declared. In this estimate \u000b was chosen as 1%\nof the diameter of the attractor. We point out that \u000b and 5 are\nreasonable but arbitrary input parameters.\n1. Fluid model\nIn order to carry out the FNN test on the fluid data to see\nif a three-dimensional embedding exists we need at least four\ncoordinates. The first three were prescribed by the family of\nmappings chosen: (x\u0001t\u0002 ,dx\u0001t\u0002 \/dt ,x\u0001t\u2212\u0003\u0002). As a fourth coor-\ndinate we chose x4\u0001t\u0002=x\u0001t\u22122\u0003\u0002 in the spirit of standard time\ndelay embeddings. To check that the codes developed to per-\nform this computation were robust, we included a fifth coor-\ndinate, chosen again in the spirit of standard time delays as\nx5\u0001t\u0002=x\u0001t\u22123\u0003\u0002. If the first three coordinates did not provide\nan embedding, the first four should, so that the fraction of\nFNN in going from four to five dimensions should fall to\napproximately zero. This provided a test of the computa-\ntional procedure. The test was carried out for data sets of\nlength 5000 points. Some larger data sets were used without\nthe results being altered in any way.\nWe computed the fraction of FNN in going from N=2 to\n3 dimensions, N=3 to 4, and N=4 to 5 dimensions. The\nresults are shown in Fig. 1, plotted as a function of the delay\nparameter \u0003. For N=2 the fraction of false near neighbors is\nin excess of 0.5. This is to be expected, as two-dimensional\nsystems cannot behave chaotically. For N=4 the fraction of\nFNN is zero or almost zero for all delays. This is also ex-\npected, as the system is three dimensional \u000342\u0004. For N=3\nthere is a substantial fraction of FNN. Further, this fraction\ndoes not show any clear signatures that a three-dimensional\nembedding occurs for some values of the delay \u0003 in this\nregion and not for others. This curve is a clear indication that\nthe FNN test fails to distinguish between mappings that are\nembeddings and those that are not in the present case.\n2. Dynamo model\nThe FNN test was also applied to the dynamo data x\u0001i\u0002.\nOne data set was chosen in the form \u0001X ,Y ,Z ,U\u0002. As applied,\nwe tested whether two points with indices i and j whose\n\u0001X ,Y ,Z\u0002 coordinates were close in the R3 subspace were also\nclose in the full space R4. The FNN test was carried out as a\nfunction of the parameter \f. The FNN test was also carried\nout on the reordered data \u0001X ,Y ,U ,Z\u0002 to test in the same way\nwhether the projection into the \u0001X ,Y ,U\u0002 subspace was an\nembedding.\nResults of this test are shown in Fig. 2. This figure shows\nthe FNN ratio as a function of the parameter \f. The detailed\nnature of these curves depends on the choice of input param-\neters \u000b and 5, but the conclusions drawn do not. The curve\nfor the \u0001X ,Y ,Z\u0002 projection shows nothing significant at either\n\f=0.6 or \f=5.4, where the transitions occur from the pro-\njection being an embedding to not being an embedding \u00031\u0004.\nIn the range 0.6\u000f\f\u000f5.4 the projected attractor exhibits self\nintersections.\nIf the hypothesis is formulated\u2014this projection is an\nembedding\u2014it is not unreasonable to reject this hypothesis\nwhen the variance around the mean stops hitting the \f axis.\nFor the \u0001X ,Y ,Z\u0002 projection this occurs with \f decreasing at\n\f\u00053.2. One would reject this hypothesis for \f\u000f3.0 and fail\nto reject it for \f\u00054.0. Both conclusions are incorrect.\n0 20 40 60 80 100\nDelay \u03c4\n0\n0.2\n0.4\n0.6\n0.8\nFr\nac\ntio\nn\nFN\nN\nN=2\nN=3\nN=4\nFIG. 1. Fraction of false near neighbors as a function of time\ndelay \u0003 for embedding dimensions N=2,3 ,4.\nLETELLIER, MOROZ, AND GILMORE PHYSICAL REVIEW E 78, 026203 \u00012008\u0002\n026203-4\nFor the \u0001X ,Y ,U\u0002 projection, the FNN ratio variations\nabout the mean never include zero. Once again, if the hy-\npothesis is formulated\u2014this projection is an embedding\u2014\nthe hypothesis would be rejected for all values of \f. It is\nknown from topological analyses that the projection\n\u0001X ,Y ,Z ,U\u0002\u2192 \u0001X ,Y ,U\u0002 is an embedding for all values of \f\n\u000343\u0004.\nThe results are that the FNN test failed to determine con-\nditions under which these projections are embeddings.\nB. Fractal dimension\nFractal dimension tests are usually carried out on time\ndelay embeddings, increasing the dimension of the embed-\nding until changes in the form of the correlation integral\ncurve become small enough. We cannot adopt this strategy\nhere, since we seek to learn when a three dimensional map-\nping is an embedding. As a result, the only quantitative cri-\nterion available to us is to make a judgement based on the\nvalue of the computed fractal dimension. We understand that\nusing fractal dimension as an indicator that an embedding\nhas been achieved is often quite different from the actual\ncomputation of the fractal dimension. Unfortunately, the pos-\nsibility is not open to us to raise dimension until changes in\nthe correlation integral curve become small enough, so we\ncan only base our hypothesis tests on the estimated value of\nthis statistic in the mapping into R3: the fractal dimension\nD2.\nThe correlation integral D2 was computed following stan-\ndard recipes \u000317,18\u0004. All such calculations were done simul-\ntaneously with estimates of the largest Lyapunov exponent,\nas explained in Sec. V below. A plot of the logarithm of the\ncorrelation integral \u0007i,j\u0010(\u000b\u2212 \u0006x\u0001i\u0002\u2212x\u0001j\u0002\u0006) versus the loga-\nrithm of the size \u000b is shown in Fig. 3. All logarithms in this\nwork are computed to base e. The correlation dimension is\nthe slope of the linear part of this plot. All plots of this type\nobtained using the algorithm suggested by Rosenstein et al.\n\u000329\u0004 had a very-well-defined linear region from which it was\neasily possible to obtain a good estimate of D2. This integral\nwas computed for the projection of the attractor at \f=4.0\nfrom the full \u0001X ,Y ,Z ,U\u0002 space into the \u0001X ,Y ,U\u0002 subspace.\nAll such integrals showed a well-defined linear region, which\nwas used to estimate D2.\n1. Fluid model\nEstimates of the correlation dimension for a three-\ndimensional differential-delay vector obtained from the sca-\nlar fluid data are shown in Fig. 4 as a function of the time\ndelay \u0003. For \u0003=0 the mapping is not an embedding and the\nD2 estimate falls below the threshold of 2.0 \u000330\u0004. For \u0003\u00022\nthis estimate is larger than 2.0. Further, the curve shows no\nparticularly strong features to suggest that for certain values\nof the delay \u0003 the mapping is an embedding while for others\nit is not. If we were to formulate the hypothesis test\u2014this\nmapping is an embedding\u2014we would reject this hypothesis\nfor values D2\u000f2.0. On the basis of the results in Fig. 4 we\nwould fail to reject the hypothesis for 2\u000f\u0003\u000f100. This con-\nclusion will be shown to be incorrect below.\n2. Dynamo model\nThe correlation dimensions for the two projections\n\u0001X ,Y ,Z ,U\u0002\u2192 \u0001X ,Y ,Z\u0002 and \u0001X ,Y ,Z ,U\u0002\u2192 \u0001X ,Y ,U\u0002 were\ncomputed as a function of \f. The results are plotted in Fig. 5\nfor the \u0001X ,Y ,Z\u0002 projection and in Fig. 6 for the \u0001X ,Y ,U\u0002\nprojection. The variance observed in these plots is not a\nfunction of changing \f; it is intrinsic, a function of changing\nthe data set. This is discussed further in Sec. VII. In both\n0 1 2 3 4 5 6 7 8\nBifurcation parameter \u03b2\n0\n0.1\n0.2\n0.3\n0.4\n0.5\nFr\nac\ntio\nn\nFa\nls\ne\nN\nN\n(X.Y.Z) then U\n(X.Y.U) then Z\nFIG. 2. \u0001Color online\u0002 Fraction of false near neighbors under the\nprojections to the \u0001X ,Y ,Z\u0002 \u0001dark\u0002 and \u0001X ,Y ,U\u0002 \u0001light\u0002 subspaces.\n-4 -3 -2 -1 0 1 2\nlog\ne\nDistance\n-7\n-6\n-5\n-4\n-3\n-2\n-1\n0\nlo\ng e\nN\nor\nm\nal\niz\ned\nN\num\nbe\nr\nFIG. 3. Logarithm of the correlation integral as a function of the\nlogarithm of the distance \u000b for the three-dimensional projection\n\u0001X ,Y ,Z ,U\u0002\u2192 \u0001X ,Y ,U\u0002 of the dynamo model for \f=4.0.\n0 20 40 60 80 100\nDelay (Time Steps)\n1.9\n2\n2.1\n2.2\n2.3\n2.4\n2.5\nC\nor\nre\nla\ntio\nn\nD\nim\nen\nsi\non\nFIG. 4. Correlation dimension estimate, as a function of time\ndelay, for a three-dimensional differential-delay mapping of x\u0001t\u0002\nfrom the fluid model.\nCOMPARISON OF TESTS FOR EMBEDDINGS PHYSICAL REVIEW E 78, 026203 \u00012008\u0002\n026203-5\ncases the correlation dimension curve D2 shows less variance\nthan the largest Lyapunov exponent curve.\nThere is no special signal in the D2 curve for the \u0001X ,Y ,Z\u0002\nprojection that the mapping is not an embedding in the range\n0.6\u000f\f\u000f5.4.\nThe hypothesis test\u2014the projection is an embedding\u2014\ncan be formulated and treated as described above. In the\n\u0001X ,Y ,Z\u0002 case we reject the hypothesis that there is an em-\nbedding where there actually is one \u0001small \f, large \f\u0002 and\nfail to reject this hypothesis when the projection is not an\nembedding. In the \u0001X ,Y ,U\u0002 case D2 is always less than 2.0,\nbut the mapping is always an embedding. As a result, under\nthis test completely incorrect conclusions are reached.\nV. DYNAMICAL TEST\nThe dynamical test that was carried out involved estimat-\ning the largest Lyapunov exponent \u0001LLE\u0002 as a function of the\nappropriate parameter. The LLE was estimated using an al-\ngorithm proposed by Sato et al. \u000326\u0004 and implemented using\nsuggestions made by Rosenstein et al. \u000329\u0004. A small modifi-\ncation in this algorithm, also proposed in \u000329\u0004, was used to\nestimate the correlation dimensions that are presented above.\nBriefly, we look at discretely sampled time series in three\nvariables \u0001x1 ,x2 ,x3\u0002i, fix i, and search over the entire time\nseries for the nearest neighbor j. Once found, we compute\nthe distance between these two points as they propagate k\nsteps into the future \u0001k up to 2000 steps\u0002. The logarithm of\nthe distance is computed for each k. These measures are\naveraged over the entire data set, i. The \u201clinear portion\u201d of\nthe \bloge\u0001divergence\u0002\t vs k curve is fitted with a straight line,\nand the slope of this fit, divided by dt, is an estimate of the\nlargest Lyapunov exponent. Our implementation of this algo-\nrithm was verified by reproducing Fig. 2 in \u000329\u0004. That curve\nhas more than one \u201clinear portion,\u201d and each such portion is\nfar from linear. A straight line of the form y=a+bx was fitted\nto various parts of that curve using a moving average win-\ndow and sliding center. By choosing an appropriate part of\nthe curve it was possible to reproduce their estimate of 1.50\nfor the largest Lyapunov exponent of the Lorenz attractor at\nparticular parameter values using windows of various half-\nwidths from 5 to 100. However, other parts of the curve and\nother window widths provided estimates ranging from about\n3 down to almost zero.\nPlots of \bloge\u0001divergence\u0002\t vs k for three-dimensional pro-\njections of the dynamo data always had two, sometimes\nthree, and occasionally four \u201clinear portion\u201d regions, and\neach region usually had small fluctuations. One such curve is\nshown in Fig. 7. This curve was computed simultaneously\nwith the curve shown in Fig. 3. These results are typical of\nthe dynamo data: the correlation integral curves usually\nshowed a single linear region while the \bloge\u0001divergence\u0002\t\ncurves had several.\nThe corresponding \bloge\u0001divergence\u0002\t curves for the fluid\ndata were remarkably different. One such curve is shown\nin Fig. 8. This curve has no locally linear regions under\nthe most optimistic assumptions. Estimates of the\n\bloge\u0001divergence\u0002\t curves were made by smoothing over\nlong intervals. We do not regard such estimates as very sig-\nnificant.\nWe do not know of any hypothesis test on whether a\nmapping is an embedding that is reasonable to formulate\n0 1 2 3 4 5 6 7 8\nBifurcation parameter \u03b2\n-0.5\n0\n0.5\n1\n1.5\n2\n2.5\n3\n\u03bb m\nax\n(s\n-1\n).\nD\n2\nes\ntim\nat\nes\n\u03bb\nmax\nD\n2\nFIG. 5. \u0001Color online\u0002 Estimates of the fractal dimension D2\n\u0001top curve\u0002 and the LLE \u0001bottom curve\u0002 for the \u0001X ,Y ,Z\u0002 projection\nof the dynamo model.\n0 1 2 3 4 5 6 7 8\nBifurcation parameter \u03b2\n0\n1\n2\n3\n\u03bb m\nax\n(s\n-1\n).\nD\n2\nes\ntim\nat\nes\n\u03bb\nmax\nD\n2\nFIG. 6. \u0001Color online\u0002 Estimates of the fractal dimension D2\n\u0001top curve\u0002 and the LLE \u0001bottom curve\u0002 for the \u0001X ,Y ,U\u0002 projection\nof the dynamo model.\n0 100 200 300 400 500 600\nForward Time Steps\n-4\n-3\n-2\n-1\n<\nlo\ng e\n(d\niv\ner\nge\nnc\ne)\n>\nFIG. 7. Estimate of the logarithm of the divergence as a function\nof the number of forward time steps for the projection\n\u0001X ,Y ,Z ,U\u0002\u2192 \u0001X ,Y ,U\u0002 of the dynamo model at \f=4.0. The largest\nLyapunov exponent is to be estimated from the slope of the \u201clocally\nlinear\u201d region. This curve was computed simultaneously with the\ncurve shown in Fig. 3, which has a single linear region.\nLETELLIER, MOROZ, AND GILMORE PHYSICAL REVIEW E 78, 026203 \u00012008\u0002\n026203-6\nusing the largest Lyapunov exponent as a quantitative mea-\nsure.\nA. Fluid model\nWe estimated \bloge\u0001divergence\u0002\t as a function of the num-\nber of forward time steps for time delays 1\u000e\u0003\u000e100. Each\nof these curves resembled that shown in Fig. 8. We felt it was\nmeaningless to try to estimate the LLE from such data. Nev-\nertheless, we fixed a range of forward time steps \u0001300\u000ek\n\u000e500\u0002 and used this range to fit a straight line y=a+bx and\nextract the slope m. The result is shown in Fig. 9. There are\nno clear signatures in this curve that the mapping is an em-\nbedding for certain values of the delay and not for others.\nB. Dynamo model\nWe computed the largest Lyapunov exponents for both the\n\u0001X ,Y ,Z\u0002 and \u0001X ,Y ,U\u0002 projections for all values of \f in the\ninterval \u00030, 7.8\u0004 with \u0011\f=0.01. An interval was chosen \u0001dif-\nferent for the two embeddings\u0002 where all plots seemed to\nhave a linear region. The results are shown in Figs. 5 and 6.\nIn both cases the LLE is the lower curve with the larger\nvariance. Neither curve shows any remarkable behavior that\nwould distinguish between a projection that is an embedding\nand one that is not.\nVI. TOPOLOGICAL TESTS\nThe topological test depends on finding and using the un-\nstable periodic orbits in the chaotic data set. Such orbits can\nbe identified in scalar time series even before an embedding\ninto R3 is attempted \u00037,11,12\u0004. The topological test for em-\nbedding looks for stability of the linking numbers between\nall pairs of unstable periodic orbits. Even more simply, it\nlooks for intersections of such orbits or even intersections of\nan orbit with itself. Intersection of two orbits is identified by\ncomputing the minimum Euclidean distance between two or-\nbits and plotting this distance as a function of the mapping\nparameter. Intersections appear as a V-shaped almost inter-\nsection of the minimum distance curve with the mapping\nparameter axis. In regions where zero crossings occur and\nlinking numbers of unstable periodic orbits change, the map-\nping cannot be an embedding.\nA. Fluid model\nThe topological test for embedding of data from the fluid\nmodel was simplified as follows. The lowest-period orbit in\nthe attractor was located before any embedding was made.\nIts projection into the x-x\u02d9 plane is independent of \u0003 and is\nshown in Fig. 10. This orbit is \u201cin the attractor,\u201d so is sur-\nrounded by a tube \u0001a torus\u0002 that contains the attractor. If this\norbit undergoes a self-intersection for \u0003=\u00031, the tube, and the\nattractor it contains, undergo self-intersections in an interval\ncontaining \u00031. The mapping cannot be an embedding in this\ninterval of parameter values.\nThe projection of this curve onto the x1-x2 plane is shown\nin Fig. 10. There are four crossing points in this projection.\nAt each crossing point the first two coordinates of each of the\ntwo segments that cross are equal. If the third coordinates are\nalso equal, the curve has a self-intersection at that point.\nThe difference between the third coordinates of the two\nsegments is shown in Fig. 11. The difference in the x3 coor-\ndinates at each of the four crossing points a-d in the x-x\u02d9\nprojection is shown in Fig. 11 as a function of \u0003\n=T1\u0001j \/1024\u0002, where T1 is the period of this orbit. When this\ndistance is zero the orbit has a self-intersection and the map-\nping cannot be an embedding. We have computed topologi-\ncal invariants for periodic orbits in this attractor and their\nchanges from one embedding interval to another. In each\ninstance the change in global torsion \u000311,12\u0004 is \u0011GT=\u00042.\nThis is consistent with a change in the extrinsic embedding\n0 100 200 300 400 500 600\nForward Time Steps\n-4\n-3.5\n-3\n-2.5\n-2\n-1.5\n-1\n<\nlo\ng e\n(d\niv\ner\nge\nnc\ne)\n>\nFIG. 8. Estimate of the logarithm of the divergence as a function\nof the number of forward time steps for the fluid data. The largest\nLyapunov exponent is to be estimated from the slope of the \u201clocally\nlinear\u201d region.\n0 20 40 60 80 100\nDelay (Time Steps)\n-0.004\n-0.002\n0\n0.002\n0.004\n\u03bb m\nax\n(s\n-1\n)\nFIG. 9. Estimate of the LLE for differential-delay mapping of\nthe scalar time series x\u0001t\u0002 from the fluid model as a function of\ndelay \u0003.\nFIG. 10. Projection of the lowest period orbit onto the x-x\u02d9 plane\nis independent of the time delay \u0003 in the mixed differential-delay\nmapping. There are four crossing points in this projection.\nCOMPARISON OF TESTS FOR EMBEDDINGS PHYSICAL REVIEW E 78, 026203 \u00012008\u0002\n026203-7\ncaused by a self-intersection of the chaotic attractor \u0001cf, Ref.\n\u000342\u0004, Fig. 9\u0002.\nB. Dynamo model\nWe used topological tests to determine whether the pro-\njections of the attractor generated by Eq. \u00012\u0002 from R4 into R3\ngiven by \u0001X ,Y ,Z ,U\u0002\u2192 \u0001X ,Y ,Z\u0002 and \u0001X ,Y ,Z ,U\u0002\n\u2192 \u0001X ,Y ,U\u0002 are in fact embeddings. We did this by extracting\nperiodic orbits from the chaotic time series in R4 by the\nmethod of close returns \u000334,47\u0004. A set of these orbits was\nfollowed adiabatically as the parameter \f varied through the\nrange 0\u000e\f\u000f7.9. The minimum distance and the linking\nnumbers between all pairs of orbits were determined as a\nfunction of \f for each of the two projections.\nIn Fig. 12 we show the minimum distances between two\nunstable periodic orbits over a limited range of \f values,\n0.25\u000e\f\u000e1.5. These three minimum distances were com-\nputed in the full space \u0001X ,Y ,Z ,U\u0002 and in the two three-\ndimensional subspaces \u0001X ,Y ,Z\u0002 and \u0001X ,Y ,U\u0002.\nIn the four-dimensional space the minimum distance is\nsmooth, varying between 1.25 and 1.5. This is expected and\nconsistent with a theorem that curves in spaces of dimension\ngreater than 3 do not intersect \u000312\u0004.\nIn the three-dimensional space \u0001X ,Y ,U\u0002 the minimum\ndistances are also bounded away from zero. In fact, in this\nprojection the minimum distance between any pair of the\norbits we followed was bounded away from zero for all val-\nues of \f. This shows that all the periodic orbits we studied\nhave unchanging topological organization for all values of \f.\nThis allows us to conclude that the chaotic attractor under-\ngoes no self-intersections in this projection, so that this pro-\njection is compatible with an embedding.\nThe situation is quite different for the projection\n\u0001X ,Y ,Z ,U\u0002\u2192 \u0001X ,Y ,Z\u0002. The minimum distance function\ndives steeply to zero approaching \f\u00050.85 and rapidly in-\ncreases from zero above 0.85. The zero crossing is elegantly\nestimated by reflecting either of these linear sections in the\nhorizontal axis and connecting the dots. The failure to reach\nzero is a resolution problem. The confirmation of a zero\ncrossing is made by computing the linking numbers of these\ntwo orbits on either side of the crossing. The linking num-\nbers differ by one, so the crossing is real. These two orbits\nexhibit many other zero crossings in the range not shown in\nthis figure \u00011.5\u000f\f\u000f5.4\u0002. Other orbits exhibit zero crossings\nin the range 0.6\u000f\f\u000f5.4. From this we conclude that in the\nrange 0.6\u000f\f\u000f5.4 the strange attractor undergoes a self-\nintersection, forcing the orbits in it to exhibit many intersec-\ntions. Outside this range there are no zero crossings, self-\nintersections no longer occur, and the projection is\ncompatible with an embedding.\nThese results allow us to reject the hypothesis that the\nprojection \u0001X ,Y ,Z ,U\u0002\u2192 \u0001X ,Y ,Z\u0002 is an embedding in the in-\nterval 0.6\u000e\f\u000e5.4. We cannot reject the hypothesis that the\nprojection \u0001X ,Y ,Z ,U\u0002\u2192 \u0001X ,Y ,U\u0002 is an embedding through-\nout the entire range 0.0\u000e\f\u000e7.9. Neither can we reject the\nhypothesis that the projection \u0001X ,Y ,Z ,U\u0002\u2192 \u0001X ,Y ,Z\u0002 is an\nembedding outside the interval 0.6\u000e\f\u000e5.4.\nWhere we could not rule out the hypothesis that the map-\nping is an embedding, it was subsequently determined to be\nan embedding by carrying out a topological analysis \u000311,12\u0004\non the periodic orbits and identifying a branched manifold\nwhich reproduced all linking numbers and correctly pre-\ndicted additional linking numbers \u000343\u0004.\nVII. STATISTICAL TESTS\nFluctuations in the values of the estimates of the LLE and\nD2 in Figs. 5 and 6 are not due to changing the value of \f.\nThey vary with the data set used. The LLE and D2 were\ncomputed for data sets in the three variables \u0001X ,Y ,Z\u0002 of\nlength 5000 with \f=4.0. This was repeated 1001 times. The\nresults are shown in Fig. 13. The variance around the D2\nestimate is tighter than around the LLE estimate. This possi-\nbly reflects the fact that curves used to determine D2 always\nhad one well-defined locally linear section, while those used\nfor LLE estimates never did.\nThe mean and variance were computed for each of the\ntwo data sets shown in Fig. 13. Each data set was scaled in\n0 128 256 384 512 640 768 896 1024\nDelay\n-1.5\n-1\n-0.5\n0\n0.5\n1\n1.5\nV\ner\ntic\nal\nD\nis\nta\nnc\ne\na\nb\nc\nd\nFIG. 11. The difference between the coordinates x3 of the two\nsegments that cross, at each of the four crossing points, is shown,\nplotted as a function of the time delay \u0003. When this difference is\nzero the orbit has a self-intersection and the mapping fails to be an\nembedding in a region around the intersection point.\n0 0.25 0.5 0.75 1 1.25 1.5 1.75\nBifurcation parameter \u03b2\n0\n0.25\n0.5\n0.75\n1\n1.25\n1.5\n1.75\nM\nin\nim\num\ndi\nst\nan\nce\ns\n\u2206\n(X.Y.Z)\n\u2206\n(X.Y.U)\n\u2206\n(X.Y.Z.U)\nFIG. 12. Minimum distance between two orbits as a function of\n\f in the chaotic attractor in R4 and under two projections\ninto three-dimensional spaces. Parameter values: \u0001R ,\u0006 ,\b ,\r\u0002\n= \u000174.667,10,8 \/3,3.2\u0002.\nLETELLIER, MOROZ, AND GILMORE PHYSICAL REVIEW E 78, 026203 \u00012008\u0002\n026203-8\nthe usual way, removing the mean and dividing the differ-\nence by the standard deviation. The results are binned in\nboxes of width 0.1. The result is shown in Fig. 14. To test\nGaussianity we did a \u00122 test on these two distributions\nagainst a null hypothesis of normality. We found for the D2\nand LLE estimates values of 0.75 and 3.17 per degree of\nfreedom. We fail to reject normally distributed fluctuations in\nthe case of correlation dimension estimates and soundly re-\nject it for LLE estimates.\nVIII. SENSITIVITY OF TESTS\nFigure 15 shows a simple \u201ccardboard model\u201d representa-\ntion of the geometric structure created by the projection\n\u0001X ,Y ,Z ,U\u0002\u2192 \u0001X ,Y ,Z\u0002 for \f=3.8 when it is not an embed-\nding. The dark line indicates the region in the \u0001X ,Y ,Z\u0002 space\nwhere the two lobes of the attractor undergo self-\nintersection. This set has dimension not greater than 2\n\u00132.2\u22123\u00051.4 \u000348\u0004. This estimate comes from genericity ar-\nguments. If two manifolds of dimension p and q are embed-\nded in RN and intersect, they intersect in a manifold of di-\nmension p+q\u2212N\u00020. For this self-intersecting chaotic\nattractor in R4, p=q\u00052.2, and this is an upper bound on the\ndimension when the attractor is projected into R3. Therefore,\nits self-intersection in R3 has dimension not greater than 1.4,\nand its measure in R3 is therefore zero. This is the region\nresponsible for failure to embed.\nGeometric and dynamical tests for embedding involve av-\neraging some real statistic over the entire mapped attractor.\nThat is, they depend upon picking up a signal from a mea-\nsure zero set. This small signal could easily be obscured by\nchoice of threshold parameters for these two classes of tests.\nOn the other hand, there is no way to misinterpret the zero-\ncrossing signatures of the type shown in Fig. 12.\nIX. PARAMETERS\nFalse near neighbor tests depend on three parameters. One\n\u0001\u000b\u0002 is used to determine neighbors; a second \u00015 in the case\ndescribed above\u0002 is used to distinguish between true and\nfalse neighbors. The third is a threshold parameter that is\nused to determine when the fraction of FNN is sufficiently\nsmall so that the mapping can be declared an embedding.\nCorrelation dimension estimates use two parameters.\nThese are lengths: they determine the two ends of the inter-\nval over which a linear curve y=mx+b is fit to estimate a\nslope.\nLargest Lyapunov exponent estimates use four input pa-\nrameters. Two are size estimates. These are sphere radii that\nare used to determine if points i and j are neighbors. The\nother two define end points of the forward time interval for\nwhich a linear curve y=mx+b is fit in order to estimate the\nLLE.\nTopological tests depend on one parameter. This is a\nlength, used to determine when two points x\u0001i\u0002 and x\u0001j\u0002 are\nclose enough to be considered points on the same unstable\nperiodic orbit, with j= i+ p, where p is related to the period\nof the orbit and the time step size dt.\nIn terms of numbers of input parameters required for\nthese types of tests for embeddings, the topological test is the\nmost frugal.\n0 200 400 600 800 1000\nRun Number\n0\n0.5\n1\n1.5\n2\n2.5\n3\n\u03bb m\nax\n(s\n-1\n).\nD\n2\nes\ntim\nat\nes\n\u03bb\nmax\nD\n2\nFIG. 13. \u0001Color online\u0002 Estimates of LLE \u0001bottom curve\u0002 and D2\nover 1001 projections into \u0001X ,Y ,Z\u0002 with \f fixed at 4.0.\n-30 -25 -20 -15 -10 -5 0 5 10 15 20 25 30\n10 \u03c3\n0\n10\n20\n30\n40\n50\n60\nN\num\nbe\nr\nof\nev\nen\nts\nGaussian\nD\n2\nestimate\n\u03bb\nmax\nestimate\nFIG. 14. Comparison of the suitably normalized statistical dis-\ntribution of the LLE and D2 estimates with the Gaussian normal\ndistribution.\nSelf\u2212intersections\nFIG. 15. Cardboard model of the self-intersection of the projec-\ntion of the chaotic attractor into the \u0001X ,Y ,Z\u0002 subspace for 0.6\u000f\f\n\u000f5.4.\nCOMPARISON OF TESTS FOR EMBEDDINGS PHYSICAL REVIEW E 78, 026203 \u00012008\u0002\n026203-9\nX. COMPUTATIONAL LOAD\nTypical scalar data sets consist of N points that sample\nabout np periods with about spp points per period, so that\nN\u0005np\u0013spp.\nAn estimate of the largest Lyapunov exponent requires\nsearching for nearest neighbors. This is asymmetric: if j is a\nnearest neighbor of i, i is not generally a nearest neighbor of\nj. This requires searching over all point pairs 1\u000e i\u0001 j\u000eN,\nwith a computational load of N\u0001N\u22121\u0002.\nThe FNN and D2 estimates involve computing distances,\nwhich are symmetric in i and j. The search is over 1\u000e i\u000f j\n\u000eN, with a computational load of 12N\u0001N\u22121\u0002.\nThe number of point pairs in each search can be reduced\nslightly by blocking out dynamically correlated points:\n\u0006i\u2212 j\u0006\u000fq, where q is conveniently taken as about spp \/4.\nTopological tests involve close returns searches for un-\nstable periodic orbits. The search is symmetric in i and j.\nAssuming orbits of period up to 6 are sufficient, the search is\nover i+ 12spp\u000f j\u000f \u00016+ 12 \u0002spp, with a computational load of\nabout \u0001N\u22126spp\u0002\u00136spp. The term quadratic in spp is due to\nsample-size edge effects.\nNo matter the sample size, FNN and D2 estimates require\nabout half the computational effort as LLE estimates. Peri-\nodic orbit searches require about 6 \/np of the computational\neffort. Useful data sets typically have np\u0005100, spp\u0005100.\nFor such data sets the topological approach requires about\n6% of the computational search effort as LLE estimates.\nThe classical tests involve symmetric or asymmetric \u0001in\nthe indices i and j\u0002 searches over all point pairs followed by\nsome post-search processing and averaging. Decisions are\nmade by introducing some sort of threshold and deciding\nwhether the average reaches this threshold. The average var-\nies from data set to data set \u0001cf. Fig. 13\u0002 and there is no\nstatistical theory to go with any of this \u0001cf. Grassberger and\nProcaccia \u000319\u0004\u0002, despite our findings \u0001cf. Fig. 14\u0002.\nBy contrast, the topological test involves a symmetric\nsearch over all point pairs followed by extraction of specific\nsmall subsets of points belonging to structures that are in-\nvariant from one data set to another \u0001periodic orbits\u0002. There\nis no averaging. What can differ from one data set to another\nis how close the minimum gets to zero \u0001cf. Fig. 12\u0002, but not\nthe shape of the minimum distance curve or the conclusion\nof whether a zero crossing occurs or not.\nXI. NOISE\nThe deleterious effect of noise on estimates of fractal di-\nmensions and Lyapunov exponents has been extensively\ndocumented \u000349,50\u0004. In view of the failure of both types of\ntests to predict correctly when a mapping was an embedding,\nit was not deemed necessary to determine how much worse\nthey behaved by adding noise to our two test data sets.\nTopological tests and analyses are robust and degrade\ngracefully with respect to noise \u00037,11,12\u0004. The very first stud-\nies of the effects of noise on this test were carried out on\nexperimental data \u00037,52\u0004. It has been well documented that\nthe ability to extract unstable periodic orbits from data de-\ncreases as the signal-to-noise level decreases, but the most\nsusceptible orbits, the first orbits masked by increasing noise\nlevel, are typically the highest period orbits. As the analysis\ndepends more heavily on the lower period orbits, noise is far\nless inimical to topological analyses than to geometric or\ndynamical analyses. In this sense, in the domain of topologi-\ncal analysis, \u201cMurphy takes a vacation\u201d \u00037,11,12\u0004.\nIt can also be argued that estimates of minimum distances\n\u0001cf. Fig. 12\u0002 or linking numbers are corrupted by noise.\nNoisy periodic orbits are closed orbits. This allows a Fourier\nrepresentation for each periodic orbit both to force closure as\nwell as filter noise by projecting higher-frequency compo-\nnents to zero \u00031\u0004. The Fourier representations of orbits can be\nused in place of the noisy orbits for the minimum distance\nand linking number calculations. Fourier representations are\nnot available in the same way for geometric or topological\nanalyses since the trajectories being analyzed there are cha-\notic, not periodic.\nFinally, dimension estimates are impossible, and\nLyapunov exponent estimates are impractical, for nonstation-\nary data. Successful topological analyses have already been\ncarried out for nonstationary experimental data \u000351\u0004.\nXII. CONCLUSIONS\nThe two classical types of tests for whether a mapping is\nan embedding, depending on geometric and dynamical mea-\nsures, have recently been joined by a third type, depending\non topological measures \u00031\u0004. The latter test is only applicable\nto three dimensions, while the classical tests do not have\nsuch a limitation. However, most claims of embeddings into\nhigher-dimensional spaces stop there: there is little post-\nembedding self-consistency checking. In three dimensions a\nsuccessful embedding is the beginning of a more detailed\nanalysis stage in which it is possible to determine the mecha-\nnism responsible for generating chaotic data \u000337,38\u0004.\nFor this reason alone it is useful to compare the reliability,\nsimplicity, and robustness of these three different types of\ntests where they can be compared: on three-dimensional at-\ntractors. We have done so in this work. We find that the\nclassical tests are often unable to suggest when mapping pa-\nrameter values provide an embedding and when they do not;\nwhen they have been able to suggest values, they have been\nwrong in every instance studied here. This result calls into\nquestion the reliability of results of the traditional methods in\nhigher dimensions where topological methods do not yet ex-\nist to reject or fail to reject the results of traditional tests.\nACKNOWLEDGMENT\nR.G. thanks Centre National de la Recherche Scientifique\n\u0001CNRS\u0002 for support at COmplexe de Recherche Interprofes-\nsionnel en A\u00e9rothermochimie \u0001CORIA\u0002 for 2006\u20132007.\nLETELLIER, MOROZ, AND GILMORE PHYSICAL REVIEW E 78, 026203 \u00012008\u0002\n026203-10\n\u00031\u0004 C. Letellier, I. M. Moroz, and R. Gilmore \u0001unpublished\u0002.\n\u00032\u0004 F. Takens, in Proceedings of the Symposium on Dynamical\nSystems and Turbulence, Warwick, 1979\u20131980, edited by D.\nRand and L. S. Young, Lecture Notes in Mathematics Vol. 898\n\u0001Springer-Verlag, Berlin, 1981\u0002, p. 366.\n\u00033\u0004 R. Ma\u00f1\u00e9, in Proceedings of the Symposium on Dynamical Sys-\ntems and Turbulence, Warwick, 1979\u20131980, edited by D. Rand\nand L. S. Young, Lecture Notes in Mathematics Vol. 898\n\u0001Springer-Verlag, Berlin, 1981\u0002, p. 230.\n\u00034\u0004 N. H. Packard, J. P. Crutchfield, J. D. Farmer, and R. S. Shaw,\nPhys. Rev. Lett. 45, 712 \u00011980\u0002.\n\u00035\u0004 J.-P. Eckmann and D. Ruelle, Rev. Mod. Phys. 57, 617 \u00011985\u0002.\n\u00036\u0004 E. Ott, Rev. Mod. Phys. 53, 655 \u00011981\u0002.\n\u00037\u0004 G. B. Mindlin, H. G. Solari, M. A. Natiello, X.-J. Hou, and R.\nGilmore, J. Nonlinear Sci. 1, 147 \u00011991\u0002.\n\u00038\u0004 H. D. I. Abarbanel, R. Brown, J. J. Sidorowich, and L. Tsim-\nring, Rev. Mod. Phys. 65, 1331 \u00011993\u0002.\n\u00039\u0004 H. D. I. Abarbanel, Analysis of Observed Chaotic Data\n\u0001Springer, New York, 1996\u0002.\n\u000310\u0004 H. Kantz and T. Schreiber, Nonlinear Time Series Analysis\n\u0001Cambridge University Press, Cambridge, England, 1997\u0002.\n\u000311\u0004 R. Gilmore, Rev. Mod. Phys. 70, 1455 \u00011998\u0002.\n\u000312\u0004 R. Gilmore and M. Lefranc, The Topology of Chaos \u0001John\nWiley & Sons, New York, 2002\u0002.\n\u000313\u0004 M. P. Chauve and P. LeGal, Physica D 58, 407 \u00011992\u0002.\n\u000314\u0004 B. Saltzman, J. Atmos. Sci. 19, 329 \u00011962\u0002.\n\u000315\u0004 E. N. Lorenz, J. Atmos. Sci. 20, 130 \u00011963\u0002.\n\u000316\u0004 P. Grassberger, Phys. Lett. 97, 227 \u00011983\u0002.\n\u000317\u0004 P. Grassberger and I. Procaccia, Phys. Rev. A 28, 2591 \u00011983\u0002.\n\u000318\u0004 P. Grassberger, Phys. Lett. 97A \u00016\u0002, 227 \u00011983\u0002.\n\u000319\u0004 P. Grassberger and I. Procaccia, Phys. Rev. Lett. 50, 346\n\u00011983\u0002.\n\u000320\u0004 D. Ruelle, Proc. R. Soc. London, Ser. A 427, 241 \u00011990\u0002.\n\u000321\u0004 M. Lefranc, D. Hennequin, and P. Glorieux, Phys. Lett. A 163,\n269 \u00011992\u0002.\n\u000322\u0004 M. B. Kennel, R. Brown, and H. D. I. Abarbanel, Phys. Rev. A\n45, 3403 \u00011992\u0002.\n\u000323\u0004 G. Sugihara and R. M. May, Nature \u0001London\u0002 344, 734\n\u00011990\u0002.\n\u000324\u0004 D. T. Kaplan and L. Glass, Phys. Rev. Lett. 68, 427 \u00011992\u0002.\n\u000325\u0004 A. Wolf, J. B. Swift, H. L. Swinney, and J. A. Vastano, Physica\nD 16, 285 \u00011985\u0002.\n\u000326\u0004 S. Sato, M. Sano, and Y. Sawada, Prog. Theor. Phys. 77, 117\n\u00011987\u0002.\n\u000327\u0004 J. D. Farmer and J. J. Sidorowich, Phys. Rev. Lett. 59, 845\n\u00011987\u0002.\n\u000328\u0004 R. Stoop and J. Parisi, Physica D 50, 89 \u00011991\u0002.\n\u000329\u0004 M. T. Rosenstein, J. J. Collins, and C. J. De Luca, Physica D\n65, 117 \u00011993\u0002.\n\u000330\u0004 J. Kaplan and J. A. Yorke, in Functional Differential Equations\nand Approximations of Fixed Points, edited by H.-O. Peitgen\nand H.-O. Walther, Lecture Notes in Mathematics Vol. 730\n\u0001Springer, Berlin, 1979\u0002, pp. 228\u2013237.\n\u000331\u0004 J.-P. Eckmann, S. O. Kamphorst, D. Ruelle, and S. Ciliberto,\nPhys. Rev. A 34, 4971 \u00011986\u0002.\n\u000332\u0004 U. Parlitz, Int. J. Bifurcation Chaos Appl. Sci. Eng. 2, 155\n\u00011992\u0002.\n\u000333\u0004 H. G. Solari and R. Gilmore, Phys. Rev. A 37, 3096 \u00011988\u0002.\n\u000334\u0004 D. Auerbach, P. Cvitanovic, J.-P. Eckmann, G. Gunaratne, and\nI. Procaccia, Phys. Rev. Lett. 58, 2387 \u00011987\u0002.\n\u000335\u0004 H. Whitney, Ann. Math. 37, 645 \u00011936\u0002.\n\u000336\u0004 T. Sauer, M. Casdagli, and J. A. Yorke, J. Stat. Phys. 65, 579\n\u00011991\u0002.\n\u000337\u0004 N. Romanazzi, M. Lefranc, and R. Gilmore, Phys. Rev. E 75,\n066214 \u00012007\u0002.\n\u000338\u0004 R. Gilmore, C. Letellier, and N. Romanazzi, J. Phys. A 40,\n13291 \u00012007\u0002.\n\u000339\u0004 T. Ondar\u00e7uhu, G. B. Mindlin, H. L. Mancini, and C. P\u00e9rez\nGarcia, Phys. Rev. Lett. 70, 3892 \u00011993\u0002.\n\u000340\u0004 G. B. Mindlin and H. G. Solari, Phys. Rev. E 52, 1497 \u00011995\u0002.\n\u000341\u0004 M. Huerta, D. Krmpotic, G. B. Mindlin, H. Mancini, D.\nMazza, and C. Perez-Garcia, Physica D 96, 200 \u00011996\u0002.\n\u000342\u0004 T. D. Tsankov, A. Nishtala, and R. Gilmore, Phys. Rev. E 69,\n056215 \u00012004\u0002.\n\u000343\u0004 I. M. Moroz, C. Letellier, and R. Gilmore, Phys. Rev. E 75,\n046201 \u00012007\u0002.\n\u000344\u0004 K. A. Robbins, Math. Proc. Cambridge Philos. Soc. 82, 309\n\u00011977\u0002.\n\u000345\u0004 I. M. Moroz, Int. J. Bifurcation Chaos Appl. Sci. Eng. 13, 147\n\u00012003\u0002.\n\u000346\u0004 I. M. Moroz, Nonlinear Dyn. 41, 191 \u00012005\u0002.\n\u000347\u0004 J.-P. Eckmann, S. O. Kamphorst, and D. Ruelle, Europhys.\nLett. 5, 973 \u00011987\u0002.\n\u000348\u0004 R. Gilmore, Catastrophe Theory for Scientists and Engineers,\n\u0001Wiley, New York, 1981\u0002.\n\u000349\u0004 P. Bryant, R. Brown, and H. D. I. Abarbanel, Phys. Rev. Lett.\n65, 1523 \u00011990\u0002.\n\u000350\u0004 X. Zeng, R. A. Pielke, and R. Eykholt, J. Atmos. Sci. 44, 649\n\u00011992\u0002.\n\u000351\u0004 A. Amon and M. Lefranc, Phys. Rev. Lett. 92, 094101 \u00012004\u0002.\n\u000352\u0004 G. B. Mindlin and R. Gilmore, Physica D 58, 229 \u00011992\u0002.\nCOMPARISON OF TESTS FOR EMBEDDINGS PHYSICAL REVIEW E 78, 026203 \u00012008\u0002\n026203-11\n"}