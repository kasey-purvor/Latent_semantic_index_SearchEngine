{"doi":"10.1021\/pr800917p","coreId":"19177","oai":"oai:eprints.bham.ac.uk:339","identifiers":["oai:eprints.bham.ac.uk:339","10.1021\/pr800917p"],"title":"SLoMo: automated site localization of modifications from ETD\/ECD Mass Spectra","authors":["Bailey, Christopher M","Sweet, Steve M. M.","Cunningham, Debbie L.","Zeller, Martin","Heath, John K","Cooper, Helen J."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2009","abstract":"Recently, software has become available to automate localization of phosphorylation sites from CID data and to assign associated confidence scores. We present an algorithm, SLoMo (Site Localization of Modifications), which extends this capability to ETD\/ECD mass spectra. Furthermore, SLoMo caters for both high and low resolution data and allows for site-localization of any UniMod post-translational modification. SLoMo accepts input data from a variety of formats (e.g., Sequest, OMSSA). We validate SLoMo with high and low resolution ETD, ECD, and CID dat","downloadUrl":"","fullTextIdentifier":null,"pdfHashValue":null,"publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.bham.ac.uk:339<\/identifier><datestamp>\n      2011-12-20T10:51:01Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D51:5152<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        SLoMo: automated site localization of modifications from ETD\/ECD Mass Spectra<\/dc:title><dc:creator>\n        Bailey, Christopher M<\/dc:creator><dc:creator>\n        Sweet, Steve M. M.<\/dc:creator><dc:creator>\n        Cunningham, Debbie L.<\/dc:creator><dc:creator>\n        Zeller, Martin<\/dc:creator><dc:creator>\n        Heath, John K<\/dc:creator><dc:creator>\n        Cooper, Helen J.<\/dc:creator><dc:subject>\n        QR Microbiology<\/dc:subject><dc:description>\n        Recently, software has become available to automate localization of phosphorylation sites from CID data and to assign associated confidence scores. We present an algorithm, SLoMo (Site Localization of Modifications), which extends this capability to ETD\/ECD mass spectra. Furthermore, SLoMo caters for both high and low resolution data and allows for site-localization of any UniMod post-translational modification. SLoMo accepts input data from a variety of formats (e.g., Sequest, OMSSA). We validate SLoMo with high and low resolution ETD, ECD, and CID data<\/dc:description><dc:date>\n        2009<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/eprints.bham.ac.uk\/339\/1\/cooper_ACS2009.pdf<\/dc:identifier><dc:relation>\n        public<\/dc:relation><dc:relation>\n        http:\/\/eprints.bham.ac.uk\/339\/1.hassmallThumbnailVersion\/cooper_ACS2009.pdf<\/dc:relation><dc:relation>\n        http:\/\/dx.doi.org\/10.1021\/pr800917p<\/dc:relation><dc:identifier>\n        Bailey, Christopher M and Sweet, Steve M. M. and Cunningham, Debbie L. and Zeller, Martin and Heath, John K and Cooper, Helen J. (2009) SLoMo: automated site localization of modifications from ETD\/ECD Mass Spectra. Journal of Proteome Research, 8 (4). p. 1965. ISSN 1535-3893<\/dc:identifier><dc:relation>\n        http:\/\/eprints.bham.ac.uk\/339\/<\/dc:relation><dc:language>\n        English<\/dc:language><dc:contributor.sponsor>\n        Wellcome Trust<\/dc:contributor.sponsor><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["public","http:\/\/eprints.bham.ac.uk\/339\/1.hassmallThumbnailVersion\/cooper_ACS2009.pdf","http:\/\/dx.doi.org\/10.1021\/pr800917p","http:\/\/eprints.bham.ac.uk\/339\/"],"year":2009,"topics":["QR Microbiology"],"subject":["Article","PeerReviewed"],"fullText":"SLoMo: Automated Site Localization of Modifications from ETD\/ECD\nMass Spectra\nChristopher M. Bailey,\u2020,\u2021 Steve M. M. Sweet,\u2020,\u2021 Debbie L. Cunningham,\u2020,\u2021 Martin Zeller,\u00a7\nJohn K. Heath,\u2020,\u2021 and Helen J. Cooper*,\u2021\nSchool of Biosciences, University of Birmingham, Edgbaston, Birmingham, B15 2TT, United Kingdom, and\nThermo Fisher Scientific, Hanna-Kunath-Str.11, 28199, Bremen, Germany\nReceived October 29, 2008\nRecently, software has become available to automate localization of phosphorylation sites from CID\ndata and to assign associated confidence scores. We present an algorithm, SLoMo (Site Localization\nof Modifications), which extends this capability to ETD\/ECD mass spectra. Furthermore, SLoMo caters\nfor both high and low resolution data and allows for site-localization of any UniMod post-translational\nmodification. SLoMo accepts input data from a variety of formats (e.g., Sequest, OMSSA). We validate\nSLoMo with high and low resolution ETD, ECD, and CID data.\nKeywords: phosphorylation \u2022 phosphopeptide \u2022 phosphoproteomics \u2022 site localization \u2022 Ascore \u2022 mass\nspectrometry \u2022 post-translational modifications \u2022 bioinformatics\nIntroduction\nLarge-scale mass spectrometric identification of phospho-\npeptides and phosphoproteins, termed phosphoproteomics,\nhas now become routine.1-5 Until recently these analyses relied\nheavily on manual validation to confirm correct site localiza-\ntion.6 This approach is both time-consuming and labor inten-\nsive, making it impractical for large data sets. To reduce the\nrequirement for manual analysis, algorithms have been devel-\noped to automate site localization.6-9 These approaches use\nstatistical models for assessing site localization, and can be used\nfor computational analysis of large data sets in a short period\nof time. The algorithm takes the peptide sequence identified\nfrom a database search, compiles a list of all possible phos-\nphorylation sites (or combinations of sites), and from this\ngenerates a list of predicted ions. These ions are then matched\nagainst the mass spectra from which the peptide was initially\nidentified in order to identify the number of matched ions, and\nin particular the number of site-determining ions. Site-\ndetermining ions are those ions which are unique for a\nparticular modification site\/combination of modification sites.\nWhile these algorithms represent a major step forward in\nthe development of tools to analyze large scale experimental\ndata sets generated from LC-MS\/MS, to date their usage is\nlimited to peptides fragmented by collision-induced dissocia-\ntion (CID). Recently, the radical-driven fragmentation tech-\nniques electron transfer dissociation (ETD)10 and electron\ncapture dissociation (ECD)11 have been applied to the large-\nscale analysis of phosphorylation.4,5,12 These techniques are\nparticularly well-suited to the analysis of phosphopeptides, as\nthe labile phosphate moiety is retained on peptide backbone\nfragments, in contrast to fragmentation by CID in which loss\nof the modification is the dominant pathway.13 An additional\nlimitation of the existing algorithms is that they accept peptide\nidentification output only from specific search engines, for\nexample, Sequest for Ascore and Mascot for MSQuant-\nincorporated localization.6,7\nTo address these limitations, we sought to generate a new\nsite localization tool, based on the Ascore algorithm, but\ncapable of addressing a wider range of problems. In particular\nour aims were to generate a tool which: (i) allows analysis of\ndata obtained using both CID and ETD\/ECD fragmentation\nmethods; (ii) caters for both high and low resolution fragmen-\ntation data; (iii) enables data to be read into the tool from a\nvariety of formats, using an extensible scheme; (iv) allows\nanalysis to be performed for a variety of modification types.\nOur algorithm, SLoMo (Site Localization of Modifications),\nallows calculation of hypothetical ions based on either CID or\nETD\/ECD. SLoMo accepts the generic pepXML input format14\nand incorporates options for searching for any modification\nfound in the UniMod database.6,15 Finally, we incorporate a\ncommon database back-end allowing easy access to the source\ndata for advanced users, and increased speed for searches on\npreproduced databases. We validate SLoMo by comparing it\nto Ascore (for CID data, where both algorithms will produce\nresults), through the use of synthetic phosphopeptide libraries\nand by manual validation of SLoMo localizations from in vivo\nphosphorylated proteins. We demonstrate that SLoMo can\nsuccessfully localize phosphorylation sites from low resolution\nETD and CID data, and from high resolution ETD and ECD\ndata. The application of SLoMo to other modifications is\nillustrated by localization of sites of methionine oxidation.\nFinally, SLoMo analysis of OMSSA output (phosphorylation)\nand Sequest output (oxidation) is shown.\n* To whom correspondence should be addressed. Helen J. Cooper, School\nof Biosciences, University of Birmingham, Edgbaston, Birmingham B15 2TT,\nUK. Telephone: +44 (0)121 414 7527. Fax: +44 (0)121 414 5925. Email:\nH.J.Cooper@bham.ac.uk.\n\u2020 CRUK Growth Factor Group.\n\u2021 University of Birmingham.\n\u00a7 Thermo Fisher Scientific.\n10.1021\/pr800917p CCC: $40.75 \uf8e9 2009 American Chemical Society Journal of Proteome Research 2009, 8, 1965\u20131971 1965\nPublished on Web 03\/10\/2009\nExperimental Section\nSpectrum Preprocessing. Given an MS\/MS spectrum gener-\nated for a peptide of precursor mass m, and a charge z, the\nmass spectrum is preprocessed to remove peaks corresponding\nto intact precursor ions and charge-reduced products (in ETD\/\nECD mass spectra) and selected neutral losses (in CID mass\nspectra) prior to binning the spectrum into 100 m\/z windows.\nSLoMo incorporates a tolerance t for region removal and\nutilizes the general ppm error value e (also used in the\ngenerated ion-to-mass spectrum matching part of the algo-\nrithm) such that for ECD\/ETD data peaks within the region R\nare removed for:\nm + Hi - e\ni\ne R e\nm + Hi + t\ni\n+ e\ni\nwhere i is the charge state of the reduced precursor ion, (1 e\ni e z), and H is the mass of a proton.\nFor CID data, peaks within region R are removed for:\nm + Hz - e - n\nz\ne R e\nm + Hz + e + t\nz\n- n\nz\nwhere n is the mass of the neutral loss entity, for example, n )\n97.977 Da (H3PO4) for phosphopeptides. Potential neutral losses\nare obtained by looking up data on the modification being\nanalyzed in UniMod. Each neutral loss is considered alone or\nwith additional neutral loss of water, and the region corre-\nsponding to the neutral loss of water alone is also removed.\nIon List Generation\/Filtering. Where ions are to be matched\nagainst mass spectra generated from ECD\/ETD events, c and\nz ions N-terminal to a proline residue are not generated. (N-\nterminal proline c and z ions are rarely observed in ECD\/ETD\nmass spectra16). Where there are multiple modifications of\ndifferent types (e.g., phosphorylation and acetylation) on a\nsingle peptide only one type of modification will be used to\ngenerate combinations of modification sites: all other modifi-\ncations are considered to be correctly localized by the search\nengine used to generate the peptide identifications, and remain\nfixed.\nModification Matching. Modifications are mapped to Uni-\nMod records by matching modification information stored\nwithin the pepXML file to the UniMod database. Matches are\nmade based on the amino acid identified as modified by the\ninitial protein database search and the mass difference of the\nassigned modification. Specifically, the modification mass must\nbe within 10-4 Daltons of the modification mass recorded in\nUniMod, and the amino acid must be specified in UniMod as\na site capable of having the modification present. For output\nfrom the OMSSA database search algorithm,17 where conver-\nsion to pepXML is currently unavailable, a user editable list is\nprovided which links the name given to the modification by\nOMSSA (e.g., phosphorylation) to the UniMod ID number for\nthat modification (in the case of phosphorylation: 21).\nStatistical Calculation. Ascore uses a cumulative binomial\nprobability model to calculate peptide and final Ascores:\nP ) \u2211\nk)n\nN (Nk )pk(1 - p)N-k\nwhere N is the number of trials (in this case the number of\npotential ions generated by the peptide under examination),\nn is the number of successes (the number of times an ion was\nmatched to a peak in the mass spectrum), and p is the\nprobability of a random match between an ion and a peak.\nAscore uses a tolerance of (0.5 m\/z for matching a peak to an\nion. This means that for a given peak depth of n peaks per 100\nm\/z window the probability of a match by chance is:\np ) n\n100\nHowever, in SLoMo, the tolerance is expressed in parts per\nmillion rather than inm\/z units. Thus the probability becomes:\np )\nxmin + xmax\n2\n\u00d7\n2e\n1000000\n\u00d7\nn\n100\nwhere xmin is the value (m\/z) of the lowest m\/z peak in the\nmass spectrum, xmax is the value (m\/z) of the highest m\/z peak\nin the mass spectrum, and e is the tolerance in parts per\nmillion.\nIn order to overcome computational issues associated with\ncalculating the binomial probability for large number of trial\nevents (which can lead to overflow and\/or underflow issues\nduring calculation), SLoMo utilizes a cumulative Poisson\ndistribution when the number of trial events is such that tests\nfor underflow and overflow issues in the binomial calculation\nare true. When this is the case, the following equation is used\nto calculate the probability score:\nP ) \u2211\nk)n\nN\ne \u03bb\u03bbk\nk!\nwhere \u03bb ) np.\nTest Datasets. 1. Ascore Data Set. A test data set of 135\nphosphoserine containing peptides was downloaded from\nhttp:\/\/ascore.med.harvard.edu\/examples\/sp.zip to test against\nSLoMo and Ascore (run online at http:\/\/ascore.med.harvard-\n.edu\/ascore.php.\n2. Synthetic Phosphopeptide Libraries. Synthetic phospho-\npeptide libraries were synthesized by Alta Biosciences (Bir-\nmingham, UK). The libraries were based on the peptide\nsequences: GPSGxVpSxAQLx[K\/R] and SxPFKxpSPLxFG[K\/R],\nwhere x is from ADEFGLSTVY. Each library therefore contains\na mixture of 2000 phosphopeptides. Each phosphopeptide\nlibrary was either fractionated by SCX chromatography or\nanalyzed directly by LC-MS\/MS.\n3. Whole-Cell Lysates. Mouse fibroblast NIH 3T3 cells were\ncultured at 37 \u00b0C, 5% CO2 in Dulbeccos Modified Eagle Medium\n(Invitrogen) supplemented with 2 mM L-Glutamine (Invitro-\ngen), 0.1 mg\/mL streptomycin, 0.2 U\/mL penicillin (Sigma) and\n10% v\/v donor bovine serum (Invitrogen). Following serum\nstarvation in media containing 0.1% serum for 18 h, cells were\ntreated with 2 mM sodium pervanadate for 20 min, prior to\nlysis. Cells were lysed by sonication in ice-cold urea lysis buffer\n(17 mM HEPES pH 8, 7.65 M urea, 1 mM Na3VO4, 50 mM NaF,\n25 mM \u0002-glycerophosphate and 1 tablet of complete mini\nprotease inhibitor cocktail (Roche Diagnostics) for every 10 mL\nof buffer).The lysates were reduced (8 mM DTT) and alkylated\n(20 mM iodoacetamide) in 50 mM ammonium bicarbonate.\nThe lysates were diluted to 4 M urea, acetonitrile (10% by\nvolume) and endoproteinase Lys-C were added (Sigma; 1:400\nenzyme:protein) and digestion was allowed to proceed at 37\n\u00b0C for 5 h. The lysates were then further diluted to 1 M urea,\ntrypsin (Trypsin Gold; Promega, Madison, WI) was added (1:\n100 enzyme:protein) prior to overnight digestion at 37 \u00b0C.\nPeptides were desalted and phosphopeptides were enriched\nusing TiO2 affinity.18 Bulk enrichment was carried out in an\nresearch articles Bailey et al.\n1966 Journal of Proteome Research \u2022 Vol. 8, No. 4, 2009\nEppendorf-type tube, rather than small columns, however the\nrest of the protocol was as previously described.19 Both the\nphosphopeptide-enriched eluate and the flow-through (un-\nbound fraction) were retained for MS analysis.\nLiquid Chromatography Tandem Mass Spectrometry\n(LC-MS\/MS). CID and ECD Data. Online liquid chromatog-\nraphy was performed by use of a Micro AS autosampler and\nSurveyor MS pump (Thermo Electron, San Jose, CA). Peptides\nwere loaded onto a 75 \u00b5m (internal diameter) Integrafrit (New\nObjective, USA) C8 resolving column (length 10 cm) and\nseparated over a 40 min gradient from 0% to 40% acetonitrile\n(Baker, Holland). Peptides eluted directly (\u223c350 nL\/min) via a\nTriversa nanospray source (Advion Biosciences, NY) into a 7 T\nThermo Finnigan LTQ FT mass spectrometer (Thermo Elec-\ntron), where they were subjected either to data-dependent CID\nor ECD. CID and ECD parameters were approximately as\npreviously described.19,20\nETD Data. Online liquid chromatography was performed by\nuse of a Micro AS autosampler and Surveyor MS pump\n(Thermo Fisher Scientific, San Jose, CA). Peptides were loaded\nonto a C18 trapping column (100 \u00b5m internal diameter, 2 cm\nlength, nanoseparations, The Netherlands) and separated on\na C18 analytical column (75 \u00b5m inner diameter, length 10 cm,\nnanoseparations, The Netherlands) over a 30 min gradient from\n0% to 35% acetonitrile (Fisher Scientific, USA). Peptides eluted\ndirectly (\u223c300 nL\/min) into a LTQ Orbitrap XL ETD mass\nspectrometer (Thermo Fisher Scientific, Bremen, Germany).\nElectron transfer dissociation was induced in the LTQ and ETD\nfragment ions were either detected in the LTQ or in the\nOrbitrap mass analyzer.\nETD reaction time was set to 100 msec for all charge states.\nSingly charged ions were rejected. Target value settings were 5\n\u00d7 105 for FT full scans, 1 \u00d7 105 for ETD with Orbitrap detection\nand 1 \u00d7 104 for ETD with LTQ detection.\nData Analysis: OMSSA Database Search Algorithm. DTA\nfiles were created from the raw data using Bioworks 3.3.1\n(Thermo Fisher Scientific Inc.). For the whole-cell lysate data,\nthe OMSSA browser was employed to search the DTA files\nagainst a concatenated database consisting of the mouse IPI\ndatabase (Version 3.40) and the reversed-sequence version of\nthe same database. The synthetic phosphopeptide libraries data\nwere searched against a concatenated database consisting of\n32 400 NCBIDrosophila melanogaster sequences and the library\nsequences with either K or R added to the N-terminus (to create\nreversed versions of the same mass).\nOMSSA settings for the whole-cell lysate high mass accuracy\nETD and ECD searches were as follows. Enzyme: trypsin.\nPeptide m\/z tolerance: 1.1 (. MS\/MS m\/z tolerance: 0.02 (.\nMis-cleavage allowed: 2. Fixed modifications: carbamidomethyl\nC. Variable modifications: acetylation of protein N-terminus,\noxidation of M, phosphorylation of S, T, Y. Product ion types\nto search: c, z, y. E-value cutoff: 50. Allow N-terminal Met\ncleavage: yes. Allow elimination of charge-reduced precursors\nin spectrum: yes. Precursor charge-state detection: read from\ninput file data. Alterations to the above settings for the various\nsearches are detailed below. OMSSA settings for the synthetic\npeptide ECD search: Mis-cleavage allowed: 1. Variable modi-\nfications: phosphorylation of S, T, Y. OMSSA settings for the\nlow mass accuracy synthetic peptide CID search: Peptide m\/z\ntolerance: 0.02 (. MS\/MS m\/z tolerance: 0.8 (. Product ion\ntypes to search: b,y. OMSSA settings for the low resolution ETD\nsearch: Peptide m\/z tolerance: 0.02 (. MS\/MS m\/z tolerance:\n0.8 (.\nOMSSA results were filtered to allow only the top scoring\nidentification (sequence and site of modification) per DTA. The\nresults were then filtered by precursor mass error (in ppm) and\ne-value to obtain a false-discovery rate for phosphopeptides\nlower than 2% for each search (FDR ) reverse hits\/forward hits\n\u00d7 100).\nSLoMo settings for the various data sets are detailed below.\nAll searches: tolerance ) 4 (window for removing precursor\nand neutral-loss peaks); doubly charged fragment ions were\nallowed for triply charged and higher charge-state precursors.\nECD and ETD data: c, z, z-prime and y ions; fragment ion\ntolerance of 13 ppm (high resolution) or 400 ppm (low\nresolution ETD data). CID data: b, y ions; fragment ion\ntolerance of 400 ppm.\nData Analysis: Sequest Database Search Algorithm. Bio-\nworks (3.3.1) was employed both to generate DTA files from\nECD analysis of mouse whole-cell lysate (flow-through from\nthe TiO2 enrichment described above) and to carry out a\ndatabase search using the Sequest algorithm.21 The database\nsearched was the mouse IPI database, as described above.\nSearch parameters were similar to those used above, with the\nexception that protein N-terminal acetylation was not available\nas a variable modification. The search results were filtered as\nabove, with the Sequest Xcorr score in place of the OMSSA\ne-value. The Trans-Proteomic Pipeline (Seattle Proteome Cen-\nter) was employed to generate a pepXML file. This file was then\nused by SLoMo to localize methionine oxidation. SLoMo search\nparameters were as described for ECD above.\nResults\nAlgorithm. SLoMo is modeled on the Ascore algorithm,\nwhich is discussed in detail by Beausoleil et al.6 We therefore\npresent here an overview of the algorithm with particular\nattention paid to the areas that have been enhanced.\nAssignment of a site localization and its associated score\nbegins with an analysis of the MS\/MS spectrum for the peptide\nin question. The mass spectrum is first cleared of all peaks\ncorresponding to precursor ions, charge-reduced ions, and\nneutral loss ions according to the dissociation method being\nused, that is, precursor ions and charge-reduced ions for ETD\/\nECD and neutral loss ions for CID. The mass spectrum is split\ninto regions, or windows, of 100m\/z width. From each of these\nregions the most intense i peaks are selected, where i is an\ninteger between 1 and 10. For example, a list generated at 5\npeaks per window contains the 5 most intense peaks in each\n100 m\/z window. Once lists of peaks have been determined\nfor each peak depth, the software then generates a list of all\npotential modification sites by examining the peptide sequence\ndetermined from the mass spectrum via a protein database\nsearch algorithm (e.g., Sequest, OMSSA etc.). At this point our\nnew algorithm deviates from the original. Through use of the\ninformation available in pepXML data files, it is possible to see\nall combinations of residues and mass differences considered\nby the protein database search algorithm when searching for\nmodified peptides. These data are read by SLoMo and used to\ndetermine the potential modifications for which it can search.\nFor OMSSA output, SLoMo parses the file to detect all modi-\nfications found. For each modification, the corresponding\nUniMod record is found, and the user prompted to select which\namino acid(s) should be considered as possible sites for this\nmodification. Once this step is complete, SLoMo allows the user\nto select from any of the modification types detected to perform\nsite localization. If there is more than one type of modification\nSLoMo: Automated Site Localization of Modifications research articles\nJournal of Proteome Research \u2022 Vol. 8, No. 4, 2009 1967\npresent in a peptide, the modifications not selected for site\nlocalization are assumed to have been correctly localized by\nthe protein database search algorithm.\nOnce a modification type has been selected, all potential\ncombinations of modification sites within a peptide are cal-\nculated, and for each combination a list of hypothetical ions\nis generated. SLoMo allows different ion sets to be generated.\nIn common with Ascore, lists of b and y ions are generated for\nCID data. However, SLoMo can also generate any other\ncombination of ion sets, so that mass spectra containing c, y\nand z\u2022 ions generated by ECD\/ETD, may be searched. The\nSLoMo ion generator can produce ion lists for most common\nion types, and those ion types can be combined together in\nany way. Likewise searching for multiply charged ions is also\nentirely optional and can be turned on or off. An established\nfeature of ECD and ETD is hydrogen transfer between comple-\nmentary fragments, resulting in c\u2022 and z\u2032 ions.22 The resulting\nz\u00b4 ions are commonly observed and can therefore optionally\nbe used in site localization by SLoMo.\nThe ion lists generated by SLoMo are matched against the\npeak lists (i.e., 1 to 10 peaks per window). In contrast to the\nAscore algorithm, the maximum permitted difference between\nFigure 1. Example of SLoMo output: SLoMo output for the phosphopeptide IDISPSYFRK. (A) Preprocessed MS\/MS spectrum after\nprecursor removal and generation of peak-per-window list. Color represents the ranked intensity of peaks within each window (1 )\nmost intense). (B) Modification scoring output. Each line shows the score for a different site of modification. In this example, the\nscores for putative phosphopeptide IDISPSY*FRK at each peak depth are shown in red. The scores for putative phosphopeptide\nIDISPS*YFRK are shown in blue and for putative phosphopeptide IDIS*PSYFRK are shown in green. (Note that the algorithm labels\nthe N-terminal amino acid as \u201c0\u201d, hence phosphopeptide IDIS*PSYFRK is labeled \u201c3\u201d and so on). (C) Comparison of site-determining\nions. In this example, the highest scoring peptides were IDIS*PSYFRK and ISISPS*YFRK. The two lists show all the ions observed\nwithin the MS\/MS spectrum at the optimum peak depth, i.e., at which the largest difference in scores is first observed, (defined as 5\nin this case). Ions highlighted in red are site-determining. \u201cDiff\u201d indicates mass error (in m\/z). (D) (Top) Program output from SLoMo\ndescribing its actions at each stage of the analysis process in addition to the final score for the localization. (Bottom) All possible\nsite-determining ions for the two highest scoring possibilities in this example.\nresearch articles Bailey et al.\n1968 Journal of Proteome Research \u2022 Vol. 8, No. 4, 2009\na hypothetical ion and a peak for a match may be customized,\nand is expressed in parts per million (ppm) rather than m\/z.\nExpressing the fragment ion tolerance in ppm better reflects\nthe errors in mass measurement in both low and high resolu-\ntion data, i.e., \u2206ppm is relatively constant across them\/z range\nof the mass spectrum, while \u2206m\/z increases with fragmentm\/z.\nPeptide scores are calculated using a binomial probability\nmodel. This approach however runs into computational prob-\nlems as the number of trials increases and, above approxi-\nmately 150 trials, it becomes impossible to calculate a score\nowing to overflow\/underflow problems with the numbers used\nto calculate the binomial probability. (Overflow\/underflow\nerrors are caused by the computer trying to work with numbers\nwhich are too big\/too small, respectively, for it to handle).\nWhen this situation occurs, SLoMo uses a Poisson model for\ncalculations, with checks for number overflow or underflow\nfail, and an additional check being done to ensure that n \u00d7 p\nand n \u00d7 p \u00d7 q are within 10% of each other, i.e., that the\nPoisson model is a close approximation to the equivalent\nbinomial model. As for Ascore, the probabilities are converted\ninto a log score via the equation:\nScore ) -10 \u00d7 log(P)\nAs for Ascore, the peptide score for each site-localized\npeptide (i.e., peptide in which the modification is assigned to\na specific site) is calculated as a weighted average of the scores\nfor each peak depth (1 peak per window ) 0.5; 2 ) 0.75; 3 ) 1;\n4 ) 1; 5 ) 1; 6 ) 1; 7 ) 0.75; 8 ) 0.5; 9 ) 0.25; 10 ) 0.25). Data\nfrom the two site-localized peptides with the highest peptide\nscores are used to generate the final score. At this stage only\nsite-determining ions are used in the calculation. A site-\ndetermining ion is any ion unique to the site-localized peptide\nin question. The list of site-determining ions is compared\nagainst the list of peaks at x peaks per windows, where x is the\nlowest number peaks per window for which the difference\nbetween the two peptide scores is maximal. The score is\ncalculated as described above and the final score is the\ndifference between the score for the top and second placed\nmodification sites. An example of the HTML output generated\nfor each localization is shown in Figure 1.\nTesting and Validation. SLoMo was tested against a series\nof data sets to ensure (i) it produced accurate site localizations\nfor data which could also be analyzed by Ascore, and (ii) could\ngenerate accurate localization data for datasets generated by\ndifferent dissociation techniques. Both synthetic phosphopep-\ntides, with known sites of phosphorylation, and in vivo phos-\nphorylated peptides with subsequent manual validation were\nused to assess SLoMo site localization.\nComparison with Ascore. In order to compare the output\nof SLoMo with that of Ascore, we took a set of 135 phospho-\npeptides available on the Ascore Web site, and analyzed them\nwith both SLoMo and Ascore. From this set of 135, Ascore\nsuccessfully (score g 19) localized the site of phosphorylation\nin 79 peptides, compared to 75 using an identical score cutoff\nfor SLoMo. The overlap between successfully localized phos-\nphopeptides was approximately 90% (70 cases). For 8 of the 9\npeptides which were confidently localized by Ascore but not\nby SLoMo, the SLoMo localization agreed but the SLoMo score\nwas below 19. SLoMo could not distinguish between the top\npossibilities for the final peptide.\nWithin the set of peptides where either method produced\na localization (regardless of score) (n ) 116), a total of six\nwere localized by SLoMo but not by Ascore, and 4 were\nlocalized by Ascore but not by SLoMo. There were also a\ntotal of three peptides where the site(s) of localization\ndiffered between the two algorithms, however the scores for\nthese peptides were below 19 in all cases. This experiment\nalso demonstrated the expected good correlation between\nAscores and SLoMo scores (R2 ) 0.84, see Supplementary\nFigure 1, Supporting Information).\nApplication of SLoMo to ECD and ETD Data. To test the\nperformance of SLoMo on ECD data, we acquired both CID\nand ECD mass spectra from two synthetic phosphopeptide\nlibraries. Each library consists of a mixture of two thousand\ndistinct phosphopeptides, with a common peptide backbone.\nEach library phosphopeptide has at least two potential sites of\nphosphorylation, with a maximum of five potential sites,\ndepending upon the identity of the variable amino acids. The\nactual site of phosphorylation is fixed at serine 7 for both\nlibraries. The sites assigned by SLoMo are shown in Table 1,\ntop half. The performance of SLoMo was also tested on a small\nnumber of phosphopeptides enriched frommammalian whole-\ncell lysates, with manual validation of the assigned sites. Three\ndata sets were used in these tests: ECD data and ETD data\nacquired with both high and low resolution. The results are\nshown in Table 1, bottom half. The error rates are within the\nexpected ranges, that is <1.3%, 1.3-3.2% and 3.2-10% for\nscores of >19, 15-19, and 10-15, respectively.\nInfluence of Fragment Ion Mass Tolerance on Site Local-\nization by SLoMo. The combined CID synthetic peptide\nlibraries (Table 1, rows 1 and 2) were searched with varying\nTable 1. SLoMo Validation Using Synthetic Phosphopeptide Libraries and Phosphopeptides Enriched from Whole-Cell Lysatesa\nnumber of localized sites (errors and multiple top hits)\ndata type number of mass spectra score: g19 15-19 10-15 <10\nSynthetic peptides (x is from ADEFGLSTVY)\nCID GPSGxVpSxAQLx[K\/R] 487 353 (0) 67 (0) 40 (2) 27 (23)\nCID SxPFKxpSPLxFG[K\/R] 420 350 (0) 26 (1) 26 (1) 18 (11)\nECD GPSGxVpSxAQLx[K\/R] 202 180 (0) 2 (0) 0 (0) 20 (20)\nECD SxPFKxpSPLxFG[K\/R] 406 356 (4) 4 (0) 0 (0) 46 (46)\nWhole-cell lysate (manually checked localizations)\nETD (low resolution) WCL phosphopeptides 82 56 (0) 4 (1) 5 (1) 17 (14)\nETD (high resolution) WCL phosphopeptides 54 40 (0) 3 (1) 1 (1) 10 (10)\nECD (high resolution) WCL phosphopeptides 41 29 (0) 3 (1) 1 (1) 7 (7)\na CID and ECD data were acquired with a 7T Thermo Finnigan LTQ-FT mass spectrometer. ETD data was acquired with a Thermo Fisher Orbitrap XL,\nusing either the Orbitrap (high resolution) or LTQ (low resolution) detector. All the peptides included in the table contained multiple potential\nphosphorylation sites. The numbers in brackets indicate the number of errors or disagreements (or multiple top hits, when SLoMo was unable to localise\nthe modification).\nSLoMo: Automated Site Localization of Modifications research articles\nJournal of Proteome Research \u2022 Vol. 8, No. 4, 2009 1969\nfragment ion tolerances, from 10 to 5000 ppm. The number of\nconfident localizations reaches a maximum around the true\nmass accuracy of the acquired data (approximately 400 ppm\nerror; Figure 2). Picking a mass tolerance much larger than\nnecessary causes the SLoMo scores to drop, while reducing the\nmass tolerance to an unrealistically small value causes an\nincrease in mass spectra with no site assignment (effectively a\nscore of 0). The error rates were relatively constant, with the\nexception of a spike in high-scoring errors when the mass\ntolerance was reduced to 10 ppm.\nLocalization of Methionine Oxidation. To demonstrate the\nlocalization of a modification other than phosphorylation, a\nmouse whole-cell lysate sample was analyzed (the flow-through\nfrom the phosphopeptide enrichment described above) and\nsites of methionine oxidation were localized. In this case, the\ninput to SLoMo was a pepXML file generated from a Sequest\ndatabase search. An example of the successful localization of\nmethionine oxidation is shown in Supplementary Figure 2\n(Supporting Information).\nConclusion\nThe results presented here demonstrate that SLoMo is a\nsuitable tool for localization of sites of modification within\npeptides identified by mass spectrometry. In this study, we\ndemonstrate that phosphorylation can easily be localized using\ndata obtained from a variety of fragmentation methods, namely\nECD, ETD and CID. The high degree of concordance between\nSLoMo and Ascore and the low error rates returned from\nsynthetic phosphopeptides and manual validation demonstrate\nthe accuracy of the algorithm. SLoMo has been validated using\nboth high and low resolution test data generated from two\ninstruments (LTQ-FT and Orbitrap). We have also demon-\nstrated the applicability of SLoMo to other modifications using\nthe example of methionine oxidation, and shown that SLoMo\naccepts outputs from a variety of protein database search\nengines (OMSSA, Sequest).\nSLoMo demonstrates general applicability to problems where\nlocalization of sites of modification is required for peptides\nidentified in high throughput mass spectrometry experiments.\nWith SLoMo, researchers now have a tool which is capable of\nundertaking site determination analysis for a range of different\nmodifications examined using multiple dissociation techniques.\nUser-defined ppm mass tolerances allow SLoMo to be applied\nto data generated from different instruments (e.g., ion-trap,\nQToF and FT-ICR) and the generic pepXML input format makes\nSLoMo compatible with multiple database search algorithms.\nThe program is extensible and modifiable: end users can easily\ncustomize the parameters used to search for localizations.\nSimilarly, adapting the program to accommodate any new\ndissociation technique which may become available is straight-\nforward. SLoMo is available for download for multiple platforms\nfrom http:\/\/massspec.bham.ac.uk\/slomo.\nAcknowledgment. We acknowledge CRUK (C.M.B.,\nD.L.C., J.K.H.), the EU FP6 Endotrack (S.M.M.S.), and the\nWellcome Trust (074131) (H.J.C.) for funding.\nFigure 2. Influence of fragment mass tolerance on SLoMo localization of phosphorylation. The combined CID mass spectra (n ) 907)\nof the synthetic phosphopeptide libraries were searched using different fragment mass tolerances. The number of errors >19 ranged\nfrom 11 to 0 and is shown multiplied 10-fold.\nresearch articles Bailey et al.\n1970 Journal of Proteome Research \u2022 Vol. 8, No. 4, 2009\nSupporting Information Available: Supplementary\nFigure 1. Comparison of Ascore scores and SLoMo scores. Score\noutput for 135 phosphopeptides examined using Ascore (x-axis)\nand SLoMo (y-axis).Supplementary Figure 2. SLoMo output\nshowing successful localization of methionine oxidation. This\nmaterial is available free of charge via the Internet at http:\/\/\npubs.acs.org.\nReferences\n(1) Mann, M.; Ong, S. E.; Gronborg, M.; Steen, H.; Jensen, O. N.;\nPandey, A. Trends Biotechnol. 2002, 20, 261\u20138.\n(2) Gruhler, A.; Olsen, J. V.; Mohammed, S.; Mortensen, P.; Faergeman,\nN. J.; Mann, M.; Jensen, O. N. Mol. Cell. Proteomics 2005, 4, 310\u2013\n27.\n(3) Ficarro, S. B.; McCleland, M. L.; Stukenberg, P. T.; Burke, D. J.;\nRoss, M. M.; Shabanowitz, J.; Hunt, D. F.; White, F. M. Nat.\nBiotechnol. 2002, 20, 301\u20135.\n(4) Molina, H.; Horn, D. M.; Tang, N.; Mathivanan, S.; Pandey, A. Proc.\nNatl. Acad. Sci. U.S.A. 2007, 104, 2199\u2013204.\n(5) Chi, A.; Huttenhower, C.; Geer, L. Y.; Coon, J. J.; Syka, J. E.; Bai,\nD. L.; Shabanowitz, J.; Burke, D. J.; Troyanskaya, O. G.; Hunt, D. F.\nProc. Natl. Acad. Sci. U.S.A. 2007, 104, 2193\u20138.\n(6) Beausoleil, S. A.; Villen, J.; Gerber, S. A.; Rush, J.; Gygi, S. P. Nat.\nBiotechnol. 2006, 24, 1285\u201392.\n(7) Olsen, J. V.; Blagoev, B.; Gnad, F.; Macek, B.; Kumar, C.; Mortensen,\nP.; Mann, M. Cell 2006, 127, 635\u201348.\n(8) Ruttenberg, B. E.; Pisitkun, T.; Knepper, M. A.; Hoffert, J. D. J.\nProteome Res. 2008, 7, 3054\u20139.\n(9) Wan, Y.; Cripps, D.; Thomas, S.; Campbell, P.; Ambulos, N.; Chen,\nT.; Yang, A. J. Proteome Res. 2008, 7, 2803\u20132811.\n(10) Syka, J. E.; Coon, J. J.; Schroeder, M. J.; Shabanowitz, J.; Hunt, D. F.\nProc. Natl. Acad. Sci. U.S.A. 2004, 101, 9528\u201333.\n(11) Zubarev, R. A.; Kelleher, N. L.; McLafferty, F. W. J. Am. Chem. Soc.\n1998, 120, 3265\u20133266.\n(12) Sweet, S. M. M.; Bailey, C. M.; Cunningham, D. L.; Heath, J. K.;\nCooper, H. J. Mol. Cell. Proteomics, in press; DOI: 10.1074\/\nmcp.M800451-MCP200.\n(13) Sweet, S. M.; Cooper, H. J. Expert Rev. Proteomics 2007, 4, 149\u201359.\n(14) Keller, A.; Eng, J.; Zhang, N.; Li, X. J.; Aebersold, R. Mol. Syst. Biol.\n2005, 1, 2005\u20130017.\n(15) Creasy, D. M.; Cottrell, J. S. Proteomics 2004, 4, 1534\u20136.\n(16) Cooper, H. J.; Hudgins, R. R.; Ha\u02dakansson, K.; Marshall, A. G. Int. J.\nMass Spectrom. 2003, 228, 723\u2013728.\n(17) Geer, L. Y.; Markey, S. P.; Kowalak, J. A.; Wagner, L.; Xu, M.;\nMaynard, D. M.; Yang, X.; Shi, W.; Bryant, S. H. J. Proteome Res.\n2004, 3, 958\u201364.\n(18) Larsen, M. R.; Thingholm, T. E.; Jensen, O. N.; Roepstorff, P.;\nJorgensen, T. J. Mol. Cell. Proteomics 2005, 4, 873\u201386.\n(19) Akbarzadeh, S.; Wheldon, L. M.; Sweet, S. M.; Talma, S.; Marda-\nkheh, F. K.; Heath, J. K. PLoS ONE 2008, 3, e1873.\n(20) Sweet, S. M.; Mardakheh, F. K.; Ryan, K. J.; Langton, A. J.; Heath,\nJ. K.; Cooper, H. J. Anal. Chem. 2008, 80, 6650\u20137.\n(21) Eng, J. K.; McCormack, A. L.; Yates, J. R. J. Am. Soc. Mass Spectrom.\n1994, 5, 976\u2013989.\n(22) Savitski, M. M.; Kjeldsen, F.; Nielsen, M. L.; Zubarev, R. A. J. Am.\nSoc. Mass Spectrom. 2007, 18, 113\u201320.\nPR800917P\nSLoMo: Automated Site Localization of Modifications research articles\nJournal of Proteome Research \u2022 Vol. 8, No. 4, 2009 1971\n"}