{"doi":"10.1109\/IPDPS.2007.370618","coreId":"70145","oai":"oai:eprints.lancs.ac.uk:13029","identifiers":["oai:eprints.lancs.ac.uk:13029","10.1109\/IPDPS.2007.370618"],"title":"On the Security of Ultrasound as Out-of-band Channel","authors":["Mayrhofer, Rene","Gellersen, Hans"],"enrichments":{"references":[{"id":16309714,"title":"A relative positioning system for co-located mobile devices.","authors":[],"date":"2005","doi":"10.1145\/1067170.1067190","raw":"M. Hazas, C. Kray, H. Gellersen, H. Agbota, G. Kortuem, and A. Krohn. A relative positioning system for co-located mobile devices. In Proc. ACM MobiSys 2005, pages 177\u2013 190, New York, NY, USA, June 2005. ACM Press.","cites":null},{"id":16309725,"title":"An authentication protocol using ultrasonic ranging.","authors":[],"date":"2006","doi":null,"raw":"R. Mayrhofer, H. Gellersen, and M. Hazas. An authentication protocol using ultrasonic ranging. Technical Report COMP-002-2006, Lancaster University, October 2006.","cites":null},{"id":16309721,"title":"Context authentication using constrained channels.","authors":[],"date":"2002","doi":"10.1109\/mcsa.2002.1017481","raw":"T. Kindberg, K. Zhang, and N. Shankar. Context authentication using constrained channels. In Proc. IEEE Workshop on Mobile Computing Systems and Applications (WMCSA), pages 14\u201321. IEEE Computer Society, June 2002.","cites":null},{"id":16309699,"title":"Distance-bounding protocols (extended abstract).","authors":[],"date":"1993","doi":"10.1007\/3-540-48285-7_30","raw":"S. Brands and D. Chaum. Distance-bounding protocols (extended abstract). In Theory and Application of Cryptographic Techniques, pages 344\u2013359, 1993.","cites":null},{"id":16309728,"title":"DOLPHIN: a practical approach for implementing a fully distributed indoor ultrasonic positioning system.","authors":[],"date":"2004","doi":"10.1007\/978-3-540-30119-6_21","raw":"M. Minami, Y. Fukuju, K. Hirasawa, S. Yokoyama, M. Mizumachi, H. Morikawa, and T. Aoyama. DOLPHIN: a practical approach for implementing a fully distributed indoor ultrasonic positioning system. In Proc. of Ubicomp 2004, pages 347\u2013365, Nottingham, UK, Sept. 2004. Springer.","cites":null},{"id":16309710,"title":"Manual authentication for wireless devices.","authors":[],"date":"2004","doi":null,"raw":"C. Gehrmann, C. J. Mitchell, and K. Nyberg. Manual authentication for wireless devices. RSA Cryptobytes, 7(1):29\u2013 37, 2004.","cites":null},{"id":16309701,"title":"New directions in cryptography.","authors":[],"date":"1976","doi":"10.1109\/tit.1976.1055638","raw":"W. Dif\ufb01e and M. E. Hellman. New directions in cryptography. IEEE Transactions on Information Theory, IT22(6):644\u2013654, 1976.","cites":null},{"id":16309700,"title":"So near and yet so far: Distance-bounding attacks in wireless networks.","authors":[],"date":"2006","doi":"10.1007\/11964254_9","raw":"J. Clulow, G. P. Hancke, M. G. Kuhn, and T. Moore. So near and yet so far: Distance-bounding attacks in wireless networks. In Proc. ESAS 2006: 3rd European Workshop on Security and Privacy in Ad hoc and Sensor Networks, pages 83\u201397. Springer, 2006.","cites":null},{"id":16309702,"title":"Surveyofmethods for modeling sound propagation in interactive virtual environment systems. Presense and Teleoperation,","authors":[],"date":"2003","doi":null,"raw":"T.Funkhouser, N.Tsingos, andJ.-M.Jot. Surveyofmethods for modeling sound propagation in interactive virtual environment systems. Presense and Teleoperation, 2003.","cites":null},{"id":16309698,"title":"Talking to strangers: Authentication in ad-hoc wireless networks.","authors":[],"date":"2002","doi":null,"raw":"D. Balfanz, D. K. Smetters, P. Stewart, and H. C. Wong. Talking to strangers: Authentication in ad-hoc wireless networks. In Proc. of the 2002 Network and Distributed Systems Security Symposium (NDSS\u201902). The Internet Society, Feb. 2002.","cites":null},{"id":16309711,"title":"The anatomy of a context-aware application.","authors":[],"date":"1999","doi":"10.1145\/313451.313476","raw":"A. Harter, A. Hopper, P. Steggles, A. Ward, and P. Webster. The anatomy of a context-aware application. In Proc. ACM\/IEEE MobiCom \u201999, pages 59\u201368, New York, NY, USA, 1999. ACM Press.","cites":null},{"id":16309731,"title":"The cricket location-support system.","authors":[],"date":"2000","doi":"10.1145\/345910.345917","raw":"N. Priyantha, A. Chakraborty, and H. Balakrishnan. The cricket location-support system. In Proc. ACM MobiCom \u201900, August 2000.","cites":null},{"id":16309718,"title":"Validating and securing spontaneous associations between wireless devices.","authors":[],"date":"2003","doi":"10.1007\/10958513_4","raw":"T. Kindberg and K. Zhang. Validating and securing spontaneous associations between wireless devices. In Proc. 6th Information Security Conference (ISC\u201903), pages 44\u201353. Springer, October 2003.","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2007-03","abstract":"Ultrasound has been proposed as out-of-band channel for authentication of peer devices in wireless ad hoc networks. Ultrasound can implicitly contribute to secure communication based on inherent limitations in signal propagation, and can additionally be used explicitly by peers to measure and verify their relative positions. In this paper we analyse potential attacks on an ultrasonic communication channel and peer-to-peer ultrasonic sensing, and investigate how potential attacks translate to application-level threats for peers seeking to establish a secure wireless link. Based on our analysis we propose a novel method for authentic communication of short messages over an ultrasonic channel","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/70145.pdf","fullTextIdentifier":"http:\/\/eprints.lancs.ac.uk\/13029\/1\/SSN2007%2DUltrasound%2DSecurity%2DAnalysis.pdf","pdfHashValue":"7d7b5ffd7e6d86b5afed9b82f9d3885df705e64a","publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lancs.ac.uk:13029<\/identifier><datestamp>\n      2018-01-24T02:16:50Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D51:5141:51413735<\/setSpec><setSpec>\n      74797065733D636F6E666572656E63655F6974656D<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        On the Security of Ultrasound as Out-of-band Channel<\/dc:title><dc:creator>\n        Mayrhofer, Rene<\/dc:creator><dc:creator>\n        Gellersen, Hans<\/dc:creator><dc:subject>\n        QA75 Electronic computers. Computer science<\/dc:subject><dc:description>\n        Ultrasound has been proposed as out-of-band channel for authentication of peer devices in wireless ad hoc networks. Ultrasound can implicitly contribute to secure communication based on inherent limitations in signal propagation, and can additionally be used explicitly by peers to measure and verify their relative positions. In this paper we analyse potential attacks on an ultrasonic communication channel and peer-to-peer ultrasonic sensing, and investigate how potential attacks translate to application-level threats for peers seeking to establish a secure wireless link. Based on our analysis we propose a novel method for authentic communication of short messages over an ultrasonic channel.<\/dc:description><dc:date>\n        2007-03<\/dc:date><dc:type>\n        Contribution to Conference<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/eprints.lancs.ac.uk\/13029\/1\/SSN2007%2DUltrasound%2DSecurity%2DAnalysis.pdf<\/dc:identifier><dc:relation>\n        http:\/\/dx.doi.org\/10.1109\/IPDPS.2007.370618<\/dc:relation><dc:identifier>\n        Mayrhofer, Rene and Gellersen, Hans (2007) On the Security of Ultrasound as Out-of-band Channel. In: Proc. IPDPS 2007: 21st IEEE International Parallel and Distributed Processing Symposium, 1900-01-01.<\/dc:identifier><dc:relation>\n        http:\/\/eprints.lancs.ac.uk\/13029\/<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/dx.doi.org\/10.1109\/IPDPS.2007.370618","http:\/\/eprints.lancs.ac.uk\/13029\/"],"year":2007,"topics":["QA75 Electronic computers. Computer science"],"subject":["Contribution to Conference","PeerReviewed"],"fullText":"On the Security of Ultrasound as Out-of-band Channel\nRene Mayrhofer and Hans Gellersen\nComputing Department, Lancaster University\n{rene,hwg}@comp.lancs.ac.uk\nAbstract\nUltrasound has been proposed as out-of-band channel\nfor authentication of peer devices in wireless ad hoc net-\nworks. Ultrasound can implicitly contribute to secure com-\nmunication based on inherent limitations in signal propa-\ngation, and can additionally be used explicitly by peers to\nmeasure and verify their relative positions. In this paper\nwe analyse potential attacks on an ultrasonic communica-\ntion channel and peer-to-peer ultrasonic sensing, and inves-\ntigate how potential attacks translate to application-level\nthreats for peers seeking to establish a secure wireless link.\nBased on our analysis we propose a novel method for au-\nthentic communication of short messages over an ultrasonic\nchannel.\n1. Introduction\nSpontaneous interaction in wireless ad hoc networks is\nespecially vulnerable to attacks on the wireless communica-\ntion channels. Such attacks include eavesdropping, inject-\ning and modifying packets, replay, or denial of service. We\ngenerally have to assume that attackers are able to mount\n\u2018man-in-the-middle\u2018 (MITM) attacks, where they agree to\ntwo different keys with the communicating devices and\nwhich subsumes the other attack types. The major problem\nof purely wireless communication is therefore key manage-\nment: to securely exchange keys with the intended commu-\nnication partner. Using (supposedly) computationally se-\ncure key agreement protocols such as Diffie-Hellman [4],\nthis problem is further shifted to that of authentication: to\nsecurely verify that a key belongs to the intended communi-\ncation partner. In pervasive computing, and more generally\nin peer-to-peer networking, we can not currently assume the\navailability of a globally trusted third party. For sponta-\nneous interaction, the only option is therefore ad hoc verifi-\ncation of keys, which requires some extra channel with ad-\nditional security properties. This is a channel other than the\nmain wireless channel and often called \u2018out-of-band\u2018 chan-\nnel.\nBalfanz et al. introduced the notion of location-limited\nchannels for out-of-band communication channels that re-\nquire devices to be in a certain, user-verifiable spatial re-\nlationship in order to establish communication [1]. Kind-\nberg et al. discussed constrained channels along similar\nlines [11]. A variety of communication technologies have\nbeen considered for implementation of out-of-band chan-\nnels with the desired characteristic of limiting communica-\ntion to a user-controlled context. This includes ultrasound,\non which we focus our analysis in this paper.\nUltrasound (US) is an interesting candidate technology\nfor out-of-band communication alongside wireless radio\n(RF), for two reasons. First, ultrasound has inherent lim-\nitations in signal propagation (unlike RF, US signals are\ncontained in rooms). Secondly, ultrasonic communication\ncan be used by peer devices to estimate their relative po-\nsitions (from US time-flight measurements, with RF com-\nmunication for synchronisation [9]), and thus to obtain in-\nformation that can be useful for verification of device au-\nthenticity. Ultrasound has been noted as a possible technol-\nogy for authentication of peers within a room, exploiting its\nbroadcast and propagation characteristics [1]. A concrete\nprotocol design with ultrasound as out-of-band channel for\nauthentication of spontaneous device associations has been\ndiscussed in [10]. In this protocol, ultrasound is proposed\nfor out-of-band communication of nonces, and for verifica-\ntion of the spatial direction from which a transmission has\nbeen received. However, the protocol has not been imple-\nmented, and assumptions made concerning the use of ultra-\nsound have neither been tested nor analysed in more depth.\nIn this paper we contribute an analysis of ultrasound as\nout-of-band channel for secure authentication of devices in\nwireless ad hoc networks. We assume a device A seeking to\nestablish a secure wireless link to a device B without prior\nknowledge of B, or access to a shared trusted third party.\nThe principal threat in this scenario is that a man-in-the-\nmiddle E can establish itself between A and B. A and B\nmay be mobile devices, but they are assumed to be static\nin relation to each other during the initial establishment of\nthe link (but may move freely after successful channel es-\ntablishment). The protocol proposed earlier [10] has the\ndisadvantage that users are expected to move deliberately\nto different locations and verify spatial measurements dur-\ning the authentication phase, which can be cumbersome for\nad hoc interaction. We do not assume any explicit actions\nby users solely for authentication purposes, but analyse the\nsecurity properties of an ultrasonic channel by itself.\nIn the following sections we first look into properties\nof ultrasonic systems that can be exploited for peer au-\nthentication. We then analyse attack scenarios on the ul-\ntrasonic communication channel, and further analyse how\nthese translate to threats at application level. We conclude\nthe paper describing a novel method for authentic commu-\nnication of short messages over an ultrasonic channel.\n2. Properties of Ultrasonic Systems\nDevices that use ultrasound as out-of-band channel can\nexploit properties of the medium both implicitly and explic-\nitly. Ultrasound has propagation characteristics that implic-\nitly contribute toward location-limited communication, in\nparticular by containing signals in rooms which provides\nusers with a distinct level of control. Devices can use ultra-\nsound also explicitly, to estimate their spatial relationship\nfor purposes of verifying that the device they are talking to\nis indeed in the assumed position, for instance \u2019in front of\nthe user\u2019.\nUltrasound signals are, due to the large differences in\nacoustic impedances between air and solid materials, (al-\nmost) completely reflected or absorbed by walls, doors and\nwindows. Bending around doors or other openings causes\nchaotic influences on signal propagation and is practically\nunpredictable from an attacker\u2019s point of view. Conse-\nquently, we can assume signals or messages transmitted\nover an ultrasonic channel not to leave a room, and we can\nalso assume that it is not possible to inject ultrasonic mes-\nsages into a room from the outside.\nUltrasound signals travel at comparatively low speed\nwhich makes it possible for a pair of devices to measure\ntime-of-flight of a pulse or message transmitted over an ul-\ntrasonic channel, provided they have access to an RF chan-\nnel for synchronisation. Time-of-flight measurements allow\nfor very accurate ranging (i.e. distance estimation) between\npeers, with errors reported well below 10cm [13, 9]. Even\nbetter accuracy can be achieved if either multiple emit-\nters or receivers are used to take measurements from dif-\nferent angles (as in ultrasonic positioning infrastructures,\ne.g. [7, 14]). However, for our target use, verification of A\nand B\u2019s authenticity in a spontaneous encounter, we assume\nthat devices will not trust other sensors but their own.\nEstimation of the direction from which an ultrasound\nsignal has arrived is possible if a device has multiple re-\nceivers on board. If these receivers are placed sufficiently\nfar apart then it can be possible to estimate angle-of-arrival\nfrom differences in time-of-flight (this method was sug-\ngested though not tried in Kindberg & Zhang\u2019s peer authen-\ntication protocol [10]). Another possibility, better suited for\ndevices of small dimension as typical in mobile scenarios, is\nto use an arrangement of receivers facing in different direc-\ntions and to derive angle-of-arrival from analysis of peak\nsignal values (an incoming pulse or message will register\nthe highest peak with the receiver oriented most closely to\nthe emitting device). This method has been used for in-\nstance in the RELATE system with 3 transceivers covering\n180 degrees, with reported raw measurement error of 33 de-\ngrees [9].\n3. Threat analysis for ultrasonic communica-\ntion and sensing\nFor our threat analysis we assume devices A and B seek-\ning to secure communication over a wireless radio network.\nWe further assume possible use of ultrasound as out-of-band\nchannel over which messages can be exchanged, and use\nof ultrasound synchronised over RF for estimation of dis-\ntance and possible relative orientation. Note that transmit-\nting messages over US as part of an authentication protocol\nis different from using US for distance-bounding protocols,\nintroduced as a method for determining the maximum dis-\ntance between devices [2]. As shown recently [3], direct\nuse of US for distance bounding is open to relaying attacks\nand thus not considered secure for authentication of peer\ndevices. For our analysis, we do not assume US to provide\na secure upper bound on the distance.\nAs for attacker capabilities, we make two principal as-\nsumptions:\n1. An attacker can stage attacks on the RF channel from\nanywhere within the range of the wireless network, to\neavesdrop, to cause Denial-of-Service (DoS), or to im-\npose itself as man-in-the-middle (MITM) between A\nand B (to the effect that A and B believe to be talking\nto each other, while actually talking to E).\n2. Attacker capabilities on the US channel depend on how\nthe attacker is located relative to the attacked devices1;\nin other words, we assume that an attacker is not able\nto \u2018virtualize\u2019 their position by using groups or whole\narrays of coordinated ultrasound emitters. Note that\nspeaker arrays can be used for spatialised audio [5]\nbut due to the shorter wavelength of ultrasound and\nits more complex propagation characteristics, it would\nappear prohibitively difficult to achieve accurate ultra-\nsound spatialisation.\n1With location or position of an attacker we actually refer to the posi-\ntion of the communication device used to mount the attack.\nFigure 1. The capability of E to stage an at-\ntack on ultrasonic communication and sens-\ning between A and B depends on how E is\npositioned with respect to A and B.\nFigure 1 illustrates our scenario with devices A and B,\nand an attacker E that can be in different positions (E0, E1,\netc.) with respect to A and B. In the following we analyse\npotential threats to ultrasonic communication and sensing\nbetween A and B for each of these positions:\n1. E0 \u2013 outside room: It is an inherent property of ul-\ntrasound that signals are blocked by walls, doors and\nwindows. Therefore we can assume that it is not pos-\nsible to eavesdrop on ultrasound communication from\noutside a room, and that it is also not possible to inter-\nfere with the ultrasound channel from the outside, i.e to\ninsert or modify messages that would compromise ul-\ntrasonic communication between A and B. While US\nsignals can bend around doors or corners, this sub-\njects them to distortions that in practice also exclude\nmeaningful attacks. In such situations, accurate loca-\ntion information for both attacker and victim would be\nneeded to produce proper time-delay-of-arrival at the\nreceiver; creating an arbitrary angle-of-arrival is pro-\nhibitively difficult [8].\nHowever, an attacker E would still be able to mount\nan attack on the RF channel, for general denial of ser-\nvice, targeted prevention of devices from discovery on\nthe network, or tampering with messages that may be\nused for synchronisation of ultrasonic sensing. The\nconcrete threats with respect to ultrasonic communi-\ncation and sensing are: a) to prevent a device from\nparticipation in ultrasonic communication, for exam-\nple to the effect that a target device B selected by a user\nwith device A becomes barred from authenticating it-\nself; b) to cause erroneous distance estimates, i.e. hav-\ning A estimate B to be closer or further away then they\nactually are and thus compromising any distance- or\nposition-based verification procedure; and c) to mod-\nify any distance, orientation, or position estimates ex-\nchanged over RF (note it is common in ultrasonic po-\nsitioning system to exchange measurements over RF,\nbut it is not required and can be avoided). Threat b)\nalso invalidates any assumptions that may be made for\ndistance-bounding methods, even without more com-\nplex relay attacks as described earlier [3].\n2. E1 \u2013 in room: If E is in the same room with A and B,\nor more precisely in the same propagation range, then\nE will have the additional capability to listen to all ul-\ntrasound communication, and to insert pulses or mes-\nsages on the ultrasound channel, at any time with arbi-\ntrary signal strength. However, E will not generally be\nable modify or replace other messages exchanged over\nthe channel, e.g. between A and B, unless E is po-\nsitioned \u201dmore strategically\u201d in cases we discuss fur-\nther below. Concrete threats arising are thus: d) to\neavesdrop on the ultrasound channel; e) to insert ultra-\nsonic pulses or messages with a potential of confusing\nor compromising ultrasonic sensing between other de-\nvices, and to present itself at a certain distance (cf. case\nE2); and f) to block ultrasound transmission, which,\ndepending on the specific implementation of ultrasonic\nsensing and the sophistication of the attack, may or\nmay not be distinguishable from signal noise. The dis-\ntinction between blocking of transmission, i.e. denial\nof service, and selectively removing messages sent by\nother devices is blurred.\n3. E2 \u2013 equidistant positions: If E is positioned at the\nsame distance from a receiving device (e.g. A) as the\nintended target device (e.g. B) then E might achieve\nto be verified as B, if verification were based on dis-\ntance only. Obviously if E is positioned equidistant\nfrom both devices, it may achieve positive verification\nby both and A and B as a man-in-the middle. Note\nthat E can easily make itself appear at a particular dis-\ntance from a single receiver, from anywhere in its ul-\ntrasonic range, by emitting an ultrasonic pulse or mes-\nsage ahead of the synchronisation schedule (to appear\nnearer) or delayed after a synchronisation point (to be\nappear farther). The threat in either case is: g) to ap-\npear at the same distance as the target device, and it\nhighlights the value of angle-of-arrival estimates in ad-\ndition to range measurements for device verification\npurposes.\n4. E3 \u2013 in line: When E manages to position itself in\nline with A and B, its US messages will be received\nat an angle-of-arrival that corresponds with the angle\nat which the device \u2019in the middle\u2019 is positioned from\nthe perspective of the receiving device. For example,\nin the scenario shown in Fig. 1, E will appear to be\nB from A\u2019s point of view, but not to be A from B\u2019s\npoint of view. The threat is thus: h) to appear from the\nsame angle to a single device. Note that peer-to-peer\nangle-of-arrival estimates tend not to be very accurate\nin practice and thus it may suffice for E to approximate\na position in line with A and B, in order to produce this\nthreat.\n5. E4 \u2013 in between: A position at some point on the line\ndirectly in between A and B offers E most capabilities\nfor an attack on US communication and sensing be-\ntween A and B. US messages produced by E will be\nreceived from the same angle at which A and B are po-\nsitioned respectively, creating threat i) to appear from\nthe same angle to both devices. Additionally, by be-\ning directly in the line of US signalling between A and\nB, the attacker E may be able j) to cancel or modify\nspecific US messages in transit, by means of gener-\nating anti-ultrasound (similar to noise-cancellation in\naudio).\nTable 1 summarises threats to ultrasonic communication\nand sensing:\nCase Threats Safeguards\nE0 Attack on RF US safe as out-of-band\nchannel for authentication\nE1, E2 Attack on Check for duplicate pulses,\nUS ranging verify angle of arrival\nE3 Attack from Mutual verification of\ndirection of target positions\nE4 Attack from Requires additional\ndirection of peer measures\nTable 1. Summary of threats and safeguards\nThe main conclusions from this analysis are:\n\u2022 Ultrasound can be effective as out-of-band channel for\nauthentication of peer devices if the presence of an\nattacker in the same room can be ruled out by other\nmeans.\n\u2022 If an attacker has access to the same room as the peer\ndevices, then US ranging as such is not safe for further\nlimiting the communication channel.\n\u2022 Angle-of-arrival can be used to further constrain the\ncommunication channel, and to limit the possibility of\nan attack to attacker positions approximately in line\nwith the peer devices; only cases E3 and E4 remain to\nbe addressed. Verifying angle-of-arrival also prevents\nattacks from outside the room that may be relying on\nreflections e.g. at half-open doors.\n4. Application-level threats\nIn this section we extend our analysis to review\napplication-level threats for devices that use RF in combi-\nnation with ultrasonic communication and sensing for au-\nthentication of peers. For our discussion we assume A to be\na device operated by a user, and B to be a target device se-\nlected by the user for association with their device. B may\nbe a device in the environment, or the device of another user.\n1. Replacement: The first threat on application-level is\nfor the attacker E to virtually replace the intended tar-\nget device (say B), to the effect that A authenticates E\ninstead of the actual target. For E to achieve this attack,\nthey need to first \u2018silence\u2019 B so that B does not emit\nultrasound and remains undetected by A (see threats\na and f as discussed in the previous section). E fur-\nther needs to pass potential verification of its position,\nwhich it can achieve by manipulating the distance at\nwhich it would be sensed by A (threats b and e, or g),\nand by positioning itself in line with A and B (cases\nE3 and E4, threat h). In this attack, interaction occurs\nonly between A and E, and no interaction occurs with\nB. This scenario is limited to situations where the user\ndoes not expect a human-verifiable response from B in\nthe process of interaction.\n2. Asynchronous MITM: An asynchronous MITM attack\noccurs when the attacker E first achieves authentica-\ntion with A (replacing B as described above), and in\na second step with B (without the need to pretend to\nbe A, and thus without positional constraint). E can\nthen intercept messages from A, and forward them to\nB, to ensure a response of B as expected by the user.\nAn example for such a situation would be printing: A,\nwhen sending a document to a printer B, expects it to\nprint shortly afterwards. In this scenario, the attacker\navoids detection by forwarding intercepted messages.\nHowever, the scenario requires that B does not verify\nthe sender of the messages (only A authenticates B, but\nnot the other way around).\n3. Synchronous MITM: For a synchronous MITM attack\nE must achieve to establish itself between A and B on\nboth the RF and the US channel, to appear to A as B\nand vice versa. If A and B use angle-of-arrival in the\nauthentication process, E will only be able to achieve\nthis attack if positioned literally in the middle between\nA and B (case E4).\nSpontaneous interactions commonly occur in unknown\nand open environments, and generally it will not be possi-\nble to rule out the presence of an attacker in close enough\nproximity, and not blocked by walls, in order to threaten\npeer authentication. For peers to guard further against at-\ntacks, sensing of angle-of-arrival can be used to signifi-\ncantly constrain the positions from which attacks remain\npossible (leaving cases E3 and E4).\nIf we assume A as a user\u2019s device to be mobile but B to\nbe a stationary device, such as a printer, then it might be\nplausible that an attacker positions itself strategically, to be\nin line between the stationary device and a likely user posi-\ntion. A scenario E3 might be excluded when B is mounted\nto a wall, or placed against wall. However, if B is also a mo-\nbile device, carried by another user, then it will generally be\nmore difficult and less likely that an attacker achieves to po-\nsition themselves between A and B. It could be argued that\na user would naturally detect any device positioned between\nits own device A, and a target device, but it has to be noted\nthat attacks would be possible with very small wireless sen-\nsor nodes.\nIf we accept the possibility of a malicious sensor node\nE directly between A and B then we need to consider more\nclosely the node\u2019s attacking capability, in particular for can-\ncellation and replacement of US messages in transit (threat\nj). If A sends a US message triggered over RF, E will need\nto cancel the message with anti-ultrasound, and generate its\nown US message directed at B. The smaller E is, the less\ntime E has to replace a message to reach B within the ex-\npected time-of-flight, because of the time it takes the US\nmessages to pass by E. For example, if E measures only\na few centimetres so not to conspicuous, then it will only\nhave a few hundred microseconds for the computations re-\nquired for modifying the pulse, which, in current wireless\nsensor hardware, will not be sufficient. Moreover, given the\npropagation characteristics of ultrasound, it would not seem\nplausible that pulses can be cancelled without noise effects\nthat would allow to uncover the attack.\n5. Authentic communication of short messages\nover an ultrasonic channel\nIn this section we introduce a method for communica-\ntion of short messages over ultrasound, effectively coding\nbits as distance quantities, in a way that ensures decoding\nonly to be possible by a receiver who is positioned at an ex-\npected distance from the sender. This method is designed\nto overcome the problem that ultrasonic ranging as such\nis open to attack, and allows effective use of distance es-\ntimates to constrain ultrasonic communication. As for the\napplication-level threat discussed, it can be used in conjunc-\ntion with angle-of-arrival verification, in order to safeguard\nagainst attack in cases E3 and E4 (providing the \u2019additional\nmeasure\u2019 referred to in table 1, under the assumption that\nthe attacker is not able to modify messages in transit).\nOur method requires in a first step, that the authenticat-\ning devices take a reference measurement of their distance,\n(a) The sender delays an US pulse after the\nRF trigger to code a message, which corre-\nsponds to a distance in the spatial domain.\n(b) The receiver measures time from trigger\nto pulse arrival, and subtracts a stored refer-\nence from the corresponding distance to re-\ntrieve the message.\nFigure 2. Message transmission embedded\nwith ultrasonic ranging.\nand that this measurement is verified by a user. This can\nbe elegantly achieved if all devices discovered in ultrasonic\nsensing range are displayed in a map corresponding with\ntheir real-world placement, as proposed in [9] for seamless\ninteraction with across devices.\nAs illustrated in Figure 2(a), a sender transmits informa-\ntion by delaying an ultrasonic pulse in relation to an RF syn-\nchronisation message. By delaying the US pulse, the time-\nof-flight and thus distance will appear larger than it is, and\nthe virtually added distance represents the transmitted in-\nformation. A receiver retrieves the virtually added distance\nand thus the message by subtracting the reference measure-\nment from their actual measurement, see Figure 2(b). The\nreceiver will only be able to retrieve the message content, if\nthe sender\u2019s distance matches the stored reference. By re-\ntrieving the random nonce this way, it can be used in higher-\nlevel protocols as an authentic message from the remote\nhost. Note that the transmitted information is not private;\nany receiver in the same room will see the same virtually\nadded distance, in comparison to previous measurements.\nThe authenticity of the proposed channel is created by\ndelaying US pulses, but only provided E does not know the\ntransmitted information beforehand. We propose that the\nchannel can be used for transmitting nonces as part of an\nauthentication protocol such as the MANA I protocol [6].\nFor authenticity of messages, both the distance and the an-\ngle must match the expectations of the receiver. We have\nalready argued that the attacker will not be able to manipu-\nlate angle-of-arrival measurements, but E could still be po-\nsitioned in between A and B (case E4). E could also cre-\nate US pulses so to appear to come from A\u2019s or B\u2019s posi-\ntion, but only if it knows when the pulse would be sent.\nThis though depends on the message content, and in the\ncase of nonces would be random. When E introduces its\nown pulses, the received message will be different from the\nnonce that the sender transmitted, and authentication proto-\ncols can be constructed to detect this. The random element\nand distance-based coding make the US channel authen-\ntic. We have implemented a concrete authentication pro-\ntocol using this property in conjunction with an interlock\nprotocol and based on an existing peer-to-peer US sensing\nplatform [12].\n6. Conclusions\nIn this paper we have analysed and discussed security\nproperties of ultrasound as out-of-band channel in the con-\ntext of peer device authentication. We identified potential\nthreats to ultrasonic communication and sensing in depen-\ndence of attacker position, and analysed how these trans-\nlate to application-level threats. A particular observation\nis the vulnerability of ultrasonic ranging to manipulation.\nTo address this problem, and to provide an authentic out-\nof-band channel, we proposed a new method for distance-\ncoded communication over ultrasound.\nOur proposed method of piggy-backing information on\nsingle ultrasound pulses makes the US channel authentic,\nand thus protects against synchronous MITM attacks even\nwhen assuming far-reaching attacker capabilities. Protect-\ning against asynchronous MITM attacks requires changes\nto the application, e.g. to light an LED when the infrastruc-\nture device is engaged in an interaction. Then a user could\nnotice the delay between the two interactions and abort the\ntransaction.\n7. Acknowledgements\nThis work is partly supported by the EC under con-\ntract 013790 \u201dRELATE\u201d, and by EPSRC under grant\nGR\/S77097\/01. We thank Mike Hazas for discussions on\ndetails of ultrasound propagation characteristics.\nReferences\n[1] D. Balfanz, D. K. Smetters, P. Stewart, and H. C. Wong.\nTalking to strangers: Authentication in ad-hoc wireless net-\nworks. In Proc. of the 2002 Network and Distributed Sys-\ntems Security Symposium (NDSS\u201902). The Internet Society,\nFeb. 2002.\n[2] S. Brands and D. Chaum. Distance-bounding protocols\n(extended abstract). In Theory and Application of Crypto-\ngraphic Techniques, pages 344\u2013359, 1993.\n[3] J. Clulow, G. P. Hancke, M. G. Kuhn, and T. Moore. So\nnear and yet so far: Distance-bounding attacks in wireless\nnetworks. In Proc. ESAS 2006: 3rd European Workshop on\nSecurity and Privacy in Ad hoc and Sensor Networks, pages\n83\u201397. Springer, 2006.\n[4] W. Diffie and M. E. Hellman. New directions in cryp-\ntography. IEEE Transactions on Information Theory, IT-\n22(6):644\u2013654, 1976.\n[5] T. Funkhouser, N. Tsingos, and J.-M. Jot. Survey of methods\nfor modeling sound propagation in interactive virtual envi-\nronment systems. Presense and Teleoperation, 2003.\n[6] C. Gehrmann, C. J. Mitchell, and K. Nyberg. Manual au-\nthentication for wireless devices. RSA Cryptobytes, 7(1):29\u2013\n37, 2004.\n[7] A. Harter, A. Hopper, P. Steggles, A. Ward, and P. Web-\nster. The anatomy of a context-aware application. In Proc.\nACM\/IEEE MobiCom \u201999, pages 59\u201368, New York, NY,\nUSA, 1999. ACM Press.\n[8] M. Hazas. Personal communication, 2006.\n[9] M. Hazas, C. Kray, H. Gellersen, H. Agbota, G. Kortuem,\nand A. Krohn. A relative positioning system for co-located\nmobile devices. In Proc. ACM MobiSys 2005, pages 177\u2013\n190, New York, NY, USA, June 2005. ACM Press.\n[10] T. Kindberg and K. Zhang. Validating and securing spon-\ntaneous associations between wireless devices. In Proc.\n6th Information Security Conference (ISC\u201903), pages 44\u201353.\nSpringer, October 2003.\n[11] T. Kindberg, K. Zhang, and N. Shankar. Context authenti-\ncation using constrained channels. In Proc. IEEE Workshop\non Mobile Computing Systems and Applications (WMCSA),\npages 14\u201321. IEEE Computer Society, June 2002.\n[12] R. Mayrhofer, H. Gellersen, and M. Hazas. An authenti-\ncation protocol using ultrasonic ranging. Technical Report\nCOMP-002-2006, Lancaster University, October 2006.\n[13] M. Minami, Y. Fukuju, K. Hirasawa, S. Yokoyama,\nM. Mizumachi, H. Morikawa, and T. Aoyama. DOLPHIN:\na practical approach for implementing a fully distributed\nindoor ultrasonic positioning system. In Proc. of Ubi-\ncomp 2004, pages 347\u2013365, Nottingham, UK, Sept. 2004.\nSpringer.\n[14] N. Priyantha, A. Chakraborty, and H. Balakrishnan. The\ncricket location-support system. In Proc. ACM MobiCom\n\u201900, August 2000.\n"}