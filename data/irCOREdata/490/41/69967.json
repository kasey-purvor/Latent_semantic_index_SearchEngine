{"doi":"10.1017\/S0305004101005709","coreId":"69967","oai":"oai:eprints.lancs.ac.uk:19284","identifiers":["oai:eprints.lancs.ac.uk:19284","10.1017\/S0305004101005709"],"title":"Order preserving limits of finite-dimensional nest algebras.","authors":["Hopenwasser, Alan","Power, Stephen C."],"enrichments":{"references":[{"id":16323819,"title":"A complete isomorphism invariant for a class of triangular UHF algebras.","authors":[],"date":"1992","doi":null,"raw":"Y.-T. Poon. A complete isomorphism invariant for a class of triangular UHF algebras. J. Operator Theory 27 (1992), 221{230.","cites":null},{"id":16323803,"title":"Algebraic orders and chordal limit algebras.","authors":[],"date":"1998","doi":"10.1017\/s0013091500019830","raw":"A. P. Donsig. Algebraic orders and chordal limit algebras. Proc. Edinburgh Math. Soc. 41 (1998), 465{485.","cites":null},{"id":16323822,"title":"Algebraic orders on K0 and approximately  operator algebras.","authors":[],"date":"1992","doi":null,"raw":"S. C. Power. Algebraic orders on K0 and approximately nite operator algebras. J. Operator Theory 27 (1992), 87{106.","cites":null},{"id":16323816,"title":"Classi of limits of upper triangular matrix algebras.","authors":[],"date":"1992","doi":"10.1017\/s0013091500005927","raw":"A. Hopenwasser and S. C. Power. Classication of limits of upper triangular matrix algebras. Proc. Edinburgh Math. Soc. 36 (1992), 107{121.","cites":null},{"id":16323820,"title":"Classi of tensor products of triangular operator algebras.","authors":[],"date":"1990","doi":"10.1112\/plms\/s3-61.3.571","raw":"S. C. Power. Classication of tensor products of triangular operator algebras. Proc. London Math. Soc. 61 (1990), 571{614.","cites":null},{"id":16323806,"title":"Homology for operator algebras IV.","authors":[],"date":"1997","doi":"10.1006\/jfan.1997.3118","raw":"A. P. Donsig and S. C. Power. Homology for operator algebras IV. J. Func. Anal. 150 (1997), 240{287.","cites":null},{"id":16323823,"title":"Limit algebras: An introduction to subalgebras of C -algebras.","authors":[],"date":null,"doi":"10.1007\/1-84628-490-2_5","raw":"S. C. Power. Limit algebras: An introduction to subalgebras of C -algebras. Pitman Research","cites":null},{"id":16323811,"title":"On a certain class of operator algebras.","authors":[],"date":"1960","doi":"10.1090\/s0002-9947-1960-0112057-5","raw":"J. Glimm. On a certain class of operator algebras. Trans. Amer. Math. Soc. 95 (1960), 318{340.","cites":null},{"id":16323809,"title":"On the classi of inductive limits of sequences of semisimple  algebras.","authors":[],"date":"1976","doi":"10.1016\/0021-8693(76)90242-8","raw":"G. A. Elliott. On the classication of inductive limits of sequences of semisimple nitedimensional algebras. J. Algebra 38 (1976), 29{44.","cites":null},{"id":16323813,"title":"On the uniqueness of AF diagonals in regular limit algebras.","authors":[],"date":null,"doi":"10.1006\/jfan.2002.3972","raw":"P. A. Haworth and S. C. Power. On the uniqueness of AF diagonals in regular limit algebras. J. Funct. Anal., to appear.","cites":null},{"id":16323804,"title":"Order preservation in limit algebras.","authors":[],"date":"1995","doi":"10.1006\/jfan.1995.1129","raw":"A. P. Donsig and A. Hopenwasser. Order preservation in limit algebras. J. Func. Anal. 133 (1995), 342{394.","cites":null},{"id":16323817,"title":"Subalgebras of groupoid C -algebras.","authors":[],"date":"1989","doi":"10.1017\/s1446788700000392","raw":"P. S. Muhly and B. Solel. Subalgebras of groupoid C -algebras. J. Reine Angew. Math. 402 (1989), 41{75.","cites":null},{"id":16323807,"title":"The classi of limits of 2n-cycle algebras.","authors":[],"date":"1999","doi":"10.1512\/iumj.1999.48.1688","raw":"A. P. Donsig and S. C. Power. The classication of limits of 2n-cycle algebras. Indiana Univ. Math. J. 48 (1999), 411{127.","cites":null},{"id":16323821,"title":"The classi of triangular subalgebras","authors":[],"date":"1990","doi":null,"raw":"S. C. Power. The classication of triangular subalgebras of AF C -algebras. Bull. London Math. Soc. 22 (1990), 269{272.","cites":null},{"id":16323805,"title":"The failure of approximate inner equivalence of standard diagonals in regular limits of digraph algebras.","authors":[],"date":"1996","doi":"10.4153\/cmb-1996-050-5","raw":"A. P. Donsig and S. C. Power. The failure of approximate inner equivalence of standard diagonals in regular limits of digraph algebras. Bull. Can. Math. Soc. 39 (1996), 420{428.","cites":null},{"id":16323818,"title":"Triangular AF algebras.","authors":[],"date":"1990","doi":"10.1090\/pspum\/051.2\/1077445","raw":"J. R. Peters, Y.-T. Poon and B. H. Wagner. Triangular AF algebras. J. Operator Theory 23 (1990), 81{114.","cites":null},{"id":16323802,"title":"Triangular UHF algebras.","authors":[],"date":"1990","doi":"10.1016\/0022-1236(90)90052-m","raw":"R. L. Baker. Triangular UHF algebras. J. Func. Anal. 91 (1990), 182{212.","cites":null},{"id":16323815,"title":"Uniformly T2 algebras in approximately  C -algebras.","authors":[],"date":"1997","doi":"10.1112\/s0024610796004589","raw":"D. Hefferman. Uniformly T2 algebras in approximately nite-dimensional C -algebras. J. London Math. Soc. 55 (1997), 181{192.108 Alan Hopenwasser and Stephen Power","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2002-07-01","abstract":"We introduce order conserving embeddings as a more general form of order preserving embeddings between finite dimensional nest algebras. The structure of these embeddings is determined, in terms of order indecomposable decompositions, and they are shown to be determined up to inner conjugacy by their induced maps on K0. Classifications of direct systems and limit algebras are obtained in terms of dimension distribution groups","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/69967.pdf","fullTextIdentifier":"http:\/\/eprints.lancs.ac.uk\/19284\/1\/download.pdf","pdfHashValue":"a70578edd4cfa5d89adb2abebfa0353f7d81ab46","publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lancs.ac.uk:19284<\/identifier><datestamp>\n      2018-01-24T02:31:22Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D51:5141<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        Order preserving limits of finite-dimensional nest algebras.<\/dc:title><dc:creator>\n        Hopenwasser, Alan<\/dc:creator><dc:creator>\n        Power, Stephen C.<\/dc:creator><dc:subject>\n        QA Mathematics<\/dc:subject><dc:description>\n        We introduce order conserving embeddings as a more general form of order preserving embeddings between finite dimensional nest algebras. The structure of these embeddings is determined, in terms of order indecomposable decompositions, and they are shown to be determined up to inner conjugacy by their induced maps on K0. Classifications of direct systems and limit algebras are obtained in terms of dimension distribution groups.<\/dc:description><dc:date>\n        2002-07-01<\/dc:date><dc:type>\n        Journal Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:relation>\n        http:\/\/dx.doi.org\/10.1017\/S0305004101005709<\/dc:relation><dc:identifier>\n        Hopenwasser, Alan and Power, Stephen C. (2002) Order preserving limits of finite-dimensional nest algebras. Mathematical Proceedings of the Cambridge Philosophical Society, 133 (1). pp. 77-108. ISSN 0305-0041<\/dc:identifier><dc:relation>\n        http:\/\/eprints.lancs.ac.uk\/19284\/<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/dx.doi.org\/10.1017\/S0305004101005709","http:\/\/eprints.lancs.ac.uk\/19284\/"],"year":2002,"topics":["QA Mathematics"],"subject":["Journal Article","PeerReviewed"],"fullText":"Math. Proc. Camb. Phil. Soc. (2002), 133, 77 c\u00a9 2002 Cambridge Philosophical Society\nDOI: 10.1017\/S0305004101005709 Printed in the United Kingdom\n77\nLimits of \fnite dimensional nest algebras\nBy ALAN HOPENWASSER\u2020\nDepartment of Mathematics, University of Alabama, Tuscaloosa, AL 35487, U.S.A.\ne-mail: ahopenwa@euler.math.ua.edu\nand STEPHEN C. POWER\u2021\nDepartment of Mathematics and Statistics, Lancaster University,\nLancaster LA1 4YF.\ne-mail: s.power@lancaster.ac.uk\n(Received 23 June 2000; revised 9 November 2000)\nAbstract\nWe introduce order conserving embeddings as a more general form of order pre-\nserving embeddings between finite dimensional nest algebras. The structure of these\nembeddings is determined, in terms of order indecomposable decompositions, and\nthey are shown to be determined up to inner conjugacy by their induced maps on\nK0. Classifications of direct systems and limit algebras are obtained in terms of\ndimension distribution groups.\n1. Introduction\nOne of the major themes in the study of direct systems of operator algebras is\nthe classification of such systems and their limit algebras. Since universal results are\nlargely out of reach and inappropriate to specific families, the usual approach is to\nstudy families of systems which are simultaneously tractable and of intrinsic interest\nand, for each such family, to find a complete set of invariants (up to a suitable notion\nof isomorphism). The selection of a family for classification entails the specification\nof a family of (usually finite dimensional) \u2018building block\u2019 algebras and a class of\nallowable embeddings between the building block algebras. One desirable goal in the\noverall process is to achieve greater unification of the various classifying invariants.\nThe first example of this scheme was Glimm\u2019s classification of UHF\nC\u2217-algebras (building blocks: full matrix algebras (Mn(C)); embeddings: unital\n\u2217-homomorphisms; complete invariants: the supernatural number) [8]. This was\neventually superseded by the Elliott\u2019s classification of AF C\u2217-algebras (building\nblocks: finite dimensional C\u2217-algebras; embeddings: \u2217-homomorphisms; complete\ninvariants: dimension groups) [7].\nResearchers in C\u2217-algebras have proceeded to the study of direct systems of\nC\u2217-algebras which are not finite dimensional; researchers in non-self-adjoint algebras\n\u2020 Supported by an EPSRC visiting fellowship to Lancaster University.\n\u2021 Supported by an EPSCoR of Alabama travel grant to visit the University of Alabama.\n78 Alan Hopenwasser and Stephen Power\nhave discovered that for systems of finite dimensional (non-self-adjoint) operator\nalgebras the limit algebras are highly dependent on both the choice of building\nblock algebra and the choice of admissible embeddings and that the variety of limits\nwhich appear is exceptionally large. Given the central role that triangular operator\nalgebras play in the theory of non-self-adjoint operator algebras, it is not surprising\nthat the best understood limits in that domain are those for which the building block\nalgebras are drawn from the family of full upper triangular matrix algebras (Tn).\nIndeed, the first non-self-adjoint classification results were obtained for direct\nlimits of Tn with refinement and with standard embeddings [1, 13, 15]. This was\nsoon followed by the classification of alternation algebras [11, 14].\nThese three families are subsumed by the family of direct systems in which the\nbuilding blocks are Tn and the embeddings are order preserving, star extendible\nhomomorphisms. Order preservation, which has its roots in [12, 17], was analysed\nin great detail in [3] for the Tn context (and for direct sums thereof ); in particular,\na complete, albeit complicated, classification was given for order preserving limits of\nfull upper triangular matrix algebras.\nAt a greater level of generality, triangular subalgebras of AF C\u2217-algebras, with the\ndiagonal a canonical (Cartan) masa in the C\u2217-algebra, have played a major role in\nthe theory of limit algebras. In particular, the spectrum (originally called the funda-\nmental relation) serves as a complete invariant for these TAF algebras [16, 18]. A\nmuch broader class of similarly coordinatised algebras is obtained by permitting the\nbuilding block algebras to be digraph algebras (including non-triangular algebras).\nAmongst these, a number of subclasses have proven to be classifiable in terms of\nscaled abelian groups. A notable example is the family of 2n-cycle algebras, which\nare of particular interest since these are the simplest operator algebras with non-\ntrivial homology. With rigid star extendible embeddings, these have been classified\nin [5, 6, 19].\nLike triangular algebras, nest algebras have played a critical role, since its incep-\ntion, in the theory of non-self-adjoint algebras. This paper is devoted to a study of\ndirect systems in which the building blocks are finite dimensional nest algebras. For\ninvariants, we turn to the Grothendieck dimension distribution groups, which were\nfirst developed in [20]. These will be denoted by G. This invariant reduces to K0 in\nthe C\u2217-algebra context and to a dual form of the spectrum in the TAF algebra con-\ntext. Dimension distribution groups, augmented as necessary by various ancillary\nstructures, form an effective invariant for additional families of systems \u2013 as we shall\nsee with finite dimensional nest algebras \u2013 and help unify the classification of direct\nsystems and of limit algebras.\nIt is, however, necessary to restrict the class of admissible embeddings between\nfinite dimensional nest algebras in order to obtain classification theorems in these\nterms. We shall show that concepts of order preservation and conservation give\nrise to diverse embeddings which are tractable in this way. Order preservation for\nembeddings is defined in terms of order preservation for isometries; in [2], Donsig\nextended these concepts from the Tn context to the digraph algebra context. The\ndefinitions are made with respect to a self-adjoint subalgebra of the original algebra;\nin the triangular case the diagonal is the only reasonable choice for this subalgebra.\nWhen A is a finite dimensional nest algebra, A w A\u2217 is a natural choice for this\nsubalgebra; we adopt Donsig\u2019s definition in the context of this paper.\nLimits of nest algebras 79\nWe shall find, however, that critical preliminary theorems (K0-uniqueness and\nG-lifting) are valid for broader classes of embeddings and so classification can be\nachieved beyond the realm of order preserving systems. A related concept, order\nconservation, is central for this extension. The reason this new concept appears for\nfinite dimensional nest algebras, and did not appear for Tn, is that the diagonal order\non projections is not anti-symmetric in the former context as it is in the latter. With\nthe understanding that we consider only regular partial isometries (see Section 2),\nwe define an order preserving partial isometry to be one for which conjugation by\nthe partial isometry preserves the diagonal order (p \u00b9 q if, and only if, vpv\u2217 \u00b9\nvqv\u2217, where p and q are subprojections of the initial space of the normalizing partial\nisometry v). We define order conserving partial isometries to be ones which respect,\nbut do not necessarily preserve, the diagonal order (in the sense that p \u227a q and\nvqv\u2217 \u227a vpv\u2217 cannot simultaneously hold). In the Tn context, these two concepts\ncoincide. But for finite dimensional nest algebras in which at least some of the atoms\nhave rank greater than one, the order preserving partial isometries form a proper\nsubset of the order conserving partial isometries.\nOrder preserving embeddings are defined to be those embeddings which map order\npreserving partial isometries to order preserving partial isometries. Similarly, order\nconserving embeddings map order conserving partial isometries to order conserving\npartial isometries. In the Tn context, these two families of embeddings coincide. In\ngeneral, however, neither family contains the other. Examples illustrating these facts\nare given at the end of Section 3.\nThere are local variants of these concepts which are of importance. An embed-\nding is locally order preserving if it maps rank one (regular) partial isometries to\norder preserving partial isometries and is locally order conserving if it maps rank\none (regular) partial isometries to order conserving partial isometries. Clearly, each\nproperty implies its local variant; furthermore, local order preservation implies local\norder conservation (since order preserving partial isometries are order conserving).\nThe following summarizes these relationships:\nOP =\u21d2 LOP =\u21d2LOC\nOC =\u21d2LOC\nThus, the locally order conserving embeddings form the broadest family, contain-\ning all the other families. Happily, two properties essential for dimension distribu-\ntion group classification, K0-uniqueness and G-lifting, are valid for all locally order\nconserving embeddings (see Theorems 3\u00b72 and 5\u00b72). These relationships and facts\nindicate the importance of a purview broader than order preservation.\nBased on these results, we prove that the dimension distribution group, together\nwith ancillary structures, is a complete invariant for systems of finite dimensional\nnest algebras of four types, one for each preservation\/conservation property. The\nclassification is up to regular isomorphism of the appropriate preservation\/\nconservation type (see Theorems 5\u00b76\u20135\u00b79).\nThe classification of operator algebra direct limits involves substantial technical\ndifficulties and has been deferred. However, for algebraic direct limits (locally finite\nalgebras), we obtain two classification theorems \u2013 one for limits of order preserving\nsystems using the dimension distribution group and an order preserving scale and\n80 Alan Hopenwasser and Stephen Power\none for limits of order conserving systems using the dimension distribution group\nand an order conserving scale (see Theorems 5\u00b710 and 5\u00b711).\nWe now briefly indicate related classification schemes for nontriangular limit\nalgebras. For nest algebras with just two atoms, star extendible embeddings are\nautomatically order conserving (although not necessarily order preserving). The cor-\nresponding T2-limit algebrasAwere classified in [10, 17] in terms of an augmentation\nof K0 data by a binary relation on \u03a30(A)\u00d7 \u03a30(A) where \u03a30(A) is the K0 scale of A.\nAlso, Donsig [2] has obtained a complete classification of order preserving limits\nof general finite dimensional nest algebras (and more general chordal algebras) by\nmeans of a ternary relation augmentation of K0 data. On the other hand, away from\norder conservation, in [21] Tr-limit algebras, with general star extendible embed-\ndings, are classified in terms of metrized dimension module invariants.\nHere is a guide to the four remaining sections of this paper. Section 2 discusses\nregular embeddings between finite dimensional nest algebras. In particular, we show\nthat local regularity implies regularity in the finite dimensional nest algebra context.\nThis result is not valid for general digraph algebras.\nSection 3 introduces the various concepts of order preservation and order conser-\nvation. The K0-uniqueness theorem for locally order conserving embeddings is\nproven. This is a stronger result than we actually need for classification; G-uniqueness\nwould suffice. This section also contains a digression (which the reader interested\nsolely in classification may skip) into the structure of order conserving embeddings.\nWe obtain a result (Corollary 3\u00b710) analogous to the theorem in [3] which states that\nan order preserving embedding in the Tn context is an ordered sum of refinement\nembeddings. For this purpose, we need to introduce refinement type embeddings\n(a generalization of refinement embeddings) and T2-degenerate embeddings, which\nare trivially order conserving but may not be of refinement type. Curiously, in or-\nder for the theorem to be valid, we must assume that every atom of the domain\nalgebra has rank two or greater. Thus, a structure theorem for order conserving\nembeddings is available when all atoms have rank one or when all atoms have rank\ngreater than one. For the case with mixed rank one and multi-rank atoms, we show\nby counterexample that the theorem is false. (A study of examples suggests that\nsome sort of general structure theorem is valid, but that the basic order irreducible\ntypes are sufficiently complicated and special that such a theorem may be of dubious\ninterest.)\nSection 4 studies isomorphism of the various systems of interest. To obtain classi-\nfications of the algebraic limits up to star extendible isomorphism we require the\nresult that a general star extendible isomorphism between the limit algebras of\nlocally order conserving systems necessarily derives from a regular isomorphism\nbetween the given systems (Theorem 4\u00b73). This guarantees that our invariants for\nlimit algebras are well-defined. Moreover, we refine this result (in Theorem 4\u00b74) to\nenable the formulation of invariants defined in terms of order preserving or order\nconserving maps (rather than regular maps).\nSection 5 gives a brief introduction to partial isometry dimension distribution\ngroups. For more detail, the reader is referred to [20]. The G-lifting theorem for\nlocally order conserving embeddings is proven (and yields G-lifting for all the other\ntypes of embeddings) and various scales are defined for dimension distribution groups.\nThe six classification theorems described earlier in the Introduction are proven and\nLimits of nest algebras 81\nthe section concludes with several examples. Readers may wish to glance at these\nexamples before perusing the whole paper.\n2. Regular and locally regular embeddings\nA finite dimensional nest algebra is a unital operator algebra A in Mn = Mn(C)\nwhich has a block upper triangular form with respect to an ordered decomposition\nof the identity as an orthogonal sum of projections: 1 = q1 + q2 + \u00b7 \u00b7 \u00b7 + ql. Such an\nalgebra A consists of all those operators a in Mn for which (1 \u2212 f )af = 0 for all\nprojections f = q1 + \u00b7 \u00b7 \u00b7 + qk, 1 6 k 6 l. The projections f , together with the zero\nprojection, form the invariant projection nest for A, while the projections qi are the\natomic interval projections of A.\nThe nest algebra A induces, through its atomic interval projections, a block struc-\nture on Mn whereby each matrix v in Mn can be viewed as an l \u00d7 l block matrix\nv = (vij) where vij = qivqj . The elements of the nest algebra are precisely the block\nupper triangular matrices with respect to this block structure. Unless some other\nblock structure is explicitly specified, it will always be assumed that elements of a\nnest algebra have the block structure natural to the nest.\nDefinition 2\u00b71. A partial isometry v in Mn is said to be regular with respect to a\nblock structure if each block matrix entry is a partial isometry.\nNote that any two block matrix entries in the same row of a regular partial iso-\nmetry have orthogonal final spaces and any two block matrices in the same column\nhave orthogonal initial spaces.\nDefinition 2\u00b72. A partial isometry v in a finite dimensional C*-algebra is said to be\nstandard, with respect to a matrix unit system if it is a sum of some of these matrix\nunits.\nNote that if a partial isometry is standard with respect to a matrix unit system,\nthen it is regular with respect to any block structure compatible with that matrix\nunit system.\nAn algebra homomorphism \u03c6 : A1 \u2192 A2 between two non-self-adjoint operator\nalgebras is said to be star extendible if it is the restriction of a star algebra homo-\nmorphism \u03c6\u02dc between the generated C*-algebras. Plainly, \u03c6\u02dc is uniquely determined\nby \u03c6. In the next definition and throughout the paper we confine attention to such\nstar-extendible homomorphisms.\nDefinition 2\u00b73. Let \u03c6 : A1 \u2192 A2 be a star-extendible homomorphism between finite\ndimensional nest algebras. Then \u03c6 is said to be regular if \u03c6 is a direct sum of multi-\nplicity one embeddings. Also, \u03c6 is locally regular if \u03c6(v) is a regular partial isometry\nin A2 whenever v is a regular partial isometry in A1.\nRemarks. If \u03c6 is a regular embedding then \u03c6 is locally regular. We prove the con-\nverse in Theorem 2\u00b74 below. Although the definition above makes sense for maps\nbetween digraph algebras it is not generally true that local regularity is equivalent\nto regularity. For example, consider the algebra E \u2286 T3 which is spanned by all\nthe matrix units of T3 except e23. Then one can verify that every star extendible\nmap \u03c6 : E \u2192 E \u2297Mn for n > 2 is locally regular, and yet there are irregular (i.e.\nnonregular) embeddings. See also the 4-cycle algebra example [6, example 2\u00b72].\n82 Alan Hopenwasser and Stephen Power\nIn order to show that a star extendible map \u03c6 is locally regular, it is sufficient to\nshow that \u03c6(v) is a regular partial isometry in A2 whenever v is a rank one regular\npartial isometry in A1. To see this, let Q\u02dc1, . . . , Q\u02dcm be the atomic interval projections\nof A1 and Q1, . . . , Qn the atomic interval projections of A2. Let v be a regular partial\nisometry in A1. Then vij = Q\u02dcivQ\u02dcj is a partial isometry, for all i and j. Each vij , in\nturn, can be written a sum of rank one partial isometries each of which has the form\nw = Q\u02dciwQ\u02dcj . Thus, we may write v as a sum, v1 + \u00b7 \u00b7 \u00b7 + vp say, of rank one regular\npartial isometries.\nSince \u03c6 is star extendible, \u03c6(v) = \u03c6(v1) + \u00b7 \u00b7 \u00b7 + \u03c6(vp) is a partial isometry and, by\nhypothesis, each \u03c6(vi) is a regular partial isometry in A2. From this we may conclude\nthat the set of initial projections of the \u03c6(vi) are pairwise orthogonal, the set of final\nprojections of the \u03c6(vi) are pairwise orthogonal, and both the initial projection and\nthe final projection of each \u03c6(vi) commute with each atom Qt. The last statement\nfollows from the fact that every Qs\u03c6(vi)Qt is a partial isometry.\nIt now follows that, for all s and t, the set of initial projections of the elements\nQs\u03c6(vi)Qt (i = 1, . . . , p) are pairwise orthogonal; the same is true for the set of\nfinal projections. Consequently, Qs\u03c6(v)Qt = Qs\u03c6(v1)Qt + \u00b7 \u00b7 \u00b7+Qs\u03c6(vp)Qt is a partial\nisometry. Since this is true for all s and t, we see that \u03c6(v) is regular in A2 and that\n\u03c6 is locally regular.\nWe may, in fact, go a little further than reducing local regularity to the action\nof \u03c6 on rank one regular partial isometries. If {eij} is a matrix unit system in A1\ncompatible with the block matrix structure of A1 and if \u03c6(eij) is regular in A2 for all\neij , then \u03c6 is locally regular.\nIf \u03c6 is locally regular and {eij} is a matrix unit system compatible with A1, then\nfor each matrix unit eij there is a matrix unit system for A2 with respect to which\n\u03c6(eij) is a sum of matrix units; i.e. \u03c6(eij) is standard. If, moreover, there is a single\nmatrix unit system forA2 with respect to which all \u03c6(eij) are standard, then it follows\nthat \u03c6 is regular. Obtaining such a system will be the strategy for the proof of the\nfollowing theorem.\nTheorem 2\u00b74. Let \u03c6 : A1 \u2192 A2 be a star extendible homomorphism between finite\ndimensional nest algebras. If \u03c6 is locally regular then \u03c6 is regular.\nProof. The nest algebra A2 and the C\u2217-algebra it generates have an r \u00d7 r block\nstructure induced by the r atoms in the nest for A2. In this block structure, the\ndiagonal blocks are square matrices of varying size and the off-diagonal blocks are\nrectangular. Elements of A2 and C\u2217(A2) will be written as r \u00d7 r matrices, v = (vst),\n1 6 s, t 6 r, where each vst is a matrix of appropriate size.\nWe may assume that A1 = Tn. Consider the star algebra extension of \u03c6. This is an\nalgebra injection \u03c6 : Mn \u2192 C\u2217(A2) such that the image of each standard matrix unit\nof Mn is a regular partial isometry. We wish to show that \u03c6 is regular with respect\nto the r by r block structure. By the remarks above this is equivalent to showing the\nfollowing with vij = \u03c6(eij).\nLet vij = (vijst),with 1 6 s, t 6 r, 1 6 i, j 6 n, be a matrix unit system for a\nsubalgebra of C\u2217(A2) which is isomorphic to Mn. Suppose moreover that each vij is\nregular with respect to the r by r block structure, so that each block matrix entry\nvijst of each v\nij is itself a partial isometry. We show that there is a matrix unit system\nLimits of nest algebras 83\nfor C\u2217(A2), which consists of (rank one) regular partial isometries, such that each vij\nis a sum of some of these matrix units.\nTo see this consider first a product vijvjk. The 1, 1 block entry is given by the sum\nvij11v\njk\n11 + v\nij\n12v\njk\n21 + \u00b7 \u00b7 \u00b7 + vij1rvjkr1 .\nSince vij is regular, the partial isometries vij11, . . . , v\nij\n1r have orthogonal range projec-\ntions and so the operators of the sum have orthogonal range projections. For similar\nreasons the domain projections are pairwise orthogonal. (We are not assuming here\nthat these products are partial isometries.) Since, by hypothesis, the product vijvjk\nis a regular partial isometry, it follows that the sum above is a partial isometry,\nand therefore, by the orthogonality of domain and range projections, each of the\nindividual products\nvij11v\njk\n11 , v\nij\n12v\njk\n21 , . . . , v\nij\n1rv\njk\nr1\nis a partial isometry.\nNow, since, for example, vij11v\njk\n11 is a partial isometry it follows that the range\nprojection of vjk11 commutes with the domain projection of v\nij\n11. Abusing notation\nsomewhat, and regarding the entry operators vijst as identified with operators in\nC\u2217(A2), it follows, by considering other block entries, that for all i, j, k, l, s, t, u, v the\nrange projection of vijst commutes with the domain projection of v\nkl\nuv. Note also that\nthe domain projections and the range projections commute amongst themselves.\nFurthermore it is clear that these projections commute with the projections in the\ncentre of the block diagonal subalgebra of C\u2217(A2). Choose now a maximal family of\nrank one projections p which commute with all these projections and are dominated\nby v\u221711v11. Then for each such projection the set of operators wij = v\ni1pv1j satisfy\nthe relations of a matrix unit system. The projections P = \u03a3ivi1pv1i are pairwise\northogonal and decompose \u03c6 as a direct sum of multiplicity one embeddings, as\ndesired.\n3. Order conserving and order preserving embeddings\nIn this section we define order conserving and locally order conserving star ex-\ntendible embeddings of finite dimensional nest algebras. We show that these em-\nbeddings are classified up to inner conjugacy by K0 and we make use of this in the\nclassifications of Section 5. This inner conjugacy classification can also be viewed as\na classification of those subalgebras A1 of a fixed nest algebra A2 where A1 is a nest\nalgebra in C\u2217(A1) and where the inclusion of A1 is an order conserving inclusion.\nIn [3], it is shown that unital order preserving embeddings in the Tn context are\ndirect sums of refinement embeddings. We will extend this result (slightly) to non-\nunital embeddings and will obtain an analogous decomposition for order conserving\nembeddings between nest algebras, provided that all atoms in the domain algebra\nhave rank greater than one. The decomposition of \u03c6 will be into an ordered sum of\norder irreducible embeddings of two basic types to be defined below.\nIn this paper we consider a general finite dimensional operator algebra A to be a\nnest algebra if it is star extendibly isomorphic to a nest algebra. This means that the\ngenerated C\u2217-algebra C\u2217(A) is isomorphic to Mp for some p and A is a nest algebra\nin C\u2217(A).\nDefinition 3\u00b71. Let A \u2286Mn be a finite dimensional nest algebra with atomic inter-\nval projections q1, q2, . . . , ql.\n84 Alan Hopenwasser and Stephen Power\n(1) The set Pisomreg(A) is the set of regular partial isometries with respect to the\nblock structure from q1, . . . , ql.\n(2) The set Pisomoc(A) denotes the subset of Pisomreg(A) consisting of order con-\nserving partial isometries v; that is, those for which\nqivqj\u0010 0 =\u21d2 qsvqt = 0, for s < i and t > j.\n(3) A star extendible embedding between finite dimensional nest algebras is order\nconserving if it maps order conserving partial isometries to order conserving\npartial isometries.\n(4) An embedding \u03c6 : A1 \u2192 A2 is locally order conserving if \u03c6(v) \u2208 Pisomoc(A2) for\neach rank one element v in Pisomreg(A1).\nIf v \u2208 Pisomreg(A) and rank v = 1 then v \u2208 Pisomoc(A). It follows from this obser-\nvation, the remarks following Definition 2\u00b73, and Theorem 2\u00b74 that a locally order\nconserving embedding between finite dimensional nest algebras is automatically a\nregular embedding.\nIn particular, order conserving star extendible embeddings are regular star ex-\ntendible embeddings and so admit decompositions as direct sums of multiplicity one\nembeddings.\nFor an explicit example of an order conserving embedding consider the map \u03c6\nfrom T (2, 2, 2) to T (6, 8, 10) given by\n\uf8ee\uf8f0a x zb y\nc\n\uf8f9\uf8fb \u2212\u2192\n\uf8ee\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\na x z\na x z\nb y\nb y\nc\nc\na x z\na x z\nb y\nb y\nc\nc\n\uf8f9\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb\n.\nThis map has an order irreducible ordered sum decomposition \u03c61 +\u03c62 +\u03c63 where \u03c61 is\na multiplicity 2 map, with range dominated by the sum of the first two atoms of the\ncodomain algebra, and \u03c62 and \u03c63 are multiplicity one embeddings. The summands\nhere are all of T2-degenerate type (in the sense below).\nIn general, the order conserving partial isometries in A are those regular partial\nisometries whose block matrix supports have a staircase form, such as\uf8ee\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\n\u2217 \u2217 \u2217 0 0 0\n0 \u2217 0 0 0\n\u2217 \u2217 \u2217 0\n0 \u2217 0\n\u2217 \u2217\n\u2217\n\uf8f9\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb .\nLimits of nest algebras 85\nTheorem 3\u00b72. Let A1 be a finite dimensional nest algebra. Let \u03c6 and \u03c8 be two locally\norder conserving regular embeddings of A1 into a second finite dimensional nest algebra,\nA2. Then \u03c6 and \u03c8 are inner conjugate if, and only if, K0(\u03c6) = K0(\u03c8).\nProof. We first prove the theorem for the special case in which every atom of A1\nhas rank one (i.e. A1 is some Tn). Select a matrix unit system for C\u2217(A1) compatible\nwith A1; for each pair of (rank one) atoms s and r, let m(s, r) denote the matrix unit\nwith initial projection r and final projection s. Note that K0(\u03c6) is a matrix whose\ncolumns are indexed by the atoms of A1 and whose rows are indexed by the atoms\nof A2. The entry in the column indexed by the atom r of A1 and the row indexed\nby the atom Q of A2 is the non-negative integer rank\u03c6(r)Q. We assume the order of\nthe rows and columns of this matrix reflect the usual \u227a ordering of the atoms of A1\nand A2.\nLet r be an atom of A1 with the property that the first non-zero entry in the\ncolumn of K0(\u03c6) indexed by r is less than or equal to the first non-zero entry in any\nother column. Let Q be the atom which indexes the row containing the first non-\nzero entry in column r. Now assume that s is some other atom of A1. First, assume\ns \u227a r. Let P be the atom of A2 which gives the first non-zero entry in column s.\nLet Er = \u03c6(r)Q and Fs = \u03c6(s)P . The fact that \u03c6 is locally order conserving ensures\nthat \u03c6(m(s, r))Er\u03c6(m(s, r))\u2217 6 Fs. To see this note that for an appropriate choice of\nmatrix units in A2, \u03c6(m(s, r)) induces an order conserving bijection from the rank\none matrix unit subprojections of \u03c6(r) to the rank one matrix unit subprojections of\n\u03c6(s). Since Er and Fs correspond to the first block occurrences of these matrix unit\nprojections and since, by the choice of r, Fs has at least as many of them as Er, it\nfollows that \u03c6(m(s, r)) conjugates Er to a subprojection of Fs.\nLet Es = \u03c6(m(s, r))Er\u03c6(m(s, r))\u2217. If r \u227a s, we argue in a similar fashion to obtain\na projection Es which is a subprojection of the index atom for the row containing\nthe first non-zero entry in column s and which satisfies Er = \u03c6(m(r, s))Es\u03c6(m(r, s))\u2217.\nThe fact that \u03c6 is an embedding implies that, for any two atoms s \u227a s\u2032, Es =\n\u03c6(m(s, s\u2032))Es\u2032\u03c6(m(s, s\u2032))\u2217.\nNote that if s and s\u2032 are distinct atoms of A1, then the projections Es and Es\u2032 are\northogonal. This is true even if Es and Es\u2032 are subprojections of the same atom of\nA2, since Es 6 \u03c6(s), Es\u2032 6 \u03c6(s\u2032) and \u03c6(s) and \u03c6(s\u2032) are orthogonal projections.\nLet P1 =\n\u2211\nsEs, where the sum runs over all atoms of A1. Let \u03c61 = P1\u03c6P1. It\nfollows from the way that \u03c61 is defined that \u03c61 and (1\u2212P1)\u03c6(1\u2212P1) are locally order\nconserving embeddings of A1 into A2 and that \u03c6 = \u03c61 + (1\u2212P1)\u03c6(1\u2212P1). The reason\nthat \u03c61 and (1 \u2212 P1)\u03c6(1 \u2212 P1) are locally order conserving is that any subpartial\nisometry of an order conserving partial isometry which is obtained by left and right\nmultiplication by a block diagonal projection is again order conserving. Note that\nK0((1\u2212 P1)\u03c6(1\u2212 P1)) is obtained from K0(\u03c6) by subtracting from the first non-zero\nentry in each column of K0(\u03c6) the integer in column r, row Q.\nSince K0(\u03c8) = K0(\u03c6), we may construct a projection P\n\u03c8\n1 which has the same\nproperties with respect to \u03c8 that P1 has with respect to \u03c6. P\n\u03c8\n1 is a sum of projections,\none for each atom of A1; the projection in the sum associated with an atom s has the\nsame rank as Es and is a subprojection of the same atom of A2 as Es. Consequently,\nthere is a unitary element of the diagonal A2 w A\u22172 such that if \u03c8\u02dc = u\n\u2217\u03c8u, then\nP1\u03c6P1 = P1\u03c8\u02dcP1 and (1\u2212 P1)\u03c8\u02dc(1\u2212 P1) is an embedding.\n86 Alan Hopenwasser and Stephen Power\nWe may now repeat this procedure with the two embeddings, (1 \u2212 P1)\u03c6(1 \u2212 P1)\nand (1\u2212P1)\u03c8\u02dc(1\u2212P1). When we do so, we obtain a projection P2 which is orthogonal\nto P1 and an embedding \u03c8\u02c6 which is inner conjugate to \u03c8 such that P2\u03c6P2 = P2\u03c8\u02c6P2.\nFurthermore, because we are really working in essence on 1\u2212 P1, we can select the\nunitary which implements the conjugacy so that it is the identity on P1. With this\ndone, we also have P1\u03c6P1 = P1\u03c8\u02c6P1 and hence (P1 +P2)\u03c6(P1 +P2) = (P1 +P2)\u03c8\u02c6(P1 +P2).\nIt is now clear that if we continue in this fashion, after finitely many steps we obtain\nan inner conjugacy between \u03c6 and \u03c8.\nSlight modifications of the argument given above yield the proposition when A1\nis a general finite dimensional nest algebra. Alternatively, we can deduce the gen-\neral version of the proposition from the special case above by the following \u2018general\nprinciples\u2019 technique. If A1 is a general nest algebra, select a subalgebra B of A1\nwhich is isomorphic to some Tn such that each block of A1 w A\u22171 corresponding to\nan atom of A1 contains exactly one rank one diagonal projection from B. Note\nthat A1 is the algebra generated by B and A1 w A\u22171 . Let \u03c6 and \u03c8 be two locally\norder conserving embeddings such that K0(\u03c6) = K0(\u03c8). Since \u03c6 and \u03c8 are star ex-\ntendible, they are determined (up to inner equivalence) by their restrictions to B.\nBut K0(\u03c6|B) = K0(\u03c6) = K0(\u03c8) = K0(\u03c8|B). By the argument above, \u03c6|B and \u03c8|B are\ninner equivalent; it follows immediately that \u03c6 and \u03c8 are inner equivalent.\n3\u00b71. Structure theorems\nWe now determine the way in which order conserving embeddings decompose as\nordered sums of embeddings of special types. Our original motivation for studying\nsuch decompositions was to use these as a vehicle for obtaining K0-uniqueness. The-\norem 3\u00b72, however, provides K0-uniqueness more directly and for a broader class\nof embeddings. While the original motivation is no longer germane, the structure\ntheorem is of independent interest. We will also comment on connections with K0-\nuniqueness, since these connections are illuminating.\nIn the next definition we write \u227aA to indicate the total ordering on the atomic\nprojections of a nest algebra A.\nDefinition 3\u00b73. (i) A (possibly non-unital) star extendible embedding \u03c6 : Tn \u2192 Tm\nis said to be a refinement type embedding if \u03c6 is locally order conserving and if, when-\never e1 \u227aTn e2 and e1\u0010 e2, it follows that f1 \u227aTm f2 for f1 6 \u03c6(e1) and f2 6 \u03c6(e2).\n(ii) A (possibly non-unital) star extendible embedding \u03c6 : A1 \u2192 A2 between finite\ndimensional nest algebras is said to be of refinement type if there are maximal trian-\ngular subalgebras Tn \u2286 A1, Tm \u2286 A2 such that \u03c6(Tn) \u2286 Tm and the restriction map\n\u03c6 : Tn \u2192 Tm is of refinement type.\nA refinement type embedding is necessarily order conserving. To see this let\n\u03c1 : Tn \u2192 Tm be a refinement embedding with star extension \u03c1 : Mn \u2192 Mm and\nlet A1 be a nest algebra containing Tn. The algebra A1 necessarily has a standard\nblock upper triangular structure. There is a smallest nest algebra A2 containing Tm\nand \u03c1(A1) and this algebra also has standard form. Note that the images of the atoms\nof rank greater than one are atoms of A2 whilst the other atoms of A2 are of rank\none. The map \u03c1 : A1 \u2192 A2 is clearly order conserving. If A3 is a nest algebra in Mm\ncontaining A2 then since the block structure of A2 refines that of A3 it follows that\nLimits of nest algebras 87\nPisomoc(A2) \u2286 Pisomoc(A3). Thus \u03c1 : A1 \u2192 A3 is order conserving and such a map \u03c1\nis a typical unital refinement type embedding.\nA general refinement type embedding \u03c6 : A1 \u2192 A4 has the form \u03c8 \u25e6 \u03c1 where\n\u03c8 : A3 \u2192 A4 is a multiplicity one inclusion, and so is also order conserving.\nNote that the argument above implies that the image of an atom of rank greater\nthan one, under a refinement type embedding, is dominated by an atom of the range.\nDefinition 3\u00b74. Let \u03c6i : A1 \u2192 A2, 1 6 i 6 r, be star extendible algebra homomor-\nphisms between finite dimensional nest algebras A1, A2 such that the projections\n\u03c6i(1) are pairwise orthogonal. Then the star extendible embedding \u03c61 + \u00b7 \u00b7 \u00b7 + \u03c6r is\nsaid to be an ordered sum if\nq\u03c6i(1)\u0010 0 =\u21d2 q\u2032\u03c6j(1) = 0 for q \u227a q\u2032, j < i\nfor all atomic interval projections q, q\u2032 of A2, and for all i.\nWhat this means can also be described in terms of a choice of a maximal set\nP = {e1, e2, . . . , em} of rank one projections in A2 whose indexing is consistent with\nthe partial ordering \u227aA2 on the set Q of atomic interval projections q (in the sense\nthat if ei 6 q, ej 6 q\u2032, i 6 j, then q \u00b9A2 q\u2032) and is such that each projection \u03c6i(1) is a\nsum of some of the projections of P. With any such choice of P the condition of the\nlast definition holds if the P-support of the projections \u03c61(1), \u03c62(1), . . . , \u03c6r(1) appear\nin order, that is,\nmax{j : ej\u03c6i(1)\u0010 0} < min{j : ej\u03c6i+1(1)\u0010 0}\nfor each i = 1, . . . , r.\nDefinition 3\u00b75. Let \u03c6 : A1 \u2192 A2 be a star extendible algebra homomorphism with\nordered decomposition \u03c61 + \u00b7 \u00b7 \u00b7+\u03c6r. Such a decomposition is said to be order reducible\nif for some index i the map \u03c6i has a non-trivial ordered sum decomposition.\nThe following proposition is evident.\nProposition 3\u00b76. A star extendible embedding between finite dimensional nest\nalgebras admits an order irreducible ordered sum decomposition which is unique up\nto a permutation of multiplicity one summands which map into the same diagonal block.\nMoreover the embedding is order conserving if, and only if, each summand is an order\nconserving embedding.\nThis proposition provides a useful perspective and to illustrate this we prove a key\nresult from [3] generalised to the case of non-unital maps.\nProposition 3\u00b77. Let n > 3 and let \u03c6 : Tn \u2192 Tm be a star extendible embedding. Then\n\u03c6 is an order conserving embedding if, and only if, \u03c6 is an ordered sum \u03c6 = \u03c61 + \u00b7 \u00b7 \u00b7+\u03c6p,\nwhere each \u03c6j is a refinement type embedding.\nProof. Let \u03c6 be order conserving with order-irreducible ordered decomposition\n\u03c61 + \u03c62 + \u00b7 \u00b7 \u00b7 + \u03c6l\nand let P = {e1, . . . , en} be the atomic interval projections of Tn, listed in their natu-\n88 Alan Hopenwasser and Stephen Power\nral order. Let Q1, Q2, . . . , Qj be consecutive interval projections of Tm (consecutive\nin the sense of there being no gaps) chosen with the following properties:\nQi\u03c6(ei) = Qi\u03c6(1), for each i,\nrank(Q1\u03c6(e1)) = rank(Q2\u03c6(e2)) = \u00b7 \u00b7 \u00b7 = rank(Qj\u22121\u03c6(ej\u22121)) > rank(Qj\u03c6(ej)),\nj is maximal,\nwhere either j = n and the last inequality is an equality, or j < n and the last\ninequality is strict. In the first case, since \u03c6 is order conserving, it follows that\n\u03c6 has an ordered decomposition \u03c6\u20321 + \u03c6\n\u2032\n2, where \u03c6\n\u2032\n1 is of refinement type; thus, by\norder irreducibility, \u03c61 = \u03c6\u20321. We show that the second case cannot hold. This, and\ninduction, completes the proof of the proposition.\nLet us illustrate this situation with the following diagram, where j = 4, a1, a2, a3\nare the rank one diagonal projections of Tm, in order, comprising Q1\u03c6(e1); b1, b2, b3,\nthose of Q2\u03c6(e2); c1, c2, c3, those of Q3\u03c6(e3); and d1, d2, those of Q4\u03c6(e4):\na1, a2, a3\ufe38 \ufe37\ufe37 \ufe38\nQ1\n, b1, b2, b3\ufe38 \ufe37\ufe37 \ufe38\nQ2\n, c1, c2, c3\ufe38 \ufe37\ufe37 \ufe38\nQ3\n, d1, d2\ufe38 \ufe37\ufe37 \ufe38\nQ4\n, x, . . . , y, . . . .\nNow let x denote the first rank one projection of Tm which follows Qj and satisfies\nx\u03c6(1)\u0010 0. Since \u03c6 maps Tn into Tm, the assumption on j implies that x is necessarily\na subprojection of \u03c6(e1) (and in our illustration could be written as a4). Also, let y\nbe the first rank one projection of Tm such that y\u03c6(ej)\u0010 0 and yQj = 0. Such a\nprojection exists since \u03c6 is star extendible and so the projections \u03c6(e1), . . . , \u03c6(ej) have\nequal rank. (In our illustration, y could be written as d3.)\nWe can now see that order conservation is contradicted. For note that \u03c6(ej\u22121,j)\nmaps y into Qj\u22121. Thus, while the partial isometry v = e1 +ej\u22121,j is order conserving,\nwe have x \u227aA2 y and \u03c6(v)y\u03c6(v)\u2217 \u227aA2 \u03c6(v)x\u03c6(v)\u2217.\nRefinement type embeddings \u03c6 : A1 \u2192 A2 are determined, uniquely, by their tri-\nangular restrictions, \u03c6t : At1 \u2192 At2, where At1 \u2286 A1 is a maximal triangular sub-\nalgebra (isomorphic to Tn for some n) and where At2 \u2286 A2 is a similar appropriately\nchosen triangular subalgebra. Compositions of refinement type embeddings between\ntriangular nest algebras are of refinement type; it follows from this and the remark\nafter Definition 3\u00b73 that general refinement type embeddings are closed under com-\npositions.\nFurthermore, refinement type embeddings between triangular algebras are de-\ntermined up to inner conjugacy by their restrictions to the diagonal subalgebra.\nAccordingly, it follows (even without the use of Theorem 3\u00b72) that refinement type\nembeddings \u03c6, \u03c8 : A1 \u2192 A2 are inner conjugate if, and only if, K0\u03c6 = K0\u03c8.\nDefinition 3\u00b78. A star extendible embedding \u03c6 : A1 \u2192 A2 between finite dimen-\nsional nest algebras is said to be of T2-degenerate type if there exist atomic interval\nprojections Q,Q\u2032 for A2 such that \u03c6(1) 6 Q +Q\u2032.\nFor an example of an embedding of T2-degenerate type, consider the multiplicity\nLimits of nest algebras 89\ntwo embedding \u03c6 : T4 \u2297Mm \u2192 T2 \u2297Mn for which\n\uf8ee\uf8ef\uf8ef\uf8f0\na x . .\nb y .\nc z\nd\n\uf8f9\uf8fa\uf8fa\uf8fb \u2212\u2192\n\uf8ee\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\na x \u2217 \u2217\na x . .\nb y .\nc z\nb y \u2217\nc z\nd\nd\n\uf8f9\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb\n.\nNote that \u03c6 = \u03b81 + \u03b82 where \u03b81, \u03b82 are rank one embeddings determined, respec-\ntively, by the block groupings (a, bcd) and (abc, d). The presence of b in block two and\nc in block one show that \u03c6 is not of refinement type. Also \u03c6 is order irreducible. Since\nit can be checked that all order irreducible embeddings from T3\u2297Mn to T2\u2297Mn are\nof refinement type, \u03c6 can be viewed as the simplest order irreducible non refinement\ntype order conserving embedding.\nIt can be shown, as in [10], that a T2-degenerate embedding is automatically\nregular. Furthermore, every T2-degenerate embedding is, essentially by default, order\nconserving, and so Theorem 3\u00b72 implies that T2-degenerate embeddings have the K0-\nuniqueness property. Since it is illuminating, we give a direct proof of this.\nLet q1, . . . , qp (respectively Q1, . . . , Qn) be the atomic interval projections of A1\n(respectively A2). Then, for a T2-degenerate embedding \u03c6, one sees that K0\u03c6 is an\nn\u00d7 p matrix with at most two non-zero rows, yielding a submatrix[\nu1 u2 . . . up\nv1 v2 . . . vp\n]\nfor which vi 6 vj and ui > uj , for i 6 j, and ui + vi = r, for all i, where r is the\nmultiplicity of \u03c6.\nThe map \u03c6 : A1 \u2192 A2 admits a direct sum decomposition into rank one embeddings\nbelonging to p+ 1 distinct inner equivalence classes. The corresponding K0 matrices\nfor embeddings in these classes have the form[\n1 1 . . . 1 1 1\n0 0 . . . 0 0 0\n]\n,[\n1 1 . . . 1 1 0\n0 0 . . . 0 0 1\n]\n,[\n1 1 . . . 1 0 0\n0 0 . . . 0 1 1\n]\n,\n...[\n0 0 . . . 0 0 0\n1 1 . . . 1 1 1\n]\n.\nIf there are rk repetitions of the kth class then we say that \u03c6 has multiplicity signature\n{r1, . . . , rn+1}. In this case\nK0\u03c6 =\n[\nr1 + r2 + . . . rp r1 + r2 + . . . rp\u22121 . . . r1\nrp+1 rp + rp+1 . . . r2 + r3 + . . . rp+1\n]\n,\n90 Alan Hopenwasser and Stephen Power\nand so it follows that K0\u03c6 determines the multiplicity signature and thus the inner\nequivalence class of \u03c6.\nWhen the following theorem is combined with Proposition 3\u00b76, it yields a structure\ntheorem analogous to Proposition 3\u00b77 for order conserving embeddings defined on a\nnest algebra with no rank one atoms.\nTheorem 3\u00b79. Let \u03c6 : A1 \u2192 A2 be a regular star extendible embedding between finite\ndimensional nest algebras which is order conserving and order irreducible, and suppose\nthat A1 has no one dimensional atoms. Then \u03c6 is either T2-degenerate or is of refinement\ntype.\nProof. Assume that \u03c6 is not T2-degenerate. Let A1 have atomic interval projec-\ntions q1, q2, . . . , qn and let A2 have atomic interval projections Q1, Q2, . . . , Qm. The\nhypothesis for A1 implies that there exists a matrix unit system v\np\nij , 1 6 i 6 j 6 n,\np = 0, 1, for a copy of Tn \u2297 C2 in A1 such that vpij is supported in qiA1qj , the (i, j)\nblock subspace of A1. In particular note that for i < n there are rank two order\nconserving partial isometries in A1 of the form v = v0i,j1 + v\n1\ni,j2\n. Similarly, there are\nrank two order conserving partial isometries supported in a single block column.\nLet \u03c6 = \u03b81 + \u00b7 \u00b7 \u00b7 + \u03b8r be the multiplicity one decomposition of \u03c6, with r > 1.\nNote first that since \u03c6 is order conserving, any subsum, such as \u03b8s + \u03b8t, is also\norder conserving. Secondly, observe that for each s, the partial isometry \u03b8s(v01n) is\nsupported in a single off-diagonal block. For if not, then Qi\u03b8s(v01n)Qi = \u03b8s(v\n0\n1n) for\nsome s and i, and so the range of \u03b8s lies in QiA2Qi. On the other hand \u03c6 is order\nconserving and it follows readily that \u03b8s must be an order summand of \u03c6, and hence\nequal to \u03c6 by order irreducibility, contrary to the assumption r > 1.\nConsider an index t for which \u03b8t(v01n) is supported in the (k, l) block subspace and is\nsuch that Qi\u03c6(v01n)Qj = 0 for all (i, j)\u0010 (k, l) satisfying k 6 i and j 6 l. We complete\nthe proof of the lemma by showing that for all s, i, j the partial isometry \u03b8s(v0ij) is\nsupported in the same block subspace as \u03b8t(v0ij). In particular all the summands \u03b8s\nare inner conjugate and \u03c6 is a refinement embedding.\nNote first that \u03b8t(v011) is supported in the Qk block subspace and that \u03b8t(v\n0\nnn) is\nsupported in theQl block subspace. Given s\u0010 t, there are various a priori possibilities\nfor the support projections Qi of \u03b8s(v011). The first possibility, i < j, is suggested by\nthe following diagram:\n. . .\ni \u03b8s(v011)\n. . .\nk \u03b8t(v01n)\n. . .\nl\n. . .\nIn this case we can deduce from the order conserving nature of \u03c6 that \u03b8s(v0nn) is\nsupported in a block Qj with j 6 k. Indeed, if such a j is greater than k, then it\nfollows that \u03b8s(v01n) and \u03b8s(v\n1\n1n) have support in the (i, j) block, \u03b8t(v\n0\n11) and \u03b8t(v\n1\n11) have\nLimits of nest algebras 91\nsupport in the (k, k) block and so the support of \u03b8s(v01n) + \u03b8t(v\n1\n11) is not of staircase\ntype. Since \u03b8s + \u03b8t is order conserving, this is a contradiction.\nWe have shown that if i < k then \u03b8s + \u03b8t is an ordered sum. Now suppose that\ni > l. Since Qi is the support projection for \u03b8s(v011), it follows immediately (without\nthe need for the order conservation of \u03c6) that \u03b8t + \u03b8s is an ordered sum.\nNow consider the case k < i < l. Then \u03b8s(v111) + \u03b8t(v\n0\n1n) has support in the (i, i)\nblock and the (k, l) block and so is not of staircase form. Since \u03c6 is order conserving,\nwe have a contradiction once again. Thus the only possible value for i is k.\nIn summary, we have shown that if s\u0010 t, then \u03b8s(v011) is supported in the same\nblock Qk as \u03b8t(v011). By the original assumption on t, we must have that \u03b8s(v\n0\n1n) is\nsupported in the (k, l) block, since the only alternative is that it is supported in a\n(k, r) with r > l. But this would imply that (\u03b8s+\u03b8t)(v0nn+v\n1\n1n) is not order conserving.\nFor similar reasons it follows that for 1 < x < n, the projections \u03b8s(v0xx) and \u03b8t(v\n0\nxx)\nare equivalent. For suppose that these projections are supported in the blocks for\nQp and Qq respectively, with p < q. Then \u03b8s(v0xn) has support in the (p, l) block\nwhile \u03b8t(v1xx) has support in the (q, q) block and hence \u03b8s+ \u03b8t is not order conserving.\nSimilarly, q < p is not possible.\nWe have shown that for all 1 6 x 6 n and for all s and t the projections \u03b8s(v0xx)\nand \u03b8t(v0xx) lie in the same block subspace and so are inner equivalent. It follows that\n\u03c6 is a refinement type embedding.\nCorollary 3\u00b710. Let \u03c6 : A1 \u2192 A2 be an order conserving embedding between finite\ndimensional nest algebras, where A1 has no rank one atoms. Then \u03c6 can be written as\nan ordered sum \u03c6 = \u03c61 + \u00b7 \u00b7 \u00b7 + \u03c6p, where each \u03c6i is either T2-degenerate or of refinement\ntype.\nRemark. Theorem 3\u00b79 is not valid if A1 has both rank one atoms and higher\nrank atoms. There are examples of embeddings which are order conserving and\norder irreducible but neither T2-degenerate nor of refinement type. For example, let\n\u03c6 : T (2, 2, 1) \u2212\u2192 T (6, 3, 1) be given by\n\uf8eb\uf8ec\uf8ec\uf8ec\uf8ec\uf8ed\ne1\nf1\ne2\nf2 x\nr3\n\uf8f6\uf8f7\uf8f7\uf8f7\uf8f7\uf8f8 \u2212\u2192\n\uf8eb\uf8ec\uf8ec\uf8ec\uf8ec\uf8ec\uf8ec\uf8ec\uf8ec\uf8ec\uf8ec\uf8ec\uf8ec\uf8ec\uf8ec\uf8ed\ne1\ne1\nf1\nf1\ne2\nf2 x\ne2\nf2 x\nr3\nr3\n\uf8f6\uf8f7\uf8f7\uf8f7\uf8f7\uf8f7\uf8f7\uf8f7\uf8f7\uf8f7\uf8f7\uf8f7\uf8f7\uf8f7\uf8f7\uf8f8\n.\nOnly one off-diagonal position has been indicated; all off-diagonal matrix units are\ndealt with in the same way. Their image under \u03c6 matches the diagonal matrix\nunits of the domain and the range spaces in the order in which they appear on the\ndiagonal.\nNote that in this example, if \u03c6 is restricted to the orthogonal complement of the\nrank one atom of A1, then it is no longer order irreducible.\n92 Alan Hopenwasser and Stephen Power\nIt is easy to construct a variety of similar counter-examples in which the number\nof atoms in the codomain which intersect \u03c6(1) is arbitrarily large.\n3\u00b72. Order preserving embeddings.\nDonsig [2] has extended the notion of order preservation to the general context of\ndigraph algebras (where order preservation is defined with respect to a self-adjoint\nsubalgebra of the digraph algebra). His definition, when restricted to a finite dimen-\nsional nest algebra and taken with respect to A w A\u2217, agrees with the definition\nbelow.\nDefinition 3\u00b711. Let A \u2286 Mn be a finite dimensional nest algebra with atomic\ninterval projections q1, q2, . . . , ql.\n(1) The set Pisomop(A) is the set of partial isometries v in Pisomreg(A) which are\norder preserving in the sense that\nqivqj\u0010 0 =\u21d2 qsvqt = 0, for (s, t)\u0010 (i, j) with s 6 i and t > j.\n(2) A star extendible embedding between finite dimensional nest algebras is order\npreserving if it maps order preserving partial isometries to order preserving\npartial isometries.\n(3) A star extendible embedding \u03c6 : A1 \u2192 A2 is locally order preserving if \u03c6(v) is\nin Pisomop(A2), for each rank one element v in Pisomreg(A1).\nFor triangular nest algebras Tn, n = 1, 2, . . . , the order preserving embeddings\ncoincide with the order conserving embeddings, since a partial isometry in Tn is or-\nder conserving if, and only if, it is order preserving. In contrast, for non-triangular\nalgebras order preservation is quite stringent. For example, a star extendible em-\nbedding,\n\u03c6 : T2 \u2192 T2 \u2297Mn,\nis order preserving if, and only if, either\n\u03c6(e12) \u2208 D2 \u2297Mn or \u03c6(e12) \u2208 e12 \u2297Mn.\nOn the other hand, if \u03c6 : Tn \u2192 Tm is an order conserving embedding and\n\u03b7 : B1 \u2192 B2 is a C\u2217-algebra homomorphism between finite dimensional C\u2217-algebras,\nthen the star extendible homomorphism,\n\u03c6\u2297 \u03b7 : Tn \u2297B1 \u2192 Tm \u2297B2,\nhas partial embeddings (between the summands of the algebras) which are locally\norder preserving. Although the local order preservation property is not generally\nconserved under composition, this is plainly the case for these tensor product\nmaps.\nWe remark that there are order conserving embeddings which are locally order\npreserving but are not order preserving. The multiplicity two standard embedding\nfrom T3 \u2297Mr to T (r, r, 2r, r, r) has this property.\nLimits of nest algebras 93\nIt is also possible for an embedding to be order preserving but not order conserving.\nTo see this consider the map T2 \u2297M2 \u2192 T4 \u2297M2 given by\n(\na b\nc\n)\n\u2212\u2192\n\uf8eb\uf8ec\uf8ec\uf8ed\na b\na b\nc\nc\n\uf8f6\uf8f7\uf8f7\uf8f8 .\nFinally, the embedding T2 \u2192 T2 \u2297M3 given by\n(\na b\nc\n)\n\u2212\u2192\n\uf8eb\uf8ec\uf8ec\uf8ec\uf8ec\uf8ec\uf8ec\uf8ed\na b\nc\na b\nc\na b\nc\n\uf8f6\uf8f7\uf8f7\uf8f7\uf8f7\uf8f7\uf8f7\uf8f8\nillustrates how easily a \u2018nice\u2019 embedding can fail to be locally order preserving.\n(For embeddings with domain T2, order preservation and local order preservation\ncoincide.)\n4. Isomorphisms\nLet A = {Ak, \u03b1k}, A\u2032 = {A\u2032k, \u03b1\u2032k} be direct systems of digraph algebras with\nembeddings \u03b1k, \u03b1\u2032k which are star extendible and regular. Let A0, A\n\u2032\n0 be the locally\nfinite algebras which are the algebraic direct limits of the systems. The limit algebras\nA0, A\n\u2032\n0 are said to be star extendibly isomorphic if there is an algebra isomorphism\n\u03a60 : A0 \u2192 A\u20320 which extends to a \u2217-algebra isomorphism between the generated C*-\nalgebras.\nDefinition 4\u00b71. The direct systems A,A\u2032 are said to be regularly isomorphic if there\nexist regular, star extendible embeddings {\u03c6k, \u03c8k} such that the diagram\nAn1 An2 An3\nA\u2032m1 A\n\u2032\nm2\n-\n@\n@R\n\u03c61\n-\n@\n@R\n\u03c62\n-\n@\n@R\u0000\n\u0000\u0012\u03c81\n-\n\u0000\n\u0000\u0012\u03c82\n-\ncommutes.\nA fundamental issue in the classification of non-self-adjoint limit algebras is that\na star extendible isomorphism \u03a6: A0 \u2192 A\u20320 need not be induced by a regular isomor-\nphism between the given systems (see [4, 21]). However, we shall see that for various\norder conserving systems this is indeed the case. This enables us to define invariants\nfor limit algebras in terms of regular isomorphism invariants for systems.\nIn the proof of the next lemma the block matrix support of an element a in a\nfinite dimensional nest algebra refers to the set of block subspaces QiAQj for which\nQiaQj\u0010 0. The matrix support of a refers to a given matrix unit system {hij} and\nis the set { (i, j) | hiiahjj\u0010 0 }.\nLemma 4\u00b72. Let \u03c6 : A1 \u2192 A2, \u03c8 : A2 \u2192 A3 be star extendible homomorphisms between\nfinite dimensional nest algebras such that the composition \u03c8\u25e6\u03c6 is locally order conserving.\n94 Alan Hopenwasser and Stephen Power\nIf h is a rank one regular partial isometry in Pisomreg(A2) which lies in the bimodule\nover A2 wA\u22172 generated by \u03c6(A1), then \u03c8(h) is an order conserving partial isometry.\nProof. Fix matrix units for A1 and A2 so that \u03c6 maps matrix units of A1 w A\n\u2217\n1 to\nsums of matrix units in A2 w A\n\u2217\n2 , and then choose matrix units for A3 such that \u03c8\nmaps matrix units in A2 w A\n\u2217\n2 to sums of matrix units. Let B be the bimodule over\nA2 w A\u22172 generated by \u03c6(A1). Since B is, in particular, a bimodule over the diagonal\nmatrices, B is the linear span of the matrix units which it contains. Let e be a matrix\nunit in B. Then there are atoms P and Q for A2 such that e = PeQ. If f and g are\nmatrix units satisfying f = PfP and g = QgQ, then f, g \u2208 A2 w A\u22172 . It follows\nthat feg \u2208 B. But any matrix unit e\u2032 for which e\u2032 = Pe\u2032Q can be written in this\nform. Thus, if PBQ \u0010 {0} then PBQ = PA2Q. This enables us to identify the\nbimodule over A2 w A\u22172 generated by \u03c6(A1): it consists of all elements of A2 which\nare supported in the collection of matrix blocks which contain non-zero entries for\nelements of \u03c6(A1).\nNow suppose that h and e are two matrix units in the same block inA2 and suppose,\nfurther, that \u03c8(e) is order conserving. By the first assumption, there are matrix units\nf and g in diagonal blocks of A2 such that h = feg. Since \u03c8(e) is order conserving,\nits support has \u2018staircase\u2019 form in A3; since \u03c8(f ) and \u03c8(g) lie in A3wA\u22173 , \u03c8(h) also has\n\u2018staircase\u2019 form; i.e. \u03c8(h) is also order conserving. This argument works equally well\nif h is a rank one partial isometry in the same block as e rather than a matrix unit.\n(The only modification is that f and g are merely rank one partial isometries in the\nappropriate diagonal blocks.) As a consequence of these observations, we see that we\ncan prove the lemma by proving it in the special case in which h is a subordinate of\na partial isometry in the range, \u03c6(A1), of \u03c6.\nIf we make this additional hypothesis, there is a rank one regular partial isometry\ne in A1 such that hh\u2217\u03c6(e)h\u2217h\u0010 0. Because of our matrix unit choice for \u03c8, it follows\nthat the matrix support of \u03c8(\u03c6(e)) contains the matrix support of \u03c8(h). However,\nthe block matrix support of \u03c8(\u03c6(e)) is of staircase type, since \u03c8 \u25e6 \u03c6 is locally order\nconserving. It follows that \u03c8(h) is an order conserving partial isometry.\nRemark. The assumption that \u03c8 \u25e6 \u03c6 is locally order conserving does not imply\nthat \u03c8 is locally order conserving, even when \u03c8 is restricted to the algebra generated\nby \u03c6(A1) and A2 w A\u22172 . The two embeddings \u03c6 : T2 \u2192 T (1, 2, 1) and \u03c8 : T (1, 2, 1) \u2192\nT (1, 1, 4, 1, 1) given by\n(\na b\nc\n)\n\u03c6\u2212\u2192\n\uf8eb\uf8ec\uf8ec\uf8ed\na b\nc\na b\nc\n\uf8f6\uf8f7\uf8f7\uf8f8\nand\n\uf8eb\uf8ed \u03b1 \u03b2 \u03b3\u03b4 \u00b2\n\u03b7\n\uf8f6\uf8f8 \u03c8\u2212\u2192\n\uf8eb\uf8ec\uf8ec\uf8ec\uf8ec\uf8ec\uf8ec\uf8ed\n\u03b1 \u03b2 \u03b3\n\u03b1 \u03b2 \u03b3\n\u03b4 \u00b2\n\u03b4 \u00b2\n\u03b7\n\u03b7\n\uf8f6\uf8f7\uf8f7\uf8f7\uf8f7\uf8f7\uf8f7\uf8f8\nLimits of nest algebras 95\nprovide a counter-example. Note that T (1, 2, 1) is the algebra generated by \u03c6(T2) and\nT (1, 2, 1) w T (1, 2, 1)\u2217.\nTheorem 4\u00b73. Let A,A\u2032 be systems of finite dimensional nest algebras in which all\ncompositions of embeddings are locally order conserving and let A0, A\u20320 be their algebraic\nlimit algebras. Then the following are equivalent.\n(i) A and A\u2032 are regularly isomorphic.\n(ii) A0 and A\u20320 are star extendibly isomorphic.\nMoreover, every star extendible isomorphism \u03a6: A0 \u2192 A\u20320 is induced by a regular star\nextendible isomorphism between the systems A,A\u2032.\nProof. The proof that (i) implies (ii) is immediate. For the converse, let \u03a6: A0 \u2192 A\u20320\nbe a star extendible isomorphism. Since each algebra in the systems A and A\u2032 is\nfinitely generated, there is a commuting diagram isomorphism of the systems with\ncrossover maps \u03c6k, \u03c8k:\nAn1 An2 An3\nA\u2032m1 A\n\u2032\nm2\n-i1\n@\n@R\n\u03c61\n-i2\n@\n@R\n\u03c62\n-i3\n@\n@R\u0000\n\u0000\u0012\u03c81\n-i\n\u2032\n1\n\u0000\n\u0000\u0012\u03c82\n-i\n\u2032\n2\nSince i1 = \u03c81 \u25e6 \u03c61, the range of i1 is contained in \u03c8(A\u2032m1 ). By hypothesis, i1 is\nlocally order conserving and so locally regular and hence regular. If x \u2208 An1 is a\nrank one regular partial isometry, then i1(x) is a regular, order conserving, partial\nisometry in \u03c8(A\u2032m1 ). Consequently, i1(x) is a sum, i1(x) = y1 + \u00b7 \u00b7 \u00b7 + ys, of regular\nrank one partial isometries in \u03c8(A\u2032m1 ). Since i\n\u2032\n1 = \u03c62 \u25e6 \u03c81 is locally order conserving,\neach partial isometry \u03c62(yj) is order conserving, by Lemma 4\u00b72, and hence regular\nin A\u2032m2 . Therefore \u03c62 \u25e6 i1(x) is regular and so \u03c62 \u25e6 i1 : An1 \u2192 A\u2032m2 is locally regular.\nBy Theorem 2\u00b74, \u03c62 \u25e6 i1 = \u03c62 \u25e6 \u03c81 \u25e6 \u03c61 is a regular embedding.\nThe same argument shows that \u03c83 \u25e6 \u03c63 \u25e6 \u03c82 = \u03c83 \u25e6 i\u20322 is regular; continuing in this\nfashion, we may replace the initial commuting diagram isomorphism with one whose\ncrossover maps are all regular. This shows that (ii) implies (i).\nThe last theorem is important in that it shows that tentative invariants defined\nfor algebraic limit algebras in terms of specific regular presentations do not in fact\ndepend on the presentation and are thus genuine invariants for star extendible iso-\nmorphism. In the next section we shall need to know that certain scales defined in\nterms of order preserving or order conserving systems are invariants. This will fol-\nlow from the following refinement of Theorem 4\u00b73 in the order preserving or order\nconserving cases.\nTheorem 4\u00b74. Let A,A\u2032 be systems of finite dimensional nest algebras in which all\nembeddings are order preserving (respectively order conserving) and let A0, A\u20320 be their\nalgebraic limit algebras. Then the following are equivalent.\n(i) The systems A and A\u2032 are regularly isomorphic by a commuting diagram iso-\nmorphism in which all the crossover maps are order preserving (respectively order\nconserving).\n(ii) A0 and A\u20320 are star extendibly isomorphic.\nMoreover, every star extendible isomorphism \u03a6: A0 \u2192 A\u20320 is induced by a system iso-\nmorphism as in (i).\n96 Alan Hopenwasser and Stephen Power\nProof. The proof of this theorem follows easily from Lemma 4\u00b75 below. If A0 and\nA\u20320 are star extendibly isomorphic, then Theorem 4\u00b73 gives a regular system isomor-\nphism in which any adjacent pair of crossover maps have a composition which is\norder preserving or order conserving, as appropriate. From the lemma, any consecu-\ntive triple of crossover maps has composition which is order preserving or order\nconserving; a sequence of such triple compositions yields a system isomorphism with\norder preserving or order conserving crossover maps.\nLemma 4\u00b75. Let\nA1\n\u03c6\u2212\u2192 A2 \u03c8\u2212\u2192 A3 \u03b7\u2212\u2192 A4\nbe regular star extendible homomorphsims between finite dimensional nest algebras such\nthat the compositions \u03c8\u03c6 and \u03b7\u03c8 are order preserving (respectively order conserving).\nThen the triple composition \u03b7\u03c8\u03c6 is order preserving (respectively order conserving).\nBefore giving a proof of the lemma, we discuss some helpful preliminary matters.\nWhen A1 is a finite dimensional nest, we number the block rows and block columns\nof A1 in the natural way. If v \u2208 A1 is supported in a single block, row(v) and col(v)\ndenote the row and column in which the support block is located. Suppose that\n\u03c6 : A1 \u2192 A2 is a multiplicity one (star extendible, regular) embedding of A1 into\nanother finite dimensional nest algebra. If v is supported in a single block in A1,\nthen \u03c6(v) is supported in a single block in A2. If v and w are each supported in a\nsingle block, then\nrow(v) = row(w) =\u21d2 row(\u03c6(v)) = row(\u03c6(w)),\ncol(v) = col(w) =\u21d2 col(\u03c6(v)) = col(\u03c6(w)),\nrow(v) < row(w) =\u21d2 row(\u03c6(v)) 6 row(\u03c6(w)),\ncol(v) < col(w) =\u21d2 col(\u03c6(v)) 6 col(\u03c6(w)).\nIn particular, if v and w are supported in the same block, then so are \u03c6(v) and \u03c6(w).\nThus, \u03c6 induces a map \u03c6\u02dc from the blocks of A1 to the blocks of A2. This map need\nnot be injective, but it does respect the block structure: if row(X) < row(Y ), then\nrow(\u03c6\u02dc(X)) 6 row(\u03c6\u02dc(Y )); similarly, if col(X) < col(Y ), then col(\u03c6\u02dc(X)) 6 col(\u03c6\u02dc(Y )).\n(Here, X and Y denote blocks in A1, not elements of the nest algebra.) In particular,\nif X and Y are blocks in the same row (or column), then \u03c6\u02dc(X) and \u03c6\u02dc(Y ) are also\nblocks in the same row (or column).\nLet v and w be partial isometries each of which is supported in a single block and\nassume that v+w is a partial isometry which is not order preserving. Then the block\nsupport for one of the partial isometries, say v, is located to the \u2018southwest\u2019 of the\nblock support for the other partial isometry. More precisely,\nrow(w) 6 row(v) and col(v) 6 colw,\nwith at least one inequality being strict. This can be indicated by the diagrams:\nw\nv\n,\nw\nv\nor\nv w\n.\nLimits of nest algebras 97\nNow suppose that \u03c6(v + w) = \u03c6(v) + \u03c6(w) is order preserving. (The assumption\nthat \u03c6 has multiplicity one is still in force.) It follows from the relations above that\nthe block support for \u03c6(v) is to the \u2018southwest\u2019, i.e. that\nrow\u03c6(w) 6 row\u03c6(v) and col\u03c6(v) 6 col\u03c6(w).\nBut \u03c6(v) + \u03c6(w) is order preserving, so in fact row\u03c6(v) = row\u03c6(w) and col\u03c6(v) =\ncol\u03c6(w); i.e. \u03c6(v) and \u03c6(w) have the same block support.\nNow assume that \u03c6 : A1 \u2192 A2 is an embedding with arbitrary multiplicity. Suppose\nthat \u03c6 is not order preserving. Then one (or both) of two situations must occur. The\nfirst is that there is a rank one partial isometry v \u2208 A1 and a pair of multiplicity\none summands \u03c61 and \u03c62 of \u03c6 such that \u03c61(v) + \u03c62(v) is not order preserving. The\nother alternative is that there are two rank one partial isometries v and w in A1\nwith support in distinct blocks such that v + w is order preserving and there are\ntwo multiplicity one summands \u03c61 and \u03c62 of \u03c6 such that \u03c61(v) + \u03c62(w) is not order\npreserving.\nIf, on the other hand, \u03c6 is order preserving, then any (partial) sum of the multi-\nplicity one summands for \u03c6 is also order preserving. Likewise, if \u03c6 is order conserving,\nthen any (partial) sum of the multiplicity one summands for \u03c6 is also order con-\nserving.\nNote also that a multiplicity one summand of a composition of two embeddings\nis the composition of multiplicity one summands of each factor.\nProof of Lemma 4\u00b75. The proof of the lemma in the order preserving context differs\nconsiderably from the proof in the order conserving context, so we present the two\narguments separately. We start with the the order preserving context, where the\nargument is simpler.\nFirst, suppose that v is a rank one partial isometry in A1 such that \u03b7\u03c8\u03c6(v) is not\norder preserving. Then there are multiplicty one summands \u03c61 and \u03c62 of \u03c6, \u03c81 and\n\u03c82 of \u03c8, and \u03b71 and \u03b72 of \u03b7 such that \u03b71\u03c81\u03c61(v) + \u03b72\u03c82\u03c62(v) is not order preserving.\nObserve that \u03c61(v) + \u03c62(v) is a partial isometry which is not order preserving. It\nis a partial isometry since \u03c61 + \u03c62 is an embedding; if it were order preserving, then\nits image under \u03b71\u03c81 + \u03b72\u03c82 would be order preserving. But \u03b71\u03c81\u03c61(v) + \u03b72\u03c82\u03c62(v) is\na subordinate of this image and is not order preserving.\nSince \u03c82\u03c61+\u03c82\u03c62 (a sum of multiplicity one summands of \u03c8\u03c6) is order preserving, it\nfollows that \u03c82\u03c61(v)+\u03c82\u03c62(v) is order preserving. Consequently, \u03c82\u03c61(v) and \u03c82\u03c62(v)\nare in the same block. This, in turn, implies that \u03b72\u03c82\u03c61(v) and \u03b72\u03c82\u03c62(v) are in the\nsame block.\nThis means that\n\u03b71\u03c81\u03c61(v) + \u03b72\u03c82\u03c61(v)\nand\n\u03b71\u03c81\u03c61(v) + \u03b72\u03c82\u03c62(v)\nhave the same block structure \u2013 either both are order preserving or both are not\norder preserving. But the second one is not order preserving by assumption while\nthe first one is the image of the rank one partial isometry \u03c61(v) under the order\npreserving embedding \u03b71\u03c81 + \u03b72\u03c82, a contradiction.\n98 Alan Hopenwasser and Stephen Power\nThe other possibility which we need to consider is that there are rank one partial\nisometries v and w in A1 such v + w is an order preserving partial isometry but\n\u03b7\u03c8\u03c6(v + w) is not order preserving. Again, there are multiplicity one summands \u03c61\nand \u03c62 of \u03c6, \u03c81 and \u03c82 of \u03c8, and \u03b71 and \u03b72 of \u03b7 such that \u03b71\u03c81\u03c61(v) + \u03b72\u03c82\u03c62(w) is\nnot order preserving.\nObserve that \u03c61(v) + \u03c62(w) is a partial isometry which is not order preserving. It\nis a partial isometry since it is a subordinate of \u03c6(v +w); if it were order preserving,\nthen its image under \u03b71\u03c81+\u03b72\u03c82 would be order preserving, but \u03b71\u03c81\u03c61(v)+\u03b72\u03c82\u03c62(w)\nis a subordinate of this image and is not order preserving.\nSince \u03c82\u03c61 +\u03c82\u03c62 is order preserving, it follows that \u03c82\u03c61(v)+\u03c82\u03c62(w) is order pre-\nserving. Consequently, \u03c82\u03c61(v) and \u03c82\u03c62(w) are in the same block, whence \u03b72\u03c82\u03c61(v)\nand \u03b72\u03c82\u03c62(v) are in the same block.\nThis means that\n\u03b71\u03c81\u03c61(v) + \u03b72\u03c82\u03c61(w)\nand\n\u03b71\u03c81\u03c61(v) + \u03b72\u03c82\u03c62(w)\nhave the same block structure, but \u03b71\u03c81\u03c61(v) + \u03b72\u03c82\u03c62(w) is not order preserving\nby assumption while \u03b71\u03c81\u03c61(v) + \u03b72\u03c82\u03c61(w) is a subordinate of the image of the\norder preserving partial isometry \u03c61(v + w) under the order preserving embedding\n\u03b71\u03c81 +\u03b72\u03c82, a contradiction. (\u03c61(v+w) is order preserving since any multiplicity one\nembedding is order preserving and v + w is an order preserving partial isometry.)\nHaving completed the order preserving context, we move on to the order conserv-\ning context. Let v \u2208 A1 be an order conserving partial isometry such that the block\nsupport of v has staircase form. Let v\u2032 = va+vb be a rank two subordinate of v which\nis supported in two of these block subspaces, denoted a and b. The orientation of\nthese blocks in the block decomposition of A1 can be indicated diagramatically as\none of six types, namely the triple,\na b\n,\na\nb\n,\na\nb\n,\ntogether with the corresponding triple with the letters reversed.\nSuppose the \u03c6(v\u2032) is not order conserving. Then there exist two blocks of A2, X\nand Y say, which have non-staircase orientation\nY\nX\nand are such that at least one of four possibilities occurs:\n(i) \u03c6(va) has support meeting X and Y ;\n(ii) \u03c6(vb) has support meeting X and Y ;\n(iii) \u03c6(va) and \u03c6(vb) have support meeting X and Y respectively;\n(iv) \u03c6(va) and \u03c6(vb) have support meeting Y and X respectively.\nLimits of nest algebras 99\nConsider the companion blocks U, V for X,Y indicated by the diagram\nU Y\nX V\n.\nSince the composition \u03c8\u03c6 is order conserving, if \u03c81 is a multiplicity one summand\nof \u03c8, the composition \u03c81\u03c6 is order conserving. In particular such a map \u03c81 must\n\u2018correct\u2019 the X,Y support of \u03c6(v) (indicated in one of the four possibilities (i) to (iv))\nby a \u2018fusion\u2019 of blocks, as indicated in each of the three diagrams\nU Y\nX V\n\u2212\u2192 \u03c8\u02dc1(U ) \u03c8\u02dc1(Y )\n\u03c8\u02dc1(X) \u03c8\u02dc1(V )\n,\nU Y\nX V\n\u2212\u2192 \u03c8\u02dc1(U ) \u03c8\u02dc1(Y )\n\u03c8\u02dc1(X) \u03c8\u02dc1(V )\n,\nU Y\nX V\n\u2212\u2192 \u03c8\u02dc1(U ) \u03c8\u02dc1(Y )\n\u03c8\u02dc1(X) \u03c8\u02dc1(V )\n.\nThis means that, in the first case for example, the image under \u03c81 of an element in\nA2 with support in the blocks U, Y or in the blocks X,V has support in a single block\nof A3. (The appearance of \u03c8\u02dc1(U ) and \u03c8\u02dc1(Y ), for example, in the same block in the\ndiagram indicates that \u03c8\u02dc1(U ) = \u03c8\u02dc1(Y ).) These types of fusion may vary among the\nvarious summands \u03c81 of \u03c8. The comments preceding the statement of the lemma\npreclude a correction of the X,Y support of \u03c6(v) of the form\nY\nX\n\u2212\u2192 \u03c8\u02dc1(X)\n\u03c8\u02dc1(Y )\nor the similar correction with \u03c8\u02dc1(X) and \u03c8\u02dc1(Y ) interchanged.\nLet w, u \u2208 A2 be rank two partial isometries with support in the blocks X,Y and\nU, V respectively. We now show that \u03b7\u03c8(w) is order conserving. The idea for this\nargument is that the fusion of blocks \u2018binds\u2019 the supports of \u03b7\u03c8(w) and \u03b7\u03c8(u) and\nthe latter is order conserving by the hypotheses, since u is order conserving. More\nprecisely let w = wX + wY be the rank one decomposition and suppose that \u03b7\u03c8(w)\nis not order conserving. Then there exist two blocks W,Z in A4 with non-staircase\nform\nZ\nW\nand there exist multiplicity one summands \u03c81, \u03c82 of \u03c8 and \u03b71, \u03b72 of \u03b7 such that at\nleast one of the following possibilities occurs.\n(a) \u03b71\u03c81(wX) and \u03b72\u03c82(wX) meet W and Z respectively.\n(b) \u03b71\u03c81(wY ) and \u03b72\u03c82(wY ) meet W and Z respectively.\n100 Alan Hopenwasser and Stephen Power\n(c) \u03b71\u03c81(wX) and \u03b72\u03c82(wY ) meet W and Z respectively.\n(d) \u03b71\u03c81(wX) and \u03b72\u03c82(wY ) meet Z and W respectively.\nLet u = uU + uV be the rank one decomposition of u. If the first possibility (a)\noccurs, then noting that \u03c81 fuses X and U , or X and V , and that \u03c82 also fuses X and\nU , or X and V , it follows that \u03b71\u03c81(uU ) (or \u03b71\u03c81(uV )) meets W and similarly that\n\u03b72\u03c82(uU ) (or \u03b72\u03c82(uV )) meets Z. For each of these four alternatives \u03b71\u03c81(u) + \u03b72\u03c82(u)\nis not order conserving, and this contradicts the fact that \u03b7\u03c8 is order conserving. The\nother three possibilities (b), (c), (d) also lead to contradictions in the same manner.\nIt has been shown then that \u03b7\u03c8(w) is order conserving or, more intuitively, that\nthe map \u03b7\u03c8 \u2018corrects\u2019 the X,Y block structure of \u03c6(v\u2032) and \u03c6(v). We now wish to\ndeduce that since every such block pair is corrected by \u03b7\u03c8 then in fact \u03b7\u03c8\u03c6(v) is\norder conserving. This will complete the proof.\nTo see this, suppose that \u03b7\u03c8\u03c6(v) is not order conserving and that it has support in\ntwo blocks P ,Q ofA4 which are not in staircase form. Then there are multiplicity one\nsummands \u03b71\u03c81\u03c61 and \u03b72\u03c82\u03c62 of \u03b7\u03c8\u03c6 (where \u03b71, \u03b72 are multiplicity one summands\nof \u03b7; \u03c81, \u03c82 are multiplicity one summands of \u03c8; and \u03c61, \u03c62 are multiplicity one\nsummands of \u03c6) such that \u03b71\u03c81\u03c61(v) meets P and \u03b72\u03c82\u03c62(v) meets Q. Thus there are\nrank one subordinates v1, v2 of v such that \u03b71\u03c81\u03c61(v1) meets P and \u03b72\u03c82\u03c62(v2) meets\nQ. It follows that the partial isometry w = \u03c61(v1) + \u03c62(v2) is not order conserving\n(since the map \u03b7\u03c8 is order conserving). However the argument above shows that\n\u03b7\u03c8(w) is order conserving, which is the desired contradiction.\nRemark. The proofs of Theorems 4\u00b73 and 4\u00b74 carry over readily to the case of\nsystems of direct sums of finite dimensional nest algebras for which the embeddings\nhave order preserving or order conserving partial embeddings between nest algebra\nsummands.\nRemark. In the terminology of [21], Theorem 4\u00b74 establishes that the families of\norder preserving and order conserving embeddings are functorial families. It follows\nfrom [9] that standard AF diagonal masas are unique up to approximately inner\nautomorphism in the corresponding algebraic limit algebras. In particular the spec-\ntrum is a well defined and a complete invariant for these algebras.\n5. Invariants and classifications\nLet A be a digraph algebra whose block diagonal subalgebra AwA\u2217 has minimal\ncentral projections q1, q2, . . . , qn. The reduced graphH forA is the graph with vertices\nlabelled 1, . . . , n and edges (i, j) for which qiAqj is non-zero. The abelian group Z\u03c9(A),\nwhere \u03c9(A) is the number of edges of H, may be defined intrinsically as the free\nabelian group G(A) whose generators are the equivalence classes [v] of rank one\nelements v of Pisomreg(A), where the equivalence relation is the following: v \u223c w if,\nand only if, there are unitaries u1 and u2 in A such that v = u1wu2. (Recall that\nv \u2208 Pisomreg(A) requires that v\u2217v and vv\u2217 belong to A.) If A is a finite dimensional\nnest algebra and q1, q2, . . . , qn are the atoms of A, in order, then we write Tn(Z) to\ndenote the abelian group G(A). Note that the group homomorphisms pif : G(A) \u2192\nK0(A) and pii : G(A) \u2192 K0(A) determined by the correspondences [v] 7\u2192 [vv\u2217] and\n[v] 7\u2192 [v\u2217v] respectively correspond to the row sum homomorphism and the column\nsum homomorphism from Tn(Z) to Zn. Observe also that K0(A) can be identified in\nLimits of nest algebras 101\na natural way with a subgroup of G(A). For a full treatment of this invariant, see\n[20].\nDefinition 5\u00b71. The dimension distribution group of the digraph algebra A is the\ngroup G(A) described above. If A = {Ak, \u03b1k} is a regular star extendible system of\ndigraph algebras, the dimension distribution group, G(A), of A is defined to be the\ndirect limit lim\u2212\u2192(G(Ak),G(\u03b1k)) determined by the naturally induced embeddings.\nPlainly, only the local regularity of \u03b1k is necessary for the existence of the induced\ngroup homomorphisms G(\u03b1k). In view of the commuting diagram\nG(Ak) G(Ak+1)\nK0(Ak) K0(Ak+1)\n?\npi\n-G(\u03b1k)\n?\npi\n-K0(\u03b1k)\nwith pi = pii or pi = pif , the invariant G(A) comes equipped with group homomor-\nphisms pii : G(A)\u2192 K0(A) and pif : G(A)\u2192 K0(A) which are, in fact, scaled group\nhomomorphisms with respect to the K0 scale \u03a30(A) and the dimension group scale\n\u03a3(A) \u2286 G(A), which is determined by the regular partial isometries of the system A.\nThe natural full dimension distribution group invariant is therefore the quadruple\nInv(A) =\n(\n(G(A),\u03a3(A)), (K0A,\u03a30A), pif , pii\n)\n,\nwhich is an invariant for regular star extendible isomorphism.\nFor self-adjoint systems, Inv(A) reduces to (K0A,\u03a30A). At the other extreme of\ntriangular algebra systems (with regular embeddings), Inv(A) can be identified with\na dual form of the fundamental binary relation (or spectrum) invariant (see [20]). In\nthe discussion below we extend the scope for Inv as a classifying invariant.\nIn [20] it was shown that partly self-adjoint Tr-algebra systems are classified by\nInv, together with an extra matrix unit scale, for r = 2, 3 but not for r > 4. Also,\nit was shown how one can introduce appropriate Grothendieck group invariants\nwhich capture the extra variety of regular embeddings and which serve as complete\nclassifying invariants (at least for regular isomorphisms of systems). However, it is\nnatural to enquire to what extent Inv(\u2212) already serves as a basis for complete\nclassification for systems of restricted type, such as order conserving embeddings.\nThis is particularly so if it is known that the inner conjugacy class of an admissible\nembedding is determined by the induced map on K0(\u2212) or on Inv(\u2212).\n5\u00b71. Existence\nRecall first the usual scheme for proving that an invariant such as Inv(\u2212) is, in fact,\na complete invariant for star extendible isomorphism. Start with an isomorphism\n\u03a6: Inv(A)\u2192 Inv(A\u2032); this gives rise to a commuting diagram with crossover maps\nInv(An1 )\n\u03b31\u2212\u2192 Inv(A\u2032m1 )\n\u03b41\u2212\u2192 Inv(An2 ) \u2212\u2192 . . . .\nLift \u03b31 to an admissible embedding \u03c61 : An1 \u2192 A\u2032m1 , perhaps after increasing m1.\nThis step, the existence step, is usually the crux of the proof and some type of\nscale preservation is usually needed to enable the lifting. Similarly, lift \u03b41 to an\nadmissible embedding \u03c81. Provided that admissible embeddings are closed under\n102 Alan Hopenwasser and Stephen Power\ncomposition or that, for some other reason, the composition is admissible, appeal\nnext to uniqueness to conclude that \u03c81 \u25e6 \u03c61 is conjugate to the given embedding\nAn1 \u2192 An2 . Adjust \u03c81 and obtain the commuting triangle for the first stage of the\ndesired infinite commuting diagram.\nWe now obtain some existence results in the context of order conservation.\nFor a finite dimensional nest algebra A, write \u03a3oc(A) for the order conserving\nelements in the scale \u03a3(A) of G(A). If g lies in \u03a3oc(A) then, under the identification\nof G(A) with Tr(Z), g is a non-negative integral matrix and has support in staircase\nform. Conversely, if g has staircase form and pii(g) \u2208 \u03a30(A) and pif (g) \u2208 \u03a30(A) then\ng \u2208 \u03a3oc(A). In a similar way, define \u03a3op(A), the subset of order preserving elements.\nWe are interested in lifting a pi-respecting group homomorphism \u03b3 : G(A1)\u2192 G(A2)\nto a star extendible regular embedding. The possible order conservation and order\npreservation properties which we might require of \u03b3 are that it be locally order\nconserving, locally order preserving, order conserving, or order preserving. (Order\nconservation or order preservation for \u03b3 means, of course, that \u03b3 maps \u03a3oc into \u03a3oc or\n\u03a3op into \u03a3op, respectively. The local versions mean that \u03b3 maps elements of \u03a3oc which\nhave only one non-zero entry into \u03a3oc or \u03a3op, as appropriate.) Of course, if \u03b3 can be\nlifted to a regular embedding \u03c6 with G(\u03c6) = \u03b3, then \u03c6 will necessarily have the same\norder conservation and order preservation properties as \u03b3. Since an embedding of\nany of these types is necessarily locally order conserving, it follows from Theorem 5\u00b72\nthat locally order preserving embeddings, order preserving embeddings, and order\nconserving embeddings all have liftings of the corresponding type.\nTheorem 5\u00b72. Let A1 and A2 be finite dimensional nest algebras. Let \u03b3 : G(A1) \u2192\nG(A2) be a locally order conserving homomorphism which is pi-respecting and for which\nthe restriction of \u03b3 to K0(A1) is a scaled group homomorphism. Then there is a locally\norder conserving star extendible embedding \u03c6 : A1 \u2192 A2 for which G(\u03c6) = \u03b3.\nWhile the proof of the theorem is somewhat technical, the existence of liftings of\nlocally order preserving embeddings is quite elementary for the following reason.\nWith the obvious notation, note that one can lift the images \u03b3([e12]), \u03b3([e23]), . . . ,\n\u03b3([er\u22121,r]) to order preserving regular partial isometries v1, v2, . . . , vr\u22121 in A2 with\nmatching initial and final projections\nv\u22171v1 = v2v\n\u2217\n2 , v\n\u2217\n2v2 = v3v\n\u2217\n3 , . . . , v\n\u2217\nr\u22122vr\u22122 = vr\u22121v\n\u2217\nr\u22121.\n(This uses the fact that \u03b3 preserves the scale and respects the group homomorphisms\npif and pii.) Since the order preserving partial isometries form a semigroupoid (ad-\nmissible products of order preserving partial isometries are order preserving) we can\ndefine \u03c6 as the unique star extendible embedding for which \u03c6(ei,i+1) = vi, 1 6 i 6 r\u22121.\nNow \u03b3 andG(\u03c6) are locally order preserving homomorphisms which are pi-respecting\nand agree on [e11], . . . , [err]. Since pii and pif determine an order preserving element\nit follows that \u03b3 = G(\u03c6).\nThis approach is not available for locally order conserving embeddings (since a\nproduct of two order conserving partial isometries can be a partial isometry which\nis not order conserving). However, Theorem 5\u00b72 follows quickly from the following\nlemma. To clarify the formulation of the lemma we remark that it is used to lift\n\u03b3([e12]) to a partial isometry which has order conserving products with a priori\nLimits of nest algebras 103\nliftings of \u03b3([eij]), for i > 2. This in turn enables an immediate proof of Theorem 5\u00b72\nby induction.\nLemma 5\u00b73. Let X = (xij), Y k = (ykij), and Zk = (zkij), 1 6 k 6 t, be matrices\nwith non-negative integral entries and with order conserving staircase form. Suppose\nthat X is p\u00d7 q, Y k is q \u00d7 rk, Zk is p\u00d7 rk and that pif (X) = pif (Zk), pii(X) = pif (Y k),\nand pii(Y k) = pii(Zk), for 1 6 k 6 t. Suppose moreover that v1, . . . , vt are block matrices\nwhich are regular partial isometries, with common final projections, for which each vk has\nrank distribution Y k. Then there is a regular partial isometry u, with rank distribution\nX and initial projection equal to v1v\u22171 , for which the products uvk are regular partial\nisometries with rank distribution ZK , for 1 6 k 6 t.\nProof. It will be enough to show that the assertion of the lemma follows if it is\nassumed that the lemma is true in the case of matrices of sizes p\u2032 \u00d7 q\u2032, q\u2032 \u00d7 r\u2032k and\np\u2032\u00d7 r\u2032k, where p\u2032 6 p, q\u2032 6 q, r\u2032k 6 rk, 1 6 k 6 t, and at least one of these inequalities\nis strict.\nWe may assume that all the entries x11, yk11 and z\nk\n11, 1 6 k 6 t are non-zero. The\nreason for this is that if a staircase form matrix has its first entry equal to zero,\nthen either the first row or the first column of the matrix is zero; the assertion then\nfollows from the induction hypothesis.\nLet d = min{x11, yk11, zk11 | 1 6 k 6 t}. Let e be a subprojection of v1v\u22171 (= viv\u2217i\nfor all i) which has rank d; let v\u2032k = evk; and let u\n\u2032 be a regular partial isometry of\nrank d with initial projection e and with p\u00d7 q rank distribution matrix of the form:\uf8ee\uf8ef\uf8ef\uf8ef\uf8f0\nd 0 . . . 0\n0 0 . . . 0\n...\n...\n...\n0 0 . . . 0\n\uf8f9\uf8fa\uf8fa\uf8fa\uf8fb .\nSet z\u2032k = u\n\u2032v\u2032i (= u\n\u2032vi), so that z\u2032k has a similar rank distribution matrix, of size\np \u00d7 rk. Consider now the matrices X\u02c6, Y\u02c6k and Z\u02c6k, which are obtained from X, Yk,\nand Zk by subtracting d from the first entry, together with the partial isometries\nv\u02c6k = vk \u2212 v\u2032k and notice that these satisfy the hypotheses of the lemma. By the\ninduction hypothesis, we may assume that there is a lifting u\u02c6 for X\u02c6 with u\u02c6\u2217u\u02c6 = v\u02c6kv\u02c6\u2217k,\nfor all k, such that u\u02c6v\u02c6k has rank distribution Z\u02c6k. Now u = u\u2032+ u\u02c6 is a partial isometry\nwith the properties needed to prove the lemma.\n5\u00b72. Classifications\nWe are now in a position to obtain a variety of classification results. Let Floc be\nthe family of embeddings between finite dimensional nest algebras which are locally\norder conserving and let Sys (Floc) be the family of systems A for which the given\nembeddings and their compositions are locally order conserving. Similarly define\nthe families Sys (Foc), Sys (Flop) and Sys (Fop) for order conserving, locally order\npreserving and order preserving embeddings.\nRecall that an isomorphism \u03b3 : Inv(A) \u2212\u2192 Inv(A\u2032) is an isomorphism of\nG(A) onto G(A\u2032) which respects K0, the scales, pii, and pif . More specifically,\n104 Alan Hopenwasser and Stephen Power\n\u03b3 : G(A) \u2212\u2192 G(A\u2032) satisfies:\n\u03b3(\u03a3(A)) = \u03a3(A\u2032),\n\u03b3(K0(A)) = K0(A\u2032),\n\u03b3(\u03a30(A)) = \u03a30(A\u2032),\n\u03b3 \u25e6 pii = pii \u25e6 \u03b3,\n\u03b3 \u25e6 pif = pif \u25e6 \u03b3.\nIn addition to the scale \u03a3(A) in G(A) we define the following subscales.\nDefinition 5\u00b74. The scale \u03a3oc(A) (respectively \u03a3op(A)) consists of the images of the\nclasses [v] in G(Ak) for which [i(v)] belongs to \u03a3oc(An) (respectively \u03a3op(An)) for all\nthe system maps i : Ak \u2192 An, for n > k.\nWe now define order conservation and local order conservation for scale preserv-\ning homomorphisms between the dimension distribution groups of systems. This is,\nof course, based on the corresponding definitions in the context of dimension distri-\nbution groups of digraph algebras (see the paragraph preceding Theorem 5\u00b72). One\ncan verify that \u03b3 is order conserving if, and only if, \u03b3(\u03a3oc(A)) \u2286 \u03a3oc(A\u2032). The order\npreserving and locally order preserving homomorphisms are defined similarly.\nDefinition 5\u00b75. Let \u03b3 : (G(A),\u03a3(A)) \u2212\u2192 (G(A\u2032),\u03a3(A\u2032)) be a scale preserving\nhomomorphism of dimension distribution groups so that for each n, there is an\ninteger kn such that \u03b3(G(An)) \u2286 G(A\u2032kn). We say that \u03b3 is order conserving if, for\neach n, the restriction of \u03b3 to G(An) is order conserving as a map from G(An) into\nG(A\u2032kn). Similarly, \u03b3 is locally order conserving if each such restriction is locally order\nconserving.\nThe following theorem gives in particular a sufficient condition for the regular\nisomorphism of systems in which all compositions are locally order conserving.\nTheorem 5\u00b76. Let A and A\u2032 be systems of finite dimensional nest algebras such that\nall compositions of embeddings are locally order conserving. Then the following statements\nare equivalent.\n(1) A and A\u2032 are isomorphic with locally order conserving crossover maps.\n(2) Inv(A) and Inv(A\u2032) are isomorphic via a locally order conserving isomorphism.\nProof. The usual scheme of proof that (2) implies (1) can be completed as follows.\nWith the aid of Theorem 5\u00b72, obtain a lifting of a suitable restriction\n\u03b31 : (G(An1 ),\u03a3(An1 ))\u2192 (G(A\u2032m1 ),\u03a3(A\u2032m1 ))\nto a locally order conserving star extendible homomorphism \u03c61. In the same way, the\nrestriction of \u03b3\u22121 to G(A\u2032m1 ) may be lifted to a locally order conserving embedding\n\u03c81. Since G(\u03c81 \u25e6 \u03c61) = G(\u03b2), where \u03b2 is a composition of the given embeddings for\nA, it follows that \u03c81 \u25e6\u03c61 is actually locally order conserving. From Theorem 3\u00b72 we\ncan replace \u03c81 by an inner unitary conjugate to obtain \u03c81 \u25e6 \u03c61 = \u03b2. Continuing in\nthis way, we obtain a commuting diagram for the desired isomorphism.\nThe same proof also works in the order conserving case; the next theorem classifies\norder conserving systems of finite dimensional nest algebras up to order conserving\ncommuting diagram isomorphism.\nLimits of nest algebras 105\nTheorem 5\u00b77. Let A and A\u2032 be systems of finite dimensional nest algebras with order\nconserving embeddings. Then the following statements are equivalent.\n(1) A and A\u2032 are isomorphic with order conserving crossover maps.\n(2) Inv(A) and Inv(A\u2032) are isomorphic via an order conserving isomorphism.\nWe also have parallel theorems for the order preserving and locally order preserv-\ning cases. The proofs are simpler in that Theorem 5\u00b72 may be replaced by the simpler\nlifting argument above for locally order preserving homomorphisms.\nTheorem 5\u00b78. Let A and A\u2032 be systems of finite dimensional nest algebras with order\npreserving embeddings. Then the following statements are equivalent.\n(1) A and A\u2032 are isomorphic with order preserving crossover maps.\n(2) Inv(A) and Inv(A\u2032) are isomorphic via an order preserving isomorphism.\nTheorem 5\u00b79. Let A and A\u2032 be systems of finite dimensional nest algebras such that\nall compositions of embeddings are locally order preserving. Then the following statements\nare equivalent.\n(1) A and A\u2032 are isomorphic with locally order preserving crossover maps.\n(2) Inv(A) and Inv(A\u2032) are isomorphic via a locally order preserving isomorphism.\nThe theorems above and also Theorem 5\u00b710 have exact counterparts for limits of\ndirect sums of finite dimensional nest algebras.\nRemark. It is natural to ask to what extent the hypotheses of the theorems above\ncan be relaxed. It can be shown for example that if \u03b8 : K0(A1) \u2192 K0(A2) is an\nisomorphism preserving the order preserving algebraic order Sop(\u2212) then there is a\nunique (up to conjugacy) locally order preserving lifting \u03c6 : A1 \u2192 A2. Here, Sop(A)\nis the set of pairs ([vv\u2217], [v\u2217v]) in \u03a30(A)\u00d7\u03a30(A) arising from order preserving partial\nisometries. This suggests that at the level of systems, an isomorphism \u03b3 : K0(A) \u2192\nK0(A\u2032) which maps Sop(A1) to Sop(A2) may lift to an isomorphism of systems. On the\nother hand, a composition of locally order preserving embeddings is not necessarily\nlocally order preserving and so the usual proof is not available (see also [18, errata]).\nThis suggests that such an isomorphism may not be sufficient for system or algebra\nisomorphism. In fact this problem is already present in the case of triangular systems\nwhere the order Sop(\u2212) agrees with the algebraic order S(\u2212). One way to settle the\nissue would be to show that even for alternation algebras the invariant (K0(\u2212), S(\u2212))\nis not a complete invariant.\nNext we give applications of Theorems 5\u00b77 and 5\u00b78 to the classification of algebraic\nlimits of order conserving and order preserving systems.\nLet A belong to Sys (Foc) or to Sys (Fop) with algebraic direct limitA0 = alg lim\u2212\u2212\u2212\u2212\u2192A.\nIt follows from Theorem 4\u00b73 that we may define Inv(A0) = Inv(A) as an invariant\nfor star extendible isomorphism. The next theorem shows that, in the Sys (Foc) case,\nthe definition \u03a3oc(A0) = \u03a3oc(A) also gives an invariant and that (Inv(A0),\u03a3oc(A0)) is\na complete invariant.\nTheorem 5\u00b710. Let A,A\u2032 be order conserving systems of finite dimensional nest\nalgebras and let A0, A\u20320 be their algebraic direct limits. Then A0 and A\n\u2032\n0 are star ex-\ntendibly isomorphic if, and only if, there is an isomorphism \u03b3 : Inv(A0)\u2192 Inv(A\u20320) such\nthat \u03b3(\u03a3oc(A0)) = \u03a3oc(A\u20320).\n106 Alan Hopenwasser and Stephen Power\nProof. In view of Theorem 5\u00b77, it will be sufficient to show that if A0, A\u20320 are star\nextendibly isomorphic then not only is the induced isomorphism of A,A\u2032 regular,\nbut the commuting diagram isomorphism may be implemented by order conserving\nembeddings. However this follows immediately from Lemma 4\u00b75\nAnd, of course, there is an analogous theorem in the order preserving context,\nwith \u03a3op(A0) = \u03a3op(A) an invariant and (Inv(A0),\u03a3op(A0)) a complete invariant.\nTheorem 5\u00b711. Let A,A\u2032 be order preserving systems of finite dimensional nest\nalgebras and let A0, A\u20320 be their algebraic direct limits. Then A0 and A\n\u2032\n0 are star ex-\ntendibly isomorphic if, and only if, there is an isomorphism \u03b3 : Inv(A0)\u2192 Inv(A\u20320) such\nthat \u03b3(\u03a3op(A0)) = \u03a3op(A\u20320)\nIt is a consequence of [2, theorem 3.6] that the operator algebra limits of order\npreserving systems of finite dimensional nest algebras are star extendibly isomorphic\nif, and only if, the algebraic limit algebras are isomorphic. Combining this with\nTheorem 5\u00b710 it follows that the operator algebras of order preserving systems may\nbe classified by (Inv(\u2212),\u03a3oc(\u2212)). We anticipate that the same is true in the order\nconserving case.\nWe conclude with some examples.\nExample 1. Let Ak = T2k \u2297 M2 and consider the embeddings \u03c6k : Ak \u2212\u2192 Ak+1\ngiven by \u03c6(a) = a\u2295 a (standard type embeddings). Then A = lim\u2212\u2192(Ak, \u03c6k)%S \u2297M2,\nwhere S = lim\u2212\u2192(T2k , \u03c3k) is the standard upper triangular 2\u221e limit algebra. Let X0 =\u220f\u221e\ni=1{0, 1} with the product topology. The spectrum (groupoid) R(C\u2217(S)) is the \u2018tails\nthe same\u2019 equivalence relation on X0 and the spectrum R(S) is the reverse lexico-\ngraphic sub-relation. R(M2) = {0, 1}\u00d7 {0, 1}, the full equivalence relation on {0, 1}.\nR(A) = R(M2)\u00d7R(S), the product relation acting on X = {0, 1} \u00d7X0. We have\n(i) K0(A)%C(X0,Z), the continuous integer valued functions on X0.\n(ii) \u03a30(A) = {\u03b1 \u2208 K0(A) | 0 6 \u03b1(x) 6 2, for all x \u2208 X0}.\n(iii) G(A) % Cc(R(S),Z), the continuous integer valued functions on R(S) with\ncompact support.\nWe may make the following interpretation: for each p \u2208 R(S), let K0(p) = K0(M2);\nthen G(A) can be identified with the space of compactly supported continuous func-\ntions on R(S) such that \u03c6(p) \u2208 K0(p), for all p.\nExample 2. Let B0 be the unital algebraic limit algebra B0 = alg lim\u2212\u2212\u2212\u2212\u2192 (Tnk , \u03c6k)\nwhere the embeddings \u03c6k are order preserving. Let\nA0 = alg lim\u2212\u2212\u2212\u2212\u2192 (Tnk \u2297Mmk , \u03c6k \u2297 \u03c8k)\nwhere each embedding \u03c8k : Mmk \u2192 Mmk+1 is a unital C*-algebra injection. Then\nA0 = B0 \u2297 D0 with D0 a unital ultramatricial algebra. As we observed at the end\nof Section 3, the maps \u03c6k \u2297 \u03c8k and their compositions are order preserving. In the\ndegenerate case \u03c6k = id : T2 \u2192 T2, G(A0) is naturally isomorphic to T2(Z)\u2297ZK0(D0).\nMore generally G(A0) can be identified naturally in terms ofK0(D0)-valued functions\non the spectrum (semigroupoid) R(B0) of B0.\nExample 3. Let B0 be the unital locally finite algebra B0 = alg lim\u2212\u2212\u2212\u2212\u2192 (Mnk , \u03c3k) where\nthe embeddings \u03c3k are standard embeddings (of direct sum form) with respect to the\nLimits of nest algebras 107\nusual matrix unit systems. Let Ak \u2286 Mnk be a nest algebra whose nest projections\nare ordered in a compatible way with the diagonal matrix units and suppose that\n\u03c3k(Ak) \u2286 Ak+1 for all k. Since the multiplicity one decomposition of \u03c3k is necessarily\nan ordered sum, it is clear that each \u03c3k is order conserving as a map from Ak to Ak+1.\nPlainly the algebra A0 contains the triangular algebra T \u03c30 = alg lim\u2212\u2212\u2212\u2212\u2192 (Tnk , \u03c3k). In fact\nit is the case that every intermediate algebra A\u20320, with the property T\n\u03c3\n0 \u2286 A\u20320 \u2286 B0\nis necessarily of this form. This can be seen by a straightforward application of\ninductivity arguments ([18, chapter 4]), in the setting of algebraic direct limits;\nA\u20320 = alg lim\u2212\u2212\u2212\u2212\u2192 (Ak, \u03c3k) where A\n\u2032\nk = A0 wC\n\u2217(Ak), and since A\u2032k contains Tnk , for each k,\nA\u2032k is a finite dimensional nest algebra. Also it follows similarly that if A\n\u2032 is a closed\nsubalgebra of a UHF C*-algebra which contains a triangular standard embedding\nlimit algebra, then A\u2032 is an order conserving limit of finite dimensional nest algebras.\nExample 4. In analogy with the last example consider a refinement limit presen-\ntation ofB0 together with its associated triangular refinement limit algebra T\n\u03c1\n0 . Then\nit can be shown that every intermediate algebra is an order conserving refinement\nlimit of finite dimensional nest algebras. This verification depends on the inductivity\nof the intermediate algebras and the fact that a refinement type embedding between\nfinite dimensional nest algebras is order conserving.\nThe most transparent intermediate algebras in this case are those nest subalgebras\nofB0 determined by a finite nest of T\n\u03c1\n0 -invariant projections. More generally however\nthe intermediate algebras are nest subalgebras of B0 determined by a nest of T\n\u03c1\n0 -\ninvariant projections in the weak closure of B0 in the tracial representation.\nExample 5. In a similar way one obtains that an intermediate operator algebra A\nsatisfying B \u2286 A \u2286 C\u2217(B), where B is an alternation algebra, is an order conserving\nlimit of finite dimensional nest algebras. In fact, the same result is valid whenever\nA is an intermediate algebra between a direct limit of Tn with order preserving\nembedding and its enveloping C\u2217-algebra.\nAcknowledgements. The authors thank Allan Donsig and Paul Haworth for several\nhelpful comments.\nREFERENCES\n[1] R. L. Baker. Triangular UHF algebras. J. Func. Anal. 91 (1990), 182\u2013212.\n[2] A. P. Donsig. Algebraic orders and chordal limit algebras. Proc. Edinburgh Math. Soc. 41\n(1998), 465\u2013485.\n[3] A. P. Donsig and A. Hopenwasser. Order preservation in limit algebras. J. Func. Anal. 133\n(1995), 342\u2013394.\n[4] A. P. Donsig and S. C. Power. The failure of approximate inner equivalence of standard\ndiagonals in regular limits of digraph algebras. Bull. Can. Math. Soc. 39 (1996), 420\u2013428.\n[5] A. P. Donsig and S. C. Power. Homology for operator algebras IV. J. Func. Anal. 150 (1997),\n240\u2013287.\n[6] A. P. Donsig and S. C. Power. The classification of limits of 2n-cycle algebras. Indiana Univ.\nMath. J. 48 (1999), 411\u2013127.\n[7] G. A. Elliott. On the classification of inductive limits of sequences of semisimple finite-\ndimensional algebras. J. Algebra 38 (1976), 29\u201344.\n[8] J. Glimm. On a certain class of operator algebras. Trans. Amer. Math. Soc. 95 (1960), 318\u2013340.\n[9] P. A. Haworth and S. C. Power. On the uniqueness of AF diagonals in regular limit algebras.\nJ. Funct. Anal., to appear.\n[10] D. Hefferman. Uniformly T2 algebras in approximately finite-dimensional C\u2217-algebras.\nJ. London Math. Soc. 55 (1997), 181\u2013192.\n108 Alan Hopenwasser and Stephen Power\n[11] A. Hopenwasser and S. C. Power. Classification of limits of upper triangular matrix algebras.\nProc. Edinburgh Math. Soc. 36 (1992), 107\u2013121.\n[12] P. S. Muhly and B. Solel. Subalgebras of groupoid C\u2217-algebras. J. Reine Angew. Math. 402\n(1989), 41\u201375.\n[13] J. R. Peters, Y.-T. Poon and B. H. Wagner. Triangular AF algebras. J. Operator Theory 23\n(1990), 81\u2013114.\n[14] Y.-T. Poon. A complete isomorphism invariant for a class of triangular UHF algebras.\nJ. Operator Theory 27 (1992), 221\u2013230.\n[15] S. C. Power. Classification of tensor products of triangular operator algebras. Proc. London\nMath. Soc. 61 (1990), 571\u2013614.\n[16] S. C. Power. The classification of triangular subalgebras of AF C\u2217-algebras. Bull. London\nMath. Soc. 22 (1990), 269\u2013272.\n[17] S. C. Power. Algebraic orders on K0 and approximately finite operator algebras. J. Operator\nTheory 27 (1992), 87\u2013106.\n[18] S. C. Power. Limit algebras: An introduction to subalgebras of C\u2217-algebras. Pitman Research\nNotes in Mathematics Series, vol. 278, Longman Scientific and Technical, England, New\nYork, 1992, Errata available at www.maths.lancs.ac.uk\/\u02dcpower\/pubs.brief.html.\n[19] S. C. Power. Relative positions of matroid algebras. J. Func. Anal. 165 (1999), 205\u2013239.\n[20] S. C. Power. Grothendieck group invariants for partly self-adjoint operator algebra. Intern.\nJ. Math. 11 (2000), 41-64.\n[21] S. C. Power. Approximately finitely acting operator algebras. J. Funct. Anal., to appear.\n"}