{"doi":"10.1088\/0305-4470","coreId":"102083","oai":"oai:epubs.surrey.ac.uk:1530","identifiers":["oai:epubs.surrey.ac.uk:1530","10.1088\/0305-4470"],"title":"Vorticity and symplecticity in Lagrangian fluid dynamics","authors":["Bridges, T. J.","Hydon, P. E.","Reich, Sebastien"],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2005-02-11","abstract":"<p>The relationship between potential vorticity (PV) and the symplectic form is explored, for the shallow-water equations governing Lagrangian particle paths. Starting with the symplectic form, the PV is found by the pullback operation to the reference space. At first sight, the encoding of PV in the symplectic form appears to be independent of the particle relabelling symmetry. The analysis is carried a step further in two ways. Using the \u2018conservation of symplecticity\u2019 as a starting point, the fluxes of symplecticity arise as differential forms, and a complete pull back of the flux forms leads to a geometric description of PV conservation. Secondly, symmetry methods are used to give a rigorous connection between particle relabelling, symplecticity and PV conservation. Generalizations of these issues to semi-geostrophic flow and three-dimensional Lagrangian fluid flows, and the connection with Ertel\u2019s theorem are also discussed.<\/p","downloadUrl":"","fullTextIdentifier":null,"pdfHashValue":null,"publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:epubs.surrey.ac.uk:1530<\/identifier><datestamp>\n      2017-10-31T14:02:15Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><setSpec>\n      6469766973696F6E733D656E67616E64706879736963616C736369656E636573:6D617468737075626C<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/epubs.surrey.ac.uk\/1530\/<\/dc:relation><dc:title>\n        Vorticity and symplecticity in Lagrangian fluid dynamics<\/dc:title><dc:creator>\n        Bridges, T. J.<\/dc:creator><dc:creator>\n        Hydon, P. E.<\/dc:creator><dc:creator>\n        Reich, Sebastien<\/dc:creator><dc:description>\n        <p>The relationship between potential vorticity (PV) and the symplectic form is explored, for the shallow-water equations governing Lagrangian particle paths. Starting with the symplectic form, the PV is found by the pullback operation to the reference space. At first sight, the encoding of PV in the symplectic form appears to be independent of the particle relabelling symmetry. The analysis is carried a step further in two ways. Using the \u2018conservation of symplecticity\u2019 as a starting point, the fluxes of symplecticity arise as differential forms, and a complete pull back of the flux forms leads to a geometric description of PV conservation. Secondly, symmetry methods are used to give a rigorous connection between particle relabelling, symplecticity and PV conservation. Generalizations of these issues to semi-geostrophic flow and three-dimensional Lagrangian fluid flows, and the connection with Ertel\u2019s theorem are also discussed.<\/p><\/dc:description><dc:date>\n        2005-02-11<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/epubs.surrey.ac.uk\/1530\/1\/fulltext.pdf<\/dc:identifier><dc:identifier>\n          Bridges, T. J., Hydon, P. E. and Reich, Sebastien  (2005) Vorticity and symplecticity in Lagrangian fluid dynamics   Journal of Physics A: Mathematical and General, 38 (6).  pp. 1403-1418.      <\/dc:identifier><dc:relation>\n        10.1088\/0305-4470\/38\/6\/015<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/epubs.surrey.ac.uk\/1530\/","10.1088\/0305-4470\/38\/6\/015"],"year":2005,"topics":[],"subject":["Article","PeerReviewed"],"fullText":"INSTITUTE OF PHYSICS PUBLISHING JOURNAL OF PHYSICS A: MATHEMATICAL AND GENERAL\nJ. Phys. A: Math. Gen. 38 (2005) 1403\u20131418 doi:10.1088\/0305-4470\/38\/6\/015\nVorticity and symplecticity in Lagrangian fluid\ndynamics\nThomas J Bridges1, Peter E Hydon1 and Sebastian Reich2\n1Department of Mathematics and Statistics, University of Surrey, Guildford, Surrey GU2 7XH,\nUK\n2Department of Mathematics, Imperial College, London SW7 2BZ, UK\nReceived 31 August 2004, in final form 1 December 2004\nPublished 26 January 2005\nOnline at stacks.iop.org\/JPhysA\/38\/1403\nAbstract\nThe relationship between potential vorticity (PV) and the symplectic form\nis explored, for the shallow-water equations governing Lagrangian particle\npaths. Starting with the symplectic form, the PV is found by the pull-\nback operation to the reference space. At first sight, the encoding of PV\nin the symplectic form appears to be independent of the particle relabelling\nsymmetry. The analysis is carried a step further in two ways. Using the\n\u2018conservation of symplecticity\u2019 as a starting point, the fluxes of symplecticity\narise as differential forms, and a complete pull back of the flux forms leads to\na geometric description of PV conservation. Secondly, symmetry methods are\nused to give a rigorous connection between particle relabelling, symplecticity\nand PV conservation. Generalizations of these issues to semi-geostrophic flow\nand three-dimensional Lagrangian fluid flows, and the connection with Ertel\u2019s\ntheorem are also discussed.\nPACS numbers: 02.30.Jr, 02.40.Yy, 45.20.Jj, 47.10.+g, 92.60.Bh\n1. Introduction\nIn Lagrangian fluid dynamics, the 1-form \u03b1 = \u3008u, dx\u3009 = u1 dx1 + u2 dx2 + u3 dx3 plays\nthe dual role of a circulation density and the generator for a canonical symplectic structure.\nThis elementary observation can easily be seen using the equations governing homogeneous\nincompressible Lagrangian fluid dynamics in two space dimensions\n\u2202u1\n\u2202t\n= \u2212 \u2202x2\n\u2202m2\n\u2202p\n\u2202m1\n+\n\u2202x2\n\u2202m1\n\u2202p\n\u2202m2\n,\n\u2202x1\n\u2202t\n= u1,\n\u2202u2\n\u2202t\n= \u2202x1\n\u2202m2\n\u2202p\n\u2202m1\n\u2212 \u2202x1\n\u2202m1\n\u2202p\n\u2202m2\n,\n\u2202x2\n\u2202t\n= u2.\n0305-4470\/05\/061403+16$30.00 \u00a9 2005 IOP Publishing Ltd Printed in the UK 1403\n1404 T J Bridges et al\nOne can take x1 = m1 and x2 = m2 at t = 0, where m = (m1,m2) are Lagrangian mass\ncoordinates on the reference space, p is the pressure, and the incompressibility constraint is\ndet(xm) = 1, where xm =\n[\n\u2202x1\n\u2202m1\n\u2202x1\n\u2202m2\n\u2202x2\n\u2202m1\n\u2202x2\n\u2202m2\n]\n.\nThis system can be interpreted as a constrained Hamiltonian system with the Hamiltonian\nfunction\nH(x, u, p) =\n\u222b\nH dm, where H = 12 \u3008u, u\u3009 + (1 \u2212 det(xm))p, (1.1)\nand the canonical representation is\uf8ee\uf8f00 \u2212I 0I 0 0\n0 0 0\n\uf8f9\uf8fb\uf8eb\uf8ed xu\np\n\uf8f6\uf8f8\n,t\n=\n\uf8eb\uf8ed\u03b4H\/\u03b4x\u03b4H\/\u03b4u\n\u03b4H\/\u03b4p\n\uf8f6\uf8f8 . (1.2)\nThe symplectic form for this system is the integral of the exterior derivative of the circulation\n1-form\n\u03c9 =\n\u222b\nd\u03b1 dm =\n\u222b\ndu \u2227 dx dm =\n\u222b\n(du1 \u2227 dx1 + du2 \u2227 dx2) dm, (1.3)\nwhere the line over \u03c9 signifies that it is integrated over m-space.\nOn the other hand, in the classical description, the circulation is obtained by integrating\nthe 1-form \u03b1 along a loop in the (x, u)-space, and by Stokes Theorem, the circulation can be\nrelated to a surface integral of the vorticity (cf Batchelor (1967), p 93). Comparison of this\nclassical observation with (1.3) suggests that it is natural to expect some connection between\nvorticity and symplecticity.\nWhen stripped of the integral, the density of the symplectic form, \u03c9 = d\u03b1, has the\nfollowing precise relation with vorticity:\n\u03c8\u2217\u03c9 = \u0004 dm1 \u2227 dm2. (1.4)\nHere, \u0004 is the vorticity in Lagrangian coordinates,\n\u0004 = \u2202x1\n\u2202m2\n\u2202u1\n\u2202m1\n\u2212 \u2202x1\n\u2202m1\n\u2202u1\n\u2202m2\n+\n\u2202x2\n\u2202m2\n\u2202u2\n\u2202m1\n\u2212 \u2202x2\n\u2202m1\n\u2202u2\n\u2202m2\n,\nand \u03c8\u2217 is the pull back3 mapping: it pulls the symplectic form from the phase space back to\nthe reference space m. In this context, the pull back is defined by\n\u03c8\u2217(dx) = \u2202x\n\u2202m1\ndm1 +\n\u2202x\n\u2202m2\ndm2, \u03c8\u2217(du) = \u2202u\n\u2202m1\ndm1 +\n\u2202u\n\u2202m2\ndm2.\nThe proof of (1.4) is therefore\n\u03c8\u2217\u03c9 = \u03c8\u2217(du \u2227 dx) = \u03c8\u2217(du) \u2227 \u03c8\u2217(dx)\n=\n(\n\u2202u\n\u2202m1\ndm1 +\n\u2202u\n\u2202m2\ndm2\n)\n\u2227\n(\n\u2202x\n\u2202m1\ndm1 +\n\u2202x\n\u2202m2\ndm2\n)\n=\n2\u2211\ni=1\n{(\n\u2202ui\n\u2202m1\ndm1 +\n\u2202ui\n\u2202m2\ndm2\n)\n\u2227\n(\n\u2202xi\n\u2202m1\ndm1 +\n\u2202xi\n\u2202m2\ndm2\n)}\n= \u0004 dm1 \u2227 dm2.\n3 The pull back in the context of continuum mechanics is sometimes called a Piola transformation; cf Casey and\nNaghdi (1991).\nVorticity and symplecticity in Lagrangian fluid dynamics 1405\nA similar argument applied to the shallow-water equations in geophysical fluid dynamics\nshows that the pull back of the symplectic form density there results in the potential vorticity.\nThe details of this construction are given in section 2. The only place in the literature that\nwe have seen the connection between potential vorticity and symplecticity discussed is in the\nwork of Abarbanel and Holm (1987) (see equation (81) on p 3375). There it is mentioned\nin passing that the pull back of the density of the symplectic form results in the potential\nvorticity, but the consequences of this observation are not studied. Arnold and Khesin (1998)\nemphasize that the vorticity can be characterized by a two form (see pp 22 and 46), but the\nconnection between vorticity and symplecticity is not explored.\nWhile the above examples and comments show a connection between vorticity or potential\nvorticity and symplecticity, there are several unanswered questions. The phase space variables\nx, u depend on (m1,m2, t). Why pull back to the label space m = (m1,m2)? Why not pull\nback to the full reference space (m1,m2, t)? Indeed, we find that this more general pull back is\nrelated to both vorticity conservation and energy conservation. Generalizations to (m, t) \u2208 R4\nare also considered and lead to a symplectic derivation of Ertel\u2019s theorem.\nFurther geometry is obtained by stripping away the integral in the 2-form which defines\nthe symplectic structure, leading to a conservation law which can be generated on the reference\nspace, a conservation law for symplecticity. This conservation law arises in a natural way when\nthe equations governing Lagrangian fluid dynamics, including geophysical fluid dynamics, are\nformulated in a multisymplectic setting. For the purposes of this paper a multisymplectic PDE\nis a system of PDEs of the form\nKz,t + Lz,1 + Mz,2 = \u2207zSM(z), z \u2208 Rn, (1.5)\nwhere K, L and M are skew-symmetric matrices and SM : Rn \u2192 R is a smooth function.\nEquivalently, such PDEs can be characterized as Lagrangian PDEs with the Lagrangian\nfunctional in the canonical form\nL =\n\u222b\nV\n{\n1\n2\n\u3008z, Mz,t \u3009 + 12 \u3008z, Kz,1\u3009 +\n1\n2\n\u3008z, Lz,2\u3009 \u2212 SM(z)\n}\ndt dx1 dx2,\nwhere \u3008 \u00b7 , \u00b7 \u3009 is a standard inner product on Rn and \u222bV is a volume integral. See Bridges\n(1997a, 1997b) for general properties of such systems.\nIn the multisymplectic setting, the fluxes of symplecticity arise as 2-forms. The symplectic\n2-form then satisfies a conservation law of the form\n\u2202\n\u2202t\n\u03c9 +\n\u2202\n\u2202m1\n\u03ba1 +\n\u2202\n\u2202m2\n\u03ba2 = 0, (1.6)\nwhere \u03ba1 and \u03ba2 are a pair of 2-forms that represent the flux of symplecticity. Pulling back\nthis equation to the label space, m, leads to\n\u2202\n\u2202t\n\u03c8\u2217\u03c9 +\n\u2202\n\u2202m1\n\u03c8\u2217\u03ba1 +\n\u2202\n\u2202m2\n\u03c8\u2217\u03ba2 = 0, (1.7)\nwhere \u03c8\u2217\u03ba1 and \u03c8\u2217\u03ba2 are 2-forms on the label space that represent the flux of potential\nvorticity.\nIt is in the investigation of the fluxes in the symplectic conservation law that the importance\nof particle relabelling and the homentropic nature of the fluid arises. For example, this\nformulation leads to the result that potential vorticity (or vorticity) is conserved on particle\npaths if and only if the divergence of the pull back of the flux 2-forms to the label space vanish\nidentically, that is if\ndiv(\u03c8\u2217\u03bal , \u03c8\u2217\u03ba2) = \u2207m \u00b7 \u03c8\u2217\u03ba = 0, \u03ba = (\u03ba1,\u03ba2)T. (1.8)\nWe will show that a sufficient condition for (1.8) to be satisfied is the Hamiltonian function is\ninvariant under particle relabelling (homentropic). Note that this derivation of PV conservation\n1406 T J Bridges et al\nis fundamentally different from the ones typically given in fluid dynamics (compare, for\nexample, Salmon (1998, p 302)).\nIn section 2, the Lagrangian form of the shallow water equations is treated in detail, and the\nfollowing features are treated in turn: the encoding of PV in symplecticity, the multisymplectic\nstructure that leads to a geometric form of PV conservation, the pull back as a generator of\nPV and energy conservation, and the use of symmetry methods to establish rigorously the\nconnection between particle relabelling and PV conservation.\nOne of the motivations of this paper is to understand the geometric structure of Lagrangian\nfluid dynamics in order to incorporate it into numerical methods. In section 4, we show how\nthe ideas in this paper can influence the design of numerical methods.\nThe ideas generalize in a straightforward way to other systems in Lagrangian fluid\ndynamics, and in section 4 we briefly consider the semi-geostrophic equations and three-\ndimensional Lagrangian incompressible fluid dynamics. Although not considered in this\npaper, another interesting direction where the relationship between vorticity and symplecticity\nhas been only partially explored is the area of relativistic fluid mechanics, where vorticity and\nsymplecticity play a central role in quantization (cf Jackiw et al (2004)).\n2. Multisymplectic GFD: shallow-water equations\nIn this section, the shallow-water equations will be considered in the Lagrangian particle-\npath representation. The connection between potential vorticity and symplecticity will be\nestablished, as will conditions for conservation of potential vorticity along particle paths, by\nconstructing the flux 2-forms associated with conservation of symplecticity.\nAs in the introduction, let x \u2208 R2, u \u2208 R2 represent the position and velocity of the\nfluid particles, parametrized by Lagrangian mass coordinates m = (m1,m2), and let h \u2208 R\nrepresent the fluid depth. The system is rotating at constant angular velocity f\/2.\nHenceforth, we use Latin indices to denote components of x and u, and Greek indices\nto denote components of m; the usual summation convention is adopted. Derivatives with\nrespect to t or m\u03b1 , for which all variables are regarded as functions of (m1,m2, t), are denoted\nby the subscript t or \u03b1 after a comma. For example,\nxi,\u03b1 = \u2202xi(m, t)\n\u2202m\u03b1\n, xi,\u03b1t = \u2202\n2xi(m, t)\n\u2202m\u03b1\u2202t\n, etc.\nPartial derivatives with respect to any other variable are written in full.\nDefine the Jacobian matrix\nxm =\n(\nx11 x12\nx21 x22\n)\nwhere xi\u03b1 \u2261 xi,\u03b1.\nConservation of mass reduces to h\u03c4 = 1 where \u03c4 = det(xm) = x11x22\u2212x12x21. The governing\nequations for u and x are\nu1,t = \u2212(x22 \u00b7 p),1 + (x21 \u00b7 p),2 + f u2, (2.1)\nu2,t = (x12 \u00b7 p),1 \u2212 (x11 \u00b7 p),2 \u2212 f u1, (2.2)\nx1,t = u1, (2.3)\nx2,t = u2. (2.4)\nThe pressure is defined by p = \u2212e\u2032(\u03c4 ) where e(\u03c4 ) is the specific internal energy for a\nhomentropic flow. The classical shallow-water equations are recovered by taking e(\u03c4 ) =\ng\/(2\u03c4), where g is the constant acceleration due to gravity.\nVorticity and symplecticity in Lagrangian fluid dynamics 1407\nIn terms of e(\u03c4 ), the equations of motion amount to\nu1,t \u2212 f x2,t =\n(\n\u2202e(\u03c4 )\n\u2202x11\n)\n,1 +\n(\n\u2202e(\u03c4 )\n\u2202x12\n)\n,2, (2.5)\nu2,t + f x1,t =\n(\n\u2202e(\u03c4 )\n\u2202x21\n)\n,1 +\n(\n\u2202e(\u03c4 )\n\u2202x22\n)\n,2, (2.6)\nx1,t = u1, (2.7)\nx2,t = u2. (2.8)\nThis system has a Hamiltonian representation with canonical coordinates (x, u):[\u2212f J \u2212I\nI 0\n](\nx\nu\n)\nt\n=\n(\n\u03b4H\/\u03b4x\n\u03b4H\/\u03b4u\n)\n, J =\n(\n0 \u22121\n1 0\n)\n,\nwhere\nH(x, u) =\n\u222b\nH dm, H = 1\n2\n\u3008u, u\u3009 + e(\u03c4 ). (2.9)\nThe symplectic form for this system is\n\u03c9 =\n\u222b\n\u03c9 dm, \u03c9 = du1 \u2227 dx1 + du2 \u2227 dx2 + f dx1 \u2227 dx2.\nWe will prove that \u03c8\u2217\u03c9 = q dm1 \u2227 dm2, where q is the potential vorticity. However, we first\nrecast the system into a multisymplectic formulation in order to deduce further information.\n2.1. A multisymplectic formulation\nIntroduce the additional variables\nwi\u03b1 \u2261 \u2212 \u2202H\n\u2202xi\u03b1\n= \u2212\u2202e(\u03c4 )\n\u2202xi\u03b1\n= \u2212e\u2032(\u03c4 ) \u2202\u03c4\n\u2202xi\u03b1\n= p(\u03c4) \u2202\u03c4\n\u2202xi\u03b1\n,\nand the extended set of dependent variables\nz = (x1, x2, u1, u2, w11, w12, w21, w22, x11, x12, x21, x22)T, (2.10)\nso that z \u2208 R12. Then (2.5)\u2013(2.8) can be written as the following system of first-order PDEs:\n\u2212u1,t + f x2,t \u2212 w11,1 \u2212 w12,2 = 0,\n\u2212u2,t \u2212 f x1,t \u2212 w21,1 \u2212 w22,2 = 0,\nxi,t = ui, i = 1, 2,\nxi,\u03b1 = xi\u03b1, i = 1, 2, \u03b1 = 1, 2,\n0 = \u2202e(\u03c4 )\n\u2202xi\u03b1\n+ wi\u03b1, i = 1, 2, \u03b1 = 1, 2.\nThis system is of the form (1.5) with\nSM(z) = H + xi\u03b1wi\u03b1 = 12 \u3008u, u\u3009 + e(\u03c4 ) + xi\u03b1wi\u03b1. (2.11)\nHere K, L, M \u2208 R12\u00d712 are skew-symmetric matrices with nonzero entries\nK1,2 = f, K1,3 = \u22121, K2,1 = \u2212f, K2,4 = \u22121, K3,1 = 1,\nK4,2 = 1, L1,5 = \u22121, L2,7 = \u22121, L5,1 = 1, L7,2 = 1,\nM1,6 = \u22121, M2,8 = \u22121, M6,1 = 1, M8,2 = 1.\n1408 T J Bridges et al\nNote that SM(z) in (2.11) is defined locally (for it involves no integration over the reference\nspace), and it differs from the classical Hamiltonian function densityH by the third term. The\nfollowing identities hold:\nxi\u03b1\n\u2202\u03c4\n\u2202xi\u03b2\n= \u03c4\u03b4\u03b1\u03b2, xi\u03b1 \u2202\u03c4\n\u2202xj\u03b1\n= \u03c4\u03b4ij ,\nwhere \u03b4 is the Kronecker delta. Therefore,\nxi\u03b1wi\u03b2 = \u2212\u03c4e\u2032(\u03c4 )\u03b4\u03b1\u03b2, xi\u03b1wj\u03b1 = \u2212\u03c4e\u2032(\u03c4 )\u03b4ij , (2.12)\nand so the multisymplectic Hamiltonian density SM can be reduced to the form\nSM(z) = 12 \u3008u, u\u3009 + e(\u03c4 ) \u2212 2\u03c4e\u2032(\u03c4 ). (2.13)\nHowever, in order for (1.5) to yield the multisymplectic shallow-water equations, SM(z) must\nbe expressed in terms of the multisymplectic coordinates, i.e., in the form (2.11).\nThe abstract formulation (1.5) gives rise to a conservation law of symplecticity4 (Bridges\n1997b)\n(dz \u2227 K dz),t + (dz \u2227 L dz),1 + (dz \u2227 M dz),2 = 0, (2.14)\nwhich, for the present system, amounts to\n\u03c9,t + \u03ba\u03b1,\u03b1 = 0, (2.15)\nwhere\n\u03c9 = dui \u2227 dxi + f dx1 \u2227 dx2 and \u03ba\u03b1 = dwi\u03b1 \u2227 dxi, \u03b1 = 1, 2.\n2.2. Pull back and the geometry of conservation laws\nIn this section, we explore in detail the connection between conservation of symplecticity, the\npull-back operation, and conservation laws, in the setting of the shallow-water equations.\nThe potential vorticity for the shallow-water system is\nq = h\u22121\n(\nf +\n\u2202u2\n\u2202x1\n\u2212 \u2202u1\n\u2202x2\n)\n= f \u03c4 + xi2ui,1 \u2212 xi1ui,2,\nwhere the second expression is in Lagrangian mass coordinates satisfying \u03c4h = 1. Let \b\u2217\nrepresent the pull-back operation from the phase space to the full reference space, (m, t).\nApplication to the symplectic 2-form results in\n\b\u2217\u03c9 = (ui,t dt + ui,\u03b2 dm\u03b2) \u2227 (xi,t dt + xi\u03b3 dm\u03b3 )\n+ f (x1,t dt + x1\u03b2 dm\u03b2) \u2227 (x2,t dt + x2\u03b3 dm\u03b3 )\n= {xi,tui,\u03b2 \u2212 xi\u03b2ui,t + f (x1\u03b2x2,t \u2212 x1,t x2\u03b2)} dm\u03b2 \u2227 dt\n+ {xi2ui,1 \u2212 xi1ui,2 + f (x11x22 \u2212 x12x21)} dm1 \u2227 dm2\n= {xi,tui,\u03b2 \u2212 xi\u03b2ui,t + f (x1\u03b2x2,t \u2212 x1,t x2\u03b2)} dm\u03b2 \u2227 dt + q dm1 \u2227 dm2,\nand\n\b\u2217\u03ba\u03b1 = (wi\u03b1,t dt + wi\u03b1,\u03b2 dm\u03b2) \u2227 (xi,t dt + xi\u03b3 dm\u03b3 )\n= {xi,twi\u03b1,\u03b2 \u2212 xi\u03b2wi\u03b1,t } dm\u03b2 \u2227 dt + {xi2wi\u03b1,1 \u2212 xi1wi\u03b1,2} dm1 \u2227 dm2.\n4 The term \u2018balance equation of symplecticity\u2019 may also be an appropriate descriptor because conservation in time\nof symplecticity does not follow without appropriate boundary conditions.\nVorticity and symplecticity in Lagrangian fluid dynamics 1409\nEvaluating (\b\u2217\u03c9, \b\u2217\u03ba\u03b1) on the set of solutions of the shallow-water equations, and taking\n(2.12) into account, we finally obtain\n\b\u2217\u03c9 = {uiui,\u03b2 + xi\u03b2wi\u03b3,\u03b3 } dm\u03b2 \u2227 dt + q dm1 \u2227 dm2\n= {uiui,\u03b2 + (xi\u03b2wi\u03b3 ),\u03b3 \u2212 xi,\u03b2\u03b3 wi\u03b3 } dm\u03b2 \u2227 dt + q dm1 \u2227 dm2\n= { 12 \u3008u, u\u3009 \u2212 \u03c4e\u2032(\u03c4 ) + e(\u03c4 )},\u03b2 dm\u03b2 \u2227 dt + q dm1 \u2227 dm2,\nand\n\b\u2217\u03ba\u03b1 = {(uiwi\u03b1),\u03b2 \u2212 (xi\u03b2wi\u03b1),t } dm\u03b2 \u2227 dt + {(xi2wi\u03b1),1 \u2212 (xi1wi\u03b1),2} dm1 \u2227 dm2\n= {(uiwi\u03b1),\u03b2 + \u03b4\u03b1\u03b2(\u03c4e\u2032(\u03c4 )),t } dm\u03b2 \u2227 dt + {\u03b4\u03b11(\u03c4e\u2032(\u03c4 )),2 \u2212 \u03b4\u03b12(\u03c4e\u2032(\u03c4 )),1} dm1 \u2227 dm2.\nThe pull-back operator \b\u2217 commutes with total differentiation with respect to t, m1, or m2.\nConsequently,\n\b\u2217\u03ba\u03b1,\u03b1 = {(uiwi\u03b1),\u03b1\u03b2 + (\u03c4e\u2032(\u03c4 )),t\u03b2} dm\u03b2 \u2227 dt;\nnote that the dm1 \u2227 dm2 component is zero. Therefore, the multisymplectic conservation law\n(2.15) is pulled back to\n0 = \b\u2217(\u03c9,t + \u03ba\u03b1,\u03b1) = q,t dm1 \u2227 dm2 +\n{( 1\n2 \u3008u, u\u3009 + e(\u03c4 )\n)\n,t\n+ (uiwi\u03b1),\u03b1\n}\n,\u03b2\ndm\u03b2 \u2227 dt.\nSeparating this conservation law into its three components, we obtain\nq,t = 0, (2.16){( 1\n2 \u3008u, u\u3009 + e(\u03c4 )\n)\n,t\n+ (uiwi\u03b1),\u03b1\n}\n,\u03b2\n= 0, \u03b2 = 1, 2. (2.17)\nThe dm1 \u2227 dm2 component (2.16) encapsulates the conservation of potential vorticity on\nparticle paths. Note that the label-space divergence of the flux of potential vorticity is zero.\nThe relation between q and Beltrami\u2019s material vorticity in the shallow-water theory is given\nby Viu\u00b4dez (2001). In the next subsection, the geometry of this material conservation of PV\nwill be examined in more detail.\nThe other conservation laws generated automatically by the pull back in (2.17) are label-\nspace derivatives of the local energy conservation law:( 1\n2 \u3008u, u\u3009 + e(\u03c4 )\n)\n,t\n+ (uiwi\u03b1),\u03b1 = 0. (2.18)\nThis conservation law implies that the total energy E is conserved, i.e.,\n\u2202tE = \u2202t\n\u222b 1\n2\n\u3008u, u\u3009 + e(\u03c4 ) dm = 0,\nprovided that appropriate boundary conditions are given.\n2.3. The origin of conservation laws obtained by pull back\nThe idea of pulling back conservation laws to the reference space can be put on a more\ngeneral footing. Hydon (2004) shows that for any multisymplectic system of PDEs (1.5), the\n2-form conservation laws are obtained by differentiating conservation laws that correspond to\ntranslational symmetry in each independent variable.\nFor the multisymplectic shallow-water equations, translations in t produce energy\nconservation (2.18). Translations in label space produce the following interesting conservation\nlaws:\n(uixi1 + f x1x21),t +\n(\ne(\u03c4 ) \u2212 12uiui \u2212 f x1u2 + xi1wi1\n)\n,1 + (xi1wi2),2 = 0; (2.19)\n(uixi2 + f x1x22),t + (xi2wi1),1 +\n(\ne(\u03c4 ) \u2212 12uiui \u2212 f x1u2 + xi2wi2\n)\n,2 = 0. (2.20)\n1410 T J Bridges et al\nThese can be regarded as expressing conservation of \u2018Lagrangian momentum\u20195. It has already\nbeen shown that the two conservation laws in (2.17) are obtained as label-space derivatives\nof (2.18). It is easy to verify that the potential vorticity conservation law (2.16) is a differential\nconsequence of (2.19) and (2.20). Specifically, (2.16) is the m1-derivative of (2.20) minus\nthe m2-derivative of (2.19). Hence, from the Lagrangian viewpoint, (2.19) and (2.20) are\nmore fundamental than (2.16); unlike potential vorticity, however, they are strictly Lagrangian\nconcepts and cannot be written solely in Eulerian variables.\n2.4. Symmetries and multisymplectic conservation laws\nIf a system of equations stems from a variational principle, Noether\u2019s theorem links\nconservation laws with symmetries of the Lagrangian form (which are called variational\nsymmetries). Noether\u2019s theorem has been extended to Hamiltonian systems (see Olver (1993)),\nand is applied to particle relabelling symmetries in Egger (1994), Padhye and Morrison (1996),\nPadhye (1998) and Albert (1997a, 1997b). Indeed, Padhye and Morrison (1996) write down\nthe generalized form of the relabelling symmetry, and identify all known symmetries of the\nLagrangian and Euler\u2013Lagrange map. The corresponding conserved quantities of the ideal\nfluid were summarized in both Lagrangian and Hamiltonian frameworks by Padyhe (1998).\nThe shallow-water equations (2.5)\u2013(2.8) possess various point symmetries, which can\nbe found systematically using the approach pioneered by Lie (see Hydon (2000) for a\nsimple introduction). Bila (2002) gives the most complete study of the symmetries and\nconservation laws of the shallow-water equations. However, the approach here, based on\nthe multisymplectic formulation leads to a connection between the fluxes of the conservation\nlaw and symmetry. A restricted form of Noether\u2019s theorem for multisymplectic systems was\nfirst derived in (cf Bridges (1997a, appendix C). A general form of Noether\u2019s theorem for\nmultisymplectic systems can be found in Hydon (2004).\nThe simplest symmetries of the shallow-water equations are the invariance under\ntranslations x \t\u2192 x + \u03b5 for any \u03b5 \u2208 R2. These symmetries lead to the unremarkable\nconservation laws (2.5) and (2.6).\nThe symmetries that lead to conservation of potential vorticity and total energy are\nparticle relabelling and time-translation, respectively. It can be shown that these are the only\nsymmetries that have no effect upon (and are independent of) the variables x and u.\nThe implication of relabelling symmetry seems to have been first pointed out by Newcomb\n(1967), who discovered a relabelling symmetry for incompressible ideal fluid without internal\nenergy. The connection between the conservation of potential vorticity and a Lagrangian\n(variational) symmetry was first pointed out by Ripa (1981) in the context of incompressible\nstratified flows, and Salmon (1982) notes the connection as well. Newcomb (1967) and\nBretherton (1970) have also related relabelling symmetry to Kelvin\u2019s circulation theorem.\nIn this section, we demonstrate that the relabelling and time-translation symmetries are\nencoded in the multisymplectic conservation law, explaining why the pull back of this law\nproduces conservation of total energy and potential vorticity.\nA particle relabelling transformation is a diffeomorphism of the label space:\n\u000b : (m1,m2) \t\u2192 (m\u02c61(m1,m2), m\u02c62(m1,m2)) .\nNeither x nor u are affected by any such transformation. However, the Hamiltonian density\nH depends on an arbitrary function e(\u03c4 ), so the transformation is a symmetry for every e(\u03c4 )\n5 Momentum is in quotes here because it is not the physical momentum. It is the conserved quantity associated with\ninvariance of the equations under translations in the reference space.\nVorticity and symplecticity in Lagrangian fluid dynamics 1411\nonly if \u03c4 is invariant. (It is easy to verify that this necessary condition is also sufficient.) By\ndefinition,\n\u03c4 = det(xm) = det(xm\u02c6) det(m\u02c6m) where det(m\u02c6m) = m\u02c61,1m\u02c62,2 \u2212 m\u02c61,2m\u02c62,1.\nTherefore, \u03c4 is invariant if and only if\ndet(m\u02c6m) = 1, (2.21)\nso that \u000b is an area-preserving transformation. The set of all particle relabelling symmetries is\nan infinite-dimensional Lie (pseudo-) group. Every one-parameter Lie subgroup of this group\nhas a generator of the form\nX = \u03c6,2 \u2202\n\u2202m1\n\u2212 \u03c6,1 \u2202\n\u2202m2\n,\nfor some smooth function \u03c6(m). A function F(m, t, x, u) is invariant under the subgroup\ngenerated by X if and only if XF = 0. If F also depends upon derivatives of x and u, the same\ncondition for invariance applies once X has been prolonged to take account of the group action\non derivatives. For example, \u03c4 is a function of the first derivatives xi\u03b1 . The prolongation of\nthe generator to these derivatives is\nX(1) = \u03c6,2 \u2202\n\u2202m1\n\u2212 \u03c6,1 \u2202\n\u2202m2\n+ {xi2\u03c6,1\u03b1 \u2212 xi1\u03c6,2\u03b1} \u2202\n\u2202xi\u03b1\n, (2.22)\nand therefore\nX(1)\u03c4 = x22(x12\u03c6,11 \u2212 x11\u03c6,21) \u2212 x21(x12\u03c6,12 \u2212 x11\u03c6,22)\n\u2212 x12(x22\u03c6,11 \u2212 x21\u03c6,21) + x11(x22\u03c6,12 \u2212 x21\u03c6,22) = 0,\nwhich is to be expected, because we obtained the relabelling symmetries by requiring that \u03c4\nis invariant.\nBefore we examine the link between the particle relabelling symmetries and conservation\nof potential vorticity within the multisymplectic framework, it is instructive to seek\ngeneralizations of the Hamiltonian density H that retain the particle relabelling symmetries.\nWe restrict attention to densities of the form\nH\u02dc = H\u02dc(t, x, u, xm),\nso that the resulting Hamiltonian system can be recast as a multisymplectic system, using the\nmatrices K, L, M that were defined in section 2.1. Consequently, the conservation law (2.15)\nholds for the same 2-forms \u03c9 and \u03ba\u03b1 that were used earlier, bearing in mind that the auxiliary\nvariables wi\u03b1 are now defined as follows:\nwi\u03b1 = \u2212 \u2202H\u02dc\n\u2202xi\u03b1\n.\nIf H\u02dc has no explicit dependence on t, it is invariant under translations in time. The density H\u02dc\nis invariant under the particle relabelling symmetries generated by X if and only if\nX(1)H\u02dc \u2261 (X(1)t) \u2202H\u02dc\n\u2202t\n+ (X(1)xi)\n\u2202H\u02dc\n\u2202xi\n+ (X(1)ui)\n\u2202H\u02dc\n\u2202ui\n+ (X(1)xi\u03b1)\n\u2202H\u02dc\n\u2202xi\u03b1\n= 0.\nBut\nX(1)t = X(1)xi = X(1)ui = 0,\nso H\u02dc can depend arbitrarily on t, x and u. Given any smooth function F(xm),\nX(1)F (xm) = {xi2\u03c6,1\u03b1 \u2212 xi1\u03c6,2\u03b1}\u2202F (xm)\n\u2202xi\u03b1\n= \u03c6,11xi2 \u2202F (xm)\n\u2202xi1\n+ \u03c6,12\n(\nxi2\n\u2202F (xm)\n\u2202xi2\n\u2212 xi1 \u2202F (xm)\n\u2202xi1\n)\n\u2212 \u03c6,22xi1 \u2202F (xm)\n\u2202xi2\n,\n1412 T J Bridges et al\nso for F(xm) to be invariant under arbitrary particle relabelling transformations, the following\nconditions must hold:\nxi2\n\u2202F (xm)\n\u2202xi1\n= 0, xi2 \u2202F (xm)\n\u2202xi2\n\u2212 xi1 \u2202F (xm)\n\u2202xi1\n= 0, xi1 \u2202F (xm)\n\u2202xi2\n= 0.\nBy using the method of characteristics, it is easy to show that F is invariant if and only if it\nis a function of \u03c4 alone. Therefore, H\u02dc admits the group of particle relabelling symmetries\nprovided that it is a function of t, x, u and \u03c4 only. Note that this result is based solely on\nmathematical considerations. There may be good physical reasons for restricting the class of\nallowable functions still further. For example, the governing equations include\nxi,t = \u2202H\u02dc\n\u2202ui\n,\nso if u is to represent the particle velocity, the most general form that H\u02dc can take is\nH\u02dc = 12 \u3008u, u\u3009 + \u03c3(t, x, \u03c4 ),\nfor some function \u03c3 .\nOur main observation is that whatever functional form H\u02dc(t, x, u, \u03c4 ) takes, potential\nvorticity is conserved on the solutions of the system (1.5), where now\nSM = H\u02dc + xi\u03b1wi\u03b1.\nThis PV conservation can be seen by substituting (1.5) into\n\b\u2217\u03c9 = {xi,tui,\u03b2 \u2212 xi\u03b2ui,t + f (x1\u03b2x2,t \u2212 x1,t x2\u03b2)} dm\u03b2 \u2227 dt + q dm1 \u2227 dm2,\n\b\u2217\u03ba\u03b1 = {xi,twi\u03b1,\u03b2 \u2212 xi\u03b2wi\u03b1,t } dm\u03b2 \u2227 dt + {xi2wi\u03b1,1 \u2212 xi1wi\u03b1,2} dm1 \u2227 dm2,\nand rearranging terms in the same way as in the previous section. After a slightly messy\ncalculation, we obtain\n\b\u2217\u03c9 =\n{\nH\u02dc\u2212 \u03c4 \u2202H\u02dc\n\u2202\u03c4\n}\n,\u03b2\ndm\u03b2 \u2227 dt + q dm1 \u2227 dm2,\n\b\u2217\u03ba\u03b1 =\n{\n(uiwi\u03b1),\u03b2 + \u03b4\u03b1\u03b2\n(\n\u03c4\n\u2202H\u02dc\n\u2202\u03c4\n)\n,t\n}\ndm\u03b2 \u2227 dt\n+\n{\n\u03b4\u03b11\n(\n\u03c4\n\u2202H\u02dc\n\u2202\u03c4\n)\n,2\n\u2212 \u03b4\u03b12\n(\n\u03c4\n\u2202H\u02dc\n\u2202\u03c4\n)\n,1\n}\ndm1 \u2227 dm2.\nTherefore, the pull back of the multisymplectic conservation law is\n\b\u2217(\u03c9,t + \u03ba\u03b1,\u03b1) = {H\u02dc,t + (uiwi\u03b1),\u03b1},\u03b2 dm\u03b2 \u2227 dt + q,t dm1 \u2227 dm2 = 0.\nHence, if the Hamiltonian density is invariant under arbitrary area-preserving particle\nrelabelling transformations, potential vorticity is conserved. Furthermore, the remaining\ncomponents of the conservation law lead to the result\n\b\u2217(H\u02dc,t + (uiwi\u03b1),\u03b1) = f (t),\nfor some function f . From the equations of motion, we obtain\nf (t) = \b\u2217\n(\n\u2202H\u02dc\n\u2202t\n)\n,\nso f (t) = 0 if H\u02dc is invariant under translations in time. For the shallow water equations, this\nleads to the local energy conservation law (2.18).\nVorticity and symplecticity in Lagrangian fluid dynamics 1413\nHow is the conservation of potential vorticity encoded in the multisymplectic 2-forms?\nTo answer this question, it is sufficient to restrict attention to the dm1 \u2227 dm2 component. First\nnote that\n\u03c9 = dui \u2227 dxi + f dx1 \u2227 dx2 (2.23)\nis invariant under particle relabelling symmetries, because xi and ui are invariant and the\nexterior derivative d is essentially coordinate-invariant. Neither of the flux 2-forms \u03ba\u03b1 is\ninvariant; however, we have shown that if the Hamiltonian density is invariant under particle\nrelabelling then the dm1 \u2227 dm2 component of \b\u2217\u03ba\u03b1,\u03b1 vanishes. Finally, the pull back of \u03c9 to\nlabel space is the product of the potential vorticity and the 2-form dm1 \u2227 dm2 (which is itself\ninvariant under the relabelling symmetries). Consequently, q,t = 0.\n3. Particle methods and conservation of potential vorticity\nIn this section, we discuss symplecticity and conservation of PV for a Lagrangian particle\ndiscretization of the shallow-water equations. Particle methods, such as smoothed particle\nhydrodynamics (SPH) (cf Monaghan (1992) and also Salmon (1983) in the context of the\nshallow-water equations), are based on an approximation of the layer depth of type\nh(x, t) =\nN\u2211\nk=1\nmk\u03c8(\u2016x \u2212 Xk(t)\u2016), (3.1)\nwhere \u03c8(r) \u0001 0 is an appropriate shape function and Xk(t) are Lagrangian particles with\nmass mk following the fluid flow. Let us assume for a moment that h(x, t) is given (or has\nbeen computed). Then each particle position x(m, t) satisfies the following time-dependent\nHamiltonian ODE:\nx,t = u, u,t = \u2212f Ju \u2212 g\u2207xh(x, t). (3.2)\nIt is obvious that the symplectic 2-form \u03c9, defined by (2.23), is conserved along solutions\nand, as pointed out before, this gives rise to conservation of PV. In fact, this observation gives\na new interpretation of the statement made by Abarbanel and Holm (1987) (see equation (81)\non p 3375) in the context of the primitive unapproximated fluid equations.\nIt is worth carrying this thought experiment a step further. Following this point of view\u2014\ntaking h as given\u2014conservation of PV can be shown for the induced two degrees-of-freedom\nHamiltonian system of the above form (3.2) with h any arbitrary (possibly time-dependent)\npotential energy function. The restriction of the associated symplectic 2-form \u03c9 is to be taken\nin the following sense. Consider a family of solutions (x(m, t), u(m, t)) \u2208 R4 parametrized by\ntheir initial positions m = x(0), then the pull back described in section 1 leads to conservation\nof PV. We also note that the equivalent of (3.2) for Euler\u2019s equation of an irrotational ideal fluid\nis used by Arnold et al (1993) (see equation (28) on p 29) to show conservation of circulation\nvia the associated Poincare\u00b4\u2013Cartan integral invariant.\nOf course, the above point of view is not equivalent to the multi-symplectic approach\nwhere the layer-depth h is also treated as a dynamical variable and where \u03c9 is no longer\nconstant along solutions of the full fluid equations of motion. We will come back to this point\nbelow.\nAnother standard result (e.g., Frank and Reich (2003)) states that the layer-depth\napproximation (3.1) satisfies a continuity equation\nh,t = \u2212\u2207x(hu\u00af)\n1414 T J Bridges et al\nwith the velocity field u\u00af(x, t) appropriately defined. Hence, the energy (Bernoulli function)\nof each particle in the flow changes according to\nd\ndt\n(\n1\n2\n\u2016u(t)\u20162 + gh(x(t), t)\n)\n= \u2212g\u2207x(hu\u00af).\nSo far we have assumed the discrete particle paths Xk(t), k = 1, . . . , N , in (3.1) as given.\nHence, the next step is to set up a closed system of equations for {Xk}k=1,...,N . In smoothed\nparticle hydrodynamics these equations are given by\nd2\ndt2\nXk = \u2212f J ddt Xk \u2212 g\u2207Xk h(Xk, {Xl})\nwith\nh(Xk, {Xl}) =\nN\u2211\nl=1\nml\u03c8(\u2016Xk \u2212 Xl\u2016).\nAgain, we can associate a symplectic form with each particle Xk . Let us denote this form by\n\u03c9k . While we had ddt \u03c9k = 0 along solutions x(mk, t) = Xk(t) of (3.2), we now treat h as a\ndynamic variable and obtain\nd\ndt\n\u03c9k = \u2212g\nN\u2211\nl=1\ndXk \u2227 mlDXkXl\u03c8(\u2016Xk \u2212 Xl\u2016) dXl ,\nwhich can be viewed as a discretization of the multi-symplectic conservation law (2.15).\nSince the label space has been replaced by N point labels mk , a pull back of the symplectic\nconservation law to label space is no longer possible. Hence, conservation of PV holds for\nparticle methods only in the sense of a single two degrees-of-freedom Hamiltonian ODE (3.2)\nwith a continuous set of initial data. This \u2018continuum\u2019 interpretation of particle methods is\nthe backbone of the argument suggested by Frank and Reich (2003) to prove conservation of\ncirculation for the discretized system.\n4. Symplecticity and vorticity for other ideal-fluid models\nIn this section, we briefly describe the implications of the constructions in section 2 based\non conservation of symplecticity for other models in Lagrangian fluid dynamics. For three-\ndimensional Lagrangian fluid dynamics the main result is that the pull back to the reference\nspace of the symplectic form leads to Ertel\u2019s theorem.\n4.1. Semi-geostrophic shallow-water equations\nIn the semi-geostrophic approximation (cf Salmon (1988), Roulstone and Norbury (1994),\nRoulstone and Sewell (1997)), the shallow-water equations (2.5)\u2013(2.8) are replaced by\nu1,t \u2212 f x2,t =\n(\n\u2202e(\u03c4 )\n\u2202x11\n)\n,1 +\n(\n\u2202e(\u03c4 )\n\u2202x12\n)\n,2, (4.1)\nu2,t + f x1,t =\n(\n\u2202e(\u03c4 )\n\u2202x21\n)\n,1 +\n(\n\u2202e(\u03c4 )\n\u2202x22\n)\n,2, (4.2)\n0 = f u1 \u2212\n(\n\u2202e(\u03c4 )\n\u2202x21\n)\n,1 \u2212\n(\n\u2202e(\u03c4 )\n\u2202x22\n)\n,2, (4.3)\n0 = f u2 +\n(\n\u2202e(\u03c4 )\n\u2202x11\n)\n,1 +\n(\n\u2202e(\u03c4 )\n\u2202x12\n)\n,2, (4.4)\nVorticity and symplecticity in Lagrangian fluid dynamics 1415\nwhere\ne(\u03c4 ) = g\n2\u03c4\n. (4.5)\nHere, u is the geostrophic velocity, not the particle velocity (which is x,t ). This system of\nequations is equivalent to the following Hamiltonian system:[\u2212f J \u2212I\nI \u2212f \u22121J\n](\nx\nu\n)\nt\n=\n(\n\u03b4H\/\u03b4x\n\u03b4H\/\u03b4u\n)\n, J =\n(\n0 \u22121\n1 0\n)\n, (4.6)\nwhere\nH(x, u) =\n\u222b\nH dm, H = 1\n2\n\u3008u, u\u3009 + e(\u03c4 ). (4.7)\nThe skew-symmetric operator on the left-hand side of (4.6) is not invertible. This degeneracy\nreflects the constraints in the semi-geostrophic formulation. In other words, the gradient of\nH is required to be in the range of the skew-symmetric operator; this solvability condition\nimposes the constraints. A closed but degenerate 2-form is called a pre-symplectic form, and\nfor this system the pre-symplectic form is\n\u03c9 =\n\u222b\n\u03c9 dm, \u03c9 = du1 \u2227 dx1 + du2 \u2227 dx2 + f dx1 \u2227 dx2 + f \u22121 du1 \u2227 du2.\nThis 2-form differs from the symplectic form for the standard shallow-water equations by the\nlast term only. In the multisymplectic formulation, the analysis of section 2 goes through with\nthe following minor changes.\n1. The skew-symmetric matrix K has two extra nonzero components:\nK3,4 = f \u22121, K4,3 = \u2212f \u22121.\n2. The potential vorticity is\nq = f \u22121{(u1 \u2212 f x2),1(u2 + f x1),2 \u2212 (u1 \u2212 f x2),2(u2 + f x1),1}.\n(As before, the potential vorticity is the dm1 \u2227dm2 component of \b\u2217\u03c9; the corresponding\ncomponent of \b\u2217\u03ba\u03b1,\u03b1 is zero on solutions, so q is conserved on particle paths.)\n3. The energy conservation law, which can be deduced from the dm\u03b1 \u2227 dt components of\nthe pull back of the symplectic conservation law, is\nH,t + (xi,twi\u03b1),\u03b1 = 0.\n4.2. Three-dimensional ideal fluid dynamics\nThe Euler equations for homogeneous incompressible fluid dynamics in three dimensions,\nwritten in terms of the Lagrangian mass coordinates m = (m1,m2,m3), are\nxi,t = ui, xi,\u03b1ui,t = \u2212p,\u03b1, det(xm) = 1.\nHere, xm is the Jacobian matrix, so the incompressibility condition amounts to\n\u03c4 \u2261 \u03b5\u03b1\u03b2\u03b3 x1\u03b1x2\u03b2x3\u03b3 = 1,\nwhere \u03b5\u03b1\u03b2\u03b3 is the alternating tensor and xi\u03b1 = xi,\u03b1 .\nThe Euler equations have the same Hamiltonian formulation (1.2) in two and three\ndimensions. From (1.1), the Hamiltonian density is\nH = 12 \u3008u, u\u3009 + (1 \u2212 det(xm))p.\n1416 T J Bridges et al\nAs usual, we construct the multisymplectic formulation by defining the auxiliary variables\nwi\u03b1 = \u2212 \u2202H\n\u2202xi\u03b1\n.\nThen the Euler equations can be rewritten as\n\u2212ui,t \u2212 wi\u03b1,\u03b1 = 0,\nxi,t = ui,\nxi,\u03b1 = xi\u03b1,\n0 = \u2202H\n\u2202xi\u03b1\n+ wi\u03b1,\n0 = 1 \u2212 \u03c4.\nLet z = (xi, ui, wi\u03b1, xi\u03b1, p)T, where the variables are ordered by the value of i (and, where\nthere are two subscripts, by the value of \u03b1 for each i). Then the Euler equations amount to\nKz,t + L\u03b1z,\u03b1 = \u2207zSM(z),\nwhere K, L1, L2, L3 are skew-symmetric matrices whose only nonzero components are\nK1,4 = K2,5 = K3,6 = \u22121, K4,1 = K5,2 = K6,3 = 1,\nL11,7 = L12,10 = L13,13 = \u22121, L17,1 = L110,2 = L113,3 = 1,\nL21,8 = L22,11 = L23,14 = \u22121, L28,1 = L211,2 = L214,3 = 1,\nL31,9 = L32,12 = L33,15 = \u22121, L39,1 = L312,2 = L315,3 = 1,\nand where SM = H + xi\u03b1wi\u03b1 . The conservation law of symplecticity is\n\u03c9,t + \u03ba\u03b1,\u03b1 = 0,\nwhere\n\u03c9 = dz \u2227 K dz = dui \u2227 dxi and \u03ba\u03b1 = dz \u2227 L\u03b1 dz = dwi\u03b1 \u2227 dxi.\nThe pull back of the multisymplectic conservation law to (m, t) space is\n0 = \b\u2217(\u03c9,t + \u03ba\u03b1,\u03b1) = \u03b5\u03b1\u03b2\u03b3\u0004\u03b3,t dm\u03b1 \u2227 dm\u03b2 +\n{( 1\n2 \u3008u, u\u3009\n)\n,t\n+ (uiwi\u03b2),\u03b2\n}\n,\u03b1\ndm\u03b1 \u2227 dt,\nwhere\n\u0004\u03b3 = \u03b5\u03bb\u00b5\u03b3 xi\u00b5ui,\u03bb = \u03b5\u03bb\u00b5\u03b3 (xi\u00b5ui),\u03bb. (4.8)\n(This result derived in essentially the same way as the conservation laws in section 2; details\nare omitted for the sake of brevity.) Thus, the pull back leads to conservation of total energy,( 1\n2 \u3008u, u\u3009\n)\n,t\n+ (uiwi\u03b2),\u03b2 = 0,\nand conservation of \u2126 = (\u00041,\u00042,\u00043)T:\n\u2126,t = 0.\nNow, from (4.8),\n\u0004\u03b3 = \u03b5\u03bb\u00b5\u03b3 xi\u00b5xj\u03bb \u2202ui\n\u2202xj\n,\nwhich can be written in the form\n\u2126 = \u2212x\u22121m (\u2207x \u00d7 u). (4.9)\nIn contrast to corresponding result for the two-dimensional Euler equations (cf section 1), \u2126\nis not the vorticity. It is however related to Belrami\u2019s material vorticity (cf Casey and Naghdi\nVorticity and symplecticity in Lagrangian fluid dynamics 1417\n(1991), Viu\u00b4dez (2001)). Ertel\u2019s theorem (cf Mu\u00a8ller (1995), Salmon (1982), Viu\u00b4dez (2001))\nis an immediate consequence of (4.9). Let \u03b8 be any materially conserved quantity, so that\n\u03b8,t = 0. Then the vector product\nQ = \u0004\u03b3 \u03b8,\u03b3\nis also materially conserved: Q,t = 0. Unlike \u2126, the quantity Q has a representation in terms\nof the Eulerian variables x and u only:\nQ = \u2212\u3008\u2207x\u03b8,\u2207x \u00d7 u\u3009.\nFor compressible homentropic fluids, the only significant modification is to replace (4.9)\nby \u2126 = \u2212\u03c4x\u22121m (\u2207x \u00d7 u); then\nQ = \u2212\u3008\u2207x\u03b8, (\u2207x \u00d7 u)\u3009\n\u03c1\n,\nwhere \u03c1 = 1\/\u03c4 the density of the fluid.\nAcknowledgment\nThis project was partially supported by the EPSRC-funded network on Geometric Methods in\nGeophysical Fluid Dynamics: http:\/\/www.ma.ic.ac.uk\/\u223csreich\/Network.html.\nReferences\nAbarbanel H D I and Holm D D 1987 Nonlinear stability analysis of inviscid flows in three dimensions: incompressible\nfluids and barotropic fluids Phys. Fluids 30 3369\u201382\nAlbert H-F 1997a On new hydrodynamic conservation laws related to the particle relabeling symmetry Z. Angew.\nMath. Mech. 77 945\u201354\nAlbert H-F 1997b Point symmetries for Lagrangian fluid dynamics Z. Angew. Math. Mech. 77 955\u20138\nArnold V I and Khesin B A 1998 Topological Methods in Hydrodynamics (New York: Springer)\nArnold V I, Kozlov V V and Neishtadt A I 1993 Mathematical Aspects of Classical and Celestial Mechanics 2nd edn\n(Berlin: Springer)\nBatchelor G K 1967 An Introduction to Fluid Dynamics (Cambridge: Cambridge University Press)\nBila N 2002 Symmetry reductions, variational symmetry and conservation laws for the shallow water and semi-\ngeostrophic PDE systems Cambridge Numerical Analysis Report Series NA2002\/03 http:\/\/www.damtp.cam.\nac.uk\/user\/na\/reports.html\nBretherton F P 1970 A note on Hamilton\u2019s principle for perfect fluids J. Fluid Mech. 44 19\u201331\nBridges T J 1997a Multi-symplectic structures and wave propagation Math. Proc. Camb. Phil. Soc. 121 147\u201390\nBridges T J 1997b A geometric formulation of the conservation of wave action and its implications for signature and\nthe classification of instabilities Proc. R. Soc. Lond. A 453 1365\u201395\nCasey J and Naghdi P M 1991 On the Lagrangian description of vorticity Arch. Ration. Mech. Anal. 115 1\u201314\nEgger J 1994 A new conservation law of the shallow-water equations Q. J. R. Meteorol. Soc. 120 1689\u201395\nFrank J E and Reich S 2003 Conservation properties of smoothed particle hydrodynamics applied to the shallow water\nequations BIT 43 40\u201354\nHydon P E 2000 Symmetry Methods for Differential Equations (Cambridge: Cambridge University Press)\nHydon P E 2004 Multisymplectic conservation laws for differential and differential-difference equations Proc. R.\nSoc. Lond. A in press\nJackiw R, Nair V P, Pi S-Y and Polychronakos A P 2004 Perfect fluid theory and its extensions J. Phys. A: Math.\nGen. 37 R327\u2013432\nMonaghan J J 1992 Smoothed particle hydrodynamics Ann. Rev. Astron. Astrophys. 30 543\u201374\nMu\u00a8ller P 1995 Ertel\u2019s potential vorticity theorem in physical oceanography Rev. Geophys. 33 67\u201397\nNewcomb W A 1967 Exchange invariance in fluid systems Proc. Symp. Appl. Math. 18 152\u201361\nOlver P J 1993 Applications of Lie Groups to Differential Equations 2nd edn (New York: Springer)\nPadhye N S 1998 Topics in Lagrangian and Hamiltonian fluid dynamics: relabeling symmetry and ion-acoustic wave\nstability PhD Dissertation University of Texas\nPadhye N S and Morrison P J 1996 Fluid element relabeling symmetry Phys. Lett. A 219 287\u201392\n1418 T J Bridges et al\nRipa P 1981 Symmetries and conservation laws for internal gravity waves Nonlinear Properties of Internal Waves:\nAIP Conf. Proc. vol 76, ed B J West pp 281\u2013306\nRoulstone I and Norbury J 1994 A Hamiltonian structure with contact geometry for the semi-geostrophic equations\nJ. Fluid Mech. 272 211\u201333\nRoulstone I and Sewell M J 1997 The mathematical structure of theories of semigeostrophic type Phil. Trans. R. Soc.\nLond. A 355 2489\u2013517\nSalmon R 1982 Hamilton\u2019s principle and Ertel\u2019s Theorem Mathematical Methods in Hydrodynamics and Integrability\nin Dynamical Systems: AIP Conf. Proc. vol 88 ed M Tabor and Y Treve pp 127\u201335\nSalmon R 1983 Practical use of Hamilton\u2019s principle J. Fluid Mech. 132 431\u201344\nSalmon R 1988 Semi-geostrophic theory as a Dirac bracket projection J. Fluid Mech. 196 345\u201358\nSalmon R 1998 Lectures on Geophysical Fluid Dynamics (Oxford: Oxford University Press)\nViu\u00b4dez A 2001 The relation between Beltrami\u2019s material vorticity and Rossby\u2013Ertel\u2019s potential vorticity J. Atmos.\nSci. 58 2509\u201317\n"}