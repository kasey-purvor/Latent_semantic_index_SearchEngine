{"doi":"10.1111\/j.1365-246X.2006.03196.x","coreId":"63227","oai":"oai:nora.nerc.ac.uk:2621","identifiers":["oai:nora.nerc.ac.uk:2621","10.1111\/j.1365-246X.2006.03196.x"],"title":"Improved strategies for the automatic selection of optimized sets of Electrical Resistivity Tomography measurement configurations","authors":["Wilkinson, Paul","Meldrum, Philip","Chambers, Jonathan","Kuras, Oliver","Ogilvy, Richard"],"enrichments":{"references":[],"documentType":{"type":0.5555555556}},"contributors":[],"datePublished":"2006-12","abstract":"Two strategies are presented for obtaining the maximum spatial resolution in electrical resistivity\\ud\ntomography surveys using a limited number of four-electrode measurement configurations.\\ud\nBoth methods use a linearized estimate of the model resolution matrix to assess the effects of\\ud\nincluding a given electrode configuration in the measurement set. The algorithms are described\\ud\nin detail, and their execution times are analysed in terms of the number of cells in the inverse\\ud\nmodel. One strategy directly compares the model resolution matrices to optimize the spatial\\ud\nresolution. The other uses approximations based on the distribution and linear independence\\ud\nof the Jacobian matrix elements. The first strategy produces results that are nearer to optimal,\\ud\nhowever the second is several orders of magnitude faster. Significantly however, both offer\\ud\nbetter optimization performance than a similar, previously published, method. Realistic examples\\ud\nare used to compare the results of each algorithm. Synthetic data are generated for each\\ud\noptimized set of electrodes using simple forward models containing resistive and\/or conductive\\ud\nprisms. By inverting the data, it is demonstrated that the linearized model resolution matrix\\ud\nyields a good estimate of the actual resolution obtained in the inverted image. Furthermore,\\ud\ncomparison of the inversion results confirms that the spatial distribution of the estimated model\\ud\nresolution is a reliable indicator of tomographic image quality","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/63227.pdf","fullTextIdentifier":"http:\/\/nora.nerc.ac.uk\/2621\/1\/ArrayOpt.pdf","pdfHashValue":"f8fa699f87e8ee4155ce27d91751bd27cb110c2d","publisher":"Blackwell Publishing","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:nora.nerc.ac.uk:2621<\/identifier><datestamp>\n      2012-11-22T11:48:47Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D533234<\/setSpec><setSpec>\n      7375626A656374733D533130<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/nora.nerc.ac.uk\/id\/eprint\/2621\/<\/dc:relation><dc:title>\n        Improved strategies for the automatic selection of optimized sets of Electrical Resistivity Tomography measurement configurations<\/dc:title><dc:creator>\n        Wilkinson, Paul<\/dc:creator><dc:creator>\n        Meldrum, Philip<\/dc:creator><dc:creator>\n        Chambers, Jonathan<\/dc:creator><dc:creator>\n        Kuras, Oliver<\/dc:creator><dc:creator>\n        Ogilvy, Richard<\/dc:creator><dc:subject>\n        Physics<\/dc:subject><dc:subject>\n        Earth Sciences<\/dc:subject><dc:description>\n        Two strategies are presented for obtaining the maximum spatial resolution in electrical resistivity\\ud\ntomography surveys using a limited number of four-electrode measurement configurations.\\ud\nBoth methods use a linearized estimate of the model resolution matrix to assess the effects of\\ud\nincluding a given electrode configuration in the measurement set. The algorithms are described\\ud\nin detail, and their execution times are analysed in terms of the number of cells in the inverse\\ud\nmodel. One strategy directly compares the model resolution matrices to optimize the spatial\\ud\nresolution. The other uses approximations based on the distribution and linear independence\\ud\nof the Jacobian matrix elements. The first strategy produces results that are nearer to optimal,\\ud\nhowever the second is several orders of magnitude faster. Significantly however, both offer\\ud\nbetter optimization performance than a similar, previously published, method. Realistic examples\\ud\nare used to compare the results of each algorithm. Synthetic data are generated for each\\ud\noptimized set of electrodes using simple forward models containing resistive and\/or conductive\\ud\nprisms. By inverting the data, it is demonstrated that the linearized model resolution matrix\\ud\nyields a good estimate of the actual resolution obtained in the inverted image. Furthermore,\\ud\ncomparison of the inversion results confirms that the spatial distribution of the estimated model\\ud\nresolution is a reliable indicator of tomographic image quality.<\/dc:description><dc:publisher>\n        Blackwell Publishing<\/dc:publisher><dc:date>\n        2006-12<\/dc:date><dc:type>\n        Publication - Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/nora.nerc.ac.uk\/id\/eprint\/2621\/1\/ArrayOpt.pdf<\/dc:identifier><dc:identifier>\n         \n\n  Wilkinson, Paul; Meldrum, Philip; Chambers, Jonathan; Kuras, Oliver; Ogilvy, Richard.  2006  Improved strategies for the automatic selection of optimized sets of Electrical Resistivity Tomography measurement configurations.   Geophysical Journal International, 167. 1119-1126.  https:\/\/doi.org\/10.1111\/j.1365-246X.2006.03196.x <https:\/\/doi.org\/10.1111\/j.1365-246X.2006.03196.x>     \n <\/dc:identifier><dc:relation>\n        http:\/\/www.blackwell-synergy.com\/<\/dc:relation><dc:relation>\n        10.1111\/j.1365-246X.2006.03196.x<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/nora.nerc.ac.uk\/id\/eprint\/2621\/","http:\/\/www.blackwell-synergy.com\/","10.1111\/j.1365-246X.2006.03196.x"],"year":2006,"topics":["Physics","Earth Sciences"],"subject":["Publication - Article","PeerReviewed"],"fullText":" - 1 - \nImproved strategies for the automatic selection of \noptimized sets of Electrical Resistivity Tomography \nmeasurement configurations \n  \nPaul B. Wilkinson, Philip I. Meldrum, Jonathan E. Chambers, Oliver Kuras, and Richard \nD. Ogilvy. \n \nBritish Geological Survey, Natural Environment Research Council, Kingsley Dunham \nCentre, Keyworth, Nottingham, NG12 5GG, UK \n \nAccepted 2006 August 14. Received 2006 August 10; in original form 2006 June 6   \n \n(Short title: Improved ERT optimization strategies) \n \n \n \n \nCorresponding Author: Paul Wilkinson, Tel: +44(0) 115 936 3086 \nFax: +44(0) 115 936 3261. Email: pbw@bgs.ac.uk \n - 2 - \nPublished in Geophysical Journal International (Royal Astronomical Society \/ Blackwell \nPublishing). The definitive version is available at www.blackwell-synergy.com \n \nGeophysical Journal International (2006) 167, 1119-1126 \nhttp:\/\/www.blackwell-synergy.com\/doi\/pdf\/10.1111\/j.1365-246X.2006.03196.x \n - 3 - \nSummary \nTwo strategies are presented for obtaining the maximum spatial resolution in \nelectrical resistivity tomography surveys using a limited number of four-electrode \nmeasurement configurations. Both methods use a linearized estimate of the model \nresolution matrix to assess the effects of including a given electrode configuration in the \nmeasurement set. The algorithms are described in detail, and their execution times are \nanalyzed in terms of the number of cells in the inverse model. One strategy directly \ncompares the model resolution matrices to optimize the spatial resolution. The other uses \napproximations based on the distribution and linear independence of the Jacobian matrix \nelements. The first strategy produces results that are nearer to optimal, but the second is \nseveral orders of magnitude faster. Significantly however, both offer better optimization \nperformance than a similar, previously published, method. Realistic examples are used to \ncompare the results of each algorithm. Synthetic data are generated for each optimized \nset of electrodes using simple forward models containing resistive and \/ or conductive \nprisms. By inverting the data, it is demonstrated that the linearized model resolution \nmatrix yields a good estimate of the actual resolution obtained in the inverted image. \nFurthermore, comparison of the inversion results confirms that the spatial distribution of \nthe estimated model resolution is a reliable indicator of tomographic image quality. \n - 4 - \nKeywords \nElectrical resistivity, Tomography, Inverse theory, Sensitivity, Numerical techniques \n - 5 - \n1. Introduction \nOver the past decade, geoelectrical surveying techniques have become a popular \nchoice for shallow subsurface investigations. The most widely used of these methods is \nelectrical resistivity tomography (ERT). Recently several computer controlled multi-\nelectrode ERT systems have become available, which permit the collection of very large \ndata sets that provide coverage of large areas at high data density. Despite the flexible \nnature of these systems, resistivity data still tend to be collected using traditional \nelectrode arrangements, such as Wenner, Schlumberger or Dipole-Dipole arrays. These \narrays are often a good choice, as they are well understood in terms of their depths-of-\ninvestigation (Barker, 1989), lateral and vertical resolutions (Barker, 1979) and signal-to-\nnoise ratios (Dahlin & Zhou, 2004). However, they may not be the most efficient option \nif the time or number of measurements allowed for the survey is limited, or if a target of \nparticular interest is spatially localized. \nTherefore there is currently much interest in generating sets of electrode \nconfigurations that optimize the resolution of the tomographic image for a given number \nof measurements or in a specified region of the model. The first attempt to do so in \nresistivity surveying was by Cherkaeva & Tripp (1996), who used weighted sums of \npole-pole configurations to produce multi-electrode transmitter and receiver arrays that \nfocused the subsurface current distribution on features at known locations and depths. \nHowever, most ERT systems permit at most two current electrodes to be used for a given \n - 6 - \nmeasurement. Two optimization methods more suited to use with these systems have \nrecently been introduced (Furman et al., 2004; Hennig & Weller, 2005). Both rely on \nassessing the sensitivity of given arrays to discrete localized changes in resistivity. The \nsensitivity distributions are calculated from analytical perturbations (Furman et al., 2004) \nor expressions for the Jacobian matrix elements for the forward problem (Hennig & \nWeller, 2005). Optimization takes place by obtaining weighted sums of these \ndistributions that maximize the sensitivity either evenly across the subsurface model or \nwithin a localized region. Summing sensitivity distributions has an intuitive appeal, in \nthat regions of the model with high average sensitivity tend to be well resolved. \nHowever, it can only give a correct representation of subsurface resolution in certain \nlimited circumstances (for example, when the sensitivity distributions have minimal \nspatial overlap with each other and the regularization constraints are small). Stummer et \nal. (2004) pioneered a more accurate approach that uses the sensitivity distributions to \ncalculate an estimate of the model resolution matrix. This provides a measure of how \nwell the observed apparent resistivity data resolve each model cell. They showed that \ntheir optimization algorithm produced sets of electrode configurations that out-performed \ntraditional arrays. \nIn this paper, we present two new ERT optimization strategies, which are both \nbased on finding a limited number of electrode configurations that enhance the model \nresolution matrix. Of the two, the algorithm that performs better in terms of optimizing \nthe resolution has much longer execution times. The other uses approximations to \n - 7 - \nincrease its speed, but manages to achieve similar optimization performance. We \ncompare our methods against that of Stummer et al. (2004) in terms of both speed and \nperformance. We also analyze each algorithm\u2019s effectiveness at optimizing the model \nresolution and validate these findings by inverting synthetic data generated using the \noptimized arrays. In addition we assess the scaling properties of all three algorithms, \nquantify the effects of the size of the inverse model on their execution times, and discuss \nthe resulting suitability of each method for different applications. \n2. Method Overview \nThe optimization strategies presented in this paper all rely on appraisals of the \nmodel resolution matrix R. This quantifies the degree to which each resistivity cell in the \nmodel can be resolved by the observed data. It is defined by mfit = Rmtrue (Menke, 1984), \nwhere mfit is the estimate of the model resistivities determined by the inversion process, \nand mtrue comprises the true resistivities, which are unknown. If each model cell is \nperfectly resolved then R = I, otherwise each row of R is the constrained least-squares \nbest fit to the corresponding row of I (Jackson, 1972). Strictly R can only be defined for \nlinear inverse problems (Friedel, 2003). However, despite the fact that the forward \nproblem is non-linear, ERT inversion is typically implemented via an iterative series of \nlinearized steps (Loke & Barker, 1995). This permits a first-order estimate of the model \nresolution matrix to be defined as \n GGCGGR TT 1)( \u2212+= , (1) \n - 8 - \nwhere the Jacobian matrix element Gij is the logarithmic sensitivity of the ith \nmeasurement to a small change in the resistivity of the jth model cell, and C contains the \ndamping factors, constraints and spatial filters that regularize the inversion (Loke et al., \n2003). Our optimization procedures attempt to maximise the matrix elements on the \nleading diagonal of R. We denote these elements R(j) and call them the \u201cmodel \nresolution\u201d, noting that they are also sometimes referred to as the \u201cmodel importance\u201d. \nSince R is the least-squares fit to I, the model resolution lies in the range 0 \u2264 R(j) \u2264 1. It \nprovides a simple measure of how well the jth resistivity model cell is resolved by the \ndata (0 being unresolved and 1 perfectly resolved). \nFor a system of N electrodes, the comprehensive measurement set contains \nN(N-1)(N-2)(N-3)\/8 non-equivalent four-electrode configurations when reciprocity is \ntaken into account (Xu & Noel, 1991). It is likely that this set will contain configurations \nthat reduce the stability of the inversion, such as those of the Wenner-\u03b3 type and others \nwith large geometrical factors. These can be discarded before the optimization process \nbegins, leaving a set Sc containing nc configurations. Suppose that one wishes to find the \nsubset of nb measurements from Sc that, by some measure, provides the optimal model \nresolution. Since there are )!(!\n!\nbcb\nc\nnnn\nn\n\u2212\nsuch combinations, and since nc scales as O[N4], \nthere is no practical possibility of testing them all. One could try a global optimization \ntechnique, such as simulated annealing or a genetic algorithm. However, the sheer \n - 9 - \nnumber of possible combinations and the lack of an obvious algorithm for producing \nbeneficial test combinations would almost certainly limit its effectiveness. \nA more practical approach is to use local optimization. The most effective method \nwould be to select a small initial base set, then test every other configuration by \nrecalculating R for the base set plus that particular configuration. The best configuration \nwould then be added to the base set for the next iteration, and the process would be \nrepeated until the set contained the required number of configurations. But each step \nwould require O[N4] calculations of R, and each of these calculations would require a \nmatrix inversion, which is an O[m3] process where m is the number of model cells. These \nunfavourable scaling properties make this form of local optimization far too inefficient \nfor practical use. However, several modifications can be made so that it retains most of \nits efficacy whilst drastically improving its efficiency. Since R does not tend to change \nrapidly after the first few steps, it is not necessary to recalculate it for the add-on \nconfigurations every time. In the intervening iterations, it is sufficient to check that the \nsensitivity distribution of the configuration being tested has a degree of orthogonality to \nthose that have already been added (Stummer et al., 2004; Menke 1984). Since this check \nis an O[m] process, this modification leads to a considerable increase in speed. When R \ndoes need to be recalculated, this can be done by updating the model resolution of the \nbase set using a Rank-1 correction based on the Sherman-Morrison formula (Press et al., \n1992). This replaces the O[m3] matrix inversion with an O[m2] process, giving a further \nlarge performance benefit. The local optimization method, with these two modifications, \n - 10 - \nis the basis of our first strategy (\u201cCompare R\u201d). It is still rather slow, taking several hours \non a 3GHz desktop PC for a realistic 2.5D ERT problem, but it does give very good \nresults. \nThe above method was developed as a more effective version of the strategy of \nStummer et al. (2004). In their paper, each configuration is ranked by a \u201cGoodness \nFunction\u201d that attempts to assess the effects of its addition to the base set without \ncalculating R explicitly. This replaces the O[m3] matrix inversions with several O[m] \ncalculations and is therefore much faster than the \u201cCompare R\u201d approach, taking only a \nfew minutes to run for the same problem. But their method, which we denote the \n\u201cOriginal GF\u201d algorithm, is also significantly less effective at optimizing the model \nresolution. We have improved on their approach to create the \u201cModified GF\u201d strategy, \nwhich not only gives results that are closer to those obtained from \u201cCompare R\u201d, but is \nfaster still than \u201cOriginal GF\u201d. \n3. Configuration Assessment \nStrategy 1 \u2013 Compare R \nThis is the most computationally intensive approach of the three strategies. Each \npossible configuration to be added to the base set is ranked in terms of \u2211\n=\nm\nj jR\njR\nm 1 )(\n)(1\nb\nt\n, \nwhere Rt is the resolution of the base set plus the test configuration and Rb is the \nresolution of the base set. The finesse in the method involves using the Sherman-\n - 11 - \nMorrison Rank-1 update to calculate Rt from the known Rb, rather than explicitly from \nEq. 1. Briefly, if g is the m element vector containing the logarithmic sensitivities of the \ntest configuration and Rb has already been calculated using Eq. 1, then the matrices are \nupdated as follows: \n gg \u2297+\u2192 GGGG TT , \n ( ) ( )\n\u00b5+\n\u2297\n\u2212+\u2192+\n\u2212\u2212\n1\n11 zzCGGCGG TT , (2) \nwhere z = (GTG + C)-1g, \u00b5 = g \u00b7 z and ba \u2297  denotes the matrix multiplication of a and \nbT. Each step in this process scales as O[m2] or better, and the final calculation of Rt is \nalso O[m2] if only the leading diagonal of Rt is calculated. \nMany configurations are added to the base set at each iteration. The first is the \nhighest ranked configuration, represented by the sensitivity vector g1. The next highest \nranked, g2, is then added only if it is deemed to have a suitable degree of orthogonality to \nthe first. This is assessed by calculating |g1 \u00b7 g2| \/ (|g1| |g2|) and checking that it is less than \na specified limit. This procedure is repeated until the desired number of extra \nconfigurations has been appended to the base set, with each configuration being checked \nagainst those that were previously added on this iteration only. \nStrategy 2 \u2013 Original GF \nFull details of the original goodness function are given in Stummer et al. (2004). \nIn brief, the ith add-on configuration is ranked by a goodness function defined by  \n - 12 - \n \u2211\n=\n\uf8f7\n\uf8f7\n\uf8f8\n\uf8f6\n\uf8ec\n\uf8ec\n\uf8ed\n\uf8eb\n\u2212=\nm\nj j\nij\ni jR\njR\nG\nG\nF\n1 c\nb\nsum )(\n)(1 , (3) \nwhere \n \u2211\n=\n=\nc\n1c\nsum 1 n\nk\nkjj G\nn\nG  (4) \nand Rc is the model resolution of the comprehensive set. The bracketed term in Eq. 3 \nselects configurations that improve regions of the model that are poorly resolved by the \nbase set. Gjsum provides a normalization factor by summing the absolute sensitivities for \nthe jth model cell of all configurations in the comprehensive set. This ensures that the \ngoodness function gives equal preference to improving the resolution in all regions of the \nmodel, regardless of their relative sensitivity. \nAs with the \u201cCompare R\u201d approach, multiple configurations are tested for \ninclusion in the base set at each iteration. In this strategy, the orthogonality check is \nperformed against the entire base set, not just the configurations that have been added on \nthis pass. This means that, if the add-on configuration fails this test against some \nconfiguration in the base set, then it will also fail at every future iteration (since that \nconfiguration will remain in the base set). Therefore any failing add-on configurations are \ndiscarded to save time in subsequent iterations. However, if the orthogonality test is too \nstrict, it is possible to discard all the add-on configurations, thereby causing the algorithm \nto halt prematurely. \n - 13 - \nStrategy 3 \u2013 Modified GF \nThe modified goodness function follows a similar approach to the original. Each \nconfiguration is ranked by \n \n2\/1\n1 c\nb\n2sum\n2\n)(\n)(1\n)(\u2211= \uf8f7\uf8f7\uf8f8\n\uf8f6\n\uf8ec\n\uf8ec\n\uf8ed\n\uf8eb\n\u2212=\nm\nj j\nij\ni jR\njR\nG\nG\nF , (5) \nwhere \n \u2211\n=\n=\nb\n1b\nsum 1 n\nk\nkjj G\nn\nG . (6) \nThe changes between the modified and original goodness functions are pragmatic in \nnature, having been found to be beneficial on the basis of numerical tests involving \nseveral different subsurface geometries. The Gjsum term now only sums over the nb \nconfigurations in the base set. Its purpose has been changed so that it gives high \nweighting to add-on configurations that are orthogonal to the base set, and this effect is \nincreased by the squared terms in Eq. 5. Since low values of Gjsum tend to imply poor \nresolution of the jth model cell, these modifications can over-emphasize the importance \nof configurations with sensitivity distribution that are strongly localized in poorly \nresolved regions of the model. This can have the side-effect that other useful \nconfigurations, which provide more uniform improvements to the model resolution, are \noften ignored. Therefore the bracketed term in Eq. 5, which has the purpose of improving \nthe same poorly resolved regions, has had its exponent reduced to restore the balance. \nThe overall effect of the modifications is that add-on configurations are chosen which \n - 14 - \nimprove the resolution whilst simultaneously having a high degree of orthogonality to the \nbase set. This means that it is only necessary to perform the separate orthogonality test \nagainst the configurations that have been added during this iteration, rather than against \nthe whole base set. This substantially reduces the amount of time spent performing these \nchecks, and removes the possibility of running out of add-on configurations. \n4. Performance Tests \nWe have tested each of the strategies using a 2.5D geometry which matches that \nused in Stummer et al. (2004). This consists of 30 electrodes positioned at 5 m spacings \nand 16 exponentially increasing depth levels in the model, giving a total of m = 464 \nresistivity model cells. All the Wenner-\u03b3 configurations and others with geometrical \nfactors larger than 5,500 m were discarded, leaving a comprehensive set Sc containing \nnc = 51,373 unique configurations. The initial base set Sb was a sparse dipole-dipole array \ncomprising nb = 147 configurations with an \u2018a-spacing\u2019 of 1 and \u2018n-levels\u2019 of 1 \u2192 6. At \neach iteration an extra 0.09nb configurations were added to Sb, and nb was updated to \n1.09nb.  \nThe Jacobian matrix G contains the logarithmic sensitivity of each configuration \nto changes in the model resistivities. It was calculated using the adjoint field approach \n(Park & Van, 1991), which is valid for arbitrary resistivity distributions. To ensure that \nthe generated sets of configurations would be applicable to general resistivity surveys, we \nassumed no prior knowledge of the resistivity distribution. Therefore we chose to use a \n - 15 - \nhomogeneous half-space, which increased the speed and simplicity of the sensitivity \ncalculations. As an aside, in this situation the adjoint field method also has a particularly \nsimple physical interpretation (see Appendix A). \nIn addition to the unknown resistivity distribution, the final constraint matrix \ncannot be determined before the inversion is performed. This is due to the iterative nature \nof the non-linear inverse resistivity problem; the inversion algorithms tend to change the \nconstraints at every iteration to maintain stability and maximize image resolution. \nFortunately the optimization strategies all rank the additional configurations in terms of \none model resolution distribution divided or normalized by another. Therefore they are \nrelatively insensitive to the detailed structure of these distributions, and hence also to the \nconstraint matrix, providing that the model resolutions are physically reasonable \n(Stummer et al., 2004). Consequently we used a simple damping constraint C = \u03bbI with \n\u03bb = 2.5\u00d710-6, which was chosen so that the model resolution, Rc, of the comprehensive \nmeasurement set was small (Rc ~ 0.05) at a depth of ~ 30 m. This depth is the typical \nmaximum median depth of investigation for four-electrode configurations on an array of \n145 m length (Barker, 1989). The distribution of Rc is shown in Fig. 1 on a logarithmic \nscale. Its spatial dependence appears realistic since it exhibits the typical, approximately \nexponential, decrease of resolution with depth. \nEach algorithm was run for 40 iterations, producing a set of 4,368 configurations. \nThe upper limit on orthogonality was chosen separately to give the best possible results \nfor each algorithm. Therefore this limit is slightly different for each, being 0.97 for \n - 16 - \n\u201cCompare R\u201d, 0.98 for \u201cOriginal GF\u201d, and 0.95 for \u201cModified GF\u201d. The outputs of each \nstrategy are shown in Fig. 2 as plots of the spatial distribution of the relative model \nresolution, Rr. This is defined as the model resolution of the optimized set divided by that \nof the comprehensive set (Rr = Rb \/ Rc). The colour scale ranges from white (Rr = 0), \nthrough the visible spectrum from blue to red, to black (Rr = 1).  The best possible \nrelative model resolution distribution would be provided by the comprehensive set, and \nwould therefore equal 1 (black) throughout the model space. Note that this means that the \nmodel resolution would be as shown in Fig. 1, it does not imply that the model resolution \nwould be uniformly good everywhere. The plots in Fig. 2 show Rr at six different stages \nof the optimization process (iteration numbers 1, 8, 16, 24, 32 and 40). Qualitatively it \ncan be seen that the model resolution improves with increasing iteration number for each \nof the optimization strategies. It should also be clear from Fig. 2 that, by iteration 40, the \n\u201cCompare R\u201d strategy has produced the best distribution of Rr, whereas the performance \nof \u201cOriginal GF\u201d is noticeably worse. However, the results of the \u201cModified GF\u201d \nalgorithm appear to be nearly as good as those of \u201cCompare R\u201d. The execution times for \nthe algorithms were 6.0 hours for \u201cCompare R\u201d, 6.3 minutes for \u201cOriginal GF\u201d, and 3.9 \nminutes for \u201cModified GF\u201d. \nA more quantitative measure of the performance of each method is presented in \nFig. 3. The graphs show the average value of the relative model resolution, \n\u2211\n=\n=\nm\njm jRS 1 r1 )( , plotted against the iteration number for \u201cCompare R\u201d (blue line), \n - 17 - \n\u201cModified GF\u201d (red line) and \u201cOriginal GF\u201d (green line). From these graphs, it can be \nclearly seen that the \u201cCompare R\u201d strategy is the most effective, producing a final \naverage resolution of S = 0.94, closely followed by \u201cModified GF\u201d (S = 0.92), with the \nleast effective being \u201cOriginal GF\u201d, which produced S = 0.84. It should be emphasized \nthat these optimized sets contain only 4,368 configurations, or 8.5% of the total number \navailable. Despite this, they achieve average model resolutions comparable with that of \nthe comprehensive set (S = 1.00). \nAs with Stummer et al. (2004), we find that the largest improvements in Rr are \ndue to the inclusion of asymmetric dipole-dipole configurations. Our implementation of \ntheir \u201cOriginal GF\u201d algorithm exhibits very similar behaviour to that which they reported. \nThe algorithm initially selects only dipole-dipole type configurations, in our case for the \nfirst 25 iterations. After this point, nested configurations (i.e. the C1-P1-P2-C2 type) are \nchosen more and more frequently, with the numbers of both types projected to be roughly \nequal (about 3,000 of each) at the 43rd iteration. The \u201cCompare R\u201d method produces \nsomewhat different behaviour, with dipole-dipole and nested configurations being added \nin approximately the same ratio (~ 4:1) at each iteration. The \u201cModified GF\u201d approach is \nsimilar, but the proportion does change slightly, from ~ 11:1 initially to ~ 9:1 at the 40th \niteration. Compared to \u201cOriginal GF\u201d, both of our new approaches tend to utilize more of \nthe asymmetric dipole-dipole configurations and select them earlier in the optimization \nprocess. \n - 18 - \n5. Inversion Results \nHaving obtained distributions of Rr from the three optimization strategies, it is \ndesirable to invert data obtained from the respective sets of configurations to test how \nwell each set performs against known targets. This is to give confidence that assessing \nthe distribution of Rr is a good way to predict the inversion performance of a given \nconfiguration set. To this end we have tested each set against three synthetic models, one \nwith four resistive prisms of \u03c1 = 100 \u2126m buried at different depths in a background with \n\u03c1 = 10 \u2126m (Fig. 4a), another with only the deepest of the four prisms (Fig. 4e), and a \nthird with both conductive and resistive structures (Fig. 5a). The data were calculated \nusing the Res2DMod software with a finite-difference forward modelling algorithm. \nThey were inverted using the companion Res2DInv program using the same model cell \ndiscretization and an l1-norm (robust) model constraint (Loke et al., 2003). The finite-\nelement method was used within Res2DInv to avoid having the same combination of \ndiscretization and modelling algorithm in the forward and inversion processes. \nThe inverted images for the four-prism model are shown in Figs 4b-d for the \n\u201cCompare R\u201d, \u201cOriginal GF\u201d and \u201cModified GF\u201d strategies respectively. We assess the \nresolution quality by the degree to which a localized resistivity structure in the inverted \nimage is contained within the boundary of the corresponding prism in the forward model. \nWe also take into account the degree to which the resistivity contrast in the forward \nmodel is reflected in the inversion. In these qualitative terms, it can easily be seen that the \n - 19 - \nprisms are best resolved by the \u201cCompare R\u201d configurations, then by \u201cModified GF\u201d, and \nleast well by \u201cOriginal GF\u201d. This agrees with what would be expected from the degree of \noptimization of the respective Rr distributions. \nThese assessments can be quantified by calculating the average resistivity value \nwithin the outlines of the prisms. The closer each prism is to being perfectly resolved, \nthen the nearer the average value would be to 100 \u2126m. The average resistivity values are \nshown adjacent to each prism in Figs 4b-d. By this measure, the best resolution for all \nfour prisms is obtained with the \u201cCompare R\u201d algorithm. With the exception of the \ndeepest prism, the next best results are obtained using \u201cModified GF\u201d, whilst \u201cOriginal \nGF\u201d gives the poorest resolution. Although the deepest prism has a slightly higher \naverage resistivity using the \u201cOriginal GF\u201d strategy as opposed to the \u201cModified GF\u201d, its \nstructure is not actually resolved at all in either image. We have examined both of these \nimages using much higher resolution contouring than shown in Fig. 4. This has \nconfirmed that, in contrast to the \u201cCompare R\u201d image, neither contains an isolated \nresistivity maximum in the vicinity of this prism. The associated average values merely \nreflect the spatial trends of the resistivity over a much larger area.  \nAlthough \u201cCompare R\u201d managed to resolve a weak localized resistivity maximum \nin the vicinity of the deepest prism, it is clear that the resolution in this region is poor \nusing any of the three strategies. Therefore, to assess their resolving capabilities more \naccurately at these depths, we have repeated the exercise using a forward model \ncontaining only the deepest prism (Fig. 4e). The inverted images for this single-prism \n - 20 - \nmodel are shown in Figs 4f-h using a compressed colour scale. With the same assessment \ncriteria as before, the \u201cCompare R\u201d scheme performs the best, showing some localized \nstructure and the greatest resistivity contrast against the background. The capabilities of \nthe \u201cOriginal GF\u201d and \u201cModified GF\u201d schemes are similar, but the \u201cModified GF\u201d is the \nbetter of the two, resolving a faint localized structure where the \u201cOriginal GF\u201d produces \nnone, and also producing a slightly higher resistivity contrast. These observations are \ncorroborated by the average resistivity value, which is highest for \u201cCompare R\u201d, and \nmarginally higher for the \u201cModified GF\u201d than the \u201cOriginal GF\u201d.  \nIt is also possible to compare the spatial resolution measured directly from the \ninverted images with an estimate of the radius of resolution obtained from R. Using the \nresults for \u201cCompare R\u201d as an example, we defined the edge of the prism in the inverted \nimage to be at 11.8 \u2126m, which is the centre contour between the maximum and \nbackground resistivities. We measured the spatial resolution as the distance between this \ncontour and the edges of the prism in the forward model, obtaining a value of ~ 9.2 m. At \nthe midpoint of the prism, the estimated model resolution is R ~ 0.035. The radius of \nresolution, defined by Friedel (2003), is given by \n \nR\nA\nr\npi\n= , (7) \nwhere A = 12.5 m2 is the area of the model cell at the prism midpoint. This gives an \nestimated radius of resolution of r ~ 10.7 m. The good agreement between these two \nestimates of spatial resolution further validates the use of the simple damping constraint \n - 21 - \nin Eq. 1, and gives added confidence in the use of model resolution estimates to predict \ninversion performance. \nWhilst the forward and inverse models involving resistive prisms illustrate the \nclose correspondence between R and the spatial resolution, it is also helpful to examine \nthe performance of the same optimized arrays against a more general model. To this end, \nwe consider the model used by Stummer et al. (2004), which consists of a conductive \noverburden, a resistive prism and an inhomogeneous conductive prism (Fig. 5a). For ease \nof comparison we have adopted their colour scale and block display for Fig. 5. It should \nbe noted that, when comparing the results of the two papers, we have used an l1-norm \nmodel constraint, which has the effect of improving the recovered blocky geometry of the \nmodel, but also reduces the peak resistivity or conductivity contrasts that are obtained. By \ninspecting Figs. 5b-d, it is clear that each of the three algorithms has resolved the two \nprisms and the overburden. Marginally better resistivity contrasts are obtained with \n\u201cCompare R\u201d (Fig. 5b) for the conductive prism, and with \u201cModified GF\u201d (Fig. 5d) for \nthe resistive prism. However, there is little quantitative difference, as evidenced by the \nsimilar average resistivity values obtained with each algorithm. More importantly, each \nof the new strategies significantly improves on the resistivity contrasts achieved with the \n\u201cOriginal GF\u201d method (Fig. 5c). \n - 22 - \n6. Conclusions \nWe have proposed two new local optimization strategies that, for a given limited \nnumber of four-electrode configurations, provide near-optimal subsurface resolution for \nERT surveys. Both algorithms use a linearized first-order estimate of the model \nresolution to assess the suitability of the electrode configurations. One approach, \n\u201cCompare R\u201d, calculates the effects of adding new configurations directly by updating \nthe model resolution matrix. The other method, \u201cModified GF\u201d, uses a goodness function \nto estimate which new configurations would be beneficial to include. \nWe compared these schemes with the \u201cOriginal GF\u201d, a previously published \nalgorithm that uses a similar approach. Our tests indicate that \u201cCompare R\u201d produces the \nclosest to optimal subsurface distribution of model resolution. However, this algorithm is \nslow and scales unfavourably with the number of resistivity cells in the model. The \n\u201cOriginal GF\u201d method is at least an order of magnitude faster but its results exhibit \nnotably poorer resolution. However, our \u201cModified GF\u201d runs faster still and produces \nmodel resolutions that are much closer to those obtained by the \u201cCompare R\u201d method. \nThe estimate of model resolution was calculated on the basis of a homogeneous \nhalf-space so that the results would not be specific to any particular subsurface resistivity \ndistribution. This had the additional benefit of increasing the speed and simplicity of the \nJacobian matrix calculations. Despite these assumptions, tests involving the inversion of \nsynthetic data derived from forward models with resistivity contrasts of 10:1 demostrated \n - 23 - \nthat the distribution of the estimated model resolution was a reliable indicator of the \nquality of the final inverted image. Both qualitative and quantitative assessments of the \ninverted images showed that the best results were obtained with the \u201cCompare R\u201d \nstrategy closely followed by our \u201cModified GF\u201d, whereas the poorest resolution was \nproduced by the \u201cOriginal GF\u201d. These findings were supported by further tests on a more \ngeneral model involving both conductive and resistive prisms and a conductive \noverburden. \nBy applying a spatial weighting function to the model resolution distribution, it \nwould not be difficult to adapt these procedures to target a specified region of the \nsubsurface (Hennig & Weller, 2005; Furman et al., 2004). Our scaling analysis suggests \nthat, due to its long execution times, \u201cCompare R\u201d is likely to be used only in the \npreparation stages for a field survey, and would therefore require prior knowledge of the \ntarget areas and geometries. However, the \u201cModified GF\u201d method is probably fast \nenough that it could be used for real-time array optimization. It could therefore form the \nbasis of an adaptive time-lapse electrical imaging system. This would use feedback from \nthe resistivity image to determine time-dependent weighting functions for the next \ninversion, automatically optimizing the spatial resolution for time-lapse tomographic \nimaging of dynamic subsurface processes. \n - 24 - \nAcknowledgements \nWe thank Dr Hansruedi Maurer and an anonymous reviewer for their helpful \ncomments on our original manuscript. This paper is published with the permission of the \nExecutive Director of the British Geological Survey (NERC). \nReferences \nBarker, R.D., 1979. Signal contribution sections and their use in resistivity studies, \nGeophysical Journal of the Royal Astronomical Society, 59, 123-129. \nBarker, R.D., 1989. Depth of investigation of collinear symmetrical four-electrode arrays, \nGeophysics, 54, 1031-1037. \nCherkaeva, E. & Tripp, A.C., 1996. Optimal survey design using focused resistivity \narrays, IEEE Transactions on Geoscience and Remote Sensing, 34, 358-366. \nDahlin, T. & Zhou, B., 2004. A numerical comparison of 2D resistivity imaging with 10 \nelectrode arrays, Geophysical Prospecting, 52, 379-398. \nFriedel, S., 2003. Resolution, stability and efficiency of resistivity tomography estimated \nfrom a generalized inverse approach, Geophysical Journal International, 153, \n305-316. \nFurman, A., Ferr\u00e9, T.P.A. & Warrick, A.W., 2004. Optimization of ERT surveys for \nmonitoring transient hydrological events using perturbation sensitivity and \ngenetic algorithms. Vadose Zone Journal, 3, 1230-1239. \n - 25 - \nHennig, T. & Weller, A., 2005. Two dimensional object orientated focussing of \ngeoelectrical multielectrode measurements. Proceedings of the 11th meeting of the \nEAGE Near Surface Geophysics Conference, Palermo, Italy. \nJackson, D.D., 1972. Interpretation of inaccurate, insufficient and inconsistent data, \nGeophysical Journal of the Royal Astronomical Society, 28, 97-109. \nLoke, M.H. & Barker, R.D., 1995. Least-squares deconvolution of apparent resistivity \npseudosections, Geophysics, 60, 1682-1690. \nLoke, M.H., Acworth, I. & Dahlin, T., 2003. A comparison of smooth and blocky \ninversion methods in 2-D electrical imaging surveys, Exploration Geophysics, 34, \n182\u2013187. \nLorrain, P., Corson, D.R. & Lorrain, F., 1988. Electromagnetic Fields and Waves, \nW. H. Freeman & Co, New York. \nMenke, W., 1984, Geophysical data analysis: Discrete Inverse Theory, Academic Press, \nLondon. \nPark, S.P. & Van, G.P., 1991. Inversion of pole-pole data for 3-D resistivity structure \nbeneath arrays of electrodes, Geophysics, 56, 951-960. \nPress, W.H., Teukolsky, S.A., Vetterling, W.T. & Flannery, B.P., 1992. Numerical \nRecipes in C: The Art of Scientific Computing 2nd Edition, Cambridge University \nPress, Cambridge. \nStummer, P., Maurer, H. & Green, A.G., 2004. Experimental design: Electrical resistivity \ndata sets that provide optimum subsurface information, Geophysics, 69, 120-139. \n - 26 - \nXu, B. & Noel, M., 1991. Archaeological investigation by electrical resistivity \ntomography: a preliminary study, Geophysical Journal International, 107, 95-\n102. \n - 27 - \nFigure Captions \nFigure 1. Logarithm of the model resolution Rc for the comprehensive set of \nconfigurations. \nFigure 2. Relative model resolutions Rr at six different stages of the optimization \nprocess for each strategy. Each column shows the results of a different optimization \nstrategy, with the iteration number and number of configurations in the optimized sets \nincreasing down the page. \nFigure 3. Average relative model resolution as a function of iteration number for \neach of the three optimization strategies. \nFigure 4. Forward models a) & e) showing the locations and sizes of resistive \nprisms (\u03c1 = 100 \u2126m, light red) embedded in an otherwise uniform background \n(\u03c1 = 10 \u2126m, light blue). Also shown are inverted images obtained from forward modelled \nsynthetic data using optimized sets of configurations generated with b) & f) \u201cCompare \nR\u201d, c) & g) \u201cOriginal GF\u201d, and d) & h) \u201cModified GF\u201d. The displayed average resistivity \nvalues relate to the regions of the inverted images bounded by the prisms. \nFigure 5. a) Forward model used in Stummer et al. (2004), showing the locations of \nconductive and resistive prisms and a conductive overburden in an otherwise uniform \nhalf-space (\u03c1 = 1000 \u2126m, yellow). Also shown are inverted images obtained from \n - 28 - \nforward modelled synthetic data using optimized sets of configurations generated with b) \n\u201cCompare R\u201d, c) \u201cOriginal GF\u201d, and d) \u201cModified GF\u201d. The displayed average resistivity \nvalues relate to the regions of the inverted images bounded by the prisms. \nFigure A1. A background medium of uniform conductivity \u03c3 incorporates a small \nvolume \u03c4 with conductivity \u03c3+\u03b4\u03c3. In the electric field of a current source C this causes a \ndipolar perturbation current density of \u03b4J at an angle \u03b8 and distance r\u2032 to the field point P. \n - 29 - \n \nFigure 1 \n - 30 - \n \nFigure 2 \n - 31 - \n \n \nFigure 3 \n - 32 - \n \nFigure 4 \n - 33 - \n \nFigure 5\n - 34 - \n \nFigure A1 \n - 35 - \nAppendix A \u2013 Physical Interpretation of Sensitivity \nCalculations \nThe derivation of the adjoint method used to calculate the Jacobian matrix \nelements is mathematically dense (Park & Van, 1991) and does not readily give insight \ninto the physical origins of the form of the sensitivity function. But when the subsurface \nresistivity distribution is homogeneous, the sensitivity does have a simple physical \ninterpretation; the change in potential due to a small localized resistivity perturbation is \ndue to the change in dipolar current density flowing in the perturbed region.  \nTo demonstrate this, we consider a homogeneous half-space of conductivity \u03c3 \ncontaining a small volume \u03c4 in which the conductivity is \u03c3 + \u03b4\u03c3 (Fig. A1). If the \nperturbation is weak, then the electric field E in \u03c4 can be assumed to be unchanged (this is \nequivalent to the Born Approximation in scattering theory). The field E, due to the \ncurrent electrode C, produces a dipolar current flow through the volume \u03c4. The change in \nthe dipolar current density caused by the conductivity perturbation is \u03b4J = E\u03b4\u03c3. In turn, \nthis extra current density changes the potential at P by \n r32\n'2\ncos\u03b4\n\u03b4 d\nr\nJV \u222b=\n\u03c4 pi\u03c3\n\u03b8\n (A1) \n(Lorrain et al., 1988), where r is a position vector within \u03c4, and r\u2032 and \u03b8 are the distance \nand angle from \u03c4 to P respectively. The magnitude of the electric field of a notional unit \ncurrent pole located at P would be 2\n'2\n1\n'\nr\nE\npi\u03c3\n= . Therefore  \n - 36 - \n \nrEE\nr\n3\n3\n'\u03b4\ncos'\u03b4\u03b4\nd\ndEEV\n\u222b\n\u222b\n\u22c5\u2212=\n=\n\u03c4\n\u03c4\n\u03c3\n\u03b8\u03c3\n, (A2) \nwhere the minus sign arises since E\u2032 is anti-parallel to r\u2032. Rearranging Eq. A2 slightly in \nterms of resistivity \u03c1 gives \n rEE 32 '\n\u03b4\n\u03b4 dV \u222b \u22c5=\n\u03c4\u03c1\n\u03c1\n, (A3) \nwhich is the result found in Park & Van (1991). \n \n"}