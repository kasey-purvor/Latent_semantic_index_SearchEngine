{"doi":"10.1007\/s00453-005-1176-8","coreId":"66662","oai":"oai:dro.dur.ac.uk.OAI2:604","identifiers":["oai:dro.dur.ac.uk.OAI2:604","10.1007\/s00453-005-1176-8"],"title":"Planar graph coloring avoiding monochromatic subgraphs : trees and paths make it difficult.","authors":["Broersma,  H. J.","Fomin,  F. V.","Kratochvil,  J.","Woeginger,  G. J."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2006-05","abstract":"We consider the problem of coloring a planar graph with the minimum number of colors so that each color class avoids one or more forbidden graphs as subgraphs. We perform a detailed study of the computational complexity of this problem. We present a complete picture for the case with a single forbidden connected (induced or noninduced) subgraph. The 2-coloring problem is NP-hard if the forbidden subgraph is a tree with at least two edges, and it is polynomially solvable in all other cases. The 3-coloring problem is NP-hard if the forbidden subgraph is a path with at least one edge, and it is polynomially solvable in all other cases. We also derive results for several forbidden sets of cycles. In particular, we prove that it is NP-complete to decide if a planar graph can be 2-colored so that no cycle of length at most 5 is monochromatic","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/66662.pdf","fullTextIdentifier":"http:\/\/dro.dur.ac.uk\/604\/1\/604.pdf","pdfHashValue":"1e2d0d6947be63b80baca1054a68542de256fa02","publisher":"Springer","rawRecordXml":"<record><header><identifier>\n  \n    \n      oai:dro.dur.ac.uk.OAI2:604<\/identifier><datestamp>\n      2011-06-14T15:40:08Z<\/datestamp><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        Planar graph coloring avoiding monochromatic subgraphs : trees and paths make it difficult.<\/dc:title><dc:creator>\n        Broersma,  H. J.<\/dc:creator><dc:creator>\n        Fomin,  F. V.<\/dc:creator><dc:creator>\n        Kratochvil,  J.<\/dc:creator><dc:creator>\n        Woeginger,  G. J.<\/dc:creator><dc:description>\n        We consider the problem of coloring a planar graph with the minimum number of colors so that each color class avoids one or more forbidden graphs as subgraphs. We perform a detailed study of the computational complexity of this problem. We present a complete picture for the case with a single forbidden connected (induced or noninduced) subgraph. The 2-coloring problem is NP-hard if the forbidden subgraph is a tree with at least two edges, and it is polynomially solvable in all other cases. The 3-coloring problem is NP-hard if the forbidden subgraph is a path with at least one edge, and it is polynomially solvable in all other cases. We also derive results for several forbidden sets of cycles. In particular, we prove that it is NP-complete to decide if a planar graph can be 2-colored so that no cycle of length at most 5 is monochromatic.<\/dc:description><dc:subject>\n        Graph partitioning<\/dc:subject><dc:subject>\n         Forbidden subgraph<\/dc:subject><dc:subject>\n         Computational complexity.<\/dc:subject><dc:publisher>\n        Springer<\/dc:publisher><dc:source>\n        Algorithmica, 2006, Vol.44(4), pp.343-361 [Peer Reviewed Journal]<\/dc:source><dc:date>\n        2006-05<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:identifier>\n        dro:604<\/dc:identifier><dc:identifier>\n        issn:0178-4617<\/dc:identifier><dc:identifier>\n        issn: 1432-0541<\/dc:identifier><dc:identifier>\n        doi:10.1007\/s00453-005-1176-8<\/dc:identifier><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/604\/<\/dc:identifier><dc:identifier>\n        http:\/\/dx.doi.org\/10.1007\/s00453-005-1176-8<\/dc:identifier><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/604\/1\/604.pdf<\/dc:identifier><dc:rights>\n        The original publication is available at http:\/\/ww.springerlink.com<\/dc:rights><dc:accessRights>\n        info:en-repo\/semantics\/openAccess<\/dc:accessRights><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["issn: 1432-0541","0178-4617"," 1432-0541","issn:0178-4617"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2006,"topics":["Graph partitioning","Forbidden subgraph","Computational complexity."],"subject":["Article","PeerReviewed"],"fullText":"Durham Research Online\nDeposited in DRO:\n02 July 2008\nVersion of attached file:\nAccepted Version\nPeer-review status of attached file:\nPeer-reviewed\nCitation for published item:\nBroersma, H. J. and Fomin, F. V. and Kratochvil, J. and Woeginger, G. J. (2006) \u2019Planar graph coloring\navoiding monochromatic subgraphs : trees and paths make it difficult.\u2019, Algorithmica., 44 (4). pp. 343-361.\nFurther information on publisher\u2019s website:\nhttp:\/\/dx.doi.org\/10.1007\/s00453-005-1176-8\nPublisher\u2019s copyright statement:\nThe original publication is available at http:\/\/ww.springerlink.com\nAdditional information:\nUse policy\nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without prior permission or charge, for\npersonal research or study, educational, or not-for-profit purposes provided that:\n\u2022 a full bibliographic reference is made to the original source\n\u2022 a link is made to the metadata record in DRO\n\u2022 the full-text is not changed in any way\nThe full-text must not be sold in any format or medium without the formal permission of the copyright holders.\nPlease consult the full DRO policy for further details.\nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom\nTel : +44 (0)191 334 3042 \u2014 Fax : +44 (0)191 334 2971\nhttp:\/\/dro.dur.ac.uk\nPlanar graph coloring avoiding monochromatic\nsubgraphs: trees and paths make it difficult \u2217\nHajo Broersma\nUniversity of Durham, UK\nhajo.broersma@durham.ac.uk\nFedor V. Fomin\nUniversity of Bergen, Norway\nfomin@ii.uib.no\nJan Kratochv\u00b4\u0131l\nCharles University, Czech Republic\nhonza@kam.ms.mff.cuni.cz\nGerhard J. Woeginger\nEindhoven University of Technology, The Netherlands\ngwoegi@win.tue.nl\nAbstract\nWe consider the problem of coloring a planar graph with the minimum number of\ncolors so that each color class avoids one or more forbidden graphs as subgraphs. We\nperform a detailed study of the computational complexity of this problem.\nWe present a complete picture for the case with a single forbidden connected (induced\nor non-induced) subgraph. The 2-coloring problem is NP-hard if the forbidden subgraph\nis a tree with at least two edges, and it is polynomially solvable in all other cases. The\n3-coloring problem is NP-hard if the forbidden subgraph is a path with at least one\nedge, and it is polynomially solvable in all other cases. We also derive results for several\nforbidden sets of cycles. In particular, we prove that it is NP-complete to decide if a\nplanar graph can be 2-colored so that no cycle of length at most 5 is monochromatic.\nKeywords: graph coloring; graph partitioning; forbidden subgraph; planar graph; com-\nputational complexity.\nAMS Subject Classifications: 05C15,05C85,05C17\n\u2217An extended abstract was presented at SWAT2002 [5]. The work of HB and FVF is sponsored by NWO-\ngrant 047.008.006. Part of the work was done while FVF a visiting postdoc at DIMATIA-ITI (supported\nby GAC\u02c7R 201\/99\/0242 and by the Ministry of Education of the Czech Republic as project LN00A056). JK\nacknowledges support by the Czech Ministry of Education as project LN00A056. GJW acknowledges support\nby the START program Y43-MAT of the Austrian Ministry of Science.\n1\n1 Introduction\nWe denote by G = (V,E) a finite undirected and simple graph with |V | = n vertices and\n|E| = m edges. For any non-empty subset W \u2286 V , the subgraph of G induced by W is\ndenoted by G[W ]. A clique of G is a non-empty subset C \u2286 V such that all the vertices of\nC are mutually adjacent. A non-empty subset I \u2286 V is independent if no two of its elements\nare adjacent. An r-coloring of the vertices of G is a partition V1, V2, . . . , Vr of V ; the r sets\nVj are called the color classes of the r-coloring. An r-coloring is proper if every color class\nis an independent set. The chromatic number \u03c7(G) is the minimum integer r for which a\nproper r-coloring of G exists.\nEvidently, an r-coloring is proper if and only if for every color class Vj , the induced\nsubgraph G[Vj ] does not contain a subgraph isomorphic to P2. (We use Pk to denote the\npath on k vertices.) This observation leads to a number of interesting generalizations of\nthe classical graph coloring concept. One such generalization was suggested by Harary [24]:\nGiven a graph property pi, a positive integer r, and a graph G, a pi r-coloring of G is a (not\nnecessarily proper) r-coloring in which each subgraph induced by a color class has property\npi. This generalization has been studied for the cases where the graph property pi is being\nacyclic, or planar, or perfect, or a path of length at most k, or a clique of size at most k.\nWe refer the reader to the work of Brown & Corneil [8, 7, 9], Chartrand et al. [11, 12, 13],\nFarrigua [16] and Sachs [29] for more information on these variants.\nIn this paper, we will investigate graph colorings where the property pi can be defined\nvia some (maybe infinite) list of forbidden induced subgraphs. This naturally leads to the\nnotion of F-free colorings. Let F = {F1, F2, . . . } be the set of so-called forbidden graphs.\nThroughout the paper we will assume that the set F is non-empty, and that all graphs in F\nare connected and contain at least one edge. Moreover, to avoid technical difficulties in the\nproofs we will assume that no graph of F is a proper subgraph of another graph of F . For a\ngraph G, a (not necessarily proper) r-coloring with color classes V1, V2, . . . , Vr is called weakly\nF\u2013free, if for all 1 \u2264 j \u2264 r, the graph G[Vj ] does not contain any graph from F as an induced\nsubgraph. Similarly, we say that an r-coloring is strongly F\u2013free if G[Vj ] does not contain\nany graph from F as an (induced or non-induced) subgraph. The smallest possible number\nof colors in a weakly (respectively, strongly) F-free coloring of a graph G is called the weakly\n(respectively, strongly) F-free chromatic number ; it is denoted by \u03c7W (F , G) (respectively, by\n\u03c7S(F , G)).\nIn the cases where F = {F} consists of a single graph F , we will sometimes simplify\nthe notation and not write the curly brackets: We will write F -free short for {F}-free,\n\u03c7W (F,G) short for \u03c7W ({F}, G), and \u03c7S(F,G) short for \u03c7S({F}, G). With this notation\n\u03c7(G) = \u03c7S(P2, G) = \u03c7\nW (P2, G) holds for every graph G, and hence also\n\u03c7W (F , G) \u2264 \u03c7S(F , G) \u2264 \u03c7(G).\nIt is easy to construct examples where both inequalities are strict. For instance, for F = {P3}\n(the path on three vertices) and G = C3 (the cycle on three vertices) we have \u03c7(G) = 3,\n\u03c7S(P3, G) = 2, and \u03c7\nW (P3, G) = 1.\nOur main concern in the paper are planar graphs. Recall that a graph is planar if it\ncan be drawn in the (Euclidean) plane without intersections of edges. Such a drawing is\n2\nreferred to as a plane graph. Hence a graph G is planar if and only if there exists a plane\ngraph isomorphic to G. A planar graph is called outerplanar if it has a drawing such that\nall vertices lie on the boundary of the unbounded face (this face is usually referred to as the\nouter face).\n1.1 Previous results\nThe literature contains quite a number of papers on weakly and strongly F-free colorings of\ngraphs. One of the most general results is due to Achlioptas [1]: For any graph F with at\nleast three vertices and for any r \u2265 2, the problem of deciding whether a given input graph\nhas a weakly F -free r-coloring is NP-hard. We often use weakly (strongly) F-free r-coloring\nas shorthand for the corresponding decision problem.\nThe special case of weakly P3-free coloring is known as the subcoloring problem in the\nliterature. It has been studied by Broere & Mynhardt [4], by Albertson, Jamison, Hedetniemi\n& Locke [2], by Fiala, Jansen, Le & Seidel [18], Gimbel & Hartman [21], and by Broersma,\nFomin, Nes\u02c7etr\u02c7il & Woeginger [6]. We will further utilize especially the following result:\nProposition 1.1. [Fiala, Jansen, Le & Seidel [18]]\nWeakly P3-free 2-coloring is NP-hard for triangle-free planar graphs.\nA (1, 2)-subcoloring of G is a partition of V into two sets S1 and S2 such that S1 induces\nan independent set and S2 induces a subgraph consisting of a matching and some (possibly\nno) isolated vertices. Le & Le [27] proved that recognizing if a graph is (1, 2)-subcolorable is\nNP-hard even for cubic triangle-free planar graphs.\nThe case of weakly P4-free coloring has been investigated by Gimbel & Nes\u02c7etr\u02c7il [22] who\nstudy the problem of partitioning the vertex set of a graph into induced cographs. Since\ncographs are exactly the graphs without an induced P4, the graph parameter studied in [22]\nequals the weakly P4-free chromatic number of a graph. In [22] it is proved that the problems\nof deciding \u03c7W (P4, G) \u2264 2, \u03c7\nW (P4, G) = 3, \u03c7\nW (P4, G) \u2264 3 and \u03c7\nW (P4, G) = 4 all are NP-\nhard and\/or coNP-hard for planar graphs. The work of Hoa`ng & Le [25] on weakly P4-free\n2-colorings was motivated by the Strong Perfect Graph Conjecture. Among other results,\nthey show that weakly P4-free 2-coloring is NP-hard for comparability graphs.\nA notion that is closely related to strongly F -free r-coloring is the so-called defective\ngraph coloring. A defective (k, d)-coloring of a graph is a k-coloring in which each color class\ninduces a subgraph with maximum degree at most d. Defective colorings have been studied\nfor example by Archdeacon [3], by Cowen, Cowen & Woodall [14], and by Frick & Henning\n[19]. Cowen, Goddard & Jesurum [15] have shown that the defective (3, 1)-coloring problem\nand the defective (2, d)-coloring problem for any d \u2265 1 are NP-hard even for planar graphs.\nWe observe that for any k, defective (k, 1)-coloring is equivalent to strongly P3-free k-coloring,\nand hence we derive the following proposition.\nProposition 1.2. [Cowen, Goddard & Jesurum [15]]\n(i) Strongly P3-free 2-coloring is NP-hard for planar graphs.\n(ii) Strongly P3-free 3-coloring is NP-hard for planar graphs.\n3\n1.2 Our results\nWe perform a complexity study of weakly and strongly F-free coloring problems for planar\ngraphs. By the Four Color Theorem, every planar graph G satisfies \u03c7(G) \u2264 4. Consequently,\nevery planar graph also satisfies \u03c7W (F , G) \u2264 4 and \u03c7S(F , G) \u2264 4, and so we may concentrate\non 2-colorings and on 3-colorings. For the case of a single forbidden subgraph, we obtain the\nfollowing results for 2-colorings:\n\u2022 If the forbidden (connected) subgraph F is not a tree, then every planar graph is\nstrongly and hence also weakly F -free 2-colorable. Therefore, the corresponding deci-\nsion problems are trivially solvable.\n\u2022 If the forbidden subgraph F = P2, then F -free 2-coloring is equivalent to proper 2-\ncoloring. It is well-known that this problem is polynomially solvable.\n\u2022 If the forbidden subgraph is a tree T with at least two edges, then both weakly and\nstrongly T -free 2-colorings are NP-hard for planar graphs. Hence, these problems are\nintractable.\nFor 3-colorings with a single forbidden subgraph, we obtain the following results:\n\u2022 If the forbidden (connected) subgraph F is not a path, then every planar graph is\nstrongly and hence also weakly F -free 3-colorable. Hence, the corresponding decision\nproblems are trivially solvable.\n\u2022 For every path P with at least one edge, both weakly and strongly P -free 3-colorings\nare NP-hard for planar graphs. Hence, these problems are intractable.\nMoreover, we derive several results for 2-colorings with certain forbidden sets of cycles.\n\u2022 For the forbidden set F345 = {C3, C4, C5}, both weakly and strongly F345-free 2-colorings\nare NP-hard for planar graphs. In fact for any finite set F\u2265345 \u2287 {C3, C4, C5} of cycles,\nboth weakly and strongly F\u2265345-free 2-colorings are NP-hard for planar input graphs.\n\u2022 Also for the forbidden set Fcycle of all cycles, both weakly and strongly Fcycle-free 2-\ncolorings are NP-hard for planar graphs.\n\u2022 For the forbidden set Fodd of all cycles of odd lengths, every planar graph is strongly\nand hence also weakly Fodd-free 2-colorable. This follows from (in fact, it is equivalent\nto) the Four Color Theorem.\n2 The machinery for establishing NP-hardness\nThroughout this section, let F denote some fixed set of forbidden planar subgraphs. We\nassume that all graphs in F are connected and contain at least two edges. We also assume\nthat no graph of F is a (not necessarily induced) proper subgraph of another graph from\nF . We will develop a generic NP-hardness proof for certain types of weakly and strongly\nF-free 2-coloring problems. The crucial concept is the so-called equalizer gadget. Before we\n4\ndefine this gadget, let us introduce the following technical concept of crossing graphs. We\nnote that we distinguish between planar graphs and plane graphs (the latter being particular\nnonintersecting drawings of abstract planar graphs), but we use the same notation for a plane\ngraph and its underlying abstract (planar) graph. When talking about more than one graph,\nwe use subscripts to distinguish their vertex and edge sets (i.e., VG and EG denote the vertex\nand edge sets of a graph G).\nDefinition 2.1. Given a plane graph G with outer face C and a set S \u2286 VG of vertices on the\nboundary of C (referred to as contact points), we say that another plane graph H is crossing\nG if the following assertions hold:\n1. G \u222aH is a plane graph (i.e., no edge of G crosses any edge of H in the simultaneous\ndrawing of G and H),\n2. all edges of EH \\ EG are drawn in C,\n3. no edge of EH \\ EG is incident with a vertex of VG \\ S,\n4. VH \u2229 (VG \\ S) 6= \u2205.\nIf G is a plane graph with a set S of contact points, we say that a planar graph H may\ncross G if some nonintersecting planar drawing of a graph isomorphic to H is crossing G.\nIn the left half of Figure 1 the graph H induced by the vertices b2, c and d is crossing the\ngraph G induced by the vertices the a, b1, b2, b3 and c with S = {c}.\nDefinition 2.2. (Equalizer)\nAn (a, b)-equalizer for F is a plane graph E with two nonadjacent contact points a and b on\nthe boundary of the outer face, which satisfies the following properties:\n(i) In every weakly F-free 2-coloring of E , a and b receive the same color.\n(ii) There exists a strongly F-free 2-coloring of E such that a and b receive the same color,\nwhereas no monochromatic copy of a graph in F may cross E . Such a coloring is called\na good 2-coloring of E .\nThe graph E in the right half of Figure 1 is an (a, b)-equalizer for P3. In every weakly P3-\nfree 2-coloring of E the vertices a and b should receive the same color; otherwise a monochro-\nmatic P3 is unavoidable if we extend the 2-coloring. A good coloring of E can be obtained\nby assigning a and b the same color and all remaining vertices of E the other color.\nTo better understand the definition of an equalizer E , let us remark right away that if F\ncontains a graph with a leaf, then an F-free 2-coloring of E is good if and only if all neighbors\nof the contact points in E have the color that is not assigned to the contact points.\nThe rest of this section is devoted to the proof of the following (technical) main theorem.\nThis theorem is going to generate a number of NP-hardness statements in the subsequent\nsections of the paper.\nTheorem 2.3. Let F be a set of connected planar graphs that all contain at least two edges,\nsuch that no graph of F is a proper subgraph of another graph of F . Suppose that\n5\nab1\nb2\nb3\nc d a b\nFigure 1: Examples to illustrate Definitions 2.1 and 2.2.\n\u2022 F contains a graph on at least four vertices with a cut vertex, or a 2-connected graph\nwith a planar embedding with at least five vertices on the boundary of the outer face;\n\u2022 there exists an (a, b)-equalizer for F .\nThen deciding weakly F-free 2-colorability and deciding strongly F-free 2-colorability are NP-\nhard problems for planar input graphs.\nWe postpone the proof of Theorem 2.3 to Section 2.2, but first introduce some additional\ntools.\n2.1 Gadgets for the NP-hardness proof\nWe will design a series of gadgets that all use the equalizer gadget as an atomic component.\nIn all constructions, the only connections between an equalizer and the rest of the constructed\ngraph will always be via the contact points. The use of the equalizer gadget is justified (and\nmotivated) by the following lemma.\nLemma 2.4. Consider a nontrivial planar graph H and an edge xy \u2208 EH . Let the graph\nH+ result from H by adding a vertex-disjoint copy E of an (a, b)-equalizer to H and then\nidentifying vertex x with contact point a, and vertex y with contact point b.\nThen H+ is a planar graph, and H+ has a strongly\/weakly F-free 2-coloring if and only\nif H has a strongly\/weakly F-free 2-coloring in which x and y both receive the same color.\nProof. Since E is a plane graph with a and b on the boundary of the outer face, H+ is\nalso planar and it has a nonintersecting drawing such that all edges of H are drawn in the\nouter face of E . For the proof of the \u2018only if\u2019 part, observe that every strongly\/weakly F-\nfree 2-coloring of H+ induces a strongly\/weakly F-free 2-coloring of H. By property (i) in\nDefinition 2.2, this induced coloring assigns the same color to x and y. For the proof of the \u2018if\u2019\npart, we construct a strongly\/weakly F-free 2-coloring of H+: We use the strongly\/weakly\nF-free 2-coloring for the subgraph H, and we color the (a, b)-equalizer E using a good coloring\nin the sense of property (ii) in Definition 2.2.\n6\nThe negator gadget. An (a, b)-negator for F is a plane graph N with two nonadjacent\ncontact points a and b on the boundary of the outer face, which satisfies the following prop-\nerties:\n(i) In every weakly F-free 2-coloring of N , a and b receive different colors.\n(ii) There exists a strongly F-free 2-coloring of N such that a and b receive different colors,\nwhereas no monochromatic copy of a graph in F may cross N . Such a coloring is called\na good 2-coloring of N .\nNext we show how to construct such an (a, b)-negator from (a, b)-equalizers. We choose an\narbitrary graph F \u2208 F , and take some fixed planar embedding of F to form the so-called\nskeleton of the negator. Let a\u2032 and b\u2032 denote two vertices on the boundary of the outer face of\nF . We partition VF into two disjoint sets V1 and V2 in such a way that both F [V1] and F [V2]\n(the subgraphs of F induced by V1 and V2) are connected, and so that a\n\u2032 \u2208 V1 and b\n\u2032 \u2208 V2.\nFor every edge xy \u2208 EF [V1] \u222aEF [V2], we add an equalizer between x and y exactly in the way\nwe described in Lemma 2.4. We introduce a new vertex a and connect it by an equalizer to a\u2032;\nwe create a new vertex b and connect it by an equalizer to b\u2032. This completes the construction\nof N . To see that (i) is fulfilled, consider some weakly F-free 2-coloring of N . Suppose that\na and b receive the same color. Then the equalizers enforce that this color propagates to all\nvertices in the skeleton, and this yields a monochromatic induced copy of F , a contradiction.\nTo see that (ii) is fulfilled, we may color {a} \u222a V1 with one color, and {b} \u222a V2 with the other\ncolor. The vertices inside the equalizer gadgets may be colored using a good coloring in the\nsense of Definition 2.2.(ii). Any monochromatic copy of a graph F \u2032 \u2208 F would either contain\nsome edges of some equalizer gadget (which is impossible by the goodness of the equalizer\ncoloring) or be a subgraph of F [V1] or F [V2] (which is impossible by the assumption we made\non F).\nIn our constructions, the negator gadget will be used similarly as the equalizer gadget\nas described in Lemma 2.4. While the equalizer gadget can be used to enforce that a pair\nof vertices receives the same color, with the help of the negator gadget we can enforce that\na pair of adjacent vertices in some planar graph must receive different colors in any weakly\nF-free 2-coloring. We omit the details since the counterpart of Lemma 2.4 with respect to\nnegators and its proof are straightforward variations on Lemma 2.4 and its proof.\nFor our NP-hardness proof (of Theorem 2.3) we need two additional gadgets.\nThe clause gadget with four contact points. The gadget C4(a, b, c, d) is a plane graph\nC with pairwise nonadjacent contact points a, b, c and d that lie in this (cyclic) ordering on\nthe boundary of the outer face of C. It has the following properties:\n(i) In every weakly F-free 2-coloring of C, not all four contact points receive the same\ncolor.\n(ii) Any 2-coloring of the four contact points that uses both colors, can be extended to a\nstrongly F-free 2-coloring of the gadget C, in such a way that no monochromatic copy\nof a graph in F may cross C. Such a coloring is called a good 2-coloring of C.\n7\nNow let us construct such a clause gadget C4(a, b, c, d). Suppose we are in the case assumed\nin Theorem 2.3. Hence the set F contains some graph F that can be planarly embedded such\nthat there are four vertices a\u2032, b\u2032, c\u2032, d\u2032 on the boundary of the outer face. We choose this\nplane graph F to form the skeleton of the clause gadget. We create four new vertices a, b, c,\nand d. Each of these new vertices is connected by an equalizer to its corresponding primed\nvertex on the outer face of the skeleton. The vertices in the skeleton are partitioned into four\ncomponents (with connecting edges between them) such that a\u2032, b\u2032, c\u2032, d\u2032 end up in different\ncomponents. Within each component, we introduce equalizers along every edge in the way\nwe described in Lemma 2.4. This completes the construction.\nBy now it is routine to verify that the construction indeed fulfills the two properties (i)\nand (ii). We leave the details to the reader.\nThe clause gadget with five contact points. The gadget C5(a, b, c, d1, d2) is a plane\ngraph C with pairwise nonadjacent contact points a, b, c, d1, and d2 that lie in the (cyclic)\nordering a \u2212 b \u2212 d1 \u2212 c \u2212 d2 on the boundary of the outer face of C. It has the following\nproperties:\n(i) In every weakly F-free 2-coloring of C, the vertices d1 and d2 receive the same color,\nand at least one of the vertices a, b, c receives the opposite color.\n(ii) Any 2-coloring of the five contact points that assigns the same color to d1 and d2, and\nthe opposite color to at least one of a, b, c, can be extended to a strongly F-free 2-\ncoloring of the gadget C, in such a way that no monochromatic copy of a graph in F\nmay cross C. Such a coloring is called a good 2-coloring of C.\nSuppose we are in the case assumed in Theorem 2.3, hence the set F contains a graph on at\nleast four vertices with a cut vertex, or a 2-connected graph with a planar embedding with\nat least five vertices on the boundary of the outer face.\nLet us first discuss the case of a graph F \u2208 F with a cut vertex d\u2032. The skeleton of\nC5(a, b, c, d1, d2) is formed by a planar embedding of F where d\n\u2032 is on the boundary of the\nouter face. Choose three vertices a\u2032, b\u2032, c\u2032 that all lie on the boundary of the outer face,\nand that do not belong to the same component of F \u2212 d\u2032, such that we can move around\nthe boundary of the outer face starting at a\u2032, then moving to b\u2032, then to d\u2032, then to c\u2032, then\nto d\u2032 again, and then returning to a\u2032 (maybe meeting other vertices, including d\u2032 and b\u2032, in\nbetween). For example, if F = K1,k is a star with k \u2265 3 leaves, we choose d\n\u2032 as the center,\nand a\u2032, b\u2032 and c\u2032 as three successive end vertices in a cyclic ordering in a planar embedding\nof F . We can move around the boundary of the outer face from a\u2032 (via d\u2032) to b\u2032, then to\nd\u2032 and to c\u2032, and back to a\u2032 via d\u2032 (and alternating between d\u2032 and the possible other end\nvertices if k \u2265 3). The other cases are similar. We create five new vertices a, b, c, d1, and\nd2, and we connect them by equalizers to a\n\u2032, b\u2032, c\u2032, d\u2032, and d\u2032, respectively, at the place\nwhere we hit the primed vertices in the above ordering a\u2032 \u2212 b\u2032 \u2212 d\u2032 \u2212 c\u2032 \u2212 d\u2032 while moving\naround the boundary of the outer face in the way we described. The vertices in the skeleton\nare partitioned into four components such that a\u2032, b\u2032, c\u2032, d\u2032 end up in different components.\nWithin each component, we introduce equalizers along every edge in the way we described\nin Lemma 2.4. This completes the construction for the first case.\n8\nNext we discuss the case of a 2-connected planar graph F \u2208 F that has a planar embedding\nwith at least five vertices on the boundary of the outer face. We use such an embedding as\nthe skeleton of C5(a, b, c, d1, d2). Consider the cycle C that forms the boundary of the outer\nface. Choose five vertices v0 \u2212 v1 \u2212 v2 \u2212 v3 \u2212 v4 in this order along C. Because all these\nv-vertices are on the outer face, only two subcases are possible.\n\u2022 (Subcase 1) There is a face D inside C that touches all these v-vertices. Then we choose\ntwo nonadjacent vertices d\u20321 and d\n\u2032\n2 from these five and three additional appropriate\nvertices a\u2032, b\u2032, c\u2032 from C such that the cyclic ordering along the cycle C is a\u2032\u2212 b\u2032\u2212 d\u20321\u2212\nc\u2032 \u2212 d\u20322. Then we connect d\n\u2032\n1 and d\n\u2032\n2 by an equalizer that is put inside D. Notice that\nin the graph F \u2212{d\u20321, d\n\u2032\n2} the vertex c\n\u2032 is in a component different from the component\ncontaining a\u2032 or b\u2032.\n\u2022 (Subcase 2) There is an i and a path P (possibly just one edge) internally-disjoint from\nC that connects two vertices vi and vi+3 (where the indices are taken modulo 5). We\nput d\u20321 = vi, d\n\u2032\n2 = vi+3 and call the remaining three v-vertices a\n\u2032, b\u2032, c\u2032 in such a way\nthat the cyclic ordering along C is a\u2032\u2212 b\u2032\u2212d\u20321\u2212 c\n\u2032\u2212d\u20322. For every edge of P we connect\nits incident vertices by an equalizer. Again notice that in the graph F \u2212 VP the vertex\nc\u2032 is in a component different from the component containing a\u2032 or b\u2032.\nIn either subcase, we create five new vertices a, b, c, d1, d2, and connect them by equal-\nizers to their corresponding primed vertices on the outer face of the skeleton. Finally, we\npartition the vertices of the skeleton into five connected subgraphs, each containing one of\nthe vertices a\u2032, b\u2032, c\u2032, d\u20321, d\n\u2032\n2, and we introduce equalizers along the edges of these subgraphs as\nin Lemma 2.4. This completes the construction.\nIt can be verified that this construction in both cases and subcases indeed fulfills the two\nproperties (i) and (ii).\n2.2 The NP-hardness argument\nNow we prove Theorem 2.3. The proof will be done by a reduction from an NP-hard variant\nof the 3-satisfiability problem: Let \u03a6 be a Boolean formula in conjunctive normal form over\na set X of logical variables; every clause in \u03a6 contains exactly three variables. With \u03a6 we\nassociate a graph Q\u03a6. The vertices of Q\u03a6 are the clauses and the variables in \u03a6. There are\ntwo types of edges in Q\u03a6. The first type belongs to a cycle that spans all the clauses in\nsome ordering. The second type connects a variable x \u2208 X to a clause \u03c6 \u2208 \u03a6 if and only if\nx or x\u00af occurs as a literal in \u03c6. We call a formula \u03a6 planar if for some choice of the cycle\nspanning all the clauses of \u03a6 the associated graph Q\u03a6 is planar. Fellows et al. [17] proved\nthat the restriction of the 3-satisfiability problem to planar formulae is NP-hard. (To be\nprecise, they only show the NP-hardness for formulas with at most three literals per clause.\nOne may achieve exactly three literals per clause by dropping the requirement of distinctness\nof literals per clause. Since variable-clause incidences will later be replaced by gadgets with\nnonadjacent contact points, our final graph will have no multiple edges anyway.)\nConsider an arbitrary planar formula \u03a6 as described above, and let Q\u03a6 be an associated\nplanar graph. We will construct in polynomial time a planar graphG\u03a6 which has the following\n9\ntwo properties: If formula \u03a6 is satisfiable, then G\u03a6 has a strongly F-free 2-coloring. If G\u03a6 has\na weakly F-free 2-coloring, then formula \u03a6 is satisfiable. This clearly will prove Theorem 2.3.\nFix a planar embedding of Q\u03a6. The cycle through the clause vertices divides the plane\ninto a bounded and an unbounded region. Variables in X that are embedded in the un-\nbounded region are called outer variables, and variables in the bounded region are called\ninner variables. As it is usual in reductions from planar SAT, we construct a graph from\nthe planar drawing of Q\u03a6 by a series of local replacements. Slightly informally described,\nwe thicken the edges and the vertices in the planar embedding of Q\u03a6 such that they become\nstreets and squares; this yields a map into which we will put our gadgets. For every variable\nx \u2208 X, we put a vertex v(x) into the square corresponding to x. For every clause \u03c6 \u2208 \u03a6, we\nput a corresponding clause gadget into the square corresponding to \u03c6 in the following way.\n\u2022 If all three literals in clause \u03c6 belong to inner variables, then the clause gadget for \u03c6\nis a clause gadget C4(a, b, c, d) with four contact points. The contact point d lies in\nthe center of the square of \u03c6, and the contact points a, b, c lie at the beginning of the\nstreets leading to these three inner variables.\n\u2022 If two literals in clause \u03c6 belong to inner variables and one literal belongs to an outer\nvariable, then the clause gadget for \u03c6 is a clause gadget C5(a, b, c, d1, d2) with five contact\npoints. The contact points d1 and d2 lie at the beginning of the streets that lead to\nthe left and the right neighbors of the clause \u03c6 on the clause cycle. The contact points\na and b lie at the beginning of the streets that lead to the two inner variables. The\ncontact point c lies at the beginning of the street that leads to the outer variable.\n\u2022 The case of three outer variables, and the case of one inner and two outer variables are\nhandled symmetrically to the above two cases.\nIf the variable x occurs un-negated (respectively, negated) in the clause \u03c6, then we put an\nequalizer (respectively, a negator) from v(x) to the corresponding contact point in the clause\ngadget for \u03c6. Finally, we put an equalizer gadget between the d-vertices into every street that\nconnects a clause square to another clause square, and thus connect all clause gadgets into a\nring. These equalizer gadgets connect contact points d from clause gadgets C4(a, b, c, d), and\ncontact points d1 and d2 from clause gadgets C5(a, b, c, d1, d2) in an appropriate way. This\ncompletes the construction of the graph G\u03a6 which is easily seen to be planar.\nAssume that formula \u03a6 is satisfiable, and consider a satisfying truth assignment. Intu-\nitively speaking, color 1 will correspond to TRUE and color 0 will correspond to FALSE.\nColor all contact points d, d1, and d2 of clause gadgets by color 0. If variable x is TRUE,\nthen color the vertex v(x) by color 1. If x is FALSE, then color v(x) by 0. The equaliz-\ners and negators propagate the colors (respectively opposite colors) of the variables to the\ncorresponding contact points a, b, c in the clause gadgets. Since the truth assignment is a\nsatisfying truth assignment, in every clause gadget at least one of the contact points a, b, c is\ncolored 1. Moreover, in every clause gadget the contact points d (respectively, d1 and d2) are\ncolored 0. Therefore, we can use property (ii) of the clause gadgets to get a strongly F-free\n2-coloring of all used clause gadgets. Altogether, this yields a strongly F-free 2-coloring for\nthe graph G\u03a6.\n10\nNow assume that G\u03a6 has a weakly F-free 2-coloring. Because of the ring of equalizer\ngadgets that connect the clause gadgets to each other and property (i) of the C5-gadgets,\nall contact points d, d1, d2 of clause gadgets must receive the same color; without loss of\ngenerality we assume that this color is 0. We construct the following truth assignment for\nX: If v(x) is colored 1, then x is set to TRUE. If v(x) is colored 0, then x is set to FALSE.\nSuppose for the sake of contradiction that some clause \u03c6 in \u03a6 is not satisfied by this truth\nsetting. Then the three literals in \u03c6 all are FALSE, and hence all three contact points a,\nb, c in the corresponding clause gadget are colored 0. But then all contact points of this\nclause gadget are colored 0, and by property (i) of the clause gadgets the coloring cannot be\na weakly F-free 2-coloring. This contradiction shows that \u03a6 is satisfiable.\nThis completes the proof of Theorem 2.3.\n3 Tree-free 2-colorings of planar graphs\nThe main result of this section is an NP-hardness result for weakly and strongly T -free\n2-colorings of planar graphs for the case where T is a tree with at least two edges (see\nTheorem 3.3). The proof of this result is based on an inductive argument over the number\nof edges in T . The following two propositions are used as the base case of the induction.\nLet K1,k denote the complete bipartite graph with one vertex in one color class and the\nother k \u2265 1 vertices in the other color class. The leftmost drawing in Figure 2 shows a K1,7.\nProposition 3.1. For every k \u2265 2, it is NP-hard to decide whether a planar graph has a\nweakly (strongly) K1,k-free 2-coloring.\nProof. For k = 2, the statement for weakly K1,k-free 2-colorings follows from Proposition 1.1,\nand the statement for strongly K1,k-free 2-colorings follows from Proposition 1.2.(i).\nFor k \u2265 3, we apply Theorem 2.3. The first condition in this theorem is fulfilled, since\nfor k \u2265 3, the star K1,k is a graph on at least four vertices with a cut vertex.\nFor the second condition, we note that the complete bipartite graph K2,2k\u22121 with color\nclasses I with |I| = 2k \u2212 1, and {a, b}, is an (a, b)-equalizer for F = {K1,k}. This graph\nsatisfies Definition 2.2.(i): In any 2-coloring, at least k of the vertices in I receive the same\ncolor, say color 0. If a and b are colored differently, then one of them is colored 0. This would\nyield an induced monochromatic K1,k. A good coloring as required in Definition 2.2.(ii)\nresults from coloring a and b by the same color, and all vertices in I by the opposite color.\nThis coloring has no monochromatic copy of K1,k itself, and since all neighbors of the contact\npoints are colored with the other color than the contact points, no monochromatic copy of\nK1,k may cross the equalizer.\nAs we mentioned in Section 1.1, Cowen, Goddard & Jesurum [15] have shown that the\ndefective (2, d)-coloring problem for any d \u2265 1 is NP-hard even for planar graphs. This\nimplies that strongly K1,k-free 2-coloring is NP-hard for planar graphs for any k \u2265 2, so the\nabove proof is needed for the weak case only.\nFor 1 \u2264 k \u2264 m, a double-star Xk,m is a tree of the following form: Xk,m has k +m + 2\nvertices. There are two adjacent central vertices y1 and y2. Vertex y1 is adjacent to k leaves,\nand y2 is adjacent to m leaves. In other words, the double-star Xk,m results from adding an\n11\nFigure 2: The graph K1,7 and the double-stars X4,5 and X1,1.\nedge between the centers (vertices of maximum degree) of K1,k and K1,m. See Figure 2 for\nan illustration. Note that X1,1 is isomorphic to the path P4.\nProposition 3.2. For every 1 \u2264 k \u2264 m, it is NP-hard to decide whether a planar graph has\na weakly (strongly) Xk,m-free 2-coloring.\nProof. We apply Theorem 2.3. The first condition in this theorem is fulfilled, since Xk,m is\na graph on at least four vertices with a cut vertex. For the second condition, we construct\nan (a, b)-equalizer.\nThe (a, b)-equalizer E = (V \u2032, E\u2032) consists of 2m+k\u2212 1 independent copies (V i, Ei) of the\ndouble-star Xk,m where 1 \u2264 i \u2264 2m+ k\u2212 1. Moreover, there are five special vertices a, b, v1,\nv2, and v3. We define\nV \u2032 = {v1, v2, v3, a, b} \u222a\n\u22c3\n1\u2264i\u22642m+k\u22121\nV i and\nE\u2032 = {v1v2, v2v3, v1v3, av3, bv3} \u222a\u22c3\n1\u2264i\u22642m+k\u22121\nEi \u222a\n\u22c3\n1\u2264i\u2264m\n{v1v : v \u2208 V\ni} \u222a\n\u22c3\nm+1\u2264i\u22642m\n{v2v : v \u2208 V\ni} \u222a\n\u22c3\n2m+1\u2264i\u22642m+k\u22121\n{v3v : v \u2208 V\ni} .\nSee Figure 3 for an illustration.\nWe claim that every 2-coloring of E with a and b colored differently contains a monochro-\nmatic induced copy of Xk,m: Consider some weakly Xk,m-free 2-coloring of E . Then each\ncopy (V i, Ei) of Xk,m must have at least one vertex that is colored 0 and at least one vertex\nthat is colored 1. If v1 and v2 had the same color, then together with appropriate vertices in\nV i, 1 \u2264 i \u2264 2m, they would form a monochromatic copy of Xk,m. Hence, we may assume\nby symmetry that v1 is colored 1, and that v2 and v3 are colored 0. Suppose for the sake\n12\nv1 v2\nXk,m Xk,m \u00b7 \u00b7 \u00b7\n\ufe38 \ufe37\ufe37 \ufe38\nm\nXk,m Xk,m Xk,m Xk,m\u00b7 \u00b7 \u00b7\n\u00b7 \u00b7 \u00b7\ufe38 \ufe37\ufe37 \ufe38\nm\nv3\nXk,m Xk,m\u00b7 \u00b7 \u00b7\nk\u22121\ufe37 \ufe38\ufe38 \ufe37\na b\nFigure 3: An equalizer for the double-star Xk,m.\nof contradiction that a and b are colored differently. Then one of them would be colored 0,\nand there would be a monochromatic copy of Xk,m with center vertices v3 and v2. Thus E\nsatisfies property (i) in Definition 2.2.\nTo show that also property (ii) in Definition 2.2 is satisfied, we construct a good 2-\ncoloring: The vertices a, b, v1 are colored 0, and v2 and v3 are colored 1. In every set V\ni\nwith 1 \u2264 i \u2264 m, one vertex is colored 0 and all other vertices are colored 1. In every set V i\nwith m + 1 \u2264 i \u2264 2m + k \u2212 1, one vertex is colored 1 and all other vertices are colored 0.\nThis coloring has no monochromatic copy of Xk,m, and since vertex v3 as the only neighbor\nof the contact points a, b is colored differently than a, b, no monochromatic copy of any tree\nmay cross E .\nNow we are ready to prove the main result of this section.\nTheorem 3.3. Let T be a tree with at least two edges. Then it is NP-hard to decide whether\na planar input graph G has a weakly (strongly) T -free 2-coloring.\nProof. By induction on the number ` of edges in T . If T has ` = 2 edges, then T = K1,2, and\nNP-hardness follows by Proposition 1.1. If T has ` \u2265 3 edges, then we consider the so-called\nshaved tree T \u2217 of T that results from T by removing all the leaves. If the shaved tree T \u2217 is\na single vertex, then T is a star, and NP-hardness follows by Proposition 3.1. If the shaved\ntree T \u2217 is a single edge, then T is a double-star, and NP-hardness follows by Proposition 3.2.\nHence, it remains to settle the case where the shaved tree T \u2217 contains at least two edges.\nIn this case we know from the induction hypothesis that weakly (strongly) T \u2217-free 2-coloring\nis NP-hard. Consider an arbitrary planar input graph G\u2217 for weakly (strongly) T \u2217-free 2-\ncoloring. To complete the NP-hardness proof, we will construct in polynomial time a planar\ngraphG that has a weakly (strongly) T -free 2-coloring if and only ifG\u2217 has a weakly (strongly)\nT \u2217-free 2-coloring: Let \u2206 be the maximum number of leaves pending on a vertex of T . For\n13\nevery vertex v in G\u2217, we create \u2206 independent copies T1(v), . . . , T\u2206(v) of T , and we join v\nto all vertices of all these copies.\nAssume first that G\u2217 is weakly (strongly) T \u2217-free 2-colorable. We extend this coloring to a\nweakly (strongly) T -free 2-coloring of G by taking a proper 2-coloring of every subgraph Ti(v)\nin G, such that for every v \u2208 VG\u2217 , exactly one vertex of each Ti(v) receives the same color as\nv. It can be verified that this extended 2-coloring for G does not contain any monochromatic\ncopy of T .\nNow assume that G is weakly (strongly) T -free 2-colorable, and let c be such a 2-coloring.\nEvery subgraph Ti(v) in G must meet both colors. This implies that every vertex v in the\nsubgraph G\u2217 of G has at least \u2206 neighbors of color 0 and at least \u2206 neighbors of color 1\nin the subgraphs Ti(v). Any monochromatic (induced) copy of T\n\u2217 in G\u2217 would then extend\nto a monochromatic (induced) copy of T in G, and hence the restriction of the coloring c to\nthe subgraph G\u2217 is a weakly (strongly) T \u2217-free 2-coloring. This concludes the proof of the\ntheorem.\nUsing the same ideas as in the proofs of the previous theorem and propositions, one can\nprove the following more general statement about larger sets of forbidden graphs.\nTheorem 3.4. Let F be a finite set of graphs containing at least one tree with at least two\nedges. Then both weakly and strongly F-free 2-coloring are NP-hard.\nProof. Let T \u2208 F be a tree in F with the minimum number of edges. If T = P3, then the\nremaining graphs in F must be complete (every non-complete connected graph contains P3 as\nan induced subgraph), so they could be only K3 or K4. The NP-hardness of F-free 2-coloring\nthen follows from Proposition 1.1, since for coloring triangle-free graphs, graphs containing\ntriangles are irrelevant as forbidden subgraphs.\nFor T being a star (with at least three leaves) or a double-star, the result follows directly\nfrom the construction of equalizers in the proofs of Propositions 3.1 and 3.2, since the good\ncolorings presented there are such that the neighbors of the contact points receive a differ-\nent color from the contact points, and the only connected monochromatic subgraphs of the\nequalizers are singletons (in case of T = K1,k) or smaller double-stars (Xk\u22121,m in case of\nT = Xk,m). Since T itself may be used as the skeleton of the negator and the clause gadgets,\nthe good colorings of these gadgets also do not contain a monochromatic copy of any graph\nof F (neither induced nor non-induced).\nIf T is such that the shaved tree T \u2217 has at least two edges, we proceed by induction\nsimilarly as in the proof of Theorem 3.3. For any graph F \u2208 F , we denote by F \u2217 the shaved\ncopy of F , i.e., the graph obtained from F by removing all leaves (vertices of degree one). Let\n\u2206 be the maximum number of leaves pending on a vertex of a graph from F . Construct the\ngraph G from a graph G\u2217 as in the proof of Theorem 3.3 and use the fact that G has a weakly\n(strongly) F-free 2-coloring if and only if G\u2217 has a weakly (strongly) F\u2217-free 2-coloring, where\nF\u2217 = {F \u2217 : F \u2208 F}.\n14\n4 Cycle-free 2-colorings of planar graphs\nIn this section we turn to the case when the forbidden graph F is not a tree and hence\ncontains a cycle (we assume F is connected).\nIf F contains an odd cycle, then the Four Color Theorem (4CT) shows that any planar\ngraph G has a strongly F -free 2-coloring: a proper 4-coloring of G partitions VG into two sets\nS1 and S2 each inducing a bipartite graph. Coloring all the vertices of Si by color i yields a\nstrongly F -free 2-coloring of G. If we extend the set of forbidden graphs to all cycles of odd\nlength, denoted by Fodd, then the converse is also true: In any Fodd-free 2-coloring of G both\nmonochromatic subgraphs of G are bipartite, yielding a 4-coloring of G. To summarize we\nobtain the following.\nProposition 4.1. The statement \u201c\u03c7S(Fodd, G) \u2264 2 for every planar graph G\u201d is equivalent\nto the 4CT.\nIn case F is just the triangle C3, one can avoid using the heavy 4CT machinery to prove\nthat \u03c7S(C3, G) \u2264 2 for every planar graph G by applying a result due to Burstein [10]. A\nbrief sketch of the argument is as follows. Prove by induction that in any plane triangulation,\nany nonmonochromatic precoloring of the outer face (triangle) can be extended to a coloring\nwhich avoids monochromatic triangles.\nIf F contains no triangles, a result of Thomassen [31] can be applied. He proved that\nthe vertex set of any planar graph can be partitioned into two sets each of which induces a\nsubgraph with no cycles of length exceeding 3. Hence every planar graph is strongly F\u22654-free\n2-colorable, where F\u22654 denotes the set of all cycles of length exceeding 3. The following\ntheorem summarizes the above observations.\nTheorem 4.2. If the forbidden connected subgraph F is not a tree, then every planar graph\nis strongly and hence also weakly F -free 2-colorable.\nThe picture changes if one forbids all cycles, or a combination of cycles including the\ntriangle. A result of Stein [30] states that the vertex set of a plane triangulation G can\nbe partitioned into two sets each inducing a forest if and only if the plane dual of G is\nhamiltonian. Since deciding hamiltonicity of planar cubic graphs is NP-hard (see [20]), this\nimplies that deciding whether a (maximal) planar graph has a weakly (strongly) cycle-free\n2-coloring is NP-hard. We are able to slightly strengthen this statement.\nTheorem 4.3. Let F345 = {C3, C4, C5} be the set of cycles of lengths three, four, and five.\nThen the problem of deciding whether a given planar graph has a weakly (strongly) F345-free\n2-coloring is NP-hard.\nWe prove this theorem in a more general setting as a corollary of Theorem 4.4. But first\nlet us note that {C3, C4, C5} is a minimal set of cycles which determines an NP-hard instance\nof the F-free 2-coloring problem. Indeed, if F \u2282 {C3, C4, C5} is a proper subset, then every\nplanar graph is strongly F-free 2-colorable. We have noted this already for F \u2286 {C3, C5}\nand F \u2286 {C4, C5}, and the last case F = {C3, C4} is covered by the result of Kaiser &\nS\u02c7krekovski [26] who proved that every planar graph is strongly {C3, C4}-free 2-colorable.\n15\nTheorem 4.4. Let F be a finite set of planar 2-connected graphs. If there exists a pla-\nnar graph which is not weakly (strongly) F-free 2-colorable, then weakly (strongly) F-free\n2-coloring is NP-hard for planar input graphs.\nProof. Consider the graphs of F with some fixed plane embeddings. If every face of every\ngraph F \u2208 F is C3 or C4, then every planar graph is strongly F-free 2-colorable by the main\nresult in [26]. If not, there is an F \u2208 F with a face of size at least 5 and the first assumption\nof Theorem 2.3 is met.\nNext we show how to construct an equalizer. LetH \u2032 be a smallest (by the number of edges)\nplanar graph which is not weakly (strongly) F-free 2-colorable. Take an edge xy \u2208 EH\u2032 and\ndenote by H the graph obtained from H \u2032 by deleting this edge. Then H is weakly (strongly)\nF-free 2-colorable, and in every weakly (strongly) F-free 2-coloring of H the vertices x and\ny receive the same color. We construct an equalizer E by concatenating sufficiently many\ncopies of H. More formally, choose a number k to be larger than the order of any graph in\nF . The copies of H will be Hi = (Vi, Ei) with Vi = {vi : v \u2208 VH} and Ei = {uivi : uv \u2208 EH},\nfor i = 1, 2, . . . , k. For i = 1, 2, . . . , k \u2212 1, we identify yi with xi+1, and we set a = x1 and\nb = yk to be the contact points.\nClearly E is planar and in every weakly (strongly) F-free 2-coloring of E the vertices xi, yi\nfor i = 1, 2, . . . , k, and hence also a and b, receive the same color.\nLet c be a weakly (strongly) F-free 2-coloring of H. Color E using c on every Hi. Consider\na graph F \u2208 F . No copy of F which lies entirely in E is monochromatic, since the 2-\nconnectedness of F implies that such a copy of F lies entirely within one of theHi\u2019s. Therefore\nthis 2-coloring of E is weakly (strongly) F -free. It also follows from the 2-connectedness of F\nthat every copy of F which crosses E contains a path from a to b through E . But every such\npath has more vertices than F . Hence the 2-coloring of E is good.\nTo conclude the proof of Theorem 4.3, it would suffice to construct a planar graph which\nis not weakly F345-free 2-colorable. It is, however, equally simple to describe an equalizer for\nF345 (and exploit the fact that C5 \u2208 F345 is 2-connected and every plane drawing contains a\nface of size 5): Let \u0398(x, y) be the graph depicted in Figure 4. This graph has the following\nimportant property: In any weakly F345-free 2-coloring of \u0398(x, y), the vertices x and y have\ndifferent colors (we leave the simple proof of this fact to the reader). The (a, b)-equalizer is\nconstructed from a graph \u0398(a, x) and a graph \u0398(b, y) by identifying the two vertices x and\ny. A good 2-coloring of the (a, b)-equalizer is induced by the 2-coloring indicated in Figure 4.\nThe following statement is now a direct corollary of Theorem 4.4 and Theorem 4.3.\nCorollary 4.5. For any finite set F\u2265345 \u2287 {C3, C4, C5} of cycles, both weakly and strongly\nF\u2265345-free 2-coloring are NP-hard for planar input graphs.\n5 3-colorings of planar graphs\nA linear forest is a disjoint union of paths (some of which may be trivial). The following\nresult was proved independently in [23] and [28].\n16\nx y\nFigure 4: A gadget for the forbidden set F345 in Theorem 4.3.\nProposition 5.1. [Goddard [23] and Poh [28]]\nEvery planar graph has a partition of its vertex set into three subsets such that every subset\ninduces a linear forest.\nThis result immediately implies that if a connected graph F is not a path, then \u03c7W (F,G) \u2264\n3 and \u03c7S(F,G) \u2264 3 hold for all planar graphs G. Hence, these coloring problems are trivially\nsolvable in polynomial time.\nFigure 5: Example for the graph Y3.\nWe now turn to the remaining cases of F -free 3-coloring for planar graphs where the\nforbidden graph F is a path. We start with a technical lemma that will yield a gadget for\nthe NP-hardness argument.\nLemma 5.2. For every k \u2265 2, there exists an outerplanar graph Yk that satisfies the following\nproperties.\n(i) Yk is not weakly Pk-free 2-colorable.\n(ii) There exists a strongly Pk-free 3-coloring of Yk, in which at least one color class being\nis independent set.\n17\nProof. The skeleton of the graph Yk is formed by a regular tree, in which every inner vertex has\nexactly k children, and all paths from the root to a leaf have exactly k vertices. Additionally\nto the edges in this regular tree, the children of every inner vertex are connected by a path.\nSee Figure 5 for an illustration.\nSuppose there was a Pk-free 2-coloring of Yk. Since the children of any vertex induce a\npath Pk, both colors must show up at the children. Consequently, for every inner vertex v at\nleast one of its children must get the same color as v. But this yields a monochromatic induced\nPk running from the root to some leaf. This contradiction proves property (i). Property (ii)\nis straightforward to prove: The graph Yk is outerplanar, and hence properly 3-colorable.\nTheorem 5.3. For any path Pk with k \u2265 2, it is NP-hard to decide whether a planar input\ngraph has a weakly (strongly) Pk-free 3-coloring.\nProof. We will use induction on k. The basic cases are k = 2 and k = 3. For k = 2,\nboth weakly and strongly P2-free 3-colorings are equivalent to proper 3-coloring which is\nwell-known to be NP-hard for planar graphs.\nNext, consider the case k = 3. Proposition 1.2.(ii) yields NP-hardness of strongly P3-\nfree 3-coloring for planar graphs. For weakly P3-free 3-coloring, we sketch a reduction from\nproper 3-coloring of planar graphs. As a gadget, we use the outerplanar graph Z depicted\nin Figure 6. The crucial property of Z is that it does not allow a weakly P3-free 2-coloring,\nas is easily checked. Now consider an arbitrary planar graph G. From G we construct the\nplanar graph G\u2032: For every vertex v in G, create a copy Z(v) of Z, and add all possible edges\nbetween v and Z(v). Since Z(v) is outerplanar, the new graph G\u2032 is planar. It is easy to\nverify that \u03c7(G) \u2264 3 if and only if \u03c7W (P3, G\n\u2032) \u2264 3.\nFigure 6: The graph Z in the proof of Theorem 5.3.\nFor k \u2265 4, we will give a reduction from weakly (strongly) Pk\u22122-free 3-coloring to weakly\n(strongly) Pk-free 3-coloring. Consider an arbitrary planar graph G, and construct the fol-\nlowing planar graph G\u2032: For every vertex v in G, create a copy Yk(v) of the graph Yk from\nLemma 5.2, and add all possible edges between v and Yk(v). Since Yk is outerplanar, the\nnew graph G\u2032 is planar. If G has a weakly (strongly) Pk\u22122-free 3-coloring, then this can\nbe extended to a weakly (strongly) Pk-free 3-coloring of G\n\u2032 by coloring the subgraphs Yk(v)\naccording to Lemma 5.2.(ii). And if G\u2032 has a weakly (strongly) Pk-free 3-coloring, then by\nLemma 5.2.(i) this induces a weakly (strongly) Pk\u22122-free 3-coloring for G.\n18\n6 Concluding remarks and open problems\n6.1 Triangle-free graphs. By modifying the gadgets for the equalizers in such a way that\nthe planar graph G\u03a6 constructed in the proof of Theorem 2.3 becomes triangle-free, one\nmight be able to prove complexity results for weakly (strongly) F -free 2-coloring restricted to\ntriangle-free planar graphs. In fact, it is not difficult to apply this method to prove that for\nF = K1,k with k \u2265 2, weakly (strongly) F -free 2-coloring remains NP-hard for triangle-free\nplanar graphs.\nProblem. Is it true that every triangle-free planar graph G is P4-free 2-colorable? This\nwould imply that for every connected graph F of diameter at least 3 there is a weakly F -free\n2-coloring of G.\n6.2 Monotonicity. All our NP-hardness techniques are such that hardness proofs for F-free\n2-colorability extend naturally to NP-hardness of F \u2032-free 2-colorability for any finite F \u2032 \u2287 F .\nThis raises the following question.\nProblem. For finite sets of graphs F \u2032 \u2287 F , is it true that F \u2032\u2212F \u2212 2\u2212CPG \u221d F \u2212F \u2212 2\u2212\nCPG? (F \u2212 F \u2212 2\u2212 CPG standing for F-Free-2-Coloring-Planar-Graphs.)\nNote that this is not necessarily true for infinite sets of forbidden graphs. The infinite\nset Fcycle of all cycles has uncountably many subsets, and if each of these defines a different\nproblem, infinitely many of them will have to be undecidable, whereas deciding the existence\nof an Fcycle-free 2-coloring is surely in NP.\n6.3 Forbidden sets of cycles. It would be interesting to characterize for which particular\n(finite) sets of forbidden cycles the F-free 2-coloring problem on planar graphs is feasible and\nfor which it is hard. In particular, for two cycles this question remains open if one of them\nis the triangle and the other one is an even cycle of length greater than 4.\nProblem. For which k > 2 does there exist a planar graph which is not {C3, C2k}-free\n2-colorable?\n6.4 Equalizers. Despite our inductive proof of NP-hardness for forbidden trees, it would be\ninteresting to know whether one can use the equalizer gadget machinery directly.\nProblem. Does there exist an equalizer for any tree T?\nAcknowledgments\nWe are grateful to Oleg Borodin, Alesha Glebov, Sasha Kostochka, and Carsten Thomassen\nfor fruitful discussions on the topic of this paper.\n19\nReferences\n[1] D. Achlioptas, The complexity of G-free colorability, Discrete Math., 165\/166 (1997),\npp. 21\u201330.\n[2] M. O. Albertson, R. E. Jamison, S. T. Hedetniemi, and S. C. Locke, The\nsubchromatic number of a graph, Discrete Math., 74 (1989), pp. 33\u201349.\n[3] D. Archdeacon, A note on defective colorings of graphs in surfaces, J. Graph Theory,\n11 (1987), pp. 517\u2013519.\n[4] I. Broere and C. M. Mynhardt, Generalized colorings of outer-planar and planar\ngraphs, in Graph theory with applications to algorithms and computer science, Wiley,\nNew York, 1985, pp. 151\u2013161.\n[5] H. Broersma, F. V. Fomin, J. Kratochv\u00b4\u0131l, and G. J. Woeginger, Planar graph\ncoloring with forbidden subgraphs: Why trees and paths are dangerous, Proceedings of\nthe 8th Scandinavian Workshop on Algorithm Theory (SWAT 2002), Springer-Verlag\nLecture Notes in Computer Science, vol. 2368, 2002, pp. 160\u2013169.\n[6] H. J. Broersma, F. V. Fomin, J. Nes\u02c7etr\u02c7il, and G. J. Woeginger, More about\nsubcolorings, Computing, 69 (2002), pp. 187\u2013203.\n[7] J. I. Brown and D. G. Corneil, On generalized graph colorings, J. Graph Theory,\n11 (1987), pp. 87\u201399.\n[8] J. I. Brown and D. G. Corneil, Graph properties and hypergraph colorings, Discrete\nMath., 98 (1991), pp. 81\u201393.\n[9] J. I. Brown and D. G. Corneil, On uniquely \u2212G k-colorable graphs, Quaestiones\nMath., 15 (1992), pp. 477\u2013487.\n[10] M. I. Burstein, The bi-colorability of planar hypergraphs, Sakharth. SSR Mecn. Akad.\nMoambe, 78 (1975), pp. 293\u2013296.\n[11] G. Chartrand, D. P. Geller, and S. Hedetniemi, A generalization of the chro-\nmatic number, Proc. Cambridge Philos. Soc., 64 (1968), pp. 265\u2013271.\n[12] G. Chartrand and H. V. Kronk, The point-arboricity of planar graphs, J. London\nMath. Soc., 44 (1969), pp. 612\u2013616.\n[13] G. Chartrand, H. V. Kronk, and C. E. Wall, The point-arboricity of a graph,\nIsrael J. Math., 6 (1968), pp. 169\u2013175.\n[14] L. J. Cowen, R. H. Cowen, and D. R. Woodall, Defective colorings of graphs\nin surfaces: partitions into subgraphs of bounded valency, J. Graph Theory, 10 (1986),\npp. 187\u2013195.\n20\n[15] L. J. Cowen, W. Goddard, and C. E. Jesurum, Defective coloring revisited, J.\nGraph Theory, 24 (1997), pp. 205\u2013219.\n[16] A. Farrugia, Uniqueness and complexity in generalized coloring, PhD thesis, University\nof Waterloo, 2003.\n[17] M. R. Fellows, J. Kratochv\u00b4\u0131l, M. Middendorf, F. Pfeiffer, The complexity of\ninduced minors and related problems, Algorithmica, 13 (1995), pp. 266\u2013282.\n[18] J. Fiala, K. Jansen, V. B. Le, and E. Seidel, Graph subcoloring: Complexity and\nalgorithms, SIAM J. Discrete Math., 16 (2003), pp. 635\u2013650.\n[19] M. Frick and M. A. Henning, Extremal results on defective colorings of graphs,\nDiscrete Math., 126 (1994), pp. 151\u2013158.\n[20] M. R. Garey, D. S. Johnson, and R. E. Tarjan, The planar Hamiltonian problem\nis NP-complete, SIAM J. Comput., 5 (1976), pp. 704\u2013714.\n[21] J. Gimbel and C. Hartman, Subcolorings and the subchromatic number of a graph,\nDiscrete Math., 272 (2003), pp. 139\u2013154.\n[22] J. Gimbel and J. Nes\u02c7etr\u02c7il, Partitions of graphs into cographs, Technical Report 2000-\n470, KAM-DIMATIA, Charles University, Czech Republic, 2000. To appear in Discrete\nMath.\n[23] W. Goddard, Acyclic colorings of planar graphs, Discrete Math., 91 (1991), pp. 91\u201394.\n[24] F. Harary, Conditional colorability in graphs, in Graphs and applications, Wiley, New\nYork, 1985, pp. 127\u2013136.\n[25] C. T. Hoa`ng and V. B. Le, P4-free colorings and P4-bipartite graphs, Discrete Math.\nTheor. Comput. Sci., 4 (2001), pp. 109\u2013122.\n[26] T. Kaiser and R. S\u02c7krekovski, Planar graph colorings without short monochromatic\ncycles, J. Graph Theory, 46 (2004), pp. 25\u201338.\n[27] H.-O. Le and V. B. Le, The NP-completeness of (1, r)-subcoloring of cubic graphs,\nInformation Proc. Letters, 81 (2002), pp. 157\u2013162.\n[28] K. S. Poh, On the linear vertex-arboricity of a planar graph, J. Graph Theory, 14 (1990),\npp. 73\u201375.\n[29] H. Sachs, Finite graphs (Investigations and generalizations concerning the construction\nof finite graphs having given chromatic number and no triangles)., in Recent Progress in\nCombinatorics, Academic Press, New York, 1969, pp. 175\u2013184.\n[30] S. K. Stein, B-sets and planar graphs, Pac. J. Math., 37 (1971), pp. 217\u2013224.\n[31] C. Thomassen, Decomposing a planar graph into degenerate graphs, J. Combin. Theory\nSer., B 65 (1995), pp. 305\u2013314.\n21\n"}