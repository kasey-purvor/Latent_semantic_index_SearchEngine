{"doi":"10.1016\/j.ymssp.2010.08.003","coreId":"140422","oai":"oai:dspace.lib.cranfield.ac.uk:1826\/5791","identifiers":["oai:dspace.lib.cranfield.ac.uk:1826\/5791","10.1016\/j.ymssp.2010.08.003"],"title":"Road vehicle state estimation using low-cost GPS\/INS","authors":["Tin Leung, King","Whidborne, James F.","Purdy, David","Barber, Phil"],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2011-08-01T00:00:00Z","abstract":"Assuming known vehicle parameters, this paper proposes an innovative integrated Kalman filter (IKF) scheme to estimate vehicle dynamics, in particular the sideslip, the heading and the longitudinal velocity. The IKF is compared with the 2DoF linear bicycle model, the triple Kalman filter (KF) and a model-based KF (MKF) in a simulation environment. Simulation results show that the proposed IKF is superior to other KF designs (both Kinematic KF and MKF) on state estimation when tyre characteristics are within the linear region (i.e. manoeuvres below 55 kph)","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/140422.pdf","fullTextIdentifier":"http:\/\/dx.doi.org\/10.1016\/j.ymssp.2010.08.003","pdfHashValue":"873579bf672464cbbb4b648471e8c70ffe66f002","publisher":"Elsevier Science B.V., Amsterdam","rawRecordXml":"<record><header><identifier>\noai:dspace.lib.cranfield.ac.uk:1826\/5791<\/identifier><datestamp>2015-09-17T08:52:01Z<\/datestamp><setSpec>hdl_1826_19<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>Road vehicle state estimation using low-cost GPS\/INS<\/dc:title><dc:creator>Tin Leung, King<\/dc:creator><dc:creator>Whidborne, James F.<\/dc:creator><dc:creator>Purdy, David<\/dc:creator><dc:creator>Barber, Phil<\/dc:creator><dc:description>Assuming known vehicle parameters, this paper proposes an innovative integrated Kalman filter (IKF) scheme to estimate vehicle dynamics, in particular the sideslip, the heading and the longitudinal velocity. The IKF is compared with the 2DoF linear bicycle model, the triple Kalman filter (KF) and a model-based KF (MKF) in a simulation environment. Simulation results show that the proposed IKF is superior to other KF designs (both Kinematic KF and MKF) on state estimation when tyre characteristics are within the linear region (i.e. manoeuvres below 55 kph).<\/dc:description><dc:publisher>Elsevier Science B.V., Amsterdam<\/dc:publisher><dc:date>2012-12-17T23:01:00Z<\/dc:date><dc:date>2012-12-17T23:01:00Z<\/dc:date><dc:date>2011-08-01T00:00:00Z<\/dc:date><dc:type>Article<\/dc:type><dc:identifier>King Tin Leung, James F. Whidborne, David Purdy, Phil Barber, Road vehicle state estimation using low-cost GPS\/INS, Mechanical Systems and Signal Processing, Volume 25, Issue 6, August 2011, Pages 1988\u20132004.<\/dc:identifier><dc:identifier>0888-3270<\/dc:identifier><dc:identifier>http:\/\/dx.doi.org\/10.1016\/j.ymssp.2010.08.003<\/dc:identifier><dc:identifier>http:\/\/dspace.lib.cranfield.ac.uk\/handle\/1826\/5791<\/dc:identifier><dc:rights>NOTICE: this is the author\u2019s version of a work that was accepted for publication in Mechanical Systems and Signal Processing. Changes resulting from the publishing process, such as peer review, editing, corrections, structural formatting, and other quality control mechanisms may not be reflected in this document. Changes may have been made to this work since it was submitted for publication. A definitive version was subsequently published in Mechanical Systems and Signal Processing, VOL 25, ISSUE 6, (2011) DOI: 10.1016\/j.ymssp.2010.08.003<\/dc:rights><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["issn:0888-3270","0888-3270"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2011,"topics":[],"subject":["Article"],"fullText":"www.elsevier.com\/locate\/ymssp\nAuthor\u2019s Accepted Manuscript\nRoad vehicle state estimation using low-cost\nGPS\/INS\nKing Tin Leung, James Whidborne, David Purdy,\nPhil Barber\nPII: S0888-3270(10)00288-8\nDOI: doi:10.1016\/j.ymssp.2010.08.003\nReference: YMSSP 2634\nTo appear in: Mechanical Systems and Signal\nReceived date: 2 March 2010\nRevised date: 29 June 2010\nAccepted date: 11 August 2010\nCite this article as: King Tin Leung, James Whidborne, David Purdy and Phil Barber,\nRoad vehicle state estimation using low-cost GPS\/INS, Mechanical Systems and Signal,\ndoi:10.1016\/j.ymssp.2010.08.003\nThis is a PDF file of an unedited manuscript that has been accepted for publication. As\na service to our customers we are providing this early version of the manuscript. The\nmanuscript will undergo copyediting, typesetting, and review of the resulting galley proof\nbefore it is published in its final citable form. Please note that during the production process\nerrors may be discovered which could affect the content, and all legal disclaimers that apply\nto the journal pertain.\nRoad Vehicle State Estimation using Low-Cost GPS\/INS\nKing Tin Leunga, James Whidbornea, David Purdyb, Phil Barberc\naSchool of Engineering, Cranfield University, Cranfield, UK\nbDepartment of Engineering Systems and Management, Cranfield University, Shrivenham, UK\ncJaguar Land Rover, Whitley, Coventry, UK\nAbstract\nAssuming known vehicle parameters, this paper proposes an innovative Integrated Kalman Filter (IKF) scheme to\nestimate vehicle dynamics, in particular the sideslip, the heading and the longitudinal velocity. The IKF is compared\nwith the 2DoF linear bicycle model, the Triple Kalman Filter (KF) and a Model-based KF (MKF) in a simulation\nenvironment. Simulation results show that the proposed IKF is superior to other KF designs (both Kinematic KF and\nMKF) on state estimation when tyre characteristics are within the linear region (i.e. manoeuvres below 55kph).\nKeywords: GPS, INS, Kalman filter, State estimation, Low-cost, IPG CarMaker\n1. Introduction\nIn recent years, modern automobiles have included ever more sophisticated electronics and control systems, such\nas the Anti-lock Braking System (ABS) and the Electronic Stability Program (ESP). With the implementation of these\nintelligent systems, vehicles have become safer to drive (Van Zanten, 2002) with less involvement in fatal accidents\n(Farmer et al., 1997; Farmer, 2001). Evidence of this can be seen in the increased demand for ABS since 1990\n(Farmer et al., 1997). It is envisaged that future development of more advanced and sophisticated control systems\nrequires accurate and \u2018up-to-date\u2019 vehicle dynamic information. In particular, as highlighted by Manning and Crolla\n(2007), sideslip estimation is essential for a commercial viable sideslip stability control system.\nVehicle dynamic states measurement and estimation can be categorised into three main approaches. The indi-\nrect approach, which involves the use of existing in-car sensors such as the Inertial Navigation System (INS) and\nwheel speed sensor. This is the cheapest solution, yet suffers from accumulative integration errors due to sensor\nbias (Lawrence, 1998). The direct approach, includes sensors such as the speed-over-ground and Global Navigation\nSatellite System (GNSS), in particular the Global Positioning System (GPS). These sensors can provide accurate in-\nformation but are expensive in price and to maintain. The third is the Vehicle Model (VM) approach. Although this\nis able to produce good estimations, VM is normally non-linear and parameter dependent. For a detailed review, see\nLeung et al. (2009a)\nIn order to obtain more accurate vehicle dynamic information, it is natural to combine the main methods in order\nto utilise their respective strengths. With INS and GPS in mind, Leung et al. (2009a) have identified four integrated\napproaches: GPS\/INS, GPS\/VM, INS\/VM, and GPS\/INS\/VM. A large amount of the reported research is based on the\nGPS\/INS Kinematic Kalman Filter (KKF) design (Bevly et al., 2000, 2001, 2002). This approach is easy to implement\nand is able to predict biases in the sensors. Although vehicle states can be accurately estimated with these proposed\nKKFs, they demand additional vehicle sensors and a high sampling-rate GPS unit. Based on a vehicle model, the\nGPS\/VM (Bayliss et al., 2006) and the INS\/VM (Best et al., 2000; Cherouat et al., 2005) are fused in a Model-\nbased KF (MKF). Although fewer sensors are required in these designs, accurate model parameters are required.\nConsidering the advantages of the KKF and MKF, state estimations can be further improved with an Integrated KF\n(IKF), which utilises GPS\/INS\/VM. In Anderson and Bevly (2005), Rock et al. (2005), and Best et al. (2007), the\nauthors have used either multiple GPS antennae or expensive GPS\/INS units (such as the RT3000 (OXTS, 2008)) to\npredict the vehicle states and model parameters. Although their designs give accurate estimations, they are generally\ntoo expensive to deploy in most production vehicles.\nAlthough the above integrated approaches are able to estimate the vehicle dynamics, components used in the\ndesign are normally expensive specialised equipment. One of the challenges that automotive industries constantly\nPreprint submitted to Mechanical Systems and Signal Processing June 29, 2010\nface is the cost-effectiveness ratio. Hence this paper proposes an IKF design that uses low-cost GPS\/INS\/Wheel Speed\nSensors (WSS)\/VM. A single antenna GPS operating at 1Hz with an accuracy of \u00b13m (Appendix A), is combined with\nexisting in-car sensors (Appendix B) and WSS. The estimated states are then used in the 2 Degree of Freedom (2DoF)\nvehicle model to estimate the steer bias and the sideslip angles. Apart from the vehicle dynamic state estimations, this\nproposed IKF is also able to predict the biases in the steering wheel and the tyre radius, thereby, giving an accurate\nestimation of the vehicle longitudinal velocity (speed over ground).\nThe proposed design is tested by simulation using IPG CarMaker (aka CM) and Matlab\/Simulink. Two tracks\nare defined in CarMaker and a virtual car based on the parameters of a Jaguar Saloon is constructed. Virtual sensors\nare also attached onto the virtual car and results are simulated with different driving speeds. The virtual sensor\nmeasurements are inputted in Matlab\/Simulink, where noise and bias are added. Various KF designs are then tested\nin Matlab\/Simulink to analyse their performance.\nThis paper is organised as follows. In the next section, a typical planar linear bicycle model is given and its relation\nwith the GPS and INS measurements are explained. Section 3 outlines the basic formulation for a Kalman Filter (KF),\nthe key components of the proposed IKF design are also discussed. Using the professional vehicle simulation program,\nIPG CarMaker, the simulation set-up is explained in Section 4. Section 5 presents the findings from the simulation.\nThis paper finishes with conclusions and suggestions for future work.\n2. Vehicle Modelling and Sensors\nIn a modern vehicle, the most common INS sensors used for measurements are the accelerometers and gyroscopes.\nTo reduce cost, manufacturers often place these sensors in the longitudinal, lateral and upward direction only, thus\nmeasuring longitudinal and lateral acceleration, and yaw rate. In addition, the longitudinal velocities at the wheels\ncan also be measured by the WSS. With the increase popularity in satellite navigation, GPS receiver has become one\nof the most wanted add-on device for drivers.\nXe\nYe\nXv\nYv\n\u03c8\u02d9\na\nb\nV\nFyF\n\u03b1F\n\u03b4F\n\u03b2F\nFyR\nFxR\nFxF\n\u03c8\n\u03bd\n\u03b2\nXb\nYb\nIN\nS\nXe\nYe\nGPS\n\u03b1R\n\u03b2\nFigure 1: Typical planar bicycle model\n2.1. Vehicle Sensors\nBefore describing the sensors that are used in this study, it is important to define each of their operating framework.\nFigure 1 shows a typical planar bicycle model of a four-wheeled-vehicle equipped with INS and GPS sensors. There\n2\nare normally a total of three sets of coordinate frameworks: the East North Up frame (ENU\/eframe) for the GPS, the\nbody frame (b-frame) for the INS and the ISO vehicle frame (v-frame) for the vehicle. The b-frame is rigidly attached\nto the vehicle body while the v-frame is fixed on the wheel\/road plane. Note that although GPS often uses the North\nEast Down (NED) frame which is standard in aerospace applications, the ENU is the ISO standard (ISO 8855) for the\nautomotive sector.\n2.1.1. Accelerometers and Gyroscopes\nIn Figure 1, the e-frame, b-frame and the v-frame are shown two-dimensionally with their corresponding sub-\nscripts. The majority of the INS used in ground vehicles nowadays are strap-down sensors, consisting of only two\naccelerometers (longitudinal and lateral) and a yaw rate gyroscope. This type of sensor moves and orientates with the\nvehicle, so the accelerometers and the gyro measure the accelerations (Ax, Ay) and yaw rate (rm), respectively, in the\nb-frame.\nThe accelerometer measurements, Ax and Ay are sensitive to both translational and rotational movement of the\nvehicle. It is assumed here that the INS is mounted rigidly to the vehicle, and aligned perfectly along the longitudinal\nand lateral direction at the centre of gravity (cg). The accelerations in the b-frame on a level road without rolling or\npitching motions are, hence, related to the accelerations at cg (x\u00a8v, y\u00a8v) in the v-frame by:\nAx = x\u00a8v \u2212 y\u02d9vrm (1)\nAy = y\u00a8v + x\u02d9vrm (2)\nNote that Eqs (1) and (2) assume zero rolling and pitching in the Euler angles (i.e. \u03c6, \u03b8 = 0) and for the rate\ngyroscopes (pm, qm = 0), thus making the Euler yaw rate equal to the yaw rate gyroscopic measurements, \u03c8\u02d9 = rm,\n(see Leung et al. (2009a) for details). With this, the vehicle sideslip at the cg can be estimated in terms of the ratio\nbetween the lateral and longitudinal velocities,\n\u03b2 =\ny\u02d9v\nx\u02d9v\n=\n\u222b\n(Ay \u2212 x\u02d9vrm)dt\u222b\n(Ax + y\u02d9vrm)dt\n(3)\nReferring to Figure 1, an alternative way to obtain the sideslip and vehicle velocities in the v-frame is by trans-\nforming the accelerations measured from the sensor (b-frame) to the e-frame using the Euler angle:\nx\u00a8e = Ax cos(\u03c8) \u2212 Ay sin(\u03c8) (4)\ny\u00a8e = Ax sin(\u03c8) + Ay cos(\u03c8) (5)\nTo obtain the velocities and positions in the e-frame, the above equation is integrated. Using the velocities in the\ne-frame, the track angle (or path angle) of the vehicle, \u03bd, can be determined as\n\u03bd = tan\u22121\n(\ny\u02d9e\nx\u02d9e\n)\n(6)\nThe sideslip angle, \u03b2, is simply the difference between the track angle and the yaw angle:\n\u03b2 = \u03bd \u2212 \u03c8 (7)\nWith the sideslip calculated from Eq. (7), the vehicle velocity (v-frame) can also be derived as\nx\u02d9v = V cos(\u03b2) (8)\ny\u02d9v = V sin(\u03b2) (9)\nwhere V is the resultant vehicle velocity with a relation of,\nV =\n\u221a\nx\u02d92e + y\u02d92e =\n\u221a\nx\u02d92v + y\u02d92v (10)\nWhen a vehicle is travelling on a straight road horizontally without any side force, the sideslip angle is zero. Thus,\nthe track angle, \u03bd, described by the GPS coincides with the yaw angle, \u03c8.\n3\n2.1.2. Wheel Speed Sensors\nOther than the INS and GPS, WSS can also be used for predicting the longitudinal velocity in the v-frame and the\nyaw rate. With a given wheel radius, Ri, and rotational speed, \u03c9i, the velocity of the wheel about its centre axis can\nbe derived,\nVi = \u03c9iRi (11)\nwhere i is the position of the wheel, i.e FR, FL, RR, RL. Eq. (11) represents the longitudinal velocity under the no-slip\ncondition. When slip occurs, the determined longitudinal velocity will be inaccurate; this error is accounted for in the\nKF design by the the Gaussian noise term of the WSS (see Appendix A.1).\nFor a vehicle, the four kinematic equations at the wheels are given as,\nVFR cos(\u03b4FR) = x\u02d9v + TF\u03c8\u02d9 (12)\nVFL cos(\u03b4FL) = x\u02d9v \u2212 TF\u03c8\u02d9 (13)\nVRR = x\u02d9v + TR\u03c8\u02d9 (14)\nVRL = x\u02d9v \u2212 TR\u03c8\u02d9 (15)\nUsing the above equations, the longitudinal velocity and the yaw rate at the cg can be determined. However, in order\nto reduce the number of dependent variables and uncertainties, only Eqs (14) and (15) are used for calculation:\nx\u02d9v =\nVRR + VRL\n2\n=\n(\u03c9RR + \u03c9RL)Rw\n2\n(16)\n\u03c8\u02d9 =\nVRR \u2212 VRL\n2TR\n=\n(\u03c9RR \u2212 \u03c9RL)Rw\n2TR\n(17)\nFrom Eqs (16) and (17), while the rotational speeds are measured by the WSS, the radius, Rw, and the vehicle\ntrack distance, 2TR, are predetermined.\n2.1.3. GPS\nTo date, there exists four potential GNSS providers worldwide: the American GPS, the Russian GLObal\u2019naya\nNAvigatsionnaya Sputnikovaya Sistema (GLONASS), the European Galileo, and the Chinese Compass. Currently,\nGPS is the only fully established satellite navigation system. With a minimum of four satellites, a good position for\nthe GPS receiver is achieved. Its velocities are then derived from the Doppler measurements (Grewal et al., 2007). As\nGPS is the most popular and mature GNSS provider, this paper assumes a GPS sensing system.\nUsing the position and velocity measurements from GPS, vehicle dynamic information can be estimated. In order\nto understand this, first consider the planar vehicle model in Figure 1. Assuming that a GPS receiver is located at\nthe cg of a vehicle, its positions (xe, ye) and velocities (x\u02d9e, y\u02d9e) are measured referenced to the e-frame. Using this\ninformation, the tracking angle and the resultant velocity of the vehicle can be determined by using Eqs (6) and (10)\nrespectively.\n2.2. Vehicle Modelling\nApart from using sensors to measure the vehicle dynamics, one can also use a vehicle model. Amongst the many\ndifferent models, the two degrees of freedom (2DoF) model is the simplest vehicle model used for evaluating vehicle\ndynamics. It is based on the bicycle model as shown in Figure 1 and assumes constant longitudinal velocity, x\u02d9v = V ,\n(i.e. zero longitudinal force and zero wheel angular acceleration). Therefore, the 2DoF are the lateral motion and the\nrotation motion, Eqs (18) and (19) respectively. Additionally, applying the small steer angle, resulting in,\nLateral motion:\ny\u00a8v =\n1\nm\n(\n\u2212mx\u02d9v\u03c8\u02d9 + FyF\u03b4F + FyR\n)\n(18)\n4\nRotation about the vertical axis - yaw motion:\n\u03c8\u00a8 =\n1\nJzz\n(\naFyF \u2212 bFyR\n)\n(19)\nThe lateral forces on the axle (i.e. FyF and FyR) are calculated with a tyre model. In the literature, three most common\ntypes are the linear tyre model, the Fiala tyre model (Blundell and Harty, 2004), and the \u2018Magic\u2019 tyre model (Bakker\net al., 1989; Pacejka and Bakker, 1993; Pacejka and Besselink, 1997). For this study, the linear tyre model is used as\nit requires the least number of parameters with no training, thus,\nFyF = CyF\u03b1F (20)\nFyR = CyR\u03b1R (21)\nThe cornering coefficient for a single tyre is normally pre-determined from a tyre rig. The determined value is then\ndoubled to give the axle cornering stiffness (i.e. CyF and CyR) as described in Eqs (20) and (21). This is because the\ntest on the tyre rig only accounts for a single tyre.\nThe slip angles (i.e. \u03b1F and \u03b1R) as shown in Figure 1 are defined as the difference between the sideslip angle and\nthe steering angle at the tyres. Note that the sideslip at the tyres is not the same as that at the cg, \u03b2, due to the difference\nin velocities at the tyres. Therefore, applying the small sideslip assumption, slip at the tyres can be approximated as,\n\u03b1F = \u03b2F \u2212 \u03b4F\n\u2248 y\u02d9v + a\u03c8\u02d9\nx\u02d9v\n\u2212 \u03b4F = \u03b2 + a\u03c8\u02d9x\u02d9v \u2212 \u03b4F (22)\n\u03b1R = \u03b2R\n\u2248 y\u02d9v \u2212 b\u03c8\u02d9\nx\u02d9v\n= \u03b2 \u2212 b\u03c8\u02d9\nx\u02d9v\n(23)\nCombining Eqs (20) to (23), substituting them into the two equations of motion, Eqs (18) and (19), and finally\napproximating y\u00a8v \u2248 \u03b2\u02d9x\u02d9v, the state space representation for the 2DoF linear bicycle model becomes:\n\u23a1\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a3\n\u03b2\u02d9\n\u03c8\u00a8\n\u23a4\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a6 =\n\u23a1\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a3\nCyF+CyR\nmV\naCyF\u2212bCyR\nmV2 \u2212 1\naCyF\u2212bCyR\nJzz\na2CyF\u2212b2CyR\nJzzV\n\u23a4\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a6\n\u23a1\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a3\n\u03b2\n\u03c8\u02d9\n\u23a4\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a6 +\n\u23a1\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a3\n\u2212CyF\nmV\n\u2212aCyF\nJzz\n\u23a4\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a6 \u03b4F\n(24)\nFrom the state-space model in Eq. (24), the input is the tyre steering angle, \u03b4F and the states are the sideslip and\nthe yaw rate,\n[\n\u03b2 \u03c8\u02d9\n]T\n. This model is very popular with automotive manufacturers as it is simple, easy to implement\nand requires relatively few parameters. In practice, the velocity, V , in the equation is normally measured from the\nWSS.\n3. The Kalman Filter Design\nPrior to presenting the proposed design of the IKF, the KF and Extended KF (EKF) are summarised. Details can\nbe found in, for example, Welch and Bishop (2001). The Triple KF, comprising of three KKFs (two linear and one\nnon-linear), is then described. The section finishes with an overview of the MKF and a description of the IKF.\n3.0.1. The Kalman Filter\nGiven the discrete plant model, xk+1 = \u03a6kxk + \u0394kuk, with measurements, zk = Hkxk, and assuming Gaussian\nprocess and measurement noise, \u0393kwk and vk respectively, a Linear KF (LKF) can be applied. In general, the KF is a\n5\ntwo-stage process consisting of the correction and the prediction stages:\nCorrection stage:\nz\u02c6k = Hkx\u02c6k|k\u22121 (25)\nKk = Pk|k\u22121Hk(HkPk|k\u22121HTk + Rk)\n\u22121 (26)\nPk|k = (I \u2212KkHk)Pk|k\u22121 (27)\nx\u02c6k|k = x\u02c6k|k\u22121 +Kk(zk \u2212 z\u02c6k) (28)\nPrediction stage:\nx\u02c6k+1|k = \u03a6kx\u02c6k|k + \u0394kuk (29)\nPk+1|k = \u03a6kPk|k\u03a6Tk + \u0393kQk\u0393\nT\nk (30)\nAt time step k, the inputs to a LKF are the state variables estimated from the previous time step, x\u02c6k|k\u22121, and, the\nprimary and referenced sensor measurements, uk and zk. Firstly, the referenced measurements, z\u02c6k, are predicted using\nthe current estimated state variables, Eq. (25). These predicted reference measurements are then compared with the\nactual measured reference value, zk \u2212 z\u02c6k. Their error is then multiplied by a weighing matrix called the Kalman gain,\nKk, and the old estimated states are updated using Eq. (28). Using the updated state estimations, x\u02c6k|k, and the system\nequations, the states for the next time step, k + 1, are predicted using Eq. (29). At time step k + 1, the estimated states\nfrom Eq. (29) are inserted into Eq. (25) and the process repeats.\nAlthough the LKF is simple to implement, in reality, most systems are non-linear and in such cases, an EKF can\nbe applied. Consider the non-linear discretized system :\nx\u02c6k+1 = x\u02c6k + Tsf(x\u02c6k, uk,wk) (31)\n= f\u02c6(x\u02c6k, uk,wk)\nz\u02c6k = g(x\u02c6k, vk) (32)\nThe EKF is implemented similarly to the LKF, with the following two stages:\nCorrection stage:\nz\u02c6k = g(x\u02c6k|k\u22121, 0) (33)\nKk = Pk|k\u22121Gk(GkPk|k\u22121GTk + Rk)\n\u22121 (34)\nPk|k = (I \u2212KkGk)Pk|k\u22121 (35)\nx\u02c6k|k = x\u02c6k|k\u22121 +Kk(zk \u2212 z\u02c6k) (36)\nPrediction stage:\nx\u02c6k+1|k = f\u02c6(x\u02c6k|k, uk, 0) (37)\nPk+1|k = FkPk|kFTk + \u0393kQk\u0393\nT\nk (38)\nwhere matrices, F and G, are the partial derivatives (Jacobian matrices) of the process and measurement functions, f\u02c6\nand g respectively:\nF[i][ j] =\n\u03b4f\u02c6[i]\n\u03b4x[ j]\n(x\u02c6k, uk, 0) (39)\nG[i][ j] =\n\u03b4g[i]\n\u03b4x[ j]\n(x\u02c6k, 0) (40)\n3.1. The Triple Kalman Filter\nFrom the literature, the most simple and straight forward GPS\/INS KF design is the dual KF (comprising two\nKKF which estimates the heading angle and the vehicle velocities) set up given by Bevly et al. (2000, 2001), and Ryu\net al. (2002). With an additional KF utilising the WSS, the dual KF is modified to form the Triple KF design.\n6\n3.1.1. The Yaw Kalman Filter, yawKKF\nThe dual KF approach is suitable for car manufacturers as it is not dependent on vehicle parameters, such as mass,\ninertia and tyre coefficients. The yawKKF consists of a state vector of two states: heading angle, \u03c8, and yaw rate gyro\nbias, br. The measurement for the yawKKF is taken from the GPS tracking angle only, \u03bd, and is related to the heading\nonly when the vehicle is travelling on a straight road: \u03bd = \u03c8. This is because vehicles generate a sideslip angle only\nduring cornering, making the tracking angle equal to the sum of the heading and sideslip angles: \u03bd = \u03c8+\u03b2. Therefore,\nthe measurement for this KKF switches on and off depending on two circumstances:\n1. the presence of GPS signals, and\n2. whether the vehicle is traveling straight or not.\nThe presence of GPS signals is often detected by a GPS tag sent from the receiver and the determination of vehicle\ncornering can be determined from the yaw rate gyro or the steering wheel sensor. We propose using the former as rate\ngyro bias can be estimated using a simple yawKKF.\nAfter the states are estimated from the yawKKF, the yaw rate measurements are corrected (rm \u2212 b\u02c6r) and the\nestimated heading angle is combined with the GPS tracking angle and velocity to produce the longitudinal and lateral\nvelocities in the v-frame as reference measurements for the velKKF:\nx\u02d9re fv = Vgps cos(\u03bdgps \u2212 \u03c8\u02c6) (41)\ny\u02d9re fv = Vgps sin(\u03bdgps \u2212 \u03c8\u02c6). (42)\nUsing these reference measurements, the velKKF predicts the longitudinal and lateral velocities in b-frame as well as\nthe biases in the corresponding accelerometers. A summary for the yawKKF is presented below:[\n\u03c8\nbr\n]\nk+1\n=\n[\n1 \u2212Ts\n0 1\n] [\n\u03c8\u02c6\nb\u02c6r\n]\nk\n+\n[\nTs\n0\n] [\nrm\n]\nk\n(43)\n[\n\u03bd\n]\nk\n= Hyaw\n[\n\u03c8\u02c6\nb\u02c6r\n]\nk\n(44)\nwhere Hyaw is\n[\n1 0\n]\nwhen the GPS is available travelling on a straight road, or\n[\n0 0\n]\nwhen either GPS is off or the\nvehicle is turning.\nIn order to \u2018correctly\u2019 determine the sideslip angle, the GPS tracking angle must be properly synchronised with\nthe heading estimate from the yawKKF in the same numerical range. To do this, the two angles are converted to\nthe trigonometric numerical range before making comparison. Hence the measurement expression in Eq. (44) is no\nlonger a direct comparison with the GPS tracking angle, i.e. \u03bdk = \u03c8\u02c6k, but a non-linear trigonometric relationship,[\ncos \u03bd\nsin \u03bd\n]\nk\n=\n[\ncos \u03c8\u02c6\nsin \u03c8\u02c6\n]\nk\n.\nThis change causes the simple measurement matrix, Hyaw, to be replaced by a non-linear Jacobian matrix, Gyaw, in\nthe KF formulation:\nGyawi, j =\n[\n\u2202zi\n\u2202x j\n]i, j=1,2\n=\n[\u2212 sin \u03c8\u02c6k 0\ncos \u03c8\u02c6k 0\n]\n. (45)\nIn the absence of GPS signals, the measurement matrix, Gyaw, becomes zero.\n3.1.2. The WSS Kalman Filter, wssEKF\nIn Section 2.1, it shows that WSS measurements can be used for estimating the longitudinal velocity, x\u02d9v, and the\nyaw rate, \u03c8\u02d9 (see Eqs (16) and (17)). However, due to errors in the wheel rotational speed and tyre radius, the WSS\nmeasurements are not accurate enough to be used, hence a KF is utilised, i.e. wssEKF.\nThe purpose of the wssEKF in the Triple KF design is to predict the tyre radius bias and therefore the longitudinal\nvelocity. This is because the predicted longitudinal velocity is more accurate with less noise from wssEKF when com-\npared with the dual KF design in Leung et al. (2008), see Figure 2. To construct the wssEKF, the WSS formulations\n7\n20 40 60 80 100 120 140 160 1809.6\n9.65\n9.7\n9.75\n9.8\n9.85\ntime, s.\nlo\nng\nitu\ndi\nna\nl v\nel\noc\nity\n, m\n\/s\n \n \n20 40 60 80 100 120 140 160 180\n\u00020.1\n\u00020.05\n0\n0.05\n0.1\n0.15\ntime, s.\ner\nro\nr,\n m\n\/s\nwssEKF\nCM true data\nvelKKFdual KF\nFigure 2: Comparison of longitudinal state estimation from wssEKF and dual KF, with actual longitudinal velocity\nfrom CarMaker (labelled CM true data) in DoubleOval 25kph\nin Eqs (16) and (17) are first discretised to,\nxk+1v = x\nk\nv + Ts\n(\n1\n2\n(\u03c9RR + \u03c9RL)(Rw + bw)\n)\n(46)\n\u03c8k+1 = \u03c8k + Ts\n(\n1\n2TR\n(\u03c9RR \u2212 \u03c9RL)(Rw + bw)\n)\n(47)\nUsing Eq. (47) only, the wssEKF is constructed with a process matrix of,[\n\u03c8\nbw\n]\nk+1\n=\n[\n1 Ts2TR (\u03c9RR \u2212 \u03c9RL)\n0 1\n] [\n\u03c8\nbw\n]\nk\n+\n[ Ts\n2TR\n(\u03c9RR \u2212 \u03c9RL)\n0\n]\nRw.\nWith the measurements from the GPS (\u03bd) and yawKKF (\u03c8\u02c6yawKKF), the measurement matrix of wssEKF is varied\naccording to three conditions, \u23a1\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a3\ncos(\u03bdgps)\nsin(\u03bdgps)\nbw|gps\ncos(\u03c8\u02c6yawKKF)\nsin(\u03c8\u02c6yawKKF)\n\u23a4\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a6\nk\n= gwss (\u03c8, bw)k (48)\n1. Corners (when corrected \u03c8\u02d9 > 2\u25e6 \/s):\nGwss =\n\u2202gwss\n\u2202xk\n=\n[\n0 0 0 0 0\n0 0 0 \u2212 sin(\u03c8) cos(\u03c8)\n]T\nk\n(49)\n8\n2. Straight road and GPS is \u2018ON\u2019:\nGwss =\n\u2202gwss\n\u2202xk\n=\n[\n0 0 1 0 0\n\u2212 sin(\u03c8) cos(\u03c8) 0 0 0\n]T\nk\n(50)\n3. Straight road and GPS is \u2018OFF\u2019:\nGwss =\n\u2202gwss\n\u2202xk\n=\n[\n0 0 1 0 0\n0 0 0 0 0\n]T\nk\n(51)\nNotice that the wheel bias is also measured by the GPS, by assuming the wheel velocity is the same as the GPS speed\non a straight road, therefore,\nx\u02d9v|straight \u2248 Vgps = (\u03c9RR + \u03c9RL)(Rw + bw)2\nbw =\n2Vgps\n\u03c9RR + \u03c9RL\n\u2212 Rw = bw|gps. (52)\nOnce the bias of the WSS is determined, the longitudinal velocity is determined by,\nxwssEKFv =\n(\n1\n2\n(\u03c9RR + \u03c9RL)(Rw + bw)\n)\n(53)\n3.1.3. The Velocity Kalman Filter, velKKF\nWith the yaw rate bias and longitudinal velocity estimated from the yawKKF and the wssEKF respectively, they\nare used in the velKKF along with the GPS measurements to produce an improved estimation for the velocities, the\naccelerometer biases, bx and by, and also the error caused by the pitching motion, bd. As a result, Eqs (1) and (2) are\nmodified to:\nAx = x\u00a8v \u2212 y\u02d9vrm + bx + bd (54)\nAy = y\u00a8v + x\u02d9vrm + by (55)\nwhich correspond to a state space representation of:\u23a1\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a3\nx\u02d9v\nbx\ny\u02d9v\nby\nbd\n\u23a4\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a6\n=\n\u23a1\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a3\n0 \u22121 (rm \u2212 b\u02c6r) 0 \u22121\n0 0 0 0 0\n\u2212(rm \u2212 b\u02c6r) 0 0 \u22121 0\n0 0 0 0 0\n0 0 0 0 0\n\u23a4\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a6\n\u23a1\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a3\nx\u02d9v\nbx\ny\u02d9v\nby\nbd\n\u23a4\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a6\n+\n\u23a1\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a3\n1 0\n0 0\n0 1\n0 0\n0 0\n\u23a4\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a6\n[\nAx\nAy\n]\nk\n(56)\n\u23a1\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a3\nx\u02d9re fv\ny\u02d9re fv\nzre f3\n\u23a4\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a6 =\n\u23a1\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a3\n1 0 0 0 0\n0 0 1 0 0\n(hvel,3)1\u00d75\n\u23a4\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a6\n\u23a1\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a3\nx\u02d9v\nbx\ny\u02d9v\nby\nbd\n\u23a4\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a6\nk\n(57)\nwhere x\u02d9re fv and y\u02d9\nre f\nv are determined from Eqs (41) and (42) using the estimated heading angle from the yawKKF and\nthe GPS tracking angle.\nWhen GPS is unavailable, it is recommended in Leung et al. (2009b) that the measurement matrix must remain\n\u2018ON\u2019 instead of turning the matrix into zeros. The measurement covariance for the velKKF, Rvel, is thus set to a large\nvalue (as listed in Appendix A.2), reducing the effect of the measurements on the estimated states. In addition, during\nGPS outages, longitudinal velocity estimation from wssEKF is used as a continual source of measurement for the\nvelKKF.\nThe pitching acceleration error, bd, can be estimated by assuming it to be zero on the straight road and equal to the\ndifference between the GPS velocity (Eq. (41)) and the WSS velocity (Eq. (53)) over one GPS sample period (Tgpss )\non the curve:\n9\n1. Straight: \u23a7\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23a8\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23a9\nbd = 0\nzre f3 = x\u02d9\nwssEKF\nv\nhvel,3 =\n[\n1 0 0 0 0\n] (58)\n2. Curve and when GPS is available: \u23a7\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23a8\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23a9\nbd =\n1\nTgpss\n(\nx\u02d9re fv \u2212 x\u02d9wssEKFv\n)\nzre f3 = x\u02d9\nre f\nv \u2212 x\u02d9wssEKFv\nhvel,3 =\n[\n0 0 0 0 Tgpss\n] (59)\n3. Curve and when GPS is not available:\u23a7\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23a8\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23aa\u23a9\nbd =\n1\nTgpss\n[\nx\u02d9v \u2212 x\u02d9wssEKFv\n]\nzre f3 = x\u02d9\nwssEKF\nv\nhvel,3 =\n[\n1 0 0 0 \u2212Tgpss\n] (60)\n3.2. The Integrated Kalman Filter, IKF\nGPS track angle  \n(straights)\nyawKKF\ndr\nbrest\nyawest\nGPS\nINS\ndrest\n[dxest; bx\nest; dyest; by\nest; bd\nest]\nE2V\nconversionGPS velocity\n[dx; dy]\nvelKKF[A\nx\n; A\ny\n]\nTripleKF\nwssEKF\ndxest\nWSS\n[WRR; WRL]\nMEKF\nsteer \nangle\n br\nest\nbeta\ndyawest\nyawest\nbdelta\nest\nIKF\ndxest\nyawest\nFigure 3: Schematic diagram for the Triple KF and the IKF design\nThe IKF design combines an MEKF with the Triple KF described in Section 3.1, see Figure 3. In the Triple\nKF, while the yawKKF provides a good continual heading angle estimation, the wssEKF gives a good estimation for\nthe longitudinal velocity. Together, the two KFs allow a continuous estimation of vehicle velocities in the velKKF\nregardless of the GPS outages. This longitudinal velocity estimation from the velKKF and the corrected yaw rate from\nthe yawKKF are then fed into the MEKF to estimate the vehicle dynamic states.\n10\n3.2.1. The Model-based Kalman Filter\nThe MEKF design is based on the 2DoF linear bicycle model, Eq. (24). As state estimations using the vehicle\nmodel are sensitive to the steering input, it is essential to ensure that the steering input is correct with the bias, b\u03b4,\ncompensated. To achieve this, b\u03b4 is added onto the state vector. Furthermore, the MEKF is also accommodated with\nthe ability to estimate the bias from the yaw rate gyroscope. The state space representation for the MEKF is thus,\n\u23a1\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a3\n\u03b2\u02d9\n\u03c8\u00a8\n\u03c8\u02d9\nb\u02d9r\nb\u02d9\u03b4\n\u23a4\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a6\n=\n\u23a1\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a3\nCyF+CyR\nmV\naCyF\u2212bCyR\nmV2 \u2212 1 0 0\n\u2212CyF\nmV\naCyF\u2212bCyR\nJz\na2CyF+b2CyR\nJzV\n0 0 \u2212aCyFJz\n0 1 0 0 0\n0 0 0 0 0\n0 0 0 0 0\n\u23a4\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a6\n\u23a1\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a3\n\u03b2\u02c6\n\u02c6\u02d9\u03c8\n\u03c8\u02c6\nb\u02c6r\nb\u02c6\u03b4\n\u23a4\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a6\n+\n\u23a1\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a2\u23a3\n\u2212CyF\nmV\n\u2212aCyF\nJz\n0\n0\n0\n\u23a4\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a5\u23a6\n\u03b4F . (61)\nIn dependent on the availability of GPS signal, the MEKF is updated with the measurements from the yaw rate\ngyroscope, rm, and the GPS tracking angle, \u03bd, such that,\u23a7\u23aa\u23aa\u23aa\u23aa\u23aa\u23a8\u23aa\u23aa\u23aa\u23aa\u23aa\u23a9\nrm = \u02c6\u02d9\u03c8 + b\u02c6r\ncos \u03bd = cos(\u03c8\u02c6 + \u03b2\u02c6)\nsin \u03bd = sin(\u03c8\u02c6 + \u03b2\u02c6)\n(62)\nIn addition, due to the inaccuracy of estimating the steer bias in the MEKF during vehicle cornering (rm > 2\u25e6 \/s), a\n10 seconds equal weighted moving average window is applied on the steer bias to supply the MEKF with a smooth\nbias prediction.\n4. The Simulation\nProposed design is tested by simulations carried out in MATLAB\/Simulink. GPS, INS and vehicle models are\nbuilt in Simulink and the KF designs are written in MATLAB code. The inputs of the simulations are gathered from\na commercial simulation programme called IPG CarMaker. Noise and disturbances are added onto the inputs before\nprocessing through the sensor models and KF designs. The estimated results are then compared with the measurements\nfrom CarMaker, and errors are calculated as Eqs (63) and (64).\n4.1. Vehicle and Sensor parameters\nThe vehicle parameters are based on a Jaguar Saloon. Data for this vehicle can be found in Appendix B. Because\nthis study is concerned about the performance of using low-cost sensors, the INS and GPS is thus operated at a\nsampling frequency of 100Hz and 1Hz respectively.\nIn the simulation, it is assumed that sensors are located at the cg of the vehicle. Sensor noise is assumed as white\nwith a constant bias (as specified in Appendix A). These errors are added to the corresponding INS measurements\nand passed through a CAN-bus simulator, before being used in the KF designs. As the GPS is an add-on device, its\nmeasurements are fed into the KFs directly without going through the CAN-bus.\n4.2. The Tracks\nIn this study, two different tracks are used for simulations. They are described as follows,\n1. the DoubleOval \u2013 two oval shaped tracks, one turning left and the other one turning right;\n2. the LaneChangeISO \u2013 a double lane change, which turns right and then left again.\n11\n4.3. Error calculations\nTo compare the estimations of the different KF designs and their effectiveness on various roads and manoeuvres,\nthe error of the estimated states are determined with the reference measurement from CarMaker. This error is derived\nusing the Root Mean Squared Deviation (RMSD) or the Normalised RMSD (NRMSD), which describes the amount\nof deviation of the estimated states (Xesti ) from the true value (X\nt\ni ), given by the following relationship:\n%RMSD =\n\u221a\u221a\u221a N\u2211\ni=1\n(Xesti \u2212 Xti )2\nN\n\u00d7 100% (63)\n%NRMSD =\n%RMSD\n(Xtmax \u2212 Xtmin)\n(64)\nwhere N is the total number of data points, Xtmax is the maximum of the true data set, and X\nt\nmin is the minimum of the\ntrue data set.\nThe NRMSD is a useful error measuring tool for any time-varying dynamic state, i.e. the yaw rate, the lateral\nvelocity and the sideslip, while the RMSD is suitable for any states which are assumed as near constant, such as the\nvehicle speed and the bias of the sensors.\n5. Results and Discussion\nWith the 2 simulated tracks (DoubleOval and LaneChangeISO), 10 manoeuvres are carried out with speed varying\nfrom 15kph to 55kph. These speeds are chosen so the tyre dynamics remain in the linear region. For each manoeuvre,\n10 simulations are performed and an average error is determined. The bias estimation ability of the IKF is first\ndiscussed, and then the performance of vehicle dynamic state estimations.\n5.1. Bias Estimation\nTable 1: Bias estimation errors (%RMSD) for the IKF and DKF\nyawKKF velKKF wssEKF MEKF\nIKF DKF IKF DKF IKF DKF IKF IKF\nEstimated bias states: b\u02c6r b\u02c6r b\u02c6x b\u02c6x b\u02c6y b\u02c6y b\u02c6w b\u02c6\u03b4\nm\nan\noe\nuv\nre\nDoubleOval 15kph 0.04 0.08 13.14 13.96 0.21 0.22 0.34 0.08\nDoubleOval 25kph 0.06 0.08 13.15 15.18 0.38 0.16 0.37 0.06\nDoubleOval 35kph 0.09 0.08 13.21 17.35 0.40 0.41 0.31 0.05\nDoubleOval 45kph 0.05 0.09 13.85 20.03 0.79 0.57 0.08 0.05\nDoubleOval 55kph 0.08 0.09 13.68 23.22 1.29 1.08 0.24 0.07\nLaneChangeISO 15kph 0.09 0.09 2.31 0.49 0.14 0.44 0.25 0.13\nLaneChangeISO 25kph 0.08 0.10 2.69 3.24 0.58 0.46 0.31 0.08\nLaneChangeISO 35kph 0.16 0.23 12.81 23.55 0.91 1.07 0.20 0.08\nLaneChangeISO 45kph 0.18 0.16 12.65 30.46 1.27 1.48 0.32 0.07\nLaneChangeISO 55kph 0.25 0.21 12.74 39.09 2.19 2.06 0.38 0.07\nTable 1 shows the bias estimation errors for the IKF and the DKF designs. Inspecting the bias estimations of the\nIKF, it is clear that all bias are well estimated with a %RMSD below 1%, except the longitudinal accelerometer bias,\nbx. The inability of predicting bx accurately is due to the constant velocity (i.e. negligible acceleration) manoeuvre in\nthe simulations.\nFor the DKF design, the bias estimations are very similar to those from the IKF with no significant difference\napart from the longitudinal accelerometer bias. This difference is due to the longitudinal measurements in the KF\ndesigns. Recall that longitudinal estimation in the DKF uses measurements from the GPS, while that in the IKF\nuses longitudinal estimations from the wssEKF. The precise wheel bias, bw, estimation from the wssEKF allows the\nlongitudinal velocity to be predicted more accurately in the IKF overall.\n12\nTable 2: State estimation error of Triple KF, IKF and Solo MEKF, %NRMSD\nsideslip, \u03b2\u02c6 yaw rate, \u02c6\u02d9\u03c8\nManoeuvre Triple KF IKF Solo MEKF Triple KF IKF Solo MEKF\nDoubleOval 15kph 6.8045 0.4174 0.6062 0.7560 0.4377 0.8362\nDoubleOval 25kph 5.2610 0.3232 0.8253 0.4946 0.3555 0.5631\nDoubleOval 35kph 6.9596 0.5600 1.2146 0.3849 0.3683 0.3609\nDoubleOval 45kph 15.1912 4.0282 3.5376 0.3259 0.3511 0.2580\nDoubleOval 55kph 12.7709 12.8077 10.1776 0.2911 0.7194 0.7895\nLaneChangeISO 15kph 21.0481 1.8495 2.3481 2.6157 1.8660 2.1964\nLaneChangeISO 25kph 17.8751 1.4995 2.3685 2.109 1.4815 2.0595\nLaneChangeISO 35kph 17.2353 1.4223 1.9844 1.7858 1.2260 1.6298\nLaneChangeISO 45kph 24.3931 2.2926 2.7409 1.5617 1.0856 1.4280\nLaneChangeISO 55kph 69.7912 9.2321 9.8130 1.4422 0.99748 1.2488\n5.2. Sideslip and Yaw Rate estimation\nFigure 4 shows the longitudinal velocity inputs of the MEKF working alone (Solo MEKF) and the MEKF of\nthe IKF. The Solo MEKF uses the longitudinal velocity determined from the WSS as inputs, while the IKF MEKF\nuses longitudinal velocity estimations from the velKKF. Comparing the two velocities, it is clear that the IKF MEKF\nhas a better longitudinal velocity input. The benefit of the accurate longitudinal velocity determination is shown in\nTable 2, in which both sideslip and yaw rate estimations are more accurate when the linear cornering coefficients are\napplicable to the 2DoF bicycle model (i.e. DoubleOval 15kph to DoubleOval 35kph and LaneChangeISO 15kph to\nLaneChangeISO 55kph). For manoeuvres which do not have a linear lateral tyre force to slip behaviour, Table\nMEKF in IKF\nSolo MEKF\nActual value\nFigure 4: Longitudinal velocity inputs to the Solo MEKF and the MEKF in IKF in the DoubleOval 35kph manoeuvre\n2 shows that the state estimations are more accurate with the Solo MEKF. This result is due to the compensation\nbetween parametric errors and state estimation errors.\nReferring to the yaw rate estimation in the Triple KF and the Solo MEKF, Table 2, we can see that the Triple\nKF is able to provide an accurate heading and longitudinal velocity while the Solo MEKF is good at estimating fast\ndynamic change of the vehicle (i.e. relatively low %NRMSD for the LaneChangeISO manoeuvres). By utilising these\nadvantages from the two approaches, the IKF gives the most accurate state estimations when the linear 2DoF bicycle\nmodel is valid.\nFigures 5 to 6 shows the errors of the sideslip and heading estimations of different estimation approaches, namely\nthe IKF, the Solo MEKF, the Triple KF and the original linear 2DoF bicycle model. Results for the two manoeuvres\nwith valid linear 2DoF vehicle model, i.e. DoubleOval 35kph and LaneChangeISO 35kph are presented here.\n13\nSolo MEKF\nTriple KF\nIKF\n2DoF\n(a) Error in sideslip angle estimations\nSolo MEKF\nTriple KF\nIKF\n2DoF\n(b) Error in heading angle estimations\nFigure 5: State estimation errors of DoubleOval 35kph manoeuvre with different estimation approaches\nFigure 5 shows the state estimation errors from when the vehicle is travelling on the DoubleOval 35kph manoeu-\nvre. For the sideslip estimation, Figure 5a reveals that the Triple KF provides a noisy estimation, which is due to the\ninaccuracy of lateral velocity estimation in the velKKF. On the other hand, approaches based on the vehicle model are\nable to give more stable estimations. However, without any error feedback and bias estimation algorithm, the 2DoF\nvehicle model estimates the sideslip with an offset. When KF is introduced into the 2DoF model, i.e. the Solo MEKF,\nthe offset is compensated but during corners, sideslip errors increase. Notice that the sideslip estimation of the Solo\nMEKF and the 2DoF model are almost the same but with an offset. For the third and fourth corners, where the vehicle\nis turning right, the offset error of the 2DoF model has become beneficial to the sideslip estimation. This 2DoF result\nis only good for this particular simulation and cannot be used as a general explanation for all vehicle systems. The\nmost accurate sideslip estimation is produced by combining the Triple KF with the Solo MEKF, i.e. IKF. Whether\nthe vehicle is travelling straight or cornering, the sideslip is predicted accurately with small overshoots just before the\nvehicle exits the corner.\nFor the heading estimations, Figure 5b shows that the 2DoF vehicle model has increasing errors due to the biases\nfrom the yaw rate gyroscope and steering wheel. Even with the bias predicted, Figure 5b shows that the Solo MEKF is\nnot able to track the heading of the vehicle accurately, but bounds the errors. As the Triple KF manages to predict the\nyaw rate and heading accurately, when utilising these estimations in the IKF, the heading estimations are as accurate as\nthose predicted from the Triple KF. In fact, from the zoom-in region of the graph, it can be seen that the IKF provides\n14\nSolo MEKF\nTriple KF\nIKF\n2DoF\n(a) Error in sideslip angle estimations\nSolo MEKF\nTriple KF\nIKF\n2DoF\n(b) Error in heading angle estimations\nFigure 6: State estimation errors of LaneChangeISO 35kph manoeuvre with different estimation approaches\nsmoother heading estimations than the Triple KF.\nFor fast dynamic manoeuvres such as the LaneChangeISO 35kph, Figure 6a shows that the sideslip estimation\nis not accurately predicted when solely using the Triple KF. Similar to the DoubleOval 35kph, the model-based\napproaches are more accurate, especially for the Solo MEKF and IKF, in which the biases are estimated. Unlike the\nDoubleOval 35kph, the fast cornering dynamic of the vehicle in the LaneChangeISO manoeuvres does not generate a\nlarge sideslip angle. Hence, the differences between the sideslip estimations in the Solo MEKF and the IKF are small,\nsee Figure 6a.\nExamining the heading estimations of the four estimation approaches, Figure 6b presents similar findings to those\nin the DoubleOval 35kph. While the 2DoF vehicle model fails to track the heading of the vehicle, the Solo MEKF\ncorrects slowly. Moreover, the results show that approaches utilising the Triple KF, i.e. the Triple KF itself and\nthe IKF, give better heading estimations. This is because of the corrected yaw rate from the yawKKF and the more\naccurate longitudinal velocity determination from wssEKF.\n6. Conclusion\nIn this paper, an IKF is proposed to estimate the vehicle dynamics using low-cost GPS and INS. The IKF is\ncomposed of 4 KFs: yawKKF, velKKF, wssEKF, and MEKF. The yawKKF estimates the heading angle and yaw rate\ngyroscopic bias with the aid of GPS. These are then fed into thewssEKF with GPS velocities to estimate the tyre radius\n15\nbias and longitudinal velocity. With the corrected yaw rate measurement and a continuous source of longitudinal\nvelocity, the velKKF improves the longitudinal velocity, and estimates the lateral velocity and accelerometer biases.\nThese are then utilised in the MEKF (based on a 2DoF linear bicycle model) to estimate the steer bias as well as the\nsideslip and heading angle.\nThe performance of the IKF design is compared with the linear 2DoF bicycle model, the Triple KF and the\nSolo MEKF under 10 different simulated manoeuvres. From the results, it is found that, in general, MEKF is better\nfor sideslip estimations and KKF is better for heading estimations. For fast dynamics, however, KKF suffers from\ncontinuous update and correction. Unless the update rate of reference sensors are increased, KKF is not superior to\nthe MEKF in state estimations. By combining the MEKF and KKF (i.e IKF), the benefits of the two approaches are\nutilised. Results show that as long as the linear cornering coefficients are applicable to the vehicle model, the IKF is\ngood at both sideslip and heading estimations.\nAlthough the IKF is able to estimate the dynamic states of the vehicle for both types of manoeuvres, it is restricted\nto manoeuvres below 55kph. This speed limitation is because of the parameters in the MKF of the IKF design\n(particularly the cornering stiffnesses, Cy[i j]) are determined a priori using the linear tyre slip-force ratio. At a higher\nspeed, the tyre forces do not vary linearly with slip, hence the vehicle dynamic estimations become inaccurate. For\nwork in the future, it is recommended to combine the MEKF design of Wenzel (2005) with the proposed Triple KF, so\nthe tyre force-slip ratio can be monitored continuously in real time. New or existing techniques for cornering stiffness\nestimation should also be investigated to enhance new designs of the IKF.\n16\nNomenclature\n\u0002b variable in the b-frame (vehicle body frame)\n\u0002e variable in the e-frame (ENU frame)\n\u0002\u02c6, \u0002est estimated variable\n\u0002gps,\u0002gps GPS measurements\n\u0002[i j] variable at Front Right (FR), Front Left (FL), Rear Right (RR), Rear Left (RL)\nor variable at Front axle (F), Rear axle (R)\n\u0002k, \u0002k variable at time k\n\u0002k+1, \u0002k+1 variable at time k + 1\n\u0002k+1|k variable at time k + 1, given information at time k\n\u0002max maximum value in data set\n\u0002min minimum value in data set\n\u0002re f reference measurement\n\u0002t true value\n\u0002v, \u0002v variable in the v-frame (vehicle dynamics frame)\n\u0002vel, \u0002velKKF variable of velKKF\n\u0002wss, \u0002wssEKF variable of wssEKF\n\u0002yaw, \u0002yawKKF variable of yawKKF\na distance from centre of gravity to front axle\nb distance from centre of gravity to rear axle\nbd bias due to the pitching motion\nbr bias in the yaw rate gyroscope\nbw bias of the tyre radius\nbw|gps estimated bias of the tyre radius given GPS measurements\nbx bias in the longitudinal accelerometer\nby bias in the lateral accelerometer\nb\u03b4 bias in the steer wheel angle\ncg centre of gravity\nf non-linear function for process matrix\ng non-linear function for measurement matrix\nh component of discrete measurement matrix, H\nm vehicle mass at centre of gravity\nrm yaw rate gyro measurement\nu input vector\nv measurement noise vector\nw input disturbance vector\nx state vector\nx longitudinal displacement\nx\u02d9 longitudinal velocity\nx\u00a8 longitudinal acceleration\ny lateral displacement\ny\u02d9 lateral velocity\ny\u00a8 lateral acceleration\nz measurement vector\nA process matrix\nAx longitudinal accelerometer measurement\n17\nAy lateral accelerometer measurement\nB input matrix\nC measurement matrix\nCy,[i j] lateral tyre cornering stiffness\nFx,[i j] Longitudinal force on tyre\nFy,[i j] Lateral force on tyre\nF Jacobian matrix for f\nG Jacobian matrix for g\nH discrete form of measurement matrix, C\nI identity matrix\nK kalman filter gain matrix\nJ[i j] Second order moment of inertia about lateral axis of wheel\nJzz Second order moment of inertia about vertical axis, Zb\nN number of data points in set, X\nP error covariance matrix\nQ process covariance matrix\nR[i j] wheel radius\nR measurement covariance matrix\nTF half of front track of vehicle\nTR half of rear track of vehicle\nTs sampling time\nV speed of vehicle at centre of gravity\nV[i j] speed at the tyre\nX longitudinal axis\nX Data set\nY lateral axis\n\u03b1[i j] slip angle at tyre\n\u03b2 sideslip angle at the centre of gravity\n\u03b2[i j] sideslip angle at the tyre\n\u03b4[i j] steer angle on the tyres\n\u03bd course angle about centre of gravity\n\u03c9[i j] wheel rotational velocity at each wheel\n\u03c8 Euler yaw angle\n\u0393k discrete form of disturbance matrix\n\u0394k discrete form of input matrix, B\n\u03a6k discrete form of process matrix, A\nAcknowledgement\nThe authors would like to express their gratitude to Jaguar Land Rover and EPSRC for their support on this project.\n18\nAppendix A. Sensor parameters\nAppendix A.1. Inertial Navigation System\nTable A.3: Simulated INS errors\nStandard deviation, \u03c3 Bias\nSensor (100Hz) Value Unit Value Unit\nYaw rate gyroscope rm 1.0 \u00d7 10\u22121 deg\/s. 1.0 deg\/s\nLongitudinal accelerometer x\u00a8b 5.0 \u00d7 10\u22121 m\/s2 1.0 m\/s2\nLateral accelerometer y\u00a8b 5.0 \u00d7 10\u22121 m\/s2 1.0 m\/s2\nSteering wheel sensor \u03b4w 1.0 deg 5.0 deg\nWheel speed sensot \u03c9 4.0 \u00d7 10\u22122 m\/s \u2014 \u2014\nAppendix A.2. Global Positioning System\nTable A.4: GPS errors based on DG-100 without an antenna\nStandard deviation, \u03c3\nGPS (1Hz) Value\nEastings position \u03c3xe 3.0\nNorthings position \u03c3ye 3.0\nLongitudinal velocity \u03c3x\u02d9e 2.5 \u00d7 10\u22122\nLateral velocity \u03c3y\u02d9e 2.5 \u00d7 10\u22122\nResultant velocity \u03c3V\n\u221a(\nx\u02d9e\nV \u03c3x\u02d9e\n)2\n+\n( y\u02d9e\nV \u03c3y\u02d9e\n)2\nTracking angle1 \u03c3\u03bd\n\u221a(\ny\u02d9e\nx\u02d92e\n\u03c3x\u02d9e\n)2\n+\n(\n1\nx\u02d9e\n\u03c3y\u02d9e\n)2\n\u03c3cos \u03bd\n\u221a(\nsin\n( y\u02d9e\nx\u02d9e\n) ( y\u02d9e\nx\u02d92e\n)\n\u03c3x\u02d9e\n)2\n+\n(\nsin\n( y\u02d9e\nx\u02d9e\n) (\n1\nx\u02d9e\n)\n\u03c3y\u02d9e\n)2\n\u03c3sin \u03bd\n\u221a(\ncos\n( y\u02d9e\nx\u02d9e\n) ( y\u02d9e\nx\u02d92e\n)\n\u03c3x\u02d9e\n)2\n+\n(\ncos\n( y\u02d9e\nx\u02d9e\n) (\n1\nx\u02d9e\n)\n\u03c3y\u02d9e\n)2\n1 \u03bd = tan\u22121\n(\ny\u02d9e\nx\u02d9e\n)\n\u2248 y\u02d9ex\u02d9e\n19\nAppendix B. Vehicle Parameters\nTable B.5: Vehicle parameters used for this project\nValue Unit\nDimension\ndistance from front axle to cg (a) 1.360 m\ndistance from rear axle to cg (b) 1.546 m\ncg height 0.554 m\nfront track (TF ) 0.768 m\nrear track (TR) 0.768 m\nMasses and inertia\nsprung mass (ms) 1665.900 kg\nunsprung mass per wheel (mu) 48.080 kg\ntotal mass of vehicle (m) 1858.000 kg\nroll inertia about cg (Jxx) 655.200 kgm2\npitch inertia about cg (Jyy) 3319.000 kgm2\nyaw inertia about cg (Jzz) 3515.000 kgm2\nwheel inertia (Jw) 1.000 kgm2\nSteering\nOn centre rack ratio 17.58\nTyre\nwheel radius 0.329 m\nAerodynamics\naerodynamic coefficient (Cdx) 0.305\nfrontal cross-sectional area (Ax) 2.200 m2\nair density (\u03c1) 1.205 kgm\u22123\n20\nReferences\nAnderson, R., Bevly, D., 2005. Estimation of tire cornering stiffness using GPS to improve model based estimation of vehicle states. In: Proceedings\nof IEEE Intelligent Vehicles Symposium. pp. 801\u2013806.\nBakker, E., Pacejka, H., Lidner, L., 1989. A new tyre model with application in vehicle dynamics studies. In: Proceedings of the 4th Auto\nTechnologies Conference. Monte Carlo, SAE paper 890087.\nBayliss, M., Leung, K.-T., Whidborne, J., Purdy, D., Williams, R., 2006. Four wheel steer controller development utilising a GPS (global positioning\nsatellite) system compensated inertial sensor suite. In: Proceedings of FISITA World Automotive Congress. Yokohama, Japan.\nBest, M., Gordon, T., Dixon, P., 2000. An extended adaptive Kalman filter for real-time state estimation of vehicle handling dynamics. Vehicle\nSystem Dynamics 34, 57\u201375.\nBest, M., Newton, A., Tuplin, S., 2007. The identifying extended Kalman filter: parametric system identification of a vehicle handling model. In:\nProceedings of the Institution of Mechanical Engineers, Part K (Journal of Multi-Body Dynamics). Vol. 221. pp. 87\u201398.\nBevly, D., Gerdes, J., Wilson, C., 2002. The use of GPS based velocity measurements for measurement of sideslip and wheel slip. Vehicle System\nDynamics 38 (2), 127\u201347.\nBevly, D., Gerdes, J., Wilson, C., Zhang, G., 2000. The use of GPS based velocity measurements for improved vehicle state estimation. In:\nProceedings of American Control Conference. Vol. 4. Chicago, USA, pp. 2538\u20132542.\nBevly, D., Sheridan, R., Gerdes, J., 2001. Integrating INS sensors with GPS velocity measurements for continuous estimation of vehicle sideslip\nand tire cornering stiffness. Proceedings of the American Control Conference 1, 25\u201330.\nBlundell, M., Harty, D., 2004. The Multibody Systems Approach to Vehicle Dynamics, 1st Edition. Butterworth-Heinemann.\nCherouat, H., Braci, M., Diop, S., 2005. Vehicle velocity, side slip angles and yaw rate estimation. IEEE International Symposium on Industrial\nElectronics 1, 349\u2013354.\nFarmer, C., 2001. New evidence concerning fatal crashes of passenger vehicles before and after adding antilock braking systems. Accident Analysis\nand Prevention 33, 361\u2013369.\nFarmer, C., Lund, A., Trempel, R., Braver, E., 1997. Fatal crashes of passenger vehicles before and after adding antilock braking. Accident Analysis\nand Prevention 29 (6), 745\u2013757.\nGrewal, M., Weill, L., Andrews, A., 2007. Global Positioning Systems, Inertial Navigation, and Integration. Wilney.\nLawrence, A., 1998. Modern inertia technology, navigation guidance and control. Springer-Verlag.\nLeung, K., Whidborne, J., Purdy, D., Dunoyer, A., 2009a. A review of ground vehicle dynamic state estimations utilising GPS\/INS. Vehicle System\nDynamics.\nLeung, K., Whidborne, J., Purdy, D., Dunoyer, A., Williams, R., 2008. A study on the effect of GPS accuracy on a GPS\/INS Kalman filter. In:\nProceedings of UKACC International Conference on Control. Manchester, UK.\nLeung, K.-T., Whidborne, J., Purdy, D., Dunoyer, A., SAE paper 2009-01-1287 2009b. Ideal vehicle sideslip estimation using consumer grade GPS\nand ins. SAE International.\nManning, W., Crolla, D., 2007. A review of yaw rate and sideslip controllers for passenger vehicles. Transactions of the Institute of Measurement\nand Control 29 (2), 117\u2013135.\nOXTS, 2008. Oxford technical solution.\nURL http:\/\/www.oxts.co.uk\/\nPacejka, H., Bakker, E., 1993. The magic formula tyre model, tyre models for vehicle dynamic analysis. In: Proceedings of the 1st International\nColloquium on Tyre Models for Vehicle Dynamic Analysis. pp. 1\u201318.\nPacejka, H., Besselink, I., 1997. Magic formula tyre model with transient properties. In: Proceedings of the Berlin Tyre Colloquium, Vehicle\nSystem Dynamics Suppliment. Vol. 27. pp. 145\u2013155.\nRock, K., Beiker, S., Laws, S., Gerdes, J., 2005. Validating GPS based measurements for vehicle control. In: 2005 ASME International Mechanical\nEngineering Congress and Exposition, IMECE 2005, Nov 5-11 2005. Vol. 74 DSC. pp. 583\u2013592.\nRyu, J., Rossetter, J., Gerdes, J., 2002. Vehicle sideslip and roll parameter estimation using GPS. In: AVEC 2002 6th International Symposium on\nAdvanced Vehicle Control. Hiroshima, Japan.\nVan Zanten, A., 2002. Evolution of electronic control systems for improving the vehicle dynamic behaviour. In: Proceedings of International\nSymposium on Advanced Vehicle Control. Hiroshima, Japan.\nWelch, G., Bishop, G., 2001. An introduction to the Kalman filter. Tech. rep., University of North Carolina at Chapel Hill.\nWenzel, T., 2005. State and parameter estimation for vehicle dynamic control. Ph.D. thesis, Coventry University.\n21\n"}