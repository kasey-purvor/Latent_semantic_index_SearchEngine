{"doi":"10.1109\/TIT.2004.838106","coreId":"102443","oai":"oai:epubs.surrey.ac.uk:1903","identifiers":["oai:epubs.surrey.ac.uk:1903","10.1109\/TIT.2004.838106"],"title":"On the (2-1) Separating Weight of the Kerdock Code","authors":["Helleseth, Tor","Schaathun, Hans"],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2004-12-01","abstract":"<p>Separating codes find applications in many fields including automata theory and digital fingerprinting. It is known that the Kerdock code of sufficient order is (2, 1)- and (2, 2)-separating, but the separating weight is only known by a lower bound due to Sagalovich. In this correspondence, we prove that the lower bound on the (2, 1)-separating weight is met with equality.<\/p","downloadUrl":"","fullTextIdentifier":null,"pdfHashValue":null,"publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:epubs.surrey.ac.uk:1903<\/identifier><datestamp>\n      2017-10-31T14:03:35Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><setSpec>\n      6469766973696F6E733D656E67616E64706879736963616C736369656E636573:436F6D707574696E67<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/epubs.surrey.ac.uk\/1903\/<\/dc:relation><dc:title>\n        On the (2-1) Separating Weight of the Kerdock Code<\/dc:title><dc:creator>\n        Helleseth, Tor<\/dc:creator><dc:creator>\n        Schaathun, Hans<\/dc:creator><dc:description>\n        <p>Separating codes find applications in many fields including automata theory and digital fingerprinting. It is known that the Kerdock code of sufficient order is (2, 1)- and (2, 2)-separating, but the separating weight is only known by a lower bound due to Sagalovich. In this correspondence, we prove that the lower bound on the (2, 1)-separating weight is met with equality.<\/p><\/dc:description><dc:date>\n        2004-12-01<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/epubs.surrey.ac.uk\/1903\/1\/fulltext.pdf<\/dc:identifier><dc:identifier>\n          Helleseth, Tor and Schaathun, Hans  (2004) On the (2-1) Separating Weight of the Kerdock Code   IEEE Transactions on Information Theory, 50 (12).  pp. 3312-3315.      <\/dc:identifier><dc:relation>\n        10.1109\/TIT.2004.838106<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/epubs.surrey.ac.uk\/1903\/","10.1109\/TIT.2004.838106"],"year":2004,"topics":[],"subject":["Article","PeerReviewed"],"fullText":"3312 IEEE TRANSACTIONS ON INFORMATION THEORY, VOL. 50, NO. 12, DECEMBER 2004\nTABLE VIII\nCLASSIFICATION OF ALL SELF-DUAL CODES OF LENGTH 16 AND RANK 14\nTABLE IX\nCLASSIFICATION OF ALL SELF-DUAL CODES OF LENGTH 16 AND RANK 15\nTABLE X\nCLASSIFICATION OF ALL SELF-DUAL CODES OF LENGTH 16 AND RANK 16\nneeded to classify and study the distance properties of such codes. We\nstudied all cyclic codes of length 8 and classi\ufb01ed the self-dual codes\naccording to their type. We also studied the self-dual codes of length\n16 and classi\ufb01ed them according to their type as well.\nREFERENCES\n[1] V. Tarokh, N. Seshadri, and A. R. Calderbank, \u201cSpace-time codes for\nhigh data rate wireless communication: Performance criterion and con-\nstruction,\u201d IEEE Trans. Inform. Theory, vol. 44, pp. 744\u2013765,Mar. 1998.\n[2] Y. Liu, M. P. Fitz, and O. Y. Takeshiti, \u201cA rank criterion for QAM space-\ntime codes,\u201d IEEE Trans. Inform. Theory, vol. 48, pp. 3062\u20133079, Dec.\n2002.\n[3] H. El Gamal, A. R. Hammons, Jr, Y. Liu, and O. Y. Takeshita, \u201cOn the\ndesign of space-time and space-frequency codes for MIMO frequency-\nselective fading channels,\u201d IEEE Trans. Inform. Theory, vol. 49, pp.\n2277\u20132292, Sept. 2003.\n[4] A. R. Hammons, Jr, P. V. Kumar, A. R. Calderbank, N. J. Sloane, and\nP. Sol\u00e9, \u201cThe \u2013linearity of Kerdock, Preparata, Goethals, and related\ncodes,\u201d IEEE Trans. Inform. Theory, vol. 40, pp. 301\u2013319, Mar. 1994.\n[5] F. J. MacWilliams and N. J. A. Sloane, The Theory of Error-Correcting\nCodes. Amsterdam, The Netherlands: North-Holland, 1977.\n[6] V. Pless, Introduction to the Theory of Error-Correcting Codes, 3rd\ned, ser. Wiley-Interscience Series on Discrete Mathematical Optimiza-\ntion. New York: Wiley, 1998.\n[7] T. Abualrub and R. Oehmke, \u201cOn the generators of cyclic codes,\u201d\nIEEE Trans. Inform. Theory, vol. 49, pp. 2126\u20132133, Sept. 2003.\n[8] , \u201cCyclic codes of length 2 over ,\u201dDiscr. Appl. Math., vol. 3\u20139,\n2003.\n[9] S. T. Dougherty and K. Shiromoto, \u201cMaximum distance codes over rings\nof order 4,\u201d IEEE Trans. Inform. Theory, vol. 47, pp. 400\u2013404, Jan.\n2001.\n[10] A. Bonnecaze, P. Sol\u00e9, C. Bachoc, and B. Mourrain, \u201cType II codes over\n,\u201d IEEE Trans. Inform. Theory, vol. 43, pp. 969\u2013976, May 1997.\n[11] S. T. Dougherty, P. Gaborit, M. Harada, A. Munemasa, and P. Sole,\n\u201cType IV self-dual codes over rings,\u201d IEEE Trans. Inform. Theory, vol.\n45, pp. 2345\u20132360, Nov. 1999.\nOn the -Separating Weight of the Kerdock Code\nTor Helleseth, Fellow, IEEE, and\nHans Georg Schaathun, Member, IEEE\nAbstract\u2014Separating codes \ufb01nd applications in many \ufb01elds including\nautomata theory and digital \ufb01ngerprinting. It is known that the Kerdock\ncode of suf\ufb01cient order is (2 1)- and (2 2)-separating, but the separating\nweight is only known by a lower bound due to Sagalovich. In this corre-\nspondence, we prove that the lower bound on the (2 1)-separating weight\nis met with equality.\nIndex Terms\u2014Fingerprinting, Kerdock code, linear codes over , sep-\narating systems.\nI. INTRODUCTION\nIn recent years there has been an increasing interest in problems of\ndigital \ufb01ngerprinting [2]. When a vendor sells copies of some copy-\nrighted work, each copy may be marked with a unique \ufb01ngerprint. If\nillegal copies subsequently appear, the \ufb01ngerprint enables the vendor\nto trace them back to a legal copy and a guilty buyer. If two or more\nusers collude they can compare their copies. Any differing bit must be\npart of the \ufb01ngerprint, and these detected bits may be changed to pro-\nduce a hybrid copy. A t-collusion-secure \ufb01ngerprinting code enables\nthe vendor to trace at least one pirate when a collusion of at most t\nusers is guilty.\nSeparating codes are used in some constructions of collusion secure\ncodes [1], and for certain constructions [7], the separating weight is an\nimportant parameter.\nConsider three codewords a1, a2, and b in an (n;M; d) code, i.e., a\ncode of length n withM codewords and minimum Hamming distance\nd.We say that a coordinate position i separates fa1; a2g and b if both a1\nand a2 are different from b in this position. A code is (2; 1)-separating\nif any pair of codewords is separated from any other codeword in at\nleast one position. The (2; 1)-separating weight is the greatest number\n\u0012 such that any pair of codewords is separated from any other codeword\nin at least \u0012 coordinates.\nThat \u0012 \u0015 d1\u0000m1=2 holds for any code with minimum distance d1\nand maximum distance m1, is well known [6], [4]. Just observe that\nthe number of positions N separating a1 and a2 from b is given as\nN \u0015\n1\n2\n(d(a1; b) + d(a2; b)\u0000 d(a1; a2)) \u0015\n1\n2\n(2d1 \u0000m1)\nwhere the \ufb01rst bound holds with equality for binary codes. It is evident\nthat \u0012 = d1 \u0000m1=2 if and only if there are three codewords a1, a2, b\nsuch that d(a1; a2) = m1 and d(a1; b) = d(a2; b) = d1.\nThe binary Kerdock code is a nonlinear (2m+1; 22(m+1); 2m \u0000\n2bm=2c) code where m is odd. Due to the all-one and all-zero code-\nwords, the binary Kerdock code cannot itself be (2; 1)-separating.\nHowever, by shortening the code, we obtain a (2m+1 \u0000 1; 22m+1;\n2m \u0000 2bm=2c) binary code. A lower bound on \u0012 for the shortened\nKerdock code is a simple consequence of the bound above due to\nSagalovich [6] and was explicitly stated for the shortened Kerdock\ncode in Krasnopeev and Sagalovich [4].\nTheorem 1 [4]: Let m be odd. The\n(2m+1 \u0000 1; 22m+1; 2m \u0000 2bm=2c)\nManuscript received October 7, 2003; revised August 19, 2004. This work\nwas supported by the Norwegian Research Council and the AURORA program.\nThe authors are with The Selmer Centre, Department of Informatics, Uni-\nversity of Bergen, N-5020 Bergen, Norway (e-mail: tor.helleseth@ii.uib.no;\ngeorg@ii.uib.no).\nCommunicated by C. Carlet, Associate Editor for Coding Theory.\nDigital Object Identi\ufb01er 10.1109\/TIT.2004.838106\n0018-9448\/04$20.00 \u00a9 2004 IEEE\nIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. 50, NO. 12, DECEMBER 2004 3313\nshortened binary Kerdock code has (2; 1)-separating weight\n\u0012 \u0015 maxf0; 2m\u00001 \u0000 3 \u0001 2bm=2c\u00001g:\nThe main result in this correspondence (see Theorem 3) is to prove\nthat this bound on \u0012 is always met with equality, and that it holds for\nthe family of (2m+1\u00001; 22m+1; 2m\u00002bm=2c) binary codes obtained\nby shortening the Gray map of the Kerdock codes over Z4 de\ufb01ned for\nall integersm. Form odd these codes coincide with the codes in The-\norem 1.\nNote that the (2m+1\u0000 1; 22m+1; 2m \u0000 2bm=2c) shortened Kerdock\ncode is a binary three-weight code with weights d1 = 2m \u0000 2bm=2c,\n2m, and m1 = 2m + 2bm=2c. Theorem 3 implies that the shortened\nbinary Kerdock code is (2; 1)-separating if and only ifm \u0015 3, in which\ncase the separating weight is exactly equal to d1 \u0000m1=2.\nSo to prove that the bound on \u0012 in Theorem 1 is met with equality, it\nremains only to prove that the code contains three codewords a1, a2, b\nsuch that d(a1; a2) = m1 and d(a1; b) = d(a2; b) = d1.\nWe present two proofs of our main result. The \ufb01rst proof that we\npresent was suggested to us by an anonymous referee and this proof\nworks directly for the binary Kerdock code de\ufb01ned for odd m. This\nproof is presented in Section II.\nThe second proof is based on the algebraic description of the codes\nover Z4 that de\ufb01ne the binary Kerdock codes via the Gray map. This\nmethod can in principle be applied to other codes with a nice algebraic\nconstruction. In Section III we describe the Kerdock codes over Z4 for\nall integersm and provide the basic results needed in order to give the\nalgebraic proof of the main result of Theorem 3.\nII. SEPARATING WEIGHT OF THE BINARY KERDOCK CODE\nIn this section we present the proof due to the anonymous referee,\nimplying the main result for the binary (2m+1; 22(m+1); 2m\u00002bm=2c)\nKerdock codes for odd m.\nTheorem 2: Let K be the binary (n;M; d) Kerdock code where\nn = 2m+1,M = 22(m+1), d = n\u0000\np\nn\n2\n, andm \u0015 3 is odd. There exist\nat least one pair a1, a2 of codewords with minimal weights (n\u0000pn)=2\nsuch that their distance is (n +\np\nn)=2.\nProof: It is known that the Kerdock code can be described as a\nunion of the \ufb01rst order Reed-Muller code, denoted by R, and n=2\u0000 1\ncosets of R contained in the second order Reed\u2013Muller code of the\nsame length. The cosets correspond to quadratic bent functions and the\nsum of two cosets is also a bent function. It is known that any such coset\n(except the zero coset R) consists of n vectors of minimum weight\n(n\u0000pn)=2 and the same number of vectors of weight (n+pn)=2.\nConsider any two such cosets and de\ufb01ne the subsets L\u000b and L\f of R\nsuch that \u000b + L\u000b and \f + L\f are the subsets of vectors of minimum\nweight (n\u0000pn)=2 in the cosets \u000b+R and \f +R, respectively, and\nlet \u000b and \f have minimum weight, i.e., 0 2 L\u000b and 0 2 L\f .\nConsider any two cosets \u000b + R and \f + R in the Kerdock code.\nThen the coset \u000b + \f + R (which does not necessarily have to be in\nthe Kerdock code) is also known to have n vectors of minimum weight\n(n\u0000pn)=2 and the same number of vectors of weight (n+pn)=2.\nWe will show that there exist two vectors a1 and a2 in the Ker-\ndock code of minimum weight (n\u0000pn)=2 such that their distance is\n(n +\np\nn)=2. If there is no such pair of vectors among a1 2 \u000b + L\u000b\nand a2 2 \f + L\f then a1 + a2 has weight (n \u0000 pn)=2 and hence\nL\u000b + L\f \u001a L\u000b+\f . Since jL\u000bj = jL\fj = jL\u000b+\fj, we have that\nL\u000b = L\f = L\u000b+\f , and therefore L\u000b = L is an additive subgroup,\ni.e., an (m+ 1)-dimensional linear code.\nSince all vectors in the coset \u000b + L have weight (n \u0000 pn)=2, we\ncan obtain a contradiction by computing the sum of the weights of the\nvectors in the coset in two ways, one by computing the sum of the\nweights of the rows and one by computing the sum of the weights of\nthe columns. Since all vectors in the coset have minimum weight and\neach nonzero column of L contributes a weight 2m to the coset, we\nobtain\n2m+1(n\u0000pn)=2 \u0015 2mne\nwhere ne is the number of nonzero columns inL. Hence ne \u0014 n\u0000pn.\nSince L is contained in the \ufb01rst order Reed-Muller code of minimum\ndistance 2m it follows by the Griesmer bound that ne \u0015 2m+1 \u0000 1 =\nn\u0000 1 > n\u0000pn, a contradiction.\nBecause the sum of the Hamming weights\nw(a1) + w(a2) + w(a1 + a2) < 2n\nfor the vectors selected by the theorem above, there is a position where\nboth a1 and a2 are zero. This means that codewords a1, a2 and b = 0\nwith the required properties exist in a shortened code of the Kerdock\ncode. Since the Kerdock code is invariant under a double transitive\ngroup such codewords exist for any shortening of the Kerdock code.\nIt therefore follows that equality holds in Theorem 1.\nIII. KERDOCK CODES OVER Z4\nLet Z4 be the ring of integers modulo 4. In this section, we will\nstudy codes over Z4 and the Gray map that can be used to construct\nbinary codes from codes overZ4. Wewill describe a family of (2m+1\u0000\n1; 22m+1; 2m\u00002bm=2c) binary codes obtained by shortening the Gray\nmap of the Kerdock codes over Z4 de\ufb01ned for all integers m. For m\nodd these codes coincides with the codes in Theorem 1. Further, this\nsection gives basic results needed in order to give the algebraic proof\nof the main result in this correspondence (cf. Theorem 3).\nA linear code over Z4 with block length n is an additive subgroup\nof Zn4 . The Lee weights of the elements 0; 1; 2; 3 of Z4 are 0; 1; 2; 1;\nrespectively. The Lee weight of a vector a 2 Zn4 is de\ufb01ned to be the\nsum of the Lee weights of its components. The Gray map is de\ufb01ned\nsuch that 0; 1; 2; and 3 are mapped into 00; 01; 11; and 10, respectively.\nTheHamming distance between two vectors under theGraymap equals\ntheir Lee distance. In [3], it was shown that ef\ufb01cient nonlinear codes\nsuch as Kerdock, Preparata, etc., can easily be constructed as binary\nimages under the Gray map of linear codes over Z4.\nThe Galois ring R = GR(4;m) is an extension of Z4 of degreem.\nThe ring R is a local ring having a unique maximal ideal M = 2R\nand the quotient ringR=M is isomorphic to F2 where F2 is a \ufb01nite\n\ufb01eld with 2m elements (see [3], [5] for details).\nAs a multiplicative group, the setR\u0003 of units ofR has the following\nstructure:\nR\u0003 \u0018= Z2 \u00001 \u0002 Z2 \u0002 Z2 \u0002 \u0001 \u0001 \u0001 \u0002 Z2\nm times\n:\nLet \f 2 R\u0003 be a generator for the multiplicative cyclic subgroup \u0018=\nZ2 \u00001 contained within R\u0003. Let T = f0; 1; \f; . . . ; \f2 \u00002g. It can\nbe shown that every element z 2 R can be expressed uniquely as\nz = a+ 2b; a; b 2 T :\nIt can be also shown that \u000b = \f (mod 2) is a primitive element in\nF2 . The Frobenius map \u001b from R to R is de\ufb01ned by\n\u001b(z) = a2 + 2b2\nand the trace map from R to Z4 is de\ufb01ned by\nT (z) =\nm\u00001\nj=0\n\u001bj(z):\nUsing the facts that (a+2b)2 = a and T (a) = T (a2), we can show\nthat for all \r, \u000e 2 T , we have that \r + \u000e + 2p\r\u000e 2 T and\nT \r + \u000e + 2 \r\u000e = T [\r + \u000e]2 :\n3314 IEEE TRANSACTIONS ON INFORMATION THEORY, VOL. 50, NO. 12, DECEMBER 2004\nLet c(u; a), where u 2 Z4, a 2 R, be a vector in Zq4 indexed by\nthe elements of T such that c(u; a)x = u+ T (ax) for all x 2 T . The\nKerdock code K over Z4 of length q = 2m is de\ufb01ned by\nK = fc(u; a) j u 2 Z4; a 2 Rg:\nClearly, K has 4m+1 codewords. In this correspondence, the code K\nwill be called the Kerdock code over Z4 for anym.\nThe Lee weight of b 2 Z4 is related to the real part of !b via\nwL(b) = 1\u0000 Re(!b), where ! =\np\u00001. Hence, we have\nwL(c(u; a)) = q \u0000Re !u\nx2T\n!T (ax) : (1)\nTo \ufb01nd the Lee weight distribution of K, it suf\ufb01ces to determine the\ndistribution of the exponential sum\n\u0000(a) =\nx2T\n!T (ax): (2)\nLemma 1: Let q = 2m where m \u0015 3. Let Ai be the number of\ncodewords of Lee weight i. The Lee weight distribution of K is as\nfollows:\ni) If m is odd, then\nAi =\n1; for i = 0 or 2q\n2q(q \u0000 1); for i = q \u0006 q=2\n4q \u0000 2; for i = q.\nii) If m is even, then\nAi =\n1; for i = 0 or 2q\nq(q \u0000 1); for i = q \u0006pq\n2q2 + 2q \u0000 2; for i = q.\nProof: If m is odd, the Lee weight distribution can be found in\n[3]. If m is even, the Lee weight distribution can be determined in a\nsimilar way, so we omit the details.\nFor any nonzero \u000e 2 T , the codeword c(0; 2\u000e) is an extended binary\nm-sequence multiplied by 2 (mod 4), so it has Lee weight q = 2m.\nTo identify the minimum Lee weight vectors of the form c(0; a), it is\nnecessary to analyze the exponential sum \u0000(a) given in (2).\nLemma 2: Let a = \r + 2\u000e with \r, \u000e 2 T and \r 6= 0. Then\n\u0000(\r + 2\u000e) = !\u0000T (\u000e=\r)\u0000(1):\nLemma 3: Let \u000f be the primitive eighth root of unity, given by \u000f =\n(1 + !)=\np\n2. Then we have\n\u0000(1) =\np\n2m\u000fm; ifm is odd\n\u0000p2m\u000fm; ifm is even .\nCombining (1) with Lemma 2 and Lemma 3, we have a closed-form\nexpression for the Lee weight of a Kerdock codeword in terms of the\ncoef\ufb01cients in its trace expansion. That is, for u 2 Z4 and \r, \u000e 2 T ,\nwe have\nwL(c(u; \r + 2\u000e)) =\nq \u0000Re[!u\u0000T (\u000e=\r)\u0000(1)]; \r 6= 0\nq; \r = 0, \u000e 6= 0\nq \u0000Re(q!u); \r = 0, \u000e = 0.\nThese relations are the key to identify vectors with minimum Lee\nweight in the Kerdock code. Note that the codeword c(0; \r + 2\u000e)\nhas the same Lee weight as the codeword c(0; 1 + 2\u000e=\r) for any\n\r 6= 0. The codewords of minimum and maximum values, of the form\nc(0; 1 + 2\u000e), are determined by the values of \u000e as given in Table I.\nConsider the codeword c(u; a), where u 2 Z4, a 2 R. The expo-\nnential sum associated with c(u; a) is the exponential sum \u0000(a) asso-\nciated with c(0; a), multiplied by !u. Hence the effect of u is to rotate\n\u0000(a) by a multiple of \u0019=2.\nWe will show that we can select two nonzero codewords c(0; a) and\nc(0; b) of minimum Lee weight d1 = 2m \u0000 2bm=2c in the Kerdock\nTABLE I\nTHE VALUES OF T (\u000e) WHICH GIVE MINIMUM AND MAXIMUM WEIGHT OF\nc(0; 1 + 2\u000e) FOR THE VARIOUS VALUES OF m\ncode over Z4, such that their difference has the maximum Lee weight\nm1 = 2\nm + 2bm=2c (excluding the all-2 vector of Lee weight 2m+1)\nin the Kerdock code overZ4. From now on, the codeword a is assumed\nto imply the codeword c(0; a).\nLet a = 1 + 2\u000e1 and b = \r + 2\u000e2, be two vectors in the Kerdock\ncode with minimum Lee weight. The difference a\u0000 b is given as\na\u0000 b =1\u0000 \r + 2(\u000e1 + \u000e2)\n= 1 + \r + 2\np\n\r + 2(\u000e1 + \u000e2 + \r +\np\n\r):\nIf we let a and b correspond to a value s giving a minimum Lee\nweight d1 and a\u0000 b to a value t giving maximum weight Leem1 (less\nthan 2m+1), it follows as an important consequence of the following\nlemma that we can \ufb01nd nonzero vectors a and b ofminimumLeeweight\nd1 such that a \u0000 b has maximum Lee weight m1 (less than 2m+1) in\nthe code.\nLemma 4: Supposem \u0015 7. Then, for any s, t 2 Z4, there exist \u000e1,\n\u000e2, \r 2 T such that \r 62 f0; 1g and\nT (\u000e1) = T\n\u000e2\n\r\n= s\nand\nT\n(\u000e1 + \u000e2 + \r +\np\n\r)2\n(1 + \r)2\n= t:\nProof: Consider the three equations\nE0 =T (\u000e1)\u0000 s\nE1 =T\n\u000e2\n\r\n\u0000 s\nE2 =T\n(\u000e1 + \u000e2 + \r +\np\n\r)2\n(1 + \r)2\n\u0000 t:\nWe \ufb01rst select \u000e1 such that T (\u000e1) = s, and then \r such that \r 62 f0; 1g.\nLet N be the number of \u000e2 2 T such that E1 = E2 = 0. Then we\nhave\n\u000e 2T u ;u 2Z\n!u E +u E = 42N:\nWe want to show that N \u0015 1. Setting\nu1E1 + u2E2 = B(\u000e2)\u0000 su1 \u0000 tu2\nwe have\nB(\u000e2) =T u1\n\u000e22\n\r2\n+ u2\n(\u000e1 + \u000e2 + \r +\np\n\r)2\n(1 + \r)2\n=T \u000e22\nu1\n\r2\n+\nu2\n(1 + \r)2\n+ 2\u000e2\nu2(\u000e1 + \r +\np\n\r)\n(1 + \r)2\n+ u2\n(\u000e1 + \r +\np\n\r)2\n(1 + \r)2\n:\nIEEE TRANSACTIONS ON INFORMATION THEORY, VOL. 50, NO. 12, DECEMBER 2004 3315\nSince 2T (uie\u000e) = 2uiT (e\u000e) = 2uiT (e2\u000e2) = 2T (uie2\u000e2) for any\ne 2 R, we have that\nB(\u000e2) =T \u000e\n2\n2\nu1\n\r2\n+\nu2\n(1 + \r)2\n+\n2u2(\u000e1 + \r +\np\n\r)2\n(1 + \r)4\n+ u2\n(\u000e1 + \r +\np\n\r)2\n(1 + \r)2\n=T \u000e22B2 +B0\nwhere\nB2 =\nu1\n\r2\n+\nu2\n(1 + \r)2\n+ 2u2\n(\u000e1 + \r +\np\n\r)2\n(1 + \r)4\nB0 =u2\n(\u000e1 + \r +\np\n\r)2\n(1 + \r)2\n:\nNow we are interested in the cases whereB2 = 0. If we writeB2 in\n2-adic expression, that is, B2 = D0 + 2D1, then B2 = 0 if and only\nif D0 = D1 = 0. Since D0 = B2 mod 2, we have\nD0 =\nu1\n\r2\n+\nu2\n(1 + \r)2\n(mod 2)\n=\nu1 + u1\r\n2 + u2\r\n2\n\r2(1 + \r)2\n(mod 2)\n=\nu1 + (u1 + u2)\r\n2\n\r2(1 + \r)2\n(mod 2):\nSo the only possibility forD0 = 0 is when u1 = u2 = 0 (mod 2). In\nthis case, we get\nB2 =\nu1\n\r2\n+\nu2\n(1 + \r)2\n(mod 4):\nTherefore, since u1 = 2v1 and u2 = 2v2, for some v1, v2 2 f0; 1g,\nwe can repeat this argument and we obtain v1 = v2 = 0 (mod 2).\nHence, we have\nB2 = 0 iff u1 = u2 = 0 (mod 4):\nUnder these conditions we also have that the constant term B0 = 0.\nLet q = 2m, then by grouping u1, u2 into two classes depending on\nwhether the value of B2 is 0 or not, we have\n16N =\nu ;u 2Z \u000e 2T\n!u E +u E\n=\n(u ;u )=(0;0) \u000e 2T\n!T(\u000e B +B )\n+\n(u ;u ) 6=(0;0)\n!\u0000su \u0000tu\n\u000e 2T\n!T(\u000e B +B )\n= q +\n(u ;u )6=(0;0)\n!\u0000su \u0000tu\n\u000e 2T\n!T(\u000e B +B ):\nSinceB2 = 0 only if u1 = u2 = 0 (mod 4), we can use the bound on\nthe exponential sum [5, Theorem 1] (or Lemma 2 and Lemma 3 above).\nSince the inner sum is 0 in the case u1 = u2 = 0 (mod 2), we have\nj16N \u0000 qj \u0014 12pq:\nTherefore, q \u0015 28 guarantees that N > 0.\nIn the case when m is odd this can be slightly improved, by noting\nthat the 12 sums corresponding to (u1; u2) 6= (0; 0) (mod 2) can be\ndivided into six pairs. Each pair correspond to (u1; u2) and its nega-\ntive (\u0000u1;\u0000u2) (mod 4). Since, each pair contributes two complex\nconjugate values to the sum, it follows that whenm is odd, the bound\n12\np\nq can be improved to 6\np\n2q. Hence, for odd m it is suf\ufb01cient to\nrequire q \u0015 27.\nLemma 4 and the discussion before this lemma implies the following\nresult.\nLemma 5: Suppose m \u0015 7. There exists two codewords c(0; a)\nand c(0; b) in the Kerdock code over Z4 of minimum Lee weight\nd1 = 2\nm\u00002bm=2c such that their Lee distance ism1 = 2m+2bm=2c.\nSince the Kerdock code overZ4 is invariant under a double transitive\npermutation group we can assume without loss of generality that the\ncode after the Gray map is shortened in the \ufb01rst position. Our main\nresult is to determine the exact (2; 1)-separating weight of the resulting\nbinary code.\nTheorem 3: Letm be any integer \u0015 3. Then the\n(2m+1 \u0000 1; 22m+1; 2m \u0000 2bm=2c)\nbinary code obtained by shortening the Gray map of the Kerdock code\nover Z4 has (2; 1)-separating weight\n\u0012 = maxf0; 2m\u00001 \u0000 3 \u0001 2bm=2c\u00001g:\nProof: The theorem says that the code is (2; 1)-separating if and\nonly ifm \u0015 3, in which case the separating weight is exactly equal to\nd1 \u0000 m1=2. It is easily veri\ufb01ed that the code is not (2; 1)-separating\nfor m = 1 and m = 2. In the case m = 3 and m = 5 the result\nhas been shown by Krasnopeev and Sagalovich [4] using a computer\nsearch. The cases m = 4 and m = 6 we have settled by a computer\nsearch.\nIt is clear following the remark after Theorem 1 that the result\nfollows if and only if there are three codewords a1, a2, b such that\nd(a1; a2) = m1 and d(a1; b) = d(a2; b) = d1. So to prove the the-\norem, it remains only to prove that such codewords exist form \u0015 7.\nIt follows as a consequence of Lemma 5 above that there are code-\nwords a1 = c(0; a), a2 = c(0; b) and b = 0 with these properties.\nSince all these codewords are zero in position x = 0, the Gray map of\nall these vectors will after shortening in the \ufb01rst position, also belong\nto the shortened binary Kerdock code and have the required properties.\nACKNOWLEDGMENT\nThe authors would like to thank Gerard Cohen for bringing the\nproblem to the authors attention and the referee for valuable comments\nand for suggesting the proof of Theorem 2.\nREFERENCES\n[1] A. Barg, G. R. Blakley, and G. A. Kabatiansky, \u201cDigital \ufb01ngerprinting\ncodes: Problem statements, constructions, identi\ufb01cation of traitors,\u201d\nIEEE Trans. Inform. Theory, vol. 49, pp. 852\u2013865, Apr. 2003.\n[2] D. Boneh and J. Shaw, \u201cCollusion-secure \ufb01ngerprinting for digital data,\u201d\nIEEE Trans. Inform. Theory, vol. 44, pp. 1897\u20131905, Sept. 1998.\n[3] A. R. Hammons Jr, P. V. Kumar, A. R. Calderbank, N. J. A. Sloane, and\nP. Sole, \u201cThe Z4-linearity of Kerdock, Preparata, Goethals, and related\ncodes,\u201d IEEE Trans. Inform. Theory, vol. 40, pp. 301\u2013319, Mar. 1994.\n[4] A. Krasnopeev andY. L. Sagalovich, \u201cTheKerdock codes and separating\nsystems,\u201d in Proc. 8th Int. Workshop on Algebraic and Combinatorial\nCoding Theory, Sept. 2002, pp. 165\u2013167.\n[5] P. V. Kumar, T. Helleseth, and A. R. Calderbank, \u201cAn upper bound for\nWeil exponential sums over Galois rings and applications,\u201d IEEE Trans.\nInform. Theory, vol. 41, pp. 456\u2013468, Mar. 1995.\n[6] Y. L. Sagalovich, \u201cSeparating systems,\u201d Probl. Inform. Transm., vol. 30,\npp. 105\u2013123, 1994.\n[7] H. G. Schaathun, \u201cFighting two pirates,\u201d in Applied Algebra, Algebraic\nAlgorithms and Error-Correcting Codes (Lecture Notes in Computer\nScience). Berlin, Germany: Springer-Verlag, 2003, vol. 2643, pp.\n71\u201378.\n[8] K. Yang, P. V. Kumar, T. Helleseth, and A. G. Shanbhag, \u201cOn the weight\nhierarchy of Kerdock codes overZ4,\u201d IEEE Trans. Inform. Theory, vol.\n42, pp. 1587\u20131593, Sept. 1996.\n"}