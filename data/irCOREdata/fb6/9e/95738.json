{"doi":"10.1287\/mnsc.1120.1515","coreId":"95738","oai":"oai:eprints.lse.ac.uk:27099","identifiers":["oai:eprints.lse.ac.uk:27099","10.1287\/mnsc.1120.1515"],"title":"Combining equity and utilitarianism in a mathematical programming model","authors":["Hooker, J. N.","Williams, H. Paul"],"enrichments":{"references":[{"id":17239762,"title":"A Primer in Social Choice Theory.","authors":[],"date":"2009","doi":"10.1017\/s0266267109990344","raw":"W. Gaertner. A Primer in Social Choice Theory. Oxford University Press, Cambridge, MA, 2009.","cites":null},{"id":17239784,"title":"A principled approach to mixed integer\/linear problem formulation.","authors":[],"date":"2009","doi":"10.1007\/978-0-387-88843-9_5","raw":"J. N. Hooker. A principled approach to mixed integer\/linear problem formulation. In J. W. Chinneck, B. Kristjansson, and M. Saltzman, editors, Operations Research and Cyber-Infrastructure (ICS 2009 Proceedings), pages 79{100. Springer, 2009.","cites":null},{"id":17239808,"title":"A Theory of Justice.","authors":[],"date":"1972","doi":"10.2307\/3327761","raw":"J. Rawls. A Theory of Justice. Oxford University Press, 1972.","cites":null},{"id":17239801,"title":"and Urologic Diseases Information Clearing House,","authors":[],"date":"2010","doi":null,"raw":"National Kidney and Urologic Diseases Information Clearing House, 2010. http:\/\/kidney.niddk.nih.gov\/kudiseases\/pubs\/kustats\/.","cites":null},{"id":17239816,"title":"Center for the Evaluation of Value and Risk","authors":[],"date":"2010","doi":null,"raw":"Tufts Medical Center. CEA Registry. Center for the Evaluation of Value and Risk in Health, Institute for Clinical Research and Health Policy Studies, 2010. https:\/\/research.tufts-nemc.org\/cear\/.","cites":null},{"id":17239818,"title":"Economics of coronary artery bypass grafting.","authors":[],"date":"1985","doi":"10.1136\/bmj.291.6497.736-a","raw":"A. Williams. Economics of coronary artery bypass grafting. British Medical Journal, 291:326{329, 1985.","cites":null},{"id":17239812,"title":"editors. Utilitarianism and Beyond.","authors":[],"date":"1982","doi":"10.1017\/cbo9780511611964","raw":"A. Sen and B. Williams, editors. Utilitarianism and Beyond. Cambridge University Press, 1982. M. S. Stein. Distributive Justice and Disability: Utilitarianism against Egalitarianism.","cites":null},{"id":17239840,"title":"Equity in health. In","authors":[],"date":"2000","doi":"10.1016\/s1574-0064(00)80048-7","raw":"A. Williams and R. Cookson. Equity in health. In A. J. Culyer and J. P. Newhouse, editors, Handbook of Health Economics. Elsevier Science, 2000.","cites":null},{"id":17239844,"title":"Equity in Theory and Practice.","authors":[],"date":"1995","doi":"10.2307\/1061013","raw":"H. P. Young. Equity in Theory and Practice. Princeton University Press, 1995.","cites":null},{"id":17239841,"title":"Equity-eciency trade-os in health technology assessment.","authors":[],"date":"2006","doi":"10.1017\/s026646230605077x","raw":"A. Williams and R. Cookson. Equity-eciency trade-os in health technology assessment. International Journal of Technology Assessment in Health Care, 22:1{9, 2006.","cites":null},{"id":17239757,"title":"Fairness and QALYs.","authors":[],"date":"1988","doi":"10.1017\/s0957042x00003874","raw":"J. Broome. Fairness and QALYs. Philosophy and Medical Welfare, 3:57{73, 1988.","cites":null},{"id":17239797,"title":"Fairness in network optimal ow control: Optimality of product forms.","authors":[],"date":"1991","doi":"10.1109\/26.87140","raw":"R. Mazumdar, L. Mason, and C. Douligeris. Fairness in network optimal ow control: Optimality of product forms. IEEE Transactions on Communications, 39:775{782, 1991.","cites":null},{"id":17239799,"title":"Institute for Health and Clinical Excellence (NICE) Website, National Health Service, United Kingdom,","authors":[],"date":"2010","doi":"10.1093\/acprof:oso\/9780199558612.003.0010","raw":"NHS. National Institute for Health and Clinical Excellence (NICE) Website, National Health Service, United Kingdom, 2010. http:\/\/www.nice.org.uk\/. NKUDIC. Kidney and Urologic Diseases Statistics for the United States.","cites":null},{"id":17239842,"title":"Logic and Integer Programming.","authors":[],"date":"2009","doi":"10.1007\/978-0-387-92280-5_2","raw":"H. P. Williams. Logic and Integer Programming. Springer, Berlin, 2009.","cites":null},{"id":17239814,"title":"Mathematical programming for the ecient allocation of health resources.","authors":[],"date":"1995","doi":null,"raw":"26A. A. Stinnett and A. D. Paltiel. Mathematical programming for the ecient allocation of health resources. Journal of Health, 15:641{653, 1995.","cites":null},{"id":17239798,"title":"Max-min fairness and its applications to routing and loadbalancing in communication networks: A tutorial.","authors":[],"date":"2008","doi":"10.1109\/surv.2008.080403","raw":"D. Nace and M. Pioro. Max-min fairness and its applications to routing and loadbalancing in communication networks: A tutorial. IEEE Communications Surveys & Tutorials, 10:5{17, 2008.","cites":null},{"id":17239754,"title":"Natural Justice.","authors":[],"date":"2005","doi":"10.1093\/acprof:oso\/9780195178111.001.0001","raw":"K. Binmore. Natural Justice. Oxford University Press, 2005.","cites":null},{"id":17239843,"title":"On dividing justly.","authors":[],"date":"1984","doi":"10.1007\/bf00297056","raw":"M. E. Yaari and M. Bar-Hillel. On dividing justly. Social Choice and Welfare, 1:1{24, 1984.","cites":null},{"id":17239802,"title":"On the lexicographic minimax approach to location problems.","authors":[],"date":"1997","doi":"10.1016\/s0377-2217(96)00154-3","raw":"W. Ogryczak. On the lexicographic minimax approach to location problems. European Journal of Operational Research, 100:218{223, 1997.","cites":null},{"id":17239785,"title":"Optimality conditions for distributive justice.","authors":[],"date":"2010","doi":"10.1111\/j.1475-3995.2009.00742.x","raw":"25J. N. Hooker. Optimality conditions for distributive justice. International Transactions in Operational Research, 17:485{505, 2010.","cites":null},{"id":17239796,"title":"Rate control in communication networks: Shadow prices, proportional fairness and stability.","authors":[],"date":"1999","doi":"10.2307\/3010473","raw":"F. P. Kelly, A. K. Maulloo, and D. K. H. Tan. Rate control in communication networks: Shadow prices, proportional fairness and stability. Journal of the Operational Research Society, 49:237{252, 1999. H. Luss. On equitable resource allocation problems: A lexicographic minimax approach.","cites":null},{"id":17239758,"title":"Reading Rawls: Critical Studies on Rawls' \\A Theory of Justice&quot;.","authors":[],"date":"1989","doi":"10.2307\/2184013","raw":"N. Daniels. Reading Rawls: Critical Studies on Rawls' \\A Theory of Justice&quot;. Stanford University Press, 1989.","cites":null},{"id":17239787,"title":"Representability in mixed integer programming, I: Characterization results.","authors":[],"date":"1987","doi":"10.1016\/0166-218x(87)90026-6","raw":"R. G. Jeroslow. Representability in mixed integer programming, I: Characterization results. Discrete Applied Mathematics, 17:223{243, 1987. R. G. Jeroslow. Mixed Integer Formulation, volume 40 of Logic-Based Decision Support.","cites":null},{"id":17239760,"title":"Taking Rights Seriously.","authors":[],"date":"1977","doi":"10.2307\/2218969","raw":"R. Dworkin. Taking Rights Seriously. Harvard University Press, Cambridge, MA, 1977.","cites":null},{"id":17239759,"title":"The measurement of individual utility and social welfare.","authors":[],"date":"1998","doi":"10.1016\/s0167-6296(97)00022-2","raw":"P. Dolan. The measurement of individual utility and social welfare. Journal of Health Economics, 17:39{52, 1998.","cites":null},{"id":17239761,"title":"The quality of life of patients with end-stage renal disease.","authors":[],"date":"1985","doi":"10.1056\/nejm198502283120905","raw":"R. W. Evans, D. L. Manninen, L. P. Garrison, L. G. Hart, C. R. Blagg, R. A. Gutman, A. R. Hill, and E. G. Lowrie. The quality of life of patients with end-stage renal disease. New England Journal of Medicine, 312:553{559, 1985.","cites":null},{"id":17239810,"title":"Theories of Distributive Justice.","authors":[],"date":"1998","doi":"10.2307\/2655683","raw":"J. E. Roemer. Theories of Distributive Justice. Harvard University Press, Cambridge, MA, 1998.","cites":null},{"id":17239763,"title":"Towards equitable distribution via proportional equity constraints.","authors":[],"date":"1993","doi":"10.1007\/bf01581272","raw":"N. G. Hall and R. V. Vohra. Towards equitable distribution via proportional equity constraints. Mathematical Programming, 58:287{294, 1993.","cites":null},{"id":17239756,"title":"Using cost eectiveness information.","authors":[],"date":"2000","doi":null,"raw":"A. Briggs and A. Gray. Using cost eectiveness information. British Medical Journal, 320:246, 2000.","cites":null},{"id":17239755,"title":"Utilitarianism and the theory of justice. In","authors":[],"date":"2002","doi":"10.1016\/s1574-0110(02)80015-7","raw":"C. Blackorby, W. Bossert, and D. Donaldson. Utilitarianism and the theory of justice. In K. Arrow, A. Sen, and K. Suzumura, editors, Handbook of Social Choice and Welfare, Vol. 1, volume 19 of Handbooks in Economics, pages 543{596. Elsevier, Amsterdam, 2002.","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2012-09","abstract":"We discuss the problem of combining the conflicting objectives of equity and utilitarianism, for social policy making, in a single mathematical programming model. The definition of equity we use is the Rawlsian one of maximizing the minimum utility over individuals or classes of individuals. However, when the disparity of utility becomes too great, the objective becomes progressively utilitarian. Such a model is particularly applicable not only to health provision but to other areas as well. Building a mixed-integer\/linear programming (MILP) formulation of the problem raises technical issues, because the objective function is nonconvex and the hypograph is not MILP representable in its initial form. We present a succinct formulation and show that it is \u201csharp\u201d in the sense that its linear programming relaxation describes the convex hull of the feasible set (before extra resource allocation or policy constraints are added). We apply the formulation to a healthcare planning problem and show that instances of realistic size are easily solved by standard MILP software","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/95738.pdf","fullTextIdentifier":"http:\/\/eprints.lse.ac.uk\/27099\/1\/Combining_equity_and_utilitarianism_in_a_mathematical_programming_model_%28LSERO%29.pdf","pdfHashValue":"d6712b2fcc61feb0dae6594dbb23091b4c02ef5c","publisher":"Institute for Operations Research and Management Sciences (INFORMS)","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lse.ac.uk:27099<\/identifier><datestamp>\n      2012-09-20T10:43:30Z<\/datestamp><setSpec>\n      74797065733D43454E54524553:4C53455F52435F4D616E5F536369<\/setSpec><setSpec>\n      74797065733D4445505453:4C53452D4D414E<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/eprints.lse.ac.uk\/27099\/<\/dc:relation><dc:title>\n        Combining equity and utilitarianism in a mathematical programming model<\/dc:title><dc:creator>\n        Hooker, J. N.<\/dc:creator><dc:creator>\n        Williams, H. Paul<\/dc:creator><dc:subject>\n        QA Mathematics<\/dc:subject><dc:description>\n        We discuss the problem of combining the conflicting objectives of equity and utilitarianism, for social policy making, in a single mathematical programming model. The definition of equity we use is the Rawlsian one of maximizing the minimum utility over individuals or classes of individuals. However, when the disparity of utility becomes too great, the objective becomes progressively utilitarian. Such a model is particularly applicable not only to health provision but to other areas as well. Building a mixed-integer\/linear programming (MILP) formulation of the problem raises technical issues, because the objective function is nonconvex and the hypograph is not MILP representable in its initial form. We present a succinct formulation and show that it is \u201csharp\u201d in the sense that its linear programming relaxation describes the convex hull of the feasible set (before extra resource allocation or policy constraints are added). We apply the formulation to a healthcare planning problem and show that instances of realistic size are easily solved by standard MILP software.<\/dc:description><dc:publisher>\n        Institute for Operations Research and Management Sciences (INFORMS)<\/dc:publisher><dc:date>\n        2012-09<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/eprints.lse.ac.uk\/27099\/1\/Combining_equity_and_utilitarianism_in_a_mathematical_programming_model_%28LSERO%29.pdf<\/dc:identifier><dc:identifier>\n          Hooker, J. N. and Williams, H. Paul  (2012) Combining equity and utilitarianism in a mathematical programming model.  Management Science, 58 (9).  pp. 1682-1693.  ISSN 0025-1909     <\/dc:identifier><dc:relation>\n        http:\/\/www.informs.org\/Pubs\/ManSci<\/dc:relation><dc:relation>\n        10.1287\/mnsc.1120.1515<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/eprints.lse.ac.uk\/27099\/","http:\/\/www.informs.org\/Pubs\/ManSci","10.1287\/mnsc.1120.1515"],"year":2012,"topics":["QA Mathematics"],"subject":["Article","PeerReviewed"],"fullText":"  \nJ. N. Hooker and H. P. Williams  \nCombining equity and utilitarianism in a \nmathematical programming model \nArticle (Accepted version) \n(Unrefereed) \n \n \n Original citation: \nHooker, J. N. and Williams, H. Paul Combining equity and utilitarianism in a mathematical \nprogramming model. Management science. ISSN 0025-1909 (In Press) \n\u00a9 2011 INFORMS \n \nThis version available at: http:\/\/eprints.lse.ac.uk\/27099\/ \nAvailable in LSE Research Online: December 2011 \n \nLSE has developed LSE Research Online so that users may access research output of the \nSchool. Copyright \u00a9 and Moral Rights for the papers on this site are retained by the individual \nauthors and\/or other copyright owners. Users may download and\/or print one copy of any \narticle(s) in LSE Research Online to facilitate their private study or for non-commercial research. \nYou may not engage in further distribution of the material or use it for any profit-making activities \nor any commercial gain. You may freely distribute the URL (http:\/\/eprints.lse.ac.uk) of the LSE \nResearch Online website.  \n \nThis document is the author\u2019s final accepted version of the journal article. There may be \ndifferences between this version and the published version.  You are advised to consult the \npublisher\u2019s version if you wish to cite from it. \n \n \n \nCombining Equity and Utilitarianism in a Mathematical\nProgramming Model\nJ. N. Hooker\nCarnegie Mellon University\njohn@hooker.tepper.cmu.edu\nH. P. Williams\nLondon School of Economics\nh.p.williams@lse.ac.uk\nRevised 18 November 2011\nAbstract\nWe discuss the problem of combining the con\ricting objectives of equity and utili-\ntarianism, for social policy making, in a single mathematical programming model. The\nde\fnition of equity we use is the Rawlsian one of maximising the minimum utility over\nindividuals or classes of individuals. However, when the disparity of utility becomes\ntoo great, the objective becomes progressively utilitarian. Such a model is particularly\napplicable to health provision but to other areas as well. Building a mixed integer\/linear\nprogramming (MILP) formulation of the problem raises technical issues, as the objec-\ntive function is nonconvex and the hypograph is not MILP representable in its initial\nform. We present a succinct formulation and show that it is \\sharp\" in the sense that\nits linear programming relaxation describes the convex hull of the feasible set (before\nextra resource allocation or policy constraints are added). We apply the formulation\nto a health care planning problem and show that instances of realistic size are easily\nsolved by standard MILP software.\n1 Introduction\nThe dilemma over whether to pursue policies that emphasize equity (sometimes regarded\nas \\fairness\") or utilitarianism (\\total good\") faces all societies. Such policies are often\nin con\rict and have been addressed by a number of authors, such as Binmore (2005)\nand Sen and Williams (1982). Should we attempt to reduce di\u000berences in wealth at\nthe expense of economic e\u000eciency? Is equity in health provision, for example, more\nimportant than maximising the aggregate health of the population?\nUtilitarianism was advocated by Bentham and Mill in the 18th and 19th centuries;\nthat is, maximising total utility irrespective of di\u000berences between individuals or classes\n1\nof individuals. Equity (egalitarianism) can be formulated in di\u000berent ways. In this\npaper we choose the maximin principle enunciated by Rawls (1972); that is, one seeks\nto allocate goods so as to maximise the welfare of the worst o\u000b. There is evidence\nto suggest that this is considered by the majority of the population to be the most\nacceptable policy to pursue, at least in health matters (Yaari and Bar-Hillel, 1984).\nBut most people regard it as unreasonable to take such a policy to its extreme; that is,\nto continue with such a policy when it takes too many resources from others. There is\nsome indirect evidence for this in Williams and Cookson (2006) and Yaari and Bar-Hillel\n(1984). Hence we switch to a utilitarian objective in extreme circumstances.\nOur discussion is perhaps most obviously relevant to health provision but is also\napplicable to other areas, such as facility location (Ogryczak, 1997), famine relief (Hall\nand Vohra, 1993), taxation (Young, 1995), communication network management (Nace\nand Pioro, 2008), or even to timing tra\u000ec lights, given the incompatibility between\nmaximising tra\u000ec \row and minimising any person's maximum waiting time.\nIn Section 2 we propose a social welfare function, based on a suggestion of Williams\nand Cookson (2000), that combines equity and e\u000eciency in the desired fashion for a\ntwo-person problem. We build a mixed integer\/linear programming (MILP) formulation\nthat maximizes the function subject to resource limitations and other constraints. This\nrequires that some technical issues be addressed, as the function is not only nonconvex,\nbut its hypograph is not MILP representable in its initial form.\nIt is not obvious how to extend the social welfare function to n persons, but we\npropose in Section 4 an extension that appears to capture the underlying idea. We\nprovide a succinct MILP formulation that contains only n binary variables. We prove\nthat despite the simplicity of the model, it is nonetheless \\sharp.\" Jeroslow (1989)\nde\fned an MILP formulation to be sharp if its linear programming (LP) relaxation\ndescribes the (closure of) the convex hull of feasible integer solutions, making it the\n\\best\" possible formulation as a mathematical programme. Our result shows that a\nvery compact formulation of the social welfare function can be sharp as well.\nOf course, this MILP formulation only comprises the \\core\" of a practical model.\nAdditional (problem-speci\fc) constraints must be added to impose resource limitations\nand policy decisions, which will constrain the possible allocations of utilities. If the\nconstraints are suitably formulated, this will result in a genuine MILP model of the\nallocation problem, for which integer programming methods will be required. However,\nthe original MILP model (before adding problem-speci\fc constraints) is the \\best\"\npossible in terms of sharpness.\nPractical application often requires that resources be allocated to groups or classes\nrather than to individuals, where the groups may have di\u000berent sizes. We show in\nSection 5 that the MILP formulation can be extended to this case without sacri\fcing\nsharpness. The relevant proofs appear in the Appendix. In Section 6 we apply the\n2\nextended model to health care resources planning. We report computational tests in-\ndicating that the model can be solved in a few seconds even for a thousand groups or\nmore.\nThere is a large literature on social welfare functions, although only a few combine\nequity and e\u000eciency. The Gini coe\u000ecient, McLoone index, Atkinson's function, Hoover\nindex, and Theil index measure inequality. These and others are discussed by Tempkin\n(1993). Maximin and lexicographic maximum functions aim to capture a Rawlsian fair-\nness criterion and are discussed, for example, by Blackorby et al. (2002), Daniels (1989),\nDworkin (1977), Luss (1999), Roemer (1998), and Stein (2006). Structural properties\nof optimal solutions for utilitarian and lexmax objectives are derived in Hooker (2010).\nNash bargaining and Rai\u000ba-Kalai-Smorodinsky bargaining may be seen as re\recting\nboth equity and e\u000eciency. These and other schemes are discussed by Blackorby et al.\n(2002), Gaertner (2009), and Yaari and Bar-Hillel (1984). Proportional fairness objec-\ntives for communication networks are closely related to the Nash bargaining solution\nand are discussed by Kelly et al. (1999) and Mazumdar et al. (1991), among others. The\ne\u000eciency cost of proportional and maximin fairness objectives is studied by Bertsimas\net al. (to appear). Welfare functions for health care allocation are discussed by Broome\n(1988), Stinnett and Paltiel (1995), and Williams and Cookson (2000, 2006).\n2 Problem and Basic Approach\nWe suppose that a population consists of individuals (or classes of individuals) and that\nour policies would result in an allocation of utilities u1; u2; :::; un to these individuals. In\nthe health context these utilities could be quality adjusted life years (QALYs) (Broome,\n1988; Dolan, 1998).\nWe will endeavor to implement a policy (e.g., resource allocation) that maximises\nthe utility of the worst o\u000b|that is, maximises minifuig|unless this takes too many\nresources from the others. Following a suggestion in Williams and Cookson (2000) for\nthe two-person case, we will switch from a Rawlsian to a utilitarian criterion when\ninequality exceeds a threshold; that is, when ju1 \u0000 u2j \u0015 \u0001. We therefore de\fne a\nsocial welfare function that has the contours shown in Fig. 1. When ju1 \u0000 u2j \u0014 \u0001,\nthe contours re\rect the Rawlsian function minfu1; u2g, and otherwise they re\rect the\nutilitarian function u1 + u2. The advantage of a formulating a social welfare function\nis that it can be maximized, subject to resource limitations and other constraints, so\nas to determine the most desirable equity\/e\u000eciency tradeo\u000b. It is not obvious how to\nextend this approach beyond two persons, but we will propose below an extension that\ncaptures the underlying motivation.\nMaximising this social welfare function has the e\u000bect of adhering to a Rawlsian\ncriterion unless the cost to the other party is too great. Suppose that due to limited\n3\n..\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.........................................................................................................................................................................................................................................................\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n..............................................................\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n..............................................................\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n............................................................\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n..............................................................\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n..............................................................\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n..............................................................\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.............................................................\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.............................................................\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n..........................\n....\n..\n..\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\nFeasible\nset\n......................................... ..................\n.......\n..\n..\n..\n.\nu\ned\nu1\nu2\n\u2206\n\u2206\n1\nFigure 1: Contours of the social welfare function for a 2-person problem. The diagonal contours\ncorrespond to a utilitarian criterion, and the L-shaped contours to a Rawlsian criterion. The curve\nre\rects resource limits.\nhealth care resources, allocations of utility must lie in the region under the curve in\nFig. 1. The curve indicates that person 1 is di\u000ecult to treat, because allocating all\nresources to person 1 is much less e\u000bective than allocating all resources to person 2.\nFurthermore, the marginal cost of improving person 1's health becomes very high as\nthe limit is approached.\nA purely Rawlsian solution allocates equal utility to each person, as indicated by\nthe open circle. However, this requires great sacri\fce from person 2. A small diversion\nof resources to person 2 would have substantial bene\ft while only slightly degrading\nthe health of person 1. It may therefore be rational to switch to a utilitarian objective.\nIn fact, the maximum value of the social welfare function, indicated by the black dot,\noccurs in the utilitarian region.\nThe level at which to set \u0001 is clearly judgemental and likely to be a point of disagree-\nment among the parties concerned. However, once a value for \u0001 has been settled upon,\nmaximising the social welfare function allows the same policy to be applied consistently\nwhenever a budgeting decision is taken. It is necessary to agree on an e\u000eciency\/equity\ncompromise only once, when the value of \u0001 is selected, rather than revisiting the issue\nevery time it comes up in practice.\nFurthermore, the model allows policy makers to examine the consequences of a\ngiven value of \u0001 across a wide variety of cases. They can compute allocations in typical\n4\nscenarios for each of several values of \u0001. Stakeholders can then examine each scenario\nand indicate which allocation they prefer. The value of \u0001 that results in the most\npopular (or least objectionable) allocation might then be selected. Once it is selected,\nthe stakeholders can be assured that the same policy is applied consistently across the\nboard.\nOne could, of course, maximize a linear combination of utilitarian and Rawlsian\nobjectives: X\ni\nui + \u000bmin\ni\nfuig\nwhich is easy to model because it is concave. However, this raises the question of how to\njustify and interpret any particular multipler \u000b. By contrast, \u0001 has intuitive meaning\nand is measured in the same units as utility. It is the level of inequality at which\ne\u000eciency considerations take over. In a health care context, for example, a resource\nallocation in which some persons enjoy \u0001 QALYs more than others should begin to\ntake e\u000eciency into account.\n3 Two-person Problem\nWe wish to allocate utilities u1; u2 to two individuals so as to maximise a social welfare\nfunction with the contours illustrated in Fig. 1. Because we want the function to be\ncontinuous, in the Rawlsian case we de\fne its value to be 2minfu1; u2g+\u0001 rather than\nminfu1; u2g. The optimization problem is therefore to maximize z subject to\nz \u0014\n(\n2minfu1; u2g+\u0001 if ju1 \u0000 u2j \u0014 \u0001\nu1 + u2 otherwise\nu1; u2 \u0015 0\n(1)\nand subject to additional constraints on u1; u2 that are added to represent resource\nlimits or policy restrictions. Such constraints will be illustrated in Section 6.\nWe wish to write an MILP model for (1). In order for the problem to be MILP\nrepresentable (Jeroslow, 1987, 1989), its hypograph must be the union of a \fnite number\nof polyhedra with the same recession directions. We do not repeat the de\fnitions of\nhypograph and recession directions here but refer the reader to Jeroslow (1987, 1989),\nHooker (2009), or Williams (2009). If the polyhedra do not have the same recession\ndirections, then some innocuous constraints can be added to equalise the recession cones.\nThe hypograph of (1) is the union of two polyhedra, de\fned respectively by the two\n5\ndisjuncts: 0BB@\nz \u0014 2u1 +\u0001\nz \u0014 2u2 +\u0001\nu1; u2 \u0015 0\n1CCA _\n \nz \u0014 u1 + u2\nu1; u2 \u0015 0\n!\nThe \frst disjunct corresponds to the maximin case and the second to the utilitarian\ncase.\nThe two polyhedra have di\u000berent recession cones. The recession cone for the \frst is\nspanned by the four vectors\n(u1; u2; z) = (1; 1; 2); (1; 0; 0); (0; 1; 0); (0; 0;\u00001)\nThe recession cone for the second is spanned by the vectors\n(u1; u2; z) = (1; 1; 0); (1; 0; 1); (0; 0;\u00001)\nHowever, if we add the constraints u1 \u0000 u2 \u0014 M and u2 \u0000 u1 \u0014 M to each disjunct,\nthen the polyhedra have the same recession cone, spanned by the vectors\n(u1; u2; z) = (1; 1; 2); (0; 0;\u00001)\nThis is illustrated in Fig. 2. The hypograph is now represented by the big-M model\nz \u0014 2ui +\u0001+ (M \u0000\u0001)\u000e; i = 1; 2 (a)\nz \u0014 u1 + u2 +\u0001(1\u0000 \u000e) (b)\nu1 \u0000 u2 \u0014M; u2 \u0000 u1 \u0014M (c)\nu1; u2 \u0015 0; \u000e 2 f0; 1g\n(2)\nWe can also give the two polyhedra the same recession cone (namely, the origin)\nby imposing bounds u1; u2 \u0014 M . In this case the formulation is the same except that\nconstraints (c) are replaced by u1; u2 \u0014M .\nModel (2) is a sharp formulation of (1), meaning that it has the tightest possible con-\ntinuous relaxation. Its continuous relaxation describes a polyhedron whose projection\nonto the original variables is the (closure of) the convex hull of the hypograph.\n6\n..\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.........................................................................................................................................................................................................................................................\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n..............................................................\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n..............................................................\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n............................................................\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n..............................................................\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n..............................................................\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n..............................................................\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.............................................................\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.............................................................\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\nu1\nu2\n\u2206 M\n\u2206\nM\n1\nFigure 2: Modi\fed social welfare function for which the hypograph is the union of two polyhedra\nwith the same recession cone.\n4 Many-person Problem\nWe now allot utilities u1; : : : ; un to n individuals. One way to generalize the two-person\nproblem (1) is to observe that (1) can be written\nz \u0014 \u0001+ 2umin +max f0; u1 \u0000 umin \u0000\u0001g+max f0; u2 \u0000 umin \u0000\u0001g\nu1; u2 \u0015 0\n(3)\nwhere umin = minfu1; u2g. Thus each person i makes a utilitarian contribution if ui\ndi\u000bers from umin more than \u0001. If u1 > u2 + \u0001, the \frst max term of (3) contributes\nu1 \u0000 umin \u0000 \u0001 and the second max term nothing, yielding u1 + u2 altogether, and\nsimilarly if u2 > u1 +\u0001. Otherwise, both max terms vanish.\nThe pattern in (3) can be generalized as follows:\nz \u0014 (n\u0000 1)\u0001 + numin +\nnX\ni=1\nmax f0; ui \u0000 umin \u0000\u0001g\nui \u0015 0; all i\n(4)\nwhere umin = minifuig. Thus person i contributes ui if ui di\u000bers from umin more than\n\u0001 and is otherwise represented by umin.\n7\nSuppose for illustration that u1 \u0014 \u0001 \u0001 \u0001 \u0014 un. If everyone makes a utilitarian contri-\nbution, then the summation in (4) becomes\n\u0000(n\u0000 1)\u0001\u0000 (n\u0000 1)u1 +\nX\ni>1\nui\nand the inequality constraint in (4) becomes z \u0014 Pni=1 ui. If no two utilities di\u000ber by\nmore than \u0001, the summation in (4) vanishes, and the resulting inequality constraint\nyields a maximin solution. If only u1; : : : ; uk are within \u0001 of u1, the constraint becomes\nz \u0014 (k \u0000 1)\u0001 + ku1 +\nnX\ni=k+1\nui\nThis is a combination of the lowest order statistic with the n\u0000k highest order statistics,\nwhere the lowest is multiplied by k so that all persons receive equal consideration.\nThus everyone in lower stratum (within \u0001 of the bottom) is identi\fed with the least\nadvantaged person, and the lower stratum receives weight in proportion to its size.\nOne might achieve a roughly similar e\u000bect by giving more weight to lower terms in a\nlinear combination of order statistics, but then the problem of justifying and interpreting\nweights is only compounded, because there are so many of them. Also it is di\u000ecult to\nmodel such a function for solution by optimization methods. The function proposed\nhere requires only one parameter \u0001, regardless of the number of individuals involved,\nand it has a practical MILP formulation.\n4.1 Mixed Integer Formulation\nAs in the two-person case, the n-person problem can be formulated as an MILP if we\nsuppose that\nuj \u0000 ui \u0014M; all i; j (5)\nWe can in principle write an MILP model for (4){(5) based on a union of polyhedra\nsimilar to that used in the two-person case, but this results in exponentially many 0-1\nvariables. A much more compact model to maximizes z subject to\nz \u0014 (n\u0000 1)\u0001 +\nnX\ni=1\nvi (a)\nui \u0000\u0001 \u0014 vi \u0014 ui \u0000\u0001\u000ei; all i (b)\nw \u0014 vi \u0014 w + (M \u0000\u0001)\u000ei; all i (c)\nui \u0015 0; \u000ei 2 f0; 1g; all i\n(6)\nand again subject to resource and policy constraints. The interpretation of \u000ei is that it\nis 0 when ui \u0000 umin < \u0001 and is 1 otherwise.\n8\nTheorem 1 The MILP model (6) is a correct formulation of problem (4){(5).\nProof. We must show that any feasible solution of the problem is a solution of (6),\nand vice-versa. To show the former, consider any feasible solution (u; z). We exhibit\nvalues of v; w; \u000e such that (u; z; v; w; \u000e) is a feasible solution of (6). Supposing without\nloss of generality that umin = u1, set\nw = u1; (\u000ei; vi) =\n(\n(0; u1) if ui \u0000 u1 < \u0001\n(1; ui \u0000\u0001) otherwise\n(7)\nTo show that (b) and (c) in (6) are satis\fed, note that when ui \u0000 u1 < \u0001, they are\nsatis\fed due to (7). When ui \u0000 u1 \u0015 \u0001, (b) and the \frst inequality in (c) are satis\fed\ndue to (7), and the second inequality in (c) is satis\fed because ui \u0000 u1 \u0014 M is given.\nTo show (a), write it as\nz \u0014 (n\u0000 1)\u0001 + nu1 +\nX\ni\nui \u0000 u1 < \u0001\n(vi \u0000 u1) +\nX\ni\nui \u0000 u1 \u0015 \u0001\n(vi \u0000 u1)\nSubstituting the values of vi given in (7), this becomes\nz \u0014 (n\u0000 1)\u0001 + nu1 +\nX\ni\nui \u0000 u1 < \u0001\n(u1 \u0000 u1) +\nX\ni\nui \u0000 u1 \u0015 \u0001\n(ui \u0000 u1 \u0000\u0001)\nwhich is implied by (4).\nWe now suppose that (u; z; v; w; \u000e) satis\fes (6) and show that (u; z) satis\fes (4) and\nuj\u0000ui \u0014M for all i; j. To show the latter, note that (c) implies that vj\u0000 (M \u0000\u0001)\u000ej \u0014\nw \u0014 vi for any i; j, and therefore\nvj \u0000 vi \u0014M \u0000\u0001 (8)\nBut because vj \u0015 uj \u0000\u0001 and vi \u0014 ui due to (b), (8) implies uj \u0000 ui \u0014 M , as claimed.\nTo show that (u; z) satis\fes (4), write (6a) as\nz \u0014 (n\u0000 1)\u0001 + nu1 +\nX\ni\n\u000ei = 0\n(vi \u0000 u1) +\nX\ni\n\u000ei = 1\n(vi \u0000 u1) (9)\nEach term of the \frst summation satis\fes\nvi \u0000 u1 \u0014 w \u0000 u1 \u0014 0 \u0014 (ui \u0000 u1 \u0000\u0001)+ (10)\n9\nwhere the \frst inequality is due to (b) and \u000ei = 0. Noting from (b) and (c) that\nw \u0014 vi \u0014 ui\u0000\u0001\u000ei for all i, we have w \u0014 u1, whence the second inequality in (10). Also\neach term of the second summation satis\fes\nvi \u0000 u1 \u0014 ui \u0000 u1 \u0000\u0001 \u0014 (ui \u0000 u1 \u0000\u0001)+\nwhere the \frst inequality is due to (b) and \u000ei = 1. Inequality (9) therefore implies (4),\nas desired.\n4.2 Proof of Sharpness\nThe model (6) is sharp because the projection of its continuous relaxation onto (z; u)-\nspace is the convex hull of the original problem. The continuous relaxation of (6) is\nz \u0014 (n\u0000 1)\u0001 +\nnX\ni=1\nvj (a)\nui \u0000\u0001 \u0014 vi; all i (di)\nvi \u0014 ui \u0000\u0001\u000ei; all i (ei)\nw \u0014 vi; all i (fi)\nvi \u0014 w + (M \u0000\u0001)\u000ei; all i (gi)\n\u000ei \u0015 0 all i (hi)\n\u000ei \u0014 1; ui \u0015 0; all i\n(11)\nTheorem 2 The model (6) is a sharp formulation of the problem (4){(5).\nProof. The proof consists of two parts. We \frst show that (11) implies the following:\nz \u0014 (n\u0000 1)\u0001 +\n\u0012\n1 + (n\u0000 1) \u0001\nM\n\u0013\nui +\n\u0012\n1\u0000 \u0001\nM\n\u0013X\nj 6=i\nuj ; all i (ki)\nuj \u0000 ui \u0014M; all i; j (`ij)\nui \u0015 0; all i\n(12)\nWe then show that every valid inequality for the original problem is implied by (12).\nBecause (6) is a correct model of the problem, it follows that (12) describes the convex\nhull of the feasible set, and (6) is a sharp model.\nPart I. We wish to show that (11) implies (12). We saw in the proof of Theorem 1\nthat (11) implies (`ij) for all i; j. To show that (11) implies (ki) for any i, we show that\n(ki) is a surrogate (nonnegative linear combination) of inequalities of (11). First, note\n10\nthat the following inequalities are surrogates of (11) for each i:\nvi \u0014 \u0001\nM\nw +\n\u0012\n1\u0000 \u0001\nM\n\u0013\nui (pi)\nvi \u0014 ui (qi)\nbecause (pi) =\n1\n\u0001 (ei) +\n1\nM\u0000\u0001 (gi) and (qi) =\n1\n\u0001 (ei) + (hi). Now we have the following\nfor each i; j:\nvj \u0014 \u0001\nM\nvi +\n\u0012\n1\u0000 \u0001\nM\n\u0013\nuj (rij)\nbecause (rij) =\nM\n\u0001 (pj) + (qi). Finally,\n(ki) = (a) +\nX\nj 6=i\n(rij) +\n\u0012\n1 + (n\u0000 1) \u0001\nM\n\u0013\n(qi)\nwhich shows that (ki) is a surrogate of (11), as desired.\nPart II. It remains to show that any inequality z \u0014 au + b that is valid for the\nproblem is implied by (12). For this it is enough to show that z \u0014 au+ b is dominated\nby a surrogate of (12).\nFirst we observe that (u1; : : : ; un; z) = (0; : : : ; 0; (n \u0000 1)\u0001) is feasible in (4) and\nmust therefore satisfy z \u0014 au+ b. Substituting these values into z \u0014 au+ b, we obtain\nb \u0015 (n\u0000 1)\u0001. Also, for any t \u0015 0,\n(u1; : : : ; un; z) = (t; : : : ; t; nt+ (n\u0000 1)\u0001)\nis feasible in (4), which implies\nX\ni\nai \u0015 n\u0000 b\u0000 (n\u0000 1)\u0001\nt\nLetting t ! 1, we get that Pi ai \u0015 n. It su\u000eces to show that any z \u0014 au + b\nwith\nP\ni ai = n is dominated by a surrogate of (12), because in this case an inequality\nwith\nP\ni ai > n can be obtained by adding multiples of ui \u0015 0 to an inequality withP\ni ai = n.\nWe let N = f1; : : : ; ng and de\fne index sets as follows:\nI =\n\u001a\ni 2 N\n\f\f\f\f 1\u0000 \u0001M \u0014 ai \u0014 1\n\u001b\n; J =\n\u001a\ni 2 N\n\f\f\f\f ai < 1\u0000 \u0001M\n\u001b\n; K = N n (I [ J)\n11\nWe next associate multipliers \u000bi with (ki) and \fij with (`ij), de\fned by\n\u000bi =\n8>><>>:\nM\nn\u0001\n\u0012\nai \u0000 1 + \u0001\nM\n\u0013\nif i 2 I\n1\u0000 \u000b[I]\nn\u0000 jIj otherwise\n\fij =\n8>>>><>>>>:\n1\njKj\n\u0012\nn\u0000 a[I]\nn\u0000 jIj \u0000 ai\n\u0013\nif i 2 J , j 2 K\nfij if i; j 2 K and i 6= j\n0 otherwise\n(13)\nwhere \u000b[I] =\nP\nj2I \u000bj , and similarly for a[I] and a[K]. The quantities fij are feasible\nnonnegative \rows on edges (i; j) of a complete directed graph whose vertices correspond\nto indices in K, with a net supply of ai \u0000 a[K]=jKj at each vertex i. Such \rows exist\nbecause the net supply over all vertices is\nP\ni(ai \u0000 a[K]=jKj) = 0.\nWe \frst show that the linear combination\nP\ni \u000bi(ki) +\nP\nij \fij(`ij) is the inequality\nz \u0014 au + (n \u0000 1)\u0001, given that Pi ai = n. It is easily checked that Pi \u000bi = 1, so that\nthe linear combination has the form z \u0014 du+ (n\u0000 1)\u0001. It remains to show that d = a.\nWe have\ndi =\n\u0012\n1 + (n\u0000 1) \u0001\nM\n\u0013\n\u000bi +\n\u0012\n1\u0000 \u0001\nM\n\u0013X\nj 6=i\n\u000bj +\nX\nj\n(\fji \u0000 \fij)\nUsing the fact that\nP\ni \u000bi = 1, this becomes\ndi =\n\u0001\nM\n(n\u000bi \u0000 1) + 1 +\nX\nj\n(\fji \u0000 \fij) (14)\nWhen i 2 I, each \fij = 0, and we immediately get from (14) that di = ai. When i 2 J ,\n(14) becomes\ndi =\nn\u0000 a[I]\nn\u0000 jIj \u0000\nX\nj2K\n1\njKj\n\u0012\nn\u0000 a[I]\nn\u0000 jIj \u0000 ai\n\u0013\n= ai\nWhen i 2 K, (14) becomes\ndi =\nn\u0000 a[I]\nn\u0000 jIj +\nX\nj2J\n1\njKj\n\u0012\nn\u0000 a[I]\nn\u0000 jIj \u0000 aj\n\u0013\n+\nX\nj2Knfig\n(fji \u0000 fij)\n=\n\u0012\n1 +\njJ j\njKj\n\u0013\nn\u0000 a[I]\nn\u0000 jIj \u0000\na[J ]\njKj +\nX\nj2Knfig\n(fji \u0000 fij)\n12\nUsing the fact that a[J ] = n\u0000 a[I]\u0000 a[K], this simpli\fes to\ndi =\na[K]\njKj +\nX\nj2Knfig\n(fji \u0000 fij) (15)\nBut this implies di = ai, because the second term is the net supply at vertex i, which\nis ai \u0000 a[K]=jKj.\nWe conclude that z \u0014 au+(n\u00001)\u0001 is the linear combinationPi \u000bi(ki)+Pij \fij(`ij).\nSince b \u0015 (n\u00001)\u0001, z \u0014 au+b is dominated by a surrogate of (12) and therefore implied\nby (6), provided we show that the multipliers \u000bi; \fij are nonnegative.\nWe observe \frst that \u000bi \u0015 0 for i 2 I because ai \u0015 1\u0000\u0001=M , due to the de\fnition\nof I. To show that \u000bi \u0015 0 for i 62 I, we note that ai \u0014 1 for i 2 I implies \u000bi \u0014 1=n,\nfrom the de\fnition of \u000bi. Thus \u000b[I] \u0014 1, which implies \u000bi \u0015 0 for i 62 I. To show that\n\fij \u0015 0 for i 2 J and j 2 K, we note that ai \u0014 1 for i 2 I implies that a[I] \u0014 jIj,\nwhence\nn\u0000 a[I]\nn\u0000 jIj \u0015 1 (16)\nBut ai < 1 \u0000\u0001=M for i 2 J n fjg implies ai \u0014 1, which along with (16) implies that\n\fij \u0015 0. Finally, \fij = fij for i; j 2 K is by de\fnition a nonnegative \row.\n5 Modeling Groups of Recipients\nPolicy makers often allocate resources to groups or classes of recipients rather than\nindividuals. This is true in particular for health care planning, where funding for spe-\nci\fc types of treatments is allocated to classes of patients depending on the type and\nprognosis of their illness. The classes generally vary in size.\nIn principle, such a situation can be modeled by introducing a utility variable ui for\neach individual, and imposing side constraints that require individuals within a given\nclass to receive the same allocation. However, this can result in a very large MILP\nmodel. Fortunately, it is possible to build a sharp model for the problem by allocating\nutility to groups rather than individuals, even when the groups have di\u000berent sizes.\nWe therefore suppose there are m groups of recipients, and each group i has size\nni. Because each member of a group receives the same allocation, we split the utility\nallocated to a group evenly among the members of the group. Let ui be the per capita\nutility in group i, so that the group's total utility is niui. The optimization problem\n13\ntherefore maximizes z subject to\nz \u0014\n \nmX\ni=1\nni \u0000 1\n!\n\u0001+\n \nmX\ni=1\nni\n!\numin +\nmX\ni=1\nni (ui \u0000 umin \u0000\u0001)+\nuj \u0000 ui \u0014M; all i; j\nui \u0015 0; all i\n(17)\nand subject to resource and policy constraints, where again umin = minjfujg.\nThe most nearly utilitarian case occurs when there is a group k that is far below\nthe others in average utility, i.e., ui \u0000 uk > \u0001 for all i 6= k. In this case the inequality\nconstraint in (17) becomes\nz \u0014 (nk \u0000 1)\u0001 +\nX\ni\nniui\nIt is not quite utilitarian, as there is an o\u000bset that depends on which group is worst o\u000b.\nThis is because the utilities in the worst-o\u000b group are equally low and therefore within\n\u0001 of the lowest, which means they do not receive utilitarian treatment.\n5.1 The Two-group Problem\nIt is interesting to examine the two-group problem, which maximizes z subject to\nz \u0014 (n1 + n2 \u0000 1)\u0001 + (n1 + n2)umin + n1(u1 \u0000 umin \u0000\u0001)+ + n2(u2 \u0000 umin \u0000\u0001)+\nu1 \u0000 u2 \u0014M; u2 \u0000 u1 \u0014M\nu1; u2 \u0015 0\n(18)\nand side constraints. A graph of the model with n1 < n2 appears in Fig. 3. Note that\nthe utilitarian contours now have slope \u0000n1=n2 rather than \u00001.\n5.2 MILP Model\nAn MILP formulation of the multi-group problem maximizes z subject to\nz \u0014\n X\ni\nni \u0000 1\n!\n\u0001+\nnX\ni=1\nnivi (a)\nui \u0000\u0001 \u0014 vi \u0014 ui \u0000\u0001\u000ei; all i (b)\nw \u0014 vi \u0014 w + (M \u0000\u0001)\u000ei; all i (c)\nui \u0015 0; \u000ei 2 f0; 1g; all i\n(19)\nand side constraints. Again \u000eij = 1 when uj \u0000 ui \u0015 \u0001.\n14\n..\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n......................................................................................................................................................................................................................................................................................\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n....\n............\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n......................................................................\n.................\n.................\n....\n........\n................\n.......\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n..............................................................................\n..................\n...................\n...................\n..................\n.....\n............\n.................\n...........\n......\n..\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.............................................................\n..............\n..................\n...................\n...................\n..................\n..........\n................\n.................\n..................\n.............\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.............................................................\n............\n..................\n...................\n...................\n..................\n............\n.\n...................\n..................\n..................\n...................\n.......\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n........................................................................\n...................\n...................\n...................\n..................\n.............\n.....\n..................\n...................\n...................\n...................\n..................\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n......................................................................\n...................\n...................\n..................\n...................\n...............\n....\n..................\n...................\n...................\n..................\n...................\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n............................................................ ...............\n...................\n...................\n..................\n...................\n........\n..\n..................\n...................\n...................\n..................\n...................\n...\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n.\n................................................................\n...................\n............\n.........................\n...................\n...................\n.\nu\u00af1\nu\u00af2\n\u2206 M\n\u2206\nM\n1\nFigure 3: Contours of the social welfare function for the 2-group problem with n1 < n2.\nTheorem 3 Model (19) is a correct formulation of (17).\nThe proof is similar to the proof of Theorem 1 and is given in the Appendix.\nTheorem 4 Model (19) is sharp.\nThe extension to groups signi\fcantly complicates the proof of sharpness, which is like-\nwise given in the Appendix.\n6 Application to Health Care\nA central problem of health care policy is to allocate scarce resources to classes of\npatients, depending on their prognosis and the extent to which they would bene\ft\nfrom various treatments. Treatments frequently have an all-or-nothing character, as\nin the case of a surgery, chemotherapy regimen, or organ transplant. Because utility\nis allocated equally to the members of a group, we must be able to model the case in\nwhich a treatment is given to all members of the group or none.\nWe therefore introduce a 0-1 variable yi that is equal to 1 when everyone in group i\nreceives a speci\fed treatment. Let qi be the average net gain in QALYs for a member\nof group i when the treatment is administered. Then the per capita utility of group i is\nui = qiyi + \u000bi (20)\nwhere \u000bi is the average QALYs that result from medical management without the\n15\ntreatment in question. If ci is the added cost per patient of administering the treatment,\nthe budget constraint becomes X\ni\nniciyi \u0014 B (21)\nwhere B represents the funds available for providing the treatments. The resulting\nMILP model maximizes z subject to (19) along with constraint (20) for all i, constraint\n(21), and yi 2 f0; 1g for all i.\nPatients in a group may present di\u000berent states of health and therefore bene\ft in\ndi\u000berent degrees from the same treatment. It may therefore be important in practice\nto divide a group into relatively homogeneous subgroups. The subgroups would be\ndistinguished by di\u000berent values of qi and\/or \u000bi in the above model.\nTo illustrate this process we present a small but fairly realistic example. The medical\nliterature contains cost-per-QALY estimates for a wide variety of treatments, and most\nof the relevant papers and\/or estimates are available online in the CEA Registry (Tufts\nMedical Center, 2010) or the United Kingdom's NICE website (NHS, 2010). However,\nthese studies span di\u000berent eras, geographical regions, and clinical settings, which re-\nsult in incomparable cost estimates. In addition, most studies examine very speci\fc\ntreatments or interventions.\nWe therefore built a model around cost-per-QALY data provided by a single source,\nBriggs and Gray (2000), which covers a limited selection of treatments but provides\nestimates based on a common methodology. Briggs and Gray derive their costs per\nQALY in part from net QALY gains reported for these treatments by Williams (1985).\nIn most cases, we obtained the per-patient cost ci by multiplying the average cost per\nQALY in the Briggs and Gray article by the net QALY gain in the Williams article.\nThe data we used for the MILP model appear in Table 1. The group sizes are based\napproximately on various estimates of the relative frequency of each intervention in the\nUnited States. However, the relative frequency of kidney dialysis patients is reduced\nto one-third the prevailing rate, because otherwise this very large population would\noverwhelm our small example.\nThe groups corresponding to pacemakers, hip replacements, and aortic valve replace-\nments are divided into three subgroups, of which subgroup B represents the average cost\nper QALY reported by Briggs and Gray (2000). Groups A and C re\rect deviations from\nthe average and allow policymakers to consider di\u000berent prognoses among patients with\nthe same basic disease. The nine categories of candidates for coronary artery bypass\ngrafts (CABGs) are explicitly distinguished by Briggs and Gray, and the costs per\nQALY re\rect their estimates.\nThe kidney dialysis candidates are categorized by expected lifespan while on dialysis,\nto re\rect the fact that the cost per patient as well as the QALYs gained depend on how\nlong the patient survives. The relative size of each category is based on survival rates for\nthe United States reported by NKUDIC (2010). The annual cost per patient is derived\n16\nfrom (a) Briggs and Gray's estimate of $14,000 per QALY; (b) an average of 0.688\nQALYs per year of dialysis, based on converting to a 0-1 scale the Index of Well Being\nfor such patients reported in Evans et al. (1985), which Briggs and Gray cite as their\nsource; and (c) an average of 0.85 additional years of life obtained for each year spent\non dialysis. This results in a per-capita annual dialysis cost of (14,000)(0.688)(0.85),\nor about $8200. Some categories are further subdivided by prognosis due to the high\nper-patient cost, because otherwise, funding a single category would consume a large\nfraction of the budget.\nThe expected QALYs without intervention, given by \u000bi, depends entirely on such\npopulation characteristics as age, general state of health, and environment. The data\nused here do not represent any particular population but are selected only to re\rect one\npossible set of circumstances. The total budget is set at $3 million because this \fgure\ncreates enough shortage to force some hard decisions.\nTable 2 presents the results of solving the MILP model over various ranges of \u0001.\nThese results are not intended as policy recommendations, because the solution depends\non population characteristics, budget, costs, and treatment options, which vary from\none situation to another. Nonetheless, the results show that combining equity and\ne\u000eciency in this manner can lead to interesting and perhaps unexpected conclusions.\nThe table shows that pacemakers are advisable under any combination of equity\nand e\u000eciency, as are hip and valve replacements except in the mildest cases. However,\nresources shift from CABGs to kidney dialysis as \u0001 increases. Dialysis has a higher\ncost per QALY, but this is overridden by the poor prognosis without treatment when\nequity is more important.\nThere are also subtleties that one might not predict. Kidney dialysis \frst appears\nfor patients with the best prognosis, for whom it is slightly less expensive per QALY,\nand extends to other patients as equity is more heavily emphasized. Most CABGs drop\nout rather suddenly when \u0001 \u0015 5:6 QALYs. In fact, CABGs for double and triple artery\ndisease are almost always funded or defunded together, even though these subgroups\nhave di\u000berent characteristics. The same is true of dialysis decisions for most patients\nwith less than 10 years life expectancy on dialysis. Some kidney transplants drop out\nwhen \u0001 reaches an intermediate value but come back in when equity dominates. A\nsimilar pattern occurs for valve replacements for mildly a\u000ficted patients.\nIn general, the solution is more sensitive to \u0001 when \u0001 is between 5 and 6. This\nsuggests that a politically acceptable compromise may place \u0001 in this neighborhood.\nIt is in this range where the greatest number of interest groups are near the boundary\nbetween approval and disapproval of \u0001.\nAs expected, the average QALYs per person generally declines as \u0001 increases,\nbecause larger values of \u0001 imply less emphasis on maximizing utility. However, due\nto the presence of discrete choices, there are some exceptions. The maximin solution\n17\nTable 1: Data for health care example.\nIntervention Cost QALYs Cost QALYs Subgroup\nper person gained per without size\nci qi QALY intervention ni\n($) ($) \u000bi\nPacemaker for atrioventricular heart block\nSubgroup A 3500 3 1167 13 35\nSubgroup B 3500 5 700 10 45\nSubgroup C 3500 10 350 5 35\nHip replacement\nSubgroup A 3000 2 1500 3 45\nSubgroup B 3000 4 750 4 45\nSubgroup C 3000 8 375 5 45\nValve replacement for aortic stenosis\nSubgroup A 4500 3 1500 2.5 20\nSubgroup B 4500 5 900 3 20\nSubgroup C 4500 10 450 3.5 20\nCABG1 for left main disease\nMild angina 3000 1.25 2400 4.75 50\nModerate angina 3000 2.25 1333 3.75 55\nSevere angina 3000 2.75 1091 3.25 60\nCABG for triple vessel disease\nMild angina 3000 0.5 6000 5.5 50\nModerate angina 3000 1.25 2400 4.75 55\nSevere angina 3000 2.25 1333 3.75 60\nCABG for double vessel disease\nMild angina 3000 0.25 12,000 5.75 60\nModerate angina 3000 0.75 4000 5.25 65\nSevere angina 3000 1.25 2400 4.75 70\nHeart transplant\n22,500 4.5 5000 1.1 2\nKidney transplant\nSubgroup A 15,000 4 3750 1 8\nSubgroup B 15,000 6 2500 1 8\nKidney dialysis\nLess than 1 year survival\nSubgroup A 5000 0.1 50,000 0.3 8\n1-2 years survival\nSubgroup B 12,000 0.4 30,000 0.6 6\n2-5 years survival\nSubgroup C 20,000 1.2 16,667 0.5 4\nSubgroup D 28,000 1.7 16,471 0.7 4\nSubgroup E 36,000 2.3 15,652 0.8 4\n5-10 years survival\nSubgroup F 46,000 3.3 13,939 0.6 3\nSubgroup G 56,000 3.9 14,359 0.8 2\nSubgroup H 66,000 4.7 14,043 0.9 2\nSubgroup I 77,000 5.4 14,259 1.1 2\nAt least 10 years survival\nSubgroup J 88,000 6.5 13,538 0.9 2\nSubgroup K 100,000 7.4 13,514 1.0 1\nSubgroup L 111,000 8.2 13,537 1.2 1\n1Coronary artery bypass graft\n18\nTable 2: Results of health care example. A 1 in the body of the table indicates that the treatment\nis given to all members of a subgroup, and 0 that it is given to none. The subgroups are de\fned in\nTable 1. The last column indicates the average expected QALYs per person. These results are not\nintended as general policy recommendations, because they re\rect one particular set of population\ncharacteristics, costs, and treatment options, which may di\u000ber substantially from one situation to\nanother.\n\u0001 Pace- Hip Aortic CABG Heart Kidney Kidney dialysis Avg.\nrange maker repl. valve L 3 2 trans. trans. < 1 1-2 2-5 5-10 > 10 QALYs\n0{3.3 111 111 111 111 111 111 1 11 0 0 000 0000 000 7.54\n3.4{4.0 111 111 111 111 111 111 0 11 1 0 000 0000 000 7.54\n4.0{4.4 111 111 111 111 111 111 0 01 1 0 000 0000 001 7.51\n4.5{5.01 111 011 111 111 111 111 1 01 1 0 000 0000 011 7.43\n5.02{5.55 111 011 011 111 111 111 0 01 1 0 000 0001 011 7.36\n5.56{5.58 111 011 011 111 111 011 0 01 1 0 000 0001 111 7.36\n5.59 111 011 011 110 111 111 0 01 1 0 000 0001 111 7.20\n5.60{13.1 111 111 111 101 000 000 1 11 1 0 111 1111 111 7.06\n13.2{14.2 111 011 111 011 000 000 1 11 1 1 111 1111 111 7.03\n14.3{15.4 111 111 111 011 000 000 1 11 1 1 101 1111 111 7.13\n15.5{up 111 011 111 011 001 000 1 11 1 0 011 1111 111 7.19\nTable 3: Solution times in seconds for m groups and di\u000berent values of \u0001. Instances with\nmore than a few hundred groups seem very unlikely to occur in practice.\n\u0001\nm 0 1 2 3 4 5 6 1\n330 0.02 1.2 0.67 0.56 0.50 0.30 0.03 0.02\n660 0.03 4.1 1.6 1.6 0.92 0.80 0.05 0.02\n990 0.02 5.2 3.1 3.6 1.5 1.5 0.08 0.02\n1320 0.00 15 4.3 4.2 2.7 3.0 0.09 0.02\n1980 0.02 24 11 11 11 5.4 0.14 0.02\n2640 0.00 32 19 14 8.6 8.8 0.19 0.02\n3300 0.17 51 43 44 34 13 0.25 0.02\n(\u0001 \u0015 15:5) results in greater utility than solutions corresponding to 5:60 \u0014 \u0001 \u0014 15:4.\nOne might argue that solutions in this range should be eliminated because they are\ndominated by the maximin solution with respect to both utility and equity.\nThis small problem, which allocates utilities ui to 33 groups and contains 1089\ninteger variables, was solved in a small fraction of a second. We created much larger\ninstances by making k copies of each group and increasing the budget by a factor of\nk, for k = 10; 20; 30; 40; 60; 80; 100. We solved the instances using CPLEX 12.2 on a\ndesktop PC running Windows XP with a Pentium 2.8 GHz dual-core processor. The\ncomputation times appear in Table 3.\nInterestingly, the problem is harder to solve for intermediate values of \u0001 than for\nthe pure utilitarian and Rawlsian cases. Nonetheless, it is readily solved for any value\nof \u0001, even when there are upwards of 3000 groups. This may be due in part to the\n19\nsharp model of the social welfare function.\nModels with hundreds or thousands of groups are probably too large to interpret in\nany case, due to the complexity of interactions. A more practical approach is to identify\ntreatments worthy of funding for any reasonable \u0001, based on a \frst-cut model with\nbroad treatment categories. These treatments can be fully funded and removed from\nthe problem, allowing policy analysts to subdivide the more controversial categories for\ncloser scrutiny while keeping the model size within bounds. Solution times for such\nmodels will be negligible.\n7 Conclusions\nWe showed how to formulate a social welfare function that combines equity and e\u000eciency\nin a fashion that often seems reasonable, particularly in a health care context. It\ncaptures the idea that the worst-o\u000b should receive highest priority until this requires\ntoo much sacri\fce from others. The threshold is re\rected by a single parameter \u0001 that\nmeasures the level of inequality at which a utilitarian objective begins to take over from\na Rawlsian objective.\nWe proposed what seems to be a natural generalization of the social welfare function\nto the n-person case. Although formulating an MILP model of the problem raises\ntechnical issues, we provided a compact MILP formulation with only n binary variables.\nWe proved that, despite its simplicity, the model is sharp and therefore provides the best\npossible linear relaxation of the social welfare function. We also showed that it can be\nextended to groups of individuals without sacri\fcing sharpness. Finally, we illustrated\nhow to adapt the extended model to a realistic health care problem and showed that\nlife-sized instances can be easily solved using widely available MILP software.\nVariants of our model are clearly possible. For example:\n(i) Instead of working with a \fxed \u0001, we could allow it to vary with the magnitude\nof the values of the utilities uj .\n(ii) We could combine a utilitarian objective with a lexicographic maximum rather\nthan a Rawlsian maximin objective.\nA more ambitious but essential research goal is to \fnd a way to justify a choice of\n\u0001 on principle rather than by political compromise. This is a task for philosophical as\nwell as mathematical analysis.\n8 Acknowledgements\nWe thank Mara Airoldi, Nikos Argyris, and Alec Morton of the London School of\nEconomics for their advice and assistance in searching health policy literature. We also\n20\nthank anonymous reviewers for suggestions that led to signi\fcant improvements in the\npaper, including a simpli\fcation of the model.\nAppendix\nProof of Theorem 3. We show that any feasible solution of problem (17) is a solution\nof (19), and vice-versa. To show the former, consider any feasible solution (u; z). We\nexhibit values of v; w; \u000e such that (u; z; v; w; \u000e) is a feasible solution of (19). Supposing\nwithout loss of generality that umin = u1, let (v; w; \u000e) be as in (7). It can be shown as\nin the proof of Theorem 1 that (b) and (c) in (19) are satis\fed. To show (a), write it as\nz \u0014\n X\ni\nni \u0000 1\n!\n\u0001+\n X\ni\nni\n!\nu1 +\nX\ni\nui \u0000 u1 < \u0001\nni(vi \u0000 u1) +\nX\ni\nui \u0000 u1 \u0015 \u0001\nni(vi \u0000 u1)\nSubstituting the values of vi given in (7), this becomes\nz \u0014\n X\ni\nni \u0000 1\n!\n\u0001+\n X\ni\nni\n!\nu1 +\nX\ni\nui \u0000 u1 < \u0001\nni(u1 \u0000 u1) +\nX\ni\nui \u0000 u1 \u0015 \u0001\nni(ui \u0000 u1 \u0000\u0001)\nwhich is implied by (17).\nWe now suppose that (u; z; v; w; \u000e) is feasible in (19) and show that (u; z) is feasible\nin (17). It can be demonstrated as in the proof of Theorem 1 that u satis\fes the second\nconstraint of (17). To show that (u; z) satis\fes the \frst constraint, write (19a) as\nz \u0014\n X\ni\nni \u0000 1\n!\n\u0001+\n X\ni\nni\n!\nu1 +\nX\ni\n\u000ei = 0\nni(vi \u0000 u1) +\nX\ni\n\u000ei = 1\nni(vi \u0000 u1) (22)\nEach term of the \frst summation satis\fes\nni(vi \u0000 u1) \u0014 ni(w \u0000 u1) \u0014 0 \u0014 ni(ui \u0000 u1 \u0000\u0001)+ (23)\nwhere the \frst inequality is due to (b) and \u000ei = 0. Noting from (b) and (c) that\nw \u0014 vi \u0014 ui\u0000\u0001\u000ei for all i, we have w \u0014 u1, whence the second inequality in (23). Also\neach term of the second summation satis\fes\nni(vi \u0000 u1) \u0014 ni(ui \u0000 u1 \u0000\u0001) \u0014 ni(ui \u0000 u1 \u0000\u0001)+\n21\nwhere the \frst inequality is due to (b) and \u000ei = 1. Inequality (22) therefore implies the\n\frst constraint of (17), as desired.\nProof of Theorem 4. The proof has two parts. We \frst show that the continuous\nrelaxation of (19) implies the following:\nz \u0014\n0@X\nj\nnj \u0000 1\n1A\u0001+\n0@ni + \u0001\nM\nX\nj 6=i\nnj\n1Aui + \u00121\u0000 \u0001\nM\n\u0013X\nj 6=i\nnjuj ; all i (ki)\nuj \u0000 ui \u0014M; all i; j (`ij)\nui \u0015 0; all i\n(24)\nWe then show that every valid inequality for the orginal problem (17) is implied by\n(24). Because (19) is a correct model of the problem, it follows that (24) describes the\nconvex hull of the feasible set, and (19) is a sharp model.\nPart I. We wish to show that the continuous relaxation of (19) implies (24). We saw\nin the proof of Theorem 3 that it implies (`ij) for all i; j. To show that the continuous\nrelaxation of (19) implies (ki) for any i, we show that (ki) is a surrogate of the relaxation.\nThe following surrogates are derived in the proof of Theorem 2:\nvi \u0014 ui (qi)\nvj \u0014 \u0001\nM\nvi +\n\u0012\n1\u0000 \u0001\nM\n\u0013\nuj (rij)\nNow\n(ki) = (a) +\nX\nj 6=i\nnj(rij) +\n0@ni + \u0001\nM\nX\nj 6=i\nnj\n1A (qi)\nwhich shows that (ki) is a surrogate, as desired.\nPart II. It remains to show that any inequality z \u0014 au + b that is valid for the\nproblem is implied by (24). For this it is enough to show that z \u0014 au+ b is dominated\nby a surrogate of (24).\nFirst we observe that (u1; : : : ; un; z) = (0; : : : ; 0; (n[N ]\u0000 1)\u0001) is feasible in (17) and\nmust therefore satisfy z \u0014 au+ b. Substituting these values into z \u0014 au+ b, we obtain\nb \u0015 (n[N ]\u0000 1)\u0001. Also, for any t \u0015 0,\n(u1; : : : ; un; z) = (t; : : : ; t; tn[N ] + (n[N ]\u0000 1)\u0001)\nis feasible in (17), which implies\na[N ] \u0015 n[N ]\u0000 b\u0000 (n[N ]\u0000 1)\u0001\nt\n22\nLetting t!1, we get that a[N ] \u0015 n[N ]. It su\u000eces to show that any z \u0014 au+ b with\na[N ] = n[N ] is dominated by a surrogate of (24), because in this case an inequality\nwith a[N ] > n[N ] can be obtained by adding multiples of ui \u0015 0 to an inequality with\na[N ] = n[N ].\nWe de\fne index sets as follows:\nI =\n\u001a\ni 2 N\n\f\f\f\f ni\u00121\u0000 \u0001M\n\u0013\n\u0014 ai \u0014 ni\n\u001b\nJ =\n\u001a\ni 2 N\n\f\f\f\f ai < ni\u00121\u0000 \u0001M\n\u0013\u001b\n;\nK = N n (I [ J)\nWe next associate multipliers with (24) as shown and de\fne them as follows:\n\u000bi =\n8>><>>:\n1\nn[N ]\nM\n\u0001\n\u0012\nai \u0000 ni\n\u0012\n1\u0000 \u0001\nM\n\u0013\u0013\nif i 2 I\n1\u0000 \u000b[I]\nm\u0000 jIj otherwise\n\fij =\n8>>>><>>>>:\n1\njKj (Si \u0000 ai) if i 2 J , j 2 K\nfij if i; j 2 K and i 6= j\n0 otherwise\n(25)\nwhere\nSi =\n\u0012\n1\u0000 \u0001\nM\n\u0013\nni +\nn[N ]\u0000 (n[N ]\u0000 n[I])\n\u0012\n1\u0000 \u0001\nM\n\u0013\n\u0000 a[I]\nm\u0000 jIj\nThe quantities fij are feasible nonnegative \rows on edges (i; j) of a complete directed\ngraph whose vertices correspond to indices in K, with a net supply of\nsi = ai \u0000\n\u0012\nni \u0000 n[K]jKj\n\u0013\u0012\n1\u0000 \u0001\nM\n\u0013\n\u0000 a[K]jKj\nat each vertex i. Such \rows exist because the net supply over all vertices is\nP\ni2K si = 0.\nWe \frst show that the linear combination\nP\ni \u000bi(ki) +\nP\nij \fij`ij is the inequality\nz \u0014 au + (n[N ] \u0000 1)\u0001, given that Pi ai = n[N ]. It is easily checked that Pi \u000bi = 1,\nso that the linear combination has the form z \u0014 du+ (n[N ]\u0000 1)\u0001. It remains to show\nthat d = a. We have\ndi =\n0@ni + \u0001\nM\nX\nj 6=i\nnj\n1A\u000bi + ni\u00121\u0000 \u0001\nM\n\u0013X\nj 6=i\n\u000bj +\nX\nj 6=i\n(\fji \u0000 \fij) (26)\n23\nUsing the fact that\nP\nj \u000bj = 1, this implies\ndi =\n\u0001\nM\nn[N ]\u000bi + ni\n\u0012\n1\u0000 \u0001\nM\n\u0013\n+\nX\nj 6=i\n(\fji \u0000 \fij) (27)\nWhen i 2 I, each \fij = 0, and we get from (27) that di = ai. When i 2 J , (27) becomes\ndi = Si \u0000\nX\nj2K\n1\njKj (Si \u0000 ai) = ai\nWhen i 2 K, (27) becomes\ndi = Si +\nX\nj2J\n1\njKj (Sj \u0000 aj) +\nX\nj2Knfig\n(fji \u0000 fij)\n=\njKjSi + S[K]\u0000 a[J ]\njKj +\nX\nj2Knfig\n(fji \u0000 fij)\nUsing the de\fnition of Si and the fact that n[N ] = a[I] + a[J ] + a[K], this becomes\ndi =\n\u0012\n1\u0000 \u0001\nM\n\u0013\nni \u0000 1jKj\n\u0012\n(n[N ]\u0000 n[I]\u0000 n[J ])\n\u0012\n1\u0000 \u0001\nM\n\u0013\n\u0000 a[K]\n\u0013\n+\nX\nj2Knfig\n(fji \u0000 fij)\nUsing the fact that n[N ] = n[I] + n[J ] + n[K], this simpli\fes to\ndi =\n\u0012\n1\u0000 \u0001\nM\n\u0013\u0012\nni \u0000 n[K]jKj\n\u0013\n+\na[K]\njKj +\nX\nj2Knfig\n(fji \u0000 fij)\n= ai \u0000 si +\nX\nj2Knfig\n(fji \u0000 fij)\n(28)\nBecause the summation is just the net supply si at node i, this yields di = ai, as desired.\nWe conclude that z \u0014 au + (n[N ] \u0000 1)\u0001 is the linear combination Pi \u000bi(ki) +P\nij \fij`ij . Since b \u0015 (n[N ]\u0000 1)\u0001, z \u0014 au+ b is dominated by a surrogate of (24) and\ntherefore implied by (19), provided we show that the multipliers in (25) are nonnegative.\nWe observe \frst that \u000bi \u0015 0 for i 2 I because ai \u0015 ni(1 \u0000 \u0001=M), due to the\nde\fnition of I. To show that \u000bi \u0015 0 for i 62 I, we note that ai \u0014 ni for i 2 I implies\n\u000bi \u0014 1=n[N ], from the de\fnition of \u000bi. Thus \u000b(I) \u0014 1, which implies \u000bi \u0015 0 for i 62 I.\nTo show that \fij \u0015 0 for i 2 J and j 2 K, we note that ai \u0014 ni for i 2 I implies that\na[I] \u0014 n[I], whence\nSi \u0015\n\u0012\n1\u0000 \u0001\nM\n\u0013\nni +\nn[N ]\u0000 n[I]\nm\u0000 jIj \u0015 ai +\nn[N ]\u0000 n[I]\nm\u0000 jIj \u0015 ai (29)\n24\nwhere the second inequality is due to the fact that ai < (1 \u0000 \u0001=M)ni for i 2 J . But\n(29) and the de\fnition of \fij imply that \fij \u0015 0 for i 2 J and j 2 K. Finally, \fij = fij\nfor i; j 2 K is by de\fnition a nonnegative \row.\nReferences\nD. Bertsimas, V. F. Farias, and N. Trichakis. The price of fairness. Operations Research,\nto appear.\nK. Binmore. Natural Justice. Oxford University Press, 2005.\nC. Blackorby, W. Bossert, and D. Donaldson. Utilitarianism and the theory of justice. In\nK. Arrow, A. Sen, and K. Suzumura, editors, Handbook of Social Choice and Welfare,\nVol. 1, volume 19 of Handbooks in Economics, pages 543{596. Elsevier, Amsterdam,\n2002.\nA. Briggs and A. Gray. Using cost e\u000bectiveness information. British Medical Journal,\n320:246, 2000.\nJ. Broome. Fairness and QALYs. Philosophy and Medical Welfare, 3:57{73, 1988.\nN. Daniels. Reading Rawls: Critical Studies on Rawls' \\A Theory of Justice\". Stanford\nUniversity Press, 1989.\nP. Dolan. The measurement of individual utility and social welfare. Journal of Health\nEconomics, 17:39{52, 1998.\nR. Dworkin. Taking Rights Seriously. Harvard University Press, Cambridge, MA, 1977.\nR. W. Evans, D. L. Manninen, L. P. Garrison, L. G. Hart, C. R. Blagg, R. A. Gutman,\nA. R. Hill, and E. G. Lowrie. The quality of life of patients with end-stage renal\ndisease. New England Journal of Medicine, 312:553{559, 1985.\nW. Gaertner. A Primer in Social Choice Theory. Oxford University Press, Cambridge,\nMA, 2009.\nN. G. Hall and R. V. Vohra. Towards equitable distribution via proportional equity\nconstraints. Mathematical Programming, 58:287{294, 1993.\nJ. N. Hooker. A principled approach to mixed integer\/linear problem formulation. In\nJ. W. Chinneck, B. Kristjansson, and M. Saltzman, editors, Operations Research and\nCyber-Infrastructure (ICS 2009 Proceedings), pages 79{100. Springer, 2009.\n25\nJ. N. Hooker. Optimality conditions for distributive justice. International Transactions\nin Operational Research, 17:485{505, 2010.\nR. G. Jeroslow. Representability in mixed integer programming, I: Characterization\nresults. Discrete Applied Mathematics, 17:223{243, 1987.\nR. G. Jeroslow. Mixed Integer Formulation, volume 40 of Logic-Based Decision Support.\nNorth-Holland, Amsterdam, 1989.\nF. P. Kelly, A. K. Maulloo, and D. K. H. Tan. Rate control in communication net-\nworks: Shadow prices, proportional fairness and stability. Journal of the Operational\nResearch Society, 49:237{252, 1999.\nH. Luss. On equitable resource allocation problems: A lexicographic minimax approach.\nOperations Research, 47:361{378, 1999.\nR. Mazumdar, L. Mason, and C. Douligeris. Fairness in network optimal \row control:\nOptimality of product forms. IEEE Transactions on Communications, 39:775{782,\n1991.\nD. Nace and M. Pioro. Max-min fairness and its applications to routing and load-\nbalancing in communication networks: A tutorial. IEEE Communications Surveys\n& Tutorials, 10:5{17, 2008.\nNHS. National Institute for Health and Clinical Excellence (NICE) Website, National\nHealth Service, United Kingdom, 2010. http:\/\/www.nice.org.uk\/.\nNKUDIC. Kidney and Urologic Diseases Statistics for the United States.\nNational Kidney and Urologic Diseases Information Clearing House, 2010.\nhttp:\/\/kidney.niddk.nih.gov\/kudiseases\/pubs\/kustats\/.\nW. Ogryczak. On the lexicographic minimax approach to location problems. European\nJournal of Operational Research, 100:218{223, 1997.\nJ. Rawls. A Theory of Justice. Oxford University Press, 1972.\nJ. E. Roemer. Theories of Distributive Justice. Harvard University Press, Cambridge,\nMA, 1998.\nA. Sen and B. Williams, editors. Utilitarianism and Beyond. Cambridge University\nPress, 1982.\nM. S. Stein. Distributive Justice and Disability: Utilitarianism against Egalitarianism.\nStanford University Press, 2006.\n26\nA. A. Stinnett and A. D. Paltiel. Mathematical programming for the e\u000ecient allocation\nof health resources. Journal of Health, 15:641{653, 1995.\nL. S. Tempkin. Inequality. Oxford University Press, 1993.\nTufts Medical Center. CEA Registry. Center for the Evaluation of Value and\nRisk in Health, Institute for Clinical Research and Health Policy Studies, 2010.\nhttps:\/\/research.tufts-nemc.org\/cear\/.\nA. Williams. Economics of coronary artery bypass grafting. British Medical Journal,\n291:326{329, 1985.\nA. Williams and R. Cookson. Equity in health. In A. J. Culyer and J. P. Newhouse,\neditors, Handbook of Health Economics. Elsevier Science, 2000.\nA. Williams and R. Cookson. Equity-e\u000eciency trade-o\u000bs in health technology assess-\nment. International Journal of Technology Assessment in Health Care, 22:1{9, 2006.\nH. P. Williams. Logic and Integer Programming. Springer, Berlin, 2009.\nM. E. Yaari and M. Bar-Hillel. On dividing justly. Social Choice and Welfare, 1:1{24,\n1984.\nH. P. Young. Equity in Theory and Practice. Princeton University Press, 1995.\n27\n"}