{"doi":"10.1016\/j.jprocont.2006.03.003","coreId":"141007","oai":"oai:dspace.lib.cranfield.ac.uk:1826\/1130","identifiers":["oai:dspace.lib.cranfield.ac.uk:1826\/1130","10.1016\/j.jprocont.2006.03.003"],"title":"Nonlinear model predictive control for the ALSTOM gasifier.","authors":["Al Seyab, Rihab Khalid Shakir","Cao, Yi"],"enrichments":{"references":[{"id":37923579,"title":"A case study of predictive control for the ALSTOM gasi\ufb01er problem\u201d. Control","authors":[],"date":"2004","doi":"10.1049\/ip-cta:20050049","raw":"Al Seyab R. K., Cao Y., and Yang S. H., \u201dA case study of predictive control for the ALSTOM gasi\ufb01er problem\u201d. Control 2004, University of Bath, UK, 2004. 24[24] R. Dixon and A. W. Pike, \u201cIntroduction to the 2ND ALSTOM benchmark challenge on gasi\ufb01er control \u201d, Control 2004, University of Bath, UK, 2004.","cites":null},{"id":37923567,"title":"A global solution to the nonlinear predictive control algorithms using polynomial ARX models\u201d,","authors":[],"date":"1997","doi":"10.1016\/s0098-1354(96)00279-7","raw":"Sriniwas G. R. and Arkun Y. , \u201cA global solution to the nonlinear predictive control algorithms using polynomial ARX models\u201d, Comput. Chem. Eng., vol. 21, pp. 431\u2013439, 1997.","cites":null},{"id":37923572,"title":"Advanced gasi\ufb01er control,\u201d","authors":[],"date":"1999","doi":"10.1049\/cce:19990301","raw":"R. Dixon, \u201cAdvanced gasi\ufb01er control,\u201d IEE Computing and Control Engineering Journal, vol. 10, no. 3, pp. 93\u201396, 1999.","cites":null},{"id":37923577,"title":"Alstom benchmark challenge ii: Control of a nonlinear gasi\ufb01er model,\u201d available from http:\/\/www.iee.org\/OnComms\/PN\/controlauto\/Speci\ufb01cation v2.pdf,","authors":[],"date":"2002","doi":null,"raw":"R. Dixon, \u201cAlstom benchmark challenge ii: Control of a nonlinear gasi\ufb01er model,\u201d available from http:\/\/www.iee.org\/OnComms\/PN\/controlauto\/Speci\ufb01cation v2.pdf, 2002.","cites":null},{"id":37923575,"title":"An advanced predictive control approach to the ALSTOM gasi\ufb01er problem,\u201d","authors":[],"date":"2000","doi":"10.1243\/0959651001540762","raw":"M. Rice, J. Rossiter, and J. Schurmans, \u201cAn advanced predictive control approach to the ALSTOM gasi\ufb01er problem,\u201d Proc. IMechE Part I, Journal of Systems and Control Engineering, vol. 214, pp. 405\u2013413, 2000.","cites":null},{"id":37923570,"title":"An identi\ufb01cation approach to nonlinear state space model for industrial multivariable model predictive control\u201d,","authors":[],"date":"1998","doi":"10.1109\/acc.1998.703517","raw":"Zhao H., Guiver J., and Sentoni G., \u201cAn identi\ufb01cation approach to nonlinear state space model for industrial multivariable model predictive control\u201d, Proceeding of the American Control Conference, Philadelphia, Pennsylvania, 1998.","cites":null},{"id":37923564,"title":"Arti\ufb01cial neural networks for nonlinear process identi\ufb01cation and control\u201d,","authors":[],"date":"1997","doi":null,"raw":"Su H. T. and McAvoy (1997), \u201cArti\ufb01cial neural networks for nonlinear process identi\ufb01cation and control\u201d, In: Henson, M. A. & Seborg, D.E. (Eds). \u201cNonlinear Process Control\u201d, Chap. 7, pp. 371\u2013428, Englewood Cliffs, NJ: Prentice\u2013Hall.","cites":null},{"id":37923581,"title":"Industrial application of a nonlinear model predictive control to polymerization reactors\u201d,","authors":[],"date":"2001","doi":"10.1016\/s0967-0661(01)00046-6","raw":"Seki H., Ogawa M., Ooyama S., Akamatsu K., Ohshima M., and Yang W., \u201cIndustrial application of a nonlinear model predictive control to polymerization reactors\u201d, Control Engineering Practice, vol. 9, pp. 819\u2013828, 2001.","cites":null},{"id":37923558,"title":"Linear and nonlinear model predictive controldesignforamilkpasteurizationplant\u201d,","authors":[],"date":"2003","doi":null,"raw":"Khadir M. T. and Ringwood J. V., \u201cLinear and nonlinear model predictive controldesignforamilkpasteurizationplant\u201d, ControlandIntelligentSystems, vol. 31, pp. 1\u20138, 2003.","cites":null},{"id":37923562,"title":"Model predictive control based on Wiener models\u201d,","authors":[],"date":"1998","doi":"10.1016\/s0009-2509(97)00195-4","raw":"Norquay S. J., Palazoglu A., and Romagnoli J. A., \u201cModel predictive control based on Wiener models\u201d, Chemical Engineering Science, vol. 53(1), pp. 75-84, 1998. 22[8] Brengle D. D. and W. D. Seider., \u201cMultistep nonlinear predictive controller\u201d, Ind. Eng. Chem. Res., vol. 28, pp. 1812\u20131822, 1989.","cites":null},{"id":37923582,"title":"Multivariable PID\u2013controller design for a gasi\ufb01er plant using penality\u2013based\u2013multi\u2013objective GA\u201d, Control","authors":[],"date":"2004","doi":null,"raw":"Farag A. and Werner H., \u201cMultivariable PID\u2013controller design for a gasi\ufb01er plant using penality\u2013based\u2013multi\u2013objective GA\u201d, Control 2004, University of Bath, UK, 2004.","cites":null},{"id":37923568,"title":"Nonlinear adaptive generalized predictive control and applications \u201d, Advances in model-based predictive control,","authors":[],"date":"1994","doi":null,"raw":"Dumont G., Fu Y., and Lu G., \u201dNonlinear adaptive generalized predictive control and applications \u201d, Advances in model-based predictive control, Oxford University Press, Oxford, 1994.","cites":null},{"id":37923566,"title":"Nonlinear model predictive control of a simulated multivariable polymerization reactor using second\u2013order Volterra models\u201d,","authors":[],"date":"1996","doi":"10.1016\/0005-1098(96)00086-6","raw":"Maner B. R., Doyle F. J., Ogunnaike B. A., and Pearson R. K., \u201cNonlinear model predictive control of a simulated multivariable polymerization reactor using second\u2013order Volterra models\u201d, Automatica, vol. 32, pp. 1285\u20131301, 1996.","cites":null},{"id":37923563,"title":"Nonlinear model predictive control of packed distillation column\u201d,","authors":[],"date":"1993","doi":"10.1021\/ie00022a018","raw":"Patwardhan A. A. and Edgar T. F., \u201cNonlinear model predictive control of packed distillation column\u201d, Ind. Eng. Chem. Res., vol. 32, pp. 2345\u20132356, 1993.","cites":null},{"id":37923556,"title":"Nonlinear model predictive control using neural networks\u201d.","authors":[],"date":"2000","doi":"10.1109\/37.845038","raw":"Piche S., Sayyar-Rodsari B., Johnson D., and Gerules M., \u201cNonlinear model predictive control using neural networks\u201d. IEEE Control System Magazine, vol. 20(3), pp. 53\u201362, 2000.","cites":null},{"id":37923559,"title":"Nonlinear quadratic dynamic matrix control with state estimation\u201d,","authors":[],"date":"1992","doi":"10.1021\/ie00004a018","raw":"Gattu G. and Za\ufb01riou E., \u201cNonlinear quadratic dynamic matrix control with state estimation\u201d, Indus. Eng. Chem. Res., vol. 31, pp. 1096\u20131104, 1992.","cites":null},{"id":37923583,"title":"P.,\u201cImproving the performance of the ALSTOM baseline controller using multiobjective optimisation\u201d, Control","authors":[],"date":"2004","doi":"10.1049\/ip-cta:20050131","raw":"Simm A. and Liu G. P.,\u201cImproving the performance of the ALSTOM baseline controller using multiobjective optimisation\u201d, Control 2004, University of Bath, UK, 2004. 25List of Figures 1 Nonlinear internal model. . . . . . . . . . . . . . . . . . . . . . . 27 2 Gasi\ufb01er Schematic [24]. . . . . . . . . . . . . . . . . . . . . . . 28 3 Open\u2013loop response of the ALSTOM gasi\ufb01er for a +20% step change in the air \ufb02owrate . . . . . . . . . . . . . . . . . . . . . . 29 4 Open-loop response of gas pressure at 0% load condition to a step change in WAIR. Plant output (solid), Wiener model (dashed), linear model (dotted). . . . . . . . . . . . . . . . . . . . . . . . . . 30 5 Validation data, plant output (solid), Wiener model (dashed), linear model (dotted) : (a) 0% load, (b) 50% load, (c) 100% load. . . . . 31 6 Open-loopoutputresponsetoastepdisturbanceat30sat0%(solid), 50% (dashed) and 100% (dash-dotted) load conditions. . . . . . . 32 7 Thegasi\ufb01erresponseat50%loadcondition, NMPC(solid), LMPC (dotted). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33 8 The gasi\ufb01er response at 0% load condition, NMPC (solid), LMPC (dotted). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34 9 The gasi\ufb01er response at setpoint ramp test, NMPC (solid), setpoint (dashed), LMPC (dotted). (a)\u2013(d) Outputs, (e)\u2013(f) Inputs and limits. 35 26CVGAS MASS, TGAS Partial nonlinear Static Model Linear Dynamic Model ) (k u ) (k x ) (k yNL ) (k L y L C PGAS , A B NN f","cites":null},{"id":37923557,"title":"Predictive control with constraints\u201d,","authors":[],"date":"2002","doi":"10.1109\/cacsd.2002.1036925","raw":"Maciejowski J. M., \u201cPredictive control with constraints\u201d, Prentice Hall, Harlow, England, 2002.","cites":null},{"id":37923560,"title":"Recon\ufb01guration and scheduling in \ufb02ight using quasi\u2013LPV high\u2013\ufb01delity models and MBPC control\u201d,","authors":[],"date":"1998","doi":"10.1109\/acc.1998.703294","raw":"Huzmezan M. and Maciejowski J. M., \u201cRecon\ufb01guration and scheduling in \ufb02ight using quasi\u2013LPV high\u2013\ufb01delity models and MBPC control\u201d, In Proc. American Control Conference, Philadelphia, 1998.","cites":null},{"id":37923555,"title":"Selecting nonlinear model structures for computer control: review\u201d,","authors":[],"date":"2003","doi":"10.1016\/s0959-1524(02)00022-7","raw":"Pearson R. K., \u201cSelecting nonlinear model structures for computer control: review\u201d, Journal of Process Control, vol. 13, pp. 1-26, 2003.","cites":null},{"id":37923565,"title":"State\u2013space nonlinear process modelling\u201d,","authors":[],"date":"1998","doi":"10.1002\/aic.690441011","raw":"Sentoni G. B., Biegler L. T., Guiver J. B., and Zhao H., \u201cState\u2013space nonlinear process modelling\u201d, AIChE J., vol. 44(10), pp. 2229\u20132239, 1998.","cites":null},{"id":37923574,"title":"The ALSTOM benchmark challenge on gasi\ufb01er control,\u201d","authors":[],"date":"2000","doi":"10.1243\/0959651001540744","raw":"R. Dixon, A. Pike, and M. Donne, \u201cThe ALSTOM benchmark challenge on gasi\ufb01er control,\u201d Proc. IMechE Part I, Journal of Systems and Control Engineering, vol. 214, pp. 389\u2013394, 2000.","cites":null},{"id":37923569,"title":"Use of multilayer feedforward neural network in identi\ufb01cation and control of Wiener model\u201d,","authors":[],"date":"1996","doi":"10.1049\/ip-cta:19960376","raw":"Al\u2013Duwaish H., Karim M. N., and Chandrasekar V., \u201cUse of multilayer feedforward neural network in identi\ufb01cation and control of Wiener model\u201d, IEE Proc\u2013Control Theory Appl., vol. 143(3), pp. 255\u2013258, 1996. 23[16] Cervantes A. L.,Agamennoni O. E., and Figueroa J. L., \u201dA nonlinear model predictive control system based on Wiener piecewise linear models\u201d, Journal of Process Control, vol. 13, pp. 655\u2013666, 2003.","cites":null},{"id":37923580,"title":"Use of neural nets for dynamic modeling and control of chemical process systems\u201d,","authors":[],"date":"1990","doi":"10.1016\/0098-1354(90)87028-n","raw":"Behat N. and McAvoy, \u201cUse of neural nets for dynamic modeling and control of chemical process systems\u201d, Computers Chem. Engng., vol. 14(4-5), pp. 573\u2013582, 1990.","cites":null},{"id":37923571,"title":"Wiener model based nonlinear predictive control\u201d,","authors":[],"date":"2000","doi":"10.1080\/002077200291307","raw":"Gerksic S., Juricic D., Strmcnik S., and Matko D., \u201cWiener model based nonlinear predictive control\u201d, International Journal of Systems Science, vol. 31(2), pp. 189\u2013202, 2000.","cites":null}],"documentType":{"type":0.8888888889}},"contributors":[],"datePublished":"2006-09-01T00:00:00Z","abstract":"In this work a nonlinear model predictive control based on Wiener model has been\ndeveloped and used to control the ALSTOM gasifier. The 0% load condition was\nidentified as the most difficult case to control among three operating\nconditions. A linear model of the plant at 0% load is adopted as a base model\nfor prediction. A nonlinear static gain represented by a feedforward neural\nnetwork was identified for a particular output channel\u2014namely, fuel gas\npressure, to compensate its strong nonlinear behaviour observed in open-loop\nsimulations. By linearising the neural network at each sampling time, the static\nnonlinear model provides certain adaptation to the linear base model at all\nother load conditions. The resulting controller showed noticeable performance\nimprovement when compared with pure linear model based predictive contr","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/141007.pdf","fullTextIdentifier":"http:\/\/dx.doi.org\/10.1016\/j.jprocont.2006.03.003","pdfHashValue":"95ea697bc25c7cf61eefcc1914bd272dc1fef5ae","publisher":"Elsevier Science B.V., Amsterdam.","rawRecordXml":"<record><header><identifier>\noai:dspace.lib.cranfield.ac.uk:1826\/1130<\/identifier><datestamp>2011-11-14T12:49:06Z<\/datestamp><setSpec>hdl_1826_19<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>Nonlinear model predictive control for the ALSTOM gasifier.<\/dc:title><dc:creator>Al Seyab, Rihab Khalid Shakir<\/dc:creator><dc:creator>Cao, Yi<\/dc:creator><dc:subject>Predictive control<\/dc:subject><dc:subject>Gasification<\/dc:subject><dc:subject>Wiener model<\/dc:subject><dc:subject>Feedforward neural networks<\/dc:subject><dc:subject>Linearisation<\/dc:subject><dc:description>In this work a nonlinear model predictive control based on Wiener model has been\ndeveloped and used to control the ALSTOM gasifier. The 0% load condition was\nidentified as the most difficult case to control among three operating\nconditions. A linear model of the plant at 0% load is adopted as a base model\nfor prediction. A nonlinear static gain represented by a feedforward neural\nnetwork was identified for a particular output channel\u2014namely, fuel gas\npressure, to compensate its strong nonlinear behaviour observed in open-loop\nsimulations. By linearising the neural network at each sampling time, the static\nnonlinear model provides certain adaptation to the linear base model at all\nother load conditions. The resulting controller showed noticeable performance\nimprovement when compared with pure linear model based predictive contro<\/dc:description><dc:publisher>Elsevier Science B.V., Amsterdam.<\/dc:publisher><dc:date>2011-11-13T23:31:04Z<\/dc:date><dc:date>2011-11-13T23:31:04Z<\/dc:date><dc:date>2006-09-01T00:00:00Z<\/dc:date><dc:type>Article<\/dc:type><dc:identifier>R.K. Al Seyab and Y. Cao, Nonlinear model predictive control for the ALSTOM\ngasifier, Journal of Process Control, Volume 16, Issue 8, September 2006, Pages\n795-808.<\/dc:identifier><dc:identifier>0959-1524<\/dc:identifier><dc:identifier>http:\/\/dx.doi.org\/10.1016\/j.jprocont.2006.03.003<\/dc:identifier><dc:identifier>http:\/\/dspace.lib.cranfield.ac.uk\/handle\/1826\/1130<\/dc:identifier><dc:language>en_UK<\/dc:language><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["issn:0959-1524","0959-1524"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2006,"topics":["Predictive control","Gasification","Wiener model","Feedforward neural networks","Linearisation"],"subject":["Article"],"fullText":"NONLINEAR MODEL PREDICTIVE CONTROL\nFOR THE ALSTOM GASIFIER\nR K Al Seyab\u2021 Y Cao\u2021\u2217\n\u2021Cranfield University, UK\nKeywords: : Predictive control, Gasification, Wiener model, Feedforward neural\nnetworks, Linearisation.\nAbstract\nIn this work a nonlinear model predictive control based on Wiener model\nhas been developed and used to control the ALSTOM gasifier. The 0% load\ncondition was identified as the most difficult case to control among three op-\nerating conditions. A linear model of the plant at 0% load is adopted as a\nbase model for prediction. A nonlinear static gain represented by a feedfor-\nward neural network was identified for a particular output channel\u2013namely,\nfuel gas pressure, to compensate its strong nonlinear behaviour observed in\nopen-loop simulations. By linearising the neural network at each sampling\ntime, the static nonlinear model provides certain adaptation to the linear base\nmodel at all other load conditions. The resulting controller showed notice-\nable performance improvement when compared with pure linear model based\npredictive control.\n\u2217To whom correspondence should be addressed (y.cao@cranfield.ac.uk).\n1 Introduction\nModel predictive control (MPC) has become a first choice of control strategy in\nindustry because it is intuitive and can explicitly handle multivariable systems with\nconstraints. The basic control strategy in MPC is the selection of a set of future\ncontrol moves (control horizon) and minimise a cost function based on the desired\noutput trajectory over a prediction horizon with a chosen length. This requires a\nreasonably accurate internal model, that captures the essential nonlinearities of the\nprocess under control and predict the dynamic behaviour multi\u2013step ahead [1].\nUntil recently, industrial applications of MPC have relied on linear dynamic\nmodels even though most processes are nonlinear. Linear MPC (LMPC) is prob-\nably acceptable and sometime desirable when the process operates at a single set-\npoint and the primary use of the controller is the rejection of small disturbances [2].\nIf the plant exhibits severe nonlinearities, the usefulness of MPC based on a linear\nmodel is limited, particularly if it is used to transfer the plant from one operating\npoint to another as in the case under study. The obvious solution is to use a non-\nlinear model. However, the extension to nonlinear model based predictive control\nhas not been always very successful. The main hurdle facing this extension is the\nsignificant computational burden associated with solving a set of nonlinear differ-\nential equations and a nonlinear dynamic optimisation problem online. In addition,\nthe convexity of the optimisation problem in this case is not guaranteed, which is a\nserious drawback for online applications [3].\nA number of researchers have developed NMPC approaches based on a lin-\nearisation of the plant model for the prediction phase. In this solution, the model\nequations are linearised around the operating point and solved within an efficient\nconvex optimisation method to obtain the optimum control step. The linearisation\nstep is performed once over the prediction horizon [3, 4], or further at a number\nof time steps inside the prediction horizon [5, 6]. This strategy has proved to be\n2\nhighly successful in controlling mildly nonlinear processes [7].\nThe internal model in NMPC can be based on the physical laws governing the\nbehaviour of the true system and often referred to as a first-principle model [8, 9].\nAlternatively the model is derived from measurements of input and output data\nfrom the real plant. This method relies heavily on system identification and the\nresulting model is called an empirical or black\u2013box model [10, 11]. First-principle\nmodels are valid globally and can predict system dynamics over the entire oper-\nating range. The development of a reliable first-principle model is, in general, a\ndifficult and time consuming task. The nonlinear black-box models, on the other\nhand, have certain advantages over the first-principle models in terms of develop-\nment time and efforts. If chosen wisely, it can simplify and accelerate the controller\nas well.\nThere are many different black-box nonlinear models utilised for NMPC in-\nclude: Volterra models [12], Polynomial autoregressive moving average model\nwith exogenous inputs (polynomial ARMAX) [13], Hammerstein and Wiener type\nmodels [14, 15, 7, 16], artificial neural networks [10], and others. Among these\ntypes of models Hammerstein and Wiener models have a special structure that\nfacilitates their application to NMPC. Wiener model is particularly useful in rep-\nresenting the nonlinearities of process without introducing the complications as-\nsociated with general nonlinear operators [7, 16]. This model consists of a linear\ndynamic element followed in series by a static nonlinear element. Hammerstein\nmodel contains the same elements in the reverse order.\nThese models have been shown to adequately represent many of the nonlin-\nearities commonly encountered in industrial processes such as distillation and pH\nneutralisation [17]. Wiener models may be incorporated into MPC schemas in a\nunique way which effectively removes the nonlinearity from the control problem,\npreserving many of the favourable properties of linear MPC [15, 7, 18, 16].\n3\nAn approach of identification and control using a Wiener model was proposed\nby Al Duwaish et al [15]. The authors proposed a Wiener model consisting of an\nautoregressive moving average (ARMA) model as a linear dynamic model in cas-\ncade with a multi-layer feedforward neural network (FFNN). A controller using\nthe Wiener model is constructed by inserting the inverse nonlinearity of the FFNN\nin an appropriate loop location. The inverse of the static nonlinearity is modelled\nby another FFNN. A linear controller was designed for the ARMA model using\nlinear control theory. Norquay et al [7] proposed another system identification and\nmodel predictive control approach using Wiener model. Two linear models were\nchosen for the linear dynamic element of the Wiener model: autoregressive with\nexogenous (ARX) model and the step-response model. While a low-order piece-\nwise polynomial is used for the nonlinear static element of the model. The model\nis incorporated into an unconstrained LMPC algorithm by removing the nonlinear\nelement from the control problem via using a static inverse nonlinearity. A similar\nNMPC approach is proposed in [18] but with input and output constraints. The\nnonlinear constraints of the outputs were linearised using the inverse static nonlin-\nearity in that work.\nRecently, Cervantes et al [16] presented a Wiener model based NMPC ap-\nproach with an invertible piecewise linear gain. The inverse of the piecewise lin-\near function is used to map the setpoint, output upper and lower bounds, and the\nmeasured outputs so that linear relationship is retained with these signals. Then\na quadratic programming (QP) routine is used to solve the optimisation problem\nonline.\nIn this paper, another Wiener model based NMPC approach is developed to\ncontrol the ALSTOM gasifier. A Wiener structure consisting of a linear multi-input\nmulti-output (MIMO) state-space part followed by a partially nonlinear static part\nis used to identify a black-box model of the gasifier plant. By linearising the static\n4\npart of Wiener model at each optimisation step, the nonlinear model becomes linear\nand the NMPC is simplified to a classical LMPC which keeps computation easier\nto perform.\nThe rest of this paper is organised as follows. Section 2 gives an introduction\nto the ALSTOM gasifier benchmark problem and an overview of the work. A short\ndescription of the nonlinear plant is presented in section 3. Section 4 discusses\nthe partially nonlinear internal model. The formulation used for model predictive\ncontrol is provided in section 5. Section 6 explains the procedures of nonlinear\nsystem identification and controller design for the gasifier. Section 7 presents the\nsimulation results, and in section 8 some conclusions are drawn from this work.\n2 The ALSTOM Gasifier\nThe coal gasifier is essentially a chemical reactor where coal reacts with air and\nsteam to produce low calorific value fuel gas, which then can be burnt in a suitably\nadapted gas turbine, and char. Limestone (sorbent) is also added to the vessel to\ncapture the majority of sulphur present in the coal [19]. In modern advanced power\ngenerating plants gasification helps burning coal in a new and environmentally\nfriendly process.\nThe ALSTOM gasifier was issued as a benchmark problem by the ALSTOM\nPower Technology Centner [20]. This process involves several challenging issues,\nsuch as high order, high nonlinearity and strong interactions between process vari-\nables. Furthermore, this process has very stringent upper, lower and rate constraints\non the process input and output variables because of safety and environmental is-\nsues and the physical nature of the variables themselves.\nBased on an industrial scale gasifier, the ALSTOM Power Technology Centner\nissued a benchmark challenge in 1997 and a second round challenge in 2002. The\n5\nfirst challenge included three linear models representing three operating conditions\nof the gasifier at 0%, 50% and 100% load respectively. The challenge required the\ncontroller to control the gasifier at three load conditions to satisfy input and output\nconstraints in the presence of step and sinusoidal disturbances (see Ref. [20]). An\noverview and comparison of various control approaches submitted to the first round\nchallenge are given in [19].\nNone of the controllers proposed in the first round managed to satisfy all the\nperformance criteria within specified constraints. The only MPC approach [21]\nproposed at the first round challenge involved the use of a LMPC with an additional\ninner loop to stabilise the process. The inner loop controller is supervised by an\nouter loop to handle the process constraints.\nThe second round of the challenge issued in 2002 extended the original prob-\nlem by providing participants with a nonlinear simulation model of the gasifier in\nMATLAB\/SIMULINK [22]. In addition to the original disturbance tests, two extra\ntests: load change and coal quality disturbance tests were added. Recently, a group\nof control solutions for the benchmark problem were presented at \u201cControl-2004\u201d\nat Bath University, UK in September 2004. Most controllers were reported as capa-\nble to control the system in the specified tests except in the coal quality disturbance\ntest because of a char flow rate saturation behaviour. Among the solutions, a lin-\near MPC employing Generalised Predictive Control (GPC) strategy was proposed\n[23].\nIn the previous work [23], the operating condition at 0% load point was consid-\nered to be the most difficult case to control and a linearised model around this load\ncondition was adopted for the internal model. The controller was able to maintain\nall the required performance specifications within the input and output constraints\nat all load conditions. In this work, it is shown that the plant\/model mismatch can\nfurther be reduced by developing a partially nonlinear Wiener type model instead\n6\nof a pure linear model. More specifically, a FFNN is developed as a nonlinear static\ngain for one of four output channels, fuel gas pressure (PGAS) to compensate its\nstrong nonlinear behaviour observed in the open loop simulation (see Figure 1).\nThe FFNN was then linearised at every sampling instance and used as constant\nover the prediction horizon to provide an adaptation to the main linear controller.\nA similar strategy can be used for the other output variables but this was found\nneither necessary nor very productive. The partially nonlinear model leads to con-\nsiderable performance improvement compared with the pure linear MPC. Also, the\nproposed controller was able to control the plant without any constraints violation\nand satisfied all the benchmark challenge requirements.\n3 Plant Description\nA schematic of the plant [24] is shown in Figure 2. The gasifier is a nonlinear,\nmultivariable system, having five controllable inputs (coal, limestone, air, steam\nand char extraction), and four outputs (pressure, temperature, bed\u2013mass and gas\nquality) with a high degree of cross coupling between them. One of its inputs, the\nlimestone feed (WLS) is used to absorb sulphur in the coal and its flow rate must\nbe set to a fixed ratio of 1:10 against the coal feed (WCOL). This leaves effectively\n4 degrees of freedom for the control design. The plant inputs and outputs with their\nlimits are given in Tables 1 and 2, respectively. The gasifier is open\u2013loop stable\nsystem, has a very complex dynamic behaviour with mixed fast and slow modes.\nAll the output variables take approximately 104 s to reach their steady\u2013state values\n(see Figure 3). On the other hand, the rising time for gas pressure (PGAS) is very\nshort comparing with other variables. The gasifier proved to be difficult to control\nas it is both multivariable and nonlinear with a significant cross\u2013coupling between\nthe input and output variables [20]. The full model of the gasifier has 25 states and\n7\nthe aim of the benchmark challenge is to design a controller to work with the given\nSIMULINK model as \u2018the plant\u2019 to satisfy the control performance. The control\nspecification includes sink pressure step and sinusoidal disturbance tests (at the\nthree different operating points), load ramp change from 50% to 100%, and coal\nquality change by \u00b118%. The specifications of these tests are given in details in\n[20].\n4 Internal model description\nIn this work, the original linear MPC design [23] is extended to include some\nof the plant nonlinearities by developing a static nonlinear model in the form of\nWiener configuration as shown in Figure 1. Linear static gains are used for three\noutputs, CVGAS, MASS, TGAS, while, a feedforward neural network model is\ncreated for the fourth output PGAS. The output selection is based on the open-loop\nstep response (within the prediction horizon length) comparison between the linear\nand nonlinear simulation model (see Figure 4). The results showed that the linear\nmodel can almost correctly capture the dynamic behaviour in three of the four\noutputs for up to 20 s (the prediction horizon length) under all load conditions.\nHowever, the fourth output PGAS exhibits salient nonlinearities which cannot be\npredicted by the linear model. It is also observed that the effect of the unmeasured\ndisturbance PSINK on the output variable PGAS is quite large, whilst the time\nconstant of the response is very short compared to that of other outputs.\nAssuming that the plant considered has manipulable input, u\u02dc \u2208 R4 and mea-\nsured output, y\u02dc \u2208 R4, which have steady-state values, u\u02dc0 and y\u02dc0 at the nominal\noperating point respectively. Around the operating point, the dynamic behaviour\nof the plant can be approximated by the following partially nonlinear discrete-time\n8\nstate-space equations:\nx(k + 1) = Ax(k) +Bu(k) (1)\nyL(k) = CLx(k)\nyNL(k) = fNN (x(k))\ny(k) =\n[\nyTL(k) yNL(k)\n]T\nwhere, k, stands for kth sampling time, u(k) = u\u02dc(k) \u2212 u\u02dc0, and y(k) =\ny\u02dc(k) \u2212 y\u02dc0, are deviation variables, and x(k), is the internal state of the model.\nOutputs are divided into two groups: yL(k) outputs vector corresponding to the\nlinear variables CVGAS, MASS and TGAS, and yNL(k) corresponding to non-\nlinear output, PGAS. The matrix CL represents the linear static gain, while fNN\nis the nonlinear function modelled by a neural network. Of course, other forms\nof nonlinear function may be used as the static gain. The choice of neural net-\nwork here is motivated by its ability to model any nonlinear function to any desired\naccuracy [10, 25].\nInitially, the plant is assumed to be at the nominal operating point with x(0) =\n0, u(0) = 0, y(0) = 0. The matrices A, B, and CL are obtained by linearising\nthe nonlinear plant model at 0% load condition. The neural network model consists\nof two hidden layers and one output layer. A FFNN with single layer is usually\nsufficient to capture the nonlinearity of the model for most applications. However,\nit was found that, for the gasifier case, a network with two layers was more capable\nto model the plant than a single layer network (see section 6.1 for more details).\nThe transfer function of the hidden layers is a sigmoid\u2013tanh nonlinear function\nwhile a linear transfer function is used for the output layer. The mathematical\n9\nform of the function fNN can be represented in a vector form as :\nO1 = \u03c3s(W 1x(k) + b1) (2)\nO2 = \u03c3s(W 2O1 + b2)\nyNL = W 3O2 + b3\nwhere O1, O2 and yNL are the output values of each layer. The values W 1, W 2,\nand W 3 are the weight parameters while b1, b2, and b3 are the bias parameters.\nThe function \u03c3s(\u00b7) is the sigmoid\u2013tanh function which is defined as,\n\u03c3s(n) =\n2\n1 + e\u22122n\n\u2212 1 (3)\nBecause the model in (1) is nonlinear, the convexity of the optimisation problem is\nnot guaranteed. In order to use efficient QP algorithm to solve the online optimisa-\ntion problem, local linearisation of the static FFNN model around the current states\nis performed. Future predictions of output based on current measurement yNL(k)\ncan be approximated by the first two terms of the Taylor series expansion:\nyNL(k + i) \u223c= nk +CNLx(k + i) for i = 1, . . . , P (4)\nwhere,\nnk = fNN (x)|x=x(k) \u2212CNLx(k) (5)\nCNL =\n\u2202fNN (x)\n\u2202x\n|x=x(k) (6)\nThe value of the function fNN (x) and the partial derivative \u2202fNN (x)\/\u2202x can\nbe efficiently calculated from the neural network structure in equation 2 using the\n10\nchain rule as:\n\u2202fNN\n\u2202x\n=W 3 diag(I \u2212O2OT2 )W 2 diag(I \u2212O1OT1 )W 1 (7)\nThis results in a time-varying linear state-space form to be used in the predictive\ncontroller. Note that, CNL is treated as constant over the entire prediction horizon\nfor an optimisation problem to be solved at each sampling time and updated only\nwhen new plant measurement available.\nThe static gain inversion method used by many researchers [15, 18, 7, 16] to\nlinearised the Wiener model is not applicable here as the model is partially nonlin-\near. To use this method the linear static gain (i.e. matrix CL) should be invertible\nwhich is not the case sinceCL is not square. On the other hand, the inverse neural\nnetwork should map one output to 16 states. Training such a network is not trivial.\nFor simplicity, the sequential linearisation approach is adopted here.\n5 Predictive control formulation\nThe prediction model to be used can be represented by the following state-space\nequation:\nx(k + 1) = Ax(k) +Bu(k) (8)\ny(k) = Cx(k) + d(k)\nwhere, y(k) = [yTL(k) yNL(k)]T , C = [C\nT\nL C\nT\nNL]\nT\n, and d(k) is the\nvirtual output disturbance estimated from the outputs measurement to reduce the\nplant-model mismatch. Note, the term nk in equation (4) is absorbed into d(k). At\nthe kth sampling time, with currently measured outputs, ym = y\u02dcm(k) \u2212 y\u02dc0, and\n11\nthe current states x(k), the future output within the prediction horizon, P can be\nestimated from the future input u(k) to be determined within the moving horizon,\nM as follows. Taking\nd(k + i) = dk = ym(k)\u2212Cx(k), for i = 1, . . . , P (9)\nthen\nY = \u03a6U +\u03a8x(k) +Ldk (10)\nwhere\nY =\n[\nyT (k + 1) \u00b7 \u00b7 \u00b7 yT (k + P )\n]T\nU =\n[\nuT (k) \u00b7 \u00b7 \u00b7 uT (k +M \u2212 1)\n]T\n\u03a6 =\n\uf8ee\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\nCB 0 \u00b7 \u00b7 \u00b7 0\nCAB CB \u00b7 \u00b7 \u00b7 0\n.\n.\n.\n.\n.\n. \u00b7 \u00b7 \u00b7 ...\nCAP\u22121B CAP\u22122B \u00b7 \u00b7 \u00b7 \u2211Pi=M CAP\u2212iB\n\uf8f9\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb\n\u03a8 =\n\uf8ee\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\nCA\n.\n.\n.\nCAP\n\uf8f9\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb\nL =\n[\nI \u00b7 \u00b7 \u00b7 I\n]T\nFuture input, U is determined to follow the output reference, yr(k), and the input\nreference ur(k) =H\u221210 (yr(k)\u2212dk), whereH0 = C(I \u2212A)\u22121B. Define input\n12\nand output reference vectors as\nY r =\n[\nyTr (k + 1) \u00b7 \u00b7 \u00b7 yTr (k + P )\n]T\nU r =\n[\nuTr (k) \u00b7 \u00b7 \u00b7 uTr (k +M \u2212 1)\n]T\nThen, U r =H(Y r \u2212Ldk), where\nH =\n\uf8ee\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\nH\u221210 0 \u00b7 \u00b7 \u00b7 0 0 \u00b7 \u00b7 \u00b7 0\n0 H\u221210 \u00b7 \u00b7 \u00b7 0 0 \u00b7 \u00b7 \u00b7 0\n.\n.\n.\n.\n.\n. \u00b7 \u00b7 \u00b7 ... ... \u00b7 \u00b7 \u00b7 ...\n0 0 \u00b7 \u00b7 \u00b7 H\u221210 0 \u00b7 \u00b7 \u00b7 0\n\uf8f9\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb\nThe optimisation problem is to minimize the performance cost:\nJ = 0.5(Y \u2212 Y r)TQ(Y \u2212 Y r) + 0.5(U \u2212U r)TR(U \u2212U r) (11)\ns.t. u \u2264 u \u2264 u\n|u(k + 1)\u2212 u(k)| \u2264 \u03b4u\nwhere, output and input weighting matrices, Q and R are positive definite and u,\nu and \u03b4u are the lower, upper and maximum rate bounds of the input respectively.\nUsing the predictive equation (10), the optimisation problem is equivalent to a\nstandard QP problem:\nJ = 0.5UTSU +UT (X1x(k)\u2212X2(Y r \u2212Ldk))\ns.t. U \u2264 U (12)\n\u2212U \u2264 \u2212U\nEU \u2264\u2206u + Fu(k \u2212 1)\n\u2212EU \u2264\u2206u \u2212 Fu(k \u2212 1)\n13\nwhere, u(k \u2212 1) is the previous input, and other variables are defined as follows:\nS = \u03a6TQ\u03a6+R\nX1 = \u03a6TQ\u03a8\nX2 = \u03a6TQ+RH\nU =\n[\nuT \u00b7 \u00b7 \u00b7 uT\n]T\nU =\n[\nuT \u00b7 \u00b7 \u00b7 uT\n]T\n\u2206u =\n[\n\u03b4Tu \u00b7 \u00b7 \u00b7 \u03b4Tu\n]T\nE =\n\uf8ee\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\nI 0 \u00b7 \u00b7 \u00b7 0 0\n\u2212I I \u00b7 \u00b7 \u00b7 0 0\n.\n.\n.\n.\n.\n. \u00b7 \u00b7 \u00b7 ... ...\n0 0 \u00b7 \u00b7 \u00b7 \u2212I I\n\uf8f9\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb\nF =\n[\nI 0 \u00b7 \u00b7 \u00b7 0\n]T\nNote, in the above formulation, output constraints are neglected to simplify the al-\ngorithm and to fully use the plant capability. The QP problem (12) is efficiently\nsolvable by off-the-shelf software. The only tunable parameters in the above for-\nmulation areQ,R, P , M and the sampling time. Thus, the control strategy can be\neasily implemented and tuned to satisfy required performance.\nIn vector U , only the first nu rows, corresponds to u(k) are applied to the\nplant. The whole procedure is repeated at the next sampling instance.\nIt should be noted here, the initial state vector required to solve the optimisation\nproblem at every sampling time is estimated by a state updated using the linear\ndynamic part of model (8). The remain estimation error is further corrected via\nthe output disturbance model dk where in the model nonlinearity is included (see\n14\nequation (9)). Note, this is a standard treatment in offset-free MPC and has been\nrecognised as a sufficient alternative of traditional state estimation approaches in\nMPC [26].\nFor the unconstrained case, the optimal solution, corresponding to a state feed-\nback control law, can be obtained analytically:\nU = \u2212K1x(k) +K2(yr \u2212 dk) (13)\nwhereK1 = S\u22121X1 andK2 = S\u22121X2. LetK be the first nu rows ofK1, then\nthe nominal stability (perfect model without input saturation) of the closed-loop\ncan be checked by calculating the eigenvalue of the matrix,A\u2212BK.\n6 Gasifier control using NMPC\n6.1 Nonlinear system identification\nThe first step to implement the above algorithm is to get an internal model in the\nform of (8). Three operating conditions are specified in the gasifier benchmark\nproblem: 0%, 50%, and 100% load conditions. The performance requirements\nat 50% and 100% load conditions were found relatively easier to achieve. It was\nthen decided to use the 0% load point as the nominal point to get the linearised\nstate space model. The resulting model was then reduced to 16 states via pole-zero\ncancellation (using Control System Toolbox functions, ssbal and minreal).\nThe 16 states model is discretized with the sampling time selected.\nFor the FFNN static model of PGAS, the number of nodes in the first or second\nhidden layers was 10 with one node in the output layer. Note for comparison, a\nFFNN with a single hidden layer and 18 hidden nodes is also trained to capture the\nstatic nonlinearity of PGAS. Data fitting using the network with two hidden layers\nwas considerably better than use the single layer network. In addition, the number\n15\nof parameters need to be trained (weights and biases) in the two-layers network (i.e.\n(10\u00d716+10)+(10\u00d710+10)+11 = 291) is smaller than the number of parameters\nfor the single layer network, which is (16 \u00d7 18 + 18) + 19 = 325). Therefore,\nthe two-layer network was selected as the internal model. Training, validating and\ntesting data were generated through applying a sequence of zero mean normalised\nrandom pulses to input channels. The periods and amplitudes of these pulses vary\naccording to their expected maximum and minimum variations under different load\nconditions. Data sets over different loads were then linked together and used in\ntraining and validation of the FFNN. The performance of the trained PGAS model\nat 0% load is shown in Figure 4, while Figure 5 shows the output pressure response\nat the three load conditions, where a significant improvement in model accuracy is\nobserved.\n6.2 Predictive controller design\nNormally, the sampling time should be less than one tenth of 2pi\/\u03c9b, where \u03c9b\nis the required bandwidth of the closed-loop. The benchmark requires to reject\na sinusoidal disturbance with a period of 25 seconds (0.04 Hz). Therefore, the\nsampling time should be less than 2.5 seconds. Further, the sampling time should\nnot be too large so that in step disturbance tests, the output variables do not deviate\nfrom setpoints more than the specified constraints before the controller can start\nto response. Several open-loop tests for a step disturbance of PSINK at three load\nconditions were performed. The outputs response results are shown in Figure 6.\nThe results show that, the worst response case is the 0% condition, where, without\ncontrol, the output PGAS is within specified range for only 1.2 seconds. Hence,\nthe sampling time is selected as 1 second. This satisfies the requirements of both\ndisturbance tests.\nThe predictive controller is implemented in MATLAB as a SIMULINK s-\n16\nfunction to replace the control block in the nonlinear simulation model provided in\nthe benchmark suit. The QP problem is solved by calling quadprog of the Op-\ntimisation Toolbox at each sampling time. This is the major computation burden\nin the above algorithm and is solely determined by the control horizon, M . The\nprediction horizon, P has little effect on computation time, thus can be selected\nrelatively large to benefit stability.\nTo tune M and P , initially let P = M . By varying M from 1 s to 12 s, a stable\nperformance is obtained which satisfies all control specifications for 5 s \u2264 M \u2264\n10 s. When M \u2265 10 s, the improvement on the system performance is negligible\nbut computation time increases significantly. Therefor M = 7 s is selected, which\ngives a good performance in all tests. To choose a suitable prediction horizon P , a\nreasonable range from the minimum value (P = M = 7 s) to P = 25 s has been\ntested. A stable response without any constraint violation is found within the range\n15 s \u2264 P \u2264 20 s. No performance improvement can be observed when P \u2265 20\ns. Therefore P = 20 s (the maximum value of the range) is chosen to ensure that\nboth the system stability and satisfactory control performance achieved within a\nreasonable computation time.\nThe weighting matrix, Q = diag(Q0, \u00b7 \u00b7 \u00b7 ,Q0), where Q0 is diagonal and\ninitially set to the inverse of the output error bounds. After online tuning, the final\nvalues are:\nQ0 =\n\uf8ee\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\n0.15 0 0 0\n0 100 0 0\n0 0 2.1 0\n0 0 0 2\u00d7 106\n\uf8f9\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb\n(14)\nAlso, the input weighting matrix R = diag(R0, \u00b7 \u00b7 \u00b7 ,R0), where R0 is diagonal\n17\nand set to the following value after online tuning:\nR0 =\n\uf8ee\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\n105 0 0 0\n0 5\u00d7 103 0 0\n0 0 5\u00d7 103 0\n0 0 0 104\n\uf8f9\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb\n(15)\nUsing the above configuration, nominal stability is achieved at all three load condi-\ntions, i.e. the magnitudes of all eigenvalues of Ai \u2212BiK are less than 1. Where,\nAi andBi are the discrete states and control matrices at different load conditions.\nOne of the advantages of MPC is that future setpoint change information is\nincorporable into the QP optimisation problem to improve setpoint tracking per-\nformance. This is implemented in the gasifier controller.\n7 Simulation Results\n7.1 Disturbance Tests\nThe following two disturbance tests are performed for three load conditions for 300\nseconds:\n1. step change in sink pressure of \u22120.2 bar at 30s;\n2. 0.04 Hz sinusoidal variation in sink pressure of amplitude 0.2 bar beginning\nat 30s.\nAll the results to follow are compared with the linear MPC. The maximum\nand minimum values as well as the peak rate change of the input variables of two\ndisturbance tests under different load conditions are shown in Table 4. The max-\nimum absolute error between output variables and their setpoints and the integral\nof absolute error (IAE) of these variables are calculated in Table 3. To quantify\n18\nthe performance improvement, the IAE ratio, defined as IAE(NMPC)\/IAE(LMPC)\nis calculated for all output variables. The mean value of these ratios is given at\nthe bottom of Table 3. These ratios indicate that the most significant improvement\nare relating to the step tests for all three load conditions and sinusoidal test for 0%\nload condition. Response for step test under 50% load condition and sinusoidal\ntest under 0% load condition are shown in Figures 7 and 8, respectively. In the\nstep disturbance test, the results are plotted for t \u2264 100s to present the control\nperformance in more details. After this time period, all the outputs response re-\nmained constant. The results in Table 4 and 3 however are calculated until t=300 s\nas required in the original challenge issue.\nFor 0% load sinusoidal test, results with extra simulation time (until t=600\ns) are provided to confirm the satisfactory performance of output in meeting the\ngiven specifications. The results show that both linear and nonlinear controllers are\ncapable of maintaining the output variables within the limits for the tests specified\nby ALSTOM.\nThe mean IAE ratio given in Table 3 shows that the system performance, com-\nparing with LMPC results, is significantly improved (overall IAE index is reduced\nby more than 10%) by using the NMPC. In fact, most of the improvement hap-\npened during the step disturbance test. In the sinusoidal disturbance test a little\nimprovement in the system response is observed. In addition, the linear controller\nwas the best at 50% and 100% load conditions. This result can be explained as\nfollow. A Wiener model mainly captures static nonlinearity of the system by in-\ntroducing a static nonlinear gain. In the step disturbance test, signal change of the\nsystem is relatively slow at the most of time. Therefore, the nonlinearity associated\nwith such a dynamic mode can be well captured by the identified Wiener model.\nThis leads to the performance improvement in all load conditions. However, in the\nsinusoidal disturbance test, signals fluctuate all the time and relatively faster than\n19\nin the step test. Nonlinearity associated with such dynamic behaviour is relatively\ndifficult to be captured by the Wiener model, hence it results some sort of perfor-\nmance deterioration in these test particularly for 50% and 100% load conditions,\nwhere the model mismatch is relatively large because the linear model is based on\nthe 0% load condition. To further demonstrate this, extra simulation is performed\nby reducing the frequency of the sinusoidal disturbance to the half of the specified\nvalue. A performance improvement in all load conditions is obtained using the\nNMPC approach (the results are not included here to save space).\nAlso, due to the strong interactions between the system variables, the improve-\nment in other output variables sometimes is even larger than that in PGAS itself\n(see figures 7 and 8). This is explained as follows. The response of PGAS, partic-\nularly to disturbance PSINK is much faster than other output variables (Figure 6).\nThe improvement of nonlinear model is mainly in long term prediction (Figure 4).\nHence, it has more effect on slow-response variables than on PGAS, which is a\nfast-response variable. Moreover, the maximum drop of PGAS in the step distur-\nbance test is a response to the disturbance before the controller can take any action,\nhence is not able to be reduced by changing internal model only.\nThe partially nonlinear model does not only improve the output performance,\nit also results smaller excursion behaviour in NMPC than that in LMPC as shown\nin figures 7 and 8.\n7.2 Load Change Test\nIn this test, the load is required to increase from 50% to 100% within time from\n100 s to 700 s. The actual response is collected from the simulation and compared\nwith the results when using LMPC controller. For both controllers, good setpoint\ntracking performance is obtained. The outputs results in Figure 9 show approx-\nimately similar behaviours for the two controllers, with a small improvement in\n20\nthe bed\u2013mass response when using the NMPC approach. It can be seen that with\nthe exception of the bed\u2013mass the outputs track their demanded levels reasonably\nwell. It takes significant time (beyond the length of simulation shown) for the bed\u2013\nmass to return to the setpoint. This is due to the saturation of the coal feed input\n( Figure 9 (g)). Note that, the coal flow-rate saturation on its upper limit is not\navoidable as explained by other researchers [24, 27, 28]. Therefore, the achievable\nimprovement in the bed mass response is limited due to the inherent characteristics\nof the process. However, the manipulated variables response appears smoother in\nthis test as shown in (e)\u2013(h) of Figure 9.\n8 Conclusion\nA nonlinear predictive controller has been developed to control the ALSTOM gasi-\nfier benchmark process. The LMPC approach employing GPC strategy of [23] is\nmodified to use a partially nonlinear model as the internal model. A nonlinear\nWiener model is used to identify one of the process output variables (PGAS) which\nhas strong nonlinearity while a linear model at 0% load condition is adopted for\nthe other output variables. A multi-layer feedforward neural network is used as the\nnonlinear static element of the Wiener model. To regain the convex feature of the\nQP optimisation problem, the nonlinear static gain of PGAS model is linearised at\nevery sampling time to update the linear model for each new optimisation prob-\nlem. Thus, the resulting internal model is a linear time-varying model. The new\ncontroller meets all the required performance specifications within given input and\noutput constraints during sink pressure disturbance and load change tests and the\nresults show a significant improvement in the system performance compared with\nthe results obtained when only linear time-invariant model is used.\nThe proposed method is useful if only part of a MIMO system exhibits a strong\n21\nnonlinearity. In this case, only this part need to be modelled using a nonlinear\nWiener model. This will reduce the efforts and time to identified a much more\ncomplicated MIMO nonlinear model which may not be necessary for the overall\nsystem.\nReferences\n[1] Pearson R. K., \u201cSelecting nonlinear model structures for computer control:\nreview\u201d, Journal of Process Control, vol. 13, pp. 1-26, 2003.\n[2] Piche S., Sayyar-Rodsari B., Johnson D., and Gerules M., \u201cNonlinear model\npredictive control using neural networks\u201d. IEEE Control System Magazine,\nvol. 20(3), pp. 53\u201362, 2000.\n[3] Maciejowski J. M., \u201cPredictive control with constraints\u201d, Prentice Hall, Har-\nlow, England, 2002.\n[4] Khadir M. T. and Ringwood J. V., \u201cLinear and nonlinear model predictive\ncontrol design for a milk pasteurization plant\u201d, Control and Intelligent Systems,\nvol. 31, pp. 1\u20138, 2003.\n[5] Gattu G. and Zafiriou E., \u201cNonlinear quadratic dynamic matrix control with\nstate estimation\u201d, Indus. Eng. Chem. Res., vol. 31, pp. 1096\u20131104, 1992.\n[6] Huzmezan M. and Maciejowski J. M., \u201cReconfiguration and scheduling in\nflight using quasi\u2013LPV high\u2013fidelity models and MBPC control\u201d, In Proc.\nAmerican Control Conference, Philadelphia, 1998.\n[7] Norquay S. J., Palazoglu A., and Romagnoli J. A., \u201cModel predictive control\nbased on Wiener models\u201d, Chemical Engineering Science, vol. 53(1), pp. 75-\n84, 1998.\n22\n[8] Brengle D. D. and W. D. Seider., \u201cMultistep nonlinear predictive controller\u201d,\nInd. Eng. Chem. Res., vol. 28, pp. 1812\u20131822, 1989.\n[9] Patwardhan A. A. and Edgar T. F., \u201cNonlinear model predictive control of\npacked distillation column\u201d, Ind. Eng. Chem. Res., vol. 32, pp. 2345\u20132356,\n1993.\n[10] Su H. T. and McAvoy (1997), \u201cArtificial neural networks for nonlinear pro-\ncess identification and control\u201d, In: Henson, M. A. & Seborg, D.E. (Eds).\n\u201cNonlinear Process Control\u201d, Chap. 7, pp. 371\u2013428, Englewood Cliffs, NJ:\nPrentice\u2013Hall.\n[11] Sentoni G. B., Biegler L. T., Guiver J. B., and Zhao H., \u201cState\u2013space nonlin-\near process modelling\u201d, AIChE J., vol. 44(10), pp. 2229\u20132239, 1998.\n[12] Maner B. R., Doyle F. J., Ogunnaike B. A., and Pearson R. K., \u201cNonlinear\nmodel predictive control of a simulated multivariable polymerization reactor\nusing second\u2013order Volterra models\u201d, Automatica, vol. 32, pp. 1285\u20131301,\n1996.\n[13] Sriniwas G. R. and Arkun Y. , \u201cA global solution to the nonlinear predic-\ntive control algorithms using polynomial ARX models\u201d, Comput. Chem. Eng.,\nvol. 21, pp. 431\u2013439, 1997.\n[14] Dumont G., Fu Y., and Lu G., \u201dNonlinear adaptive generalized predictive\ncontrol and applications \u201d, Advances in model-based predictive control, Oxford\nUniversity Press, Oxford, 1994.\n[15] Al\u2013Duwaish H., Karim M. N., and Chandrasekar V., \u201cUse of multilayer feed-\nforward neural network in identification and control of Wiener model\u201d, IEE\nProc\u2013Control Theory Appl., vol. 143(3), pp. 255\u2013258, 1996.\n23\n[16] Cervantes A. L.,Agamennoni O. E., and Figueroa J. L., \u201dA nonlinear model\npredictive control system based on Wiener piecewise linear models\u201d, Journal\nof Process Control, vol. 13, pp. 655\u2013666, 2003.\n[17] Zhao H., Guiver J., and Sentoni G., \u201cAn identification approach to nonlin-\near state space model for industrial multivariable model predictive control\u201d,\nProceeding of the American Control Conference, Philadelphia, Pennsylvania,\n1998.\n[18] Gerksic S., Juricic D., Strmcnik S., and Matko D., \u201cWiener model based non-\nlinear predictive control\u201d, International Journal of Systems Science, vol. 31(2),\npp. 189\u2013202, 2000.\n[19] R. Dixon, \u201cAdvanced gasifier control,\u201d IEE Computing and Control Engi-\nneering Journal, vol. 10, no. 3, pp. 93\u201396, 1999.\n[20] R. Dixon, A. Pike, and M. Donne, \u201cThe ALSTOM benchmark challenge on\ngasifier control,\u201d Proc. IMechE Part I, Journal of Systems and Control Engi-\nneering, vol. 214, pp. 389\u2013394, 2000.\n[21] M. Rice, J. Rossiter, and J. Schurmans, \u201cAn advanced predictive control ap-\nproach to the ALSTOM gasifier problem,\u201d Proc. IMechE Part I, Journal of\nSystems and Control Engineering, vol. 214, pp. 405\u2013413, 2000.\n[22] R. Dixon, \u201cAlstom benchmark challenge ii: Con-\ntrol of a nonlinear gasifier model,\u201d available from\nhttp:\/\/www.iee.org\/OnComms\/PN\/controlauto\/Specification v2.pdf, 2002.\n[23] Al Seyab R. K., Cao Y., and Yang S. H., \u201dA case study of predictive control\nfor the ALSTOM gasifier problem\u201d. Control 2004, University of Bath, UK,\n2004.\n24\n[24] R. Dixon and A. W. Pike, \u201cIntroduction to the 2ND ALSTOM benchmark\nchallenge on gasifier control \u201d, Control 2004, University of Bath, UK, 2004.\n[25] Behat N. and McAvoy, \u201cUse of neural nets for dynamic modeling and con-\ntrol of chemical process systems\u201d, Computers Chem. Engng., vol. 14(4-5),\npp. 573\u2013582, 1990.\n[26] Seki H., Ogawa M., Ooyama S., Akamatsu K., Ohshima M., and Yang W.,\n\u201cIndustrial application of a nonlinear model predictive control to polymeriza-\ntion reactors\u201d, Control Engineering Practice, vol. 9, pp. 819\u2013828, 2001.\n[27] Farag A. and Werner H., \u201cMultivariable PID\u2013controller design for a gasifier\nplant using penality\u2013based\u2013multi\u2013objective GA\u201d, Control 2004, University of\nBath, UK, 2004.\n[28] Simm A. and Liu G. P.,\u201cImproving the performance of the ALSTOM base-\nline controller using multiobjective optimisation\u201d, Control 2004, University of\nBath, UK, 2004.\n25\nList of Figures\n1 Nonlinear internal model. . . . . . . . . . . . . . . . . . . . . . . 27\n2 Gasifier Schematic [24]. . . . . . . . . . . . . . . . . . . . . . . 28\n3 Open\u2013loop response of the ALSTOM gasifier for a +20% step\nchange in the air flowrate . . . . . . . . . . . . . . . . . . . . . . 29\n4 Open-loop response of gas pressure at 0% load condition to a step\nchange in WAIR. Plant output (solid), Wiener model (dashed), lin-\near model (dotted). . . . . . . . . . . . . . . . . . . . . . . . . . 30\n5 Validation data, plant output (solid), Wiener model (dashed), linear\nmodel (dotted) : (a) 0% load, (b) 50% load, (c) 100% load. . . . . 31\n6 Open-loop output response to a step disturbance at 30s at 0% (solid),\n50% (dashed) and 100% (dash-dotted) load conditions. . . . . . . 32\n7 The gasifier response at 50% load condition, NMPC (solid), LMPC\n(dotted). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 33\n8 The gasifier response at 0% load condition, NMPC (solid), LMPC\n(dotted). . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34\n9 The gasifier response at setpoint ramp test, NMPC (solid), setpoint\n(dashed), LMPC (dotted). (a)\u2013(d) Outputs, (e)\u2013(f) Inputs and limits. 35\n26\nCVGAS\nMASS, TGAS\nPartial nonlinear Static\nModel\nLinear Dynamic\nModel\n)(ku )(kx\n)(kyNL\n)(kLyLC\nPGAS\n,A B\nNNf\nFigure 1: Nonlinear internal model.\n27\nto Gas Turbine \nfuel Inlet\nBoast compressor\nAtmospheric inlet\nSteam  Inlet Flow\nWSTM\nCoal     & Sorbent Flow\nWCOL         WLS\nALSTOM \nGasifier\nSystem\nPressure Disturbance\nPSINK\nAir Inlet Flow\nWAIR\nMASS\nPressure\nPGAS\nTemperature\nTGAS\nCVGAS\nChar Off-take\nWCHR\nfrom GT\nCompressor\nbleed\nFigure 2: Gasifier Schematic [24].\n28\n100 101 102 103 104 105\n4\n4.1\n4.2\n4.3\n4.4\nx 106\nCV\nG\nAS\n, M\nJ\/\nkg\n100 101 102 103 104 105\n6000\n7000\n8000\n9000\n10000\nM\nAS\nS,\n T\n100 101 102 103 104 105\n2\n2.01\n2.02\n2.03\n2.04\n2.05\nx 106\nPG\nAS\n, b\nar\nTime, s\n100 101 102 103 104 105\n1220\n1240\n1260\n1280\n1300\n1320\n1340\nTG\nAS\n, K\nTime, s\nFigure 3: Open\u2013loop response of the ALSTOM gasifier for a +20% step change in\nthe air flowrate .\n29\n0 10 20 30 40\n4.2\n4.3\n4.4\n4.5\n4.6\n4.7\nx 106\nCV\nG\nAS\n, M\nJ\/\nkg\n0 10 20 30 40\n9970\n9975\n9980\n9985\n9990\n9995\n10000\nM\nAS\nS,\n T\n0 10 20 30 40\n1.13\n1.135\n1.14\n1.145\n1.15\n1.155\n1.16\nx 106\nPG\nAS\n, b\nar\nTime, s\n0 10 20 30 40\n1066\n1067\n1068\n1069\n1070\nTG\nAS\n, K\nTime, s\nFigure 4: Open-loop response of gas pressure at 0% load condition to a step change\nin WAIR. Plant output (solid), Wiener model (dashed), linear model (dotted).\n30\n0 500 1000 1500\n1.5\n1.55\n1.6\n1.65\nx 106\nPG\nAS\n, b\nar\n0 500 1000 1500\n1.1\n1.12\n1.14\n1.16\n1.18\n1.2\nx 106\nPG\nAS\n,  \nba\nr\n0 500 1000 1500\n1.9\n1.95\n2\n2.05\n2.1\n2.15\nx 106\nPG\nAS\n, b\nar\nTime, s \n(a) \n(b) \n(c) \nFigure 5: Validation data, plant output (solid), Wiener model (dashed), linear\nmodel (dotted) : (a) 0% load, (b) 50% load, (c) 100% load.\n31\n28 29 30 31 32 33 34 35\n\u221215\n\u221210\n\u22125\n0\n5\n10\n15\nCV\nG\nAS\n, K\nJ\/\nkg\n28 29 30 31 32 33 34 35\n\u22120.4\n\u22120.2\n0\n0.2\n0.4\n0.6\nM\nAS\nS,\n to\nnn\nes\n28 29 30 31 32 33 34 35\n\u22120.1\n\u22120.05\n0\n0.05\n0.1\n0.15\nPG\nAS\n, b\nar\nTime, s\n28 29 30 31 32 33 34 35\n\u22121\n\u22120.5\n0\n0.5\n1\nTG\nAS\n, K\nTime, s\nFigure 6: Open-loop output response to a step disturbance at 30s at 0% (solid),\n50% (dashed) and 100% (dash-dotted) load conditions.\n32\n40 60 80 100\n\u22125\n0\n5\n10\nCV\nG\nAS\n, K\nJ\/\nkg\n40 60 80 100\n\u221215\n\u221210\n\u22125\n0\n5\nx 10\u22123\nM\nAS\nS,\n to\nnn\nes\n40 60 80 100\n\u22120.05\n0\n0.05\nPG\nAS\n, b\nar\n40 60 80 100\n\u22120.6\n\u22120.4\n\u22120.2\n0\n0.2\n0.4\nTG\nAS\n, K\n40 60 80 100\n0\n1\n2\n3\nW\nCH\nR,\n k\ng\/\ns\n40 60 80 100\n10\n12\n14\n16\nW\nAI\nR\n, k\ng\/\ns\n40 60 80 100\n6\n7\n8\n9\n10\nTime, s\nW\nCO\nL,\n k\ng\/\ns\n40 60 80 100\n0\n2\n4\n6\nW\nST\nM\n, k\ng\/\ns\nTime, s\nLimits = \u00b1 10 Limits = \u00b1 0.5 \nLimits = \u00b1 1  Limits = \u00b1 0.1 \nLimits = 0 & 3.5  Limits = 0 & 20  \nLimits = 0 & 6  Limits = 0 & 10  \nFigure 7: The gasifier response at 50% load condition, NMPC (solid), LMPC (dot-\nted).\n33\n0 200 400 600\n\u22125\n0\n5\n10\nCV\nG\nAS\n, K\nJ\/\nkg\n0 200 400 600\n\u22120.1\n\u22120.05\n0\n0.05\nM\nAS\nS,\n to\nnn\nes\n0 200 400 600\n\u22120.1\n0\n0.1\nPG\nAS\n, b\nar\n0 200 400 600\n\u22121\n\u22120.5\n0\n0.5\n1\nTG\nAS\n, K\n0 200 400 600\n0\n1\n2\n3\nW\nCH\nR,\n k\ng\/\ns\n0 200 400 600\n0\n5\n10\nW\nAI\nR\n, k\ng\/\ns\n0 200 400 600\n2\n4\n6\n8\nTime, s\nW\nCO\nL,\n k\ng\/\ns\n0 200 400 600\n0\n2\n4\n6\nW\nST\nM\n, k\ng\/\ns\nTime, s\nLimits = \u00b1 10 Limits = \u00b1 0.5 \nLimits = \u00b1 0.1 Limits = \u00b1 1  \nLimits = 0 & 3.5  Limits = 0 & 20  \nLimits = 0 & 10  Limits = 0 & 6  \nFigure 8: The gasifier response at 0% load condition, NMPC (solid), LMPC (dot-\nted).\n34\n0 20 40 60 80\n4.2\n4.3\n4.4\n4.5\n4.6\nCV\nG\nAS\n, M\nJ\/\nkg\na\n0 20 40 60 80\n9\n9.5\n10\n10.5\nM\nAS\nS,\n T\nb\n0 20 40 60 80\n15\n20\n25\nPG\nAS\n, b\nar\nc\n0 20 40 60 80\n1150\n1200\n1250\nTG\nAS\n, K\nd\n0 20 40 60 80\n0\n1\n2\n3.5\nW\nCH\nR,\n k\ng\/\ns\ne\n0 20 40 60 80\n0\n5\n10\n15\n20\nW\nAI\nR\n, k\ng\/\ns\nf\n0 20 40 60 80\n0\n5\n10\nW\nCO\nL,\n k\ng\/\ns\nTime, min\ng\n0 20 40 60 80\n0\n3\n6\nW\nST\nM\n, k\ng\/\ns\nTime, min\nh\nLimits = 0 & 10  \nLimits = 0 & 3.5  \n Limits = 0 & 20  \nLimits = 0 & 6  \nFigure 9: The gasifier response at setpoint ramp test, NMPC (solid), setpoint\n(dashed), LMPC (dotted). (a)\u2013(d) Outputs, (e)\u2013(f) Inputs and limits.\n35\nTable 1: Outputs variables and limits\nOutputs Description Allowed fluctuations\nCVGAS Fuel gas calorific value \u00b10.01 MJ\/kg\nMASS Bed mass \u00b1500 kg\nPGAS Fuel gas pressure \u00b10.1 bar\nTGAS Fuel gas temperature \u00b11 K\nTable 2: Inputs variables and limits\nInputs Description Maximum value Peak rate\nWCHR Char extraction rate 3.5 kg\/s 0.2 kg\/s2\nWAIR Air flow rate 20 kg\/s 1.0 kg\/s2\nWCOL Coal flow rate 10 kg\/s 0.2 kg\/s2\nWSTM Steam flow rate 6 kg\/s 1.0 kg\/s2\n36\nTable 3: Output results\nStep, 100% load Maximum Absolute Error IAE\nOutput LMPC NMPC LMPC NMPC Ratio\nCVGAS 7.33 5.69 96.275 84.986 0.8827\nMASS 16.00 10.613 3148 1711 0.5435\nPGAS 0.067 0.0735 0.262 0.266 1.0153\nTGAS 0.5194 0.5193 12.619 10.842 0.8592\nStep, 50% load Maximum Absolute Error IAE\nOutput LMPC NMPC LMPC NMPC Ratio\nCVGAS 7.447 4.231 75.112 64.775 0.8624\nMASS 12.42 4.054 1569 372.686 0.2089\nPGAS 0.076 0.081 0.336 0.3128 0.9310\nTGAS 0.611 0.542 10.813 9.819 0.9081\nStep, 0% load Maximum Absolute Error IAE\nOutput LMPC NMPC LMPC NMPC Ratio\nCVGAS 8.98 2.943 106.12 47.054 0.4434\nMASS 29.26 8.090 5587 1505 0.2694\nPGAS 0.0954 0.1006 0.471 0.449 0.9533\nTGAS 0.525 0.6005 31.13 22.325 0.7172\nSine, 100% load Maximum Absolute Error IAE\nOutput LMPC NMPC LMPC NMPC Ratio\nCVGAS 5.065 5.348 858.052 898.07 1.0466\nMASS 3.588 3.1789 452.835 434.991 0.9606\nPGAS 0.0315 0.0354 5.146 5.245 1.0192\nTGAS 0.302 0.321 43.805 45.957 1.0491\nSine, 50% load Maximum Absolute Error IAE\nOutput LMPC NMPC LMPC NMPC Ratio\nCVGAS 4.317 4.720 695.382 760.38 1.0935\nMASS 6.663 6.191 948.47 1010.7 1.0656\nPGAS 0.034 0.040 5.7903 6.417 1.1082\nTGAS 0.349 0.440 57.327 66.176 1.1544\nSine, 0% load Maximum Absolute Error IAE\nOutput LMPC NMPC LMPC NMPC Ratio\nCVGAS 8.0745 3.916 649.430 295.29 0.4547\nMASS 48.642 46.207 7510 9292 1.2373\nPGAS 0.0774 0.099 9.899 13.616 1.3755\nTGAS 0.7138 0.7705 111.17 101.388 0.9120\nThe Mean IAE Ratio 0.8780\n37\nTable 4: Input results\nStep, 100% load Maximum Minimum Peak Rate\nInput LMPC NMPC LMPC NMPC LMPC NMPC\nWCHR 1.6899 1.366 0.3075 0.582 0.2 0.2\nWAIR 19.109 19.322 16.175 16.161 1.0 1.0\nWCOL 10.00 10.00 8.62 8.616 0.2 0.2\nWSTM 5.0702 4.744 2.492 2.347 1.0 1.0\nStep, 50% load Maximum Minimum Peak Rate\nInput LMPC NMPC LMPC NMPC LMPC NMPC\nWCHR 1.9405 1.673 0.520 0.606 0.2 0.2\nWAIR 14.004 14.151 10.356 10.856 1.0 1.0\nWCOL 8.987 8.688 6.844 6.844 0.2 0.2\nWSTM 4.997 4.322 1.719 1.733 1.0 1.0\nStep, 0% load Maximum Minimum Peak Rate\nInput LMPC NMPC LMPC NMPC LMPC NMPC\nWCHR 2.153 1.947 0.227 0.962 0.2 0.2\nWAIR 8.385 8.799 4.715 4.714 1.0 1.0\nWCOL 7.558 7.207 5.157 5.156 0.2 0.2\nWSTM 4.236 4.236 1.040 1.191 1.0 1.0\nSine, 100% load Maximum Minimum Peak Rate\nInput LMPC NMPC LMPC NMPC LMPC NMPC\nWCHR 1.3616 1.523 0.473 0.3908 0.174 0.1857\nWAIR 18.902 18.933 15.75 15.735 0.569 0.625\nWCOL 9.724 9.788 7.293 7.244 0.2 0.2\nWSTM 3.604 3.616 1.571 1.626 0.602 0.4922\nSine, 50% load Maximum Minimum Peak Rate\nInput LMPC NMPC LMPC NMPC LMPC NMPC\nWCHR 1.834 1.738 0.416 0.548 0.2 0.2\nWAIR 13.896 13.916 10.222 10.15 0.6502 0.733\nWCOL 8.122 8.108 5.441 5.381 0.2 0.2\nWSTM 3.292 3.387 0.635 0.4905 0.6802 0.606\nSine, 0% load Maximum Minimum Peak Rate\nInput LMPC NMPC LMPC NMPC LMPC NMPC\nWCHR 2.427 2.665 0.066 0.059 0.2 0.2\nWAIR 8.992 8.876 3.252 3.511 1 1\nWCOL 6.264 6.346 3.172 2.961 0.2 0.2\nWSTM 3.829 4.166 0 0 1 1\n38\n"}