{"doi":"10.1109\/IVS.2004.1336378","coreId":"71277","oai":"oai:eprints.lancs.ac.uk:4364","identifiers":["oai:eprints.lancs.ac.uk:4364","10.1109\/IVS.2004.1336378"],"title":"Modelling freeway networks by hybrid stochastic models","authors":["Boel, R.","Mihaylova, L."],"enrichments":{"references":[{"id":16357865,"title":"A Finite Difference Approximation of the Kinematic Wave Model of Traf\ufb01c Flow,","authors":[],"date":"1995","doi":"10.1016\/0191-2615(95)00004-w","raw":"Daganzo, C. F., A Finite Difference Approximation of the Kinematic Wave Model of Traf\ufb01c Flow, Transportation Research B, Vol. 29B, No. 4, pp. 261-276, 1995.","cites":null},{"id":16357867,"title":"Eds., Revised Monograph on Traf\ufb01c Flow Theory,","authors":[],"date":"2002","doi":null,"raw":"Gartner, N., C. Messer, and A. Rathi, Eds., Revised Monograph on Traf\ufb01c Flow Theory, USA, 2002, http:\/\/www.tongji.edu.cn\/\u223c yangdy\/its\/tft\/.","cites":null},{"id":16357882,"title":"Freeway Ramp Metering: an Overview,","authors":[],"date":"2002","doi":"10.1109\/tits.2002.806803","raw":"Papageorgiou, M., and A. Kotsialos, Freeway Ramp Metering: an Overview, IEEE Transactions on Intelligent Transportation Systems, Vol. 3, No. 4, pp. 271-280, 2002.","cites":null},{"id":16357878,"title":"Macroscopic Model- ling of Traf\ufb01c Flow on the Boulevard P\u00b4 eriph\u00b4 erique in Paris,","authors":[],"date":"1989","doi":"10.1016\/0191-2615(89)90021-0","raw":"Papageorgiou, M., J. Blosseville, Macroscopic Model- ling of Traf\ufb01c Flow on the Boulevard P\u00b4 eriph\u00b4 erique in Paris, Transp. Research B, Vol. 23B, No. 1, pp. 29-47, 1989.","cites":null},{"id":16357873,"title":"State-of-the-art of Vehicular Traf\ufb01c Flow Modelling,","authors":[],"date":"2001","doi":"10.1243\/0959651011541120","raw":"Hoogendoorn, S., and P. Bovy, State-of-the-art of Vehicular Traf\ufb01c Flow Modelling, Special Issue on Road Traf\ufb01c Modelling and Control of the Journal of Systems and Control Eng. Proc. of the IME I, 2001.","cites":null},{"id":16357864,"title":"The Cell Transmission Model: A Dynamic Representation of Highway Traf\ufb01c Consistent with the Hydrodynamic Theory,","authors":[],"date":"1994","doi":"10.1016\/0191-2615(94)90002-7","raw":"Daganzo, C., The Cell Transmission Model: A Dynamic Representation of Highway Traf\ufb01c Consistent with the Hydrodynamic Theory, Transportation Research B, Vol. 28B, No. 4, pp. 269-287, 1994.","cites":null},{"id":16357871,"title":"Traf\ufb01c and Related Self-Driven Many-Particle Systems,","authors":[],"date":"2001","doi":"10.1103\/revmodphys.73.1067","raw":"Helbing, D., Traf\ufb01c and Related Self-Driven Many-Particle Systems, Review of Modern Physics, Vol. 73, pp. 1067-1141, 2001.","cites":null},{"id":16357869,"title":"Traf\ufb01c Data and Their Implications for Consistent Traf\ufb01c Flow Modeling,","authors":[],"date":"1997","doi":"10.1103\/physreve.55.r25","raw":"Helbing, D., Traf\ufb01c Data and Their Implications for Consistent Traf\ufb01c Flow Modeling, in: M. Papageorgiou and A. Pouliezos (eds.) Transportation Systems, Vol. II (IFAC, Chania, Greece), pp. 809-814, 1997.","cites":null},{"id":16357875,"title":"Traf\ufb01c Flow Modeling of Large-Scale Motorway Using the Macroscopic Modeling Tool METANET,","authors":[],"date":"2002","doi":"10.1109\/tits.2002.806804","raw":"Kotsialos, A., M. Papageorgiou, C. Diakaki, Y. Pavis, F. Middelham, Traf\ufb01c Flow Modeling of Large-Scale Motorway Using the Macroscopic Modeling Tool METANET, IEEE Transactions on Intelligent Transportation Systems, Vol. 3, No. 4, pp. 282-292, 2002","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2004-07-15","abstract":"Traffic flow on freeways is a nonlinear, many-particle phenomenon, with complex interactions between the vehicles. This paper presents a stochastic hybrid model of freeway traffic at a time scale and at a level of detail suitable for on-line flow estimation, for routing and ramp metering control. The model describes the evolution of continuous and discrete state variables. The freeway is considered as a network of components, each component representing a different section of the network. The traffic model, designed from physical considerations, comprises sending and receiving functions describing the downstream and upstream propagation of perturbations to be controlled. Results from simulation investigations illustrate the effectiveness of our model compared to the well-known METANET model","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/71277.pdf","fullTextIdentifier":"http:\/\/eprints.lancs.ac.uk\/4364\/1\/Parma_2004_traffic_modelling.pdf","pdfHashValue":"6263adc9dafa89b2933493925d15c9915ba70cd0","publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lancs.ac.uk:4364<\/identifier><datestamp>\n      2018-01-24T02:10:04Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D51:5141:51413735<\/setSpec><setSpec>\n      74797065733D626F6F6B5F73656374696F6E<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        Modelling freeway networks by hybrid stochastic models<\/dc:title><dc:creator>\n        Boel, R.<\/dc:creator><dc:creator>\n        Mihaylova, L.<\/dc:creator><dc:subject>\n        QA75 Electronic computers. Computer science<\/dc:subject><dc:description>\n        Traffic flow on freeways is a nonlinear, many-particle phenomenon, with complex interactions between the vehicles. This paper presents a stochastic hybrid model of freeway traffic at a time scale and at a level of detail suitable for on-line flow estimation, for routing and ramp metering control. The model describes the evolution of continuous and discrete state variables. The freeway is considered as a network of components, each component representing a different section of the network. The traffic model, designed from physical considerations, comprises sending and receiving functions describing the downstream and upstream propagation of perturbations to be controlled. Results from simulation investigations illustrate the effectiveness of our model compared to the well-known METANET model.<\/dc:description><dc:date>\n        2004-07-15<\/dc:date><dc:type>\n        Contribution in Book\/Report\/Proceedings<\/dc:type><dc:type>\n        NonPeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/eprints.lancs.ac.uk\/4364\/1\/Parma_2004_traffic_modelling.pdf<\/dc:identifier><dc:relation>\n        http:\/\/dx.doi.org\/10.1109\/IVS.2004.1336378<\/dc:relation><dc:identifier>\n        Boel, R. and Mihaylova, L. (2004) Modelling freeway networks by hybrid stochastic models. In: Intelligent Vehicles Symposium, 2004 IEEE. , 182 - 187. ISBN 0-7803-8311-7<\/dc:identifier><dc:relation>\n        http:\/\/eprints.lancs.ac.uk\/4364\/<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/dx.doi.org\/10.1109\/IVS.2004.1336378","http:\/\/eprints.lancs.ac.uk\/4364\/"],"year":2004,"topics":["QA75 Electronic computers. Computer science"],"subject":["Contribution in Book\/Report\/Proceedings","NonPeerReviewed"],"fullText":"Modelling Freeway Networks by Hybrid Stochastic Models\nRene\u00b4 Boel Lyudmila Mihaylova\nSYSTeMS, Universiteit Gent SYSTeMS, Universiteit Gent\nB-9052 Zwijnaarde, Belgium B-9052 Zwijnaarde, Belgium\nrene.boel@ugent.be mila.mihaylova@ieee.org\nAbstract\nTraffic flow on freeways is a nonlinear, many-particle\nphenomenon, with complex interactions between the vehicles.\nThis paper presents a stochastic hybrid model of freeway\ntraffic at a time scale and at a level of detail suitable\nfor on-line flow estimation, for routing and ramp metering\ncontrol. The model describes the evolution of continuous\nand discrete state variables. The freeway is considered as\na network of components, each component representing a\ndifferent section of the network. The traffic model, designed\nfrom physical considerations, comprises sending and receiving\nfunctions describing the downstream and upstream propagation\nof perturbations to be controlled. Results from simulation\ninvestigations illustrate the effectiveness of our model\ncompared to the well-known METANET model.\nI. Motivation\nTraffic flow on freeways is a complex process and its on-\nline management incorporates many aspects: analysis of\nthe traffic phenomena, building models of traffic dynamics\nand observations that are adequate for control purposes,\ndevelopment of cost effective and reliable data-processing\nalgorithms for state estimation and control. A freeway\nnetwork consists of many interacting components which\ncan exhibit highly variable behavior, such as traffic jams,\nstop-and-go waves and hysteresis phenomena. Experimen-\ntal studies [5] based on traffic data have shown that traffic\nflow in different sections of the freeway possesses distinct\ndynamic modes (phases) such as: free flow traffic where\nvehicles do not interact much with each other and where\nvehicles approach their own desired speed; synchronized\ntraffic flow, a mode in which drivers move with nearly\nthe same speed on the different lanes of the highway;\ncongested mode in which the speed is quite low and can\nfluctuate very much while flow does not vary significantly;\nand jammed mode, where both speed and flow are very\nlow. Some changes in the section mode, for example\nfrom \u201cfree flow\u201d to \u201ccongested\u201d are induced by the traffic\ndynamics themselves, for instance the drivers\u2019 behavior,\nwhile other transitions are due to external events such as\naccidents, road works or weather conditions. Perturbations\nare propagated from upstream to downstream sections\nvia forward waves. Different phenomena are observed\nin jammed mode. Drivers are slowing down when they\nobserve traffic congestion in the section ahead of them\nwhich increases the traffic density upstream provoking\na backward wave. In [1], [2] for the first time linear\nand static sending and receiving functions are proposed\nto model these waves together with a cell-transmission\nmodel.\nWe represent the freeway traffic as a network of stochas-\ntic dynamic components, each component describing a\ndifferent section of the network. The approach of traffic\nmodelling as a network of hybrid components offers\nmodularity and flexibility, it allows parallel processing\nwhich can reduce the computational load. As such, it\nbrings the scalability potential of the decentralized archi-\ntectures, adaptability and improves system predictability.\nIt is applicable to both freeways and urban networks.\nChanges in the topology of the freeway network only\nrequire addition or deletion of a few components (local\nchanges to the model). The traffic is a stochastic hybrid\nsystem, which means that each traffic section possesses\ncontinuous and discrete states, interacting with variables\nfrom neighboring sections. Continuous variables in a\nsection are the average speed and the number of vehicles\nin the section. Modal (discrete) state variables describing\nthe abrupt changes in the traffic regimes are the number\nof lanes, traffic modes, external conditions (weather, road\nworks), controlled events (e.g. change of traffic lights,\nspeed limitations). Continuous variables are stochastic due\nto the random behavior of drivers reacting to local events,\nmodal states are random due to unexpected events.\nThe novelty of this paper lies in the derived stochastic\nhybrid model of the freeway traffic, well suited for on-\nline estimation. It represents both forward and backward\nwaves through the mechanism of sending and receiving\nfunctions. The traffic dynamics is described in this model\nby macroscopic (aggregated) variables, i.e. in terms of\ncollective vehicle dynamics and treating the traffic as a\nfluid flow.\nVarious macroscopic models have been developed over\nthe last 60 years for deterministic or stochastic evolution\nof the three main variables of aggregated traffic: flow,\nspeed, and density (for recent surveys, see [3], [5], [6],\n[7], [4], [9]). The majority of the macroscopic models\nproposed in the literature are deterministic. Until now\nmacroscopic models are predominantly used to simulate\nthe traffic dynamics, less for traffic state estimation and\ncontrol. Compared to the other types of models with\nhigher levels of detail, like microscopic (particle-based)\nand mesoscopic (gas-kinetic) [5], the macroscopic (fluid-\ndynamic) models are more suitable for on-line predictions\nof traffic states with real data and for traffic regimes\ndetection and for incident detection. These predictions are\nthen useful for model based predictive control.\nThe outline of the paper is as follows. Section II presents\nthe framework for modelling the traffic flow as a stochas-\ntic hybrid system. The freeway network is divided into\ncomponents and each component is described by its\ndynamic mode with aggregated traffic variables. In Sec-\ntion III a compositional model of a link is developed,\na substantial part of which are sending and receiving\nfunctions. Section IV presents a comparison between\nsimulation results obtained using the model introduced in\nthis paper and a stochastic version of METANET. Finally,\nconclusions and ongoing research issues are highlighted.\nII. Traffic Modelled as a Stochastic Hybrid\nSystem\nA network of freeways can be divided into stretches,\ncalled links, typically between two on- and off- ramps.\nA link is composed by a sequence of sections, as in-\ndicated in Fig. 1. Each section corresponds to a stretch\nof a freeway where the behavior is fairly homogeneous\n(usually few hundred meters long). The traffic flow in\na section is modelled as a stochastic hybrid system, with\ncontinuous and discrete states, interacting with states from\nneighboring sections. The global state of link m at time tk\nis described by the vector xk = (xT1,k, xT2,k, . . . , xTnm,k)\nT ,\ncontaining the local state vectors xi,k = (Ni,k, vi,k)T of\nthe nm sections forming this link. Ni,k is the number of\nvehicles present in section i at time tk, and vi,k is their\naverage speed. The state vector xk is sampled at possibly\nasynchronous points in time t1 < t2 < . . . < tk < . . . .\nThe evolution from one sample time to the next sample\ntime is described by the update equation\nxk+1 = f(xk,Pk, Qink , vink , Qoutk , voutk , \u03b7k) (1)\nwhere Pk denotes the vector of all time-varying\nparameters, such as road conditions, or number of\navailable lanes; Qin,k counts the number of vehicles\nentering section 1 during the k-th time interval [tk, tk+1)\nwhile vin,k is the average speed of these vehicles. Qout,k\nspecifies the possible outflow, at speed vout,k from\nsection nm. \u03b7k is a disturbance vector, reflecting random\nfluctuations in the traffic states, and modelling errors.\nThe traffic mode in section i in this interval can make\nsudden transitions between different modes with rates\nwhich depend on the state vectors xi\u22121,k, xi,k, xi+1,k.\nUsing traffic modes as discrete state variables allows\nfor much simpler form of fi (e.g. affine function). In\nthe first and the last zones of a section, di,k acts as a\npart of boundary conditions. These first and last zones\nare special because they describe boundary conditions,\nincluding the interaction with upstream and downstream\nsections, on- and off-ramps, etc.\nb\nkmz ,bkm\nz ,1\u2212\n1\u2212i\nQ\nSection i \niQ\n11\n, -\u2212 ii vN ii vN , 11 , ++ ii vN\nSensor measurements \n1 i - 1... i i + 1 ... Nm \nLink m - 1 Link m Link m + 1\nFig. 1. Freeway links, sections and measurement points. Qi is\nthe average number of vehicles at the boundary between sections\ni and i + 1, Ni and vi are respectively the average number of\nvehicles and speed within section i.\nThe observation equation is of the form\nzi,kb+1 = hi(xi,s, s \u2208 [tkb , tkb+1), \u03bei,kb+1), (2)\nwhere the measurement vector zi,kb = (Q\u00afi,kb , v\u00afi,kb)T\ncomprises the average number of vehicles (cars and\ntrucks) Q\u00afi,kb , crossing the boundary between section i\nand section i + 1 over the interval [tkb , tkb+1) (only for\nthe sections equipped by sensors). The different time\nindices in (2) emphasize that the data are aggregated over\nintervals [tkb , tkb+1) at regular or irregular points in time,\ntypically less frequent than the state update (or sample)\ntimes tk.\nThe measurements are obtained by induction loop de-\ntectors or video cameras at the boundary between some\nsections (at least one sensor at entrance and exit). They\nare corrupted by noise due to sensor calibration errors,\ncommunication link errors, sensor failures. Sensor failures\nraise missing data problems which the traffic estimation\/\ncontrol algorithm should be able to cope. Usually the\ndata are received from non-equidistant points in space.\nFunctions fi and hi are nonlinear in general and can be\ndifferent in the different sections of the freeway. One form\nof the functions fi and hi is given in the next section,\nwhere a compositional model of a link is derived from\nphysical considerations.\nIII. Compositional model of a link\nEach section receives vehicles from the upstream section,\nand sends vehicles to the downstream section. Hence, the\ndynamic evolution of the traffic state of a link depends on\nthe interaction between neighbor links, i.e. on the inflow\nand outflow at upstream and downstream boundary of the\nlink.\nA. Updating the number of vehicles\nThe number of vehicles, Ni,k, [veh], within a freeway\nsection i (with length Li, [km], and with \u0003i,k number of\nlanes, at sample time instant tk is related to the density\n\u03c1i,k (number of vehicles per length unit, [veh\/km\/lane])\nvia\nNi,k = \u03c1i,kLi\u0003i,k, i = 1, 2, . . . Nm. (3)\nThe evolution of Ni,k can be expressed by\nNi,k+1 = Ni,k + Qi\u22121,k \u2212Qi,k, (4)\nwhere Qi,k is the number of vehicles, [veh], crossing the\nboundary between two sections (Fig. 1), leaving section i\nand entering the section i+1 during the interval [tk, tk+1).\nQi,k is the minimum\nQi,k = min(Si,k, Ri,k+1), (5)\namong the values computed from a sending function\nSi,k = max{Ni,k vi,k\u2206tk\nLi\n+\u03b7Si,k, Ni,k\nvout,min\u2206tk\nLi\n} (6)\nand a receiving function Ri,k+1. Si,k is a random variable\nexpressing how many among Ni,k vehicles in section i at\nk are at a distance less than vi,k\u2206tk from the boundary\nbetween sections i and i + 1, where \u2206tk = tk+1 \u2212 tk is\nthe sampling interval.\nWhen the density is low (corresponding to free-flow mode\nof traffic, i.e. when Ni,k \u2264 \u03c1critLi,k\u0003i,k; \u03c1crit denotes the\ncritical density) the interaction between vehicles will be\nnegligible and their location will be uniformly distributed\nover Li. Si,k is then a binomial random variable with\nNi,k drawings, with probability of success (vi,k\u2206tk)\/Li.\nIf the traffic is congested, vehicles will be approximately\nequidistantly spaced and the noise is small (relative to\nSi,k) and approximately Gaussian (by the central limit\ntheorem).\nThis formula for Si,k does not take into account what\nhappens when a severe traffic jam causes stopped traffic\nat time tk in section i. The speed then drops to 0 and\nno vehicle would ever leave section i after time tk, even\nif the downstream section was empty. Hence, we have to\nimpose a minimum outflow speed vout,min with which\nvehicles attempt to leave section i. This minimal outflow\nspeed can only be realized if the downstream section is not\ntoo congested, which effect is taken into account by the\nreceiving function. This outflow speed vout,min is chosen\nso that \u03c1jamvout,min\u0003i,k equals the empirically observed\noutflow from a traffic jam into an empty downstream\nsection, a value that is typically significantly smaller than\nthe maximum flow.\nThe receiving function\nRi,k+1 = Nmaxi+1,k + Qi+1,k \u2212Ni+1,k, (7)\nwhere\nNmaxi+1,k = (Li+1\u0003i+1,k)\/(A\u0001 + vi+1,ktd), (8)\ngives the number of vehicles that can enter section\ni + 1 at the next time instant k + 1, vi,k is the average\nspeed of vehicles inside section i. Nmaxi+1,k characterizes\nthe maximum number of vehicles within section i + 1\nat sample time k, assuming that the average space\nneeded by a vehicle is its average length A\u0001 plus the\ndistance travelled. td is the minimum time distance\nbetween vehicles. The sending function corresponds\nto downstream propagation and can be recursively\ncalculated from left to right, whereas the receiving\nfunction corresponds to upstream propagation and must\nbe recursively calculated from right to the left.\nEvidently, this requires the solution of a system with nm\nnonlinear algebraic equations (4)-(8). Sources of nonlin-\nearity are the minimum operation in (5), the multiplication\nof Ni,k and vi,k in (6), as well as the division by vi+1,k\nin (8). To prevent possible negative values of Ri,k+1 (7)\nwhen abrupt changes happen, it is imposed\nNi+1,k = Nmaxi+1,k, if N\nmax\ni+1,k < Ni+1,k. (9)\nIn order to describe this complex traffic behavior, the\nsending function is calculated at first forward by assuming\nthat Qi,k = Si,k and substituting it in (4). With this\n\u201cguessed\u201d number of vehicles on borders, a guessed\nnumber of vehicles inside sections, a guessed density and\na guessed speed are calculated. After that the receiving\nfunction is computed from section nm down to section\n1 and the condition that the number of vehicles leaving\nsection i cannot be larger than the number of vehicles that\ncan be received by section i + 1 is imposed as follows:\nif Ri,k+1 < Si,k, then Qi,k = Ri,k+1,\n\u2206i,k = Si,k \u2212Ri,k+1, Ni,k+1 \u2212 recalculated.\n(10)\nQi,k is the number of vehicles which actually\nare succeeding to cross the boundary, whereas\n\u2206i,k = Si,k \u2212 Ri,k+1 is the number of vehicles\nwhich are forced to remain in section i by slowing down.\n\u2206i,k is added to Ni,k+1. With this updated value of\nNi,k+1, the previous values of the receiving function are\nrecalculated in order to avoid \u201coverflow\u201d of sections with\nvehicles. This \u201cbackward validation\u201d is repeated until\n\u2206i,k = 0 (see (10)) for all sections.\nB. Updating the average speed\nThe speed vi,k+1 is calculated via the steps :\nvintermi,k+1 =\n\uf8f1\uf8f4\uf8f4\uf8f4\uf8f2\n\uf8f4\uf8f4\uf8f4\uf8f3\n[vi\u22121,kQi\u22121,k + vi,k(Ni,k \u2212Qi,k)]\/Ni,k+1,\nfor Ni,k+1 \u0003= 0,\nvf , otherwise.\n(11)\n\u03c1antici,k+1 = \u03b1\u03c1i,k+1 + (1\u2212 \u03b1)\u03c1i+1,k+1, (12)\nvi,k+1 = \u03b2vintermi,k+1 + (1\u2212 \u03b2)ve(\u03c1antici,k+1) + \u03b7vi,k, (13)\nwhere vintermi,k+1 is the intermediate speed taking convection\ninto account as if all vehicles would maintain their speed\nconstant; \u03c1antici,k+1 is the anticipated traffic density which\ndrivers see at some distance in front of their vehicles, and\n\u03c1i,k+1 is computed from (3) after Ni,k+1, i = 1, . . . , nm\nhas been evaluated. The coefficients \u03b1 and \u03b2 are in the\nrange: (0, 1]. Formulae (11) and (13) express the fact that\ndrivers can not change their speed instantaneously due\nto inertia. Anticipation leads drivers to reach a weighted\naverage density in downstream sections. The noise \u03b7vi,k\nreflects speed irregularities due to the unpredictable be-\nhavior of the drivers and also modelling errors. It is\nassumed to be a Gaussian random process. The relative\nnoise \u03b7vi,k\/vi,k is small for jammed traffic and high for\nsynchronized and congested traffic. The equilibrium speed\nve(\u03c1antici,k+1) can be computed according to eq. (19) [7]\nusing simpler affine functions ve(\u03c1i) corresponding to\ndifferent traffic modes.\nThen (4) and (13) are the traffic state equations of the\ni-th section, with a state vector xi,k = (Ni,k, vi,k)T\nof a section i, and the state vector of a link is\nxk = (xT1,k, x\nT\n2,k, . . . , x\nT\nnm,k\n)T . The initial vector\nx0 = (N1,0, v1,0, . . . , Nnm,0, vnm,0)\nT\n, and the boundary\nvariables (for the first and last segment) are of primary\nimportance. The number of vehicles entering the first\nsection is upper bounded by the sending flow, i.e.\nQ1,0 = S1,0, Qnm,0 = Rnm,0. The number of the\nvehicles leaving the last section is bounded by the\nmaximum outflow Rnm,0.\nC. Congestion propagation\nCongestion occurs often in freeway traffic. Congestion\nis a traffic flow phenomenon when the travel demand\napproaches or exceeds capacity of the facility. Traffic\ndemands vary significantly depending on the season of\nthe year, the day of the week, and the time of the day.\nMajor reasons for congestions are: reduced capacity due\nto accidents, work zones, weather conditions (as fog,\nsnow, rain), special events.\nWhen the density is high, the state of a section often is\nsuch that traffic flow is lower than the capacity (maximal\nflow). This inefficiency is represented in the model by\nve and spreads upstream via the receiving function. The\nbackward wave, which is created during congestion, is\nmodelled through the receiving function in the composi-\ntional model, reflecting the fact that a cell cannot emit\nmore vehicles than the neighbor cell can receive. In\nterms of densities, traffic is congested when the density\nexceeds its critical value \u03c1crit. The critical density \u03c1crit\nhas to be distinguished from the density in jam, \u03c1jam,\ncharacterizing the jammed mode.\nAdvantages of the model (4)-(13) are that it does not\nrequire many computations, nor parameter adaptation.\nParameters which are of primary importance are the\ncritical density and the number of lanes. The value of\nthe critical density is crucial in order to distinguish the\nfree-flow mode from the congested mode.\nD. Observation equations\nThe following observation equations are derived in agree-\nment with (2)\nzj,kb+1(1) = Q\u00afj,kb+1 + \u03beQj ,kb+1 , (14)\nzj,kb+1(2) = v\u00afj,kb+1 + \u03bevj ,kb+1 , (15)\nwhere zj,kb+1(1) is the measured averaged number of\nvehicles crossing the boundary between sections j and\nj + 1 during the time interval \u2206tb = [tkb , tkb+1), namely\nQ\u00afj,kb+1 =\n1\n\u2206tb\n\u2211k=tb+1\nk=tb\nQj,k, j \u2208 J \u2282 {1, . . . , nm};\nzj,kb+1(2) is the average speed over the same interval of\nthese Qj,k vehicles. Note that this average speed weighs\nthe faster vehicles more heavily than the slower vehicles,\nsince faster vehicles cross boundaries more frequently.\nIV. A comparison to stochastic METANET\nmodel\nThe compositional model introduced in Section III is\nvalidated by comparing simulation results of (4)-(13) with\nresults obtained via results from a stochastic version of\nMETANET model [8], [7]\n\u03c1i,k+1 = \u03c1i,k +\n\u2206tk\nLili,k\n(qi\u22121,k \u2212 qi,k) + \u03b7\u03c1i,k, (16)\nvi,k+1 = vi,k +\n\u2206tk\nLi\nvi,k(vi\u22121,k \u2212 vi,k)+\n\u2206tk\n\u03c4\n{ve[\u03c1i,k]\u2212 vi,k}\u2212 \u03bd\u2206tk(\u03c1i+1,k \u2212 \u03c1i,k)\n\u03c4Li(\u03c1i,k + \u03ba)\n+\u03b7vi,k\n(17)\nin which traffic is considered as a comprehensible fluid.\n\u03c4 denotes the relaxation constant, \u03bd - the anticipation\nconstant, \u03ba - a model parameter, preventing the third term\nin (17) to become zero [8], [7]. The flow in each section\ni is presented as the average speed in that section times\nthe average traffic density and the number of lanes in the\nsection\nqi,k = \u03c1i,kvi,k\u0003i,k. (18)\nThe average speed in equilibrium [7]\nve(\u03c1i,k) = vf exp\n{\n\u2212 1\nam\n[\n\u03c1i,k\n\u03c1i,crit\n]am}\n(19)\nis computed based on the free-flow speed vf and\nthe critical density \u03c1i,crit under the assumption that\nthe vehicles do not influence each other. In order to\nguarantee numerical stability, the condition vf\u2206tk < Li\nmust be respected [8]. Noises are added to the density\nand speed state variables and reflect modelling errors.\nThe density noise \u03b7\u03c1i,k and the speed noise \u03b7vi,k are\nassumed to be Gaussian.\nFigure 2 presents results obtained using the model (4)-\n(13) for a traffic over 5 sections, with a congestion mode.\nIn order to make comparison to the same states as in\nthe stochastic METANET model, flow-density, speed-flow\ndiagrams are plotted and the evolution of the flow and of\nthe speed in time is presented. The state variable Qi,k\nfrom the compositional model has units [veh], whereas\n0 50 100 150 200 250\n0\n2000\n4000\n6000\n8000\nFl\now\n,  \n  [\nve\nh\/\nh]\nDensity, [veh\/km]\n0 2000 4000 6000 8000\n0\n50\n100\n150\nFlow,  [veh\/h]\nSp\nee\nd,\n [k\nm\n\/h\n]\n1 2 3 4\n0\n2000\n4000\n6000\n8000\nFl\now\n, [\nve\nh\/\nkm\n]\nTime, [h]\n1 2 3 4\n20\n40\n60\n80\n100\n120\nSp\nee\nd,\n [k\nm\n\/h\n]\nTime, [h]\n1\n2\n3\n4\n5\nFig. 2. Simulation results from the compositional model\nqi,k from METANET is in [veh\/h]. The density and the\nflow are aggregated over all lanes of the freeway. An\nabrupt change occurs at tk = 2 [h]. The number of lanes\ndrops from 3 to 1 in sections 3 and 4 and hence until\ntk = 3 [h], \u00033,k = \u00034,k = 1.\n0 50 100 150 200 250\n0\n2000\n4000\n6000\n8000\nDensity, [veh\/km]\nFl\now\n, [\nve\nh\/\nh]\n0 2000 4000 6000 8000\n0\n20\n40\n60\n80\n100\n120\nFlow, [veh\/h]\nSp\nee\nd,\n [k\nm\n\/h\n]\n1 2 3 4\n1000\n2000\n3000\n4000\n5000\n6000\n7000\n8000\nFl\now\n, [\nve\nh\/\nh]\nTime, [h]\n1 2 3 4\n20\n40\n60\n80\n100\n120\nSp\nee\nd,\n [k\nm\n\/h\n]\nTime, [h]\n1\n2\n3\n4\n5\nFig. 3. Simulation results from the stochastic METANET model\nFor tk > 3 [h], the number of lanes is three again. The\naverage vehicle length is assumed to be A\u0001 = 0.01 [km],\nthe minimum time distance between vehicles td = 1 [sec],\nthe free-flow speed is vf = 130 [km\/h], the minimum\noutflow speed vout,min = 3 [km\/h], the critical density\n\u03c1i,crit = 32.5 [veh\/km\/lane]. The coefficient values are\nchosen as follows: \u03b1 = 0.95, \u03b2 = 0.10. Sampling is\ncarried out with time step \u2206tk = 10 [sec] = 0.0028 [h].\nThe section length is Li = 0.5 [km]. The speed noise\ncovariance is cov(\u03b7vi,k) = 0.52 [km\/h]2, whereas the\ncovariance of the sending function is non-stationary, equal\nto cov(\u03b7Si,k) = (0.03Ni,kvi,k\u2206tk\/Li)\n2 [veh]2. All noises\nare with Gaussian distribution.\nThe flow-density diagram from Fig. 2 shows that the com-\npositional model describes well different traffic modes.\nIn contrast to METANET, the compositional model does\nnot require to preset the value of the density in jam. The\nmechanism of the sending and receiving functions affords\nan automatic change of the number of vehicles which can\nenter the next sections.\nThe stochastic METANET model (16)-(19) is applied\nto the same simulation scenario as the compositional\nmodel. Its parameters are chosen as follows: \u03c1i,crit =\n32.5 [veh\/km\/lane], \u03c4 = 18 [sec], \u03bd = 60 [km2\/h],\n\u03c1jam = 80 [veh\/km\/lane], \u03ba = 40 [veh\/km], am =\n1.867, most of them such as in [7]. The capacity of\nthe freeway (for all lanes) is qmaxi,k = 8000, [veh\/h].\nThe model errors are with covariances cov(\u03b7\u03c1i,k) =\n0.122 [veh\/km]2, cov(\u03b7vi,k) = 0.5\n2 [km\/h]2. The abrupt\nchange of the number of lanes in sections 3 and 4 leads\nto a drop of the capacities to qmax3,k = qmax4,k =\n2600 [veh\/h]. After tk > 3 [h], the number of lanes is\nthree again and qmax3,k = qmax4,k = 8000 [veh\/h]. In\nthe results obtained from the compositional model (Fig. 2)\nas well as from METANET (Fig. 3) one observes that\nthe change in the number of lanes provokes a congestion\nwith a backward wave: the congestion in lanes 3 and 4\nis slowing down the drivers\u2019 speeds in sections 1 and 2.\nFlow-density and flow-speed diagrams are presented in\nFig. 3.\nAs seen from Figs. 2 and 3, both the compositional model\nand the stochastic METANET model describe very well\nthe traffic phenomenon. The flow-density diagram has a\nbell-shaped form and the scattered zone in it (with density\nhigher than the critical) represents the congestion when\nthe number of the lanes is reduced.\nV. Conclusions\nA framework for modelling traffic on highways as a\nhybrid stochastic system is proposed. It is straightfor-\nward, general, and applicable to both freeways and urban\nnetworks, with different topologies, with any number of\nsensors, with regularly or irregularly received data in\nspace and in time. The approach of modelling the traffic\non freeways as a network of hybrid components has\nthe following features: modularity, flexibility, suitable for\nparallel computations. Changes in the topology of the\nfreeway network only require addition or deletion of a\nfew components (local changes to the model). Its fea-\nsibility is demonstrated by the developed compositional\ntraffic model and through a comparison to a stochastic\nMETANET model. The compositional model is aimed at\ndescribing two types of traffic behavior: when the traffic\nflow propagates forward, i.e. from upstream to down-\nstream sections (forward waves) and when the traffic flow\npropagates backward (upstream waves) in the presence of\ncongestions. Results from simulation investigations are\ngiven. The compositional model can be applied to real\ntraffic data for the goals of on-line traffic flow estimation,\non-line control and modes detection.\nReferences\n[1] Daganzo, C., The Cell Transmission Model: A Dynamic\nRepresentation of Highway Traffic Consistent with the Hy-\ndrodynamic Theory, Transportation Research B, Vol. 28B,\nNo. 4, pp. 269-287, 1994.\n[2] Daganzo, C. F., A Finite Difference Approximation of the\nKinematic Wave Model of Traffic Flow, Transportation\nResearch B, Vol. 29B, No. 4, pp. 261-276, 1995.\n[3] Gartner, N., C. Messer, and A. Rathi, Eds., Re-\nvised Monograph on Traffic Flow Theory, USA, 2002,\nhttp:\/\/www.tongji.edu.cn\/\u223c yangdy\/its\/tft\/.\n[4] Helbing, D., Traffic Data and Their Implications for Con-\nsistent Traffic Flow Modeling, in: M. Papageorgiou and\nA. Pouliezos (eds.) Transportation Systems, Vol. II (IFAC,\nChania, Greece), pp. 809-814, 1997.\n[5] Helbing, D., Traffic and Related Self-Driven Many-Particle\nSystems, Review of Modern Physics, Vol. 73, pp. 1067-1141,\n2001.\n[6] Hoogendoorn, S., and P. Bovy, State-of-the-art of Vehicular\nTraffic Flow Modelling, Special Issue on Road Traffic\nModelling and Control of the Journal of Systems and Control\nEng. Proc. of the IME I, 2001.\n[7] Kotsialos, A., M. Papageorgiou, C. Diakaki, Y. Pavis, F.\nMiddelham, Traffic Flow Modeling of Large-Scale Motor-\nway Using the Macroscopic Modeling Tool METANET,\nIEEE Transactions on Intelligent Transportation Systems,\nVol. 3, No. 4, pp. 282-292, 2002\n[8] Papageorgiou, M., J. Blosseville, Macroscopic Model- ling\nof Traffic Flow on the Boulevard Pe\u00b4riphe\u00b4rique in Paris,\nTransp. Research B, Vol. 23B, No. 1, pp. 29-47, 1989.\n[9] Papageorgiou, M., and A. Kotsialos, Freeway Ramp\nMetering: an Overview, IEEE Transactions on Intelligent\nTransportation Systems, Vol. 3, No. 4, pp. 271-280, 2002.\nAcknowledgments. Financial support by the project DWTC-\nCP\/40 \u201cSustainability effects of traffic management\u201d, Belgium is\ngratefully acknowledged, and also by the Programme on Inter-\nUniversity Poles of Attraction initiated by the Belgian State,\nPrime Minister\u2019s Office for Science, Technology and Culture,\nand in part by the Bulgarian Foundation for Scientific Investi-\ngations under grants I-1202\/02 and I-1205\/02. We also thank\nthe \u201cVlaams Verkeerscentrum Antwerpen\u201d, Antwerp, Belgium,\nand Mr. Frans Middleham from the Transport Research Centre\nof the Ministry of the Transport, the Netherlands for providing\nthe data used in this study.\n"}