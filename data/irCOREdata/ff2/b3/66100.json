{"doi":"10.1215\/S0012-7094-02-11535-X","coreId":"66100","oai":"oai:dro.dur.ac.uk.OAI2:3187","identifiers":["oai:dro.dur.ac.uk.OAI2:3187","10.1215\/S0012-7094-02-11535-X"],"title":"Topology of billiard problems : I and II.","authors":["Farber,  M."],"enrichments":{"references":[],"documentType":{"type":0.8888888889}},"contributors":[],"datePublished":"2002","abstract":"Part I.\\ud\nLet T\u2282Rm+1T\u2282Rm+1 be a strictly convex domain bounded by a smooth hypersurface X=\\partialTX=\\partialT. In this paper we find lower bounds on the number of billiard trajectories in TT which have a prescribed initial point A\u2208XA\u2208X, a prescribed final point B\u2208XB\u2208X, and make a prescribed number nn of reflections at the boundary XX. We apply a topological approach based on the calculation of cohomology rings of certain configuration spaces of SmSm.\\ud\n\\ud\nPart I.\\ud\nIn this paper we give topological lower bounds on the number of periodic and of closed trajectories in strictly convex smooth billiards T\u2282Rm+1T\u2282Rm+1. Namely, for given nn, we estimate the number of nn-periodic billiard trajectories in TT and also estimate the number of billiard trajectories which start and end at a given point A\u2208\u2202TA\u2208\u2202T and make a prescribed number n of reflections at the boundary \u2202T\u2202T of the billiard domain. We use variational reduction, admitting a finite group of symmetries, and apply a topological approach based on equivariant Morse and Lusternik-Schnirelman theories","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/66100.pdf","fullTextIdentifier":"http:\/\/dro.dur.ac.uk\/3187\/1\/3187pt1.pdf","pdfHashValue":"ad35bcf2cfaa852fbed941a749a2597686b5d0f1","publisher":"Duke University Press","rawRecordXml":"<record><header><identifier>\n  \n    \n      oai:dro.dur.ac.uk.OAI2:3187<\/identifier><datestamp>\n      2017-11-10T11:47:56Z<\/datestamp><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        Topology of billiard problems : I and II.<\/dc:title><dc:creator>\n        Farber,  M.<\/dc:creator><dc:description>\n        Part I.\\ud\nLet T\u2282Rm+1T\u2282Rm+1 be a strictly convex domain bounded by a smooth hypersurface X=\\partialTX=\\partialT. In this paper we find lower bounds on the number of billiard trajectories in TT which have a prescribed initial point A\u2208XA\u2208X, a prescribed final point B\u2208XB\u2208X, and make a prescribed number nn of reflections at the boundary XX. We apply a topological approach based on the calculation of cohomology rings of certain configuration spaces of SmSm.\\ud\n\\ud\nPart I.\\ud\nIn this paper we give topological lower bounds on the number of periodic and of closed trajectories in strictly convex smooth billiards T\u2282Rm+1T\u2282Rm+1. Namely, for given nn, we estimate the number of nn-periodic billiard trajectories in TT and also estimate the number of billiard trajectories which start and end at a given point A\u2208\u2202TA\u2208\u2202T and make a prescribed number n of reflections at the boundary \u2202T\u2202T of the billiard domain. We use variational reduction, admitting a finite group of symmetries, and apply a topological approach based on equivariant Morse and Lusternik-Schnirelman theories.<\/dc:description><dc:publisher>\n        Duke University Press<\/dc:publisher><dc:source>\n        Duke mathematical journal, 2002, Vol.115(3), pp.559-621 [Peer Reviewed Journal]<\/dc:source><dc:date>\n        2002<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:identifier>\n        dro:3187<\/dc:identifier><dc:identifier>\n        issn:0012-7094<\/dc:identifier><dc:identifier>\n        issn: 1547-7398<\/dc:identifier><dc:identifier>\n        doi:10.1215\/S0012-7094-02-11535-X, 10.1215\/S0012-7094-02-11536-1<\/dc:identifier><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/3187\/<\/dc:identifier><dc:identifier>\n        http:\/\/www.dukeupress.edu\/Catalog\/ViewProduct.php?productid=45608<\/dc:identifier><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/3187\/1\/3187pt1.pdf<\/dc:identifier><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/3187\/2\/3187pt2.pdf<\/dc:identifier><dc:rights>\n        2002 \u00a9 Duke University Press \\ud\n\\ud\n<\/dc:rights><dc:accessRights>\n        info:en-repo\/semantics\/openAccess<\/dc:accessRights><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["0012-7094","issn:0012-7094"," 1547-7398","issn: 1547-7398"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2002,"topics":[],"subject":["Article","PeerReviewed"],"fullText":"Durham Research Online\nDeposited in DRO:\n08 June 2007\nVersion of attached file:\nPublished Version\nPeer-review status of attached file:\nPeer-reviewed\nCitation for published item:\nFarber, M. (2002) \u2019Topology of billiard problems : I and II.\u2019, Duke mathematical journal., 115 (3). pp.\n559-621.\nFurther information on publisher\u2019s website:\nhttp:\/\/www.dukeupress.edu\/Catalog\/ViewProduct.php?productid=45608\nPublisher\u2019s copyright statement:\n2002 Duke University Press\nAdditional information:\nPart I : http:\/\/dx.doi.org\/10.1215\/S0012-7094-02-11535-X, Part II : http:\/\/dx.doi.org\/10.1215\/S0012-7094-02-11536-1\nUse policy\nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without prior permission or charge, for\npersonal research or study, educational, or not-for-profit purposes provided that:\n\u2022 a full bibliographic reference is made to the original source\n\u2022 a link is made to the metadata record in DRO\n\u2022 the full-text is not changed in any way\nThe full-text must not be sold in any format or medium without the formal permission of the copyright holders.\nPlease consult the full DRO policy for further details.\nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom\nTel : +44 (0)191 334 3042 \u2014 Fax : +44 (0)191 334 2971\nhttp:\/\/dro.dur.ac.uk\nDUKE MATHEMATICAL JOURNAL\nVol. 115, No. 3, c\u00a9 2002\nTOPOLOGY OF BILLIARD PROBLEMS, II\nMICHAEL FARBER\nAbstract\nIn this paper we give topological lower bounds on the number of periodic and of\nclosed trajectories in strictly convex smooth billiards T \u2282 Rm+1. Namely, for given n,\nwe estimate the number of n-periodic billiard trajectories in T and also estimate the\nnumber of billiard trajectories which start and end at a given point A \u2208 \u2202T and make\na prescribed number n of reflections at the boundary \u2202T of the billiard domain. We use\nvariational reduction, admitting a finite group of symmetries, and apply a topological\napproach based on equivariant Morse and Lusternik-Schnirelman theories.\n1. Introduction\nLet X \u2282 Rm+1 be a closed smooth strictly convex hypersurface. We consider the\nbilliard system in the (m+1)-dimensional convex body T , bounded by X . Recall that\nwe view the billiard ball as a point that moves in T in a straight line except when it\nhits X = \u2202T , where it rebounds, making the angle of incidence equal the angle of\nreflection.\nG. Birkhoff [2] studied periodic billiard trajectories in plane convex billiards.\nPapers [1] and [8] deal with the problem of estimating the number of periodic trajec-\ntories in convex billiards in Rm+1, where m > 1. In [7] we studied the number of\nbilliard trajectories having fixed distinct end points and making a prescribed number\nof reflections.\nThe purpose of this paper, which is a continuation of [7], is twofold. First, we ob-\ntain estimates of the number of closed billiard trajectories that start and end at a given\npoint A \u2208 X and make a prescribed number n of reflections at the hypersurface X .\nThis problem may seem to be a special case of the fixed-end billiard problem [7], but,\nas we show, the presence of symmetry allows us to get much stronger estimates than\nin [7]. Second, we give a linear in n estimate of the number of n-periodic trajectories.\nThe following theorem, Theorem 1, gives an estimate of the number of closed\nbilliard trajectories. It deals with Z2-orbits of billiard trajectories. Any such Z2-orbit\nDUKE MATHEMATICAL JOURNAL\nVol. 115, No. 3, c\u00a9 2002\nReceived 12 June 2000. Revision received 4 September 2001.\n2000 Mathematics Subject Classification. Primary 37D50; Secondary 55R80.\nAuthor\u2019s work partially supported by the United States\u2013Israel Binational Science Foundation and by the\nMinkowski Center for Geometry.\n587\n588 MICHAEL FARBER\nis determined by a sequence of reflection points x1, x2, . . . , xn \u2208 X such that xi 6=\nxi+1 for i = 1, . . . , n\u22121 and x1 6= A, xn 6= A. The reverse sequence xn, xn\u22121, . . . , x1\ndetermines the same Z2-orbit.\nTHEOREM 1\nLet X \u2282 Rm+1 be a closed smooth strictly convex hypersurface, A \u2208 X.\n(I) For any even n \u2265 2, the number of distinct Z2-orbits of closed billiard trajec-\ntories inside X which start and end at A and make n reflections is at least\nn if m \u2265 3 is odd,\nn\n2\n+ 1 if m \u2265 2 is even. (1.1)\n(II) For any even n \u2265 2, the number of distinct Z2-orbits of closed billiard trajec-\ntories inside X which start and end at A and make n reflections is at least\n[log2 n] + m \u2212 1 if m \u2265 3 is odd,\n[log2 n] + m \u2212 2 if m \u2265 2 is even and n \u2265 4,\nm if m \u2265 2 is even and n = 2. (1.2)\n(III) If n \u2265 2 is even and if the billiard data (X, A, n) is generic (cf. below), then\nthe number of distinct Z2-orbits of closed billiard trajectories inside X which\nstart and end at A and make n reflections is at least\nmn\n2\n. (1.3)\nFirst we explain the genericity assumption in statement (III). The billiard data\n(X, A, n) determines a continuous function\nX\u00d7n \u2192 R, (x1, . . . , xn) 7\u2192\nn\u2211\ni=0\n|xi \u2212 xi+1| (1.4)\n(the total length), where we understand that x0 = A = xn+1. This function is smooth\nat all configurations (x1, . . . , xn) \u2208 X\u00d7n with xi 6= xi+1 for i = 0, . . . , n. The\ndata (X, A, n) is generic if any critical configuration (x1, . . . , xn) \u2208 X\u00d7n of the total\nlength function (1.4), satisfying the above condition xi 6= xi+1, is Morse (cf. [1], [8]).\nStatements (I) and (II) give different lower bounds on the number of closed bil-\nliard trajectories. (I) is linear in n; it is better than (II) for large n. On the other hand,\n(II) may be better than (I) if the dimension m = dim X of the boundary of billiard\ndomain is large.\nLet us compare Theorem 1 with the lower bound on the number of billiard tra-\njectories with fixed distinct end points, obtained in [7]. In Theorem 1 we speak about\nTOPOLOGY OF BILLIARD PROBLEMS, II 589\nZ2-orbits of billiard trajectories. Each Z2-orbit contains one or two billiard trajec-\ntories. For n even, each Z2-orbit contains precisely two distinct billiard trajectories.\nHence we see that, for n even, statement (I) of Theorem 1 predicts twice the number\nof closed billiard trajectories, compared to the estimate of [7] for the billiard trajec-\ntories with fixed ends. Also, for large m, statements (II) and (III) give much larger\nlower bounds than the corresponding estimates of [7, Theorem 1].\nStatement (III) includes the case m = 1 (the plane billiards) and gives the es-\ntimate n\/2. The billiard in the unit circle has precisely n\/2 orbits of closed billiard\ntrajectories with a given initial point.\nIt is reasonable to expect that, for any even n \u2265 2, the number of distinct Z2-\norbits of closed billiard trajectories inside X which start and end at A and make n\nreflections is at least\nn + m \u2212 1 if m \u2265 3 is odd,\nn\n2\n+ m \u2212 1 if m \u2265 2 is even. (1.5)\nSuch an estimate implies both statements (I) and (II) of Theorem 1. The methods of\nthis paper do not prove this assertion, although the gap looks very small.\nThe proof of Theorem 1 is based on a computation of the cohomology ring of a\nrelevant configuration space of points on the sphere Sm . We apply the technique of\nthe critical point theory, based on the cup-length estimates together with a refinement,\nsuggested by E. Fadell and S. Husseini [6], related to the notion of category weight\nof cohomology classes.\nNext we state the main result concerning n-periodic trajectories.\nTHEOREM 2\nLet X \u2282 Rm+1 be a smooth strictly convex hypersurface. For any odd prime n, there\nexist at least\nn if m > 1 is odd,\nn + 1\n2\nif m is even (1.6)\ndistinct Dn-orbits of n-periodic billiard trajectories inside X.\nHere Dn denotes the dihedral group of order 2n, which acts naturally on the billiard\ntrajectories (see [8]).\nThis theorem complements the results of [8]. In [8] it is shown that, for m \u2265 3\nand n odd, the number of distinct Dn-orbits of n-periodic billiard trajectories inside\nX \u2282 Rm+1 is not less than [log2(n \u2212 1)] + m and is at least (n \u2212 1)m for generic\nbilliards X \u2282 Rm+1. These results from [8] are similar to statements (II) and (III) of\n590 MICHAEL FARBER\nTheorem 1. Theorem 2 has several advantages compared to [8]. It gives a linear in n\nestimate that is better for large n than the logarithmic estimate of [8]. Also, it allows\nthe case m = 2, which corresponds to convex billiards in 3-dimensional Euclidean\nspace. On the other hand, the result of [8] is better for large m.\nThe proof of Theorem 2 is based on a computation of the cohomology rings\nof cyclic configuration spaces of spheres with rational coefficients. The case of Z2-\ncoefficients was computed in [8].\n2. Cohomology of the closed string configuration spaces of spheres\nLet\nGn = G(Sm; A, A, n) (2.1)\ndenote the closed string configuration space of Sm , that is, the space of all configura-\ntions (x1, . . . , xn), where xi \u2208 Sm , such that x1 6= A, xn 6= A, and xi 6= xi+1 for all\ni = 1, . . . , n \u2212 1. There is a natural involution\nT : Gn \u2192 Gn, T (x1, . . . , xn) = (xn, xn\u22121, . . . , x1) (2.2)\nwhich is important for the sequel.\nTHEOREM 3\nThe cohomology group H i (Gn;Z) is nonzero only in dimensions\ni = 0, (m \u2212 1), 2(m \u2212 1), . . . , (n \u2212 1)(m \u2212 1),\nand for these values i the group H i (Gn;Z) is free abelian of rank 1. One may choose\nadditive generators\n\u03c3i \u2208 H i(m\u22121)(Gn;Z), i = 0, 1, . . . , n \u2212 1,\nsuch that, for m \u2265 3 odd, the multiplication is given by\n\u03c3i\u03c3 j =\n{\n(i+ j)!\ni !\u00b7 j ! \u00b7 \u03c3i+ j if i + j \u2264 n \u2212 1,\n0 if i + j > n \u2212 1 (2.3)\nand, for m \u2265 2 even, it is given by\n\u03c3i\u03c3 j =\n{ [(i+ j)\/2]!\n[i\/2]!\u00b7[ j\/2]! \u00b7 \u03c3i+ j if i + j \u2264 n \u2212 1 and i or j is even,\n0 if either i + j > n \u2212 1 or both i and j are odd. (2.4)\nReflection (2.2) acts for m > 1 odd by\nT \u2217(\u03c3i ) = (\u22121)i\u03c3i (2.5)\nand for m > 1 even by\nT \u2217(\u03c3i ) = (\u22121)[i\/2]+ni\u03c3i , i = 0, 1, . . . , n \u2212 1. (2.6)\nTOPOLOGY OF BILLIARD PROBLEMS, II 591\nProof\nConsider the map\nGn = G(Sm; A, A, n) \u2192 Sm \u2212 A, (x1, . . . , xn) 7\u2192 xn .\nIt is a smooth fibration with fiber G(Sm; A, B, n \u2212 1), where A 6= B. Since the base\nSm \u2212 A is contractible, we conclude that the inclusion\nG(Sm; A, B, n \u2212 1) \u2282 Gn (2.7)\nis a homotopy equivalence. Hence the integral cohomology ring of Gn coincides with\nH\u2217(G(Sm; A, B, n \u2212 1);Z), which we calculate below.\nTheorem 8 of [7] describes algebra H\u2217(G(Sm; A, B, n \u2212 1);k), where k is an\narbitrary field. From this description it is clear that the dimension of the cohomol-\nogy does not depend on field k. Therefore we conclude that the integral cohomology\nH i (G(Sm; A, B, n \u2212 1);Z) has no torsion; it is a free abelian group of rank 1 for\ni = r(m \u2212 1), where r = 0, 1, . . . , n \u2212 1, and vanishes for all other values of i .\nLet C \u2208 Sm be a point distinct from A and B. We obtain an inclusion of con-\nfiguration spaces \u03c6\u2217 : G(Sm \u2212 C; A, B, n \u2212 1) \u2192 G(Sm; A, B, n \u2212 1), where we\nidentify Sm \u2212 C with Rm . The cohomology algebra H\u2217(G(Rm; A, B, n \u2212 1);Z) has\ngenerators s0, . . . , sn\u22121, and the full list of relations is described in [7, Proposition 7].\nFrom [7, Remark 9] we know that the induced map \u03c6\u2217 on cohomology with an arbi-\ntrary field of coefficients k is injective. This implies that the induced map on integral\ncohomology\n\u03c6\u2217 : H\u2217(G(Sm; A, B, n \u2212 1);Z)\u2192 H\u2217(G(Rm; A, B, n \u2212 1);Z) (2.8)\nis injective and that \u03c6\u2217 maps indivisible classes from H\u2217(G(Sm; A, B, n\u22121);Z) into\nindivisible classes in H\u2217(G(Rm; A, B, n \u2212 1);Z).\nWe claim that, for any r = 0, 1, . . . , n \u2212 1, there exists an indivisible class\n\u03c3r \u2208 H r(m\u22121)\n(\nG(Sm; A, B, n \u2212 1);Z)\nsuch that\n\u03c6\u2217(\u03c3r ) =\n\uf8f1\uf8f4\uf8f2\uf8f4\uf8f3\n\u2211\n0\u2264i1<\u00b7\u00b7\u00b7<ir<n\nsi1 \u00b7 \u00b7 \u00b7 sir for m odd,\n(\u22121)[r\/2]+nr \u00b7 \u2211\n0\u2264i1<\u00b7\u00b7\u00b7<ir<n\n(\u22121)i1+\u00b7\u00b7\u00b7+ir si1 \u00b7 \u00b7 \u00b7 sir for m even\n(2.9)\n(cf. [7, (4.3), (4.4)]). Indeed, applying [7, Remark 9] with k = Q, we see that the\nimage of the generator of the group\nH r(m\u22121)\n(\nG(Sm; A, B, n \u2212 1);Z) ' Z\n592 MICHAEL FARBER\nunder homomorphism \u03c6\u2217 equals an integral multiple of the expression on the right-\nhand side of (2.9). Since the classes on the right-hand side of (2.9) are indivisible, and\nsince we know that \u03c6\u2217 maps indivisible classes to indivisible classes, we conclude\nthat there exists a generator \u03c3r with the required property.\nThe product formulae (2.3) and (2.4) for classes \u03c3r follow since they hold for the\nproducts \u03c6\u2217(\u03c3i )\u03c6(\u03c3 j ) \u2208 H\u2217(G(Rm; A, B, n \u2212 1);Z), as can be easily checked using\nthe arguments of the proof of [7, Theorem 8].\nNow we want to find the action of the reflection T : Gn \u2192 Gn on classes \u03c3i . It\nis clear that T \u2217(\u03c3i ) = \u00b1 \u03c3i , and we need to calculate the sign. Consider the following\ndiagram of natural inclusions,\nG(Rm; A, B, n \u2212 1) \/\/\n\u000f\u000f\nG(Sm; A, B, n \u2212 1)\n\u000f\u000f\nG(Rm; A, A, n) \/\/ G(Sm; A, A, n)\n(where Rm = Sm \u2212 C as above), and the induced diagram of cohomology groups,\nH\u2217\n(\nG(Rm; A, A, n);Z)\n\u03b2\n\u000f\u000f\nH\u2217\n(\nG(Sm; A, A, n);Z)\u03b3oo\n'\u03b1\n\u000f\u000f\nH\u2217\n(\nG(Rm; A, B, n \u2212 1);Z) H\u2217(G(Sm; A, B, n \u2212 1);Z)\u03c6\u2217oo\nwhere \u03b1 is an isomorphism and \u03c6\u2217 is injective. To understand \u03b2, note that\nG(Rm; A, A, n) is homotopy equivalent to the cyclic configuration space G(Rm, n +\n1) (cf. [8]) and so the cohomology H\u2217(G(Rm; A, A, n);Z) has (m \u2212 1)-dimensional\ngenerators s0, s1, . . . , sn which satisfy the relations of [8, Proposition 2.2]. (We shift\nindices for convenience.) The proof of [7, Proposition 7] shows that \u03b2(si ) = si for\ni = 0, 1, . . . , n \u2212 1 and \u03b2(sn) = 0. Hence \u03b2 is an epimorphism with a kernel equal\nto the ideal generated by sn .\nThe reflection T also acts on G(Rm; A, A, n) (by formula (2.2)). It is clear that\nthe induced map T \u2217 : H\u2217(G(Rm; A, A, n);Z) \u2192 H\u2217(G(Rm; A, A, n);Z) acts on\nthe generators si as follows:\nT \u2217(si ) = (\u22121)msn\u2212i , where i = 0, 1, . . . , n. (2.10)\nNow we may calculate T \u2217(\u03c3r ), where r = 1, . . . , n \u2212 1. Fix a subsequence\n0 < i1 < \u00b7 \u00b7 \u00b7 < ir < n. (We avoid indices 0 and n.) Suppose first that m is odd. Then\n\u03c6\u2217(\u03b1(\u03c3r )) contains monomial si1si2 \u00b7 \u00b7 \u00b7 sir ; therefore \u03b3 (\u03c3r ) contains the same mono-\nmial with coefficient 1. Then T \u2217(\u03b3 (\u03c3r )) contains monomial sn\u2212ir sn\u2212ir\u22121 \u00b7 \u00b7 \u00b7 sn\u2212i1\nTOPOLOGY OF BILLIARD PROBLEMS, II 593\nwith coefficient (\u22121)mr = (\u22121)r . The last monomial appears in \u03b3 (\u03c3r ) with coef-\nficient 1. Since we know that T \u2217(\u03c3r ) = \u00b1 \u03c3r , we conclude that T \u2217(\u03c3r ) = (\u22121)r\u03c3r .\nAssume now that m is even. Then \u03c6\u2217(\u03b1(\u03c3r )) contains monomial si1si2 \u00b7 \u00b7 \u00b7 sir with\ncoefficient\n(\u22121)[r\/2]+nr+i1+\u00b7\u00b7\u00b7+ir .\nApplying T \u2217 and using (2.10), we see that the monomial sn\u2212ir sn\u2212ir\u22121 \u00b7 \u00b7 \u00b7 sn\u2212i1 appears\nin T \u2217(\u03b3 (\u03c3r )) with coefficient\n(\u22121)nr+i1+\u00b7\u00b7\u00b7+ir\nand in \u03b3 (\u03c3r ) with coefficient\n(\u22121)[r\/2]+i1+\u00b7\u00b7\u00b7+ir .\nThis shows that T \u2217(\u03c3r ) = (\u22121)[r\/2]+nr\u03c3r .\n3. Calculation of equivariant cohomology\nOur purpose in this section is to compute the cohomology of Gn\/Z2, the factor space\nof the space of closed string configurations Gn = G(Sm; A, A, n) with respect to\nthe Z2-action given by the reflection T : Gn \u2192 Gn . For n even, T acts freely, and\nH\u2217(Gn\/Z2;Z) coincides with the equivariant cohomology of Gn .\nThe problem is trivial for m = 1; therefore everywhere in this section we assume\nthat m > 1.\nTo compute the equivariant cohomology, we apply the Morse theory method.\nNamely, we consider the simplest billiard in the standard unit sphere Sm \u2282 Rm+1 and\nthe function of negative total length\nL : Gn = G(Sm; A, A, n)\u2192 R, (x1, . . . , xn) 7\u2192 \u2212\nn\u2211\ni=0\n|xi \u2212 xi+1|. (3.1)\nHere we understand that x0 = xn+1 = A. The critical points of L are the billiard\ntrajectories in Sm which start and end at A and make n reflections. All such trajectories\ncan easily be described.\nNamely, fix a vector a \u2208 Sm , a \u22a5 A, orthogonal to A and an angle\n\u03c8k = 2pik\nn + 1 , k = 1, 2, . . . ,\n[n + 1\n2\n]\n. (3.2)\nThis choice (a, \u03c8k) determines the billiard trajectory (x1, . . . , xn), where\nx j = A cos( j\u03c8k)+ a sin( j\u03c8k), j = 1, . . . , n.\nNote that for n odd the trajectory determined by the pair (a, \u03c8(n+1)\/2) does not depend\non a; it has the form (x1, . . . , xn), where x j = A for j even and x j = \u2212A for j odd.\n594 MICHAEL FARBER\nWe denote by\nVp \u2282 Gn, p = 0, 1, . . . ,\n[n \u2212 1\n2\n]\n,\nthe variety of trajectories determined by all pairs (a, \u03c8k), where\nk =\n[n + 1\n2\n]\n\u2212 p (3.3)\nand a \u22a5 A is an arbitrary point of the sphere Sm\u22121 \u2282 Sm orthogonal to A.\nIf n is even, then every submanifold Vp is diffeomorphic to sphere Sm\u22121.\nIf n is odd, then V0 is a single point and V1, . . . , V[(n\u22121)\/2] are diffeomorphic to\nthe sphere Sm\u22121.\nThe following statement is similar to that of I. Babenko in [1, Proposition 3.1].\nPROPOSITION 4\nEach Vp \u2282 Gn is a nondegenerate critical submanifold of function L in the sense of\nR. Bott.\nIf n is even, then the index of each Vp equals 2p(m \u2212 1) for p = 0, 1, . . . , (n \u2212\n2)\/2.\nIf n is odd, then the index of V0 equals zero and, for p = 1, . . . , (n \u2212 1)\/2, the\nindex of Vp equals (2p \u2212 1)(m \u2212 1).\nProof\nLet e1, . . . , em+1 \u2208 Rm+1 be an orthonormal base. We may assume that A = e1. We\nwant to calculate the Hessian of function L at a billiard trajectory ck = (x1, . . . , xn) \u2208\nGn , where\nx j = cos(\u03c8k)e1 + sin(\u03c8k)e2, j = 1, . . . , n,\nand\n\u03c8k = 2pik\nn + 1 , k = 1, . . . ,\n[n + 1\n2\n]\n.\nLet x\u22a5j denote the vector orthogonal to x j lying in the (e1, e2)-plane, that is,\nx\u22a5j = cos\n(\u03c8k + pi\n2\n)\ne1 + sin\n(\u03c8k + pi\n2\n)\ne2.\nAny tangent vector Y \u2208 Tck Gn =\n\u2295\nj Tx j Sm is determined by numbers \u00b5r, j \u2208 R,\nwhere r = 0, 1, . . . ,m \u2212 1 and j = 1, . . . , n, such that the component of Y in Tx j Sm\nequals\n\u00b50, j x\u22a5j +\nm\u22121\u2211\nr=1\n\u00b5r, j er+2.\nTOPOLOGY OF BILLIARD PROBLEMS, II 595\nA direct calculation of the Hessian H(L)ck (Y, Y ) of L gives the following quadratic\nform in variables \u00b5r, j :\nH(L)ck (Y, Y ) =\n1\n2\nsin\n(\u03c8k\n2\n)\n\u00b7\nn\u2211\nj=0\n(\u00b50, j \u2212 \u00b50, j+1)2\n+\n(\n2 sin\n(\u03c8k\n2\n))\u22121\n\u00b7\n[m\u22121\u2211\nr=1\nQ\u03c8k (\u00b5r,1, . . . , \u00b5r,n)\n]\n, (3.4)\nwhere in the first sum we understand that \u00b50,0 = 0 = \u00b50,n+1 and in the second sum\nthe symbol Q\u03c8 (y1, . . . , yn) denotes the following quadratic form:\nQ\u03c8 (y1, . . . , yn) = \u22122 cos(\u03c8) \u00b7\nn\u2211\ni=1\ny2i + 2\nn\u22121\u2211\ni=1\nyi yi+1.\nWe see that the Hessian splits as a direct sum of m quadratic forms corresponding\nto different values r = 0, 1, . . . ,m \u2212 1. The terms involving \u00b50, j (the first sum) give\na positive definite quadratic form. The remaining (m \u2212 1)-forms are identical, and\ntheir index and nullity equal the index and nullity of Q\u03c8k . Hence we conclude that\nthe index and nullity of the Hessian equals m \u2212 1 times the index and nullity of the\nform Q\u03c8k .\nIn order to calculate the index of Q\u03c8k , we observe that the eigenvalues of the\nsymmetric (n \u00d7 n)-matrix\uf8ee\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\n0 1 0 . . . 0 0\n1 0 1 . . . 0 0\n0 1 0 . . . 0 0\n. . . . . . . . . . . . . . . . . .\n0 0 0 . . . 0 1\n0 0 0 . . . 1 0\n\uf8f9\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb\nare given by\n\u03bbs = 2 cos\n( pis\nn + 1\n)\n, s = 1, 2, . . . , n, (3.5)\nand the eigenvector (v1,s, . . . , vn,s) corresponding to \u03bbs is given by\nv j,s = sin\n( pi js\nn + 1\n)\n, j = 1, . . . , n. (3.6)\nThis claim can be checked directly.\nTherefore the eigenvalues of Q\u03c8k are\n2\n[\ncos\n( pis\nn + 1\n)\n\u2212 cos\n( 2pik\nn + 1\n)]\n, s = 1, 2, . . . , n, (3.7)\n596 MICHAEL FARBER\nand the eigenvectors of Q\u03c8k are given by (3.6).\nHence the index of Q\u03c8k equals the number of integers s such that 2k < s \u2264 n,\nwhich is n \u2212 2k for 2k \u2264 n and zero if k = (n + 1)\/2 and n is odd. Since (according\nto (3.3)) k = [(n + 1)\/2] \u2212 p, we conclude that the index of Q\u03c8k equals\nn \u2212 2k = n \u2212 2\n([n + 1\n2\n]\n\u2212 p\n)\n=\n{\n2p if n is even,\n2p \u2212 1 if n is odd.\nThe special case k = (n+ 1)\/2 for n odd corresponds to p = 0; in this case the index\nand nullity of Q\u03c8k equal zero.\nFrom (3.7) we see that the nullity of Q\u03c8k equals 1 for any k unless n is odd and\nk = (n + 1)\/2.\nThe discussion above proves that on any critical submanifold Vp the dimension\nof the kernel of the Hessian of L equals the dimension of Vp; hence all submanifolds\nVp are nondegenerate in the sense of Bott and their indices are as stated.\nThe normal bundle \u03bd(Vp) splits as a direct sum \u03bd+(Vp) \u2295 \u03bd\u2212(Vp) of the positive\nand negative normal bundles with respect to the Hessian of L . One may describe the\nnegative normal bundle \u03bd\u2212(Vp) as follows.\nLEMMA 5\nThe negative normal bundle \u03bd\u2212(Vp) to Vp is\n\u03bd\u2212(Vp) =\n\uf8f1\uf8f4\uf8f4\uf8f4\uf8f2\uf8f4\uf8f4\uf8f4\uf8f3\n\u03be \u2295 \u03be \u2295 \u00b7 \u00b7 \u00b7 \u2295 \u03be\ufe38 \ufe37\ufe37 \ufe38\n2p times\nif n is even,\n\u03be \u2295 \u03be \u2295 \u00b7 \u00b7 \u00b7 \u2295 \u03be\ufe38 \ufe37\ufe37 \ufe38\n2p\u22121 times\nif n is odd and p > 0, (3.8)\nwhere \u03be denotes the tangent bundle of sphere Sm\u22121.\nProof\nLet Sm\u22121 \u2282 Sm be the equatorial sphere consisting of unit vectors orthogonal to\nA. Any point a \u2208 Sm\u22121 and angle (3.2) determine a critical submanifold Vp. Fix\nan eigenvalue \u03bbs (given by (3.5)) such that expression (3.7) is negative. Consider\nthe subbundle \u03bds(Vp) of the normal bundle \u03bd(Vp) consisting of eigenvectors of the\nHessian with eigenvalue \u03bbs . We show that \u03bds(Vp) is isomorphic to \u03be . This would\nclearly imply the lemma.\nConsider a billiard trajectory ck = (x1, . . . , xn) \u2208 Gn in the plane of vectors a\nand A, where\nx j = cos(\u03c8k)A + sin(\u03c8k)a, j = 1, . . . , n,\nTOPOLOGY OF BILLIARD PROBLEMS, II 597\nand\n\u03c8k = 2pik\nn + 1 , k =\n[n + 1\n2\n]\n\u2212 p.\nDenote by \u03bea the (m\u2212 1)-dimensional subspace orthogonal to a and A. We show that\nthere is an isomorphism between the fiber of \u03bds(Vp) over ck and \u03bea which depends\ncontinuously on a.\nLet v j \u2208 Tx j Sm , where j = 1, 2, . . . , n, be a sequence of tangent vectors. Using\n(3.4) and (3.6), we find that a sequence of vectors (v1, . . . , vn) belongs to the fiber of\n\u03bds(Vp) over the configuration ck = (x1, . . . , xn) if and only if\nv j \u2208 \u03bea and v j = sin(pi js\/(n + 1))\nsin(pis\/(n + 1)) \u00b7 v1, j = 1, . . . , n. (3.9)\nWe see that the first vector v1 uniquely determines a tangent vector (v1, . . . , vn) to a\nconfiguration ck in the eigendirection \u03bbs . Moreover, v1 can be an arbitrary vector in\n\u03bea .\nSince \u03be is orientable, we obtain the following.\nCOROLLARY 6\nThe negative normal bundle \u03bd\u2212(Vp) is orientable.\nNote that this corollary is trivial for m > 2 since the sphere Sm\u22121 is then simply\nconnected.\nCOROLLARY 7\nThe function L : Gn \u2192 R (cf. (3.1)) is a perfect Bott function.\nProof\nNote that the critical value L(Vp) equals\nL(Vp) = \u22122(n + 1) sin\n( 2pik\nn + 1\n)\n, where k =\n[n + 1\n2\n]\n\u2212 p.\nHence, for p < p\u2032, we have L(Vp) < L(Vp\u2032).\nChoose constants c0, c1, . . . , c[(n\u22121)\/2] \u2208 R such that\nL(Vp) < cp < L(Vp+1), p = 0, 1, . . . ,\n[n \u2212 3\n2\n]\n,\nand\nL(V[(n\u22121)\/2]) < c[(n\u22121)\/2].\n598 MICHAEL FARBER\nEach Fp = L\u22121(\u2212\u221e, cp]) \u2282 Gn is a compact manifold with boundary, and we\nobtain a filtration\nF0 \u2282 F1 \u2282 \u00b7 \u00b7 \u00b7 \u2282 F[(n\u22121)\/2].\nThe inclusion F[(n\u22121)\/2] \u2192 Gn is a homotopy equivalence (as follows easily from [7,\nProposition 4]). Using Corollary 6 and the Thom isomorphism, we obtain\nH j (Fp, Fp\u22121;Z) ' H j\u2212ind(Vp)(Vp;Z)\n=\n{\nZ if j = ind(Vp) or j = ind(Vp)+ m \u2212 1,\n0 otherwise.\n(3.10)\nThis also holds true for p = 0 if we understand that F\u22121 = \u2205.\nSuppose that n is even. Then cohomology group H j (Fp, Fp\u22121;Z) is isomorphic\nto Z for j = 2p(m \u2212 1) and j = (2p + 1)(m \u2212 1) and vanishes for all other j .\nComparing this with the additive structure of H\u2217(Gn;Z) given by Theorem 3, we\nfind that\nH\u2217(Gn;Z) '\n[(n\u22121)\/2]\u2295\np=0\nH\u2217(Fp, Fp\u22121;Z), (3.11)\nwhich means that L is perfect.\nSuppose now that n is odd. Then H j (F0, F\u22121;Z) is Z for j = 0 and vanishes for\nall other values of j . If p > 0, then\nH j (Fp, Fp\u22121;Z) '\n{\nZ for j = (2p \u2212 1)(m \u2212 1) or j = 2p(m \u2212 1),\n0 otherwise,\nand thus the perfectness of (3.11) also holds.\nAlternatively, for m > 2, the perfectness of (3.11) follows without using Theorem\n3 by considering the spectral sequence of filtration Fp,\nE p,q1 = H p+q(Fp, Fp\u22121;Z)\u21d2 H p+q(Gn;Z),\nand observing that for any of its differentials dr , with r \u2265 1, either the source or the\ntarget vanishes. Therefore E1 = E\u221e. Moreover, every diagonal p + q = c of E\u221e\ncontains at most one nonzero group. If m = 2, the differential d1 has a nonzero source\nand target, and so the above argument does not work.\nFrom this point on we assume that n is even.\nThen the reflection T : Gn \u2192 Gn acts freely, and our purpose is to calculate the\ncohomology of the factor space G \u2032n = Gn\/Z2. Function (3.1) is reflection invariant\nand so determines a smooth function\nL \u2032 : G \u2032n \u2192 R.\nTOPOLOGY OF BILLIARD PROBLEMS, II 599\nThe critical points of L \u2032 form nondegenerate (in the sense of Bott) critical submani-\nfolds\nV \u20320, V \u20321, . . . , V \u2032n\/2\u22121,\nwhere V \u2032p = Vp\/Z2. The index of V \u2032p equals 2p(m \u2212 1) (as follows from Proposition\n4). Since each Vp can be identified with Sm\u22121 and under this identification the reflec-\ntion T acts as the usual antipodal map, we see that each V \u2032p is diffeomorphic to the\nprojective space RPm\u22121.\nCOROLLARY 8\nThe Poincare\u00b4 polynomial of G \u2032n = G(Sm; A, A, n)\/Z2 with coefficients in field Z2 is\ntm \u2212 1\nt \u2212 1 \u00b7\ntn(m\u22121) \u2212 1\nt2(m\u22121) \u2212 1 ,\nand the sum of Betti numbers with coefficients in Z2 is mn\/2.\nProof\nWe give here a simple proof that works for m > 2. The case m = 2 follows from\nTheorem 11.\nConsider the filtration F0 \u2282 F1 \u2282 \u00b7 \u00b7 \u00b7 \u2282 Fn\/2\u22121 \u2282 Gn, as in the proof of\nCorollary 7. Let F \u2032p denote Fp\/Z2. We obtain a filtration F \u20320 \u2282 F \u20321 \u2282 \u00b7 \u00b7 \u00b7 \u2282 F \u2032n\/2\u22121 \u2282\nG \u2032n such that the inclusion F \u2032n\/2\u22121 \u2282 G \u2032n is a homotopy equivalence and\nH j (F \u2032p, F \u2032p\u22121;Z2) ' H j\u22122p(m\u22121)(RPm\u22121;Z2), p = 0, 1, . . . ,\nn\n2\n\u2212 1\n(using the Thom isomorphism). Hence H j (F \u2032p, F \u2032p\u22121;Z2) is nonzero (and 1-\ndimensional) only for 2p(m \u2212 1) \u2264 j \u2264 (2p + 1)(m \u2212 1). The spectral sequence of\nfiltration F \u2032p,\nE p,q1 = H p+q(F \u2032p, F \u2032p\u22121;Z2)\u21d2 H p+q(G \u2032n;Z2),\nhas E p,q1 ' Z2 for p(2m \u2212 3) \u2264 q \u2264 p(2m \u2212 3)+ (m \u2212 1) and E p,q1 = 0 otherwise.\nHence, for any differential dr , where r \u2265 1, either the source or the target vanishes.\nTherefore E1 = E\u221e and our statement follows.\nWe now calculate the Stiefel-Whitney classes of the negative normal bundle \u03bd\u2212(V \u2032p).\nIn particular, we find out for which p this bundle is orientable. This information is\nneeded for computing the integral cohomology of G \u2032n .\nLEMMA 9\nThe total Stiefel-Whitney class of the negative normal bundle \u03bd\u2212(V \u2032p) equals\n(1 + \u03b1)p(m\u22121) \u2208 H\u2217(V \u2032p;Z2),\n600 MICHAEL FARBER\nwhere \u03b1 \u2208 H1(V \u2032p;Z2) ' Z2 denotes the generator.\nProof\nAs in the proof of Lemma 5, we obtain that the negative normal bundle \u03bd\u2212(V \u2032p) splits\nas a direct sum of 2p vector bundles \u03b7s of rank m\u22121, one for each negative eigenvalue\n\u03bbs = 2\n[\ncos\n( pis\nn + 1\n)\n\u2212 cos\n( 2pik\nn + 1\n)]\nof the Hessian. Here k = n\/2 \u2212 p.\nLet \u03c4 denote the tangent bundle of RPm\u22121. Let \u03b3\u22a5 be a rank m\u22121 vector bundle\nover RPm\u22121 such that its fiber over a line ` \u2208 RPm\u22121 is the orthogonal complement\n`\u22a5.\nWe claim that\n\u03b7s '\n{\n\u03c4 if s is even,\n\u03b3\u22a5 if s is odd.\nIndeed, this bundle is obtained from the tangent bundle \u03be of Sm\u22121 (cf. Lemma 5) by\nidentifying the antipodal points, and under this identification the first vector v1 should\nbe replaced by the last vector vn (cf. (3.9)). Formulae (3.9) show that\nvn = \u2212 cos(pis) \u00b7 v1 = (\u22121)s+1 \u00b7 v1,\nand hence the bundle \u03b7s is obtained from \u03be by identifying the fibers over points a and\n\u2212a with a twist (\u22121)s+1. This implies our claim (cf. [12]).\nFor a given p there is an equal number of negative eigenvalues \u03bbs of the Hessian\non Vp with even and odd s. Therefore the bundle \u03bd\u2212(V \u2032p) is isomorphic to a direct\nsum of p copies of \u03c4 \u2295 \u03b3\u22a5.\nThe total Stiefel-Whitney class of \u03b3\u22a5 is (1+\u03b1)\u22121, and the total Stiefel-Whitney\nclass of \u03c4 is (1+ \u03b1)m (cf. [12]). Hence the total Stiefel-Whitney class of the negative\nbundle is [\n(1 + \u03b1)\u22121 \u00b7 (1 + \u03b1)m]p = (1 + \u03b1)(m\u22121)p.\nCOROLLARY 10\nIf m is odd, then the negative normal bundle \u03bd\u2212(V \u2032p) is orientable for any p. If m\nis even, then the negative normal bundle \u03bd\u2212(V \u2032p) is orientable for all even p and\nnonorientable for all odd p.\nProof\nBy Lemma 9, the first Stiefel-Whitney class of \u03bd\u2212(V \u2032p) is p(m \u2212 1)\u03b1. This implies\nour statement.\nTOPOLOGY OF BILLIARD PROBLEMS, II 601\nRecall our permanent assumption that m > 1 and n is even.\nTHEOREM 11\nIf m > 1 is odd, then\nH j (G \u2032n;Z) '\n\uf8f1\uf8f4\uf8f4\uf8f4\uf8f4\uf8f2\uf8f4\uf8f4\uf8f4\uf8f4\uf8f3\nZ for j = 2i(m \u2212 1), where i = 0, 1, . . . , n\/2 \u2212 1,\nZ2 for j even satisfying 2i(m \u2212 1) < j \u2264 (2i + 1)(m \u2212 1)\nwith i as above,\n0 otherwise.\nIf m is even, then\nH j (G \u2032n;Z) '\n\uf8f1\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f2\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f4\uf8f3\nZ for j = (4r + \u000f)(m \u2212 1), r = 0, 1, . . . , [(n \u2212 2)\/4], \u000f = 0, 1,\nZ2 for j = 4r(m \u2212 1)+ i , or j = (4r \u2032 + 2)(m \u2212 1)+ i \u2032, where\ni = 2, 4, . . . ,m \u2212 2, r is as above, i \u2032 = 1, 3, . . . ,m \u2212 1, and\n0 \u2264 r \u2032 \u2264 (n \u2212 4)\/4,\n0 otherwise.\nProof\nConsider filtration F \u20320 \u2282 F \u20321 \u2282 \u00b7 \u00b7 \u00b7 \u2282 F \u2032n\/2\u22121 \u2282 G \u2032n (cf. the proof of Corollary 8) and\nthe associated spectral sequence\nE \u2032 p,q1 = H p+q(F \u2032p, F \u2032p\u22121;Z)\u21d2 H p+q(G \u2032n;Z).\nF \u2032p\u2212F \u2032p\u22121 contains a single critical submanifold V \u2032p ' RPm\u22121 with index 2p(m\u22121).\nThe normal bundle to V \u2032p is orientable if p(m\u22121) is even and nonorientable if p(m\u22121)\nis odd. The Thom isomorphism gives\nH j (F \u2032p, F \u2032p\u22121;Z) '\n{\nH j\u22122p(m\u22121)(RPm\u22121;Z) if p(m \u2212 1) is even,\nH j\u22122p(m\u22121)(RPm\u22121;\u00b1Z) if p(m \u2212 1) is odd. (3.12)\nHere\u00b1Z denotes the nontrivial local system of groups Z over RPm\u22121; its monodromy\nalong the generator of pi1(RPm\u22121) is multiplication by \u22121.\nFor m even, we have\nH j (RPm\u22121;Z) =\n\uf8f1\uf8f4\uf8f4\uf8f2\uf8f4\uf8f4\uf8f3\nZ for j = 0 and j = m \u2212 1,\nZ2 for j = 2, 4, . . . ,m \u2212 2,\n0 otherwise\nand\nH j (RPm\u22121;\u00b1Z) =\n{\nZ2 for j = 1, 3, . . . ,m \u2212 1,\n0 otherwise.\n602 MICHAEL FARBER\nFor m odd, we have\nH j (RPm\u22121;Z) =\n\uf8f1\uf8f4\uf8f4\uf8f2\uf8f4\uf8f4\uf8f3\nZ for j = 0,\nZ2 for j = 2, 4, . . . ,m \u2212 1,\n0 otherwise.\nTherefore, in the above spectral sequence, E \u2032 p,q1 = 0 holds for p(2m\u22123) \u2264 q \u2264\np(2m \u2212 3) + (m \u2212 1). This implies that for m > 2 either the source or the target of\nany differential dr vanishes.\nHence, for m > 2, E \u20321 = E \u2032\u221e holds and any diagonal p+ q = const contains at\nmost one nonzero group. This proves our statement for m > 2.\nAssume now that m = 2, and consider the first differential d1 : E \u2032r\u22121,r1 \u2192 E \u2032r,r1 .\nWe have\nE \u2032r\u22121,r1 ' H2r\u22121(Fr\u22121, Fr\u22122;Z) =\n{\nZ if r is odd,\nZ2 if r is even\nand\nE \u2032r,r1 ' H2r (Fr , Fr\u22121;Z) =\n{\n0 if r is odd,\nZ if r is even.\nWe see that d1 vanishes since there are no nonzero homomorphisms E \u2032r\u22121,r1 \u2192 E \u2032r,r1\nfor any r .\nThe higher differentials dr , r \u2265 2, vanish for obvious reasons. Hence the conclu-\nsion we made for m > 2 also holds for m = 2.\nThe following theorem is the main result of this section. It describes the multiplicative\nstructure of H\u2217(G \u2032n;Z). Recall that we assume that n is even.\nTHEOREM 12\nFor m > 1 odd, H\u2217(G \u2032n;Z) is the commutative ring given by the sequence of gener-\nators\n\u03b4i \u2208 H2i(m\u22121)(G \u2032n;Z) ' Z, i = 0, 1, 2, . . . ,\nand\ne \u2208 H2(G \u2032n;Z) ' Z2,\nsatisfying the following relations:\n\u03b4i\u03b4 j = (2i + 2 j)!\n(2i)!(2 j)! \u00b7 \u03b4i+ j , \u03b4n\/2 = 0, \u03b40 = 1,\n2e = 0, e(m+1)\/2 = 0.\nTOPOLOGY OF BILLIARD PROBLEMS, II 603\nIf m is even, then H\u2217(G \u2032n;Z) is the graded commutative ring given by the generators\n\u03b4i \u2208 H4i(m\u22121)(G \u2032n;Z) ' Z, i = 0, 1, 2, . . . ,\nand also\ne \u2208 H2(G \u2032n;Z) ' Z2, a \u2208 Hm\u22121(G \u2032n;Z) ' Z, b \u2208 H2m\u22121(G \u2032n;Z) ' Z2,\nsatisfying the following relations:\n\u03b4i\u03b4 j = (2i + 2 j)!\n(2i)!(2 j)! \u00b7 \u03b4i+ j , \u03b4[(n+2)\/4] = 0, \u03b40 = 1,\n2e = 0, em\/2 = 0,\na2 = 0, ab = 0, ae = 0,\n2b = 0, b2 = 0,\n\u03b4kb = 0 (if n = 4k + 2).\nRemark. For m = 2 the generator e disappears since one of the above relations reads\ne = 0. If m is even and n = 2, then b = 0 since one of the relations gives \u03b40b = 0.\nProof\nConsider the universal Z2-bundle S\u221e \u2192 RP\u221e and the associated fibration S\u221e \u00d7Z2\nGn \u2192 RP\u221e, having Gn as the fiber. The total space S\u221e\u00d7Z2 Gn is homotopy equiva-\nlent to G \u2032n . The Serre spectral sequence of this fibration converges to the cohomology\nalgebra H\u2217(G \u2032n;Z). The initial term is\nE p,q2 = H p(RP\u221e;H q\n(\nGn;Z)\n)\n,\nwhereH q(Gn;Z), the cohomology of the fiber, is understood as a local system over\nRP\u221e.\nFrom Theorem 3 we know that Hq(Gn;Z) is either Z or trivial. There are two\ntypes of local systems with fiber Z over RP\u221e, which we denote Z and \u00b1Z. Their\nstructure is determined by the monodromy along any noncontractible loop of RP\u221e,\nwhich is 1 in the case of Z and \u22121 in the case of \u00b1Z.\nAssume first that m > 1 is odd. From formula (2.6) we find that\nH q(Gn;Z) '\n{\nZ for q = 2i(m \u2212 1),\n\u00b1Z for q = (2i + 1)(m \u2212 1),\n604 MICHAEL FARBER\nwhere i = 0, 1, . . . , n\/2 \u2212 1. Hence we find that\nE p,q2 =\n\uf8f1\uf8f4\uf8f4\uf8f4\uf8f4\uf8f2\uf8f4\uf8f4\uf8f4\uf8f4\uf8f3\nZ for p = 0 and q = 2i(m \u2212 1),\nZ2 if p > 0 is even and q = 2i(m \u2212 1)\nor if p is odd and q = (2i + 1)(m \u2212 1),\n0 otherwise,\nwhere i = 0, 1, . . . , n\/2 \u2212 1. As a bigraded algebra, E2 can be identified with the\ntensor product\nE0,\u22172 \u2297 E\u2217,02 \u2297 A,\nwhere\nE0,\u22172 ' H2\u2217(Gn;Z), E\u2217,02 ' H\u2217(RP\u221e;Z),\nand A is an exterior algebra with A0,0 ' Z and A1,m\u22121 ' Z2. If x \u2208 E1,m\u221212 is the\ngenerator, then relation x2 = 0 follows from relation \u03c3 21 = 2\u03c32 (in the notation of\nTheorem 3). Here we denote by H2\u2217(Gn;Z) \u2282 H\u2217(Gn;Z) the graded subring\nH2\u2217(Gn;Z) =\n\u2295\ni\nH2i(m\u22121)(Gn;Z).\nThe structure of the ring H2\u2217(Gn;Z) follows from Theorem 3.\nThe first nontrivial differential is dm . Since we know the additive struc-\nture of H\u2217(G \u2032n;Z) (cf. Theorem 11), we find that the differential d = dm :\nE1,m\u221212 \u2192 Em+1,02 must be an isomorphism. On the other hand, d : E0,2i(m\u22121)2 \u2192\nEm,(2i\u22121)(m\u22121)2 vanishes (since the range is the zero group). It follows that d :\nE p, j (m\u22121)2 \u2192 E p+m,( j\u22121)(m\u22121)2 is nonzero if and only if both p and j are odd.\nFigure 1 shows the nontrivial differential d = dm . The large circles denote group\nZ, and the small circles denote Z2.\nWe conclude that the bigraded algebra Em+1 is isomorphic to the tensor product\nof algebras\nH2\u2217(Gn;Z)\u2297 H\u2217(RPm\u22121;Z),\nwhere H2i(m\u22121)(Gn;Z) has bidegree (0, 2i(m\u22121)) and H2 j (RPm\u22121;Z) has bidegree\n(2 j, 0). It is clear that all further differentials vanish, and hence E\u221e = Em+1. Any\ndiagonal p + q = c contains at most one nonzero group, and hence the algebra\nH\u2217(G \u2032n;Z) coincides with E\u221e. This proves our statement for m > 1 odd.\nAssume now that m is even. Recall that we always assume that n is even. From\nformula (2.6) we find that\nH q(Gn;Z) '\n{\nZ for q = 4i(m \u2212 1) or q = (4i + 1)(m \u2212 1),\n\u00b1Z for q = (4i + 2)(m \u2212 1) or q = (4i + 3)(m \u2212 1),\nTOPOLOGY OF BILLIARD PROBLEMS, II 605\n-\n6\ns\ns\ns\nq q q q q\nq q q q q\nq q q q q\nq q q q q\nq q q q q\nq q q q q\nQ\nQ\nQ\nQ\nQQs\nQ\nQ\nQ\nQ\nQQs\nQ\nQ\nQ\nQ\nQQs\nQ\nQ\nQ\nQ\nQQs\nQ\nQ\nQ\nQ\nQQs\nQ\nQ\nQ\nQ\nQQs\nQ\nQ\nQ\nQ\nQQs\nQ\nQ\nQ\nQ\nQQs\nQ\nQ\nQ\nQ\nQQs\nQ\nQ\nQ\nQ\nQQs\nQ\nQ\nQ\nQ\nQQs\nQ\nQ\nQ\nQ\nQQs\nm \u2212 1\n2(m \u2212 1)\n3(m \u2212 1)\n4(m \u2212 1)\n5(m \u2212 1)\n1 2 m + 1 m + 3 m + 5 p\nq\nFigure 1. Term Em of the spectral sequence for m odd\nassuming that q < n(m \u2212 1). Hence we find that\nE p,q2 =\n\uf8f1\uf8f4\uf8f4\uf8f4\uf8f4\uf8f2\uf8f4\uf8f4\uf8f4\uf8f4\uf8f3\nZ for p = 0 and q = (4i + \u000f)(m \u2212 1), where \u000f = 0, 1,\nZ2 if p > 0 is even and q = (4i + \u000f)(m \u2212 1)\nor if p is odd and q = (4i + 2 + \u000f)(m \u2212 1),\n0 otherwise.\nAs a bigraded algebra, E2 can be identified with the tensor product\nE0,\u22172 \u2297 E\u2217,02 \u2297 B\u2217,\u2217,\nwhere\nE0,\u22172 ' H4\u2217(Gn;Z)\u2297 C\u2217, E\u2217,02 ' H\u2217(RP\u221e;Z),\nC\u2217 is an exterior algebra with C0 ' Z and Cm\u22121 ' Z, and B\u2217,\u2217 is an exterior\nbigraded algebra with B0,0 ' Z and B1,2(m\u22121) ' Z2. If y \u2208 E1,2(m\u22121)2 denotes the\ngenerator, then y2 = 0 follows from relation \u03c3 22 = 2\u03c34 (cf. Theorem 3). We denote\n606 MICHAEL FARBER\n-\n6\ns\ns\ns\ns\ns\ns\nq q q q qq q q q q\nq q q q q\nq q q q q\nq q q q q\nq q q q q\nq q q q q\nq q q q q\nq q q q q\nq q q q q\nq q q q q\nq q q q q\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nHHHj\nm \u2212 1\n2(m \u2212 1)\n3(m \u2212 1)\n4(m \u2212 1)\n5(m \u2212 1)\n6(m \u2212 1)\n7(m \u2212 1)\n8(m \u2212 1)\n9(m \u2212 1)\nm m + 2 m + 4 p\nq\nFigure 2. Term Em of the spectral sequence for m even\nby H4\u2217(Gn;Z) \u2282 H\u2217(Gn;Z) the graded subring\nH4\u2217(Gn;Z) =\n\u2295\ni\nH4i(m\u22121)(Gn;Z).\nConsider now the first nontrivial differential d = dm : E p,q2 \u2192 E p+m,q\u2212m+12 .\nIt is clear that it may be nonzero only for q of the form q = (2i + 1)(m \u2212 1). On\nthe other hand, since we know the additive structure of the limit (cf. Theorem 11), we\nconclude that d : E0,m\u221212 = Z \u2192 Em,02 = Z2 is surjective. Using the multiplicative\nproperties of the spectral sequence, we find that all the differentials shown in Figure\n2 are epimorphic. In fact, all differentials in Figure 2, except those that start at the\nq axis, are isomorphisms (since they act between isomorphic groups). As before, the\nlarge circles denote Z and the small circles denote Z2.\nHence, moving to the next term, Em+1, classes \u03c34i = \u03b4i survive, as do a = 2\u03c31,\ne \u2208 E2,0m+1 ' Z2, and b \u2208 E1,2(m\u22121)m+1 and their products \u03b4i a, \u03b4i e j , and \u03b4i be j with\nj < m\/2. It is clear that all further differentials vanish and that in each diagonal\np + q = c there is at most one nonzero group. Therefore we conclude that the ring\nTOPOLOGY OF BILLIARD PROBLEMS, II 607\nH\u2217(G \u2032n;Z) is isomorphic to Em+1. Its structure coincides with the description given\nin Theorem 12.\n4. Equivariant Lusternik-Schnirelman theory via nonsmooth critical\npoint theory\nIn this section we first recall the basic notions of the critical point theory for nons-\nmooth functions, suggested recently in [4] and [5]. Then we apply the nonsmooth crit-\nical point theory to get a simple independent exposition of a version of the equivariant\nLusternik-Schnirelman theory of [11] and [3], which we need for our applications to\nthe billiard problems. One of the advantages of our approach is its applicability to\nmanifolds with boundary.\nLet X be a metric space endowed with the metric d . Given a point p \u2208 X and\n\u03b4 > 0, we denote by B(p, \u03b4) \u2282 X the ball of radius \u03b4 centered at p.\nDefinition 13\nLet f : X \u2192 R be a continuous function. The weak slope of f at a point p \u2208 X ,\ndenoted |d f |(p), is defined as the supremum of all \u03c3 \u2208 [0,\u221e] such that there exist\n\u03b4 > 0 and a continuous deformation \u03b7 : B(p, \u03b4) \u00d7 [0, \u03b4] \u2192 X with the following\nproperties:\nd\n(\n\u03b7(q, t), q\n) \u2264 t, f (\u03b7(q, t)) \u2264 f (q)\u2212 \u03c3 t\nfor all q \u2208 B(p, \u03b4), t \u2208 [0, \u03b4].\nA point p \u2208 X is said to be a critical point of function f if |d f |(p) = 0.\nExample 14\nLet X be a smooth Riemannian manifold without boundary, and let f : X \u2192 R\nbe a smooth function. Then the weak slope |d f |(p) coincides with the norm of the\ndifferential ||d f (p)||, viewed as a bounded linear functional on the tangent space\nTp(X).\nExample 15\nLet X be a smooth Riemannian manifold with boundary, and let f : X \u2192 R be\na smooth function. A point on the boundary p \u2208 \u2202X is a critical point of f if and\nonly if there is no tangent vector v \u2208 Tp X pointing inside X such that the derivative\nv( f ) < 0 is negative. The last condition implies that\nd f p|Tp\u2202X = 0, (4.1)\nthat is, that the gradient of f at point p \u2208 \u2202X is orthogonal to the boundary \u2202X .\nA point p \u2208 \u2202X is a critical point of f if and only if (4.1) holds and the gradient\nof f at p points inwards. It is clear that the above conditions are independent of the\nRiemannian metric.\n608 MICHAEL FARBER\nPROPOSITION 16\nLet f : X \u2192 R be a continuous function on a compact metric space X. Then the\nnumber of critical points of f (in the sense of Definition 13) is at least cat(X), the\nLusternik-Schnirelman category of X.\nThis follows from the much more general [5, Theorem 3.7].\nWe apply the nonsmooth critical point theory to the equivariant critical point\ntheory of smooth functions (cf. [11], [3]).\nPROPOSITION 17\nLet M be a smooth compact G-manifold with boundary, where G is a finite group.\nLet f : M \u2192 R be a G-invariant smooth function. Suppose that at points of the\nboundary p \u2208 \u2202M the gradient of f does not vanish and is directed outwards. Then\nthe number of G-orbits of points p \u2208 M with d f p = 0 is at least cat(M\/G).\nProof\nLet X denote the space of orbits X = M\/G. Function f determines a continuous\nfunction f\u02dc : X \u2192 R. We want to show that any orbit x \u2208 X , representing points\np \u2208 X with d f p 6= 0, is not a critical point of f\u02dc : X \u2192 R in the sense of Definition\n13. This implies that the number of critical orbits of f is at least the number of critical\npoints of f\u02dc ; the latter can be estimated from below by cat(X) in Proposition 16.\nWe assume that M is supplied with a G-invariant Riemannian metric. Let p \u2208 M\nbe a point with d f p 6= 0. We want to construct a smooth vector field v in a neighbor-\nhood of the orbit of p having the following properties:\n(a) v( f )p < 0;\n(b) the norm of vector vp equals 1;\n(c) v is G-invariant;\n(d) if p belongs the boundary \u2202M , the vector vp points inside M .\nTo construct such a vector field v, one first finds a vector vp \u2208 Tp M for each point\np of the orbit so that (a), (b), and (d) are satisfied. It is then possible to extend the\nvectors vp to form a smooth vector field v in a neighborhood of the orbit of p with\nproperties (a), (b), and (d). Then (c) can be achieved by averaging.\nThe flow determined by the vector field v gives a deformation of the ball around\nthe point {p} \u2208 X , which represents the orbit of p, showing that the slope |d f\u02dc |(p) is\npositive.\n5. Proof of Theorem 1\nLet T \u2282 Rm+1 be a compact strictly convex domain bounding a smooth hypersurface\nX = \u2202T . Given a point A \u2208 X and an integer n, consider the configuration space\nTOPOLOGY OF BILLIARD PROBLEMS, II 609\nGn = G(X; A, A, n) (cf. (2.1)) and the smooth function\nL X : Gn \u2192 R, L X (x1, . . . , xn) = \u2212\ni=n\u2211\ni=0\n|xi \u2212 xi+1|\n(the negative total length), where we understand that x0 = A = xn+1. This function is\ninvariant with respect to the reflection T : Gn \u2192 Gn (cf. (2.2)). Hence L X determines\na continuous function\nL \u2032X : G \u2032n \u2192 R, G \u2032n = Gn\/T, (5.1)\nand the critical points of L \u2032X (in the sense of Definition 13) are in one-to-one cor-\nrespondence with the Z2-orbits of the closed billiard trajectories in X which start\nand end at A and make n reflections. This follows from [7, Lemma 2] and from the\nargument in the proof of Proposition 17.\nNote that, for n even, T acts freely on Gn , the factor G \u2032n = Gn\/T is a smooth\nmanifold, and the function L \u2032X is smooth. In this case the nonsmooth critical point\ntheory coincides with the usual one.\nWe claim the following.\nThe number of critical points of L \u2032X is at least the Lusternik-Schnirelman category\ncat(G \u2032n); moreover, assuming that n is even and the function L \u2032X is Morse, the number\nof critical points of (5.1) is at least the sum of the Betti numbers of G \u2032n with Z2\ncoefficients.\nThe italicized statement does not follow directly from the traditional Morse-\nLusternik-Schnirelman theory since G \u2032n is not compact. However, as in [8] and [7],\none may fix \u000f > 0 and consider the following compact subset:\nG\u000f \u2282 Gn, G\u000f =\n{\n(x1, . . . , xn) \u2208 X\u00d7n :\nn\u220f\ni=0\n|xi \u2212 xi+1| \u2265 \u000f\n}\n.\nIf \u000f > 0 is small enough, then\n(a) G\u000f is a compact manifold with boundary;\n(b) the inclusion G\u000f \u2282 Gn is a Z2-equivariant homotopy equivalence;\n(c) all critical points of L X are contained in G\u000f ;\n(d) at every point of \u2202G\u000f, the gradient of L X is directed outwards\n(cf. [8, Proposition 4.1], [7, Proposition 4]).\nSince G \u2032\u000f = G\u000f\/T is a compact smooth manifold with boundary, we may ap-\nply the Morse-Lusternik-Schnirelman theory to it. Condition (d) implies that the\ncritical points of the restriction of L \u2032X on \u2202G \u2032\u000f should not be taken into account\n(cf. Proposition 17). Therefore the number of critical points of L \u2032X |G \u2032\u000f is at least\ncat(G \u2032\u000f) = cat(G \u2032n). If L \u2032X |G \u2032\u000f is Morse, then the number of its critical points is at\n610 MICHAEL FARBER\nleast the sum of Betti numbers of G \u2032\u000f , which is the same as the sum of Betti numbers\nof G \u2032n .\nIn the proof of Theorem 1(I), we use the following general simple remark.\nFor any regular covering map p : X\u02dc \u2192 X with connected X\u02dc ,\ncat(X) \u2265 cat(X\u02dc). (5.2)\nIndeed, if A \u2282 X is an open subset that is contractible to a point in X, then A\u02dc =\np\u22121(A) is a disjoint union of open subsets of X\u02dc , such that each is contractible to a\npoint in X\u02dc . Hence any categorical open cover A1 \u222a A2 \u222a \u00b7 \u00b7 \u00b7 \u222a Ak = X produces a\ncategorical open cover A\u02dc1 \u222a A\u02dc2 \u222a \u00b7 \u00b7 \u00b7 \u222a A\u02dck of X\u02dc .\nThe above remark applies to the two-fold cover Gn \u2192 G \u2032n giving\ncat(G \u2032n) \u2265 cat(Gn) \u2265 cl(Gn)+ 1,\nwhere cl(Gn) is the cohomological cup length of Gn (Froloff-Elsholz theorem).\nNow we use Theorem 3 to compute the cup length of Gn . If m \u2265 3 is odd,\nthen \u03c3 n\u221211 = (n \u2212 1)!\u03c3n\u22121 6= 0 \u2208 H (n\u22121)(m\u22121)(Gn;Z) and hence cl(Gn) = n \u2212 1.\nTherefore cat(G \u2032n) \u2265 n. This proves Theorem 1(I) in the case when m \u2265 3 is odd.\nIf m is even, then the longest nontrivial cup product in H\u2217(Gn;Z) is \u03c31\u03c3 k\u221212\nwhere n = 2k. We conclude that, for m even, the cup length of Gn equals n\/2 and\ntherefore cat(G \u2032n) \u2265 n\/2 + 1. Together with the information collected above, this\nproves Theorem 1(I) for m even.\nTo prove Theorem 1(II), we use Theorem 12 to estimate the Lusternik-\nSchnirelman category of G \u2032n . Note that Theorem 12 requires the assumption that n\nis even. Suppose first that m \u2265 3 is odd. Then (in the notation of Theorem 12) we\nhave a nonzero cohomology product\n\u03b41\u03b42\u03b422 \u00b7 \u00b7 \u00b7 \u03b42s e(m\u22121)\/2, (5.3)\nwhere s is the largest integer with 2s+1\u22121 \u2264 n\/2\u22121, that is, where s = [log2(n)]\u22122.\nNote that the class e \u2208 H2(G \u2032n;Z) has order 2; that is, 2e = 0. Nontriviality of the\nabove product is equivalent to the claim that the product \u03b41\u03b42\u03b422 \u00b7 \u00b7 \u00b7 \u03b42s is an odd\nmultiple of the class \u03b41+2+22+\u00b7\u00b7\u00b7+2s . Indeed, we use the relation\n\u03b4i\u03b4 j =\n(\n2i + 2 j\n2i\n)\n\u03b4i+ j\nand the well-known fact that the binomial coefficient\n( 2i+2 j\n2i\n)\nis even if and only if i\nand j , in their binary expansions, have a 1 in the same position.\nNow we use the notion of category weight of a cohomology class, introduced by\nFadell and Husseini [6]. They associate weights to cohomology classes, so that non-\ntriviality of a cup product v1\u222av2\u222a\u00b7 \u00b7 \u00b7\u222avm implies that the Lusternik-Schnirelman cat-\negory of the space is greater than the sum of the weights of the classes v1, v2, . . . , vm .\nTOPOLOGY OF BILLIARD PROBLEMS, II 611\nHence, instead of counting each cohomology class vi as contributing 1 into the total\ncup-length estimate, in the approach of Fadell and Husseini we count the contribution\nof vi according to its category weight.\nWe claim that the category weight of e \u2208 H2(G \u2032n;Z) equals 2. Indeed, e\nequals the image of a class e\u2032 \u2208 H1(G \u2032n;Z2) under the Bockstein homomorphism\n\u03b2 : H1(G \u2032n;Z2)\u2192 H2(G \u2032n;Z); that is, e = \u03b2(e\u2032). Hence, by Fadell and Husseini in\n[6, Theorem (1.2)], the category weight of e is 2. Therefore nontriviality of product\n(5.3) implies\ncat(G \u2032n) \u2265 (s + 1)+ 2 \u00b7\nm \u2212 1\n2\n+ 1 = [log2 n] + m \u2212 1.\nThis proves Theorem 1(II) for m \u2265 3 odd.\nConsider now the case when m \u2265 2 is even. First we assume that n \u2265 8 and that\nn + 2 is not a power of 2. Then we have a nontrivial cohomological product\n\u03b41\u03b42\u03b422 \u00b7 \u00b7 \u00b7 \u03b42s be(m\u22122)\/2, (5.4)\nwhere s = [log2[(n + 2)\/4]] \u2212 1. As above, nontriviality of (2.3) implies\ncat(G \u2032n) \u2265 (s + 1)+ 1+ 2 \u00b7\nm \u2212 2\n2\n+ 1 =\n[\nlog2\n[n + 2\n4\n]]\n+ m \u2265 [log2 n] + m \u2212 2.\nIf n + 2 = 2r is a power of 2, where r \u2265 4, then the product\n\u03b41\u03b42\u03b422 \u00b7 \u00b7 \u00b7 \u03b42s e(m\u22122)\/2\n(we skip b because of the last relation in Theorem 12) is nonzero, where s = r \u2212 3.\nIn this case we obtain\ncat(G \u2032n) \u2265 (s + 1)+ 2 \u00b7\nm \u2212 2\n2\n+ 1 = s + m = [log2 n] + m \u2212 2.\nWe are left to consider the cases n = 2, 4, 6 with m even. Here we have a\nnontrivial cup product be(m\u22122)\/2, and hence\ncat(G \u2032n) \u2265 1 + 2 \u00b7\nm \u2212 2\n2\n+ 1 = m.\nThis implies the estimate of Theorem 1(II) for the specified values of n and m.\nFor m > 1, Theorem 1(III) follows from Corollary 8. If m = 1, then the space\nG \u20321 = G(S1; A, A, n)\/Z2 consists of n\/2 connected components and each is con-\ntractible; this can be established by arguments similar to those used in [7, \u00a77]. Hence\nthe sum of Betti numbers of G \u20321 is n\/2.\n612 MICHAEL FARBER\n6. Cohomology of cyclic configuration spaces of spheres\nThe cyclic configuration space G(X, n) of a space X is defined (cf. [8]) as the set\nof all configurations (x1, . . . , xn) \u2208 X\u00d7n with xi 6= xi+1 for i = 1, . . . , n \u2212 1 and\nxn 6= x1. The dihedral group Dn acts naturally on G(X, n).\nIn [8] M. Farber and S. Tabachnikov showed that information about the coho-\nmology ring of the factor space G(Sm, n)\/Dn leads to estimates of the number of\nn-periodic orbits of convex billiards in (m + 1)-dimensional space Rm+1. The rings\nH\u2217(G(Sm, n);Z2) and H\u2217(G(Sm, n)\/Dn;Z2) were computed in [8].\nIn this section we describe the cohomology of the cyclic configuration space\nG(Sm, n) with other fields of coefficients. It turns out that the answer depends on the\nparity of m; therefore we state the even- and odd-dimensional cases in the form of\ntwo separate theorems.\nThe results of this section are used in the proof of Theorem 2.\nTHEOREM 18\nLet m \u2265 3 be odd. The ring H\u2217(G(Sm, n);Q) is given by generators\nu \u2208 Hm(G(Sm, n);Q), \u03c3i \u2208 H i(m\u22121)(G(Sm, n);Q), i = 1, . . . , n \u2212 2,\nand relations\nu2 = 0, \u03c3i\u03c3 j =\n{\n(i+ j)!\ni !\u00b7 j ! \u00b7 \u03c3i+ j if i + j \u2264 n \u2212 2,\n0 if i + j > n \u2212 2. (6.1)\nOne may show that the statement of Theorem 18 holds, with Q replaced by an arbi-\ntrary field of coefficients k. However, the short proof we give below works only in the\ncase k = Q. On the other hand, for the purposes of this paper, it is enough to know\nthe rational cohomology H\u2217(G(Sm, n);Q). The case of a field k of positive charac-\nteristic may be proven by using [8, Theorem 3] and computing the spectral sequence\nas in the proof of [8, Theorem 4].\nThe following theorem gives the answer for m even.\nTHEOREM 19\nLet k be a field of characteristic not equal to 2. For any even m \u2265 2 and odd n \u2265 3,\nthe cohomology algebra H\u2217(G(Sm, n);k) is given by generators\nw \u2208 H2m\u22121(G(Sm, n);k), \u03c32i \u2208 H2i(m\u22121)(G(Sm, n);k), i = 1, . . . , n \u2212 32 ,\nand relations\nw2 = 0, \u03c32i\u03c32 j =\n{\n(i+ j)!\ni !\u00b7 j ! \u00b7 \u03c32(i+ j) if i + j \u2264 n\u221232 ,\n0 if i + j > n\u221232 .\n(6.2)\nTOPOLOGY OF BILLIARD PROBLEMS, II 613\nx\nv(x)\nx1 = x x2\nx3\nxn = \u2212x xn\u22121\nFigure 3. Continuous family of configurations\nProof of Theorem 18\nConsider the fibration\np : G(Sm, n)\u2192 Sm, (6.3)\nwhere the image of a cyclic configuration (x1, . . . , xn) \u2208 G(Sm, n) under projec-\ntion p is given by p(x1, . . . , xn) = x1. The fiber of p is the configuration space\nG(Sm; A, A, n\u22121). Consider the Serre spectral sequence of this fibration. The coho-\nmology of the fiber G(Sm; A, A, n \u2212 1) is described by Theorem 3; it has generators\n\u03c31, . . . , \u03c3n\u22122, which multiply according to (2.3).\nThis spectral sequence may have only one nonzero differential dm . We show that\nthis differential vanishes; that is, dm = 0. This clearly implies our statement.\nSince we may write \u03c3i = (i !)\u22121(\u03c31)i , it is enough to show that dm(\u03c31) = 0.\nVanishing dm(\u03c31) = 0 follows from the fact that fibration (6.3) admits a continuous\nsection s : Sm \u2192 G(Sm, n), and thus the transgression is trivial. To construct s, fix\na nowhere zero tangent vector field V on the sphere Sm . (Recall that m is odd.) For\nx \u2208 Sm , the tangent vector V (x) determines a half-circle starting at x , tangent to\nV (x), and ending at the antipodal point \u2212x . Then the section s can be defined by\ns(x) = (x1, x2, . . . , xn), x \u2208 Sm,\nwhere x1 = x, xn = \u2212x and the points x2, . . . , xn\u22121 are situated on the half-circle\nmaking equal angles as shown in Figure 3. Analytically, we may write\nx j = cos\n( ( j \u2212 1)pi\nn \u2212 1\n)\nx + sin\n( ( j \u2212 1)pi\nn \u2212 1\n)\nV (x), j = 1, . . . , n.\nProof of Theorem 19\nFirst we assume that m > 2; the case m = 2 is treated separately later.\n614 MICHAEL FARBER\nWe describe the additive structure of H\u2217(G(Sm, n);k) using the Morse theory\napproach. Let Sm \u2282 Rm+1 be the unit sphere. Consider the total length function\nL : G(Sm, n)\u2192 R,\nwhere for (x1, . . . , xn) \u2208 G(Sm, n) we have\nL(x1, x2, . . . , xn) = \u2212|x1 \u2212 x2| \u2212 |x2 \u2212 x3| \u2212 \u00b7 \u00b7 \u00b7 \u2212 |xn \u2212 x1|.\nThe critical points of L are n-periodic billiard trajectories in the unit sphere; hence\nthe critical configurations are regular n-gons lying in 2-dimensional central sections\nof the sphere. A regular n-gon is determined by two first vectors x1, x2 \u2208 Sm , which\nmust make an angle of the form\n\u03b1p = 2pi\nn\n\u00b7\n(n \u2212 1\n2\n\u2212 p\n)\n, where p = 0, 1, . . . , n \u2212 3\n2\n.\nRecall that we assume that n is odd. Fixing p = 0, 1, . . . , (n \u2212 3)\/2, we obtain a\nvariety of critical configurations, which we denote by Vp \u2282 G(Sm, n). Each Vp has\ndimension 2m \u2212 1 and is diffeomorphic to the Stiefel manifold of pairs of mutually\northogonal vectors in Rm+1. Since we assume that m is even and that the character-\nistic of k is 6= 2, we have H\u2217(Vp;k) ' H\u2217(S2m\u22121;k). Note also that Vp is simply\nconnected (since m > 2).\nBabenko has shown (cf. [1, Proposition 3.1]) that function L is nondegenerate in\nthe sense of Bott and that the index of each critical submanifold Vp equals 2p(m\u22121).\nMoreover, it is clear that L(Vp) < L(Vp\u2032) for p < p\u2032.\nFix \u03b5 > 0 small enough, and consider the submanifold G\u03b5(Sm, n) \u2282 G(Sm, n),\nwhere\nG\u03b5(Sm, n) =\n{\n(x1, . . . , xn) \u2208 (Sm)\u00d7n :\nn\u220f\ni=1\n|xi \u2212 xi+1| \u2265 \u03b5\n}\n.\nIf \u03b5 > 0 is sufficiently small, then (according to [8, Proposition 4.1]) G\u03b5(Sm, n) is\na compact manifold with boundary containing all the critical points of L and such\nthat the inclusion G\u03b5(Sm, n) \u2282 G(Sm, n) is a Dn-equivariant homotopy equivalence.\nMoreover, at every point of the boundary \u2202G\u03b5(Sm, n), the gradient of L extends out-\nward.\nChoose constants c0, c1, . . . , c(n\u22123)\/2 such that L(Vp) < cp < L(Vp+1) for\n0 \u2264 p < (n \u2212 3)\/2 and c(n\u22123)\/2 = 0. Let\nFp = L\u22121\n(\n(\u2212\u221e, cp]\n) \u2229 G\u03b5(Sm, n).\nWe obtain a filtration F0 \u2282 F1 \u2282 \u00b7 \u00b7 \u00b7 \u2282 F(n\u22123)\/2 = G\u03b5(Sm, n). Since the inclusion\nF(n\u22123)\/2 \u2282 G(Sm, n) is a homotopy equivalence, we may use the spectral sequence\nof this filtration to calculate the cohomology of G(Sm, n).\nTOPOLOGY OF BILLIARD PROBLEMS, II 615\nWe claim that this filtration is perfect, that is, that the Poincare\u00b4 polynomial of the\ncyclic configuration space G(Sm, n) equals the sum of the Poincare\u00b4 polynomials of\nthe pairs (Fp, Fp\u22121). The initial term of the spectral sequence is\nE p,q1 = H p+q(Fp, Fp\u22121;k).\nUsing the Thom isomorphism (recall that Vp is simply connected), we find that\nH j (Fp, Fp\u22121;k) is isomorphic to H j\u22122p(m\u22121)(Vp;k); hence H j (Fp, Fp\u22121;k) is\n1-dimensional for j = 2p(m \u2212 1) and for j = 2p(m \u2212 1)+ 2m \u2212 1 and vanishes for\nall other values of j . This follows since in Fp+1 \u2212 Fp there is a single nondegenerate\ncritical submanifold Vp which has index 2p(m\u22121) and is diffeomorphic to the Stiefel\nmanifold Vm+1,2.\nThe gradient of L at points of the boundary \u2202G\u03b5(Sm, n) extends outward, and\nhence, the points of the boundary do not contribute to the usual statements of the\nMorse-Bott critical point theory.\nFor a given p there are precisely two values of q such that E p,q1 is nonzero (q =\np(2m \u2212 3) and q = p(2m \u2212 3) + 2m \u2212 1). From the geometry of the differentials,\nwe see that all the differentials dr , r \u2265 1, must vanish if m > 2. This proves that\nthe cohomology H j (G(Sm, n);k) is 1-dimensional for j = 2p(m \u2212 1) and j =\n2p(m\u2212 1)+ 2m\u2212 1, where p = 0, 1, . . . , (n\u2212 3)\/2, and H j (G(Sm, n);k) vanishes\nfor other values of j .\nHaving recovered the additive structure of H\u2217(G(Sm, n);k), we may use The-\norem 3 to find its multiplicative structure. The mapping (x1, x2, . . . , xn) 7\u2192 x1 is a\nSerre fibration G(Sm, n)\u2192 Sm ; its fiber is G(Sm : A, A, n \u2212 1). The Serre spectral\nsequence has only two nonzero columns, and dm is the only differential that could be\nnonzero. In the zeroth columns we have classes \u03c3i in dimensions i(m \u2212 1), and in the\nmth column we have classes \u03c3i u having dimension i(m \u2212 1) + m (cf. Theorem 3).\nSince we already know the additive structure of H\u2217(G(Sm, n);k), we conclude that\nthe differential\ndm : E0,i(m\u22121)2 \u2192 Em,(i\u22121)(m\u22121)2\nis an isomorphism for i odd and vanishes for i even. Hence the classes \u03c32i and \u03c32i+1u\nsurvive. Now, we set w = \u03c31u, and we conclude that H\u2217(G(Sm, n);k) has the mul-\ntiplicative structure stated in Theorem 19.\nFor m = 2 the above argument, based on the spectral sequence of the filtration\nF0 \u2282 F1 \u2282 \u00b7 \u00b7 \u00b7 \u2282 F(n\u22123)\/2 = G\u03b5(Sm, n), is not sufficient since, in principle, this\nspectral sequence could have a nonzero differential, as shown in Figure 4. Also, for\nm = 2 the critical submanifolds Vp are not simply connected, and so the Thom iso-\nmorphisms for the negative normal bundles of the Hessian may require additional\ntwists by flat line bundles (depending on the orientability of the negative normal bun-\ndles of the critical submanifolds).\n616 MICHAEL FARBER\n-\n6\ns\ns s\ns s\ns\ns\ns\ns\ns\ns\np\nq\nHHHj\nHHHj\nHHHj\nHHHj\nFigure 4. Nonzero terms of the spectral sequence for m = 2\nHowever, in the case m = 2, a different argument can be applied. Consider the\naction of SO(3) on G(S2, n) arising from the standard action of SO(3) on S2. Fix a\npoint A \u2208 S2, and consider G(S2; A, A, n \u2212 1) as being canonically embedded in\nG(S2, n). We obtain the map\nSO(3)\u00d7 G(S2; A, A, n \u2212 1)\u2192 G(S2, n), (R, c) 7\u2192 Rc, (6.4)\ngiven by applying an orthogonal matrix R \u2208 SO(3) to a configuration of points on the\nsphere c \u2208 G(S2; A, A, n\u22121). It is easy to see that (6.4) is a fibration with fiber S1. If\nc = (A, x1, . . . , xn\u22121) is a configuration of points on S2 such that A 6= x1, xi 6= xi+1\nfor i = 1, . . . , n \u2212 1 and xn\u22121 6= A, then the fiber of fibration (6.4) over c consists of\nthe space of all pairs (R\u2212\u03c6, R\u03c6(c)), where R\u03c6 \u2208 SO(3) denotes the rotation by angle\n\u03c6 \u2208 [0, 2pi ] about A.\nThe cohomology algebra of the total space of this fibration,\nH\u2217\n(\nSO(3)\u00d7 G(S2; A, A, n \u2212 1);k) ' H\u2217(S3;k)\u2297 H\u2217(G(S2; A, A, n \u2212 1);k),\nis given by Theorem 3. It has a generator w with degw = 3 (coming from a generator\nof H3(SO(3);k)) and also classes \u03c3i , where i = 0, 1, . . . , n \u2212 2, with deg \u03c3i = i ,\nwhich are pullbacks of the generators of H\u2217(G(S2; A, A, n \u2212 1);k) (cf. Theorem 3).\nWe have the relation w2 = 0, and each product \u03c3i\u03c3 j equals a multiple of \u03c3i+ j , the\ncoefficient indicated in formula (2.4).\nLet us show that the restriction map from the total space to the fiber\nH1\n(\nSO(3)\u00d7 G(S2; A, A, n \u2212 1);k)\u2192 H1(S1;k)\nTOPOLOGY OF BILLIARD PROBLEMS, II 617\nis surjective. Since H1(SO(3);k) = 0, our statement is equivalent to the following.\nLet c = (A, x1, . . . , xn\u22121) be a fixed configuration. We obtain an embedding f :\nS1 \u2192 G(S2; A, A, n \u2212 1) given by \u03c6 7\u2192 R\u03c6(c), where \u03c6 \u2208 [0, 2pi ]. We claim that\nthe induced map f \u2217 : H1(G(S2; A, A, n\u22121);k)\u2192 H1(S1;k) is surjective. In other\nwords, we want to show that the cohomology class f \u2217(\u03c31) \u2208 H1(S1;k) is nonzero.\nWe may assume that the antipode A\u2032 of A does not appear in the configuration c.\nIdentify S2 \u2212 A\u2032 with R2 using the stereographic projection with A\u2032 as a center; this\nleads to the following commutative diagram:\nS1\ng \/\/\nf\n&&NN\nNNN\nNNN\nNNN\nN G(R\n2; 0, 0, n \u2212 1)\nh\n\u000f\u000f\nG(S2; A, A, n \u2212 1)\nwhere g is given by rotations of a fixed configuration c\u2032 = (0, y1, y2, . . . , yn\u22121) of\npoints on the plane, c\u2032 \u2208 G(R2; 0, 0, n \u2212 1), around the origin 0 \u2208 R2. Clearly, the\nspace G(R2; 0, 0, n \u2212 1) is homotopy equivalent to G(R2, n), and thus the coho-\nmology algebra H\u2217(G(R2; 0, 0, n \u2212 1);k), as given by [8, Proposition 2.2], has 1-\ndimensional generators s1, . . . , sn which satisfy the relations s2i = 0 for i = 1, . . . , n\nand also a relation of degree n\u22121 (cf. [8, formula (4)]). From [7, Remark 9] we obtain\nh\u2217(\u03c31) =\nn\u2211\ni=1\n(\u22121)i+1si . (6.5)\nLet s \u2208 H1(S1;k) denote the generator corresponding to the usual anticlockwise\norientation of the circle. Then\ng\u2217(si ) = s, i = 1, 2, . . . , n. (6.6)\nIndeed, g\u2217(si ) = di s, where di is the degree of the following map S1 \u2192 S1,\n\u03c6 7\u2192 R\u03c6(yi )\u2212 R\u03c6(yi\u22121)|R\u03c6(yi )\u2212 R\u03c6(yi\u22121)| = R\u03c6\n( yi \u2212 yi\u22121\n|yi \u2212 yi\u22121|\n)\n, \u03c6 \u2208 [0, 2pi ],\nand hence it is clear that di = 1. Here R\u03c6 denotes the plane rotation by angle \u03c6.\nComparing (6.5) and (6.6), we obtain\nf \u2217(\u03c31) = g\u2217h\u2217(\u03c31) = g\u2217\n( n\u2211\ni=1\n(\u22121)i+1si\n)\n= s,\nwhere we have used the assumption that n is odd. (Note that, for n even, the above\narguments give f \u2217(\u03c31) = 0.)\n618 MICHAEL FARBER\nLet us examine the Serre spectral sequence of fibration (6.4). First we observe\nthat the fundamental group of the base acts trivially on the cohomology of the fiber.\nThis follows since (6.4) is induced from the standard fibration\nq : SO(3)\u2192 S2, where q(R) = R(A), R \u2208 SO(3),\nby the map G(S2, n)\u2192 S2 given by (x1, . . . , xn) 7\u2192 x1. The Serre spectral sequence\nof (6.4) has two rows and may have one nontrivial differential. Since we know that\nthe fundamental class of the fiber s \u2208 H1(S1;k) survives, that is, applying the differ-\nential to it gives zero, it follows that all the differentials in the Serre spectral sequence\nvanish. We conclude that the cohomology algebra of the base H\u2217(G(S2, n);k) is the\nfactor of H\u2217(SO(3) \u00d7 G(S2; A, A, n \u2212 1);k) with respect to the ideal generated by\nclass \u03c31. Since \u03c32i+1 = \u03c31\u03c32i , we obtain that H\u2217(G(S2, n);k) has generators w with\ndegw = 3 and \u03c32i with deg \u03c32i = 2i , where i = 0, 1, . . . , (n \u2212 3)\/2, which satisfy\nrelations (6.2).\nRelation between cyclic configuration spaces of spheres and spaces of paths\nIn this section we describe the relations between the cyclic configuration spaces of\nspheres and some spaces of paths. We do not give the proofs since they are similar\n(almost identical) to the proof of [7, Theorem 12]. The results mentioned here are not\nused in the rest of this paper.\nLet L (Sm) denote the space of free loops in Sm , that is, the space of all H1-\nsmooth maps S1 \u2192 Sm . We refer to [9, Chapter 5] for the basic definitions. We\ndenote byL (Sm)n \u2282 L (Sm) the subspace of all loops having length less than pin.\nFor n even, there is a continuous map \u03c8 : G(Sm, n) \u2192 L (Sm)n which acts as\nfollows. Given a configuration of points c = (x1, x2, . . . , xn) \u2208 G(Sm, n), define a\nsequence (y1, . . . , yn) \u2208 (Sm)\u00d7n , where yi = (\u22121)i xi . Then for any i = 1, . . . , n,\nthe points yi and yi+1 are not antipodal and hence we may join them by a shortest\ngeodesic arc of Sm ; here yn+1 is understood to be y1. Union of these arcs gives a\nclosed loop \u03c8(c) having length< pin. In a manner similar to that of [7, Theorem 12],\none may show that \u03c8 is a homotopy equivalence.\nFor the billiard problem we are mainly interested in the spaces G(Sm, n) with n\nodd. The corresponding space of paths can be described as follows. Let L \u2217(Sm) de-\nnote the space of all H1-smooth paths \u03c9 : [0, 1] \u2192 Sm , such that the end points are\nantipodal, \u03c9(0) = \u2212\u03c9(1). Projecting onto RPm , we obtain closed noncontractible\nloops in RPm . In fact, L \u2217(Sm) may be identified with a two-fold cover of the con-\nnected component of the free loop spaceL (RPm), consisting of noncontractible free\nloops in RPm .\nWe denote byL \u2217(Sm)n \u2282 L \u2217(Sm) the subspace of paths having length less than\npin. In a manner similar to the case of n even and [7, Theorem 12], one may show the\nfollowing.\nTOPOLOGY OF BILLIARD PROBLEMS, II 619\nFor any n > 2 odd, there exists a natural homotopy equivalence \u03c8 :\nG(Sm, n) \u2192 L \u2217(Sm)n . In particular, for odd n \u2192 \u221e, the space\nG(Sm, n) approximates the spaceL \u2217(Sm).\nIt is easy to show that, for m odd, the path space L \u2217(Sm) is homotopy equivalent to\nthe free loop space L (Sm). It follows using the remark that, for m odd, the antidi-\nagonal D : Sm \u2192 Sm \u00d7 Sm , where D(x) = (x,\u2212x), is homotopic to the diagonal\nx 7\u2192 (x, x).\nFor m even, the spaces L (Sm) and L \u2217(Sm) are not homotopy equivalent. For\nexample, pi1(L (S2)) ' Z and pi1(L \u2217(S2)) ' Z2.\n7. Proof of Theorem 2\nLet T \u2282 Rm+1 be a compact strictly convex domain with smooth boundary X = \u2202T .\nConsider the smooth function\nL X : G(X, n)\u2192 R, L X (x1, . . . , xn) = \u2212\ni=n\u2211\ni=1\n|xi \u2212 xi+1|\n(the negative total length), where we understand the indices cyclically modulo n, that\nis, where xn+1 = x1. The critical points of L X are in one-to-one correspondence with\nn-periodic billiard trajectories in X .\nFix \u000f > 0, and consider\nG\u000f \u2282 G(X, n), G\u000f =\n{\n(x1, . . . , xn) \u2208 X\u00d7n :\nn\u220f\ni=1\n|xi \u2212 xi+1| \u2265 \u000f\n}\n.\nAccording to [8, Proposition 4.1], if \u000f > 0 is small enough, then\n(a) G\u000f is a compact manifold with boundary;\n(b) the inclusion G\u000f \u2282 G(X, n) is a Dn-equivariant homotopy equivalence;\n(c) all critical points of L X are contained in G\u000f ;\n(d) at every point of \u2202G\u000f, the gradient of L X extends outwards.\nNow we apply Proposition 17 with M = G\u000f , f = L X , and G = Dn . We\nconclude that the number of Dn-orbits of n-periodic billiard trajectories in X is at\nleast\ncat(G\u000f\/Dn) = cat\n(\nG(X, n)\/Dn\n)\n.\nSince we assume that n is an odd prime, the action of Dn on G(X, n) is free, and we\nmay use inequality (5), which gives\ncat\n(\nG(X, n)\/Dn\n) \u2265 cat(G(X, n)) \u2265 cl(G(Sm, n))+ 1.\nTheorems 18 and 19 allow us to estimate cat(G(Sm, n)). Assume first that m is\nodd, m > 1. Then (according to Theorem 18) we have a nonzero cup product\n\u03c3 n\u221221 u,\n620 MICHAEL FARBER\nwhich shows that the cup length of G(Sm, n) for odd m > 1 is at least n \u2212 1. This\ngives a lower bound n on the number of Dn-orbits of n-periodic billiard trajectories\nin X for m odd.\nIf m is even, then (by Theorem 19) we have a nonzero cup product\n\u03c3\n(n\u22123)\/2\n2 w \u2208 H\u2217\n(\nG(Sm, n);k),\nwhere k is a field of characteristic not equal to 2. This shows that, for m even, the cup\nlength of G(Sm, n) is at least (n \u2212 1)\/2. This gives a lower bound (n + 1)\/2 on the\nnumber of Dn-orbits of n-periodic billiard trajectories in X .\nAcknowledgments. I would like to thank H.-J. Baues and S. Tabachnikov for useful\ndiscussions.\nReferences\n[1] I. BABENKO, Periodic trajectories of three-dimensional Birkhoff billiards, Math.\nUSSR-Sb. 71 (1992), 1 \u2013 13. MR 91m:58128 587, 588, 594, 614\n[2] G. BIRKHOFF, Dynamical Systems, Amer. Math. Soc. Colloq. Publ. 9, Amer. Math.\nSoc., Providence, 1966. MR 35:1 587\n[3] M. CLAPP and D. PUPPE, Critical point theory with symmetries, J. Reine Angew. Math.\n418 (1991), 1 \u2013 29. MR 92d:58031 607, 608\n[4] J.-N. CORVELLEC, Morse theory for continuous functionals, J. Math. Anal. Appl. 196\n(1995), 1050 \u2013 1072. MR 96m:58037 607\n[5] M. DEGIOVANNI and M. MARZOCCHI, A critical point theory for nonsmooth\nfunctionals, Ann. Mat. Pura Appl. (4) 167 (1994), 73 \u2013 100. MR 96a:58043 607,\n608\n[6] E. FADELL and S. HUSSEINI, Category weight and Steenrod operations, Bol. Soc. Mat.\nMexicana (2) 37 (1992), 151 \u2013 161. MR 95m:55007 589, 610, 611\n[7] M. FARBER, Topology of billiard problems, I, Duke Math. J. 115 (2002), 561 \u2013 587.\n587, 588, 589, 591, 592, 598, 609, 611, 617, 618\n[8] M. FARBER and S. TABACHNIKOV, Topology of cyclic configuration spaces and\nperiodic trajectories of multi-dimensional billiards, Topology 41 (2002),\n553 \u2013 589. CMP 1 910 041 587, 588, 589, 590, 592, 609, 612, 614, 617, 619\n[9] J. JOST, Riemannian Geometry and Geometric Analysis, Universitext, Springer, Berlin,\n1995. MR 96g:53049 618\n[10] V. KOZLOV and D. TRESHCH \u00a8EV, Billiards: A Genetic Introduction to the Dynamics of\nSystems with Impacts, Transl. Math. Monogr. 89, Amer. Math. Soc., Providence,\n1991. MR 93k:58094a\n[11] W. MARZANTOWICZ, A G-Lusternik-Schnirelman category of space with an action of\na compact Lie group, Topology 28 (1989), 403 \u2013 412. MR 91c:55002 607, 608\n[12] J. W. MILNOR and J. D. STASHEFF, Characteristic Classes, Ann. of Math. Stud. 76,\nPrinceton Univ. Press, Princeton, 1974. MR 55:13428 600\nTOPOLOGY OF BILLIARD PROBLEMS, II 621\n[13] S. TABACHNIKOV, Billiards, Panor. Synth. 1, Soc. Math. France, Montrouge, 1995.\nMR 96c:58134\n[14] B. TOTARO, Configuration spaces of algebraic varieties, Topology 35 (1996),\n1057 \u2013 1067. MR 97g:57033\nDepartment of Mathematics, Tel Aviv University, Tel Aviv 69978, Israel; mfarber@post.tau.ac.il\n"}