{"doi":"10.1016\/j.trb.2005.001","coreId":"71504","oai":"oai:eprints.lancs.ac.uk:822","identifiers":["oai:eprints.lancs.ac.uk:822","10.1016\/j.trb.2005.001"],"title":"A compositional stochastic model for real-time freeway traffic simulation.","authors":["Boel, R.","Mihaylova, Lyudmila"],"enrichments":{"references":[{"id":16344243,"title":"A \u00afnite di\u00aeerence approximation of the kinematic wave model of tra\u00b1c \u00b0ow.","authors":[],"date":"1995","doi":null,"raw":"Daganzo, C. (1995). A \u00afnite di\u00aeerence approximation of the kinematic wave model of tra\u00b1c \u00b0ow. Transportation Research B, 29B(4), 261{276.","cites":null},{"id":16344255,"title":"A particle \u00aflter for freeway tra\u00b1c estimation.","authors":[],"date":"2004","doi":"10.1109\/cdc.2004.1430359","raw":"Mihaylova, L., & Boel, R. (2004). A particle \u00aflter for freeway tra\u00b1c estimation. In Proc.","cites":null},{"id":16344249,"title":"A phenomenological model for dynamic tra\u00b1c \u00b0ow in networks.","authors":[],"date":"1995","doi":"10.1016\/0191-2615(95)00018-9","raw":"Hilliges, M., & Weidlich, W. (1995). A phenomenological model for dynamic tra\u00b1c \u00b0ow in networks. Transportation Research B, 29B(6), 407{431.","cites":null},{"id":16344257,"title":"Beyond the Kalman \u00aflter: Particle \u00aflters for tracking applications.","authors":[],"date":"2004","doi":null,"raw":"of the 43rd IEEE Conf. on Decision and Control (p. 2106-2111). (Atlantis, Paradise Island, Bahamas) Ristic, B., Arulampalam, S., & Gordon, N. (2004). Beyond the Kalman \u00aflter: Particle \u00aflters for tracking applications. Artech House.","cites":null},{"id":16344253,"title":"Hybrid stochastic framework for freeway tra\u00b1c \u00b0ow modelling.","authors":[],"date":"2003","doi":"10.1109\/ivs.2004.1336378","raw":"Mihaylova, L., & Boel, R. (2003). Hybrid stochastic framework for freeway tra\u00b1c \u00b0ow modelling. In Proc. of the Intl. Symp. on Inform. and Communication Technologies (p. 391-396). Trinity College Dublin, Ireland.","cites":null},{"id":16344238,"title":"Modelling freeway networks by hybrid stochastic models.","authors":[],"date":"2004","doi":"10.1109\/ivs.2004.1336378","raw":"Boel, R., & Mihaylova, L. (2004). Modelling freeway networks by hybrid stochastic models. In Proc. of the IEEE Intelligent Vehicle Symposium (pp. 182{187). Parma, Italy.","cites":null},{"id":16344245,"title":"Sequential Monte Carlo methods in practice.","authors":[],"date":"2001","doi":"10.1007\/978-1-4757-3437-9","raw":"Doucet, A., Freitas, N., & N. Gordon, E. (2001). Sequential Monte Carlo methods in practice. New York: Springer-Verlag.","cites":null},{"id":16344241,"title":"The cell transmission model: A dynamic representation of highway tra\u00b1c consistent with the hydrodynamic theory.","authors":[],"date":"1994","doi":"10.1016\/0191-2615(94)90002-7","raw":"Daganzo, C. (1994). The cell transmission model: A dynamic representation of highway tra\u00b1c consistent with the hydrodynamic theory. Transportation Research B, 28B(4), 269-287.","cites":null},{"id":16344251,"title":"Tra\u00b1c \u00b0ow modeling of large-scale motorway using the macroscopic modeling tool METANET.","authors":[],"date":"2002","doi":"10.1109\/tits.2002.806804","raw":"Kotsialos, A., Papageorgiou, M., Diakaki, C., Pavlis, Y., & Middelham, F. (2002, December). Tra\u00b1c \u00b0ow modeling of large-scale motorway using the macroscopic modeling tool METANET. IEEE Trans. on Intelligent Transportation Systems, 3(4), 282-292.","cites":null},{"id":16344247,"title":"Tra\u00b1c and related self-driven many-particle systems.","authors":[],"date":"2001","doi":"10.1103\/revmodphys.73.1067","raw":"Helbing, D. (2001). Tra\u00b1c and related self-driven many-particle systems. Review of Modern Physics, 73, 1067-1141.","cites":null},{"id":16344235,"title":"Tra\u00b1c control on motorways.","authors":[],"date":"2003","doi":null,"raw":"Bellemans, T. (2003). Tra\u00b1c control on motorways. Ph.D. thesis, Katholieke Universiteit Leuven, Belgium.","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2006-05","abstract":"Traffic flow on freeways is a non-linear, many-particle phenomenon, with complex interactions between vehicles. This paper presents a stochastic model of freeway traffic at a time scale and of a level of detail suitable for on-line estimation, routing and ramp metering control. The freeway is considered as a network of interconnected components, corresponding to one-way road links consisting of consecutively connected short sections (cells). The compositional model proposed here extends the Daganzo cell transmission model by defining sending and receiving functions explicitly as random variables, and by also specifying the dynamics of the average speed in each cell. Simple stochastic equations describing the macroscopic traffic behavior of each cell, as well as its interaction with neighboring cells are obtained. This will allow the simulation of quite large road networks by composing many links. The model is validated over synthetic data with abrupt changes in the number of lanes and over real traffic data sets collected from a Belgian freeway","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/71504.pdf","fullTextIdentifier":"http:\/\/eprints.lancs.ac.uk\/822\/2\/TRB_accepted.pdf","pdfHashValue":"428109568c3c7b06ab99ac733f3034c3c6bcc4a6","publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lancs.ac.uk:822<\/identifier><datestamp>\n      2018-01-24T03:17:03Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D51:5141:51413735<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        A compositional stochastic model for real-time freeway traffic simulation.<\/dc:title><dc:creator>\n        Boel, R.<\/dc:creator><dc:creator>\n        Mihaylova, Lyudmila<\/dc:creator><dc:subject>\n        QA75 Electronic computers. Computer science<\/dc:subject><dc:description>\n        Traffic flow on freeways is a non-linear, many-particle phenomenon, with complex interactions between vehicles. This paper presents a stochastic model of freeway traffic at a time scale and of a level of detail suitable for on-line estimation, routing and ramp metering control. The freeway is considered as a network of interconnected components, corresponding to one-way road links consisting of consecutively connected short sections (cells). The compositional model proposed here extends the Daganzo cell transmission model by defining sending and receiving functions explicitly as random variables, and by also specifying the dynamics of the average speed in each cell. Simple stochastic equations describing the macroscopic traffic behavior of each cell, as well as its interaction with neighboring cells are obtained. This will allow the simulation of quite large road networks by composing many links. The model is validated over synthetic data with abrupt changes in the number of lanes and over real traffic data sets collected from a Belgian freeway.<\/dc:description><dc:date>\n        2006-05<\/dc:date><dc:type>\n        Journal Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/eprints.lancs.ac.uk\/822\/2\/TRB_accepted.pdf<\/dc:identifier><dc:relation>\n        http:\/\/dx.doi.org\/10.1016\/j.trb.2005.001<\/dc:relation><dc:identifier>\n        Boel, R. and Mihaylova, Lyudmila (2006) A compositional stochastic model for real-time freeway traffic simulation. Transportation Research Part B: Methodological, 40 (4). pp. 319-334. ISSN 0191-2615<\/dc:identifier><dc:relation>\n        http:\/\/eprints.lancs.ac.uk\/822\/<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/dx.doi.org\/10.1016\/j.trb.2005.001","http:\/\/eprints.lancs.ac.uk\/822\/"],"year":2006,"topics":["QA75 Electronic computers. Computer science"],"subject":["Journal Article","PeerReviewed"],"fullText":"A Compositional Stochastic Model\nfor Real-Time Freeway Traffic Simulation\nRene\u00b4 Boel a, Lyudmila Mihaylova \u2217,b\naUniversity of Ghent, SYSTeMS Research Group, B-9052 Zwijnaarde, Belgium\nbDepartment of Electrical and Electronic Engineering, University of Bristol,\nMerchant Venturers Building, Woodland Road, Bristol BS8 1UB, UK\nAbstract\nTraffic flow on freeways is a nonlinear, many-particle phenomenon, with complex\ninteractions between vehicles. This paper presents a stochastic model of freeway traf-\nfic at a time scale and of a level of detail suitable for on-line estimation, routing\nand ramp metering control. The freeway is considered as a network of intercon-\nnected components, corresponding to one-way road links consisting of consecutively\nconnected short sections (cells). The compositional model proposed here extends the\nDaganzo cell transmission model by defining sending and receiving functions explic-\nitly as random variables, and by also specifying the dynamics of the average speed\nin each cell. Simple stochastic equations describing the macroscopic traffic behavior\nof each cell, as well as its interaction with neighboring cells are obtained. This will\nallow the simulation of quite large road networks by composing many links. The\nmodel is validated over synthetic data with abrupt changes in the number of lanes\nand over real traffic data sets collected from a Belgian freeway.\nKeywords \u2013 macroscopic traffic models, freeway traffic, stochastic systems, send-\ning and receiving functions\n1 Motivation and relation to previous work\nTraffic flow on freeways is a complex process with many interacting components and ran-\ndom perturbations such as traffic jams, stop-and-go-waves, hysteresis phenomena. These\nperturbations propagate from upstream to downstream road sections (cells) forming for-\nward waves, usually when traffic is light. During traffic jams drivers are slowing down when\nthey observe traffic congestion in the cell ahead of them, causing upstream propagation of\na traffic density perturbation. The development of models capable of capturing these differ-\nent interactions between neighboring cells is a challenging task. In (Daganzo, 1994, 1995)\npiecewise affine static sending and receiving functions were introduced to describe the in-\nteraction between neighboring road cells, and these waves together. This model, called a cell\ntransmission model (CTM) clearly describes the interaction between neighboring road cells.\n\u2217 Corresponding author\nEmail addresses: rene.boel@ugent.be (Rene\u00b4 Boel), mila.mihaylova@bristol.ac.uk\n(Lyudmila Mihaylova).\nSince it relies on a sending function depending only on the state of upstream cells, and on a\nreceiving function depending on the state of downstream cells, it is very well suited for the\ndynamic analysis of large road networks. The CTM model provides an intuitively appealing\nand easy to tune deterministic description of how the number of vehicles in consecutive cells\nof a freeway evolves over consecutive time intervals.\nIn the present paper we develop a stochastic compositional model of the evolution of traffic\nflows on freeways. It is aimed to be applied to on-line prediction algorithms and control\nstrategies (such as ramp metering and adaptive routing) for large freeway networks. The\ntime scale of the traffic control actions requires aggregated models, which describe the\ndynamics of macroscopic variables such as density and average speed. The size of the network\nunder study brings the necessity of compositionality, robustness. The model allows a lot of\nflexibility in choosing the time update step size and the cell sizes. These can vary with time\ndepending on the availability of on-line measurements and with the location of the cells (e.g.\non the location of sensors), as long as the generic condition is satisfied that \u201cno vehicle can\njump over a cell during one time step\u201d.\nIn order to properly select good control actions, the simulation model must allow predictions\nof the future costs resulting from the control decisions we envisage. This cost could be, e.g.,\nthe average time delay incurred by vehicles crossing the freeway network under study, a delay\nthat will depend on the speed of the vehicles and hence on the congestion over a considered\ntime horizon. The effects of the control actions are to a great extent predetermined by the\nevolution of the average speed in each cell over time intervals of the order of a few minutes.\nFor these short intervals of time, and for the high average speed of freeway traffic, the inertia\nof platoons of vehicles adjusting their driving speed to changes in the local traffic density,\nwill not be negligible. Hence, we extend the CTM model with a dynamic equation describing\nhow speed evolves dynamically in each cell of the road network.\nThe model we propose describes well the interaction between variables in different cells of\nthe freeway network, and the local dynamics in each cell. First results for traffic modelling\nwith this compositional model were reported in (Boel & Mihaylova, 2004; Mihaylova & Boel,\n2003). The model allows for parallel processing which can reduce the computational load. It\nbrings the scalability potential of the decentralized architectures and makes predictors and\ncontrollers more robust, by avoiding the need for a centralized processing node. It is also\nflexible because it is easy to update the model when a local change occurs into some parts\nof the road network: only the description of one or a few cells has to be modified.\nFor the purposes of developing control strategies on freeways, it is also important to explicitly\nmodel the randomness of the traffic state evolution. This randomness is reflected in the\nmodel via the probability distributions governing the sending functions and the receiving\nfunctions, as well as via the well defined noise terms in the speed adaptation rules. The\nprediction of the expected future cost of control decisions will of course also depend heavily\non the availability of accurate estimates of the current values of the traffic variables (speed\nand density in each cell). Constructing a reliable estimator requires a clear definition of\nthe probability distribution relating the often very limited observations to the traffic states.\nIn (Mihaylova & Boel, 2004) we have shown that the stochastic compositional model of\nthis paper is indeed suitable for real-time estimation of freeway traffic flow variables. The\nrecursive filter we developed is based on Monte Carlo techniques (called also particle filters),\n2\na powerful sample-based method with a wide range of applications in science and engineering\n(Doucet, Freitas, & N. Gordon, 2001; Ristic, Arulampalam, & Gordon, 2004).\nThe outline of this paper is as follows. Section 2 presents the compositional description of the\nfreeway network under study, and the traffic variables of interest. Section 3 introduces the\ndynamic model of one component of the freeway traffic network, using stochastic sending and\nreceiving functions of vehicles passing from one cell to the next cell. Section 4 demonstrates\nthe effectiveness of our model comparing synthetic data and real data obtained from Flemish\nroad authorities. Finally, conclusions and ongoing research issues are highlighted.\n2 Problem setup and definition of the traffic variables\nA freeway network can be represented as a sequence of links. A link m is composed of a\nsequence of cells, numbered from 1 to nm, as indicated in Fig. 1. Each link involves several\nlanes in one direction of a freeway, e.g. connecting two major intersections, or important on-\nor off-ramps. Links are indexed by a number m, ranging from 1 toM . The length Li of each\ncell is small enough - typically a few hundred meters - so that the variables describing the\ntraffic behavior at some time instant tk can be assumed approximately uniform inside one\ncell. The evolution of the traffic variables in a cell, as measured at an increasing sequence\nof time instants t0, t1, . . . , tk, . . . , forms the basic building block of our model. The traffic\nvariables at time tk which the model presented in this paper deals with are:\n\u2022 the number of vehicles Ni,k in cell i at time tk and\n\u2022 the average speed vi,k of these Ni,k vehicles at time tk.\nThe intervals [tk, tk+1) should be small enough to allow accurate modelling (typically less\nthan 10sec), but not too small so that predictions over time horizons of a few minutes,\nrelevant for the control actions that are envisaged as applications of this model, can be\ncarried out in real time.\nNeighboring cells interact with each other because vehicles that are leaving the downstream\nboundary of cell i in a time interval [tk, tk+1) are entering cell i+1 via the upstream boundary\n \n1\u2212iQ  \nCell  i \niQ  \n11, \u2212\u2212 ii vN  ii vN ,  11, ++ ii vN  \nmkmz ,1\u2212\n \nSensor measurements \n1 i - 1 \u2026 i  i + 1 \u2026 nm \nmkmz ,\nLink  m - 1 Link  m Link  m +1 \n \n \nFig. 1. Freeway links, cells and measurement points.\n3\nof cell i + 1 during the same time interval [tk, tk+1). In the equations below we represent\nthis number of vehicles that enter the cell i+1 from cell i during the time interval [tk, tk+1)\nby Qi,k, called the outflow from cell i in time interval [tk, tk+1), or the inflow into cell\ni+1 (see Fig. 1). Cells 1 and nm are special because their inflow of vehicles at the upstream\nboundary, respectively the outflow from the downstream boundary, are interactions with\nother links, adjacent to link m.\nThe evolution of the traffic variables within a cell i depends not only on the inflow into\ncell i, and the outflow from cell i (inflow for cell i + 1), but also on fixed parameters such\nas the cell\u2019s length Li, the number of lanes `i,k available at time tk, and on parameters of\nthe speed-density relation, that may vary over time due to uncontrollable or random effects\nsuch as weather, accidents, speed limitations.\n3 Traffic dynamics for one link\n3.1 Updating the number of vehicles in a cell\nThe evolution of the number of vehicles Ni,k within a cell i measured at consecutive time\ninstants tk can be expressed by the conservation of vehicles equation:\nNi,k+1 = Ni,k +Qi\u22121,k \u2212Qi,k, (1)\nwhere the number of vehicles Qi,k crossing the boundary between cells i and i + 1 during\nthe interval \u2206tk = tk+1 \u2212 tk (Fig. 1) is the minimum\nQi,k = min(Si,k, Ri,k) (2)\nof the sending function Si,k, representing how many vehicles intend to leave cell i during the\ninterval \u2206tk, provided there would be no constraints imposed by the state of cell i+ 1, and\nthe receiving function Ri,k, representing the maximum number of vehicles that are allowed\nto enter cell i+ 1 during the same interval \u2206tk.\nThe sending function Si,k only depends on the state of the traffic network in cell i, i.e.\nupstream from the boundary between cell i and cell i+1. It represents forward (downstream)\npropagation of traffic perturbations. The receiving function Ri,k depends only on the state\nof the traffic network downstream from the boundary between cell i and cell i + 1. It\ncharacterizes the backward (upstream) propagation of traffic perturbations due to queueing.\nThe values of Si,k are random variables because the location and the speed of the Ni,k\nvehicles in cell i at time tk are both random. The probability distribution of Si,k can be\nderived as follows. A vehicle in cell i that drives at a speed w at time tk and is located\nwithin a distance less than \u2206tk.w from the boundary between cell i and cell i + 1 crosses\nthis boundary prior to tk+1.\nUnder light traffic conditions, when Ni,k is small compared to the maximum number N\nmax\ni,k\nof vehicles that can be present simultaneously in cell i, these vehicles do not interact very\noften with each other. Hence, their locations can be assumed to be independently, uniformly\n4\ndistributed, along the cell of length Li. Note that we do not model the lane distribution of\nthe vehicles, since this is not very important for the control applications we are interested\nin, and since we do not have enough empirical data to validate a lane-dependent model. The\nspeeds w of these Ni,k vehicles are also random variables with approximately independent\ndistribution, centered around vi,k. Then, a vehicle in cell i at time tk, driving at speed w,\nhas a probability \u2206tk.w\/Li of crossing the boundary with cell i+1. For any one of the Ni,k\nvehicles in cell i at time tk the average probability of crossing the boundary with cell i+ 1\nis thus pi,k = \u2206tk.vi,k\/Li. Hence, under light traffic conditions the sending function Si,k is a\nbinomial random variable, corresponding to Ni,k independent drawings each with \u201csuccess\u201d\nrate pi,k = \u2206tk.vi,k\/Li. The mean value of Si,k is ESi,k = \u2206tk.vi,k.Ni,k\/Li. The variance of\nthe sending function Si,k is then Ni,k.pi,k\/(1\u2212 pi,k).\nThe following requirement has to be fulfilled for the above argument to be valid: each\nvehicle must be detected at least once in cell i, during the time interval \u2206tk. This requires\nthat vi,max.\u2206tk < Li, with vi,max being the maximum allowed speed (e.g. equal to the free-\nflow speed vf ). This condition is equivalent to the assumption made in the CTM model\n(Daganzo, 1994, 1995), where \u2206tk is always equal to Li\/vi,max. This condition also agrees\nwith the classical requirement for numerical stability of the integration of traffic models\nbased on partial differential equations, where the time step must be less than the space\ndiscretization step divided by the wave speed. In view of this condition, the sampling rate\ncan be adaptively changed: the faster the speed, the smaller the discretization period, and\non the opposite \u2013 the slower the drivers\u2019 speed, the bigger \u2206tk can be.\nIf the traffic in cell i is extremely congested (Ni,k close to N\nmax\ni,k ), then the Ni,k vehicles will\ninteract very often with each other, and their location and speed will be highly correlated.\nBecause of the minimum time distance requirement between successive vehicles in the same\nlane, they must at time tk be approximately equidistantly spaced over the length Li of cell\ni, with approximately the same speed vi,k for successive vehicles. The randomness on Si,k\nis now the sum of many small effects (many interactions between a relatively large number\nof vehicles) and hence this noise can be assumed Gaussian according to the central limit\ntheorem. The average value of the sending function is ESi,k = \u2206tk.vi,k.Ni,k\/Li. Its variance\n\u03c32i,k(Ni,k, vi,k) should be determined empirically.\nFor intermediate cases between very light traffic (the \u201cbinomial\u201d case) and very dense traffic\n(the \u201cGaussian\u201d case), it is very complicated to write down an analytical formula for the\nprobability distribution of Si,k. However, in traffic simulations one can easily generate ran-\ndom variables describing the location and speed of the Ni,k vehicles at time tk by imitating\n\u201cphysical reality\u201d. We are still investigating various descriptions of the overtaking rules,\nleading to specific distributions for the size of the platoons, and various car-following rules.\nIn the validation experiments reported on in Section 4 we have used a simple rule where the\nsending function is selected according to the binomial case, resp. the Gaussian case with a\nprobability that depends on Ni,k\/N\nmax\ni,k .\nThe above derivation of Si,k does not take into account what happens when a severe traffic\njam causes stopped traffic at time tk. When the speed drops to 0 no vehicle will ever leave\ncell i between time tk and tk+1 irrespective of what the receiving function might be. Hence,\nthe number of vehicles in cell i can only increase, keeping the speed 0 forever, and causing\na permanent bottleneck in cell i. This is obviously not what happens in reality. No matter\n5\nhow dense the traffic may become, some vehicles at the front of a congestion wave tend to\nescape from the bottleneck, with a certain minimum outflow speed voutmin,i. This minimum\nspeed voutmin,i is an empirically determined variable (Helbing, 2001). This leads to the following\nmean value of the sending function :\nESi,k = Ni,k\nmax(vi,k, v\nout\nmin,i).\u2206tk\nLi\n. (3)\nAs soon as the downstream cell i+ 1 becomes congested we have to take into account that\nnot all Si,k vehicles may be able to enter cell i+ 1. Some vehicles in cell i may have to slow\ndown and postpone their departure from cell i until after tk+1. To express this constraint\nwe also define the maximum number of vehicles allowed to enter cell i+ 1 during the time\ninterval \u2206tk by the receiving function Ri,k. The receiving function depends only on traffic\nvariables of cell i+ 1 and can be calculated as follows:\nRi,k = N\nmax\ni+1,k +Qi+1,k \u2212Ni+1,k, (4)\ni.e. the number of vehicles that can enter cell i+ 1 during \u2206tk is N\nmax\ni+1,k minus the number\nof vehicles Ni+1,k \u2212 Qi+1,k that were in cell i + 1 at time tk and that remain there at time\ntk+1. The receiving function Ri,k is a random variable because Qi,k+1 is a random variable.\nThe maximum number of vehicles Nmaxi+1,k within cell i + 1 at sample time tk+1, is found\nby assuming that the average space needed by a vehicle is its average length A` plus the\ndistance vi+1,k.td that it travels during the minimal safety time td\nNmaxi+1,k = (Li+1.`i+1,k)\/(A` + vi+1,k.td) . (5)\nThe minimal safety time distance td between vehicles following each other, as used in equa-\ntion (5) for Nmaxi+1,k, expresses the minimal safe braking distance, specified in safety manuals\nat 2 [sec].\n3.2 Updating the average speed\nThe vehicles are adjusting their speed to the local density of the traffic and to road conditions\nusually with some inertia. Since the maximal speed can be quite high for freeway traffic, it\nmay take more than one state update interval before the speed has increased from stopped\ntraffic in a traffic jam, up to the maximal speed at free flowing traffic (even at maximal\nacceleration conditions an average vehicle will take 10 [sec] to reach 120 [km\/h], and platoons\nof vehicles are considerably slower).\nThe speed update equation for the compositional model starts by calculating the effect of\nconvection, and adaptation to downstream congestion. At time tk+1 cell i contains Qi\u22121,k\nvehicles that had average speed vi\u22121,k at time tk when they were in cell i \u2212 1. We assume\nthat these Qi\u22121,k vehicles maintain their average speed vi\u22121,k. We ignore here the fact that\nfaster vehicles have a higher probability of crossing the cell boundary. This approximation\nis acceptable because in general the relative variance on the speed is fairly small.\nAt time tk+1 cell i also contains Ni,k \u2212 Qi,k vehicles that were already in cell i at time tk\ndriving with average speed vi,k.\n6\n\u2022 If Si,k \u2264 Ri,k, then these vehicles can be assumed to maintain the same average speed vi,k\nat time tk+1.\n\u2022 If however Si,k > Ri,k, then not all vehicles can leave the i-th cell. Some vehicles in cell\ni must slow down during \u2206tk in order to make sure that only Ri,k of them cross the\nboundary between cell i and cell i + 1 during the interval \u2206tk. The change in the speed\n\u2206vi,k is proportional to the difference Si,k \u2212Ri,k.\nOne implementation achieving this slowing down is as follows: Ni,k \u2212 Si,k vehicles that are\nin cell i at tk do not reach the downstream boundary even though they maintain their\naverage speed vi,k;max(Si,k \u2212 Ri,k, 0) other vehicles must come to a stop before time tk+1\nin order to avoid crossing this downstream boundary before tk+1. In reality the Ni,k+1 =\nNi,k\u2212Si,k+max(Si,k\u2212Ri,k, 0)+Qi\u22121,k vehicles that remain in cell i throughout the interval\n[tk, tk+1) will average out their speed so that they reach the same average speed\n(Ni,k\u2212Si,k).vi,k\n(Ni,k\u2212Qi,k) .\nCombining the speed of these vehicles remaining in cell i with the average speed of the\nQi\u22121,k vehicles with average speed vi\u22121,k leads to the following expression:\nvintermi,k+1 =\n(Ni,k \u2212Qi,k).vi,k +Qi\u22121,k.vi\u22121,k\nNi,k+1\n. (6)\nDuring the interval \u2206tk the drivers in cell i will adapt their speed to the local traffic density\nthat they see in front of them, i.e. to some weighted average of the density in cell i and in\ncell i+ 1. To simplify the equations we assume that this adaptation occurs at time tk+1 so\nthat drivers adapt to the density\n\u03c1antici,k+1 = \u03b1i.Ni,k+1\/(Li`i,k+1) + (1\u2212 \u03b1i).Ni+1,k+1\/(Li+1`i+1,k+1), (7)\nwhere the coefficient \u03b1i \u2208 (0, 1] weighs how far ahead the drivers are looking in order to\nadapt their speed (largest lookahead for \u03b1i close to 1, corresponding to looking one full cell\nahead; realistic values of \u03b1i clearly depend on Li and Li+1).\nBecause the drivers\u2019 aggressiveness is random, the average speed in cell i at time tk+1 is a\nrandom variable\nvi,k+1 = \u03b2i,k+1.v\ninterm\ni,k+1 + (1\u2212 \u03b2i,k+1)ve(\u03c1antici,k+1) + \u03b7vi,k+1, (8)\nwhere \u03b7vi,k+1 is a noise reflecting the fluctuations in the drivers\u2019 speed, v\ne(\u03c1antici,k+1) is a speed-\ndensity relation, that can be computed according to the classical fundamental diagram, as\nin (Kotsialos, Papageorgiou, Diakaki, Pavlis, & Middelham, 2002)\nve(\u03c1i,k+1) = vf exp\n{\n\u2212 1\nam\n[\n\u03c1i,k+1\n\u03c1i,crit\n]am}\n, (9)\nbut that may also be represented by a simpler piecewise affine function (Hilliges & Wei-\ndlich, 1995) connecting the free-flow speed vf to the critical density \u03c1i,crit. Parameters like\nam, vf , \u03c1i,crit are usually determined via tuning experiments. The weight factor \u03b2i expresses\nthe relative impact on the calculation of the speed of convective and anticipative behavior.\nThe coefficient \u03b2i,k+1 is adaptively updated as a function of the change in the traffic density\n7\naccording to the relation\n\u03b2i,k+1 =\n\uf8f1\uf8f2\uf8f3\u03b2I , if |\u03c1antici+1,k+1 \u2212 \u03c1antici,k+1| \u2265 \u03c1threshold,\u03b2II otherwise, (10)\nwhere \u03b2I and \u03b2II (\u03b2I < \u03b2II) are appropriately chosen constants. We notate \u03c1threshold a\nthreshold density difference between two adjacent cells above which the value of \u03b2 is changed.\nWhen the difference between the densities of two neighbour cells is bigger than a threshold\nvalue, this is an indication that an abrupt change in the traffic conditions is forthcoming,\ne.g. a congestion might start. When this difference is big, \u03b2 should have a small value which\nmeans that the second term from (8) has a predominant influence. On the opposite, when\nthere is no difference between the densities of two neighbour cells the value of beta is high.\nSimilar adaptations can be done for \u03b1 and the minimum time distance td (as an exponential\nfunction of the speed, e.g.).\nThe above described equations require at each state update the solution of a large sys-\ntem of non-linear equations, solving equations (1)-(9) for the unknowns Ni,k+1, vi,k+1, i =\n1, 2, . . . , nm as function of the already known variables Ni,k, vi,k, i = 1, 2, . . . , nm. Using a\nsimple procedure for solving this set of equations - moving forward from i = 1 to i = nm,\nthen backward from i = nm to i = 1, in the evaluation of the variables Ni,k+1, vi,k+1, i =\n1, 2, . . . , nm we can preserve the advantages of compositionality at each step of the iteration.\nThe algorithmic implementation of the compositional model (1)-(9), used in the validation\nexperiments, is given in the Appendix.\n3.3 Connection of the modelled traffic variables to the measurements\nIn order to allow validation of the proposed model, and to be able to use the model for the\npurpose of on-line traffic state estimation, we investigated the relation between the model\nvariables, and the available observations. Typically sensors (video cameras or magnetic loop\ndetectors) are located at a small subset of the boundaries between cells. The boundaries be-\ntween cells where a sensor is situated are indexed by the subset j \u2208 J \u2282 I = {1, 2, . . . , nm}.\nThe available data for the validation of our model are the data we expect to use in on-\nline control applications. These data consist of the number Q\u00afj,ks of vehicles passing such a\nboundary j during the s-th one minute interval, and the average speed v\u00afj,ks of these Q\u00afj,ks\nduring the same s-th one minute interval. The indices ks \u2208 L \u2282 N form a subset of the\nindices of the state update time instants. Indeed the one-minute intervals are much too\nlong to allow accurate simulation runs (cell lengths of more than two kilometers would be\nrequired to satisfy the condition that \u201cno car jumps over a cell during one time step\u201d).\nThe measured flow of vehicles at sensor location j (the boundary between cell j and cell j+1)\nin the s-th minute can be obtained via (in vehicles per minute [veh\/min]; by multiplying\nby 60 one obtains the data in the usual unit of vehicles per hour [veh\/h]):\nQ\u00afj,ks =\n1\n\u03b4t\n\u03a3\nk=ks+1\u22121\nk=ks\nQj,k + \u03beQj,ks ,\nwhere \u03b4t = tks+1 \u2212 tks is the measurement time interval and \u03beQj,ks is the sensor noise. From\n8\ninvestigations with real traffic data from Belgian freeways we found that the error in the ob-\nserved number of vehicles with video cameras can be represented as the difference between\nthe number of missed vehicles (due to occlusion, fog, snow, or other unpredictable factors)\nand the number of false alarms (e.g. a lorry taken for two or more cars, or a shadow counted\nas a vehicle). Each type of error is approximately, independently, Poisson distributed. While\nthe parameters of these Poisson distributions are obviously heavily dependent on weather\nconditions, and hence correlated both in time and in space, we do obtain reasonably good\nresults for our filtering algorithms with a simple model where the Poisson parameters are\nconstant. In (Mihaylova & Boel, 2004) we actually obtained reasonable results with an\napproximate model where the noises \u03beQj,ks have a Gaussian distribution with constant pa-\nrameters.\nThe relation between the space averaged speeds vj,k, ks \u2264 k \u2264 ks+1 and the time averaged\nspeed measurements v\u00afj,ks at sensor location j is more complicated. By ignoring the difference\nbetween time and space averages we obtain the following approximate relation:\nv\u00afj,ks =\n\u03a3\nks+1\u22121\nk=ks\nNj,kvj,k\n\u03a3\nks+1\u22121\nk=ks\nNj,k\n+ \u03bevks , (11)\nwhere the relatively small speed sensor noises are represented as an independent additive\nGaussian noise \u03bevks .\n4 Model validation\nThe compositional model was tested and validated over one single link of a freeway network\nin the present paper. However, its generalization to a large network with many components\nis straightforward. We present results for the model performance at first over synthetic data.\n4.1 Investigation with synthetic data\nA test scenario with abrupt changes in the number of lanes is considered : 16 cells cover\na freeway stretch of 8 [km], where the number of lanes in cells 9 and 10 drops as shown\nin Fig. 2 a), whilst the number of lanes in the other cells 1-8 and 11-16 remain always 3\nwithin the whole time interval [1h, 4h]. The inflow (from cell 0) and the outflow (from cell\n17) are given in Fig. 2 b). The model is implemented in MATLAB, version 7.0. One of the\ndifficulties met was the need of proper simulation of the inflow and outflow data (Fig. 2,\nb)). In order to have a smooth change in the number of vehicles crossing the boundaries,\nand their corresponding speed, the inflow data were modelled as follows:\nQk,0 = Q\nc\n0exp\n{\n\u2212\n[\n\u03c11,k\n\u03c1crit\n]}\n, (12)\nvk,0 = vfexp\n{\n\u2212 1\nam\n[\n\u03c11,k\n\u03c1crit\n]am}\n= ve0(\u03c1\nantic\n1,k ), (13)\n9\nwhere Qc0 is a given constant initial number of vehicles inside the cell 0. Equation (13) is\nwith respect to the anticipated density in the next cell.\nThe outflow data (from cell 17) are set to be equal to the estimated ones in the previous\ncell 16 and this way they follow naturally the dynamics of the traffic changes. The model\nparameters are given in Table 1. Figure 3 presents results from the compositional model\n1 1.5 2 2.5 3 3.5 4\n0\n0.5\n1\n1.5\n2\n2.5\n3\n3.5\n4\nTime, [h]\nN\num\nbe\nr o\nf l\nan\nes\n1 1.5 2 2.5 3 3.5 4\n0\n1000\n2000\n3000\n4000\n5000\n6000\nFl\now\n [v\neh\n\/h]\nTime, [h]\nInflow\nOutflow\nFig. 2. a) Number of lanes in cells 9 and 10 is changed within the interval 1.8 [h] \u2013 3 [h]. b) Inflow\n(from cell 0) and outflow (cell 17). The dotted lines indicate the moments of lane change.\n(1)-(9). Since usually flow-density and speed-flow diagrams are very representative for the\ntraffic phenomenon, we show these diagrams and the evolution of the flow and speed in\ntime. The flow is calculated on the basis of the vehicles Qi,k crossing cell boundaries.\n0 50 100 150\n0\n2000\n4000\n6000\nFl\now\n,  \n  [\nve\nh\/h\n]\nDensity, [veh\/km]\n0 2000 4000 6000\n0\n50\n100\nFlow,  [veh\/h]\nSp\nee\nd,\n [k\nm\/\nh]\n1 2 3 4\n0\n2000\n4000\n6000\nFl\now\n, [\nve\nh\/h\n]\nTime, [h]\n1 2 3 4\n0\n50\n100\nSp\nee\nd,\n [k\nm\/\nh]\nTime, [h]\n1\u22124 5\u22128 9\u221210 11\u221213 14\u221216\n9\n10\nFig. 3. Simulation results from the compositional model. The legend above shows the colors cor-\nresponding to the different cells. The dotted lines in the bottom left and right figures indicate the\nmoments of lane changes. Lines 9 and 10 in the bottom right figure refer to the phenomena in cell\n9 and cell 10.\n10\nTable 1. Simulation parameters\ndiscretisation time step \u2206ti 10 [sec]\nfree flow speed vf 120 [km\/h]\nminimum speed voutmin,i 7.4 [km\/h]\ndensity coefficient \u03b1i = 0.15\nspeed coefficient \u03b2i,k+1 =\n{\n0.3, if |\u03c1antici+1,k+1 \u2212 \u03c1i,k+1| \u2265 1,\n0.7 otherwise.\ncritical density \u03c1crit = 20.89 [veh\/km\/lane]\ncell length Li = 0.5 [km]\nminimal time distance td = 2 [sec]\nnoises \u03b7Si,k and \u03b7vi,k with Gaussian distribution\ncovariance of the noise in the sending function cov{\u03b7Si,k} = (0.0122Ni,kvi,k\u2206tk\/Li)2 [veh]2\ncovariance of the noise in the speed cov{vi,k} = 0.032 [km\/h]2\nFrom the results in Fig. 3 we see bell-shaped forms of the flow-density and speed-flow\ndiagrams (the top left and right plots) which agree with the theory. Backward waves are\nprovoked by the reduction of the number of lanes (evident also from the two bottom plots).\nAfter the first lane change (from 3 to 2) at 1.8 [h], the freeway cells are able to accept all the\nincoming vehicles and there is no congestion (evident from Fig. 3 bottom left), although the\nspeed is gradually decreased (Fig. 3, bottom right). When the number of lanes ` drops to\n1, at 2.25 [h], this provokes a congestion, and a backward wave, as seen especially from the\nresults on the bottom of Fig. 3. After the increase of ` to 2 at 2.75 [h], the speeds gradually\nincrease which is reflected in an increase of the flow. Cells 11\u201316 behave in a different way\n(there is no jam) since there ` = 3 always and the vehicles can freely adjust their speed.\nWe observe reduction of the speed in cells 1-8 (bottom right plot). The speed in cell 5 is\nslightly increased because vehicles can move freely (the downstream density is small and\nthere are 3 lanes). This allows the vehicles of cell 4 to increase their speed, despite the\nreduction in the number of lanes. The flow behavior is evident from the left bottom plot.\nDuring the first reduction of the number of lanes from 3 to 2, the flow is slightly increased\nbecause the density increases, the speed is still high. During the interval of time when the\nnumber of lanes is reduced to one the flows in all cells drop.\n4.2 Model validation with real traffic data\nCase study set-up\nThe performance of the model (1)-(9) is validated over a 2.2 [km] km part of E17 freeway\n(Figure 4) between the cities of Ghent and Antwerp (Bellemans, 2003) for which real traffic\ndata were provided to us by the Vlaams Verkeerscentrum, Antwerp, Belgium of the Flemish\nMinistry of Transportation. E17 is one of the busiest Belgian freeways leading to the Antwerp\n11\nseaport, subject to frequent severe congestion during rush hours. The first on- and off-ramp\nalong the considered stretch of road lead to a parking lot along the freeway. The data (Fig. 6)\n \n \n \nTRAVEL DIRECTIONS \nFig. 4. Schematic representation of the segmentation of the E17 case study freeway. The labels\nCLOF to CLO1 indicate the locations of the traffic measurement cameras.\nare from video cameras and are aggregated over one minute interval (to reduce the cost of\nthe transmission from roadside sensors to the dispatching centre): average speed over all\nvehicles passing the sensor location during the one minute interval, and number of vehicles\ncrossing the sensor location during the same interval. We obtained data over the whole year\n2001, and selected one random day at a location where the sensors are very close together\nallowing proper validation. We consider the stretch between CLOF and CLOA. The cameras\nare positioned at the points notated by CLOF, CLOE, CLOD, CLOC, CLOB and CLOA.\nThe measurements from CLOF are used for inflow data, respectively the measurements\nfrom CLOA are outflow boundary data for the model. Along the freeway from point CLOE\nto point CLOB the compositional model is computing the traffic variables. In the stretch\nbetween CLOF and CLOC there is one off-ramp and one on-ramp from a parking lot (Fig. 4).\nIt is assumed that the number of vehicles entering the parking lot and leaving it is small so\nthat the conservation law for the vehicles is preserved and we neglect some possibly small\nchanges of counted vehicles. The model parameters are given in Table 2. The critical density\nis determined on the basis of sets of real traffic data from the same E17 freeway in Belgium.\nThe inflow and outflow data (from CLOF and CLOA resp.) are shown in Fig. 5. The flows\nare quite similar over the whole time period 1\u2212 24 [h] (Fig. 5 a), the speeds differ slightly\nfrom each other in the period 1\u2212 10 [h].\n5 10 15 20\n0\n1000\n2000\n3000\n4000\n5000\n6000\nTime, [h]\nFl\now\n, [\nve\nh\/h\n]\nInflow\nOutflow\n5 10 15 20\n0\n20\n40\n60\n80\n100\n120\nTime, [h]\nSp\nee\nd,\n [k\nm\/\nh]\n1\n2\nFig. 5. Inflow and outflow data (from CLOF and CLOB resp.): a) Inflow and outflow; b) Speeds:\n1 \u2013 from cell 0, 2 \u2013 from cell 5\n12\n100 200 300\n0\n2000\n4000\n6000\nDensity, [veh\/km]\nFl\now\n, [\nve\nh\/h\n]\n0 2000 4000 6000\n0\n50\n100\nSp\nee\nd,\n [k\nm\/\nh]\nFlow, [veh\/h]\n5 10 15 20\n0\n2000\n4000\n6000\nTime, [h]M\nea\nsu\nre\nd \nve\nhi\ncl\nes\n, [\nve\nh]\n5 10 15 20\n0\n50\n100\nTime, [h]\nSp\nee\nd,\n [k\nm\/\nh]\nCLOE CLOD CLOC CLOB\nFig. 6. Measurements from Sept. 4, 2001. Flow-density diagram (top left), flow-speed diagram\n(top right), evolution of the counted vehicles in time (bottom left), evolution of the speed in time\n(bottom right) for the period 1h \u2013 24h. The data are obtained in four locations along the freeway\n(CLOE, CLOD, CLOC and CLOB from Fig. 4)\n0 100 200 300\n0\n2000\n4000\n6000\nFl\now\n,  \n  [\nve\nh\/h\n]\nDensity, [veh\/km]\n0 2000 4000 6000\n0\n50\n100\nFlow,  [veh\/h]\nSp\nee\nd,\n [k\nm\/\nh]\n5 10 15 20\n0\n2000\n4000\n6000\nFl\now\n, [\nve\nh\/k\nm]\nTime, [h]\n5 10 15 20\n0\n50\n100\nSp\nee\nd,\n [k\nm\/\nh]\nTime, [h]\nFig. 7. Traffic variables calculated from the compositional model\n13\nThe real traffic data measured at the boundaries (points CLOE, CLOD, CLOC and CLOB)\nare shown in Fig. 6. There are scattered and even missing data (obvious from the right\nbottom diagram for the speed). Nevertheless, we see a good matching of the results from\nthe compositional model to the data (Fig. 7).\nTable 2. Model parameters for the validation with real data\ndiscretisation time step \u2206ti 10 [sec]\nfree flow speed vf 120 [km\/h]\nminimum speed voutmin,i 7.4 [km\/h]\ndensity coefficient \u03b1i = 0.15\nspeed coefficient \u03b2i,k+1 =\n\uf8f1\uf8f2\uf8f30.3, if |\u03c1antici+1,k+1 \u2212 \u03c1i,k+1| \u2265 1,0.7 otherwise.\ncell length L1 = L2 = 0.6 [km], L3 = L4 = 0.5 [km]\nminimal time distance td = 2 [sec]\ncritical density \u03c1crit = 20.89 [veh\/km\/lane]\nnoises \u03b7Si,k and \u03b7vi,k with Gaussian distribution\ncovariance of the noise in the sending function cov{\u03b7Si,k} = (0.11Ni,kvi,k\u2206tk\/Li)2 [veh]2\ncovariance of the noise in the speed cov{vi,k} = 1.32 [km\/h]2\n5 Conclusions\nA stochastic compositional model for freeway traffic flows is proposed. It is intuitive, and\ngenerally applicable to freeways with different topologies, with any number of sensors, with\nregularly or irregularly received data in space and in time. The approach of modelling the\ntraffic on freeways by the developed stochastic dynamic model with sending and receiving\nfunctions has the following features: modularity, flexibility, suitable for parallel computa-\ntions. Changes in the topology of the freeway network only require addition or deletion of a\nfew components (local changes to the model). Currently we are working on an extension of\nthe model to road networks with intersections. The inclusion in the model of weaving and\nmerging phenomena at on- or off-ramps is another open issue for research.\nThe compositional model is shown to work well, both on synthetic and real traffic data sets.\nThe model can be used for the design of recursive prediction (with the Monte Carlo filtering\napproach (Mihaylova & Boel, 2004)) of the state of the traffic network. These predictions\nin turn can serve for designing model predictive control strategies, optimizing the behavior\nof a network by e.g. ramp metering, or adaptive speed limits.\nAcknowledgments. The authors are thankful the Editor and reviewers which valuable com-\nments helped for improving considerably the paper. This work was initiated by the Belgian project\n14\nDWTC-CP\/40 \u201cSustainability effects of traffic management\u201d. We acknowledge also the financial\nsupport of the Programme on Inter-University Poles of Attraction initiated by the Belgian State,\nPrime Minister\u2019s Office for Science, Technology and Culture. The authors are thankful ir. C.\nCarbone for the fruitful discussions on different traffic models. We also thank the Vlaams Verkeer-\nscentrum, Antwerp, Belgium of the Flemish Ministry of Transportation, and Mr. Frans Middleham\nfrom the Transport Research Centre of the Ministry of the Transport, the Netherlands for providing\nthe data used in this study.\nA Appendix. Algorithmic implementation of the compositional model\n1. Forward wave: for i = 1, 2, . . . , nm\n1.1. calculate the sending function values\nSi,k = max(Ni,k\nvi,k.\u2206ti,k\nLi\n+ \u03b7Si,k, Ni,k\nvoutmin,i.\u2206ti,k\nLi\n) (A.1)\n1.2. set the number of vehicles crossing the cell borders to be equal to Si,k:\nQi,k = Si,k. (A.2)\n2. Backward wave: for i = nm, nm\u22121 . . . , 1\n2.1. calculate the receiving function values\nRi,k = Nmaxi+1,k +Qi+1,k \u2212Ni+1,k, (A.3)\nwhere\nNmaxi+1,k = (Li+1`i+1,k)\/(A` + vi+1,ktd). (A.4)\n- In order to prevent possible numerical instabilities that might happen when abrupt changes\noccur (e.g. reduction in the number of lanes can provoke jams) the following condition is imposed:\nif Ri,k < 0, Ri,k = Qi+1,k.\n2.2. compare Si,k and Ri,k\nif Si,k < Ri,k, Qi,k = Si,k,\nelse Qi,k = Ri,k, vi,k = Qi,kLi\/(Ni,k\u2206tk),\n(A.5)\n3. Number of vehicles inside cells, for i = 1, 2, . . . , nm\nNi,k+1 = Ni,k +Qi\u22121,k \u2212Qi,k, (A.6)\n4. Update the density, for i = 1, 2, . . . , nm\n\u03c1i,k+1 = Ni,k+1\/(Li`i,k+1), (A.7)\n\u03c1antici,k+1 = \u03b1i\u03c1i,k+1 + (1\u2212 \u03b1i)\u03c1i+1,k+1, (A.8)\n15\n5. Update of the speed, for i = 1, 2, . . . , nm\nvintermi,k+1 =\n{\n[vi\u22121,kQi\u22121,k + vi,k(Ni,k \u2212Qi,k)]\/Ni,k+1, for Ni,k+1 6= 0,\nvf , otherwise,\n(A.9)\nvintermi,k+1 = max(v\ninterm\ni,k+1 , v\nout\nmin,i),\nvi,k+1 = \u03b2i,k+1vintermi,k+1 + (1\u2212 \u03b2i,k+1)ve(\u03c1antici,k+1) + \u03b7vi,k+1, (A.10)\n\u03b2i,k+1 =\n{\n\u03b2I , if |\u03c1antici+1,k+1 \u2212 \u03c1antici,k+1| \u2265 \u03c1threshold,\n\u03b2II otherwise,\n(A.11)\nwhere \u03b2I < \u03b2II and ve(\u03c1antici,k+1) is calculated according to (9). The second part of equation (A.9)\nreflects the fact that the drivers tend to reach their free-flow speed when a cell is empty.\nReferences\nBellemans, T. (2003). Traffic control on motorways. Ph.D. thesis, Katholieke Universiteit\nLeuven, Belgium.\nBoel, R., & Mihaylova, L. (2004). Modelling freeway networks by hybrid stochastic models.\nIn Proc. of the IEEE Intelligent Vehicle Symposium (pp. 182\u2013187). Parma, Italy.\nDaganzo, C. (1994). The cell transmission model: A dynamic representation of highway\ntraffic consistent with the hydrodynamic theory. Transportation Research B, 28B(4),\n269-287.\nDaganzo, C. (1995). A finite difference approximation of the kinematic wave model of traffic\nflow. Transportation Research B, 29B(4), 261\u2013276.\nDoucet, A., Freitas, N., & N. Gordon, E. (2001). Sequential Monte Carlo methods in\npractice. New York: Springer-Verlag.\nHelbing, D. (2001). Traffic and related self-driven many-particle systems. Review of Modern\nPhysics, 73, 1067-1141.\nHilliges, M., & Weidlich, W. (1995). A phenomenological model for dynamic traffic flow in\nnetworks. Transportation Research B, 29B(6), 407\u2013431.\nKotsialos, A., Papageorgiou, M., Diakaki, C., Pavlis, Y., & Middelham, F. (2002, December).\nTraffic flow modeling of large-scale motorway using the macroscopic modeling tool\nMETANET. IEEE Trans. on Intelligent Transportation Systems, 3 (4), 282-292.\nMihaylova, L., & Boel, R. (2003). Hybrid stochastic framework for freeway traffic flow\nmodelling. In Proc. of the Intl. Symp. on Inform. and Communication Technologies\n(p. 391-396). Trinity College Dublin, Ireland.\nMihaylova, L., & Boel, R. (2004). A particle filter for freeway traffic estimation. In Proc.\nof the 43rd IEEE Conf. on Decision and Control (p. 2106-2111). (Atlantis, Paradise\nIsland, Bahamas)\nRistic, B., Arulampalam, S., & Gordon, N. (2004). Beyond the Kalman filter: Particle filters\nfor tracking applications. Artech House.\n16\n"}