{"doi":"10.1109\/EPE.2007.4417316","coreId":"54864","oai":"oai:eprints.lincoln.ac.uk:2356","identifiers":["oai:eprints.lincoln.ac.uk:2356","10.1109\/EPE.2007.4417316"],"title":"A back to back multilevel converter for driving low inductance brushless AC machines","authors":["Minshull, S.","Bingham, Chris","Foster, M. P.","Stone, D. A."],"enrichments":{"references":[{"id":18444680,"title":"A vector control scheme for EV induction motors with a series iron loss model.","authors":[],"date":"1998","doi":"10.1109\/41.704890","raw":"Jung, J. and K. Nam.: A vector control scheme for EV induction motors with a series iron loss model. IEEE Transactions on Industrial Electronics, 1998. 45(4): p. 617-624.","cites":null},{"id":18444664,"title":"Diode-clamped multilevel converters: A practicable way to balance DC-link voltages.","authors":[],"date":"2002","doi":"10.1109\/tie.2002.801237","raw":"Marchesoni, M. and P. Tenca.: Diode-clamped multilevel converters: A practicable way to balance DC-link voltages. IEEE Transactions on Industrial Electronics, 2002. 49(4): p. 752-765.","cites":null},{"id":18444682,"title":"Multilevel DC link inverter for brushless permanent magnet motors with very low inductance. IAS Annual Meeting.","authors":[],"date":"2001","doi":"10.1109\/ias.2001.955549","raw":"Su, G.J. and D.J. Adams.: Multilevel DC link inverter for brushless permanent magnet motors with very low inductance. IAS Annual Meeting. 2001. Chicago, IL.","cites":null},{"id":18444666,"title":"PWM regenerative rectifiers: State of the art.","authors":[],"date":"2005","doi":"10.1109\/tie.2004.841149","raw":"Rodriguez, J.R., et al.: PWM regenerative rectifiers: State of the art. IEEE Transactions on Industrial Electronics, 2005. 52(1): p. 5-22.","cites":null},{"id":18444665,"title":"Theoretical and Practical Limits","authors":[],"date":"2001","doi":null,"raw":"Marchesoni, M. and P. Tenca.: Theoretical and Practical Limits in Multilevel MPC Inverters with Passive Front Ends. EPE2001. 2001. Graz.","cites":null},{"id":18444678,"title":"Voltage-balancing strategies for diode-clamped multilevel converters. PESC Record.","authors":[],"date":"2004","doi":"10.1109\/pesc.2004.1355180","raw":"Pou, J., et al.: Voltage-balancing strategies for diode-clamped multilevel converters. PESC Record. 2004. Aachen, Germany.","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2007","abstract":"Traditionally, multilevel converters are utilised in medium voltage applications, allowing the DC-link voltage to exceed the switch maximum blocking voltage. Here, their application to control high- efficiency brushless permanent magnet synchronous machines exhibiting low phase inductance is explored, the relative advantages being shown to include reduced current ripple and improved harmonic spectrum. A cost benefit analysis is included along with experimental results from a prototype 5-level back-to-back converter","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/54864.pdf","fullTextIdentifier":"http:\/\/eprints.lincoln.ac.uk\/2356\/1\/minshull_1.pdf","pdfHashValue":"5e37cf54b37fe02a460edb2137a03719667ce777","publisher":"IEEE","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lincoln.ac.uk:2356<\/identifier><datestamp>\n      2014-08-28T09:24:55Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D6A6163735F48:6A6163735F48363330<\/setSpec><setSpec>\n      74797065733D636F6E666572656E63655F6974656D<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/eprints.lincoln.ac.uk\/2356\/<\/dc:relation><dc:title>\n        A back to back multilevel converter for driving low inductance brushless AC machines<\/dc:title><dc:creator>\n        Minshull, S.<\/dc:creator><dc:creator>\n        Bingham, Chris<\/dc:creator><dc:creator>\n        Foster, M. P.<\/dc:creator><dc:creator>\n        Stone, D. A.<\/dc:creator><dc:subject>\n        H630 Electrical Power<\/dc:subject><dc:description>\n        Traditionally, multilevel converters are utilised in medium voltage applications, allowing the DC-link voltage to exceed the switch maximum blocking voltage. Here, their application to control high- efficiency brushless permanent magnet synchronous machines exhibiting low phase inductance is explored, the relative advantages being shown to include reduced current ripple and improved harmonic spectrum. A cost benefit analysis is included along with experimental results from a prototype 5-level back-to-back converter.<\/dc:description><dc:publisher>\n        IEEE<\/dc:publisher><dc:date>\n        2007<\/dc:date><dc:type>\n        Conference or Workshop contribution<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/eprints.lincoln.ac.uk\/2356\/1\/minshull_1.pdf<\/dc:identifier><dc:identifier>\n          Minshull, S. and Bingham, Chris and Foster, M. P. and Stone, D. A.  (2007) A back to back multilevel converter for driving low inductance brushless AC machines.  In: Power Electronics and Applications, 2007 European Conference on, 2-5 September 2007, Aalborg, Denmark.  <\/dc:identifier><dc:relation>\n        http:\/\/dx.doi.org\/10.1109\/EPE.2007.4417316<\/dc:relation><dc:relation>\n        10.1109\/EPE.2007.4417316<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/eprints.lincoln.ac.uk\/2356\/","http:\/\/dx.doi.org\/10.1109\/EPE.2007.4417316","10.1109\/EPE.2007.4417316"],"year":2007,"topics":["H630 Electrical Power"],"subject":["Conference or Workshop contribution","PeerReviewed"],"fullText":" 1\nA Back to Back Multilevel Converter for Driving Low Inductance \nBrushless AC Machines \nS. R. Minshull, C. M. Bingham, D. A. Stone, M. P. Foster \nDepartment of Electrical and Electronic Engineering \nUniversity of Sheffield  \nSheffield, UK \nTel.: +44 \/ (0) \u2013 114 2225847  \nFax: +44 \/ (0) \u2013 114 2225143 \nE-Mail: s.r.minshull@sheffield.ac.uk \nKeywords \n\u00abMultilevel converter\u00bb, \u00abVariable speed drive\u00bb, \u00abVector control\u00bb, \u00abBrushless drive\u00bb, \u00abAC\/AC \nconverter\u00bb. \nAbstract \nTraditionally, multilevel converters are utilised in medium voltage applications, allowing the dc-link \nvoltage to exceed the switch maximum blocking voltage.  Here, their application to control high-\nefficiency brushless permanent magnet synchronous machines exhibiting low phase inductance is \nexplored, the relative advantages being shown to include reduced current ripple and improved \nharmonic spectrum.  A cost benefit analysis is included along with experimental results from a \nprototype 5-level back-to-back converter. \nIntroduction \nSix-switch, two level converters have traditionally been used to excite Permanent Magnet \nSynchronous Machine (PMSM) drive systems.  However, as the phase inductance of the machines has \nreduced, to facilitate the production of high power-dense units with high fundamental electrical \nfrequency, the switching frequency of the converter has had to increase to keep the ripple current \nwithin bounds.  Since the switching frequency is ultimately limited by losses and device speed limits, \nmultilevel converters are considered an attractive alternative due to their ability to reduce the ripple \ncurrent without an increase in the switching frequency.  Here then, the paper considers a comparison \nof back-to-back multilevel converters, with a classical two level counterpart, for the control of a \nrelatively low voltage, low inductance PMSM.   \nBack-to-Back System Configuration \n2\u00d75-level diode clamped converters, connected back to back, have been developed to demonstrate the \nsuitability of multilevel converters for driving low inductance Brushless AC (BLAC) machines in \nAC-DC-AC applications, Fig.1.  The back-to-back connection is utilised to allow balancing of the DC \nlink capacitor voltages under a full range of operating conditions [1] whereas, only a limited operating \nrange is possible if a passive rectifier (diode bridge) is employed [2].  Additional advantages brought \nby the back-to-back connection have been shown to include: the ability to draw almost sinusoidal \ncurrents from the supply, the input power factor can be controlled and the back-to-back topology \nautomatically regenerates power back to the supply when the operating conditions dictate [3].  \nAlternatively, a passive rectifier draws a pulsed current from the supply and does not allow a \nregenerative current to return to the supply.  The pulsed current can cause Electromagnetic \nInterference (EMI) and may require the addition of a power filter to the system, whilst an energy \ndumping circuit would be required if the drive was to operate in the generating region.  Furthermore, \nthe back-to-back topology allows the DC link voltage to be varied, within limits, which allows further \ncurrent ripple reductions and reduced losses during low speed machine operation.  \n \n 2\nWhilst the matrix converter topology allows 4-quadrant AC\/AC conversion, it does not provide the \nbenefits of reduced current ripple and associated reduced machine eddy current losses that the \nmultilevel topology offers. \n \n \nFig. 1: 5-Level Diode Clamped Back-to-Back Converter \n \nReferring to Fig.1, the two converters are connected by the multilevel DC link created by the series \nconnection of 4 capacitors (C1 - C4).  Each phase is constructed from 8 switches (S1 - S8) and  \n6 clamping diodes (D1 - D6).  The output voltage is formed by operating switches S1, S2, S3 and S4 \ncomplementary to switches S5, S6, S7 and S8 respectively.  For example, to produce a voltage of \n3\n4\nDCV , at the C phase rectifier input, switches S2 - S5 are closed and switches S1, S6 - S8 are open.  \nDiode D1 then clamps the phase C rectifier input to 3 4\nDCV  for current flowing from the rectifier to the \nsupply and diode D2 does the same for current flowing from the supply into the rectifier. \n \nProviding correct balancing of the DC link voltage across the 4 DC link capacitors, each switch \nexperiences a voltage of 4\nDCV  across its terminals and the clamping diodes experience up to 3 4\nDCV  \ndepending upon their position in the circuit.  The inductors in series with the 3 phase voltage supplies \nfulfil 3 purposes: i) to provide energy storage to allow for voltage boost operation of the rectifier, ii) to \nprovide a reactive voltage drop permitting input power factor control and iii) to filter converter \nswitching frequency harmonics in the 3 phase supply currents. \n \nControl of Back-to-Back Converter \nFig. 2 illustrates the Field Orientated Control (FOC) scheme employed to control the inverter and \nrectifier.  The machine currents are converted into the rotating dq axis such that simple proportional + \nintegral (PI) controllers can be used.  The d axis current is controlled to be zero and the q axis current \nis used to control the torque with the addition of an outer speed control loop.  In order to balance the \nvoltages across the series connected DC link capacitors a switching scheme detailed in [1, 4] is \nemployed.  This scheme uses a minimum energy principle to choose the best redundant switching \nvectors in each modulation period such that the DC link capacitor voltage imbalance is minimised.  \nRotor position is obtained with a resolver. \n 3\n \nThe rectifier control is similar to that of the inverter with the exception of the outer control loop \nmanaging the total DC link voltage and position information being obtained from a phase locked loop \nlocked to the 3 phase supply voltage. \n  \n \n \nFig. 2:  Control Scheme \n \nThe control scheme is implemented on a Texas Instruments TMS320C6713DSK development board \nwith peripheral support such as analogue to digital conversion and resolver to digital conversion on a \ncustom made daughterboard.  The required gate drive signals are generated using a Xilinx Spartan 3 \nFPGA development board.  The experimental rig is shown in Fig. 3. \n \n \n \nFig. 3:  Experimental Rig \n 4\nCurrent Ripple Analysis \nIn BLAC drive systems, current ripple is caused due to the non-perfect estimation of the required \nsinusoidal voltage drive waveforms from PWM approximations.  As the inductance of the machine is \nreduced, to facilitate high speed, high power dense machines, this current ripple will increase which is \nundesirable due to the creation of a ripple torque and increased losses in the machine due to eddy \ncurrents [5]. \n \nConsidering the electrical equation of the BLAC machine for a single phase: \n \n      dIV IR L E\ndt\n= + +                                  (1) \n \n \nwhere V , I , R , L  and E are the terminal phase voltage, machine phase current, phase resistance, \nphase inductance and back-emf respectively, it is possible to derive an equation for the peak-to-peak \ncurrent ripple when driven by a classical 2-level converter.  Considering further that the converter is \nmodulated with a PWM signal of duty cycle \u2202  and switching frequency F  operating from a DC link \nvoltage of DCV , the peak-to-peak current ripple is given by: \n \n( )2DCpp VI FL= \u2202 \u2212 \u2202                  (2) \n  \n             \nThis derivation makes the assumptions that the average current remains constant during a single PWM \nperiod and that all the ripple voltage due to the ripple current appears across the inductance.  The \nmaximum value of (2) occurs at 0.5\u2202 = .  A similar analysis can be performed for the multilevel case \nwith n  levels, giving: \n  \n( )( )21 \u2202\u2212\u2212\u2202= n\nLF\nVI DCpp            (3)\n \n \nFor example, a 3 level converter has maximum peak-to-peak current ripple values at 0.25\u2202 =  and \n0.75\u2202 =  with the maximum value being half that of the 2-level case since the incremental voltage \napplied to the machine is 2\nDCV . \n \nFig. 4 shows the results of this analysis for 2, 3, 4 and 5-level converters.  The currents data have been \nnormalised to that of the maximum peak-to-peak current ripple for 2-levels.  It can be seen, from  \nFig. 4 that 3, 4, and 5-level variants reduce the current ripple by 50%, 33% and 25%, respectively, \ncompared to classical 2-level variants.  A similar analysis has been performed in [6] for a 5-level \nconverter.   \n \nFig. 5 shows simulated current ripple under a q axis step current demand of 100A for a machine with \n100 H\u00b5  phase inductance operating from a 600V DC link.  With the d axis current controlled to be \nzero, a steady q axis current demand results in a constant torque produced by the machine, which \nfurther results in a steady acceleration of the machine when zero load torque is applied.  The voltage \ndemand (or peak duty cycle) therefore sweeps from zero to a maximum of 1.  The normalised peak \ncurrent ripples can therefore be compared between the theoretical values in Fig. 4 and the simulated \nvalues in Fig. 5.  It can be seen that the simulated maximum peak-to-peak ripple current for 3, 4 and 5-\nlevels is reduced by 51%, 37% and 27%, respectively, over the 2-level converter which corresponds \nwell with the theoretical results in Fig. 4. \n \n 5\n \nFig. 4:  Peak to Peak Ripple Current Vs Converter Voltage Demand \n \n \nFig. 5:  Simulated Current Ripple \nHarmonic Performance \nThe multilevel back-to-back system is also used to investigate the expected reduction in Total \nHarmonic Distortion (THD) of the currents flowing in the BLAC machine.  The inverter is controlled \nsuch that the machine operates at a constant speed under a fixed load torque in order that the machine \ncurrents are of constant frequency and amplitude at steady state.  A section of machine current data is \nextracted from the simulation results and a Fast Fourier Transform (FFT) is applied to estimate the \n 6\nharmonic content of the currents and calculate a THD value.  For each converter a speed demand is \nchosen to provide maximum ripple current allowing a proper comparison between the different levels. \n \nTable I shows the percentage THD and the THD normalised to the 2-level value.  Fig. 6 shows a plot \nof the normalised THD values versus converter levels.  It can be seen that the THD improves as the \nnumber of levels increases and also that it follows in the similar pattern of roughly 50%, 33% and 25% \nreduction over 2-levels as in the case of the current ripple. \n \n \nTable I: Total harmonic distortion of \nmachine currents  \nFig.6:  Normalised THD versus Converter \nLevels \nCost of Multilevel Converters \nThe main disadvantage of employing multilevel converters is the increased number of components \nrequired and hence the increase in cost.  This section aims to estimate the cost of diode clamped \nconverters and compare it against the benefits of reduced current ripple produced by the multilevel \naction. \n \nTable II shows the number of the main components in 2, 3, 4 and 5-level converters, along with an \nestimated cost for a single converter.  Table III shows the same data for back-to-back connected \nconverters.  In both cases the estimated cost has been normalized to the cost of a single classical  \n2-level converter.  To derive this data the following points are noted: \n \n\u2022 The price data was collated from the Farnell 2006 catalogue, where devices were chosen from \nthe same family where possible, to fit with a 5kW drive rating. \n\u2022 It is assumed that the capacitor balancing scheme operates correctly and so the voltage rating \nof devices such as IGBTs and DC link capacitors are reduced for an increasing number of \nconverter levels. \n\u2022 IGBTs were chosen with integral freewheel diodes and so these diodes do not appear in \nTables II and III. \n\u2022 The number of current and voltage transducers was set to measure each variable required in \nthe control algorithm, even when one value could be inferred from others, e.g. 3 current \ntransducers are specified for measuring the 3 phase machine currents. \n\u2022 The cost of the required control was not considered but it should be noted that the complexity \nof the capacitor balancing algorithm rises sharply with an increasing number of converter \nlevels. \nLevels THD (%) Normalised THD \n2 15.3 1 \n3 7.8 0.51 \n4 5.8 0.38 \n5 4.1 0.27 \n 7\nTable II:  Number of main components and estimated cost for a single converter \nConverter \nLevels \nIGBTs Clamping \nDiodes \nDC Link \nCapacitors\nGate \nDrive \nCircuits \nVoltage \nTransducers\nCurrent \nTransducers \nNormalized \nCost \n2 6 0 1 6 0 3 1 \n3 12 6 2 12 1 3 1.23 \n4 18 12 3 18 2 3 1.65 \n5 24 18 4 24 3 3 2.21 \n \nTable III:  Number of main components and estimated cost for a back-to-back converter \nConverter \nLevels \nIGBTs Clamping \nDiodes \nDC Link \nCapacitors\nGate \nDrive \nCircuits \nVoltage \nTransducers\nCurrent \nTransducers \nNormalized \nCost \n2 12 0 1 12 4 6 1.98 \n3 24 12 2 24 5 6 2.50 \n4 36 24 3 36 6 6 3.31 \n5 48 36 4 48 7 6 4.24 \n \n \nFig. 7:  Comparison of number of levels, converter cost and theoretical current ripple \n \nFig. 7 compares the normalised converter cost against the theoretical maximum current ripple for  \n2, 3, 4 and 5-level converters for both single converters and the back-to-back case.  It shows that for \njust over 2x the cost, a reduction of 4x the maximum current ripple can be achieved in specifying a  \n5-level converter over a classical 2-level converter. \n \nFig. 7 also shows that the back-to-back converters are approximately 2x the cost of a single converter \ndue to having almost 2x the number of components.  The additional advantages of having almost \nsinusoidal input currents, unity power factor and allowing for regeneration, offset this cost for  \nAC-DC-AC applications. \n \n 8\nExperimental Results \nThis section includes experimental results obtained from the prototype back-to-back converter which \nwas controlled to produce both 5-level and 2-level outputs to allow comparisons between the different \nlevels to be drawn. \n \nFig. 8 shows a measured phase current in a relatively high inductance (20mH) BLAC machine for \nboth 2 and 5-level converters.  The rectifier operated from a 25Vrms, 400Hz supply to generate a \n120V dc link while the inverter operated at modulation index of 0.9 and a switching frequency of \n24kHz.  A mechanical load for the BLAC machine was provided by a brushed DC machine.  Fig. 8 \nillustrates the reduction in current ripple between 2 and 5-levels.  In this case the maximum current \nripples were found to be 122mA pk-pk and 34 mA pk-pk for the 2 and 5-levels respectively.  This \ncorresponds to a reduction to 28% of the 2-level maximum current ripple for the 5-level converter \nwhich corresponds well with the theoretical reductions shown in Fig. 4. \n \nFig 8:  Machine phase currents for high inductance machine. \n \nFig. 9:  Phase Currents in 3 phase 500\u00b5H inductors \n 9\nIn order to test the performance at low inductances three, star-connected, 500\u00b5H inductors were driven \nby the back-to-back converter operating from a 50Vdc link.  A single inductor current is shown in  \nFig. 9 for both 2 and 5-levels.  Again the reduction in maximum current ripple can be seen from Fig. 9 \nwhere the maximum current ripple is 1.12A pk-pk and 0.31A pk-pk for the 2 and 5-levels respectively. \nThe currents data in Fig.9 was used to calculate a THD figure giving 13.5% and 8.0% for the 2 and  \n5-levels respectively.  This shows a reduction to 59% of the 2-level THD for the 5-level converter.   \nConclusion \nFor an increased cost, diode clamped multilevel converters are an attractive alternative to classical  \n2-level, six switch converters for AC-DC-AC motor drives employing low inductance brushless ac \nmachines.  Benefits shown are reduced current ripple and improved harmonic content of motor \ncurrents. The increase is cost can be justified for applications where the current ripple would be \nprohibitively large, resulting in a large torque ripple and high machine eddy current losses, when \ndriven with a classical 2-level converter.  Experimental results from a prototype 5-level back-to-back \nconverter have been included to verify the theoretical and simulated claims. \nReferences \n[1] Marchesoni, M. and P. Tenca.: Diode-clamped multilevel converters: A practicable way to balance DC-link \nvoltages. IEEE Transactions on Industrial Electronics, 2002. 49(4): p. 752-765. \n[2] Marchesoni, M. and P. Tenca.: Theoretical and Practical Limits in Multilevel MPC Inverters with Passive \nFront Ends. EPE2001. 2001. Graz. \n[3] Rodriguez, J.R., et al.: PWM regenerative rectifiers: State of the art. IEEE Transactions on Industrial \nElectronics, 2005. 52(1): p. 5-22. \n[4] Pou, J., et al.: Voltage-balancing strategies for diode-clamped multilevel converters. PESC Record. 2004. \nAachen, Germany. \n[5] Jung, J. and K. Nam.: A vector control scheme for EV induction motors with a series iron loss model. IEEE \nTransactions on Industrial Electronics, 1998. 45(4): p. 617-624. \n[6] Su, G.J. and D.J. Adams.: Multilevel DC link inverter for brushless permanent magnet motors with very low \ninductance. IAS Annual Meeting. 2001. Chicago, IL. \n \n \n"}