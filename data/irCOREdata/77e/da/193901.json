{"doi":"10.1080\/00207170600944229","coreId":"193901","oai":"oai:lra.le.ac.uk:2381\/2004","identifiers":["oai:lra.le.ac.uk:2381\/2004","10.1080\/00207170600944229"],"title":"Anti-windup synthesis using Riccati equations","authors":["Sofrony, J.","Turner, Matthew C.","Postlethwaite, Ian"],"enrichments":{"references":[{"id":44675017,"title":"A common framework for anti-windup, bumpless transfer and reliable designs.","authors":[],"date":"2002","doi":"10.1016\/s0005-1098(02)00072-9","raw":"L. Zaccarian and A.R. Teel. A common framework for anti-windup, bumpless transfer and reliable designs. Automatica, 38:1735\u20131744, 2002.","cites":null},{"id":44675010,"title":"A new perspective on static and low order anti-windup synthesis.","authors":[],"date":"2004","doi":"10.1080\/00207170310001640116","raw":"M.C. Turner and I. Postlethwaite. A new perspective on static and low order anti-windup synthesis. International Journal of Control, 77(1):27\u201344, 2004.","cites":null},{"id":44674992,"title":"A unified framework for the study of anti-windup designs.","authors":[],"date":"1994","doi":"10.1016\/0005-1098(94)90048-5","raw":"M.V. Kothare, P.J. Campo, M. Morari, and C.N. Nett. A unified framework for the study of anti-windup designs. Automatica, 30(12):1869\u20131883, 1994.","cites":null},{"id":44675007,"title":"Accounting for robustness in anti-windup synthesis.","authors":[],"date":"2004","doi":"10.1109\/cdc.2004.1429607","raw":"M.C. Turner, G. Herrmann, and I. Postlethwaite. Accounting for robustness in anti-windup synthesis. In Proc. American Control Conference, Boston, 2004.","cites":null},{"id":44675012,"title":"Analysis and design of linear conditioning schemes for systems containing saturating actuators.","authors":[],"date":"1998","doi":"10.1016\/s0005-1098(00)00044-3","raw":"P.F. Weston and I Postlethwaite. Analysis and design of linear conditioning schemes for systems containing saturating actuators. IFAC Nonlinear Control System Design Symposium, 1998.","cites":null},{"id":44674987,"title":"Anti-windup and bumpless transfer schemes.","authors":[],"date":"1998","doi":"10.1016\/s0005-1098(97)00165-9","raw":"C. Edwards and I. Postlethwaite. Anti-windup and bumpless transfer schemes. Automatica, 34(2):199\u2013210, 1998.","cites":null},{"id":44674990,"title":"Anti-windup for stable linear systems with input saturation: an LMI based synthesis.","authors":[],"date":"2003","doi":"10.1109\/tac.2003.816965","raw":"G. Grimm, J. Hatfield, I. Postlethwaite, A.R. Teel, M.C. Turner, and L. Zaccarian. Anti-windup for stable linear systems with input saturation: an LMI based synthesis. IEEE Transactions on Automatic Control, 48(9):1509\u20131525, 2003.","cites":null},{"id":44674986,"title":"Anti-windup synthesis for guaranteed L2 performance.","authors":[],"date":"2000","doi":"10.1109\/cdc.2000.911992","raw":"S. Crawshaw and G. Vinnicombe. Anti-windup synthesis for guaranteed L2 performance. Proc. IEEE Conf. on Decision and Control, 2000.","cites":null},{"id":44675003,"title":"Anti-windup synthesis for PIO avoidance in an experimental aircraft.","authors":[],"date":null,"doi":"10.1109\/cdc.2006.377217","raw":"J. Sofrony, M.C. Turner, I. Postlethwaite, O.M. Brieger, and D. Leissling. Anti-windup synthesis for PIO avoidance in an experimental aircraft. In IEEE Conference on Decision and Control, submitted.","cites":null},{"id":44675002,"title":"Anti-windup synthesis using Riccati equations.","authors":[],"date":"2005","doi":"10.3182\/20050703-6-cz-1902.00599","raw":"J. Sofrony, M.C. Turner, and I. Postlethwaite. Anti-windup synthesis using Riccati equations. In Proc. IFAC World Congress, Prague, 2005.","cites":null},{"id":44674997,"title":"Control of a bank-to-turn missile with saturating actuators.","authors":[],"date":"1994","doi":"10.1109\/acc.1994.752353","raw":"A.A. Rodriguez and J. R. Cloutier. Control of a bank-to-turn missile with saturating actuators. Proc. American Control Conference, 1994.","cites":null},{"id":44674999,"title":"Control of linear systems with saturating actuators.","authors":[],"date":"1996","doi":"10.1109\/9.486638","raw":"A. Saberi, Z. Lin, and A.R. Teel. Control of linear systems with saturating actuators. IEEE Trans. on Automatic Control, 41(3):368\u2013378, 1996.","cites":null},{"id":44675004,"title":"Control of Uncertain Systems with Bounded Inputs.","authors":[],"date":"1997","doi":"10.1007\/bfb0032160","raw":"S. Tarbouriech and G. Garcia. Control of Uncertain Systems with Bounded Inputs. Springer-Verlag, London, 1997.","cites":null},{"id":44675005,"title":"Delay-dependent anti-windup strategy for linear systems with saturating inputs and delayed outputs.","authors":[],"date":"2004","doi":"10.1002\/rnc.899","raw":"S. Tarbouriech, J.M. Gomes da Silva Jr., and G. Garcia. Delay-dependent anti-windup strategy for linear systems with saturating inputs and delayed outputs. International Journal of Robust and Nonlinear Control, 14(7):665\u201382, 2004.","cites":null},{"id":44674996,"title":"Disturbance attenuation for systems with input saturation: an LMI approach.","authors":[],"date":"1999","doi":"10.1109\/9.754833","raw":"T. Nguyen and F. Jabbari. Disturbance attenuation for systems with input saturation: an LMI approach. IEEE Trans. Automatic Control, 44(4):852\u2013857, 1999.","cites":null},{"id":44675016,"title":"Extended anti-windup control schemes for LTI and LFT systems with actuator saturations.","authors":[],"date":"2004","doi":"10.1002\/rnc.943","raw":"F. Wu and M. Soto. Extended anti-windup control schemes for LTI and LFT systems with actuator saturations. International Journal of Robust and Nonlinear Control, 14(15):1255\u20131281, 2004.","cites":null},{"id":44674985,"title":"Global and local analysis of coprime-factor based anti-windup for stable and unstable plants.","authors":[],"date":"2003","doi":null,"raw":"S. Crawshaw. Global and local analysis of coprime-factor based anti-windup for stable and unstable plants. Proc. European Control Conference, 2003.","cites":null},{"id":44675008,"title":"Improving robustness in anti-windup synthesis. submitted,","authors":[],"date":"2005","doi":"10.3182\/20050703-6-cz-1902.00689","raw":"M.C. Turner, G. Herrmann, and I. Postlethwaite. Improving robustness in anti-windup synthesis. submitted, 2005.","cites":null},{"id":44675014,"title":"Linear conditioning for systems containing saturating actuators.","authors":[],"date":"2000","doi":"10.1016\/s0005-1098(00)00044-3","raw":"P.F. Weston and I Postlethwaite. Linear conditioning for systems containing saturating actuators. Automatica, 36(9):1347\u20131354, 2000.","cites":null},{"id":44674989,"title":"Linear Robust Control.","authors":[],"date":"1996","doi":"10.1007\/978-1-4612-4484-4_26","raw":"M. Green and D.J.N. Limebeer. Linear Robust Control. Prentice Hall, New Jersey, 1996.","cites":null},{"id":44674995,"title":"Multivariable anti-windup controller synthesis using linear matrix inequalities.","authors":[],"date":"2001","doi":"10.1016\/s0005-1098(01)00075-9","raw":"E.F. Mulder, M.V. Kothare, and M. Morari. Multivariable anti-windup controller synthesis using linear matrix inequalities. Automatica, 37(9):1407\u20131416, 2001.","cites":null},{"id":44675001,"title":"Multivariable feedback control: analysis and design.","authors":[],"date":"2006","doi":null,"raw":"S. Skogstad and I. Postlethwaite. Multivariable feedback control: analysis and design. Wiley, Chichester, England, 2nd edition, 2006.","cites":null},{"id":44674988,"title":"Output feedback compensators for weakened anti-windup of additively perturbed systems.","authors":[],"date":"2005","doi":"10.3182\/20050703-6-cz-1902.00687","raw":"S. Galeani, S. Nicosa, A.R. Teel, and L. Zaccarian. Output feedback compensators for weakened anti-windup of additively perturbed systems. In Proc. IFAC World Congress, Prague, 2005.","cites":null},{"id":44674991,"title":"Pratical implementation of a novel anti-windup scheme in a hdddual-stage servo-system.","authors":[],"date":"2004","doi":"10.1109\/tmech.2004.835333","raw":"G. Herrmann, M.C. Turner, and I. Postlethwaite. Pratical implementation of a novel anti-windup scheme in a hdddual-stage servo-system. IEEE\/ASME Transactions on Mechatronics, 9(3):580\u2013592, 2004.","cites":null},{"id":44674994,"title":"Robust control of plants with saturation nonlinearity based on comprime factor representations.","authors":[],"date":"1996","doi":"10.1109\/cdc.1996.573547","raw":"S. Miyamoto and G. Vinnicombe. Robust control of plants with saturation nonlinearity based on comprime factor representations. Proc. IEEE Conf. on Decision and Control, pages 2838\u20132840, 1996.","cites":null},{"id":44674993,"title":"Robustification of static and low-order anti-windup designs. IFAC","authors":[],"date":null,"doi":"10.3182\/20060705-3-fr-2907.00065","raw":"A. Marcos, M.C. Turner, D.G. Bates, and I. Postlethwaite. Robustification of static and low-order anti-windup designs. IFAC Symposium on Robust Controller Design, submitted.","cites":null},{"id":44674998,"title":"Some comments on anti-windup synthesis using LMI\u2019s.","authors":[],"date":"1999","doi":"10.1002\/(sici)1099-1239(199908)9:10<717::aid-rnc430>3.0.co;2-f","raw":"B.G. Romanchuk. Some comments on anti-windup synthesis using LMI\u2019s. International Journal of Robust and Nonlinear Control, 9(10):717\u2013734, 1999.","cites":null},{"id":44675000,"title":"Synthesis of a static anti-windup compensator via linear matrix inequalities.","authors":[],"date":"2002","doi":"10.1002\/rnc.673","raw":"M. Saeki and N. Wada. Synthesis of a static anti-windup compensator via linear matrix inequalities. International Journal of Robust and Nonlinear Control, 12:927\u2013953, 2002.","cites":null},{"id":44675006,"title":"The L2 anti-windup problem: Its definition and solution.","authors":[],"date":"1997","doi":null,"raw":"A.R. Teel and N. Kapoor. The L2 anti-windup problem: Its definition and solution. Proc. European Cont. Conf., 1997.","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2007","abstract":"The aim of this paper is to give a novel solution to the full order anti-windup (AW) compensation problem for stable systems with input saturation. The solution is obtained by \u201ccompleting the square\u201d in three steps and requires the solution to a single bounded-real Riccati equation, characterized by the open-loop plant's   norm. The Riccati equation plays the role of the LMIs usually found in anti-windup synthesis, but, in addition to its numerical advantages, it yields a family of anti-windup compensators with the same   performance. This family of compensators is parameterized by a matrix which is intimately linked with both the poles of the anti-windup compensator and the robustness properties of the closed-loop saturated system. Thus, this matrix allows a robust anti-windup problem to be solved in a straightforward and intuitive manner. The effectiveness of the proposed technique is demonstrated on a simple example","downloadUrl":"http:\/\/www.informaworld.com\/smpp\/content~db=all?content=10.1080\/00207170600944229.","fullTextIdentifier":"https:\/\/lra.le.ac.uk\/bitstream\/2381\/2004\/1\/robust_AW8_rev.pdf","pdfHashValue":"0cf24f5a3c9a05c48b85ba5fb4ed4e54118d4f57","publisher":"Taylor & Francis","rawRecordXml":"<record><header><identifier>\n    \n        \n            \n                oai:lra.le.ac.uk:2381\/2004<\/identifier><datestamp>\n                2016-01-05T09:29:11Z<\/datestamp><setSpec>\n                com_2381_171<\/setSpec><setSpec>\n                com_2381_9549<\/setSpec><setSpec>\n                col_2381_835<\/setSpec>\n            <\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:doc=\"http:\/\/www.lyncode.com\/xoai\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n            \nAnti-windup synthesis using Riccati equations<\/dc:title><dc:creator>\nSofrony, J.<\/dc:creator><dc:creator>\nTurner, Matthew C.<\/dc:creator><dc:creator>\nPostlethwaite, Ian<\/dc:creator><dc:description>\nThe aim of this paper is to give a novel solution to the full order anti-windup (AW) compensation problem for stable systems with input saturation. The solution is obtained by \u201ccompleting the square\u201d in three steps and requires the solution to a single bounded-real Riccati equation, characterized by the open-loop plant's   norm. The Riccati equation plays the role of the LMIs usually found in anti-windup synthesis, but, in addition to its numerical advantages, it yields a family of anti-windup compensators with the same   performance. This family of compensators is parameterized by a matrix which is intimately linked with both the poles of the anti-windup compensator and the robustness properties of the closed-loop saturated system. Thus, this matrix allows a robust anti-windup problem to be solved in a straightforward and intuitive manner. The effectiveness of the proposed technique is demonstrated on a simple example.<\/dc:description><dc:date>\n2009-12-08T16:16:04Z<\/dc:date><dc:date>\n2009-12-08T16:16:04Z<\/dc:date><dc:date>\n2007<\/dc:date><dc:type>\nArticle<\/dc:type><dc:identifier>\nInternational Journal of Control, 2007, 80 (1), pp.112-128<\/dc:identifier><dc:identifier>\n0020-7179<\/dc:identifier><dc:identifier>\nhttp:\/\/www.tandfonline.com\/doi\/abs\/10.1080\/00207170600944229<\/dc:identifier><dc:identifier>\nhttp:\/\/hdl.handle.net\/2381\/2004<\/dc:identifier><dc:identifier>\n10.1080\/00207170600944229<\/dc:identifier><dc:language>\nen<\/dc:language><dc:relation>\nRAE 2007<\/dc:relation><dc:rights>\nThis is the author's final draft of the paper published as International Journal of Control, 2007, 80 (1), pp.112-128.  The final version is available from http:\/\/www.informaworld.com\/smpp\/content~db=all?content=10.1080\/00207170600944229.  Doi: 10.1080\/00207170600944229<\/dc:rights><dc:publisher>\nTaylor & Francis<\/dc:publisher>\n<\/oai_dc:dc>\n<\/metadata>\n        <\/record>","journals":[{"title":null,"identifiers":["0020-7179","issn:0020-7179"]}],"language":{"code":"en","id":9,"name":"English"},"relations":["RAE 2007"],"year":2007,"topics":[],"subject":["Article"],"fullText":"Anti-windup synthesis using Riccati equations\u2021\nJorge Sofrony \u2020, Matthew C. Turner \u2217\u2020and Ian Postlethwaite \u2020\nControl and Instrumentation Research Group,\nDepartment of Engineering,\nUniversity of Leicester,\nLeicester,\nLE1 7RH, UK.\n{ js246,mct6,ixp } @ le.ac.uk\nAbstract\nThe aim of this paper is to give a novel solution to the full order anti-windup (AW) compensation problem\nfor stable systems with input saturation. The solution is obtained by \u201ccompleting the square\u201d in three steps\nand requires the solution to a single bounded-real Riccati equation, characterised by the open-loop plant\u2019s\nH\u221e norm. The Riccati equation plays the role of the LMI\u2019s usually found in anti-windup synthesis, but, in\naddition to its obvious numerical advantages, it yields a family of anti-windup compensators with the same\nL2 performance. This family of compensators is parameterised by a matrix which is intimately linked with\nboth the poles of the anti-windup compensator and the robustness properties of the closed-loop saturated\nsystem. Thus, this matrix allows a robust anti-windup problem to be solved in a straightforward and intuitive\nmanner. The effectiveness of the proposed technique is demonstrated on a simple example.\nKeywords: anti-windup, saturation, robustness\n1 Introduction\nTwo of the most frequent problems ecountered by control engineers are model uncertainty and actuator satu-\nration. Input saturation has been tackled in a number of different ways over the years, including the design of\none-shot linear controllers which directly account for saturation ([15, 12]); model predictive control, where the\ncontrol constraints are incorporated into the optimisation procedure; and anti-windup techniques, whereby an\nexisting linear controller - designed for the linear unconstrained plant - is augmented with an additional linear\nelement which becomes active only when saturation occurs ([8, 3]).\nThis paper concentrates on the latter methodology: anti-windup compensation. Such a technique is practi-\ncally important as it gives a simple, intuitive and potentially computationally efficient way of handling input\nconstraints, while not restricting the initial linear controller design. The technique complements the existing\ncontroller, preventing a re-design of the baseline control algorithm, yet it has the power to limit performance\ndegradation during saturation periods. Although such an approach has its roots in industrial control, over the\nlast twenty years or so, the research community has proposed more systematic AW designs. A full review of\n\u2217Corresponding author\n\u2020Work supported by the UK Engineering and Physical Science Research Council\n\u2021A preliminary version of this paper was presented at the 2005 IFAC World Congress\n1\n2these designs is beyond the scope of this paper but the interested reader can consult [10, 1, 21, 29, 25, 28] and\nreferences therein for details.\nOne of the common elements in many of these recent AW techniques is that their synthesis is dependent on a\nset of linear matrix inequalities (LMI\u2019s) being feasible ([11, 6, 25, 28, 16]). Although there are several free and\ncommercial packages available for solving LMI problems, for large and ill-conditioned problems, they are often\nprone to numerical errors and, arguably, some design insight is lost. As will be seen later, the method proposed\nin this paper eliminates LMI\u2019s from the design process, and instead relies on the solution to a single Riccati\nequation of bounded-real type. Such an approach combines the reliable numerical procedures used for Riccati\nequation solutions with a degree of flexibility, in the form of a diagonal, positive definite matrix, which is absent\nin the corresponding LMI approach.\nAnother common characteristic of many recent anti-windup techniques is the lack of attention given to robust-\nness. Although robustness to uncertainty has been studied in robust control literature for many years, it is\nconspicuously absent from most anti-windup literature. The implicit assumption present in these papers appears\nto be that the saturated closed-loop system with anti-windup will inherit similar robustness properties to those of\nthe nominal linear system. As shown in [23], this is not always the case.\nAn early attempt to consider robustness in the design of saturated feedback systems was made in [20], although\nmost of the results contained therein pertained to one-shot constrained control solutions rather than anti-windup\nper se. With few exceptions, the main results on robustness analysis of anti-windup systems are contained within\n[22], [23], and [4]. The results of [22] consider only static uncertaintes, while those in [4] allow a modification\nof the nominal linear closed-loop, leading to the so-called weakened anti-windup problem. We follow the work\nof [23] where standard anti-windup is considered, but the uncertainty is allowed to be dynamic, and of the\nadditive type used in standard linear robust control ([5, 17]. This allows a general and methodical treatment of\nuncertainty, and one which is closely linked to that used in practice. It transpires that such a treatment leads to\nelegant and intuitive results when approached using the Riccati equation technique advocated in this paper.\nThe paper is organised as follows. Firstly, the problems we seek to solve are defined and then followed by sec-\ntions describing their solutions. Particular attention is devoted to the interplay between the robustness properties\nof the anti-windup compensator and a free parameter, the so-called \u201cstability multplier\u201d. The theoretical results\nare followed by an academic example in which the strengths of the Riccati-based scheme are demonstrated and\ncompared with other useful techniques. Finally we draw some brief conclusions.\n1.1 Assumptions and Notation\nThe notation used is standard throughout. The Lp norm of the time-dependent vector y(t) \u2208 Rny is denoted\nas \u2016y\u2016p and the induced Lp norm of a possibly nonlinear operator Y : Y1 \u2192 Y2 from one Lebesque space to\nanother, as \u2016Y\u2016i,p. To avoid notational clutter the time variable (t) and the Laplace argument (s) are omitted\nif no confusion is believed to arise. The Euclidean norm of the vector y(t) is given by \u2016y(t)\u2016 = \u221ay(t)\u2032y(t).\nThe distance between a vector y(t) and a compact set Y is denoted by dist(y,Y) := inf\u03c9\u2208Y \u2016y \u2212 w\u2016. Ri\u00d7j\nrepresents the space of all the real rational i \u00d7 j transfer function matrices, and RH\u221e the subset which are\nanalytic in the closed right-half complex plane with supremum on the imagnary axis.\n32 Problem formulation\nWe consider the stable, FDLTI (finite dimensional linear time invariant) plant\nG(s) \u223c\n{\nx\u02d9 = Ax + Bum\ny = Cx + Dum\n(1)\nwhere x \u2208 Rnp is the plant state, um \u2208 Rm is the plant input (saturated control signal) and y \u2208 Rq is the plant\noutput, which is fed back to the controller. For simplicity disturbances are not considered although they can\neasily be accounted for (see [27],[25]) The nominal linear plant transfer function is denoted as:\nG(s) \u223c\n[\nA B\nC D\n]\n\u2208 RH\u221e (2)\nThe need for the global stability assumption will become clear in the proofs later on.\nThe plant input um is given by the nonlinear saturation function where:\num = sat(u) = [sat(u1), . . . , sat(um)]\n\u2032\nand sat(ui) = sign(ui) min{|ui|, u\u00afi}, where u\u00afi > 0 \u2200i \u2208 {1, . . . , m}. If there is no saturation present, sat(u) \u2261\nu, and nominal linear closed-loop dynamics govern the system. It is also convenient to define the deadzone\nfunction, Dz(.), related to the saturation function through the identity\nDz(u) = u\u2212 sat(u) (3)\nNote that, for all u \u2208 U \u2282 Rm where\nU := [\u2212u\u00af1, u\u00af1]\u00d7 . . .\u00d7 [\u2212u\u00afm, u\u00afm] (4)\nit follows that Dz(u) = 0. A charactersitic of the deadzone, central to the results derived here, is that Dz(.) \u2208\nSector[0, I], as defined below.\nDefinition 1 The decentralised nonlinearity N = diag(\u03b71, . . . , \u03b7m) is said to belong to Sector[0, I] if the fol-\nlowing inequality holds:\n\u03b7i(ui)\n2 \u2264 \u03b7i(ui)ui \u2264 u2i \u2200 i \u2208 {1, . . . , m} (5)\nThis definition will later allow us to formulate an H\u221e-type optimisation problem using the Circle Criterion.\n2.1 Standard AW formulation\nCharacterising the main objective of AW compensation is subjective but the general underlying idea is simple:\nwe require a fast and smooth return to linear behaviour after saturation ([8], [22]). We term this objective the\ntrue goal of anti-windup compensation. Although many different formulations have arisen (see some of the\nreferences given earlier) few have been able to address successfully the true goal of AW in a general, systematic\nand intuitive way.\nFigure 1 shows a generic anti-windup configuration, where G(s) is the plant described earlier and K(s) is\nthe controller which has been designed to stabilise the nominal (un-saturated) plant and achieve some nominal\n4K(s) G(s)\n\u0398(s)\nr\ny\n+ -\n+\n+\nyd\nud\n-\n+ulin um\nylin\n~u\nu\nFigure 1: Generic Anti-Windup scheme\nK(s) G(s)\nM(s)-I\nr\ny\n+ -\n+\n+\nyd\nud\n-\n+ulin um\nylin\n~u\nu\nG(s)M(s)\nFigure 2: Conditioning with M(s)\nperformance specifications. These are standard assumptions in the anti-windup literature and are required for\nthe anti-windup problem to make practical sense. \u0398(s) is the anti-windup compensator which only becomes\nactive once saturation has occurred. The compensator has two sets of outputs, ud \u2208 Rm and yd \u2208 Rq, which are\ninjected at the controller output and the controller input respectively.\nA novel method of representing most AW schemes using a single transfer function M(s) was proposed in [26].\nIn this work, the anti-windup compensator was parameterised by a transfer function matrix M(s) \u2208 RH\u221e as\nshown in Figure 2. As before, the plant is G(s) and the controller is K(s); the reference is r(t), the plant input\num(t), and the controller output u(t). It was then shown that, using this parameterisation, Figure 2 could be\nre-drawn as Figure 3 where the closed-loop AW compensated system is decoupled into three parts: nominal\nlinear loop, nonlinear loop and disturbance \u0002lter. This new decoupled structure provides a useful tool for the\nanalysis of existing anti-windup schemes and the design of new ones.\nFrom Figure 3, observe that our intuitive objectives for good anti-windup performance can be accomplished if\nthe map from ulin to yd is made small in some sense. The problem of minimising the L2 gain of Tp : ulin 7\u2192 yd\nwas considered in [25] and [23] where methods for static, low and full order AW compensation were derived\nbased on LMI optimisation. One of the main problems with the static and low order schemes is that there is\nno guarantee that one of these schemes will globally stabilise the system in question. In contrast, there always\nexists a full-order AW compensator which globally stabilises a linear control system with saturation, providing\nthe plant is open-loop stable. It is this type of compensator which the remainder of the paper will focus on.\nFull-order AW compensation is that in which the order of the AW compensator is the same as that of the plant.\nFrom Figure 2, in order for our AW compensator parametrised by M(s) to be full-order, pole-zero cancellations\nmust occur between M(s) and G(s). In [27] it was suggested that a good choice of M(s) would be a right\n5ulinK(s) G(s)\nr\nylin\nyd\nud\n-\n+\n+\ny\nM(s)-I\nG(s)M(s)\n+\nNon-Linear Loop\nLinear Loop\nDisturbance Filter\nu ~u\nFigure 3: Decoupled structure\ncoprime factorization of the plant, G(s) = N(s)M(s)\u22121, providing a dual representation of anti-windup com-\npensators to that given by [8] (also used by [10] and [2]). Thus, the disturbance filter reduces to N(s) and the\nthe AW compensator is completely independent of the controller K(s). A suitable representation for M and N ,\nwithout introducing any extra states, is:\n[\n\u03981\n\u03982\n]\n=\n[\nM \u2212 I\nN\n]\n=\n\uf8f1\uf8f4\uf8f2\n\uf8f4\uf8f3\nx\u02d9 = (A + BF )x + Bu\u02dc\nud = Fx\nyd = (C + DF )x + Du\u02dc\n(6)\nwhere F is a free parameter and A + BF must be Hurwitz. Thus, the problem of designing a full-order anti-\nwindup compensator becomes that of choosing an appropriate right coprime factorisation, which in turn reduces\nto that of choosing an appropriate state-feedback gain matrix, F .\nIn the standard AW formulation we do not consider uncertainty and focus on ensuring that linear behaviour is\nperturbed as little as possible by any saturation events and that linear behaviour is recovered ([25, 22]). Formally,\nthe problem we address is encapsulated in the following formulation.\nProblem 1 The AW compensator (6), is said to solve the anti-windup problem if the closed loop system in Figure\n2 is stable and well-posed and the following hold:\n1. If dist(ulin,U) = 0, \u2200t \u2265 0, then yd = 0, \u2200t \u2265 0 (assuming zero initial conditions for M(s)).\n2. If dist(ulin,U) \u2208 L2, then yd \u2208 L2.\nThe AW compensator is said to solve strongly the anti-windup problem if, in addition, the following condition is\nsatis\u0002ed:\n3. The operator Tp : ulin 7\u2192 yd is well-de\u0002ned and \u0002nite gain L2 stable.\nEssentially, a compensator solving this problem would ensure no corrective AW action is taken unless saturation\noccurs, assuming zero initial conditions for the compensator, and that an asymptotic recovery of linear behaviour\nis guaranteed. The strong version of the problem also guarantees that peformance (measured by the \u201cgain\u201d of\nthe operator Tp) is also addressed. The first part of the paper solves this problem.\n6+\nM\u2212I\n\u2212\n+\ny\nd\nG M\ny\nlin\ny\n\u2212\nM\n+\n\u2212\n++\n~\nud\nu\ny\u2206r\nG\nu linK\n\u2206 G\nDisturbance\nFilter\nNonlinear Loop\nFigure 4: Anti-windup scheme with uncertainty\n2.2 Robust AW Formulation\nControl engineers rarely have the luxury of dealing with perfect plant models and typically the model, G(s), is\nnot a true representation of the real system. A better way of describing the true linear plant is\nG\u02dc = G + \u2206G (7)\nwhere our plant model G(s) is now accompanied by additive uncertainty \u2206G \u2208 RH\u221e. It is well known from the\nrobust control literature [17] that disregard for uncertainty may have serious consequences for the true closed-\nloop system, and control loops which behave acceptably for the nominal plant may suffer dramatic stability and\nperformance losses when applied to the true, uncertain plant. Recent results in the AW literature [20, 4, 23] seem\nto suggest that obtaining robust performance in the face of saturation may be more demanding.\nAlthough there are several ways of representing uncertainty, the additive type given in equation (7) is appealing\nbecause it captures both output-multiplicative and input-multiplicative uncertanties: \u2206G = \u2206oG or \u2206G = G\u2206i\nwhere \u2206o and \u2206i are output and input multiplicative uncertainties respectively. The converse is only true if G\u22121\nexists. As we are seeking global results it is necessary that \u2206G \u2208 RH\u221e\nA key feature of the standard AW formulation, is that it allows the decoupling of nominal linear behaviour from\nsaturated behaviour. The presence of uncertainty destroys this property and, instead, uncertainty-dependent\ncoupling is introduced, as illustrated in Figure 4. The block \u2206GM couples the \u201clinear loop\u201d with the output\nof the nonlinear loop. Although it is obvious that sufficiently small \u2206G(s) will not be problematic, for larger\nuncertainties potential stability issues may arise. Also note that if the map from ulin to u\u02dc is sufficiently small,\nsimilar robustness properties to the linear system can be expected.\nFollowing [23], robustness is tackled via a small gain approach. The following formal assumption is made:\nAssumption 1 The closed-loop linear system is robustly stable: \u2016K(I \u2212GK)\u22121\u2016\u221e = \u03b2 and \u2206G \u2208 \u2206 where\n\u2206 =\n{\n\u2206 \u2208 RH\u221e : \u2016\u2206\u2016\u221e < 1\n\u03b2\n}\n(8)\nThis assumption guarantees that, in the absence of saturation, the linear system satisfies the small gain condition\nfor stability.\n7M\nM\u2212I\nu\nu\nz\nu\nu\nlin\nd\n\u2206~\n\u2212\n+\n+\n\u2212\n\u2206\nFigure 5: Robust stability minimisation problem\nFrom Figure 4, note that\nylin = Gulin + \u2206G[ulin \u2212MF(ulin)] = Gulin + \u2206\u02dcG(ulin) (9)\nwhere F(ulin) denotes the nonlinear operator from ulin to u\u02dc and \u2206\u02dcG is the \u201cmodified\u201d uncertainty representing\nthe effect of saturation on the uncertainty. From the small gain theorem we know that robust stability is obtained\nif\n\u2016\u2206\u02dcG\u2016i,2 = \u2016\u2206G[I \u2212MF(.)]\u2016i,2 < 1\n\u03b2\n(10)\nFurthermore the level of robust stability will be equal to or better than that of the linear system if\n\u2016Tr\u2016i,2 = \u2016I \u2212MF(.)\u2016i,2 \u2264 1 (11)\nIt was shown in [23] (see also [24]) that as the nonlinear operator F(ulin) = 0 for sufficiently small ulin, the\nL2 gain of Tr can never be less than unity. Thus nominal robustness is obtained when \u2016Tr\u2016i,2 = 1 and hence\n\u2016\u2206\u02dc\u2016i,2 = \u2016\u2206\u2016\u221e. Denoting the output of the M block as z\u2206 it then follows that for robust stability of our\nanti-windup system we should attempt to minimise the L2 norm of Tr : ulin 7\u2192 z\u2206 (as shown in Figure 5). This\nmotivates the following problem formulation.\nProblem 2 The anti-windup compensator (6) is said to solve the robust anti-windup compensator problem with\nrobustness margin 1\/\u00b5 if the closed-loop in Figure 4 is well-posed and the following hold:\n1. If sat(u) \u2261 u, then the system is robustly stable for all \u2206 \u2208 \u2206.\n2. If \u2206G = 0, then M(s) solves strongly the standard anti-windup problem (De\u0002nition 2) for some perfor-\nmance level \u03b3.\n3. The operator Tr : ulin 7\u2192 z\u2206 has \u0002nite L2 gain, i.e. \u2016Tr\u2016i,2 < \u00b5.\nThis problem will be addressed in the second part of the paper.\nRemark 1: Obviously if \u00b5 = 1, we have retained the robustness of the linear system. However, this is not\nalways possible if the performance level, \u03b3, is to be minimised as well, and thus it might be appropriate to relax\nour robustness requirements in order to obtain performance improvement. \u0003\n83 Standard AW Problem Solution (\u2206G = 0)\nThe problem of stability and performance is addressed by minimizing the L2 gain of Tp : ulin 7\u2192 yd, or\nalternatively finding the minimum \u03b3 > 0 such that \u2016Tp\u2016i,2 \u2264 \u03b3. The following procedure not only allows\nthe synthesis of an optimal compensator, but also ensures asymptotic stability and gives a measure of global\nperformance if the plant G is assumed asymptotically stable. The main result of the section is the following\ntheorem.\nTheorem 1 There exists a full order anti-windup compensator \u0398 = [\u0398\u20321 \u0398\u20322]\u2032 \u2208 R(m+q)\u00d7m, as described by\nequation (6), which solves Problem 1 if there exist matrices P = P \u2032 > 0, W = diag(\u03c91, . . . , \u03c9m) > 0 and a\npostive real scalar \u03b3 such that the following Riccati equation is satis\u0002ed\nA\u02dc\u2032P + PA\u02dc + PBR\u22121B\u2032P + Q\u02dc = 0 (12)\nwhere\nA\u02dc = A + BR\u22121D\u2032C (13)\nQ\u02dc = C \u2032(I + DR\u22121D\u2032)C (14)\nR = (\u03b32I \u2212D\u2032D) > 0 (15)\nand\nZ = (2W \u2212D\u2032D \u2212 \u03b3\u22122W 2) > 0 (16)\nFurthermore, if equation (12) and inequality (16) are satis\u0002ed, a suitable \u0398 achieving \u2016Tp\u2016i,2 < \u03b3 is obtained\nby calculating the matrix gain F in (6) as follows:\nF = \u2212\u03b32(W\u22121 \u2212 \u03b3\u22122)R\u22121(B\u2032P + D\u2032C) (17)\nTo aid our proof we will need the following property:\nDefinition 2 Completing the square Given vectors x \u2208 Rn, y \u2208 Rm, matrices X \u2208 Rn\u00d7p, Y \u2208 Rp\u00d7m and\nscalar \u03b1\n(\u03b1Xx\u2212 \u03b1\u22121Y y)\u2032(\u03b1Xx\u2212 \u03b1\u22121Y y) = \u03b12x\u2032X \u2032Xx + \u03b1\u22122y\u2032Y \u2032Y y \u2212 x\u2032X \u2032Y y \u2212 y\u2032Y \u2032Xx\nProof: In order to solve strongly the AW compensation problem, it is necessary to meet the conditions stated in\nProblem 1. It is easy to observe that the first two conditions are trivially met if internal stability of the closed-loop\ncompensated system is guaranteed, assuming zero initial conditions for the AW compensator. As will be shown\nlater, by choosing F as described in Theorem 1, it is possible to guarantee that \u2016Tp\u2016i,2 < \u03b3 for any \u03b3 > \u2016G\u2016\u221e,\ntherefore solving strongly the AW compensation problem.\nFor algebraic simplicity, we consider the case where D = 0 (the proof when D 6= 0 involves much more algebra\nand hence for space reasons is omitted). Note that as Dz(.) \u2208 Sector[0, I], it follows that for some matrix\nW = diag(\u03c91, . . . , \u03c9m) > 0\nu\u02dc\u2032W (u\u2212 u\u02dc) \u2265 0 (18)\n9Next assume \u2203 v(x) = x\u2032Px > 0, then if\nL(x, ulin, u\u02dc, F, W ) :=\nd\ndt\nx\u2032Px + \u2016yd\u20162 \u2212 \u03b32\u2016ulin\u20162 + 2u\u02dc\u2032W (u\u2212 u\u02dc) (19)\nis negative definite, it follows that v\u02d9(x) < 0 is a Lyapunov inequality and the closed loop system is stable. Also\nnotice that if L(x, ulin, u\u02dc, F, W ) < 0, then assuming zero initial conditions, integrating L(.) in the time interval\nfrom 0 to T and taking the limit T \u2192 \u221e, yields \u2016yd\u20162 < \u03b3\u2016ulin\u20162 and hence \u2016Tp\u2016i,2 < \u03b3. Thus, if equation\n(19) is negative definite, the strong anti-windup problem is solved in the L2 sense.\nExpanding (19) and substituting u = ulin \u2212 ud gives\nL = x\u2032C \u2032Cx\u2212 \u03b32u\u2032linulin + x\u02d9\u2032Px + x\u2032Px\u02d9\u2212 2u\u02dc\u2032Wud \u2212 2u\u02dc\u2032Wu\u02dc + 2u\u02dc\u2032Wulin (20)\nThis inequality contains several cross-terms in x, u\u02dc, ulin. We now eliminate the cross-product terms in three\nsteps using Definition 2.\n(I) The cross-product terms involving ulin and u\u02dc can be grouped as follows:\n\u2212 [\u03b32u\u2032linulin \u2212 2u\u02dc\u2032Wulin] = \u2212\u2016\u03b3ulin \u2212 \u03b3\u22121Wu\u02dc\u20162 + \u03b3\u22122u\u02dc\u2032W 2u\u02dc\nCombining the above with (20), a cost function containing no cross-product terms between ulin and u\u02dc is obtained.\nUsing equation (1) to expand x\u02d9 and noticing from equation (6) that ud = Fx:\nL = x\u2032(C \u2032C + A\u2032P + PA + 2PBF )x + 2u\u02dc\u2032(B\u2032P \u2212WF )x\u2212 u\u02dc\u2032(2W \u2212 \u03b3\u22122W 2)u\u02dc\u2212 \u2016\u03b3ulin \u2212 \u03b3\u22121Wu\u02dc\u20162\n(II) The cross-product terms involving u\u02dc and x can be grouped, including the extra term \u03b3\u22122u\u02dc\u2032W 2u\u02dc from (I), as\nfollows:\n\u2212 [u\u02dc\u2032(2W \u2212 \u03b3\u22122W 2)u\u02dc\u2212 2u\u02dc\u2032(B\u2032P \u2212WF )x] =\n\u2212\u2016Z 12 u\u02dc\u2212 Z\u2212 12 (B\u2032P \u2212WF )x)\u20162 + x\u2032(B\u2032P \u2212WF )\u2032Z\u22121(B\u2032P \u2212WF )x\nNote that Z = (2W \u2212 \u03b3\u22122W 2) must be positive definite in order to have a well-posed problem, and hence the\ncondition in equation (16) is imposed. This condition arises from the necessity of making the term\n\u2016Z 12 u\u02dc\u2212 Z\u2212 12 (B\u2032P \u2212WF )x\u20162 (21)\npositive definite for any pair (u\u02dc, x). It can easily be shown that if Z \u2264 0, this is not always guaranteed. By\nreplacing this new group of terms, the cost function can be written with no cross-product terms between u\u02dc and\nx:\nL = x\u2032(C \u2032C + A\u2032P + PA + 2F \u2032B\u2032P + PBZ\u22121B\u2032P \u2212 2PBZ\u22121WF + F \u2032WZ\u22121WF )x\n\u2212\u2016Z 12 u\u02dc\u2212 Z\u2212 12 (B\u2032P \u2212WF )x\u20162 \u2212 \u2016\u03b3ulin \u2212 \u03b3\u22121Wu\u02dc\u20162 \u2264 0\n(III) The terms involving F and F \u2032F can be grouped as follows:\nF \u2032WZ\u22121WF \u2212 2F \u2032((WZ\u22121B\u2032P \u2212B\u2032P ) =\n\u2016Z\u2212 12 WF \u2212 Z 12 W\u22121(WZ\u22121 \u2212 I)B\u2032P\u20162 \u2212 PB(WZ\u22121 \u2212 I)\u2032W\u22121ZW\u22121(WZ\u22121 \u2212 I)B\u2032P\n10\nThis last step will yield an expression for the matrix gain F . Finally, by using the results given in (III) we obtain\nan expression for our cost function (19) as\nL(x, ulin, u\u02dc, F, W ) = La + Lb + Lc (22)\nwhere\nLa = x\n\u2032(C \u2032C + A\u2032P + PA + PBZ\u22121B\u2032P \u2212 PB(WZ\u22121 \u2212 I)\u2032W\u22121ZW\u22121(WZ\u22121 \u2212 I)B\u2032P )x (23)\nLb = \u2016(Z\u2212\n1\n2 WF \u2212 Z 12 W\u22121(WZ\u22121 \u2212 I)B\u2032P )x\u20162 (24)\nLc = \u2212\u2016Z 12 u\u02dc\u2212 Z\u2212 12 (B\u2032P \u2212WF )x\u20162 \u2212 \u2016(\u03b3ulin \u2212 \u03b3\u22121Wu\u02dc\u20162 (25)\nEquation (22) is comprised of three terms. The last term, Lc, is a negative definite quadratic term, and therefore\nif the first two terms can be set to zero, then L(.) < 0. Setting the second term, Lb, to zero yields a condition for\nthe gain matrix F .\n(Z\u2212\n1\n2 WF \u2212 Z 12 W\u22121(WZ\u22121 \u2212 I)B\u2032P ) = 0 \u21d4 F = (\u03b3\u22122 \u2212W\u22121)B\u2032P (26)\nwhere P = P \u2032 > 0 comes from solving the Ricatti equation which makes the first term La = 0:\nC \u2032C + A\u2032P + PA + PBZ\u22121B\u2032P \u2212 PB(WZ\u22121 \u2212 I)\u2032W\u22121ZW\u22121(WZ\u22121 \u2212 I)B\u2032P = 0 (27)\nwhich, after some algebraic manipulation, reduces to:\nC \u2032C + A\u2032P + PA + \u03b3\u22122PBB\u2032P = 0 (28)\nThese are exactly the conditions given in Theorem 1 with D = 0. Internal stability guarantees that condition (1)\nof the anti-windup problem (Problem 1) is satisfied; the finite L2 gain of Tp ensures condition (3) is satisfied, and\nhence condition (2) is also satisfied. Well-posedness of the loop is guaranteed by the lack of direct feedthrough\nterms i.e. M \u2212 I is strictly proper. \u0003\u0003\nRemark 2: Notice that the Riccati equation given is of bounded-real type and only has a solution if G(s) is stable\nand \u03b3 > 0 is such that \u2016G\u2016\u221e = \u03b3opt \u2264 \u03b3. That is, the performance level of the AW compensator is restricted\nby the H\u221e norm of the open-loop plant. This suggests that optimal anti-windup performance is obtained when\n\u03b3 = \u03b3opt, leaving the designer the task of choosing W > 0. This freedom in choosing W is absent in [23] and\n[11] and hence we have recovered freedom in choosing the so-called stability multiplier. \u0003\nRemark 3: The poles of AW compensator (6) are the poles of M(s), which are the eigenvalues of the matrix\nA + BF where F is given by equation (17). Note that equation (17) contains the \u201cfree\u201d parameter, W > 0\nwhich exerts influence over the location of the AW compensator poles. Thus it can be observed that, providing\n(A, B) is controllable (it is always stabilisable by virtue of A being Hurwitz), decreasing the size of W will tend\nto increase the magnitude of the AW compensator\u2019s poles. This extra freedom in shaping the AW compensator\u2019s\npoles is useful for discrete-time implementation when careful attention should be paid to their size relative to\nthe sampling rate. In the LMI formulation of [23], W did not appear as a free parameter and hence there was\nnot such direct control over pole magnitude. Note also that the freedom in choosing W allows one to \u201ctransfer\u201d\nanti-windup action between the compensation signals ud and yd. \u0003\nRemark 4: Apart from being diagonal and positive definite, the only restriction on W is given by equation (16).\nWhen D = 0 this simply reduces to (2I \u2212 \u03b32W ) > 0 which always holds for small enough W > 0. When\nD 6= 0, the condition on R ensures that D\u2032D < \u03b32I which in turn means that inequality (16) becomes\nZ = 2W \u2212 \u03b32I \u2212 \u03b3\u22122W 2 > 0 (29)\n11\nUsing the Schur complement this holds if \uf8ee\n\uf8ef\uf8f0 2W W IW \u03b32 0\nI 0 \u03b3\u22122\n\uf8f9\n\uf8fa\uf8fb > 0 (30)\nfrom which W can be determined. In the work carried out so far, it has been straightforward to choose W such\nthat the condition on Z is satisfied. \u0003\n4 Robust anti-windup synthesis\n4.1 Robustness analysis\nSimilar to the standard anti-windup problem above, the robust anti-windup problem, eventually reduces to the\nchoice of a coprime factorisation of G(s) and hence the choice of a matrix F (with the restriction that (A+BF )\nis Hurwitz) . From the discussion in Section 2.2 we know that in order to achieve good robustness we need\nto minimise \u2016Tr\u2016i,2, which is the map from ulin to z\u2206. Before the problem is solved formally, it is useful to\nexamine the problem from a less rigorous perspective and to anticipate the solutions we might expect.\nFollowing similar arguments to those in Section 3, to guarantee that \u2016Tr\u2016i,2 < \u00b5, we consider\nL(x, ulin, u\u02dc, F, W ) :=\nd\ndt\nx\u2032Px + \u2016z\u2206\u20162 \u2212 \u00b52\u2016ulin\u20162 + 2u\u02dc\u2032W (u\u2212 u\u02dc) (31)\nIf L(.) < 0 it follows that the anti-windup system is internally stable and that \u2016Tr\u2016i,2 < \u00b5 indeed holds.\nFor the sake of illustration, let W = I . Although this restricts the design freedom, it enables the simple illustra-\ntion of a class of robust AW compensators (the case when W 6= I will be discussed next). Expanding (31) and\nsubstituting u = ulin \u2212 Fx and z\u2206 = (ulin \u2212 Fx\u2212 u\u02dc) gives\nL = x\u2032(A\u2032P + PA + 2PBF + F \u2032F )x + 2xPBu\u02dc\u2212 u\u02dc\u2032u\u02dc\u2212 (\u00b52 \u2212 1)u\u2032linulin \u2212 2xF \u2032u\u2032lin (32)\nEliminating the cross-product terms in three steps, it is possible to obtain conditions which ensure global stability\nand some level of robustness robustness as\nA\u02dc\u2032P + PA\u02dc + \u00b5\u22122PBB\u2032P = 0 (33)\nand\nZ = (1\u2212 \u00b5\u22122)I > 0 \u21d4 \u00b5 > 1 (34)\nFurthermore, if equations (33) and (34) are satisfied, a suitable AW compensator achieving \u2016Tr\u2016i,2 < \u00b5 is\nobtained by calculating the matrix gain F as follows:\nF = \u2212(1\u2212 \u00b5\u22122)B\u2032P (35)\nNotice that the immediately obvious solution for the Riccati equation in (33) is P = 0, which therfore implies\nthat F = 0 and hence that our AW compensator takes the form of an internal-model-control (IMC) compensator.\nThus for optimal robustness, the Riccati approach agrees with [23] in advocating the IMC scheme as an optimally\nrobust solution as \u00b5 is not restricted by equation (33) if P = 0 (note from equation (34) that it is possible to\n12\n0 0.5 1 1.5 2 2.5 3 3.5 4 4.5 5\n\u221215\n\u221210\n\u22125\n0\n5\n10\n15\nW\n\u00b52\nFigure 6: \u00b52 and W such that Z = 0\nachieve \u00b5 = 1 for P = 0). However, there is more freedom in equation (33) because by defining P =: P\u02dc\u22121 > 0\nwe could equivalently obtain, from equation (33), the Lyapunov equation\nP\u02dcA\u2032 + AP\u02dc + \u00b5\u22122BB\u2032 = 0 (36)\nwhich has a positive definite solution, and therefore produces a compensator different from the IMC scheme.\nIn order to solve the robust AW compensation problem, it is necessary to meet the conditions in Problem 2\n(and hence Problem 1). It is easy to observe again that the conditions of the standard AW problem are met\nif internal stability of the closed-loop compensated system is guaranteed, assuming zero initial conditions for\nthe AW compensator. By choosing F as described in (35), it is possible to guarantee that \u2016Tr\u2016i,2 < \u00b5 for some\n\u00b5 > 0, therefore solving the robust AW compensation problem. It can be argued that the the strong AW problem,\ni.e. \u2016Tp\u20162 \u2264 \u03b3, is better solved when the IMC-like scheme is avoided (see Theorem 2 and proof).\nRemark 5: It is not necessary to choose W = I . More generally, the expression for (31) is given as\nL = x\u2032(A\u2032P + PA + 2PBF + F \u2032F )x + 2xPBu\u02dc\u2212 u\u02dc\u2032(2W \u2212 I)u\u02dc\u2212 (\u00b52 \u2212 1)u\u2032linulin \u2212 2xF \u2032u\u2032lin\n+ 2ulin(W \u2212 I)u\u02dc\u2032 \u2212 2xF \u2032(W \u2212 I)u\u02dc\u2032 < 0 (37)\nCompleting the square for terms involving ulin, a more general condition on Z is derived as\nZ = 2W \u2212 \u00b5\u22122W 2 \u2212 I > 0 (38)\nAs W is diagonal, this implies that \u00b52 > wi2wi\u22121 \u2200i \u2208 {1 . . .m}. This implies that wi > 0.5 (since \u00b5 > 0) and\nthat the minwi \u00b5 = 1 and occurs at wi = 1 (or W = I). Thus W = I is in fact, the optimally robust solution.\nThis can be seen in Figure 6. \u0003.\n4.2 Robust stability and performance analysis\nThe main purpose of AW compensation is to improve performance during periods of saturation. Section 2.2\nmentioned that the solution to the robust AW problem with the greatest robustness margin (the smallest \u00b5) is\n13\nlikely to be IMC-like. In fact, just considering robustness leads to conditions (33) and (35) which do not give\nany explicit performance guarantees. The real value of conditions (33) and (35) is when used in conjuction with\nperformance optimization.\nThe AW solutions given in [25] performed well but tended to produce large compensation signals and poles,\nwhich are often linked with poor robustness. Although robustness was present, it was not addressed formally.\nLater, [23] addressed robust stability and mixed robustness\/perfromance optimization problems using LMI for-\nmulations. Nevertheless, this formulation lacks some intuition and practicability.\nThis section will attempt to show that the work in [18], which produces a family of anti-windup compensators,\nnaturally yields a robust solution where the \u201cstability multiplier\u201d (i.e. W ) is a measure of robustness. It will also\ngive a method for the synthesis of robust AW compensators with performance guarantees.\nThe problem of robust stability and performance involves minimizing a mixed L2 gain. By combining the\nobjective of robust stability with that of performance, it is possible to pose a sensible L2 gain optimization\nproblem which addresses robustness and performance simultaneously.\nTheorem 2 Let Assumption 1 be satis\u0002ed, then there exists a full order robust anti-windup compensator \u0398 =\n[\u0398\u20321 \u0398\n\u2032\n2]\n\u2032 \u2208 R(m+q)\u00d7m, as described by equation (6) which solves Problem 2 with robustness margin 1\/\u00b5 if\nthere exist a matrix P = P \u2032 > 0 and postive real scalars \u03c9p and \u03b3 such that the following Riccati equation is\nsatis\u0002ed\nA\u02dc\u2032P + PA\u02dc + PBR\u22121B\u2032P + Q\u02dc = 0 (39)\nwhere\nA\u02dc = A + BR\u22121D\u2032C (40)\nQ\u02dc = C \u2032(I + DR\u22121D\u2032)C (41)\nR = (\u03b32I \u2212D\u2032D) > 0 (42)\nand\nZ = (\u03c9p \u2212 \u03b3\u22122)(\u03c9\u22121p I \u2212D\u2032D) > 0 (43)\nFurthermore, if equation (39) is satis\u0002ed, a suitable \u0398 is obtained by calculating the matrix gain F as:\nF = \u2212\u03b32R\u22121(\u03c9p \u2212 \u03b3\u22122)(B\u2032P + D\u2032C) (44)\nand the robustness margin is given as 1\/\u00b5 = 1\/\u03b3\u221a\u03c9p.\nBefore we give a formal proof of this theorem, it is instructive to consider the relationship between the standard\nAW solution and robustness. For simplicity assume G(s) is strictly proper (D = 0), then it follows that for\nsimultaneous performance and robustness optimisation we would like to ensure\u2225\u2225\u2225\u2225\u2225 W\n1\n2\np yd\nz\u2206\n\u2225\u2225\u2225\u2225\u2225\n2\n\u2264 \u00b5\u2016ulin\u20162 (45)\nwhere Wp > 0 is a matrix which weights the performance variable, yd, to allow a trade-off between performance\nand robustness. From the results given in section 4.1, a sufficient condition for this to hold can be easily derived\nand is given by\nA\u2032P + PA + \u00b5\u22122PBB\u2032P + C \u2032WpC = 0 (46)\nF = \u2212(W\u02c6\u22121 \u2212 \u00b5\u22122)B\u2032P (47)\n14\nwhere W\u02c6 is the extra parameter introduced by the Circle Criterion formulation and the sector bound definition.\nNext assume that Wp = I\u03c9p > 0, then defining Pw := P\u03c9\u22121p > 0 allows us to write equation (46) as\n\u03c9p(A\n\u2032Pw + PwA + \u00b5\u22122\u03c9pPwBB\u2032Pw + C \u2032C) = 0 (48)\nNext, defining \u03b3 := \u00b5\/\u221a\u03c9p yields (as \u03c9p > 0)\nA\u2032Pw + PwA + \u03b3\u22122PwBB\u2032Pw + C \u2032C = 0 (49)\nSimilarly we obtain F as\nF = \u2212(W\u02c6\u22121 \u2212 \u00b5\u22122)B\u2032Pw\u03c9p = \u2212(W\u02c6\u22121\u03c9p \u2212 \u03b3\u22122)B\u2032Pw (50)\nNotice that equations (49) and (50) are of exactly the same form as (12) and (17) with Pw playing the role of P\nand W\u02c6\u22121\u03c9p = W\u22121.\n\u00b5 = \u03b3\n\u221a\n\u03c9p \u2264 \u03b3\u2016\n\u221a\nWW\u02c6\u22121\u2016 (51)\nThus for small \u03c9p, or equivalently large W we have greater robustness (as small \u00b5 corresponds to greater robust-\nness margin, 1\n\u00b5\n). Thus in the standard AW problem, the choice of W is directly linked to the robustness of the\nsystem and must be chosen large to increase robustness.\nProof of Theorem 2: To satisfy the robustness and performance AW problem we need to ensure that both the\nstandard AW problem, i.e. \u2016Tp\u2016i,2 < \u03b3 for some \u03b3 > 0, and the robust AW problem, i.e. \u2016Tr\u2016i,2 < \u00b5 for some\n\u00b5 > 0, are satisfied while also requiring internal stability and well-posedness. In order to achieve this we would\nlike to ensure that \u2225\u2225\u2225\u2225\u2225\n\u221a\n\u03c9pyd\nz\u2206\n\u2225\u2225\u2225\u2225\u2225\ni,2\n\u2264 \u00b5\u2016ulin\u20162 (52)\nIf this inequality is satisfied it ensures that both \u2016Tr\u2016i,2 < \u00b5 and \u2016Tp\u2016i,2 < \u03b3 = \u00b5\u221a\u03c9p . To guarantee inequality\n(52) holds and to ensure internal stability, as before, it suffices that\nL(x, ulin, u\u02dc, F, W ) :=\nd\ndt\nx\u2032Px + \u03c9py\u2032dyd + z\n\u2032z \u2212 \u00b52u\u2032linulin + 2u\u02dc\u2032W (u\u2212 u\u02dc) < 0 (53)\nThe remainder of the proof is given for the general case when D 6= 0. Although it is possible to give a simpler\nproof when D = 0, the simplicity obscures the cross terms which require more care in removing.\nFirst note that we can \u201cabsorb\u201d \u03c9p into the plant\u2019s C and D matrices:\n\u2016\u221a\u03c9pyd\u20162 = \u2016\u221a\u03c9p[(C + DF )x + Du\u02dc]\u20162 = \u2016(Cw + DwF )x + Dwu\u02dc\u20162\nwhere Cw =\n\u221a\n\u03c9pC and Dw =\n\u221a\n\u03c9pD.\nExpanding (53) and substituting u = ulin \u2212 ud and yd = (Cw + DwF )x + Dwu\u02dc gives:\nL = x\u02d9\u2032Px + x\u2032Px\u02d9 + x\u2032(Cw + DwF )\u2032(Cw + DwF )x + x\u2032F \u2032Fx\u2212 (\u00b52 \u2212 1)u\u2032linulin \u2212 u\u02dc\u2032(2W \u2212 I \u2212D\u2032wDw)u\u02dc\n\u22122x\u2032F \u2032ulin + 2u\u02dc(W \u2212 I)ulin \u2212 2x\u2032F \u2032(W \u2212 I)u\u02dc + 2x\u2032(Cw + DwF )\u2032Dwu\u02dc (54)\nAs before, the cross-product terms are eliminated in three steps.\n(I) The cross-product terms involving ulin, u\u02dc and x are grouped as follows:\n15\n\u2212 [(\u00b52 \u2212 1)u\u2032linulin + 2x\u2032F \u2032ulin \u2212 2u\u02dc(W \u2212 I)ulin] =\n\u2212\u2016(\u00b52 \u2212 1) 12 ulin \u2212 (\u00b52 \u2212 1)\u2212 12 ((W \u2212 I)u\u02dc\u2212 Fx)\u20162 + (u\u02dc\u2032(W \u2212 I)\u2212 x\u2032F )(\u00b52 \u2212 1)\u22121((W \u2212 I)u\u02dc\u2212 Fx)\nCombining the above and equation (54), a cost function containing no cross-product terms between ulin, u\u02dc and\nx is obtained:\nL = x\u2032(A\u2032P + PA + 2PBF + (Cw + DwF )\u2032(Cw + DwF ) + \u00b5\u02dcF \u2032F )x\u2212 u\u02dc\u2032\u00b5\u02dcZu\u02dc + 2x\u2032(Cw + DwF )\u2032Dwu\u02dc\n+ 2x\u2032PBu\u02dc\u2212 2x\u2032F \u2032\u00b5\u02dc(W \u2212 I)u\u02dc\u2212 \u2016(\u00b52 \u2212 1) 12 ulin + (\u00b52 \u2212 1)\u2212\n1\n2 ((W \u2212 I)u\u02dc\u2212 Fx)\u20162 (55)\nwhere Z = 2W \u2212W 2\u00b5\u22122 \u2212 I \u2212 \u00b5\u02dc\u22121D\u2032wDw\u2217 and \u00b5\u02dc = 1\u2212 (\u00b52 \u2212 1)\u22121 = \u00b5\n2\n\u00b52\u22121\n(II) The cross-product terms involving u\u02dc and x are grouped as follows:\n\u2212 [u\u02dc\u2032\u00b5\u02dcZu\u02dc\u2212 2x\u2032(PB + (Cw + DwF )\u2032Dw \u2212 F \u2032\u00b5\u02dc(W \u2212 I))u\u02dc] =\n\u2212\u2016\u00b5\u02dc 12 Z 12 u\u02dc\u2212 \u00b5\u02dc\u2212 12 Z\u2212 12 (B\u2032P + D\u2032w(Cw + DwF )\u2212 \u00b5\u02dc(W \u2212 I)F )x\u20162\n+x\u2032(PB + (Cw + DwF )\u2032Dw \u2212 F \u2032\u00b5\u02dc(W \u2212 I))\u00b5\u02dc\u22121Z\u22121(B\u2032P + D\u2032w(Cw + DwF )\u2212 \u00b5\u02dc(W \u2212 I)F )x\nBy replacing this group of terms, the cost function can be written with no cross-product terms between u\u02dc and x,\nviz:\nL = x\u2032(A\u2032P + PA + C \u2032w(I + Dw\u00b5\u02dc\n\u22121Z\u22121D\u2032w)Cw + 2C\n\u2032\nwDw\u00b5\u02dc\n\u22121Z\u22121B\u2032P + PB\u00b5\u02dc\u22121Z\u22121B\u2032P\n+ F \u2032(\u00b5\u02dc + \u00b5\u02dc(W \u2212 I)Z\u22121(W \u2212 I) + D\u2032w(I + Dw\u00b5\u02dc\u22121Z\u22121D\u2032w)Dw \u2212 2D\u2032wDwZ\u22121(W \u2212 I))F\n+ 2PB(I + \u00b5\u02dc\u22121Z\u22121D\u2032wDw \u2212 Z\u22121(W \u2212 I))F + 2C \u2032wDw(I + Dw\u00b5\u02dc\u22121Z\u22121D\u2032w \u2212 Z\u22121(W \u2212 I))F )x\n\u2212 \u2016(\u00b52 \u2212 1) 12 ulin + (\u00b52 \u2212 1)\u2212\n1\n2 ((W \u2212 I)u\u02dc\u2212 Fx)\u20162\n\u2212 \u2016Z 12 u\u02dc\u2212 Z\u2212 12 (B\u2032P + D\u2032w(Cw + DwF )\u2212 \u00b5\u02dc(W \u2212 I)F )x\u20162 (56)\n(III) The terms involving F and F \u2032F are grouped.. Before grouping terms, it is possible to reduce them by using\nthe definitions for \u00b5\u02dc and Z. Although some algebra is involved, it is easy to note that:\nI + \u00b5\u02dc\u22121Z\u22121D\u2032wDw \u2212 Z\u22121(W \u2212 I) = Z\u22121(W \u2212W 2\u00b5\u22122)\n\u00b5\u02dc + D\u2032wDw + \u00b5\u02dc(W \u2212 I)Z\u22121(W \u2212 I)\u2212 2D\u2032wDwZ\u22121(W \u2212 I) + D\u2032wDw\u00b5\u02dc\u22121Z\u22121D\u2032wDw = \u00b5\u02dcH\nwhere\nH = W 2\u00b5\u22122 + (W \u2212W 2\u00b5\u22122)Z\u22121(W \u2212W 2\u00b5\u22122)\nThe problem of grouping terms invloving F is now reduced to:\nF \u2032\u00b5\u02dcHF + 2F \u2032(W \u2212W 2\u00b5\u22122)Z\u22121(B\u2032P + D\u2032wCw) =\n\u2016\u00b5\u02dc 12 H 12 F + \u00b5\u02dc\u221212 H \u221212 (W \u2212W 2\u00b5\u22122)(B\u2032P + D\u2032wCw)\u20162\n\u2212(PB + C \u2032wDw)Z\u22121(W \u2212W 2\u00b5\u22122)\u00b5\u02dc\u22121H\u22121(W \u2212W 2\u00b5\u22122)Z\u22121(B\u2032P + D\u2032wCw)\nUsing the matrix inversion lemma:\nH\u22121 = W\u22122\u00b52 \u2212W\u22122\u00b52(W \u2212W 2\u00b5\u22122)\u00b5\u02dcR\u22121(W \u2212W 2\u00b5\u22122)W\u22122\u00b52\n\u2217This reduces to the Z given in Theorem 2 when W = I - see later in the proof.\n16\nwhere R = \u00b52I \u2212D\u2032wDw. Now define the matrix Q as follows:\nQ = Z\u22121(W \u2212W 2\u00b5\u22122)\u00b5\u02dc\u22121H\u22121(W \u2212W 2\u00b5\u22122)Z\u22121 = R\u22121(W \u2212W 2\u00b5\u22122)W\u22122\u00b52(W \u2212W 2\u00b5\u22122)Z\u22121\nsuch that the following equality holds:\n\u00b5\u02dc\u22121Z\u22121 \u2212Q = R\u22121\nFinally, by using the results given in III an expression for the cost function (53) is given by\nL(x, ulin, u\u02dc, F, W ) = La + Lb + Lc (57)\nwhere\nLa = x\n\u2032[A\u2032P + PA + PB(\u00b5\u02dc\u22121Z\u22121 \u2212Q)B\u2032P + C \u2032w(I + Dw(\u00b5\u02dc\u22121Z\u22121 \u2212Q)D\u2032w)Cw\n+ 2C \u2032wDw(\u00b5\u02dc\n\u22121Z\u22121 \u2212Q)B\u2032P ]x (58)\nLb = x\n\u2032(\u2016\u00b5\u02dc 12 H 12 F + \u00b5\u02dc\u221212 H \u221212 (W \u2212W 2\u00b5\u22122)Z\u22121(B\u2032P + D\u2032wCw)\u20162)x (59)\nLc = \u2212\u2016(\u00b52 \u2212 1) 12 ulin + (\u00b52 \u2212 1)\n\u22121\n2 ((w \u2212 I)u\u02dc\u2212 Fx)\u20162\n\u2212\u2016Z 12 u\u02dc\u2212 Z \u221212 (B\u2032P + D\u2032w(Cw + DwF )\u2212 \u00b5\u02dc(W \u2212 I)F )x\u20162 (60)\nAs before the negative quadratic terms can be ignored and the second term, Lb, set to zero in order to obtain a\nstabilizing matrix gain F .\n\u00b5\u02dc\n1\n2 H\n1\n2 F + \u00b5\u02dc\n\u22121\n2 H\n\u22121\n2 (W \u2212W 2\u00b5\u22122)Z\u22121(B\u2032P + D\u2032wCw) (61)\nF = \u2212\u00b5\u02dc\u22121H\u22121(W \u2212W 2\u00b5\u22122)(B\u2032P + D\u2032wCw)\nwhich after some simplifications yields:\nF = \u2212\u00b52(W\u22121 \u2212 \u00b5\u22122)R\u22121(B\u2032P + D\u2032wCw) (62)\nwhere P = P \u2032 > 0 comes from solving the Ricatti equation which makes the first term La = 0, viz:\nA\u2032P + PA + C \u2032wDwR\n\u22121B\u2032P + PBR\u22121D\u2032wCw + PBR\n\u22121B\u2032P + C \u2032w(I + DwR\n\u22121D\u2032w)Cw (63)\nSubsituting for Cw and Dw transforms equation (62) into\nF = \u2212\u00b52\u03c9\u22121p (W\u22121\u03c9p \u2212 \u00b5\u22122\u03c9p)(\u00b52\u03c9\u22121p I \u2212D\u2032D)\u22121(B\u2032P\u22121w + D\u2032C) (64)\n= \u03b32(W\u22121\u03c9p \u2212 \u03b3\u22122I)(\u03b32I \u2212D\u2032D)(B\u2032Pw + D\u2032C) (65)\nwhere \u03b3 = \u00b5\n\u221a\n\u03c9\u22121p . Redefining R = (\u03b32I\u2212D\u2032D) and setting W = I (as it is a free parameter) the expressions\nfor F and Z given in Theorem 2 can be obtained. We can apply a similar strategy to equation (63) to obtain\nA\u2032Pw + PwA + C \u2032DR\u22121B\u2032Pw + PwBR\u22121D\u2032C + PwBR\u22121B\u2032Pw + C \u2032(I + DR\u22121D\u2032)C (66)\nwhere Pw = P\u03c9\u22121p plays the role of P .\nThe proof is completed by noting that internal stability, which is guaranteed by choosing F as stipulated and the\nsolution to the Riccati equation in (63), ensures conditions (1) and (3) (and hence condition (2)) of the standard\nanti-windup problem. This guarantees condition (1) of the robust anti-windup problem, while condition (3) is\n17\nsatisfied through Assumption 1. Well-posedness of the system is trivially guaranteed by the absence of direct\nfeedthourgh terms in the nonlinear loop. \u0003\u0003.\nRemark 6: As \u00b5 = \u03b3\u221a\u03c9p it follows that by choosing \u03c9p small, we have a better robustness margin and choosing\n\u03c9p large gives a worse robustness margin. Also, a small \u03c9p causes our feedback matrix F to become small and\nhence approach the IMC solution; a large \u03c9p creates large compensator poles. It is interesting to compare the\nconditions in Theorems 1 and 2. Note that W\u22121 in Theorem 1 is essentially equivalent to \u03c9p in Theorem 2.\nTherefore, choosing W in Theorem 1 large implies greater robust stability and choosing it small implies worse\nrobust stability. Thus the choice of the \u201cstability multplier\u201d, W , plays a central role in the robustness of the anti-\nwindup compensator. Alternatively, in the standard AW solution, W can be seen as the \u201crobustness weighting\nmatrix\u201d: choosing W large (and therefore \u03c9p small) increases the robustness of the design. This gives some\ntheoretical justification for the robustness of the schemes tested in [7]. \u0003\nRemark 7: It is not necessary to choose Wp = \u03c9pI in robust anti-windup synthesis. We have made this choice in\nTheorem 2 to enable clear expressions for robustness to be given, although this is not a requirement in general.\nWith Wp chosen as a more general positive definite (normally diagonal) matrix, it is possible to increase the\nflexibility in the design and draw the same general conclusions, although the robustness margin will not be as\nexplicit as that given in Theorem 2. \u0003\nRemark 8: The main difference between the solutions to the standard and robust AW problems are the conditions\nimposed on the solution by the different expressions for Z in inequalities (16) and (43). These inequalities impose\ndifferent conditions on the free parameter, W or \u03c9p. They also give rise to different extreme solutions. This is\nperhaps most easily seen for D = 0. In this case inequalities (16) and (43) become\nZnom := 2W \u2212 \u03b3\u22122W 2 \u21d2 2\u03b32I > W (67)\nZrob := (\u03c9p \u2212 \u03b3\u22122)\u03c9\u22121p \u21d2 \u03b32 > \u03c9\u22121p (68)\nSo when W is as large as possible, that is W \u2248 2\u03b32I , it follows that from equation (17) F is nonzero, and hence,\nnot IMC-like. Conversely, when \u03c9p is as small as possible and \u03c9\u22121p \u2248 \u03b32, it follows from equation (44) that\nF \u2248 0 and hence, the IMC solution is recovered. Thus, as expected from the results of [23], the optimal robust\nAW scheme (i.e. when \u03c9p is as small as possible), results in the IMC scheme. It is also interesting to note that\ninequality (43) ensures that inequality (16) holds; the converse is only true if \u2016D\u2016 is \u201csmall\u201d. \u0003\n5 Example\nIn this section, the effectiveness of the results are shown through an example taken from the literature. This\nexample, a missile auto-pilot introduced by [13], was also used in [25] and [14]. The plant is a simplified model\nof the dynamics of the roll-yaw channels of a bank-to-turn misile:\nAp =\n\uf8ee\n\uf8ef\uf8f0 \u22120.818 \u22120.999 0.34980.29 \u22120.579 0.009\n\u22122734 0.05621 \u22122.10\n\uf8f9\n\uf8fa\uf8fb ,\nBp =\n\uf8ee\n\uf8ef\uf8f0 0.147 0.012\u2212194.4 37.61\n\u22122716 \u22121093\n\uf8f9\n\uf8fa\uf8fb , Bpd =\n\uf8ee\n\uf8ef\uf8f0 0 00 0\n0 0\n\uf8f9\n\uf8fa\uf8fb\nCp =\n[\n1 0 0\n0 1 0\n]\n, Dp = Dpd =\n[\n0 0\n0 0\n]\n18\nA nominal linear LQG\/LTR controller yields excellent nominal closed-loop time and frequency responses and is\ngiven by [\nAc Bc Bcr\nCc Dc Dcr\n]\n=\n\uf8ee\n\uf8ef\uf8f0 Ac1 Bc1 0 00 0 \u2212I I\nCc1 0 0 0\n\uf8f9\n\uf8fa\uf8fb (69)\nwhere\nAc1 =\n\uf8ee\n\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\n\u22120.29 \u2212107.8 6.67 \u22122.58 \u22120.4\n107.68 \u221297.81 63.95 \u22124.52 \u22125.35\n\u22126.72 64.82 \u221254.19 \u221240.79 5.11\n3.21 2.1 29.56 \u2212631.15 429.89\n0.36 \u22123.39 3.09 \u2212460.03 \u22120.74\n\uf8f9\n\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb ,\nBc1 =\n\uf8ee\n\uf8ef\uf8ef\uf8ef\uf8ef\uf8ef\uf8f0\n2.28 0.48\n\u221240.75 2.13\n18.47 \u22120.22\n\u22122.07 \u221244.68\n\u22120.98 \u22121.18\n\uf8f9\n\uf8fa\uf8fa\uf8fa\uf8fa\uf8fa\uf8fb , Cc1 =\n[\n0.86 8.54 \u22121.71 43.91 1.12\n2.17 39.91 \u221218.39 \u22128.51 1.03\n]\nThe actuators have saturation limits of \u00b18 in both channels. Figure 7 shows the nominal linear response of the\nmissile for a pulse reference r = [ 6 \u22126 ] applied for 16 seconds. Notice the excellent response and decou-\npling. However, observe that the control signal strays outside the set U = {(8, 8), (\u22128, 8), (\u22128,\u22128), (8,\u22128)}for\na considerable period of time. This suggests that the system with saturated actuators might have poor perfor-\nmance and could even become unstable. Figure 8 shows the system with saturation (but no AW); clearly the\nsaturation has caused a loss in coupling and gives rise to large overshoots. To limit the degradation caused by\nsaturation, an AW compensator designed using Theorem 1 is introduced. As the anti-windup compensator is\ndesigned using the bounded real Riccati equation associated with the open-loop system, the optimal value of \u03b3\nis \u2016G(s)\u2016\u221e = \u03b3 \u2248 379, leaving the designer the task of choosing W . Choosing W as W = 10I2\u00d72 yielded the\nfollowing value of F :\nF =\n[\n4.8324 31.0935 0.9470\n\u22120.1224 \u22120.6860 \u22120.0004\n]\n(70)\nFigure 9 shows the missile response with the full order AW compensation proposed in Theorem 1. Notice the\nimprovement over the uncompensated response: the saturated system follows the linear response closely and\nthe return to nominal linear dynamics is swift. Also, observe how the control signal of the compensated system\nreturns to linear behaviour faster than the uncompensated system. After saturation i.e. when u\u2212 sat(u) = 0, the\nsystem displays additional dynamics introduced by the AW compensator. This suggests that the poles of the AW\ncompensator must be fast and well damped.\nNote that the Riccati based synthesis described in Theorem 1 gives, for a given value of \u03b3 (and therefore P > 0),\na family of gains, F , and therefore anti-windup compensators, parameterised by the diagonal matrix W > 0.\nObserve from equation (6) that the poles of the anti-windup compensator and the sizes of the compensation\nsignals yd and ud are functions of W . Increasing the size of F (and thus decreasing the size of W ) leads to larger\npoles (faster dynamics) and a large compensation signal ud. The flexibility in W is useful for implementation\nas it allows the designer to limit the magnitude of the compensator poles to ensure that they are compatible with\nthe sampling frequency. The possibility of closely relating the size of the stability multiplier with the systems\npoles is not present in th LMI formulation of the problem. Figure 10 shows time simulations for different values\nof W with a fixed sampling rate of 10\u22123sec.\n19\n0 5 10 15 20 25\n\u22128\n\u22126\n\u22124\n\u22122\n0\n2\n4\n6\n8\nO\nut\npu\nt r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\n0 5 10 15 20 25\n\u221216\n\u221214\n\u221212\n\u221210\n\u22128\n\u22126\n\u22124\n\u22122\n0\n2\nCo\nnt\nro\nl r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\nFigure 7: Nominal linear resposne\n0 5 10 15 20 25\n\u221260\n\u221250\n\u221240\n\u221230\n\u221220\n\u221210\n0\n10\n20\n30\n40\nO\nut\npu\nt r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\n0 5 10 15 20 25\n\u22128\n\u22127\n\u22126\n\u22125\n\u22124\n\u22123\n\u22122\n\u22121\n0\n1\nCo\nnt\nro\nl r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\nFigure 8: Saturated system with no AW compensation\nNow consider the real nominal open-loop plant G\u02dc(s) = G(s)\u2206act(s) consisting of the nominal plant G(s) plus\nunmodelled dynamics \u2206act(s) = diag(\u03b4act(s), \u03b4act(s)) where \u2206act(s) represents unmodelled actuator dynamics\nof the form:\n\u03b4act(s) =\n\u03c92n\ns2 + 2\u03b6\u03c9ns + \u03c92n\nwhere \u03c9n is the undamped natural frequency and \u03b6 is the damping constant. Assuming a \u201cworst case\u201d sce-\nnario (from looking at the frequency response of the closed-loop transfer function) and setting these con-\nstants to 30rad\/sec and 0.049 respectively, the actuators have a resonant peak and very large phase shifts\nnear the crossover frequency. This input-multiplicative uncertainty can be modelled as an additive uncertainty\n\u2206G(s) = G(s)[\u2206act(s)\u2212I]. It can be verfied using the small gain theorem that under this uncertainty the system\nis robustly stable as \u2016K(I \u2212 GK)\u22121\u2206G\u2016\u221e < 1. The nominal (un-saturated) closed loop response, including\nuncertainties, is shown in Figure 11 and it is clear that stability has been maintained and that linear performance\nin the face of this uncertainty is remarkably good. However, introducing saturation as well as the uncertainty\nleads to the system entering a very high amplitude limit cycle (Figure 12).\nIn order to show the advantages of the Riccati based design method proposed in this paper, it will be compared\n20\n0 5 10 15 20 25\n\u22128\n\u22126\n\u22124\n\u22122\n0\n2\n4\n6\n8\nO\nut\npu\nt r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\n0 5 10 15 20 25\n\u221216\n\u221214\n\u221212\n\u221210\n\u22128\n\u22126\n\u22124\n\u22122\n0\n2\nCo\nnt\nro\nl r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\nFigure 9: Saturated system with full-order AW compensation using Theorem 1\nagainst the static, low-order and robust full-order LMI methods proposed in [23, 25, 23]. Consider the uncertain,\nsaturated, AW compensated closed-loop system. Firstly, static and low-order compensators are designed using\nthe LMI method described in [25], to give:\n\u0398static =\n[\n\u03981\n\u03982\n]\n=\n\uf8ee\n\uf8ef\uf8ef\uf8ef\uf8f0\n\u22120.9992 \u22120.0039\n0.0173 \u22120.6921\n\u22120.0112 \u22120.5573\n\u22120.2022 \u22120.3408\n\uf8f9\n\uf8fa\uf8fa\uf8fa\uf8fb\n\u0398loword = F1\u03981 + F2\u03982 = F1\n[\n\u22121.6973 5.1136\n3.5044 81.5261\n]\n+ F2\n[\n\u22127.2807 \u2212356.3648\n\u2212113.6640 53.0146\n]\nwhere the low-pass filters are chosen to be F1 = diag( 2s+2 , 1) and F2 = I2\nFrom Figures 13 and 14 it is evident that both the static and low-order compensators just manage to maintain\nstability in the presence of uncertainty, but the system\u2019s tracking and decoupling properties are lost. This rein-\nforces the need for robust AW compensation schemes which can deal with a wide range of uncertainties in a\nsystematic way. Using the approach of [23], a \u201crobust\u201d LMI based AW compensator was obtained by choosing\nweights Wp = I (performance) and Wr = 0.001I (robustness) to give the matrix gain:\nF =\n[\n0.1181 0.8070 0.0240\n\u22120.0035 \u22120.0172 \u22120.0002\n]\n(71)\nThe robust full-order compensator synthesis of [23] will be compared against the synthesis method proposed\nin this paper. Figure 15 shows the response of the full-order LMI based AW compensator proposed in [23].\nSurprisingly, its performance is worse than that of the static or low-order compensators. This may be due to the\nfact that in such a scheme, robustness is achieved by reducing the magnitude of the poles of the compensator.\nThis, in turn, reduces the system\u2019s performance. Although this is the ever present trade-off in robust control, the\nlack of real freedom in the LMI synthesis method compromises more performance than necessary.\nFigure 15 shows the response of the full-order Riccati based AW compenstor proposed in Theorem 2. Although\nthe response is far from ideal, it is definitely stable and yields overshoots around two orders of magnitude lower\nthan the LMI-based compensator. Although the robust Riccati-based compensator has faster dynamics, it is\n21\n0 5 10 15 20 25\n\u22128\n\u22126\n\u22124\n\u22122\n0\n2\n4\n6\n8\nO\nut\npu\nt r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\n0 5 10 15 20 25\n\u221215\n\u221210\n\u22125\n0\n5\n10\nCo\nnt\nro\nl r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\nW=10 and \u2206T = 10\u22123\n0 5 10 15 20 25\n\u22128\n\u22126\n\u22124\n\u22122\n0\n2\n4\n6\n8\nO\nut\npu\nt r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\n0 5 10 15 20 25\n\u221216\n\u221214\n\u221212\n\u221210\n\u22128\n\u22126\n\u22124\n\u22122\n0\n2\nCo\nnt\nro\nl r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\nW=200 and \u2206T = 10\u22123\nFigure 10: Full order compensation using Theorem 1 for different values of W , \u03b3 = 378 and a sampling rate of\n10\u22123sec\nclearly preferable to the LMI compensator. This is actually achieved by using Theorem 1, which can be seen\nas a weighted version of Theorem 2, and setting W = diag[20, 0.1] and \u03b3 = 500. Notice that the freedom in\nchoosing \u03b3 or W is especially useful and is almost absent in the LMI formulations. In other words, the so called\nstability multiplier (W ) and the performance index \u03b3 capture in a more efficient way the trade-offs that exist\nbetween robustness and performance when designing AW cmpensators in the presence of uncetainties.\nRemark 9: The example in this section has provided a simple illustration of the application of the algorithms\ndeveloped in this paper. It has been demonstrated how the link between the free parameter W and the AW\ncompensator\u2019s closed-loop poles is useful for practical situations. The other strength of the Riccati technique\nwhen compared to the LMI techniques is its numerical superiority. Although the robust design algorithm of\nTheorem 2 has an LMI counterpart given in [23, 24], for large and complex problems, LMI\u2019s can become\nunreliable and unwieldy. Unfortunately, a comprehensive discussion of such an example is beyond the scope of\nthe current paper but AW compensators based on the Riccati techniques proposed here have recently been tested\non a model of an experimental aircraft; these results are due to be reported in [19].\n22\n0 5 10 15 20 25 30 35 40\n\u22128\n\u22126\n\u22124\n\u22122\n0\n2\n4\n6\n8\nO\nut\npu\nt r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\n0 5 10 15 20 25 30 35 40\n\u221216\n\u221214\n\u221212\n\u221210\n\u22128\n\u22126\n\u22124\n\u22122\n0\n2\nCo\nnt\nro\nl r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\nFigure 11: Uncertain Unsaturated system\n0 5 10 15 20 25 30 35 40\n\u22122000\n\u22121500\n\u22121000\n\u2212500\n0\n500\n1000\n1500\n2000\nO\nut\npu\nt r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\n0 5 10 15 20 25 30 35 40\n\u221215\n\u221210\n\u22125\n0\n5\n10\nCo\nnt\nro\nl r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\nFigure 12: Uncertain Saturated system\n6 Conclusions\nThis paper has presented an alternative solution to the full-order AW problem with performance and robustness\nguarantees. The solution given is novel in the sense that most other full-order AW design techniques which\nensure stability and performance involve LMI\u2019s (see [6] for a general treatment): here we simply require the\nsolution to a bounded real type of Riccati equation. The solution is also believed to be more intuitive in the\nway that the free parameter, W > 0, is clearly linked to the poles of the anti-windup compensator, which has\nimportant practical relevance.\nThe paper has also been successful in incorporating robustness into the AW problem and the results obtained have\nuncovered the close relationship that exists between robust stability and the free parameter W , or the \u201cstability\nmultiplier\u201d. An important feature of designing full-order compensators using Riccati equations is that freedom\nin choosing W allows the designer to reflect the relative importance of the input channels. Such is the case of\nthe auto-pilot-missile example, where even though both channels have saturation limits, only the second tends to\nexceeds these limits.\nAnother important feature is the direct freedom the designer has in choosing \u03b3. Although optimal peformance\n23\n0 5 10 15 20 25 30 35 40\n\u22121500\n\u22121000\n\u2212500\n0\n500\n1000\n1500\nO\nut\npu\nt r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\n0 5 10 15 20 25 30 35 40\n\u221215\n\u221210\n\u22125\n0\n5\n10\nCo\nnt\nro\nl r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\nFigure 13: Uncertain Saturated system + Static AW compensator\n0 5 10 15 20 25 30 35 40\n\u2212800\n\u2212600\n\u2212400\n\u2212200\n0\n200\n400\n600\n800\nO\nut\npu\nt r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\n0 5 10 15 20 25 30 35 40\n\u221215\n\u221210\n\u22125\n0\n5\n10\nCo\nnt\nro\nl r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\nFigure 14: Uncertain Saturated system + Low-order AW compensator\nis always desired, sometimes it is neccessary to compromise performance in order to achieve robust stability. In\nthe LMI fomulation given in [23], such a trade-off is hidden within the optimisation.\nIt is interesting to note how the design of AW compensators is completely independent from the controller K(s)\nif no uncertainties are present. However, when uncertainties are introduced, this is no longer the case and a small\nadjustment of the linear loop may enhance robustness of the saturated closed-loop plant. Recently the weakened\nAW problem has been proposed in [4]. This attempts to improve robustness at the expense of adjusting the linear\nloop, which has the potential to achieve greater robust stability (see also [9]).\nReferences\n[1] S. Crawshaw. Global and local analysis of coprime-factor based anti-windup for stable and unstable plants. Proc.\nEuropean Control Conference, 2003.\n[2] S. Crawshaw and G. Vinnicombe. Anti-windup synthesis for guaranteed L2 performance. Proc. IEEE Conf. on\nDecision and Control, 2000.\n[3] C. Edwards and I. Postlethwaite. Anti-windup and bumpless transfer schemes. Automatica, 34(2):199\u2013210, 1998.\n24\n0 5 10 15 20 25 30 35 40\n\u22122000\n\u22121500\n\u22121000\n\u2212500\n0\n500\n1000\n1500\n2000\nO\nut\npu\nt r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\n0 5 10 15 20 25 30 35 40\n\u221215\n\u221210\n\u22125\n0\n5\n10\nCo\nnt\nro\nl r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\nFigure 15: Uncertain Saturated system + Full-order LMI based robust AW compensator\n0 5 10 15 20 25 30 35 40\n\u221240\n\u221230\n\u221220\n\u221210\n0\n10\n20\n30\nO\nut\npu\nt r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\n0 5 10 15 20 25 30 35 40\n\u221216\n\u221214\n\u221212\n\u221210\n\u22128\n\u22126\n\u22124\n\u22122\n0\n2\nCo\nnt\nro\nl r\nes\npo\nns\ne \n[de\ng]\nTime [sec]\nFigure 16: Uncertain Saturated system + Full-order Riccati based robust AW compensator\n[4] S. Galeani, S. Nicosa, A.R. Teel, and L. Zaccarian. Output feedback compensators for weakened anti-windup of\nadditively perturbed systems. In Proc. IFAC World Congress, Prague, 2005.\n[5] M. Green and D.J.N. Limebeer. Linear Robust Control. Prentice Hall, New Jersey, 1996.\n[6] G. Grimm, J. Hatfield, I. Postlethwaite, A.R. Teel, M.C. Turner, and L. Zaccarian. Anti-windup for stable linear\nsystems with input saturation: an LMI based synthesis. IEEE Transactions on Automatic Control, 48(9):1509\u20131525,\n2003.\n[7] G. Herrmann, M.C. Turner, and I. Postlethwaite. Pratical implementation of a novel anti-windup scheme in a hdd-\ndual-stage servo-system. IEEE\/ASME Transactions on Mechatronics, 9(3):580\u2013592, 2004.\n[8] M.V. Kothare, P.J. Campo, M. Morari, and C.N. Nett. A unified framework for the study of anti-windup designs.\nAutomatica, 30(12):1869\u20131883, 1994.\n[9] A. Marcos, M.C. Turner, D.G. Bates, and I. Postlethwaite. Robustification of static and low-order anti-windup designs.\nIFAC Symposium on Robust Controller Design, submitted.\n[10] S. Miyamoto and G. Vinnicombe. Robust control of plants with saturation nonlinearity based on comprime factor\nrepresentations. Proc. IEEE Conf. on Decision and Control, pages 2838\u20132840, 1996.\n[11] E.F. Mulder, M.V. Kothare, and M. Morari. Multivariable anti-windup controller synthesis using linear matrix in-\nequalities. Automatica, 37(9):1407\u20131416, 2001.\n25\n[12] T. Nguyen and F. Jabbari. Disturbance attenuation for systems with input saturation: an LMI approach. IEEE Trans.\nAutomatic Control, 44(4):852\u2013857, 1999.\n[13] A.A. Rodriguez and J. R. Cloutier. Control of a bank-to-turn missile with saturating actuators. Proc. American\nControl Conference, 1994.\n[14] B.G. Romanchuk. Some comments on anti-windup synthesis using LMI\u2019s. International Journal of Robust and\nNonlinear Control, 9(10):717\u2013734, 1999.\n[15] A. Saberi, Z. Lin, and A.R. Teel. Control of linear systems with saturating actuators. IEEE Trans. on Automatic\nControl, 41(3):368\u2013378, 1996.\n[16] M. Saeki and N. Wada. Synthesis of a static anti-windup compensator via linear matrix inequalities. International\nJournal of Robust and Nonlinear Control, 12:927\u2013953, 2002.\n[17] S. Skogstad and I. Postlethwaite. Multivariable feedback control: analysis and design. Wiley, Chichester, England,\n2nd edition, 2006.\n[18] J. Sofrony, M.C. Turner, and I. Postlethwaite. Anti-windup synthesis using Riccati equations. In Proc. IFAC World\nCongress, Prague, 2005.\n[19] J. Sofrony, M.C. Turner, I. Postlethwaite, O.M. Brieger, and D. Leissling. Anti-windup synthesis for PIO avoidance\nin an experimental aircraft. In IEEE Conference on Decision and Control, submitted.\n[20] S. Tarbouriech and G. Garcia. Control of Uncertain Systems with Bounded Inputs. Springer-Verlag, London, 1997.\n[21] S. Tarbouriech, J.M. Gomes da Silva Jr., and G. Garcia. Delay-dependent anti-windup strategy for linear systems with\nsaturating inputs and delayed outputs. International Journal of Robust and Nonlinear Control, 14(7):665\u201382, 2004.\n[22] A.R. Teel and N. Kapoor. The L2 anti-windup problem: Its definition and solution. Proc. European Cont. Conf.,\n1997.\n[23] M.C. Turner, G. Herrmann, and I. Postlethwaite. Accounting for robustness in anti-windup synthesis. In Proc.\nAmerican Control Conference, Boston, 2004.\n[24] M.C. Turner, G. Herrmann, and I. Postlethwaite. Improving robustness in anti-windup synthesis. submitted, 2005.\n[25] M.C. Turner and I. Postlethwaite. A new perspective on static and low order anti-windup synthesis. International\nJournal of Control, 77(1):27\u201344, 2004.\n[26] P.F. Weston and I Postlethwaite. Analysis and design of linear conditioning schemes for systems containing saturating\nactuators. IFAC Nonlinear Control System Design Symposium, 1998.\n[27] P.F. Weston and I Postlethwaite. Linear conditioning for systems containing saturating actuators. Automatica,\n36(9):1347\u20131354, 2000.\n[28] F. Wu and M. Soto. Extended anti-windup control schemes for LTI and LFT systems with actuator saturations.\nInternational Journal of Robust and Nonlinear Control, 14(15):1255\u20131281, 2004.\n[29] L. Zaccarian and A.R. Teel. A common framework for anti-windup, bumpless transfer and reliable designs. Automat-\nica, 38:1735\u20131744, 2002.\n"}