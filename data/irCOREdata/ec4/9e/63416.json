{"doi":"10.1016\/S0098-3004(00)00042-X","coreId":"63416","oai":"oai:nora.nerc.ac.uk:2402","identifiers":["oai:nora.nerc.ac.uk:2402","10.1016\/S0098-3004(00)00042-X"],"title":"Geoscience after IT: Part G. Familiarization with spatial analysis","authors":["Loudon, T.V."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":["Loudon, T.V."],"datePublished":"2000-04","abstract":"Spatial pattern is crucial to geoscience. It enables us to compare the observed properties of objects and explain their spatial relationships, correlation and distribution in terms of the geological circumstances and processes that formed them. Digital cartography and the spatial model provide computer support for looking at objects and properties in their spatial context. Transformations enable us to move and shape the objects for better visualization and analysis. Spatial statistics can quantify configuration for analysis of form and structure. The fractal model reminds us of the divergence between our models and reality. \\u","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/63416.pdf","fullTextIdentifier":"http:\/\/nora.nerc.ac.uk\/2402\/1\/Part_G.pdf","pdfHashValue":"6870591dae8535444f5da93454ac7b57140331ee","publisher":"Pergamon Elsevier-Science, Oxford","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:nora.nerc.ac.uk:2402<\/identifier><datestamp>\n      2012-11-22T11:48:20Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D5338<\/setSpec><setSpec>\n      7375626A656374733D5339<\/setSpec><setSpec>\n      7375626A656374733D533130<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/nora.nerc.ac.uk\/id\/eprint\/2402\/<\/dc:relation><dc:title>\n        Geoscience after IT: Part G. Familiarization with spatial analysis<\/dc:title><dc:creator>\n        Loudon, T.V.<\/dc:creator><dc:subject>\n        Computer Science<\/dc:subject><dc:subject>\n        Data and Information<\/dc:subject><dc:subject>\n        Earth Sciences<\/dc:subject><dc:description>\n        Spatial pattern is crucial to geoscience. It enables us to compare the observed properties of objects and explain their spatial relationships, correlation and distribution in terms of the geological circumstances and processes that formed them. Digital cartography and the spatial model provide computer support for looking at objects and properties in their spatial context. Transformations enable us to move and shape the objects for better visualization and analysis. Spatial statistics can quantify configuration for analysis of form and structure. The fractal model reminds us of the divergence between our models and reality. \\ud\n<\/dc:description><dc:publisher>\n        Pergamon Elsevier-Science, Oxford<\/dc:publisher><dc:contributor>\n        Loudon, T.V.<\/dc:contributor><dc:date>\n        2000-04<\/dc:date><dc:type>\n        Publication - Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/nora.nerc.ac.uk\/id\/eprint\/2402\/1\/Part_G.pdf<\/dc:identifier><dc:identifier>\n         \n\n  Loudon, T.V..  2000  Geoscience after IT: Part G. Familiarization with spatial analysis.   Computers & Geosciences, 26 (3, Sup). A51-A62.  https:\/\/doi.org\/10.1016\/S0098-3004(00)00042-X <https:\/\/doi.org\/10.1016\/S0098-3004(00)00042-X>     \n <\/dc:identifier><dc:relation>\n        http:\/\/www.elsevier.com\/wps\/find\/journaldescription.cws_home\/398\/description#description<\/dc:relation><dc:relation>\n        doi:10.1016\/S0098-3004(00)00042-X<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/nora.nerc.ac.uk\/id\/eprint\/2402\/","http:\/\/www.elsevier.com\/wps\/find\/journaldescription.cws_home\/398\/description#description","doi:10.1016\/S0098-3004(00)00042-X"],"year":2000,"topics":["Computer Science","Data and Information","Earth Sciences"],"subject":["Publication - Article","PeerReviewed"],"fullText":"<<<Back to Table of Contents       \nOn to Part H: Familiarization with managing the information base>>> \n \n \nGeoscience after IT: Part G \n \nFamiliarization with spatial analysis \n \nT. V. Loudon \nBritish Geological Survey, West Mains Road, Edinburgh EH9 3LA, U.K. \ne-mail: v.loudon@bgs.ac.uk \n \n \nPostprint of article in Computers & Geosciences, 26 (3A) April 2000, pp. A51-A62 \n \nAbstract - Spatial pattern is crucial to geoscience. It enables us to compare the \nobserved properties of objects and explain their spatial relationships, correlation and \ndistribution in terms of the geological circumstances and processes that formed them. \nDigital cartography and the spatial model provide computer support for looking at \nobjects and properties in their spatial context. Transformations enable us to move and \nshape the objects for better visualization and analysis. Spatial statistics can quantify \nconfiguration for analysis of form and structure. The fractal model reminds us of the \ndivergence between our models and reality. \n \nKey Words - Digital cartography, spatial relationships, spatial models, spatial \ntransformations, fractals. \n \n \n1. Digital cartography \n \nA vector (xi1, xi2) can represent a point in two dimensions, and a vector (xi1, xi2, xi3) \ncan represent a point in three dimensions. A straight line joining two points is also a \nvector in the geometric sense (it has length, orientation and direction). A string of \nvectors, joined end to end, linking a set of points, can represent a curved line on a \nmap. A set of lines joined end to end can delimit a closed area on the map, sometimes \nreferred to as a polygon. The point, line and area are sometimes known in digital \ncartography as a vertex, edge and face.  \n \nComputer systems for drawing maps may be specifically developed for cartography, \nor could be computer-aided design systems, adapted for cartographic purposes. Areas \ncan be filled with a selected color or ornament, and symbols and text positioned at \npoints selected by the user. Fig. 1 for example shows a diagrammatic geological map \nprepared on a desktop computer. Other cartographic representations show, for \nexample, a vertical section of beds measured at an exposure or from a borehole (Fig. \n2), or a fence diagram (Fig. 3) showing the variation in thickness of each of a \nsequence of beds across a number of measurement sites. Symbol maps of various \nkinds can show the spatial variation of one or more variables. Programs for a personal \ncomputer are available at reasonable cost to support a range of these tasks. \nLoudon, T.V., 2000. Geoscience after IT: Part G  (postprint, Computers & Geosciences, 26(3A)) \n \n \n \nFig. 1. Diagrammatic geological map. Example of a diagram prepared on a desktop computer. \nReproduced by permission of Rockware. More at http:\/\/www.rockware.com\/ \n \nSee next page for Fig 2. \n \n \n \n \n \nFig. 3. Fence diagram. Example of diagram prepared on a dektop computer. Reproduced by permission \nof Rockware. More on http:\/\/www.rockware.com\/ \n \nLoudon, T.V., 2000. Geoscience after IT: Part G  (postprint, Computers & Geosciences, 26(3A)) \n \n \n \nFig. 2. Log of vertical section. Example of diagram prepared on a desktop computer. Reproduced by \npermission of Rockware. More at http:\/\/www.rockware.com\/ \n \nExisting maps can be digitized by clicking on selected points. A sequence of points \ncan be digitized to record a line, and a sequence of lines to enclose an area. Because \nthe short lines joining points are vectors, this is known as vector digitizing, and \ngenerates a vector format. Another way to capture existing images is with a scanner. \nThis creates a raster format, in which the image is made up of a rectangular grid of \nsmall cells (picture elements, picture cells, or pixels). The scanner assigns a value to \neach pixel to indicate the color at that point. The computer stores the values for the \narray of pixels. A minimum of one bit records each pixel in a monochrome image, but \nLoudon, T.V., 2000. Geoscience after IT: Part G  (postprint, Computers & Geosciences, 26(3A)) \n \nup to 24 bits or more may be used to store the proportions of red, green and blue in a \npixel of a color image. \n \nThe raster format is an effective and efficient means of recording and storing complex \nimages, such as air photographs, satellite imagery or \u201cbusy\u201d topographic maps. Vector \nrepresentation is more flexible and efficient where there are relatively few lines, as in \na geological map. It has the advantage that individual lines and areas can be referred \nto and processed separately. Thus, one could select all the areas enclosed by the \nCretaceous boundary, and find specimens within it by a points-in-polygon process. \n \nRaster and vector methods are frequently used together. For example, a topographic \nmap might be scanned and displayed as a raster image on the screen. Points and lines \nof geological significance could then be traced by moving a cursor on the screen and \nrecorded in vector mode. This is a widely used procedure for digitizing geological \nmaps, having the advantage of providing separate but linked representation of the \ntopography and the geology in exact register. The two layers can be overlain when \nrequired and displayed together. Each is also available separately in its most useful \nformat. Conversion from one format to the other is possible when required, and vector \nformat is generally rasterized before it is displayed on the screen or printed. Many \nrasters, however, such as satellite images, could not be represented satisfactorily by \nvectors. \n \n2. The spatial model \n \nIdeas about how quantitative methods fit into broader schemes of investigation are \ntaken up later (part L, section 6.3). Meanwhile, we may note that most quantitative \nwork in geoscience arises in geophysics and other subjects where instruments provide \nmuch of the raw data. Examples from geophysics include gravity, aeromagnetic or \nexploration seismic surveys, geomagnetism and global seismology. Other examples \ncan be found in some geochemical and oceanographic surveys, aerial photography \nand satellite imagery. The initial data processing may be concerned more with \ncorrecting and clarifying the instrumental records than in exploring geological ideas. \nThe mathematical models may be specific to the tools used in probing the properties \nof the Earth. The consistency of well-calibrated instruments, and the ability to correct \nfor extraneous effects, are powerful features of these methods. Standardization makes \nit possible to conduct surveys over large regions or of global extent. Conclusions are \nnot limited by local circumstances. \n \nThe significance of the results is not likely to lie in a single measurement at one point, \nbut rather in the regional spatial patterns, and their correlation with spatial patterns \nfrom other types of survey. Integration of the ideas from the various topics could \nproceed through examination and comparison of maps showing the final \ninterpretations of the topic experts. However, digital spatial models (computer \nrepresentations of objects and their properties in geographic space) offer more \npowerful methods of representing, analyzing, comparing and displaying the data. \nSpatial data, such as measurements of gravity, or formation elevations determined \nfrom downhole logs, may be recorded as part of a general database system, and still \nbe part of the spatial model.  \n \nLoudon, T.V., 2000. Geoscience after IT: Part G  (postprint, Computers & Geosciences, 26(3A)) \n \nTraditional geological maps, showing the distribution of formations and other features \nat or near the ground surface, are now generally prepared by digital cartography (G 1). \nContour maps, showing the variation of properties across an area, may also be drawn \nby computer (see Watson, 1992). The case for digital methods usually refers to long-\nterm cost savings, flexibility, rapid production and ease of editing and updating. \nHowever, the longer-term benefits may depend on end products beyond the published \nmap. The map, after all, is no more than an illustration of the underlying concepts (B \n4.1). IT offers the prospect of expressing the latest conceptual model more \ncomprehensively, and linking it to the quantitative surveys mentioned in F 5 (F\u00f6rster \nand Merriam, 1996, Grunsky et al., 1996). The model can thus include three-\ndimensional rock bodies, their disposition and configuration, their composition and \nproperties, their changes through geological time, the evidence and confidence in the \nconclusions (M 2.3). There is a prospect of freeing spatial information from the \nlimitations of the paper map (B 4), and integrating it within the computer model (L 4). \nThe ability to integrate concepts, and therefore the scope of the spatial model, is \ndetermined by the human interpreter, not by the capabilities of the software. \nUltimately, therefore, the model reaches out beyond the computer with links to the \nscientists\u2019 unstated knowledge. \n \nThe computer spatial model, unconstrained by cartographic limitations, can express \nthe conceptual model more fully. More of the ideas in the minds of the surveyors can \nbe recorded and become the shared resource of the community. Maps can then be \nseen as ephemeral documents to assist visualization, illustrating selected two-\ndimensional projections of the model (see MacEachern, 1998 and the special issue of \nthe International Journal of Geographical Information Science introduced by Kraak, \n1999). The collection and archiving of spatial data are freed from the limitations of \nthe map. Users would choose their own map content and display, after interacting \nwith the model to clarify the availability of information and to select from it to meet \ntheir requirements. Comparison and correlation with other models, such as \ntopography, land-use, or patterns of mineral deficiency in livestock, could be based on \nthe models themselves, not on their cartographic representation. These future \nprospects are discussed in L 4 and M 2. The objective at this point is to look at the \nmethods of handling data in the context of a spatial model. \n \nA geological map enables the user to find (in the map key) a list of the things of \ninterest (objects), such as stratigraphic units, displayed on the map. The map shows \nthe location of the objects, related to topography and to a geographic grid or latitude \nand longitude. It gives an indication of the pattern and form of the objects. Contour \nmaps may show, for example, chemical composition or engineering properties, and \ntheir spatial variation. The digital spatial model should combine these tasks and \nperform them more effectively. Like the map key, the metadata (D 3) associated with \nthe model should identify the objects, perhaps grouping them within object classes or \ntopics that might correspond to projects or to types of map, such as geology, \ngeophysics or topography.  \n \nThe location of data must obviously be recorded in the model. The configurations of \nobjects and their distribution patterns and correlations may be investigated \nnumerically, but are more likely to be examined by eye. The data must be displayable \non a computer screen or printed as a map, and this involves transforming their three-\ndimensional locations to appropriate positions on the display. The transformation \nLoudon, T.V., 2000. Geoscience after IT: Part G  (postprint, Computers & Geosciences, 26(3A)) \n \nmust preserve significant relationships among the data. We therefore look next at \nwhat these relationships are, how the transformations can be carried out, and which \nquantitative methods might be appropriate for the spatial data. \n \n3. Spatial relationships \n \nSpatial relationships can be important to the interpretation of a geological map, such \nas a formation boundary veeing upstream or a fossil being collected from a particular \nrock unit. They fall into two main categories - topological and geometric. Topological \nrelationships are those that are unchanged by rubber-sheet deformations. If you \nimagine a map drawn on a thin elastic sheet, the sheet could be distorted by stretching \nand the relative position of points altered. Straight lines could become curved, angles \nbetween them altered, distances changed. Topological relationships are invariant \n(unaltered) during these distortions. Examples are: a point lying on a line; points, lines \nor areas coinciding or contained inside an area; lines touching, branching or \nintersecting; lines bounding an area; and their opposites, such as a point lying outside \nan area. \n \nGeometric relationships on the other hand, require a consistent metric, that is, \ndistance and direction must be measured consistently throughout the space. Geometric \nrelationships include: above, near, adjacent to, farther from, parallel to, converging \nwith, at right angles to, interdigitated with, larger than, and their opposites and \napproximations. Unlike topological relationships, geometric relationships can \ngenerally be quantified, as in: twice as large, 234 meters from, converging at 20o. \n \nSome relationships may be obvious in the field, such as an outcrop being on the north \nside of a river below a road bridge. The relationship might be shown with some \ndifficulty on a map, but is liable to be lost if the map is generalized for scale change. \nA printed geological map may be locked into a specific base map by overprinting. \nThe spatial model seeks the flexibility of allowing each topic and each project to be \nmanaged separately, preferably meeting standards (L 4) that allow easy interchange of \ndata. As this allows datasets to change independently, important relationships between \nthem should be recorded explicitly. If need be, the short section of river and road \nbridge might be digitized and made available permanently within the geological \nmodel. It can then be compared with the same fragment of river on the topographic \nmodel during display, and any necessary adjustments made. \n \nSpatial information can be transformed in various ways, altering the geometric \nrelationships between objects. The transformations are an important part of computer \ngraphics and essential for manipulating and visualizing the spatial model. They must \nbe used with care to avoid accidentally distorting patterns or altering spatial \nrelationships. For example, different map projections alter the size, shape and location \nof areas and cause difficulty in overlaying maps. Spatial transformations are also used \nin recreating surfaces from point data and in multivariate statistics. Understanding \ntheir effects is useful background. \n \n4. Spatial transformations \n \nSpatial transformations of a geoscience model generally alter geometry rather than \ntopology. However, it is possible that, say, two separate lines would coincide on the \nLoudon, T.V., 2000. Geoscience after IT: Part G  (postprint, Computers & Geosciences, 26(3A)) \n \ndisplay when the scale is reduced. On a printed map, a cartographic draftsman might \nmove the lines apart, to preserve the relationship at the expense of accurate \npositioning. On an interactive system, the ability to zoom in and clarify the \nrelationships makes this unnecessary, and the true positions of the lines could be \npreserved. \n \nFor display purposes, a simple set of geometric transformations is available (Foley, \n1994). Translation is bodily movement of an object relative to the origin. Rotation \ninvolves the object being turned about an axis. They are both rigid-body \ntransformations that do not alter the size or shape of an object. Stretching changes the \nlength of an object along an axis, thus changing its shape and altering distances and \nangles, except in the special case of enlargement where scaling is the same in all \ndirections, and only the size and distances are altered. Projection involves reducing \nthe number of dimensions, as when a three-dimensional body is projected on a two-\ndimensional screen. The linear transformations just mentioned are known as affine \ntransformations. Perspective change gives a more lifelike appearance to the \nprojection of an object by including perspective effects, such as apparent size \ndiminishing with distance and parallel lines converging. \n \nThese transformations, which are illustrated in Fig. 4, are carried out on the computer \nby matrix multiplication (F 4).  For display purposes, a sequence of transformations \nmay be called for, such as rotate about the x-axis by 30o, dilate to twice the length \nalong the new y-axis, then rotate back by -30o about the x-axis. This can be \nrepresented by a sequence of matrices, which could be applied in turn. It is more \nefficient, however, to multiply the transformation matrices together to obtain a \ncomposite matrix of the same size representing the entire sequence of transformations. \nThe composite matrix is then applied to each of the original data points. \n \n \n \n \nFig. 4. Some geometric transformations. The figure at A is translated in B and rotated in C. The scale is \nchanged in D, and the figure is stretched in E, with only the horizontal scale being altered. The figure is \nsheared in F. There are obvious three-dimensional equivalents. More complex transformations include \nperspective projections (G) in which the change of scale varies across the figure. \n \nLoudon, T.V., 2000. Geoscience after IT: Part G  (postprint, Computers & Geosciences, 26(3A)) \n \nThe transformation matrix is a square matrix, with two rows and two columns (2x2) \nfor transformations in two dimensions, 3x3 for three dimensions and so on. The \ntransformations, and the matrix multiplications, must be carried out in the correct \norder. Translation involves addition, rather than multiplication, but can be included in \nthe multiplication by adding an extra dimension. The three-dimensional data are \ntransformed in four dimensions. The extra dimension is also needed for perspective \ntransformations.  \n \nThe main application of these spatial transformations is for graphical display and \nmanipulation, such as projection of three-dimensional objects onto two-dimensional \npaper or a computer screen. They also play a part in structural geology, process \nmodeling, and such areas as multivariate statistics, surface interpolation and shape \nanalysis.  \n \nAn image can be subdivided into small patches. Each patch can be transformed \nseparately, while forcing continuity across patches by modifying the transformations \nto ensure that the patches meet smoothly at the edges, by methods comparable to \nblending functions (G 5). The process is sometimes known as rubber sheeting. \nDistorted images such as oblique air photographs can be corrected. For example, \npoints could be selected on the distorted photograph as landmarks for which exact \ncoordinates could be found on a map. The distorted image could then be corrected by \njoining adjacent landmarks by lines and transforming the patches between them to \nconform to the map coordinates. \n \nSpatial transformations also arise in map projections, which offer solutions to the \nproblem of projecting an irregular oblate spheroid (the surface of the Earth) onto two-\ndimensional paper. The transformations are generally more complex than those just \ndescribed. Different projections maintain different aspects of the original geometry. \nAreas, angles, distances and continuity cannot all be preserved when part of the \nsurface of a sphere is distorted for representation in two dimensions. Aspects that can \nbe neglected on the screen are important on printed maps. For instance, the user is \nlikely to expect roads to meet across sheet boundaries without sharp breaks in \ndirection.  \n \nContinuity from area to area raises problems as even the coordinate system, based on \nlatitude and longitude, has local variations. The Earth is irregular, and mathematical \napproximations must be used for such concepts as the datum (the origin of the local \ncoordinate system including mean sea level) and the geoid (a mathematical surface \napproximating, at least locally, to the shape of the earth). Different geoids and datums \nhave been used at different times and in different places. Map coordinates and \nprojections are a subject in their own right (see, for example, Snyder, 1987). \nHowever, if you combine spatial data from different sources, you should at least be \naware of this potential source of error. \n \n5. Spatial statistics and surface fitting \n \nThe statistical methods described in F 5 apply to properties measured at points in \nspace. In geoscience, spatial patterns and spatial correlations are often crucial. \nStatistical methods describe the observed patterns quantitatively, guide interpolation \nbetween sampled points, and measure spatial correlations. The patterns are likely to \nLoudon, T.V., 2000. Geoscience after IT: Part G  (postprint, Computers & Geosciences, 26(3A)) \n \nreflect underlying geological processes that have influenced many measurable \nvariables. Possible aims are to put individual points in context by fitting them to a \nsurface, then to compare and correlate surfaces from the same area to learn more of \nthe environment in which they developed, the formative processes and their effects. \nSpecific tasks might be to estimate the elevation of a formation at a drilling location, \nthe amount of ore in a mineral deposit, or the amount of folding across a cross-\nsection. \n \nAs always, the validity of conclusions depends on appropriate sampling techniques (D \n4). The sample should be random, in the sense that each item in the population has an \nequal chance of being included in the sample. You might try to obtain a representative \nsample of the lithologies in a rock body by selecting collection points as near as \npossible to, say, random points on a map grid, or every 25 paces along a traverse. The \nsample would be unrepresentative, however, if hard sandstones formed outcrops, with \ninterbedded soft shales covered by soil and vegetation. If you were studying the \nrelationship between, say, petrography and geochemistry, then spatial randomization \ncould be misleading. It might be better to ensure that every petrographic composition \nof interest had an equal chance of selection. We should continually review our raw \nmaterial and ask how appropriate our models are, and whether it is possible to \nimprove their correspondence to reality. \n \nA surface is most readily analyzed if the data points are evenly spaced on a \nrectangular grid. But most data are positioned for reasons unconnected with surface \nanalysis. Uneven clusters of points are found in oilfields, or soil samples from a \nhousing development. Sampling points may lie along lines, such as geophysical \ntraverses, geotechnical measurements along a new highway, or geochemical analyses \nof samples along streams. But even if the sampling pattern rules out statistical \nconclusions, quantitative methods may still be of value. \n \nTime series, sequences of measurements at successive times, have been widely \nstudied in statistics. In geoscience, time series arise in geophysics, hydrology, \noceanography and other subjects. Similar methods can be applied to sequences along \na line in space, and some can be extended to two or more dimensions. Regression \ntechniques are one way to relate the variation of a property to its position in time or \nspace. For example, the grain size (p) of samples could be related to distance (x) \nabove the base of a vertical section, by the equation: \n p = a + bx \nThe straight line which this represents is unlikely to show the variation adequately, \nand more terms from a power series or a trigonometric series can be added (see F 5): \n p = a + bx + cx2  + dx3 + . . . + mxn \nor: \n p = a  + bsinx + c sin2x + dsin3x + . . . + msinnx \nIn two dimensions (x and y) the equations represent surfaces and are slightly more \ncomplicated. For example, they might refer to the top of a formation based on its \nelevation (p) as measured at wells: \n p = a + bx + cy + dx2 + exy + fy2 + gx3 + . . . + myn \nor: \np = a + bsinx + csiny + dsin2x + esinx.siny + fsin2x + . . . + msinny \nLoudon, T.V., 2000. Geoscience after IT: Part G  (postprint, Computers & Geosciences, 26(3A)) \n \nThe regression equations are calculated as in F 5 to minimize the sum of squares of \ndeviations between the measured and calculated values of p. An excellent \nmathematical introduction is provided by Lancaster and Salkauskas (1986). \n \nLet us take as an example the elevations of the top of the Cretaceous as known from \nfifty wells over the flank of a depositional basin. One possibility would be to fit a \nregression equation of fifty terms. As this equals the number of wells, it would fit the \nvalues perfectly, and the sum of squares of deviations would be zero. The position of \ncontours on the quantitative surface could be calculated and drawn as a contour map. \nThere is little reason to suppose, however, that the mathematical surface would match \nthe geology. There is no obvious reason why geological processes would produce \nforms shaped like polynomial curves (F Fig. 4), and the result will be greatly \ninfluenced by the spatial distribution of data points, which were almost certainly not \npositioned with this type of analysis in mind.  \n \nA better approach would be to fit a simpler third-order regression surface to the data, \nthat is, an equation with terms up to the third power of x and y. The result would be a \nsmooth surface that was less sensitive to the point distribution. It shows slow \nsystematic change and is known as a trend surface. The residuals, that is the \ndeviations between the data points and the fitted surface, can be displayed and \nmapped separately. Variations at different scales have been separated. The trend \nmight be the result of regional tilting, subsidence and folding, the residuals the result \nof depositional and erosional features. By mapping the residuals separately, features \nmight be noticed which were not apparent on the original map. Attempts at a rigorous \nmathematical justification for such conclusions tend to be rather unconvincing, but are \nunnecessary if the results can be justified by geological reasoning. \n \nIn order to arrive at a unique surface, the least-squares criterion can be applied (F 5), \nminimizing the sum of squares of deviations of data points from the fitted surface. An \nalternative is to fit spline surfaces (Lancaster and Salkauskas, 1986) that minimize \nthe tension, or more strictly, the strain energy, in the surface (thinking of the surface \nas a flexible sheet). This model can give a good fit to some types of geological \nsurface, and might, for example, mimic the shape of a folded surface. \n  \nFor geophysicists, the use of periodic functions needs no introduction. The \nseismologist, for example, deals with shock waves generated by earthquake or \nexplosion, and their modification by the rocks through which they pass. Waves, by \ndefinition, have a repetitive form and this may readily be described by fitting a \nfunction of sines and cosines (see F 5), a process known as harmonic or Fourier \nanalysis. Rather than characterizing the wave by values at successive moments of \ntime, a static view of the power spectrum, or relative importance of components of \ndifferent wavelength, can be calculated. The values in the spectrum relate to the \nconstants, a, b, c, . . . in the sine-wave equation. The power spectrum incorporates a \ngreat deal of information about the form of the wave, and makes it possible to \ncompare the amplitude of different wavelengths (spectral analysis) as a separate issue \nfrom their time of arrival or position in space.  \n \nFourier analysis has benefited from the existence of many accurate time series \ncollected digitally, and from the development of the Fast Fourier Transform (FFT), an \nefficient algorithm that reduces the computing load. Although the main applications \nLoudon, T.V., 2000. Geoscience after IT: Part G  (postprint, Computers & Geosciences, 26(3A)) \n \nare in seismic work, geomagnetism and gravity studies also study periodicity with \nFourier transforms. Methods such as the fast Fourier transform can be applied to large \ndigital datasets such as satellite imagery and downhole logs. With imagery, they can \ngive information about the texture and its variation that may be related to changing \ngeology. \n \nFor a geologist, the value of spectral analysis is less clear. The notion of treating \ndistance from the origin as an angle may seem bizarre, but poses no mathematical \nproblem. More fundamental is the relevance to the geological model. The periodicity \nof deposition of sediment, for example, might be related to geological time, with \ndistance from the base of the section an inadequate substitute. Random events during \ndeposition are likely to throw subsequent periodicity out of phase with that below. \nSimilar comments could be made about variation in two dimensions, on a geological \nsurface.  \n \nOne way around this difficulty is to look at the relationship of each point to the \nadjacent points, as this is less affected by phase shifts. A mathematical function can \nbe fitted globally, that is to the entire sequence or surface of interest, or piecewise, \nthat is to a small number of adjacent measurements at a time (see Watson, 1992, \nHoulding, 1994). Piecewise fitting involves treating small parts of the section, or \nsmall patches of the surface, separately, and aggregating the results. The patches can \nbe selected in many ways, preferably in some coherent and unambiguous manner. \nOne way of creating surface patches is with Delauney triangles (see Bonham-Carter, \n1994), a unique set of evenly shaped triangular facets with a data point at each apex. \n \n \nFig. 5. Blending functions. Separate curves are fitted through the points P, Q, R and Q, R, S. They can \nbe blended into one another where they overlap by the dotted curve, which is a weighted combination \nof the other two. The weight that the blending function gives to the curve PQR varies gradually from 1 \nat Q to 0 at R, while the weight given to QRS varies from 0 at Q to 1 at R. Blending functions can also \nsmooth transitions between surface patches. \n \nA polynomial function can be fitted separately to each triangle. The simplest would be \na flat plane. The planar facets would meet at the edges of the triangles, but the abrupt \nbreaks in slope would be distracting to the eye, and would have no geological \nsignificance (section 6). A cubic function could therefore be fitted to each patch, and a \nblending function (see Watson, 1992, Foley, 1994) applied at each vertex to ensure \ncontinuity from one patch to the next (Fig. 5). This is one approach used in computer \ncontouring and in computer graphics and visualization. The finite element methods \nused by engineers for representing complex shapes adopt a similar approach, also \nincluding four-sided shapes (Lancaster and Salkauskas, 1986, or Buchanan, 1995). \nFunctions known as wavelets (Graps (1995; Strang, 1994) can similarly be fitted to \nsmall patches. They lead to an interesting analysis by measuring the fit of wavelets to \nthe surface while altering their position, amplitude and scale. There are occasions \nwhen local and regional variations are both of interest, as in trend-surface analysis, \nLoudon, T.V., 2000. Geoscience after IT: Part G  (postprint, Computers & Geosciences, 26(3A)) \n \nwhere local fitting methods can be applied to the residuals from the global trend. \nPiecewise fitting provides more detail where more is known, thus partly overcoming \nthe sampling problem.  \n \nMany algorithms work best with data spaced on a regular grid. Therefore, one method \nmay be used to interpolate from the raw data to grid points, and a different method to \nanalyze and visualize the surface based on the grid points. The drawback is that one \nartifact is then being applied to another, obscuring the link between model and reality.  \n \nOther approaches are mentioned in G 7. Principal component analysis or PCA (F 5) \ncan be applied to spatial data, including satellite images. Where quantitative \ninformation is available for each dot on the image (pixel) from each of a number of \nbands of the electromagnetic spectrum, PCA can distribute this information across a \nsmaller number of principal components that can be mapped separately. They may be \nmore readily interpreted than the original. PCA can also be applied to measurements \nof a suite of downhole logs, but is less likely to be successful. Since each of the \nlogging tools, such as the microlog and the laterolog, are measuring properties of \ndifferent volumes of rock, the results are not comparing like with like. It would not be \nclear what each of the principal components could be referring to, and the geologist\u2019s \ninsights, which stem from an understanding of the strata and the tool, would be lost. \n \n6. The fractal model \n \nA computer program can define a sequence of mathematical operations. It enables the \nscientist to express a conceptual model of a geological process. This is particularly \nsatisfying where theoretical ideas of the process match the fitted function. Not \ninfrequently, however, it turns out that the conceptual model and reality differ in \nimportant ways. For example, we may visualize geological boundaries as smooth \nsurfaces, even when we know from field observation that this is not so. Aided and \nabetted by the cartographer, we simplify by smoothing. It is inevitable that our \nrecords reflect our mental images, but smooth models can mislead and we should be \naware of their divergence from the real world (J 2.3).  \n \nMandelbrot (1982) takes as an example the question: How long is the coastline of \nGreat Britain? Faced with the question, many of us visualize a map, maybe even \nwondering what scale is appropriate. Few think of the coast itself, with its headlands, \nbeaches, boulders and breaking waves. We know that the answer must depend on a \nconceptual model, and we simplify reality in order to think about it. The more detailed \nour model, the longer the coastline seems to become. The length of a line joining the \nmain headlands might give a first approximation (see Fig. 9). However, the line \nbecomes longer without limit as we extend it to give the outline of each bay; the detail \nof each small irregularity; the outline of each sand grain; the microscopic and atomic \nstructure of the interface. The question has no single number for an answer, but leads \nto an interesting discussion of measurement techniques. A precisely defined \nconceptual model can define the distance. There is no uniquely appropriate model, \nhowever, and none that matches reality in every respect. \n \nMandelbrot pointed out that continuity, which is an essential feature of most of our \nmodels, is not typical of natural phenomena, which tend to be discontinuous at all \nscales. Continuity refers to the characteristic of a mathematical function of having \nLoudon, T.V., 2000. Geoscience after IT: Part G  (postprint, Computers & Geosciences, 26(3A)) \n \nthe possibility of creating a very small zone about a point, within which the value of \nthe function does not significantly change. On a geological surface, for example, \ncontinuity may refer to elevation, slope (rate of change of elevation), curvature (rate \nof change of slope), and so on (Fig. 6).  \n \n \n \nFig. 6. Continuity of elevation, slope and curvature. Large and sudden changes in elevation, such as \ncliff faces, are obvious when looking at a landscape. Elevations on either side of the break differ, with \nno gradual transition. Large breaks in slope and curvature (the first and second derivatives of elevation) \nmay also be apparent. Close inspection reveals similar breaks at all levels of detail. \n \nIn the natural world, we can seldom demonstrate mathematical continuity at any level. \nIt must therefore be a feature of our perception. When we look at the distant outline of \na mountain ridge, the small-scale variation is blurred, and we see an apparently \nsmooth edge against the sky. As we examine the edge, the changes in direction, \nbreaks in slope and even changing curvature catch our eye. In preparing maps and \nmodels, we therefore avoid such breaks if we know they have no geological \nsignificance. For the same reason, flat triangular facets joining data points are \ngenerally an unsatisfactory representation of a geological surface. The discontinuities \nof slope between facets draw the eye to the sampling pattern and obscure the \nunderlying geology. \n \nThe approach taken by Mandelbrot is to study a number of mathematical functions \nthat he terms fractals (Fig. 7). As well as lack of continuity, they exhibit another \nfeature of interest to geoscience. They show self-similarity, that is, the pattern created \nby the function looks the same if we enlarge a small part of the original (Fig. 8). The \nconcept is familiar to the geologist. Microfolds can mimic regional structure, and \ntrickles of water on a mud bank may form a delta like a scaled-down Mississippi. He \nextends this to self-affinity, where vertical exaggeration or other affine \ntransformations (G 4) alter the pattern. Manipulations of the fractals can produce \nimages uncannily like real islands, mountains and clouds. The functions that generate \nthem, however, are not obviously related to geological processes. \n \n \n \nFig. 7. Example of fractal function. Starting on the left of the diagram, a simple square is the initial \nobject (initiator). The object is copied and attached to the north, east, south and west sides to form a \nnew object, here reduced in scale. The same simple process (generator) is repeated, going from left to \nright, to give ever more complex objects. Reproduced by permission of David G. Green. More at \nhttp:\/\/life.csu.edu.au\/complex\/tutorials\/tutorial3.html \nLoudon, T.V., 2000. Geoscience after IT: Part G  (postprint, Computers & Geosciences, 26(3A)) \n \n \n \nFig. 8. Self-similarity of fractal. Enlarging one of the segments of this fractal fern would create another \nimage similar to this frond, and so on. Many fractal functions show this property of self-similarity over \na range of scales, as do the results of many geological processes. Reproduced by permission of David \nG. Green. More at http:\/\/life.csu.edu.au\/complex\/tutorials\/tutorial3.html \n \n \n \n \nFig. 9. Coastline and yardstick length. As the length S of the yardstick (or the span of a pair of dividers) \ndecreases, the apparent length (S \u00d7 L) of the coastline increases. Reproduced by permission of David \nG. Green. More at http:\/\/life.csu.edu.au\/complex\/tutorials\/tutorial3.html \n \nIn studying fractals, we can visualize the length of a coastline being measured by a \nhypothetical set of dividers. We measure the length of the coast by stepping the giant \npair of dividers around it. The apparent total length increases as the span of the \ndividers diminishes (Fig. 9). We can plot the resulting calculated length against the \nlength of the measuring device. The plot throws some light on the intricacy of the \nconvolutions at various resolutions. The overall slope of the plotted curve has a \nbearing on a property (the fractal dimension) of the configuration of the coastline as a \nwhole. Accounts of the numerous applications of fractals in geoscience can be found \nin journals such as Computers & Geoscience (Agterberg and Cheng, 1999) and \ntextbooks such as those by Turcotte (1992) and Barton and La Pointe (1995). \n \n7. Spatial configuration \n \nWe have looked in section 5 at the disposition of a property, at ways of describing the \ndistribution in space of its values. An obvious next step is look at the configuration, \nthat is, the spatial form and structure of the values. An important insight that \ngeologists bring to spatial data is their expectation of how knowledge of nearby \nvalues might influence prediction. The distribution of commercially exploitable \nminerals in the Earth's crust, for example, is obviously uneven. Experience and \nconcepts of formative processes guide geological expectations of their distribution. \nThe study of geostatistics (for an introduction, see Isaaks and Srivastava, 1989) \nLoudon, T.V., 2000. Geoscience after IT: Part G  (postprint, Computers & Geosciences, 26(3A)) \n \nattempts to formalize and quantify this knowledge, and then to use it with available \ndata to predict unknown values. Its roots lie in mining geology, where it offers \ntechniques, for example, for estimating ore reserves from core sample data. The \nmethods apply to estimating values at points, and also to estimating large volumes \nfrom small volumes, such as ore reserves from core samples or comparing readings \nfrom a laterolog and a microlog.  \n \nAn obvious approach to describing the configuration is to compare values at different \ndistances apart. One can then draw a graph of distance versus the similarity of values. \nThe results are not tied to one location, but make a general statement about spatial \ncorrelation within the dataset. The power spectrum (section 5) takes this approach, as \ndoes the correlogram, which shows correlation coefficients between data points at a \ngiven distance apart, plotted against that separation distance.  \n \nGeostatistics also considers the amount of change to be expected between values at \nvarious distances apart. For each separation distance, one can sample the difference in \nvalues, calculate the variance and plot it against the separation distance in a so-called \nsemi-variogram (Fig. 10). Subsequently, one can estimate the value of an unsampled \npoint on the basis of surrounding data points weighted according to the semi-\nvariogram. This process is referred to as kriging. It can take direction as well as \ndistance into account, as ore bodies, say, may be elongated, with greater variation in \none direction than another. Not surprisingly, nearby points predict unknown values \nbetter than those farther away. Thus, tightly clustered data points are all to some \nextent providing the same predictive information. Kriging therefore gives them less \nweight than more isolated data points. \n \n \nFig. 10. Variogram. A geological property varies from place to place. Its values are likely to be more \nsimilar at nearby points than at those further apart, at least over a limited range of influence. This \npattern can be quantified in a variogram, which plots the geographical distance between samples \nagainst the mean squared difference of their values. Samples taken at the same point may not give \nidentical results, and rapid change can occur over short distances (the nugget effect). \n \nThere is a major advantage in looking at the general configuration separately from the \nindividual values. The general summary is not totally dependent on the sample. The \nsample gives an indication of the likely form of the semi-variogram, but conclusions \nabout the population require geological inference. One can select a general curve that \nLoudon, T.V., 2000. Geoscience after IT: Part G  (postprint, Computers & Geosciences, 26(3A)) \n \nis compatible with the sample but takes experience of other similar situations into \naccount.  \n \n \nFig. 11. Direction cosines. The line from the origin O to the point P is of unit length. It represents the \norientation of a line parallel to OP or the pole to a plane perpendicular to OP. The cosines of the angles \nwhich OP makes with the x, y and z axes give the direction cosines l, m and n. Using Pythagoras\u2019 \ntheorem, it can be shown that l2 + m2 + n2 = OP2 = 1. The direction cosines can be treated as lengths \nwhen applying geometrical transformations, but rescaling will then be needed to ensure that their sum \nof squares is again 1. \n \nStructural geologists and geomorphologists may prefer to think of change between \nvalues at various distances apart in terms of slopes rather than differences in height. \nSlopes are easier to measure, are invariant under translation, are not limited to a single \nsurface, and relate more obviously to their conceptual model. For computer \nprocessing, slopes in two, three or more dimensions can be conveniently represented \nby direction cosines (Fig. 11) for manipulation and analysis. The subject of \ndifferential geometry (Kreyszig, 1991) is concerned with the intrinsic geometric \nproperties of surfaces, such as principal axes and lines of greatest and least curvature. \nIt offers a mathematically rigorous account of geometric features that resemble \ngeological features such as fold axes. It is relevant to considerations of shape and \nform as opposed to size and position. \n \nThese various methods can take into account detailed information from past and \npresent studies. They do not however supplant the geologist\u2019s insight into the \ngeological setting, the processes and complex relationships. Already some spatial \nmodeling programs enable geologists to input additional information about, say, the \nposition of faults. To benefit fully from the capabilities of both the computer and the \nhuman brain, interactive methods must be the way ahead. This will require the \ndevelopment of computer processes that accept interactive control by users who can \nformulate their background information in appropriate terms. In turn, this will need \ngreater appreciation by geologists of the underlying mathematical concepts. \n \nThere are many instances where it is difficult for geologists to convey their ideas with \na conventional contour map. A buried landscape might be sculpted with a pattern of \nLoudon, T.V., 2000. Geoscience after IT: Part G  (postprint, Computers & Geosciences, 26(3A)) \n \nriver valleys. One cannot place the valleys accurately on the map if elevations are \nknown only at widely spaced boreholes. There are two choices. One could contour a \nsmooth surface showing the most likely elevation of the surface based on known data, \nbut giving no indication of the detailed form of the surface. Alternatively, one could \ndraw an illustrative surface, matching the data points and between them showing the \nnature of the surface and hence its likely origin, but with the features in arbitrary and \npossibly misleading positions. In computer graphics, the process of superimposing \ntexture on a surface to make it looks more realistic is known as rendering. A \ncomputer system should offer the flexibility of separating likely position from likely \nform and shape. \n \nAnother issue arises with positioning, say, the edge of a steep-sided carbonate reef or \na vertical fault. One might know the overall geometry, but not the position of the \nfeature, which might lie anywhere between two widely spaced wells. Hand contouring \ncould lead to arbitrary positioning of the feature. Computer contouring could lead to a \nsmooth slope between the wells. But this is not realistic for a vertical feature, like \nbetting that a coin will land on its edge because heads and tails are equally probable. \nThe solution requires a clearer perception of probabilities. Probabilities cause \nproblems in hand contouring but are well suited to computer calculation. Many \ncontouring programs can provide probability envelopes, in effect indicating the most \nlikely value of a surface, and bands on either side where it is decreasingly likely to \noccur. Near the steep feature and between the two widely spaced wells, there are two \nlikely positions of the surface, separated by an improbable zone. The problem is not \ncalculating the positions but in providing a comprehensible display. An exact \ndefinition of what the contours represent, such as most likely position or most likely \nshape, and different displays showing different aspects, can make the situation clearer. \n \nSurfaces that repeat as with a thrust fault, or roll over as with a recumbent fold, are \nagain difficult to contour manually. The computer contouring procedures described \nearlier are also unable to handle them. The computer graphics solution uses \nparametric coordinates s and t (Rogers and Adams, 1976), which are drawn on the \nsurface itself, and related to the conventional coordinates (x, y and z) by polynomial \nequations. Visualization of the results may require a block diagram rather than a \nconventional contour map. \n \nIt is clearly necessary to have a wide choice of methods available for handling spatial \ndata. There is no single method appropriate to all circumstances. Geostatistics and \nspectral analysis inevitably provide different solutions to the same problem. To find \nthe best solution, the geologist must combine wide background knowledge with some \nunderstanding of the computer techniques.  \n \nIn order to provide adequate flexibility, the computer system must offer a wide range \nof processes that one can apply to the data. The data, and the general supporting \ninformation, must be managed within a flexible framework that makes it readily \navailable as and when it is required for any process. Information management is the \ntopic of part H. \n \n \n \n \nLoudon, T.V., 2000. Geoscience after IT: Part G  (postprint, Computers & Geosciences, 26(3A)) \n \n8. References \n \nAgterberg, F.P., Cheng, Q. (Eds.), 1999. Fractals and Multifractals (special issue). \nComputers & Geosciences 25 (9), 947-1099. \n \nBarton, C.C., La Pointe, P.R. (Eds.), 1995. Fractals in the Earth Sciences. Plenum \nPress, New York, 265pp. \n \nBonham-Carter, G. F., 1994. Geographic Information Systems for Geoscientists: \nModelling with GIS. Pergamon, Oxford, 398pp. \n \nBuchanan, G.R., 1995. Schaum\u2019s Outline of Theory and Problems of Finite Element \nAnalysis (Schaum\u2019s Outline Series). McGraw-Hill, New York, 264pp. \n \nFoley, J.D., 1994. Introduction to Computer Graphics. Addison-Wesley, Reading, \nMass., 559pp. \n \nF\u00f6rster, A., Merriam, D.F. (Eds.), 1996. Geologic Modeling and Mapping. Plenum, \nNew York, 334pp. \n \nGrunsky, E.C., Cheng, Q. and Agterberg, F.P., 1996. Applications of spatial factor \nanalysis to multivariate geochemical data. In F\u00f6rster, A. and Merriam, D.F. (Eds.), \nGeologic Modeling and Mapping. Plenum, New York, 334pp. \n \nHoulding, S.W., 1994. 3d Geoscience Modeling: Computer Techniques for \nGeological Characterization. Springer-Verlag, New York, 309pp. \n \nIsaaks, E.H., Srivastava, R.M., 1989. Applied Geostatistics. Oxford University Press, \nOxford, 561pp. \n \nKraak, M.-J., 1999. Visualization for exploration of spatial data. International Journal \nof Geographical Information Science, 13(4), 285-288. \n \nKreyszig, E., 1991. Differential Geometry. Dover, New York, 352pp. \n \nLancaster, P., Salkauskas,K., 1986. Curve and Surface Fitting. Academic Press, \nLondon, 280pp. \n \nMandelbrot, B. B., 1982. The Fractal Geometry of Nature. Freeman, San Francisco, \n460pp. \n \nRogers, D.F., Adams, J.A., 1976. Mathematical Elements for Computer Graphics. \nMcGraw-Hill, New York, 239pp. \n \nSnyder, J.P., 1987. Map Projection - a Working Manual. United States Geological \nSurvey Professional Paper 1395. Government Printing Office, Washington. \n \nStrang, G., 1994. Wavelets. American Scientist, 82, 250-255. \n \nLoudon, T.V., 2000. Geoscience after IT: Part G  (postprint, Computers & Geosciences, 26(3A)) \n \nLoudon, T.V., 2000. Geoscience after IT: Part G  (postprint, Computers & Geosciences, 26(3A)) \n \nTurcotte, D.L., 1992. Fractals and Chaos in Geology and Geophysics. Cambridge \nUniversity Press, Cambridge, 221pp. \n \nWatson, D.F., 1992. Contouring: a Guide to the Analysis and Display of Spatial Data. \nComputer Methods in the Geosciences, 10. Pergamon, Oxford, 321pp. \n \n \n8.1 Internet references \n \nGraps, A., 1995. Amara\u2019s wavelet page. http:\/\/www.amara.com\/current\/wavelet.html \n \nMacEachren, A.M., 1998. Visualization - cartography for the 21st century. \nInternational Cartographic Association Commission on Visualization conference, \nMay 1998, Warsaw, Poland. http:\/\/www.geog.psu.edu\/ica\/icavis\/poland1.html \n \n \n \n \n \nDisclaimer: The views expressed by the author are not necessarily those of the British \nGeological Survey or any other organization. I thank those providing examples, but should \npoint out that the mention of proprietary products does not imply a recommendation or \nendorsement of the product. \n \n \n \n<<<Back to Table of Contents       \nOn to Part H: Familiarization with managing the information base>>> \n \n"}