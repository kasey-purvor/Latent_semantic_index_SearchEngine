{"doi":"10.1109\/ICICIC.2006.448","coreId":"113803","oai":"oai:epubs.surrey.ac.uk:1937","identifiers":["oai:epubs.surrey.ac.uk:1937","10.1109\/ICICIC.2006.448"],"title":"Efficient Video Authentication for H.264\/AVC","authors":["Zhang, Jing","Ho, Anthony T. S."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2006-08-01","abstract":"<p>Traffic image sequences are important information for the purpose of traffic system control and traffic accidents surveillance, for example, the determination of offending vehicles. A semi-fragile watermarking method for the automatic authentication and restoration of traffic images using irregular sampling is described. Watermarks are embedded into the pinned field of the pinned sine transform (PST) of the original image, which reflects local malicious tampering on the texture of the image. When tampered blocks are detected, the restoration problem is formulated as an irregular sampling problem in approximation subspaces. These blocks are then reconstructed, making use of the information embedded in the same watermarked image, through iterative projections onto convex sets in approximation subspaces. The restoration process is a variant of the Papoulis- Gerchberg algorithm, and is robust to common image processing operations such as lossy transcoding and image filtering. <\/p","downloadUrl":"","fullTextIdentifier":null,"pdfHashValue":null,"publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:epubs.surrey.ac.uk:1937<\/identifier><datestamp>\n      2017-10-31T14:03:43Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      74797065733D636F6E666572656E63655F6974656D<\/setSpec><setSpec>\n      6469766973696F6E733D656E67616E64706879736963616C736369656E636573:436F6D707574696E67<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/epubs.surrey.ac.uk\/1937\/<\/dc:relation><dc:title>\n        Efficient Video Authentication for H.264\/AVC<\/dc:title><dc:creator>\n        Zhang, Jing<\/dc:creator><dc:creator>\n        Ho, Anthony T. S.<\/dc:creator><dc:description>\n        <p>Traffic image sequences are important information for the purpose of traffic system control and traffic accidents surveillance, for example, the determination of offending vehicles. A semi-fragile watermarking method for the automatic authentication and restoration of traffic images using irregular sampling is described. Watermarks are embedded into the pinned field of the pinned sine transform (PST) of the original image, which reflects local malicious tampering on the texture of the image. When tampered blocks are detected, the restoration problem is formulated as an irregular sampling problem in approximation subspaces. These blocks are then reconstructed, making use of the information embedded in the same watermarked image, through iterative projections onto convex sets in approximation subspaces. The restoration process is a variant of the Papoulis- Gerchberg algorithm, and is robust to common image processing operations such as lossy transcoding and image filtering. <\/p><\/dc:description><dc:date>\n        2006-08-01<\/dc:date><dc:type>\n        Conference or Workshop Item<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/epubs.surrey.ac.uk\/1937\/1\/fulltext.pdf<\/dc:identifier><dc:identifier>\n          Zhang, Jing and Ho, Anthony T. S.  (2006) Efficient Video Authentication for H.264\/AVC  In: First International Conference on Innovative Computing, Information and Control - Volume I (ICICIC'06).     <\/dc:identifier><dc:relation>\n        10.1109\/ICICIC.2006.448<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/epubs.surrey.ac.uk\/1937\/","10.1109\/ICICIC.2006.448"],"year":2006,"topics":[],"subject":["Conference or Workshop Item","PeerReviewed"],"fullText":"Efficient Video Authentication for H.264\/AVC\nJing Zhang\nSchool of Electrical and Electronic Engineer\nNanyang Technology University\n639798 Singapore\njingzjang@pmail.ntu.edu.sg\nAnthony T. S. Ho\nSchool of Electronics and Physical Sciences\nUniversity of Surrey\nGuildford, Surrey, GU2 7XH, UK\nA.Ho@surrey.ac.uk\nAbstract\nThis paper proposed a novel and efficient scheme to au-\nthenticate the H.264\/AVC video. The scheme makes an\naccurate usage of the tree-structured motion compensa-\ntion, motion estimation and Lagrangian optimization of the\nstandard. Authentication information is embedded strictly\nbased on the best mode decision strategy in the sense that if\nundergone any spatial and temporal attacks, the scheme can\ndetect the tampering by the sensitive mode change. And the\nexperimental results prove the effectiveness the algorithm\nagainst many transcoding and signal processing attacks.\n1. Introduction\nDigital multimedia Authentication techniques have wit-\nnessed a tremendous rise in interest over the past few years.\nIn multimedia context, video authentication aims to estab-\nlish its veracity in time, sequence and content. A video au-\nthentication system ensures the integrity of digital video,\nand verifies that the video taken into use has not been tam-\npered.\nIn the past, several techniques and concepts based on\ndata hiding have been introduced for tamper detection in\ndigital images and video. One class of authentication wa-\ntermarks is Hard Authentication [5]. Hard Authentication\nrejects any modifications to multimedia content. The in-\nserted watermark is so weak that any manipulations to the\nmultimedia content disturbs its integrity.\nAlthough the concepts of hard authentication have been\nwell studied, there are not many research works dealing\nwith authenticating the H.264\/AVC standard. With many\nemerging technologies, H.264\/AVC has achieved a signif-\nicant improvement in the enhanced compression perfor-\nmance, providing a factor of two in bit-rate savings when\ncompared with existing standards such as MPEG-2 video\n[3]. However, whole new challenges and associated trade-\noffs need to be considered for watermarking H.264\/AVC\ndata. With the exhaustive investigation of the H.264\/AVC\nstandard, we develop a novel and efficient watermarking al-\ngorithm for authentication in the compressed domain. The\nscheme makes an accurate usage of the tree-structured mo-\ntion compensation, motion estimation and Lagrangian opti-\nmization for mode decision. The authentication information\nis represented by a binary watermark sequence and embed-\nded into video frames. And the experimental results prove\nthe effectiveness the algorithm.\nThe rest of this paper is organized as follows. Sec-\ntion 2 provides the reader with related techniques of the\nH.264\/AVC standard. Section 3 gives a detailed explana-\ntion of the H.264 hard authentication algorithm. Some ex-\nperimental results of the developed algorithm are covered\nin Section 4. Section 5 concludes the paper with the outline\nof future work.\n2 Investigation of Best Mode\n2.1 Tree-structured Motion Compensa-\ntion\nSignificant differences of the H.264\/AVC standard from\nearlier standards include the support for a range of block\nsizes (from 16 \u00d7 16 down to 4 \u00d7 4) for prediction and fine\nsub-sample motion vectors (quarter-sample resolution in the\nluma component).\nFigure 1. Macroblock partition modes: 16\u00d716,\n8\u00d7 16, 16\u00d7 8, 8\u00d7 8\nProceedings of the First International Conference on Innovative Computing, Information and Control (ICICIC'06)\n0-7695-2616-0\/06 $20.00  \u00a9 2006\nFigure 2. Sub-macroblock partition modes:\n8\u00d7 8, 4\u00d7 8, 8\u00d7 4, 4\u00d7 4\n16x16 8x16 8x16\n8x8  8x8\n8x8  8x8\n(a) mode 16x16 (b) mode 8x16 (c) mode 8x8\nwith 4 sub-\nmodes 8x8\n(d) mode 8x8\nwith sub-\nmodes 4x4,\n8x4, 8x4 &\n4x8\n16\n16\n8\n4x4 4x4\n4x4 4x4\n8x4\n8x4\n8x4\n8x4\n4x8 4x8 \nFigure 3. examples of partition modes using\nthe tree-structured motion compensation\nThe luma component of each macroblock may be split up\nand motion compensated in four ways as shown in Figure 1.\nIn cases where the 8 \u00d7 8 partition mode is chosen, each of\nthe four 8 \u00d7 8 sub-macroblocks within the macroblock can\nbe further split up in four ways as shown in Figure 2. This\nmethod is known as tree-structured motion compensation\n[4]. In general, a large partition mode is appropriate for\nhomogeneous areas of the frame and a small partition mode\nmay be beneficial for detailed areas. Figure 3 shows four\nmacroblocks with different partition modes.\nThe best mode I\u2217 for a macroblock S is selected by\nminimizing the expression in Equation (1) within the con-\nstrained R and minimized D, using Lagrangian Optimiza-\ntion technique [1] of H.264\/AVC, among all possible modes\n(denoted by I):\nI\u2217 = arg min\nIc\u2208I\n(\nD(S, Ic) + \u03bbR(S, Ic)\n)\n(1)\nwhere \u03bb denotes the predetermined Lagrangian multiplier\nfor mode choice, and D and R represent the distortion and\nconsumed bits for encoding the current mode Ic, respec-\ntively. Figure 1 shows one frame of Foreman and the parti-\ntion mode selection map.\n2.2 Partition Mode Change\nFor each macroblock, the H.264 encoder selects the best\npartition mode among all possible partition modes that min-\n1\n2\n3\n4\n5\n6\n7\n8\n9\n1 2 3 4 5 6 7 8 9 10 11 \n(a) mode map of the original\nframe\n1\n2\n3\n4\n5\n6\n7\n8\n9\n1 2 3 4 5 6 7 8 9 10 11 \n(b) mode map of the recom-\npressed frame\nFigure 4. Foreman\u2019s partition mode selection:\n(a) of the original coded B-frame, (b) of the\nrecompressed B-frame.\nimizes the amount of information to be coded and sent. Fig-\nure 4. (b) shows the same frame as in Figure 4. (a) and\nthe new partition mode selection map after recompression.\nFrom these two figures, the best partition modes of many\nmacroblocks are not the same. For example, for the fourth\nmacroblock in the second row, due to recompression, its\nbest mode changes from 8\u00d7 16 to 16\u00d7 16. For some mac-\nroblocks, even if their best modes are the same, the infor-\nmation may be different. Thus the DCT coefficients may\nnot be the same.\n3 Proposed Watermarking Method\n3.1 Embedding\nOur algorithm is developed for the inter-predicted slices:\nP- and B-slices. As mentioned before, the encoder needs\nto find the best partition mode for each macroblock, as dif-\nferent modes will produce different sets of bit-rate and dis-\ntortion to the video stream. The encoder will go through\nthe motion estimation and compensation, transformation,\nquantization and entropy coding for all possible partition\nmodes, and the Lagrangian optimization technique deter-\nmines which partition mode has the lowest rate-distortion\nrelated cost in Equation (1). Only when the minimum cost\nis attained, the encoder will allocate the corresponding par-\ntition mode as the best mode to the macroblock. Through\ncareful observation of the mode decision scheme, it can be\ncertain that in region where there is no motion (such as\nbackground), a partition mode of 16 \u00d7 16 is chosen by the\nencoder. In areas where there is a lot of detailed motion,\nsmaller partition modes prove to be more efficient.\nTherefore, by using the mode decision scheme of the\nProceedings of the First International Conference on Innovative Computing, Information and Control (ICICIC'06)\n0-7695-2616-0\/06 $20.00  \u00a9 2006\nencoder, we could implement our watermarking algorithm\ntargeting at higher motion activities macroblocks with the\nbest mode 8 \u00d7 8 (with four sub-modes chosen from 4 \u00d7 4,\n8 \u00d7 4, 8 \u00d7 4 and 8 \u00d7 8). By choosing these smaller parti-\ntion modes, it is difficult for the Human Visual System to\ndetect the differences, or the distortions introduced by the\nwatermark embedding scheme.\nFor example, in one run of the iterative mode decision\nprocedure for a macroblock S, if the current prediction\nmode Ic is 8\u00d7 8 (with four sub-modes 4\u00d7 4, 8 \u00d7 4, 8\u00d7 4\nand 4 \u00d7 8) (Figure 3(d)), the watermark components are\nembedded, starting with the 10th coefficient. As the coeffi-\ncients represent the residual to code, all zero coefficients\nare avoided to prevent the video from getting badly dis-\ntorted. The nonzero quantized DCT coefficients D(u, v)\nare replaced by the watermark components wi, i \u2208 N (N is\nthe number of nonzero coefficients):\nD(u, v) = wi + 1 (2)\nwhere wi is the binary authentication watermark (a pseudo-\nrandom sequence).\nIn the H.264\/AVC standard, the encoder will first carry\nout the motion estimation and mode decision for modes\n16 \u00d7 16, 16 \u00d7 8 and 8 \u00d7 16, for the unitary macroblock,\nand compute the corresponding rate-distortion related costs\nin Equation (1). After big partition modes, the encoder will\napply the motion estimation and mode decision for mode\n8\u00d7 8 with the sub-modes 4\u00d7 4, 8\u00d7 4, 8\u00d7 4 and 8\u00d7 8, for\nfour 8 \u00d7 8 sub-blocks. Suppose 6 watermark components\nare embedded, so the last watermark to be embedded is the\n15th coefficient.\nAfter embedding watermark component wi into all the\navailable modes (denoted by I), the best mode I\u2217 for the\nmarked macroblock Sm is selected by minimizing the ex-\npression in Equation (1):\nI\u2217 = arg min\nIc\u2208I\n(\nD(Sm, Ic) + \u03bbR(Sm, Ic)\n)\n(3)\nwhere \u03bb, D and R have the same meanings as in Equation\n(1).\nAfter all possible modes are tested for the minimum\nrate-distortion cost of the current macroblock, the encoder\nchecks whether the partition mode 8\u00d78 with the 4 sub-mode\n4\u00d7 4, 8\u00d7 4, 8\u00d7 4 and 4\u00d7 8 has the minimum cost. In case\nthis is the best partition mode I\u2217, a counter of watermark\nsequence will be updated. And the beginning watermark\ncomponent for the next macroblock will be the 16th com-\nponent. However, if the rate-distortion cost is not minimal,\nthe watermark sequence will have to redo the embedding.\nThat is, the algorithm will have to embed the watermark\ncomponents started from 10th coefficient again, when the\nencoder checks the rate-distortion cost of the next partition\nmode.\n(a) Stefan (b) News\nFigure 5. Comparison of the rate-distortion\nperformance for H.264 encoding without wa-\ntermark (\u25e6) and with watermark (\u00d7).\n3.2 Extraction\nDuring decoding a macroblock, only if the best mode is\n8\u00d78, all the nonzero quantized DCT coefficients (level val-\nues of entropy coding) are extracted to form the watermark\nsequence for authentication in a 1-D order. The extracted\nwatermark sequence is compared to the original authentica-\ntion watermark information to check if the video has been\ntampered.\n4 Experiments and Results\nThe proposed watermarking technique has been inte-\ngrated into the H.264 JM-9.0 reference software [2]. The\nvideo sequences: Foreman, Stefan, Coastguard, Mobile,\nBus, Football and News are used in the experiments. All\nvideo clips are coded in CIF format (352 \u00d7 288 pixels) at\nthe frame rate 30 frames\/s at the bit-rate 512 kbit\/s. The\nGOP structure comprises IBPBP\u00b7 \u00b7 \u00b7, compliant to the Main\nProfile of H.264\/AVC. A binary watermark sequence with\n150 bits is used as the authentication information for our\nexperiments.\nFigure 5 compares the rate-distortion performance of the\nH.264 encoder without watermarking and with watermark-\ning. All tests are performed with fixed quantization param-\neters. The unmarked and marked video clips are recon-\nstructed from the compressed data without and with water-\nmarks, respectively. The average PSNR values are com-\nputed by comparing the reconstructed video frames to the\noriginal raw video frames.\nTwo categories of video attacks have been applied to the\nmarked video to test the sensitivity of the authentication al-\ngorithm: transcoding and common signal processing pro-\ncesses.\nProceedings of the First International Conference on Innovative Computing, Information and Control (ICICIC'06)\n0-7695-2616-0\/06 $20.00  \u00a9 2006\n(a) Bit-rate\/frame-rate\/bit-\nrate + frame-rate reduction\n(b) Frame Reordering and\nreplacing\n(c) 3\u00d73 Gaussian filter and\nCirucal averaging filter\n(d) Contrast enhancing fil-\nter and Gaussian Noise\nFigure 6. Sensitivity under transcoding and\ncommon signal processing on Foreman, Mo-\nbile, News, Bus, Football, Stefan and Coastguard\n(denoted by For, Mo, Ne, Bu, Foo, St and Co in\nthe horizontal axis, respectively) (512 kbit\/s,\nCIF-size).\nIn the first group, we utilized the bit-rate reduction (re-\nducing to approximately the 1\/2 of the original bit-rates),\nframe-rate reduction (from 30 to 15 frames\/s), frame re-\nordering, and frame replacing. After decoding the marked\nbitstream, common signal processing attacks are applied to\nthe raw video frame by frame, including 3 \u00d7 3 Gaussian\nlow-pass filtering, circular averaging filtering, unsharpened\ncontrast enhancement, additive Gaussian noise (mean=0,\nvariance= 0.001).\nThe authentication security of our watermarking algo-\nrithm is represented by the sensitivity against attacks. The\nstandard normalized correlation values of the original and\nextracted watermark sequences are measured and shown in\nFigure 6, with the dynamic range from \u22121 to 1. From these\ntwo figures, almost all the correlation values are less then 0.\nOne special attack, the cutting and pasting attack is also\napplied to test the security of our authentication system. For\nexample, the 8\u00d748 square of DVC characters in the bottom\n(a) Watermarked (b) undergone cutting and\npasting\nFigure 7. The watermarked and the attacked\nBus under cutting and pasting attack.\nright corner of the Bus frame is cut and replaced as shown\nin Figure 7: our algorithm shows the significant sensitivity\nat the average correlation value equal to -0.261.\n5 Conclusions\nThe proposed hard authentication algorithm performed\nwell in terms of sensitivity against transcoding and com-\nmon signal processing. The watermarked H.264\/AVC video\nclips maintained the good visual quality and almost the\nsame Bit-rate. However our algorithm lacks the ability to\nprovide further information necessary to characterize the at-\ntack. Therefore, the future work will focus on enhancing the\nproposed algorithm by localizing the attacked areas.\nReferences\n[1] A. Joch, F. Kossentini, H. Schwarz, T. Wiegand, and G. J.\nSullivan. Performance comparison of video coding standards\nusing Lagrangian coder control. Proc. IEEE Int. Conf. Image\nProcessing, 4:IV\u20133728\u2013IV\u20133731, 2002.\n[2] Oinline. H.264\/avc joint model 9.0 (jm-9.0)\nreference software, available: ftp:\/\/imtc.org\/jvt-\nexports\/reference software\/.\n[3] T. Wiegang, H. Schwarz, A. Joch, F. Kossentini, and G. J.\nSullivan. Rate-contrained coder control and compression of\nvideo coding standard. IEEE Trans. Circuits Syst. Video\nTechnol., 13(7):688\u2013703, 2003.\n[4] T. Wiegang, G. J. Sullivan, G. Bjontegaard, and A. Luthra.\nOverview of the h.264\/avc video coding standard. IEEE\nTrans. Circuits Syst. Video Technol., 13(7):560\u2013576, 2003.\n[5] B. B. Zhu, M. D. Swanson, and A. H. Tewfik. When seeing\nisn\u2019t believing. IEEE Signal Processing Magazine, 2004.\nProceedings of the First International Conference on Innovative Computing, Information and Control (ICICIC'06)\n0-7695-2616-0\/06 $20.00  \u00a9 2006\n"}