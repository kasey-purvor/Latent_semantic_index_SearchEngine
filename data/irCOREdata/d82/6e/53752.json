{"doi":"10.1109\/TEC.2010.2051811","coreId":"53752","oai":"oai:eprints.lincoln.ac.uk:2899","identifiers":["oai:eprints.lincoln.ac.uk:2899","10.1109\/TEC.2010.2051811"],"title":"Methods of resistance estimation in permanent magnet synchronous motors for real-time thermal management","authors":["Wilson, S. D.","Stewart, Paul","Taylor, B. P."],"enrichments":{"references":[{"id":842350,"title":"(M\u20192000-SM\u20192004) was born in Birmingham, England in 1960. He received the B.Eng and Ph.D degrees in electronic, control and systems engineering from the University of Shef\ufb01eld UK,","authors":[],"date":"2007","doi":null,"raw":"Paul Stewart Paul Stewart (M\u20192000-SM\u20192004) was born in Birmingham, England in 1960. He received the B.Eng and Ph.D degrees in electronic, control and systems engineering from the University of Shef\ufb01eld UK, in 1996 and 2000 respectively. He became Assistant Professor in Electronic and Electrical Engineering in the Machines and Drives Group at the University of Shef\ufb01eld in 2002, and Associate Professor in 2007. He is currently Founding Head of Engineering at the University of Lincoln. His research interests are in multiobjective optimisation and intelligent control with automotive and aeronautic applications.","cites":null},{"id":839094,"title":"A new \ufb02ux and stator resistance identi\ufb01er for ac drive systems,\u201d","authors":[],"date":"1996","doi":"10.1109\/28.502170","raw":"[4] R. Kerkman, B. Seibel, T. Rowan, and D. Schlegel, \u201cA new \ufb02ux and stator resistance identi\ufb01er for ac drive systems,\u201d IEEE Trans. Ind. Appl., vol. 32, no. 3, pp. 585\u2013593, May\/Jun. 1996.","cites":null},{"id":839760,"title":"A stator resistance estimation scheme for speed sensorless rotor \ufb02ux oriented induction motor drive,\u201d","authors":[],"date":"2003","doi":"10.1109\/tec.2003.816595","raw":"[8] V. Vasic, S. Vukosavic, and E. Levi, \u201cA stator resistance estimation scheme for speed sensorless rotor \ufb02ux oriented induction motor drive,\u201d IEEE Trans. Energy Convers., vol. 18, no. 4, pp. 476\u2013482, Dec. 2003.","cites":null},{"id":838879,"title":"An integrated on-line motor protection system,\u201d","authors":[],"date":"1996","doi":"10.1109\/2943.485759","raw":"[3] S. Farag, R. Bartheld, and T. Habetler, \u201cAn integrated on-line motor protection system,\u201d IEEE Trans. Ind. Appl., vol. 2(2), pp. 21\u20136, Mar.\/Apr. 1996.","cites":null},{"id":840683,"title":"An online stator winding resistance estimation technique for temperature monitoring of line connected induction machines,\u201d","authors":[],"date":"2003","doi":"10.1109\/TIA.2003.811789","raw":"[13] S. Lee and T. Habetler, \u201cAn online stator winding resistance estimation technique for temperature monitoring of line connected induction machines,\u201d IEEE Trans. Ind. Appl., vol. 39, no. 3, pp. 685\u2013694, May\/Jun. 2003.","cites":null},{"id":841610,"title":"Analysis of three-phase surfacemounted magnet modular permanent magnet machines,\u201d","authors":[],"date":"1990","doi":"10.1049\/cp:20040411","raw":"[17] S. D. Stearns and D. R. Hush, Digital Signal Analysis, 2nd ed. PrenticeHall, 1990, p. 157. [18] J. Wang, Z. .Xia, and D. Howe, \u201cAnalysis of three-phase surfacemounted magnet modular permanent magnet machines,\u201d IEEE Trans.","cites":null},{"id":841863,"title":"Analytical prediction of dynamic performance characteristics of brushless dc drives,\u201d","authors":[],"date":"1992","doi":"10.1080\/07313569208909626","raw":"[19] Z. Zhu, D. Howe, and B. Ackermann, \u201cAnalytical prediction of dynamic performance characteristics of brushless dc drives,\u201d Electric Machines and Power Systems, vol. 20, no. 6, pp. 661\u2013678, 1992.","cites":null},{"id":842073,"title":"Delamere Wilson was born in Chester, Cheshire, England in 1979. He received the M.Eng degree in Electrical Engineering from the University of Shef\ufb01eld,","authors":[],"date":"2004","doi":null,"raw":"Simon Delamere Wilson was born in Chester, Cheshire, England in 1979. He received the M.Eng degree in Electrical Engineering from the University of Shef\ufb01eld, UK, in 2004 and his PhD from the same institution in 2009. Since 2007, he has been a Consultant in the New Energy Technologies department at EA Technology, Capenhurst, Chester. His research interests include power electronics, drive systems and renewable energy and energy ef\ufb01ciency.","cites":null},{"id":841332,"title":"Dynamic model tracking design for low inertia, high speed permanent magnet ac motors,\u201d","authors":[],"date":"2004","doi":"10.1016\/S0019-0578(07)60024-X","raw":"[16] P. Stewart and V. Kadirkamanathan, \u201cDynamic model tracking design for low inertia, high speed permanent magnet ac motors,\u201d ISA Transactions, vol. 43, no. 1, pp. 111\u201322, Jan. 2004.","cites":null},{"id":841109,"title":"Electric Machinery.","authors":[],"date":"2003","doi":null,"raw":"[15] A. Fitzgerald, J. Charles Kingsley, and S. D. Umans, Electric Machinery. McGraw-Hill, 2003.","cites":null},{"id":838656,"title":"Failure modes and \ufb01eld testing of medium-voltage motor windings,\u201d","authors":[],"date":"2002","doi":"10.1109\/tia.2002.802913","raw":"[2] R. Gleichman, \u201cFailure modes and \ufb01eld testing of medium-voltage motor windings,\u201d IEEE Trans. Ind. Appl., vol. 38, no. 5, pp. 1473\u20131476, Sep.\/Oct. 2002.","cites":null},{"id":840460,"title":"Mechanical sensorless control of pmsm with online estimation of stator resistance,\u201d","authors":[],"date":"2004","doi":"10.1109\/tia.2004.824490","raw":"[11] B. Nahid-Mobarakeh, F. Meibody-Tabar, and F.-M. Sargos, \u201cMechanical sensorless control of pmsm with online estimation of stator resistance,\u201d IEEE Trans. Ind. Appl., vol. 40(2), pp. 457\u201371, Mar.\/Apr. 2004. [12] P. Milanfar and J. H. Lang, \u201cMonitoring the thermal condition of permanent-magnet synchronous motors,\u201d IEEE Trans. Aerosp. Electron.","cites":null},{"id":839301,"title":"Neural-network-based model reference adaptive systems for high performance motor drives and motion controls,\u201d","authors":[],"date":"2002","doi":"10.1109\/tia.2002.1003444","raw":"[5] M. Elbuluk, L. Tong, and I. Hussain, \u201cNeural-network-based model reference adaptive systems for high performance motor drives and motion controls,\u201d IEEE Trans. Ind. Appl., vol. 38, no. 3, pp. 879\u2013886, Jun. 2002.10 TABLE II SYMBOL TABLE Symbol Parameter \u03b1 Temperature coef\ufb01cient of copper \u03b2 Regulation factor \u2206 Change in a parameter \u03b8 Electrical rotor position \u03b8F Angle of injected current vector (elec) \u03b8L Angle of resistive voltage in stator frame (elec) \u03b8m Mechanical rotor position (mech) \u03b8R Angle of inductive voltage in stator frame (elec) \u03b8qds Angle of resistive and inductive voltage in stator frame (elec) \u03c9 Electrical frequency \u03c9m Mechanical (shaft) frequency B Blackman window function B2 Modi\ufb01ed Blackman window function F Magnitude of injected current vector ia Phase-A current ib Phase-B current ic Phase-C current idr D-axis current, rotor reference frame iqr Q-axis current, rotor reference frame ids D-axis current, stator reference frame iqs Q-axis current, stator reference frame kd Coef\ufb01cient for D-axis EMF harmonics kq Coef\ufb01cient for D-axis EMF harmonics Ke EMF constant Kt Torque constant Ld D-axis inductance Lq Q-axis inductance Ninj Number of injected current pulses PFA Power dissipation for \ufb01xed-angle method PFM Power dissipation for \ufb01xed-magnitude method Rs Stator resistance Rs0 Stator winding resistance at reference temperature S0 Zero-sequence quantity Sa Phase-A quantity Sb Phase-B quantity Sc Phase-C quantity Sd D-axis quantity, rotor reference frame Sq Q-axis quantity, rotor reference frame T0 Reference temperature Tel Elapsed time between injected pulses Tem Electromagnetic torque Ti Duration of current injection pulse Ts Stator winding temperature Tw Time-period of the window function vidr D-Axis voltage caused by current injection viqr Q-axis voltage caused by current injection vdr D-axis voltage, rotor reference frame vqr Q-axis voltage, rotor reference frame VL Magnitude of inductive voltage VR Magnitude of resistive voltage Vqds Magnitude of resistive and inductive voltage in stator frame [6] J. Campbell and M. Sumner, \u201cAn arti\ufb01cial neural network for stator resistance estimation in a sensorless vector controlled induction motor drive,\u201d 9th European Conference on Power Electronics and Applications, vol. 2001, Graz, Austria Aug.","cites":null},{"id":840843,"title":"On-line estimation of the stator resistance of induction machines based on zero sequence model,\u201d","authors":[],"date":"2000","doi":"10.1109\/63.838107","raw":"[14] C. Jacobina, J. Filha, and A. Lima, \u201cOn-line estimation of the stator resistance of induction machines based on zero sequence model,\u201d IEEE Trans. Power Electron., vol. 15, no. 2, pp. 346\u2013352, Mar. 2000.","cites":null},{"id":839538,"title":"Online estimation of stator resistance of an induction motor for speed control applications,\u201d","authors":[],"date":"1995","doi":"10.1049\/ip-epa:19951568","raw":"[7] L. Umanand and S. Bhat, \u201cOnline estimation of stator resistance of an induction motor for speed control applications,\u201d IEE Proc.-Electr. Power Appl., vol. 142, no. 2, pp. 97\u2013103, Mar. 1995.","cites":null},{"id":840235,"title":"Online stator resistance estimation for thermal monitoring of converter fed induction motors using pseudorandom modi\ufb01ed pwm,\u201d","authors":[],"date":"2004","doi":"10.1109\/ias.2004.1348495","raw":"[10] L. C. Benn, B. Burton, and R. G. Harley, \u201cOnline stator resistance estimation for thermal monitoring of converter fed induction motors using pseudorandom modi\ufb01ed pwm,\u201d in Conference Record of the 2004 IEEE Industry Applications Conference. 39th IAS Annual Meeting, Oct. 2004, pp. 727\u201334.","cites":null},{"id":839995,"title":"Quasi-fuzzy estimation of stator resistance of induction motor,\u201d","authors":[],"date":"1998","doi":"10.1109\/63.668097","raw":"[9] B. Bose and N. Patel, \u201cQuasi-fuzzy estimation of stator resistance of induction motor,\u201d IEEE Trans. Power Electron., vol. 18, no. 4, pp. 401\u2013 409, May 1998.","cites":null},{"id":842559,"title":"received the M.Eng degree in electronic engineering (communications) from the University of Shef\ufb01eld,","authors":[],"date":"1998","doi":null,"raw":"Ben Taylor received the M.Eng degree in electronic engineering (communications) from the University of Shef\ufb01eld, Shef\ufb01eld, UK, in 1998. Currently, he is employed as a research associate in the Department of Automatic Control and Systems Engineering, at the University of Shef\ufb01eld, working on power systems modelling for more electric aircraft platforms. His research interests also include power electronics, machine control and energy scavenging systems.","cites":null},{"id":838454,"title":"Root cause ac motor failure analysis,\u201d","authors":[],"date":"2000","doi":"10.1109\/28.871294","raw":"[1] A. H. Bonnet, \u201cRoot cause ac motor failure analysis,\u201d IEEE Trans. Ind. Appl., vol. 36, no. 5, pp. 1435\u20131448, Sep.\/Oct. 2000.","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2010-08-12","abstract":"Real-time thermal management of electrical ma- chines relies on sufficiently accurate indicators of internal tem- perature. One indicator of temperature in a permanent-magnet synchronous motor (PMSM) is the stator winding resistance. Detection of PMSM winding resistance in the literature has been made on machines with relatively high resistances, where the resistive voltage vector is significant under load. This paper describes two techniques which can be applied to detect the winding resistance, through \u2018Fixed Angle\u2019 and \u2018Fixed Mag- nitude\u2019 current injection. Two further methods are described which discriminate injected current and voltages from motoring currents and voltages: \u2018Unipolar\u2019 and \u2018Bipolar\u2019 separation. These enable the resistance to be determined, and hence the winding temperature in permanent-magnet machines. These methods can be applied under load, and in a manner that does not disturb motor torque or speed. The method distinguishes between changes in the electro-motive force (EMF) constant and the resistive voltage. This paper introduces the techniques, whilst a companion paper covers the application of one of the methods to a PMSM drive system","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/53752.pdf","fullTextIdentifier":"http:\/\/eprints.lincoln.ac.uk\/2899\/1\/Methods.pdf","pdfHashValue":"ccd89eba4cf6e835e623c1d575001d11c9421244","publisher":"Institution of Electronic and Electrical Engineers IEEE","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lincoln.ac.uk:2899<\/identifier><datestamp>\n      2013-12-04T16:54:52Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D6A6163735F48:6A6163735F48363030<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/eprints.lincoln.ac.uk\/2899\/<\/dc:relation><dc:title>\n        Methods of resistance estimation in permanent magnet synchronous motors for real-time thermal management<\/dc:title><dc:creator>\n        Wilson, S. D.<\/dc:creator><dc:creator>\n        Stewart, Paul<\/dc:creator><dc:creator>\n        Taylor, B. P.<\/dc:creator><dc:subject>\n        H600 Electronic and Electrical Engineering<\/dc:subject><dc:description>\n        Real-time thermal management of electrical ma- chines relies on sufficiently accurate indicators of internal tem- perature. One indicator of temperature in a permanent-magnet synchronous motor (PMSM) is the stator winding resistance. Detection of PMSM winding resistance in the literature has been made on machines with relatively high resistances, where the resistive voltage vector is significant under load. This paper describes two techniques which can be applied to detect the winding resistance, through \u2018Fixed Angle\u2019 and \u2018Fixed Mag- nitude\u2019 current injection. Two further methods are described which discriminate injected current and voltages from motoring currents and voltages: \u2018Unipolar\u2019 and \u2018Bipolar\u2019 separation. These enable the resistance to be determined, and hence the winding temperature in permanent-magnet machines. These methods can be applied under load, and in a manner that does not disturb motor torque or speed. The method distinguishes between changes in the electro-motive force (EMF) constant and the resistive voltage. This paper introduces the techniques, whilst a companion paper covers the application of one of the methods to a PMSM drive system.<\/dc:description><dc:publisher>\n        Institution of Electronic and Electrical Engineers IEEE<\/dc:publisher><dc:date>\n        2010-08-12<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/eprints.lincoln.ac.uk\/2899\/1\/Methods.pdf<\/dc:identifier><dc:identifier>\n          Wilson, S. D. and Stewart, Paul and Taylor, B. P.  (2010) Methods of resistance estimation in permanent magnet synchronous motors for real-time thermal management.  IEEE Transactions on Energy Conversion, 25  (3).   pp. 698-707.  ISSN 0885-8969  <\/dc:identifier><dc:relation>\n        http:\/\/dx.doi.org\/10.1109\/TEC.2010.2051811<\/dc:relation><dc:relation>\n        10.1109\/TEC.2010.2051811<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/eprints.lincoln.ac.uk\/2899\/","http:\/\/dx.doi.org\/10.1109\/TEC.2010.2051811","10.1109\/TEC.2010.2051811"],"year":2010,"topics":["H600 Electronic and Electrical Engineering"],"subject":["Article","PeerReviewed"],"fullText":"1Methods of Resistance Estimation in Permanent\nMagnet Synchronous Motors for Real-Time\nThermal Management\nSimon D. Wilson, Paul Stewart Senior Member, IEEE, and Benjamin P. Taylor\nAbstract\u2014Real-time thermal management of electrical ma-\nchines relies on sufficiently accurate indicators of internal tem-\nperature. One indicator of temperature in a permanent-magnet\nsynchronous motor (PMSM) is the stator winding resistance.\nDetection of PMSM winding resistance in the literature has been\nmade on machines with relatively high resistances, where the\nresistive voltage vector is significant under load. This paper\ndescribes two techniques which can be applied to detect the\nwinding resistance, through \u2018Fixed Angle\u2019 and \u2018Fixed Mag-\nnitude\u2019 current injection. Two further methods are described\nwhich discriminate injected current and voltages from motoring\ncurrents and voltages: \u2018Unipolar\u2019 and \u2018Bipolar\u2019 separation. These\nenable the resistance to be determined, and hence the winding\ntemperature in permanent-magnet machines. These methods\ncan be applied under load, and in a manner that does not\ndisturb motor torque or speed. The method distinguishes between\nchanges in the electro-motive force (EMF) constant and the\nresistive voltage. This paper introduces the techniques, whilst\na companion paper covers the application of one of the methods\nto a PMSM drive system.\nIndex Terms\u2014Resistance measurement, temperature measure-\nment, temperature control, parameter estimation.\nI. INTRODUCTION\nBRUSHLESS permanent-magnet machines have emergedas the preferred electrical machine technology for many\napplications due to their high specific power and efficiencies.\nIn common with other types of electrical machine, their output\npower is usually limited by the maximum operating tempera-\nture of key machine components [1]. Of particular significance\nare the lifetime of coil insulation which reduces markedly\nbeyond the manufacturers specified temperature rating [2], and\nthe diminishing magnetic properties of the permanent magnets.\nTo ensure that the maximum temperature limit is not exceeded\nduring service, it is common practice to design a machine on\nthe basis of a worst-case estimate of the operating conditions,\nwhich amongst over things, should account for the highest\nanticipated ambient temperature, worst-case load conditions\nAt the time of this research the authors were with the Electrical Machines\nand Drives Research Group, The University of Sheffield, Mappin Street, S1\n3JD, U.K. S.D. Wilson is now with EA Technology, Capenhurst Technology\nPark, Capenhurst, CH1 6ES. Paul Stewart is now with the Univeristy of\nLincoln (e-mail: simon.wilson@eatechnology.com; pstewart@lincoln.ac.uk;\nb.p.taylor@shef.ac.uk).\nS.D. Wilson was supported by a grant from the \u2018Engineering and Physical\nSciences Research Council\u2019 (EPSRC) and a \u2018Co-operative Awards in Science\nand Engineering\u2019 (CASE) award provided by Rolls-Royce PLC. Technical\nsupport, and the hardware used in this research was provided by the EPSRC\nProject \u2018Zero-Constraint Free Piston Energy Converter\u2019, Grant Number:\nGR\/S97507\/01.\nand most onerous duty cycle. An inevitable consequence of\nthis approach to machine rating is that it will operate well\nbelow its potential for much of its service life, particularly in\napplications with intermittent or unpredictable duty-cycles. In\nsuch applications, a machine could achieve a transient power\nrating that is considerably greater than its continuous rating\nif the thermal capacity of the machine is fully harnessed\n(although it is essential to ensure that the magnet has been ad-\nequately dimensioned to avoid irreversible demagnetisation).\nThis said, it should also be recognized that under extreme\nshort-term overload conditions, increases in output power are\naccrued with diminishing return as a consequence of the onset\nof magnetic saturation in the stator core.\nThe key to reliably and fully exploiting the thermal capacity\nof a machine in applications with variable and often unpre-\ndictable duty cycles, is monitoring key temperatures within the\nmachine. Temperature monitoring within a machine could be\nachieved using an array of thermal sensors embedded through-\nout the machine. One drawback of this approach is that the\nrelationship between the sensor and component temperatures is\nreliant on the interface properties, particularly in terms of any\ntime-lags introduced. Moreover, an array of embedded sensors\nincreases the number of connections required between the\nmotor and its controller, with a detrimental impact on system\nreliability [3]. A so-called \u2018sensorless\u2019 technique is therefore\nattractive, whereby estimates of stator coil temperatures can\nbe obtained by tracking changes in the coil resistance, which\nin turn can be derived from terminal voltage and current\nmeasurements.\nAlthough terminal resistance measurements only provide a\nmeans of determining average coil temperatures, these inferred\ntemperatures could in principle be used as input to a machine\nspecific thermal model to provide more localized temperature\ninformation, e.g. track any hotspot in the end-windings. As\nwell as providing an effective means of protection against\nover-temperature, the accurate tracking of winding temperature\nprovides a valuable source of information for health moni-\ntoring and prognostics and offer the potential for real-time\nthermal management of a machine, e.g. real-time variable de-\nrating to match peak transient capability in unexpected service\nconditions.\nAlthough the relatively high sensitivity of coil resistance to\ntemperature rise would appear to provide a convenient means\nof estimating stator coil temperature, in practice tracking\nresistance changes in PM machines is extremely challenging,\nparticularly in high efficiency, high power machines. In such\n2machines, the contribution from the stator resistive voltage\ndrop to the net terminal voltage under normal operating\nconditions is often very small, typically being of the order\nof less than a few percent. By way of illustration the target\nmotor for this research similarly has a resistive voltage drop at\nrated current of just 1.1 percent of the terminal voltage, with\nthe parameters of Table I. In order to provide a temperature\nresolution as coarse as 10\u25e6C in this machine, a resolution\nwhich might be regarded as the upper limit for tracking tem-\nperatures to avoid transient overheating, would require a means\nof reliably extracting the true resistive voltage component from\nterminal measurements to a resolution of 0.04 percent. These\ndifficulties are compounded in a practical drive system by the\npresence of several disturbances in the voltage and current\nwaveforms due to switching ripple, the action of closed-loop\ncontrollers which continually adjust the current to meet some\nspecified commanded motion, the presence of varying degrees\nof magnetic saturation in the stator and\/or rotor core (this being\nparticularly problematic under severe short-term overload) and\nrotor saliency.\nAs a consequence, resistance estimation methods that are\nsolely reliant on terminal measurements under normal operat-\ning conditions cannot usually provide the precision required\nfor high power PM machines. The method described in this\npaper is based on intermittent current injection to temporarily\nboost the resistive voltage contribution, thus alleviating to\nsome degree the difficulties of ensuring reliable measurement.\nSince the thermal time constant of a large PM machine (and\nhence the frequency with which estimates of resistance need\nto be obtained) is many orders of magnitude longer than\nthe duration of injected pulses (which are typically tens of\nmilliseconds), then the additional heating effect within the\nmachine is negligible. However, it is necessary in many ap-\nplications to ensure that the transient disturbance to the motor\nnormal operation during the current injection is minimized.\nII. STATOR-WINDING RESISTANCE ESTIMATION\nThe stator winding of a typical machine consists of several\ninsulated copper coils, whose resistance varies as a function\nof coil temperature as:\nRs = Rs0 + \u03b1Rs0(Ts \u2212 T0) (1)\nwhere Rs0 is the winding resistance at T0\u25e6C, Rs is the winding\nresistance at Ts \u25e6 C, and \u03b1 is the temperature coefficient of\ncopper (3.93x10\u22123 per \u25e6C).\nFor Rs0 = 0.133 \u2126 at 25\u25e6C, Rs = 0.183 \u2126 at 120\u25e6C. Thus\nthere is significant change in resistance over an operating tem-\nperature range, even if the resistance itself is small. Detection\nof this change in resistance provides a means of determining\nthe temperature of the stator coils. For a 10\u25e6C resolution in the\noperating temperature range the resistance must be estimated\nto an accuracy of approximately 5 m\u2126. Achieved accuracies of\n10 m\u2126 result in a resolution of 20\u25e6C, etc. In conjunction with\nthermal models, temperatures at other locations in a machine\ncan be estimated. Temperature estimates are desired for motor\nprotection functions and applications which require motors to\nbe operated at the limit of their temperature envelope.\nConsiderable research has been published on the estimation\nof stator resistance in induction machines for the improvement\nof sensorless speed and torque control [4]\u2013[9] and thermal\nmonitoring [10]. On-line stator resistance estimation has also\nbeen applied to PMSMs to improve sensorless control [11],\nbut thermal tracking has not been demonstrated.\nSensorless thermal monitoring has been demonstrated [12],\nprotecting a 200 W PMSM from coolant failure. This method\nwas based on least-squares estimation of the resistance. De-\nspite the low power rating, and hence the more significant\ncontribution of the resistive voltage drop, even in this case\nreliable estimates were only achieved over a limited speed\nrange, beyond which the contribution of the induced EMF\ndegraded the accuracy of the method employed.\nOne method of increasing the magnitude of the resistive\nvoltage drop relative to the remaining contributors to terminal\nvoltage, so as to aid the accuracy of resistance estimates, is to\nperiodically inject sensing current pulses of a prescribed form\ninto windings. Since most large, high-power machines have\nrelatively long thermal time constants (significant temperature\nexcursions occurring over time scales of the order of tens of\nseconds) it is usually only necessary to inject short sensing\npulses on a very low duty cycle, e.g. tens of millisecond\nduration pulses every few tens of seconds.\nHence, even with sense pulses that are significant in mag-\nnitude when compared to the rated current, the additional\nlosses generated in the machine will be marginal. However\nsuch an approach may have an impact on the converter rating,\nas the relatively low thermal mass of the switching elements\nmay dictate that a substantial increase in short-term rating is\nnecessary.\nThe injection of current pulses to aid resistive voltage mea-\nsurements can be achieved by superimposing a bias voltage\non the stator supply voltage [13], or by imposing a rotating\nvoltage on the neutral point of a star-connected machine with\na capacitor bank [14].\nThe first method induces a fixed current vector in the\nmachine, which causes the motor torque output to include an\noscillatory component. As the amplitude of the component\nincreases, the accuracy of the estimate also increases. In servo\nsystems this speed disturbance may prevent a system from\naccurately tracking a position or velocity profile, and makes\nthe application of this method subject to mechanical system\nconstraints. The lower the inertia of the system, the greater\nthe possible speed disturbance. If the motor is connected to\nthe load through a system with backlash, such as gears, then\nthe system may wear faster than expected.\nThe second method requires the addition of a capacitor bank\nand access to the motor star point, which requires modification\nto the motor, and may not be easily accessible. Both injection\nmethods dissipate power within the machine and any addi-\ntional devices required to induce the sense currents. In [13]\nthe average power dissipation of the DC injection method is\nshown to be negligible. The method presented in this article,\novercomes these two deficiencies by using the motor control\nsystem to inject the sense current along the direct-axis of the\nmachine.\n3III. PMSM DQ-AXIS MODEL\nThe concept of resolving machine armature quantities into\ntwo rotating components, one aligned with the field axis, the\ndirect-axis component (d), and one in quadrature with the\nfield axis, (q) is a well-established and widely used means of\nanalyzing electrical machines. These components, which are\nstationary with respect to the rotor, are referred to as being in\nthe rotor-stationary frame of reference (qdr). When transferred\nto the stator-stationary frame of reference, they are referred to\nas being in the stator-stationary frame of reference (qds).\nThe transformation itself can be represented in terms of the\nelectrical angle between the rotor direct-axis and the stator\nphase-a axis [15]. Letting S represent the quantity to be\ntransformed (current, voltage or flux), the transformation can\nbe written in matrix form using Park\u2019s transformation as\uf8ee\n\uf8f0 SdSq\nS0\n\uf8f9\n\uf8fb = (2)\n2\n3\n\uf8ee\n\uf8f0 cos(\u03b8) cos(\u03b8 \u2212 2pi\/3) cos(\u03b8 + 2pi\/3)\u2212 sin(\u03b8) \u2212 sin(\u03b8 \u2212 2pi\/3) \u2212 sin(\u03b8 + 2pi\/3)\n1\/2 1\/2 1\/2\n\uf8f9\n\uf8fb\n\uf8ee\n\uf8f0 SaSb\nSc\n\uf8f9\n\uf8fb\nwhere Sd, Sq and S0 denote the d-axis, q-axis and zero-\nsequence components of the transformed phase quantities Sa,\nSb and Sc.\nAn equivalent inverse transform exists which transfers the\ndq0 quantities into stator three-phase quantities. Under bal-\nanced conditions there are no zero-sequence components.\nWhen the PMSM three-phase motor equations are also trans-\nformed into the rotor reference frame the motor variables may\nbe represented by the following matrix[\nvdr\nvqr\n]\n=\n[\nRs \u2212\u03c9Lq\n\u03c9Ld Rs\n] [\nidr\niqr\n]\n+\n[\nLd 0\n0 Lq\n]\nd\ndt\n[\nidr\niqr\n]\n+\n[\n0\nKe\u03c9m\n]\n(3)\nwhere vdr and vqr are the direct and quadrature axes voltages\nin the rotor reference frame, idr and iqr are the direct and\nquadrature axes currents in the rotor reference frame, Rs is the\nstator resistance, Ld and Lq are the direct and quadrature axis\ninductances, Ke is the back-EMF constant, \u03c9 is the electrical\nfrequency and \u03c9m is the rotor angular velocity in radians per\nsecond.\nIV. DC INJECTION\nDC Injection is the superposition of a DC offset in one\nor more of the motor phases. The DC offset is used since it\nfacilitates the separation by filters of the injection voltage from\nthe motor\u2019s normal operating voltages under current control.\nIn principle, the sensing current can be injected into any\ncombination of phases in a variety of relative proportions.\nBy way of example, Fig. 1(a) shows a case in which the\ncurrent is injected into phase \u2018A\u2019 returning entirely through\nphase \u2018B\u2019 while in Fig. 1(b) the current is again injected\ninto phase \u2018A\u2019 but returns in equal proportions through phases\n(a) Two-phase\n(b) Three-phase\nFig. 1. Injection Current Paths\n\u2018B\u2019 and \u2018C\u2019. Both these paths can be represented by a current\nvector, Fig. 2 with dq components in the qds reference frame\nids = F cos(\u03b8F ) (4)\niqs = F sin(\u03b8F ) (5)\nwhere ids and iqs are the direct and quadrature axes currents in\nthe stator reference frame, F is the magnitude of the injected\ncurrent vector and \u03b8F is the angle of the injected current\nvector.\nThe injected current causes a magneto-motive force to be\npresent in the airgap of the machine. An additional rotating\ncurrent controlled vector will be present when the motor\ncomprises part of a drive system and is producing torque,\nFig. 3. The drive system is a closed-loop current control\nsystem which minimizes the error between the axes current\nfeedback and current demands i\u2217qr, i\u2217dr. The feedback axes cur-\nrents are generated by measuring the three phase currents and\ntransforming them into dq-frame (Eq. 3). The outputs of the\ncurrent controller are the calculated demand voltages v\u2217qr, v\u2217dr,\nwhich are transformed into the phase voltage demands via the\n4Fig. 2. General Current Vector\nFig. 3. Schematic of Current-Controlling Drive System\n\u2018Space-Vector Pulse-Width Modulation\u2019 (SVPWM) algorithm\nand the inverse transform of Eq. 3. The three-phase inverter is\nsupplied with bus voltages +Vdc,\u2212Vdc and applies the relevant\nswitching voltages to the motor.\nAs the injection currents must be superimposed with the ro-\ntating current vector, the application of current injection must\nbe managed in order to prevent the total current exceeding\nthe motor limit. When referred to the dq or \u2018rotor stationary\nframe\u2019(qdr), the injection current vector is represented as\nrotating\nidr = F cos(\u03b8F \u2212 \u03b8) (6)\niqr = F sin(\u03b8F \u2212 \u03b8) (7)\nwhere \u03b8 is the rotor electrical angle. The following equations\nof d- and q-axis voltage are obtained by substitution of (Eq. 6\n& 7) in (Eq. 3)\nvdr = FRs cos(\u03b8F \u2212 \u03b8)\n\u2212\u03c9F (Ld + Lq) sin(\u03b8F \u2212 \u03b8) (8)\nvqr = FRs sin(\u03b8F \u2212 \u03b8)\n+\u03c9F (Ld + Lq) cos(\u03b8F \u2212 \u03b8) (9)\nThe resistive and inductive parts generate voltage vectors\nwhich are orthogonally related. The resistance and inductance\ncan therefore be estimated separately by resolving along angles\n\u03b8\u2212 \u03b8F and \u03b8\u2212 \u03b8F +90\u25e6. The loci of the vectors is presented\nin Fig. 4, where |VR| = FRs, |VL| = \u03c9F (Ld + Lq).\nThe injection currents and detected voltages comprise the\nDC injection scheme, similar to that implemented by Lee\nFig. 4. DC Injection Resistance and Inductance Voltage Loci\n& Habetler [13] but represented in the dq-frame. The injection\nvoltage generated is stationary with respect to the stator.\nFor stator current magnitudes below those at which there\nis appreciable magnetic saturation of the stator and\/or rotor\ncore, the torque produced by a PMSM can be represented in\ndq-axis variables by\nTem = Ktiqr (10)\nwhere Tem is the torque and Kt is the torque-constant of the\nPMSM.\nThe DC-injection method must therefore produce a torque\nripple, as both d- and q-axis currents are generated (Eq. 6\n& 7). For accurate resistance estimation, the magnitude of\nthe injection current must be large. This causes large torque\nripples, so the engineer must constrain the current injection\nmagnitude F (and therefore accuracy) to the limit of the\nconnected mechanical system.\nThis torque ripple can cause significant speed deviation\nduring the application of the DC offset. The consequence\nof the distortion on connected mechanical systems could\nbe severe, especially at low loads since the output torque\npolarity could reverse. The speed deviation caused cannot be\ncorrected by the motor controller, since it would necessitate\ncancellation of the q-axis current and consequent deformation\nof the injection current.\nThus the scope for application of the DC Injection method\nis limited to systems with large inertial loads and stiffly\nconnected mechanisms. In order to prevent the injected sense\ncurrent unduly disturbing the electromagnetic torque, it is\nnecessary to adopt a current injection method which takes due\ncognizance of the effect on the instantaneous output torque.\nV. DIRECT-AXIS INJECTION METHODS\nA. Fixed-Angle Current Injection\nThis method represents a development of the DC-injection\nmethod as presented in Section I. The injection currents are\nmodified in order to reduce or eliminate the unwanted torque\npulsation. Reduction of the q-axis injection current by the\nregulation factor \u03b2 causes a corresponding reduction in torque\n5pulsation. The injection currents and torque production can be\nformulated\nidr = F cos(\u03b8F \u2212 \u03b8) (11)\niqr = \u03b2F sin(\u03b8F \u2212 \u03b8) (12)\nTem = \u03b2FKt sin(\u03b8F \u2212 \u03b8) (13)\nwhere Tem denotes the pulsating torque produced by injection.\nFor \u03b2 = 0 there is no torque production and the axes\nvoltages due to the injection current (Eq. 11) are described\nvdr = FRs cos(\u03b8F \u2212 \u03b8)\u2212 \u03c9FLd sin(\u03b8F \u2212 \u03b8) (14)\nvqr = \u03c9FLd cos(\u03b8F \u2212 \u03b8) (15)\nBecause the current vector achieves a fixed angle with re-\nspect to the rotor in the stator-stationary frame, it is referred to\nas \u2018Fixed-Angle Current Injection\u2019. The general disadvantage\nof the fixed angle is that the magnitude of the sense current\nmust vary. The resistance can best be estimated when the\nvoltage FRs is a maximum, so estimating the resistance at\na rotor angle other than \u03b8 = \u03b8F is less than optimal.\nB. Fixed-Magnitude Current Injection\nThe alternative formulation of current injection is to main-\ntain a constant magnitude of injection current but to allow\nthe phase to vary such that the criterion of zero torque\nproduction is retained. Thus a constant magnitude of resistive\nvoltage with respect to angle is achieved. This is a desirable\nfeature, allowing estimated data to be combined to form a\nsingle preferred value representing resistance. The currents are\nformulated in the qds frame\nids = F cos(\u03b8) (16)\niqs = F sin(\u03b8) (17)\nHence the magnitude is constant, and the angle varies with\nrotor position. When transferred to qdr frame\nidr = F (18)\niqr = 0 (19)\nIf the method is restricted to purely negative F , then this\nmethod becomes analogous to the \u2018Flux-Weakening\u2019 method\nof extending the controllable speed range of a motor under the\nconstraint of some finite applicable voltage magnitude [16].\nThe estimation voltages are obtained by substitution of the\nqdr frame injection currents (Eq. 18 & 19) into the PMSM\nvoltage equation (Eq. 3)\nvdr = FRs (20)\nvqr = \u03c9FLd (21)\nThe resistive and inductive voltages produced by injection\nare naturally separated onto the d & q-axes respectively.\nNotably the resistive voltage is orthogonally separated from\nthe inductive voltage and the EMF. This is advantageous\nconsidering that the resistive voltage is generally the smallest\nof the three quantities in magnitude.\n0 1 2 3 4 5 6 7\n0\n0.2\n0.4\n0.6\n0.8\n1\n\u03b8, (rad)\nN\nor\nm\nal\nis\ned\n M\nag\nni\ntu\nde\ns\nVL\nVR\nFig. 5. Normalized Magnitudes of Injection Voltages for \u03b8F = 0\u25e6\nVI. SIGNAL VOLTAGE ANALYSIS\nA. Fixed-Angle\nTo realize the most accurate estimator performance per\nampere of injected current, the largest magnitude and most\nsignificant contribution from the resistive voltage term to the\nterminal voltage is required.\nThe resistive voltage term in (Eq. 14) is maximum at\n\u03b8 = \u03b8F , coinciding with the maximum of the d-axis injection\ncurrent (Eq. 11). The inductive voltage magnitude is constant,\nand the two voltages are orthogonally related. As rotor position\nmoves away from \u03b8 = \u03b8F , the angle between the two voltages\nbecomes non-orthogonal. Therefore to estimate the resistance\nmost accurately requires the rotor position to be \u03b8 = \u03b8F . Both\nthe resistance and inductance can be estimated at this point.\nWhile the machine is rotating there will be a short time\ninterval during which the greatest resistive signal voltage\nis available. This is the best rotor position to estimate the\nresistance, but exists momentarily. To account for the existence\nof noise and other possible error voltages in the measurement\nit is prudent to increase the arc of rotor angle (and therefore\nthe number of measurements) for which the resistance can\nbe estimated. With small arcs of rotor angle the difference\nin magnitude of the injection current is small. For example\nwith a 30\u25e6 arc centered on the optimal angle, the difference\nin current magnitude is only 3.4 percent. The signal voltages\nare resolved when not orthogonal by the equations[\nVR\nVL\n]\n=\n[\n\u2212Vqds sin(\u03b8L\u2212\u03b8qds)\nsin(\u03b8R\u2212\u03b8L)\nVqds sin(\u03b8R\u2212\u03b8qds)\nsin(\u03b8R\u2212\u03b8L)\n]\n(22)\nwhere Vqds, \u03b8qds are the magnitude and angle of the sum of\nthe resistive and inductive voltages in the qds frame, and\n\u03b8R, \u03b8L are the angles of the resistive and inductive voltages\nrespectively.\nThe denominator of the equation becomes zero when \u03b8R =\n\u03b8L, with rotor position \u03b8 = \u03b8F + pi\/2. This condition will not\nbe satisfied for useful resistance estimates since the resistive\nsignal voltage is zero at this angle. \u03b8R and \u03b8L can be calculated\nfrom (Eq. 14 & 15), and depend on rotor position but not on\nthe magnitudes of Rs or the inductances.\n6The injection current should be concentrated in the region\nof greatest accuracy to prevent excessive losses. The required\ncurrent is an arc, which can be produced by using a window\nfunction multiplied by the injection current (Eq. 11).\nB. Fixed-Magnitude\nSince the injection current is not defined by rotor angle\nin the qdr frame, a constant-magnitude resistive voltage is\ngenerated with respect to angle. As such there is no rotor\nposition which offers the greatest resistive voltage, and no\nrequirement to limit the application of current around this\npoint. The use of a window function is prudent in limiting\nthe voltage required to change from pre-injection motoring\ncurrents to injection currents and vice-versa.\nVII. A WINDOW FUNCTION FOR INJECTING CURRENT\nPULSES\nIf the current injection pulses are crudely applied, for\nexample by switching them on and off according to rotor\nposition, the step currents produced may excite electrical\ncircuit resonances, encouraging voltage oscillations to form.\nExcitation of the resonances can be reduced by controlling the\ntransition from one current level to another. This control takes\nthe form of a window function, which has a profile defined\nto reduce the magnitude of the voltage harmonics required to\nmove from one current level to another [17].\nBy choosing a defined window function, the voltage re-\nquired to make the transition can be calculated. This is useful\nin calculating the greatest injection current that may be applied\nat a given speed, or in rating the inverter.\nThe window function profile specifies a compromise be-\ntween the voltage requirement and the length of time spent in\nthe window period. A soft-start function such as the \u2018Black-\nman\u2019 window function can be used to minimize oscillations in\nthe transition from one current value to another, Fig. 6. The\nfunction is specified\nB(tn, Tw) = 0.42 + 0.5 cos\n(\npitn\nTw\n)\n+0.08 cos\n(\n2pitn\nTw\n)\n(23)\nwhere tn is time normalized to the center of the window\nfunction and Tw is the period of the function.\nThis is one of a group of finite-length window functions\nwhich are employed in digital signal processing [17]. Func-\ntions such as the Blackman window approximate the ideal\nwindow spectra with a finite-length.\nThe differential of the Blackman function is useful in\nassessing its suitability, Fig. 7. Clearly, the rate of change of\nthe differential shown in Fig. 7 is non-zero for the standard\nfunction at tn = 0. This causes tracking errors for the current\ncontroller at the junction of the window and injection func-\ntions. A better match can be achieved with a modified window\n(Figs. 6, 7), albeit at a higher differential magnitude, and by\nshifting the tracking errors towards the tn = (\u22121, 1) points.\nThis is justified as the injection current at these points tends\n\u22121 \u22120.8 \u22120.6 \u22120.4 \u22120.2 0 0.2 0.4 0.6 0.8 1\n0.0\n0.5\n1.0\nM\nag\nni\ntu\nde\nNormalised Time, t\nn\nBlackman\nModified\nFig. 6. Blackman-Type Windows\n\u22121 \u22120.8 \u22120.6 \u22120.4 \u22120.2 0 0.2 0.4 0.6 0.8 1\n\u22122.5\n\u22122.0\n\u22121.5\n\u22121.0\n\u22120.5\n0.0\n0.5\n1.0\n1.5\n2.0\n2.5\nM\nag\nni\ntu\nde\n o\nf D\niff\ner\nen\ntia\nl\nNormalised Time, t\nn\nBlackman\nModified\nFig. 7. Differential of Blackman-Type Windows\ntowards zero, and can play no part in resistance estimation.\nThe modified function is given\nB2(tn, Tw) = 0.625 + 0.5 cos\n(\npitn\nTw\n)\n\u2212 0.125 cos\n(\n2pitn\nTw\n)\n(24)\nmax\n(\nd(B)\ndt\n)\n=\n1.81\nTw\n(25)\nmax\n(\nd(B2)\ndt\n)\n=\n2.04\nTw\n(26)\u222b Tw\n\u2212Tw\nB(t)dt = 0.84Tw (27)\u222b Tw\n\u2212Tw\nB2(t)dt = 1.25Tw (28)\nUsing the maximum differential of the window profile, the\nmachine-dependent drive voltage and current requirements per\n70 0.005 0.01 0.015 0.02 0.025 0.03 0.035 0.04 0.045 0.05\n0\n5\n10\n15\n20\n25\n30\n35\n40\n45\n50\nPeriod T\nw\n, (s)\nVo\nlta\nge\n A\nva\nila\nbl\ne,\n (V\n)\n25 A\n50 A\n75 A\nFig. 8. Maximum Current Available for Injection with Ld = 9 mH and Rs\n= 0.133 \u2126\nphase can be calculated\nVinj = F\n\u221a(\n[1.81, 2.04]Ld\nTw\n)2\n+R2s (29)\nIinj =\n2\n3\nF (30)\nThese are beneficial in specifying inverter VA rating for resis-\ntance estimation, or in tuning the window period Tw to suit\nthe available drive voltage. Given a certain maximum voltage\navailable for injection and particular machine parameters, the\nmaximum achievable injection current can be calculated for\nvarious Tw, Fig. 8.\nVIII. INJECTION CURRENT PROFILE AND POWER\nDISSIPATION\nMultiplying the window function in a piecewise manner\nwith the injection currents (Eqs. 6 & 18) realize the injection\ncurrent profiles, Fig. 10. The intermittent injection of the d-\naxis current through resistance Rs causes resistive power loss\nPFA =\nF 2\nNinjRs\nTel\n(\n2\n\u03c9\nsin\n(\n\u03c9Ti\n2\n)\n+ [0.84, 1.25]Tw\n)\n(31)\nPFM = F\n2NinjRs\nTel\n(Ti + [0.84, 1.25]Tw) (32)\nwhere PFA, PFM are the average power losses for fixed-angle\nand fixed magnitude methods over elapsed time Tel, Ninj is\nthe number of injection current pulses in the elapsed time and\nTi is the duration of the current injection pulse. The values\n[0.84, 1.25] refer to the Blackman and modified windows\nrespectively.\nThe practical significance of the losses introduced by current\ninjection can be illustrated by reference to the PMSM of\nTable I which has a rated power of 11.9 kW. By way of\nillustration, the additional losses generated as a function of\ncurrent magnitude for the specific case of three injections every\n10 seconds, with window arc of \u03b8w = 10\u25e6 and injection arc of\n0 20 40 60 80 100 120 140 160 180\n0\n10\n20\n30\n40\n50\n60\nAngle, (degrees)\nIn\njec\ntio\nn C\nurr\nen\nt, (\nA)\n\u03b8\nw\n\u03b8i\/2 \u2190 \u03b8c\nFixed\u2212Magnitude\nFixed\u2212Angle\nFig. 9. Injection Current Profiles for \u03b8i = 90\u25e6, where \u03b8c denotes the center\nangle for injection, and \u03b8i is the arc of the injection window\n200 400 600 800 1000 1200 1400 1600 1800 2000\n0\n2\n4\n6\n8\n10\n12\n14\n16\n18\n20\nSpeed, (RPM)\nAv\ner\nag\ne \nLo\nss\nes\n G\nen\ner\nat\ned\n B\ny \nIn\njec\ntio\nn, \n(W\n) F = 25A\nF = 50A\nF = 75A\nFig. 10. Average Power Dissipation for Bipolar Injection\n\u03b8i = 720\n\u25e6 are plotted in Fig. 10. The intermittent estimation\nof resistance via current injection is sufficient for machines\nwith long thermal time constants, and results in an additional\nheating load which is low when compared to the motor rated\npower.\nIX. THE INFLUENCE OF THE EMF\nThe widespread use of the dq transform (Eq. 3) stems from\nits representation of the stator three-phase EMFs as a constant\nwhich is aligned with the q-axis in the rotor reference frame.\nThe machine drive currents and EMFs must be sinusoidal for\nsmooth, high bandwidth control.\nDue to machine design constraints this ideal waveform\ncannot be achieved and the EMF may contain significant\nharmonics. Fig. 11 shows an ideal sinusoid and two EMF\nwaveforms of the same peak voltage which are typical of those\nobserved in practical machines [18], [19]. The \u2018Sinusoidal\u2019,\n\u2018Modular\u2019 and \u2018Trapezoidal\u2019 machines contain 100, 89 and 77\npercent fundamental components respectively.\nThe EMF waveform has a significant effect on the axes volt-\nages, especially at high speeds. The effect of non-sinusoidal\n80 1 2 3 4 5 6 7\n\u22120.25\n\u22120.20\n\u22120.15\n\u22120.10\n\u22120.05\n0.00\n0.05\n0.10\n0.15\n0.20\n0.25\nPosition, (rad)\nEM\nF,\n (V\n\/ra\nd\/s\n)\nSinusoidal\nModular\nTrapezoidal\nFig. 11. Back-EMF Profiles\nEMF on the axes voltages has been predicted by simulation of\na vector-controlled drive-system similar to Fig. 3, and with the\nmotor parameters of Table I. The fluctuation in axes voltages\nis comparable in magnitude to the resistive voltage under\ncurrent injection. Harmonic generation from motors with less-\nsinusoidal EMF will be of greater magnitude, and resistance\nestimation will therefore be more difficult.\nMethods employed to estimate the resistance must be able to\nseparate the voltage harmonics from the superimposed signal\nvoltage.\nX. METHODS OF SEPARATING INJECTION VOLTAGES\nFROM MOTORING VOLTAGES\nThe injection voltages must be separated from the motoring\n(Eq. 3) and harmonic voltages. The unknown injection volt-\nages can be defined if the motoring voltages and harmonics\nare defined.\nThe motoring voltages could be defined using parameters,\nrequiring estimation procedures or empirical determination.\nThe EMF harmonics in particular require many parameters to\ndefine. Basing the separation function on parameters is unwise,\nespecially in a temperature-estimating drive system which may\nbe subject to significant parameter deviation over the working\ntemperature range.\nThe following methods are based on measuring the ter-\nminal voltage waveforms for a short interval during normal\noperation, i.e. with no current injection, and subtracting these\nwaveforms from those obtained during a corresponding in-\nterval with current injection for the same nominal speed and\nmotoring current conditions. Such approaches are inherently\nreliant on achieving near identical motoring conditions during\nthe two intervals. Whilst this could be difficult to achieve in\npractical drive systems, there may be options to command the\nmotor to a set torque or speed output during current injection.\nDuring each interval the motor variables idr,iqr,vdr,vqr,\u03c9m\nand \u03c9 are recorded and the difference in voltage is computed\noffline.\nA. Unipolar Method\nOnly the second period contains an injection pulse, and\nthe two periods are recorded over the same arc of rotor\nangle \u03b8. The harmonic voltages with respect to rotor position\nare assumed equal over two periods with unchanged motor\nparameters. Thus the difference in the recorded variables\nover the two time periods reveals the injection currents and\nvoltages.\nEstimation of harmonic voltages is thus avoided. From\n(Eq. 3), and neglecting the differential terms, the following\nequations can be formulated with arbitrary generated injection\nvoltages vidr on the d-axis, viqr on the q-axis, and for\ntwo recordings of parameters starting at \u03b8 and \u03b8 + \u2206\u03b8. For\nRecording 1:\nvdr(\u03b8) = Rsidr(\u03b8)\u2212 \u03c9(\u03b8)Lqiqr(\u03b8) + kd(\u03b8)\u03c9m(\u03b8) (33)\nvqr(\u03b8) = Rsiqr(\u03b8)\u2212 \u03c9(\u03b8)Ldidr(\u03b8) + kq(\u03b8)\u03c9m(\u03b8)\n+Ke\u03c9m(\u03b8) (34)\nRecording 2:\nvdr(\u03b8 +\u2206\u03b8) = Rsidr(\u03b8 +\u2206\u03b8)\n\u2212\u03c9(\u03b8 +\u2206\u03b8)Lqiqr(\u03b8 +\u2206\u03b8)\n+kd(\u03b8 +\u2206\u03b8)\u03c9m(\u03b8 +\u2206\u03b8) + vidr(\u03b8) (35)\nvqr(\u03b8 +\u2206\u03b8) = Rsiqr(\u03b8 +\u2206\u03b8)\n\u2212\u03c9(\u03b8 +\u2206\u03b8)Ldidr(\u03b8 +\u2206\u03b8)\n+kq(\u03b8)\u03c9m(\u03b8 +\u2206\u03b8) + viqr(\u03b8 +\u2206\u03b8) (36)\nwhere kd(\u03b8), kq(\u03b8) are the harmonic voltages with respect to\nelectrical rotor position.\nBy subtraction of (Eq. 35 & 36) from (Eq. 33 & 34) the\ninjection voltage is recovered providing that kd(\u03b8), kq(\u03b8) =\nkd(\u03b8 +\u2206\u03b8), kq(\u03b8 +\u2206\u03b8) (Eq. 37 & 38).\nvidr(\u03b8) = vdr(\u03b8)\u2212 vdr(\u03b8 +\u2206\u03b8) + \u2206\u03c9Lq\u2206iqr\n\u2212\u2206idrRs (37)\nviqr(\u03b8) = vqr(\u03b8)\u2212 vqr(\u03b8 +\u2206\u03b8) + \u2206\u03c9Ld\u2206idr\n\u2212\u2206iqrRs +Ke\u2206\u03c9m (38)\nwhere \u2206 is the difference in the respective variables between\nmeasurement periods.\nThis equivalence can be achieved for electrical harmonics\nnumbered 0 and upwards by setting \u2206\u03b8 = 2pi. The equivalence\nis also achievable for mechanical harmonics by setting \u2206\u03b8 =\n2ppi. The drawback is that \u2206\u03b8 is longer and the assumption\nthat the motor parameters are unchanged may not be valid.\nB. Bipolar Method\nIn the bipolar method, the first injection time period contains\ninjection current of positive polarity, and the second of nega-\ntive polarity. The EMF is separated as the recorded voltages\nand currents are subtracted from one another, and twice the\nmagnitude of injection voltage and current is obtained. To\nobtain a specific signal magnitude the bipolar method therefore\nrequires half the time period, or half the injection current\nmagnitude of the unipolar. From Eq. 3,\n9Recording 1:\nvdr(\u03b8) = Rsidr(\u03b8)\u2212 \u03c9(\u03b8)Lqiqr(\u03b8) + kd(\u03b8)\u03c9m(\u03b8)\n+vidr(\u03b8) (39)\nvqr(\u03b8) = Rsiqr(\u03b8)\u2212 \u03c9(\u03b8)Ldidr(\u03b8) + kq(\u03b8)\u03c9m(\u03b8)\n+viqr(\u03b8) +Ke\u03c9m(\u03b8) (40)\nRecording 2:\nvdr(\u03b8 +\u2206\u03b8) = Rsidr(\u03b8 +\u2206\u03b8)\n\u2212\u03c9(\u03b8 +\u2206\u03b8)Lqiqr(\u03b8 +\u2206\u03b8)\n+kd(\u03b8 +\u2206\u03b8)\u03c9m(\u03b8 +\u2206\u03b8)\u2212 vidr(\u03b8) (41)\nvqr(\u03b8 +\u2206\u03b8) = Rsiqr(\u03b8 +\u2206\u03b8)\n\u2212\u03c9(\u03b8 +\u2206\u03b8)Ldidr(\u03b8 +\u2206\u03b8)\n+kq(\u03b8)\u03c9m(\u03b8 +\u2206\u03b8)\u2212 viqr(\u03b8 +\u2206\u03b8) (42)\nBy subtraction twice the injection voltage is recovered\n2vidr(\u03b8) = vdr(\u03b8)\u2212 vdr(\u03b8 +\u2206\u03b8) + \u2206\u03c9Lq\u2206iqr\n\u2212\u2206idrRs (43)\n2viqr(\u03b8) = vqr(\u03b8)\u2212 vqr(\u03b8 +\u2206\u03b8) + \u2206\u03c9Ld\u2206idr\n\u2212\u2206iqrRs +Ke\u2206\u03c9m (44)\nBoth methods rely on the repeatability of measurements made\nwith respect to rotor position from one injection period to\nthe next. If there is sufficient change in any of the system\nconditions then the methods are likely to become erroneous.\nMonitoring the speed change \u2206\u03c9 between the injection peri-\nods could provide a means of predicting the suitability of the\ndata for resistance estimation.\nFrom the determinations of the injection voltages vidr\nand viqr, and knowledge or measurement of the injected\ncurrents, the stator winding resistance can be estimated from\n(Eqs. 20 & 14).\nXI. FIXED-ANGLE VERSUS FIXED-MAGNITUDE\nFor the fixed-angle method, the resistance may be estimated\nfrom the determined resistive signal voltages (Eq. 22) using the\nphase and magnitude of detected injection voltage. Due to the\nchanging magnitude of resistive signal voltage, only a small\nnumber of samples per revolution can be obtained relative to\nthe number of measurements that can be made in a whole\nrevolution of the rotor.\nThis makes it likely that many revolutions will be required\nin order to achieve adequate separation of the resistive signal\nfrom noise and error voltages. There may also be a reduction in\ninjection current magnitude due to attenuation of the sinusoidal\ncurrent by the current controller.\nFor the fixed-magnitude method the resistive voltage\n(Eq. 20) is constant. Thus the injection current may be applied\nfor an indefinite, multi-revolution period of time. As the\ninjection current is constant in the current-controller frame,\nthere will be no problem with attenuation. There will be\ndeviations in the detected resistive voltage due to noise and\nvariation of the system conditions between the two time\nintervals, and the application of filters to smooth these out\nis straightforward with the underlying resistive voltage being\nTABLE I\nPMSM PARAMETERS\nParameter Symbol Value\nTorque constant Kt 2.08 Nm\/A\nEMF constant Ke 1.19Vs radian\u22121\nRated speed \u03c9rated 314 radians\u22121\nRated continuous power output Pcont 11.9 kW\nRated continuous current Icont 31.9 A RMS\nStator resistance Rs 0.133 \u2126\nStall current Istall 117.5 A RMS\nMaximum phase voltage Vac 480 V\nLine-to-line inductance Ll\u2212l 11 mH\nRotor moment of inertia J 0.00841 kg m2\nPole-pairs p 3\nThermal time constant \u03c4th 2880s (48 min)\nTorque due to Coulomb friction Tc 0.908 Nm\nconstant. Comparing the d-axis current injection methods with\nthe DC injection method, the d-axis methods do not produce\nthe torque ripple that is a consequence of the DC offset. The\nunipolar and bipolar methods provide a means to separate the\ninjection current and voltage signals which is not dependent\non frequency separation, but on the likelihood that change in\nthe motoring system conditions between two time intervals is\nsmall.\nXII. CONCLUSIONS\nTwo methods of current injection have been presented which\ndo not directly generate torque in a PMSM. These methods are\nsuitable for stator resistance estimation in machines with rela-\ntively low resistances compared to terminal voltage magnitude,\nby virtue of the decoupling of the resistance-sensing current\nfrom the motor\u2019s torque-producing current. A novel separation\ntechnique is presented which is able to recover the voltage\ngenerated by current injection from two recordings of motor\nparameters; without the estimation of many of the PMSM\nparameters being required, and without the need for frequency\nseparation between motoring and injection currents. A window\nfunction is also presented which smooths transitions between\nthe high current magnitudes required for resistance-sensing\nand the lower magnitudes of motoring currents. The authors\nwill publish a companion paper, detailing the application of the\nbipolar current injection technique to a PMSM. The technique\nwas able to maintain a temperature estimation error of less\nthan 10\u25e6C at winding temperatures above 60\u25e6C.\nREFERENCES\n[1] A. H. Bonnet, \u201cRoot cause ac motor failure analysis,\u201d IEEE Trans. Ind.\nAppl., vol. 36, no. 5, pp. 1435\u20131448, Sep.\/Oct. 2000.\n[2] R. Gleichman, \u201cFailure modes and field testing of medium-voltage motor\nwindings,\u201d IEEE Trans. Ind. Appl., vol. 38, no. 5, pp. 1473\u20131476,\nSep.\/Oct. 2002.\n[3] S. Farag, R. Bartheld, and T. Habetler, \u201cAn integrated on-line motor pro-\ntection system,\u201d IEEE Trans. Ind. Appl., vol. 2(2), pp. 21\u20136, Mar.\/Apr.\n1996.\n[4] R. Kerkman, B. Seibel, T. Rowan, and D. Schlegel, \u201cA new flux and\nstator resistance identifier for ac drive systems,\u201d IEEE Trans. Ind. Appl.,\nvol. 32, no. 3, pp. 585\u2013593, May\/Jun. 1996.\n[5] M. Elbuluk, L. Tong, and I. Hussain, \u201cNeural-network-based model\nreference adaptive systems for high performance motor drives and\nmotion controls,\u201d IEEE Trans. Ind. Appl., vol. 38, no. 3, pp. 879\u2013886,\nJun. 2002.\n10\nTABLE II\nSYMBOL TABLE\nSymbol Parameter\n\u03b1 Temperature coefficient of copper\n\u03b2 Regulation factor\n\u2206 Change in a parameter\n\u03b8 Electrical rotor position\n\u03b8F Angle of injected current vector (elec)\n\u03b8L Angle of resistive voltage in stator frame (elec)\n\u03b8m Mechanical rotor position (mech)\n\u03b8R Angle of inductive voltage in stator frame (elec)\n\u03b8qds Angle of resistive and inductive voltage in stator frame (elec)\n\u03c9 Electrical frequency\n\u03c9m Mechanical (shaft) frequency\nB Blackman window function\nB2 Modified Blackman window function\nF Magnitude of injected current vector\nia Phase-A current\nib Phase-B current\nic Phase-C current\nidr D-axis current, rotor reference frame\niqr Q-axis current, rotor reference frame\nids D-axis current, stator reference frame\niqs Q-axis current, stator reference frame\nkd Coefficient for D-axis EMF harmonics\nkq Coefficient for D-axis EMF harmonics\nKe EMF constant\nKt Torque constant\nLd D-axis inductance\nLq Q-axis inductance\nNinj Number of injected current pulses\nPFA Power dissipation for fixed-angle method\nPFM Power dissipation for fixed-magnitude method\nRs Stator resistance\nRs0 Stator winding resistance at reference temperature\nS0 Zero-sequence quantity\nSa Phase-A quantity\nSb Phase-B quantity\nSc Phase-C quantity\nSd D-axis quantity, rotor reference frame\nSq Q-axis quantity, rotor reference frame\nT0 Reference temperature\nTel Elapsed time between injected pulses\nTem Electromagnetic torque\nTi Duration of current injection pulse\nTs Stator winding temperature\nTw Time-period of the window function\nvidr D-Axis voltage caused by current injection\nviqr Q-axis voltage caused by current injection\nvdr D-axis voltage, rotor reference frame\nvqr Q-axis voltage, rotor reference frame\nVL Magnitude of inductive voltage\nVR Magnitude of resistive voltage\nVqds Magnitude of resistive and inductive voltage in stator frame\n[6] J. Campbell and M. Sumner, \u201cAn artificial neural network for stator\nresistance estimation in a sensorless vector controlled induction motor\ndrive,\u201d 9th European Conference on Power Electronics and Applications,\nvol. 2001, Graz, Austria Aug.\n[7] L. Umanand and S. Bhat, \u201cOnline estimation of stator resistance of an\ninduction motor for speed control applications,\u201d IEE Proc.-Electr. Power\nAppl., vol. 142, no. 2, pp. 97\u2013103, Mar. 1995.\n[8] V. Vasic, S. Vukosavic, and E. Levi, \u201cA stator resistance estimation\nscheme for speed sensorless rotor flux oriented induction motor drive,\u201d\nIEEE Trans. Energy Convers., vol. 18, no. 4, pp. 476\u2013482, Dec. 2003.\n[9] B. Bose and N. Patel, \u201cQuasi-fuzzy estimation of stator resistance of\ninduction motor,\u201d IEEE Trans. Power Electron., vol. 18, no. 4, pp. 401\u2013\n409, May 1998.\n[10] L. C. Benn, B. Burton, and R. G. Harley, \u201cOnline stator resistance\nestimation for thermal monitoring of converter fed induction motors\nusing pseudorandom modified pwm,\u201d in Conference Record of the 2004\nIEEE Industry Applications Conference. 39th IAS Annual Meeting, Oct.\n2004, pp. 727\u201334.\n[11] B. Nahid-Mobarakeh, F. Meibody-Tabar, and F.-M. Sargos, \u201cMechanical\nsensorless control of pmsm with online estimation of stator resistance,\u201d\nIEEE Trans. Ind. Appl., vol. 40(2), pp. 457\u201371, Mar.\/Apr. 2004.\n[12] P. Milanfar and J. H. Lang, \u201cMonitoring the thermal condition of\npermanent-magnet synchronous motors,\u201d IEEE Trans. Aerosp. Electron.\nSyst., vol. 32(4), pp. 1421\u20139, Oct. 1996.\n[13] S. Lee and T. Habetler, \u201cAn online stator winding resistance estimation\ntechnique for temperature monitoring of line connected induction ma-\nchines,\u201d IEEE Trans. Ind. Appl., vol. 39, no. 3, pp. 685\u2013694, May\/Jun.\n2003.\n[14] C. Jacobina, J. Filha, and A. Lima, \u201cOn-line estimation of the stator\nresistance of induction machines based on zero sequence model,\u201d IEEE\nTrans. Power Electron., vol. 15, no. 2, pp. 346\u2013352, Mar. 2000.\n[15] A. Fitzgerald, J. Charles Kingsley, and S. D. Umans, Electric Machinery.\nMcGraw-Hill, 2003.\n[16] P. Stewart and V. Kadirkamanathan, \u201cDynamic model tracking design for\nlow inertia, high speed permanent magnet ac motors,\u201d ISA Transactions,\nvol. 43, no. 1, pp. 111\u201322, Jan. 2004.\n[17] S. D. Stearns and D. R. Hush, Digital Signal Analysis, 2nd ed. Prentice-\nHall, 1990, p. 157.\n[18] J. Wang, Z. .Xia, and D. Howe, \u201cAnalysis of three-phase surface-\nmounted magnet modular permanent magnet machines,\u201d IEEE Trans.\nPower Electron., vol. 3, pp. 27\u201332, 2004.\n[19] Z. Zhu, D. Howe, and B. Ackermann, \u201cAnalytical prediction of dynamic\nperformance characteristics of brushless dc drives,\u201d Electric Machines\nand Power Systems, vol. 20, no. 6, pp. 661\u2013678, 1992.\nSimon Delamere Wilson was born in Chester,\nCheshire, England in 1979. He received the M.Eng\ndegree in Electrical Engineering from the University\nof Sheffield, UK, in 2004 and his PhD from the\nsame institution in 2009. Since 2007, he has been a\nConsultant in the New Energy Technologies depart-\nment at EA Technology, Capenhurst, Chester. His\nresearch interests include power electronics, drive\nsystems and renewable energy and energy efficiency.\nPaul Stewart Paul Stewart (M\u20192000-SM\u20192004) was\nborn in Birmingham, England in 1960. He received\nthe B.Eng and Ph.D degrees in electronic, control\nand systems engineering from the University of\nSheffield UK, in 1996 and 2000 respectively. He be-\ncame Assistant Professor in Electronic and Electrical\nEngineering in the Machines and Drives Group at\nthe University of Sheffield in 2002, and Associate\nProfessor in 2007. He is currently Founding Head\nof Engineering at the University of Lincoln. His\nresearch interests are in multiobjective optimisation\nand intelligent control with automotive and aeronautic applications.\nBen Taylor received the M.Eng degree in electronic\nengineering (communications) from the University\nof Sheffield, Sheffield, UK, in 1998. Currently, he is\nemployed as a research associate in the Department\nof Automatic Control and Systems Engineering, at\nthe University of Sheffield, working on power sys-\ntems modelling for more electric aircraft platforms.\nHis research interests also include power electronics,\nmachine control and energy scavenging systems.\n"}