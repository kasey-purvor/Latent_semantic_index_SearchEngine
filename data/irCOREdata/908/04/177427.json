{"doi":"10.1063\/1.3530440","coreId":"177427","oai":"oai:aura.abdn.ac.uk:2164\/2240","identifiers":["oai:aura.abdn.ac.uk:2164\/2240","10.1063\/1.3530440"],"title":"Modeling the complex dynamics of enzyme-pathway coevolution.","authors":["Sch\u00fctte, Moritz","Skupin, Alexander","Segr\u00e8, Daniel","Ebenhoeh, Oliver"],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":["University of Aberdeen, Medicine, Medical Sciences & Nutrition, Institute of Medical Sciences","University of Aberdeen, Institute for Complex Systems and Mathematical Biology (ICSMB)","University of Aberdeen, Institute of Medical Sciences"],"datePublished":"2010-12-01","abstract":"Peer reviewedPostprin","downloadUrl":"","fullTextIdentifier":null,"pdfHashValue":null,"publisher":null,"rawRecordXml":"<record><header><identifier>\n        \n            \n                oai:aura.abdn.ac.uk:2164\/2240<\/identifier><datestamp>\n                2018-01-02T00:04:26Z<\/datestamp><setSpec>\n                com_2164_320<\/setSpec><setSpec>\n                com_2164_319<\/setSpec><setSpec>\n                com_2164_318<\/setSpec><setSpec>\n                com_2164_644<\/setSpec><setSpec>\n                com_2164_365<\/setSpec><setSpec>\n                com_2164_330<\/setSpec><setSpec>\n                com_2164_705<\/setSpec><setSpec>\n                col_2164_321<\/setSpec><setSpec>\n                col_2164_645<\/setSpec><setSpec>\n                col_2164_706<\/setSpec>\n            <\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:doc=\"http:\/\/www.lyncode.com\/xoai\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n            \nModeling the complex dynamics of enzyme-pathway coevolution.<\/dc:title><dc:creator>\nSch\u00fctte, Moritz<\/dc:creator><dc:creator>\nSkupin, Alexander<\/dc:creator><dc:creator>\nSegr\u00e8, Daniel<\/dc:creator><dc:creator>\nEbenhoeh, Oliver<\/dc:creator><dc:contributor>\nUniversity of Aberdeen, Medicine, Medical Sciences & Nutrition, Institute of Medical Sciences<\/dc:contributor><dc:contributor>\nUniversity of Aberdeen, Institute for Complex Systems and Mathematical Biology (ICSMB)<\/dc:contributor><dc:contributor>\nUniversity of Aberdeen, Institute of Medical Sciences<\/dc:contributor><dc:subject>\nR Medicine<\/dc:subject><dc:subject>\nR<\/dc:subject><dc:description>\nPeer reviewed<\/dc:description><dc:description>\nPostprint<\/dc:description><dc:date>\n2012-02-08T10:58:02Z<\/dc:date><dc:date>\n2012-02-08T10:58:02Z<\/dc:date><dc:date>\n2010-12-01<\/dc:date><dc:type>\nJournal article<\/dc:type><dc:identifier>\nSch\u00fctte , M , Skupin , A , Segr\u00e8 , D & Ebenhoeh , O 2010 , ' Modeling the complex dynamics of enzyme-pathway coevolution. ' Chaos , vol 20 , no. 4 , 045115 . DOI: 10.1063\/1.3530440<\/dc:identifier><dc:identifier>\n1089-7682<\/dc:identifier><dc:identifier>\nPURE: 3656577<\/dc:identifier><dc:identifier>\nPURE UUID: 7cbd336a-5004-4624-94f4-bef308f3fa62<\/dc:identifier><dc:identifier>\nBibtex: urn:6db343897447a0f7f37fffd782840b70<\/dc:identifier><dc:identifier>\nScopus: 78650716528<\/dc:identifier><dc:identifier>\nhttp:\/\/hdl.handle.net\/2164\/2240<\/dc:identifier><dc:identifier>\nhttp:\/\/dx.doi.org\/10.1063\/1.3530440<\/dc:identifier><dc:identifier>\nhttp:\/\/dx.doi.org\/10.1063\/1.3530440<\/dc:identifier><dc:language>\neng<\/dc:language><dc:relation>\nChaos<\/dc:relation><dc:rights>\nThis is the author's version of an article accepted for publication in Sch\u00fctte, M, Skupin, A, Segr\u00e8, D & Ebenhoeh, O 2010, 'Modeling the complex dynamics of enzyme-pathway coevolution.', Chaos, vol 20, no. 4. doi:10.1063\/1.3530440 Copyright \u00a9 2012 American Institute of Physics<\/dc:rights><dc:format>\n10<\/dc:format>\n<\/oai_dc:dc>\n<\/metadata>\n        <\/record>","journals":[{"title":null,"identifiers":["1089-7682","issn:1089-7682"]}],"language":{"code":"en","id":9,"name":"English"},"relations":["Chaos"],"year":2010,"topics":["R Medicine","R"],"subject":["Journal article"],"fullText":"Modeling the complex dynamics of enzyme-pathway coevolution\nMoritz Schu\u00a8tte\nMax Planck Institute of Molecular Plant Physiology,\nAm Mu\u00a8hlenberg 1, 14476 Potsdam-Golm, Germany and\nBioinformatics Program, Boston University, Boston, MA 02215, USA\nAlexander Skupin\nMax Planck Institute of Molecular Plant Physiology,\nAm Mu\u00a8hlenberg 1, 14476 Potsdam-Golm, Germany\nDaniel Segre`\nBioinformatics Program, Department of Biology, Department of\nBiomedical Engineering, Boston University, Boston, MA 02215, USA\nOliver Ebenho\u00a8h\nInstitute of Medical Sciences, Institute of Complex Systems and Mathematical Biology,\nUniversity of Aberdeen, Aberdeen AB24 3UE, U.K. and\nMax Planck Institute of Molecular Plant Physiology,\nAm Mu\u00a8hlenberg 1, 14476 Potsdam-Golm, Germany\n(Dated: December 26, 2010)\nMetabolic pathways must have coevolved with the corresponding enzyme gene sequences. How-\never, the evolutionary dynamics ensuing from the interplay between metabolic networks and genomes\nis still poorly understood. Here, we present a computational model that generates putative evo-\nlutionary walks on the metabolic network using a parallel evolution of metabolic reactions with\ntheir catalyzing enzymes. Starting from an initial set of compounds and enzymes, we expand the\nmetabolic network iteratively by adding new enzymes with a probability that depends on their\nsequence-based similarity to already present enzymes. Thus, we obtain simulated time courses of\nchemical evolution in which we can monitor the appearance of new metabolites, enzyme sequences,\nor even entire organisms. We observe that new enzymes do not appear gradually but rather in\nclusters which correspond to enzyme classes. A comparison with Brownian motion dynamics indi-\ncates that our system displays biased random walks similar to diffusion on the metabolic network\nwith long-range correlations. This suggests that a quantitative molecular principle may underlie\nthe concept of punctuated equilibrium as enzymes occur in bursts rather than by phyletic gradual-\nism. Moreover, the simulated time courses lead to a putative time-order of enzyme and organism\nappearance. Among the patterns we detect in these evolutionary trends is a significant correlation\nbetween the time of appearance and their enzyme repertoire size. Hence, our approach to metabolic\nevolution may help understand the rise in complexity at the biochemical and genomic levels.\nEvolution is a dynamic process in which\nspecies become extinct and new species\nemerge all the time. It is a disputed question\nwhether the emergence of new species pro-\nceeds with an approximately constant rate or\nwhether new species rather evolve in short\nperiods with a high speciation rate which are\nseparated by long silent periods in which only\nfew new species evolve. The latter scenario is\nreferred to as \u2019punctuated equilibrium\u2019 and\nhas recently experienced empirical evidence.\nHere, we present a model of metabolic evo-\nlution which suggests that punctuated equi-\nlibrium is also observed in the evolution of\nmacromolecules. This supports the hypoth-\nesis that underlying molecular mechanisms\nare responsible for the phenomenon of punc-\ntuated equilibrium in the evolution of new\nspecies. Our model uses available amino acid\nsequences for thousands of enzymes present\nin several hundred different organisms. By\ncomparing all these sequences, we estimate\nprobabilities that sequences may have evolved\nfrom one another. This information allows\nfor simulating putative scenarios how today\u2019s\nmetabolism might have evolved. By time se-\nries analysis we demonstrate that the exist-\ning sequence information strongly supports a\npunctuated equilibrium behavior and we also\ndemonstrate that this behavior is consider-\nably less pronounced if sequence information\nis deliberately neglected.\nIntroduction\nThe evolution of the modern biochemical pathways\nfrom an early proto-metabolism must have been shaped\nby innovations concurrently involving enzymes and chem-\nical compounds [1\u20133]. While it is generally assumed that\n2today\u2019s enzymes have evolved from a few ancestors that\nwere able to catalyze the first reactions, the details of\nthis evolutionary history are almost as uncertain as the\ndetails about the first self-replicating systems themselves\n[4\u20139]. Several scenarios have been proposed, the sim-\nplest suggesting a \u2019forward\u2019 evolution in which enzymes\nevolved that could make use of the end products of ex-\nisting metabolic pathways [10]. In the reverse assump-\ntion of a retrograde evolution, a necessary precursor be-\ncame depleted and enzymes have evolved that replenish\nthis required resource from other, still abundant, sub-\nstances [11]. While for both views supporting example\npathways may be found, the more complex assumption of\na patchwork evolution [12, 13] became more prominent\nwhen viewing metabolism as a whole. The method of\nnetwork expansion [14, 15] provides a simple evolution-\nary model that extends the forward evolution scenario on\nthe metabolic network comprising all biochemical reac-\ntions known to date. While this approach was useful to\nrelate structural to functional properties [16] by tracing\ncatalytic properties along the evolutionary tree [17], dis-\ncovering hints for an early separation of DNA and RNA\nmetabolism [18] and providing insight into the increase of\ncomplexity upon the rise of oxygen in the Earth\u2019s atmo-\nsphere [19], it is clearly too simple to reproduce realistic\nevolutionary paths. More recent models elaborating on\nthese ideas include the toolbox model of metabolic evolu-\ntion [20], which assumes that network evolution is driven\nby the need to explore new resources and can readily\nexplain the apparent quadratic scaling of the numbers of\ntranscription factors with the total number of genes. The\nview of metabolic evolution as a Markov process in which\nadditions or removal of reactions depend on the numbers\nof neighboring reactions [21] allows to estimate parame-\nters for the evolutionary dynamics and to assess possible\nevolutionary paths between two different network config-\nurations.\nThe above mentioned examples all provide plausible\narguments for a particular evolutionary path, but it is\nevident that, after the appearance of the first catalyzed\nreaction networks, the discovery of new chemical com-\npounds is strongly linked to the evolution of new en-\nzymes from existing ones. Hints that the evolution of\nthe sequence space defining contemporary enzymes mir-\nrors to some extent the gradual expansion of the chemical\nspace, defined by the variety of metabolites, were found\nby correlating sequence similarities to a distance of the\ncatalyzed reactions on the metabolic network [22].\nIt was argued [23] that such a coevolution promotes\nshort term avalanches during which a large number of\nnew enzymatic steps are invented, thus giving rise to a\npunctuated equilibrium behavior [24, 25]. In this paper,\nwe present a model of metabolic evolution combining\ngenome scale data, tools from bioinformatics, dynamic\nmodeling and time series analysis with the goal of study-\ning the apparent coevolution of small molecules and cat-\nalysts in further detail. As a basis for our exploration, we\nuse the KEGG database [26, 27] which provides a com-\nprehensive collection of biochemical reactions from sev-\neral hundred organisms and information on amino acid\nsequences of the respective catalyzing enzymes. While\nexisting models [28\u201330] investigate the evolution of arti-\nficial metabolic networks, our model explicitly considers\navailable biological data and assumes that those enzymes\nare more likely to evolve for which a related enzyme has\nalready been discovered. We systematically explore how\nthe evolutionary dynamics depends on the coevolution of\nmetabolites and enzymes by introducing a tunable pa-\nrameter reflecting the importance of sequence similar-\nity. Thus, we can separate the effects of a sequence-\nbased evolution from one in which the discovery of new\nenzymes is only restricted by stoichiometric constraints.\nWe find that simulations taking into account existing se-\nquence data display a punctuated equilibrium behavior\nand thus support the view that evolution, also on the\nlevel of metabolic networks, occurs in bursts of rapid se-\nquences of new inventions, rather than in a gradual fash-\nion [24].\nModel description\nThe enzymes found in contemporary organisms are\nhighly efficient and usually very specific catalysts for\nchemical reactions. The amino acid sequences of present-\nday enzymes are the outcome of a long evolutionary his-\ntory, in which they were subjected to random mutations\nand selective pressures favoring only particular sequences\nwhich may efficiently perform useful functions. A dif-\nficulty in modeling the evolutionary process of enzyme\nevolution is that neither sequences for early or extinct\nenzymes nor the precise criteria for the selective pres-\nsures are known.\nOur proposed simple model for the evolution of\nmetabolism takes these limitations into account. Instead\nof aiming at describing the evolution of networks of par-\nticular organisms, we focus on the network comprising\nreactions from several hundreds of species. We can thus\nfocus on very general selective principles and ignore the\nspecific pressures that were acting to support the evolu-\ntion of highly specialized functions. Due to the lack of\nknowledge of early and now extinct protein sequences,\nour model is limited to all described biochemical reac-\ntions and sequence information available to date.\nWe mimic the evolution of the network comprising the\npresently known metabolic reactions by a simple process\nin which the network grows in size by consecutive addi-\ntion of single enzymes. The process is initiated by as-\nsuming that a certain combination of primitive metabo-\nlites are abundant in the environment. We assume that\nnew enzymes may evolve from existing ones through a\nseries of amino acid exchanges. Since the mechanism for\nsuch mutations is essentially a random process, we as-\nsume that the probability to discover a new functional\nenzyme from an existing one is higher, the more similar\ntheir corresponding sequences are. Thus, at any stage\n3of our simulated evolutionary process in principle every\nknown enzyme may evolve. However, we assume that\nonly those newly discovered enzymes will be positively\nselected which can perform a useful function. We there-\nfore impose a selective pressure by accepting only those\nnew enzymes which can catalyze a biochemical reaction\nfrom reactants that may in principle be produced from\nreactions already present in the network. A temporal\nscale is introduced by assuming that evolutionary events\nwith a higher probability tend to occur faster.\nThe evolutionary simulation is implemented as a Gille-\nspie algorithm [31] for the simulation of stochastic expan-\nsion processes and can be summarized in the following 7\nsteps:\n1. A set of primitive compounds and first enzymes is\nselected. These comprise the initial network.\n2. On the basis of the actual network structure, all\nenzymes that can catalyze a reaction utilizing only\nsubstrates present in the network are identified. For\neach enzyme i, a propensity pi is calculated in de-\npendence on the sequence similarity with already\npresent enzymes (see below). The propensity de-\nscribes the probability that the enzyme is discov-\nered in one unit time.\n3. Depending on the propensities, the time tnext of\nthe next evolutionary event is determined by an\nexponentially distributed random variable with the\nmean given by 1\/\n\u2211\npi.\n4. Which particular enzyme is added at time tnext\nis determined by a uniformly distributed random\nnumber. The probability that enzyme j is selected\nis given by pj\/\n\u2211\npi.\n5. All reactions catalyzed by the selected enzyme as\nwell as the corresponding products, are added to\nthe network.\n6. Due to the incorporation of new substances, new\nreactions catalyzed by enzymes already present in\nthe network may be executable. These reactions\nand their products are added as well. The same\nholds true for any newly occurring spontaneous re-\nactions.\n7. The process is repeated with step 2 until no new\nenzymes can be added to the network.\nIterating this expansion process leads to a series of in-\nvented enzymes where their invention times depend on\nthe underlying dynamics. Hence, we use the inter-\nenzyme intervals (IEI) which are defined by the sequence\nof tnext and correspond to waiting times to characterize\nthe evolutionary process.\nIn contrast to the conceptually similar method of net-\nwork expansion introduced in [15], in our model enzymes\nare considered to be the basic units of the networks rather\nthan reactions. As a consequence, the discovery of a new\nenzyme leads to the addition of all reactions that it can\ncatalyze. Moreover, whereas in the method of network\nexpansion all reactions which can possibly occur are si-\nmultaneously added to the growing network in each step,\nwe here only add a single enzyme in each expansion event.\nDefining probabilities for enzyme appearance introduces\na stochastic component which is inherent to all evolution-\nary processes. Further, by assigning characteristic times\nfor the single evolutionary events our model possesses an\nintrinsic definition of an evolutionary time coordinate.\nLike in many applications of the method of network ex-\npansion (see e.g. [32, 33]), we also assume that common\ncofactors do not specifically have to be produced dur-\ning the expansion process before they can be used (see\nMethods). The rationale for this is that their metabolic\nfunctions can in principle also be carried out by sim-\npler pairs of molecules. For example, the transfer of\nphosphate groups by ATP\/ADP is possible by pyrophos-\nphate and phosphate, as demonstrated in the bacterial\nphosphotransferase system, the role of NADH\/NAD+ as\nelectron carriers can in principle be performed by metal\nions such as Fe2+\/Fe3+ with different oxidation states.\nSequence distances and propensities\nOne particular focus of our model is the investigation\nof the evolutionary dynamics for different assumptions\non how strongly the evolvability of novel enzymes from\nexisting ones depends on the respective sequence similar-\nities.\nFor roughly half of all functionally different enzymes\npresent in the KEGG database [27], sequence information\nis available. The amount of information for one partic-\nular enzyme commission (EC) number can vary between\nnone and a couple of thousand different sequences. In\ntotal KEGG (release 53) provides around one million se-\nquences from various organisms for about 3000 EC num-\nbers. We reduced the space of possible sequences by\nconstruction of a consensus set using the clusters of or-\nthologous groups of proteins (COG) database [34\u201337] as\na benchmark. This enables to drop redundant sequences\nbetween functionally equivalent enzymes having the same\nEC number, see [22] and the Methods section. Here-\nwith, we obtain a set of 11925 sequences that code for\n3048 EC numbers for which we calculate all mutual dis-\ntances using the \u2019score\u2019 of the best BLAST alignment\nto assess the probability that sequence A evolves into B.\nThe Blast \u2019score\u2019 provides evolutionary knowledge about\nsingle amino acid substitutions, insertions, and deletions\nfrom which we define the distance between sequence A\nand B as\nDAB = 1\u2212\n2 \u00b7 score(A,B)\nscore(A,A) + score(B,B)\n. (1)\nThe pairwise distance ranges from 0 for identical se-\nquences to 1 for sequences without any significant align-\nment. For EC numbers for which no sequence is avail-\n4able, we assign distances to all other enzymes randomly\nfrom the distribution of all calculated sequence distances.\nWhile it is certainly possible that this introduces a bias in\nour results, we consider this approach the best possibility\nunder the circumstances of incomplete information.\nIt is plausible to assume that, during evolution, the\nprobability to discover a new enzyme is higher, if a similar\nenzyme already exists. We denote by dmini the minimal\ndistance for enzyme i to all enzymes that have already\nbeen found. To have a tunable parameter that weighs\nthe strength of the influence of the protein sequences, we\ndefine the propensities for a new enzyme to be discovered\nby\npi =\n1\ndmini\n\u03b3 . (2)\nThis definition implies that we assume that the expected\ntime to find a new enzyme depends only on the minimal\ndistance to existing enzymes scaled by the exponent \u03b3.\nThe extreme assumption of \u03b3 = 0 leads to equal propen-\nsities for all possible new enzymes and thus reflects a\nhypothetical case in which sequence information has no\ninfluence on the selective process, and the evolution of\nthe network is exclusively determined by chemical con-\nstraints. A value of \u03b3 = 2 corresponds to the assumption\nthat the possible sequence space is explored in a process\nanalogous to a random walk, for which the average dis-\ntance covered is proportional to the square root of the\nelapsed time. The other extreme, \u03b3 \u2192 \u221e, reflects the\nhypothetical case of the path following least resistance\nin which always the enzyme with the closest distance to\nan existing enzyme will be discovered in the next step\n[23, 38].\nMethods\nData for network structure and sequences\nWe use the KEGG database, release 53. The\n\u201dgenes.pep\u201d in fasta format is downloaded for protein\nsequences and the ligand-file for reactions. In order to\ncurate the data erroneous reactions, that are not bal-\nanced or contain unspecified parts like a rest group, are\nrejected. The irreversibility information is obtained by\nscanning the pathway maps [32, 39]. Such reactions\nthat contain the cofactor pairs ATP\/ADP, NAD\/NADP,\nNADH\/NADPH, or Co-A\/Acetyl-CoA are added a sec-\nond time pured of the cofactors, assuming that they are\npossible during expansion but no cofactor is produced.\nSequence distance and consensus set\nIn order to calculate the evolutionary distance\nbetween any two enzyme we use pairwise sequence align-\nment using BLAST (version 2.2.22, standalone blast,\nhttp:\/\/www.ncbi.nlm.nih.gov\/blast\/blast overview.shtml):\nbl2seq -i SequenceA -j SequenceB -p blastp -F F -o\noutput with the default substitution matrix BLOSUM62.\nThen we score the alignment by the best hit of the\n\u2019score\u2019 from the output getting the distance DAB given\nby Eq. (1). This is not a distance by mathematical\ndefinition as it does not fulfill the triangular inequality.\nIt ranges from 0, identical, to 1, completely different [22].\nKEGG release 53 contains around one million sequences\ncontaining an EC (enzyme commission) number in their\ndescription. We sort these sequences by EC numbers\nand choose representatives from each set by taking only\ninto account those that have a mutual distance, defined\nsimilarly to (1), above 0.95 and drop all others. The\ncutoff has been chosen according to a benchmark using\nthe clusters of orthologous groups of proteins (COG)\ndatabase, [22, 34]. This reduces the sequence set to\n11925 for 3048 EC numbers. For EC numbers that\nappear in the reaction set but for which we do not have\na sequence we randomly pick a distance to any other\nsequence from the distribution of distances between all\nknown ones.\nSeeds\nWhat are the first metabolites and enzymes? We\nuse the following primordial seed of compounds: H2O,\nCO2, H2SO4,H2PO3, NH3 and H\n+, [1, 40]. In or-\nder to identify the putative first enzymes, we use work\nby Y. Sobolevsky [41\u201343] who identified common con-\nserved protein fragments in 131 proteomes. One partic-\nularly long fragment LSGGQQQRVAIARAL was found\nin bmn:BMA10247 1739 and tpe:Tpen 0904 and we\nadded the remaining two of the same function 3.6.3.21,\neco:b2306 and hpa:HPAG1 0922, to the seed of enzymes.\nResults\nThe expansion: process and enzyme sequences\nThe expansion process starts from a given set of\nmetabolites and enzymes, called the seed [14\u201317]. This\nset represents a putative prebiotic chemical environment.\nA necessary requirement for the evolution of a substantial\nreaction network is the presence of all essential chemical\nelements in the seed. Here, we consider only the atoms\nH, C, O, N, P and S, because 80% of all metabolites\nin the KEGG database are composed of these elements.\nAs seed, we choose H2O, CO2, H2SO4, H2PO3, NH3 and\nH+ [1, 40]. The choice of a first enzyme sequence is made\nby using conserved sequence fragments [41\u201343] to be en-\nzymes of the function 3.6.3.21, see Methods.\nTo study the effect of sequence information, controlled\nby the parameter \u03b3 introduced in Eq. (2), we perform\nsimulations with five values \u03b3 = 0, 2, 10, 20, 100. We ac-\ncount for the stochasticity of the simulated evolutionary\n5walks by performing 200 simulation runs for each selected\nvalue of \u03b3, which correspond to scenarios in which se-\nquence information is completely ignored (\u03b3 = 0) to the\ncase in which a strict order of enzyme appearance is im-\nposed by the sequence relatedness (\u03b3 = 100). As a di-\nrect consequence of the definition of the propensities of\nEq. (2), simulations with different \u03b3 proceed on very dif-\nferent time scales, with the total time required to explore\nthe entire network (inlet in Fig. 1A) being roughly 1000\ntimes longer for the random scenario when compared to\nthe scenario with high \u03b3. In order to compare the ve-\nlocities of the evolutionary processes between scenarios\nwith different \u03b3\u2019s, we normalize for each \u03b3 the time by\nthe average final time of the respective 200 simulations\nand term the resulting temporal measure the normalized\ntime, as opposed to the non-normalized absolute time.\nFig. 1A provides a comparison of the expansion processes\non both time scales.\nThe expansion process with maximum sequential or-\nder, \u03b3 = 100, leads to the quickest exploration of the\nnetwork also on the normalized time (Fig. 1A). The be-\nhavior in terms of the number of metabolites as a func-\ntion of time looks qualitatively similar [44], and obeys\nparticularly the same ranking in dependence on \u03b3.\nWhich novel sequences may actually perform a useful\nfunction by catalyzing a biochemical reaction depends\non the specific structure of the metabolic network at any\ngiven time during the evolutionary process. The number\nof these potential new enzyme sequences can be under-\nstood as a measure of the evolvability of the network\n[45]. To compare networks of identical sizes for scenarios\nwith different \u03b3, we introduce a third time measure, the\nenzyme time, defined by the current network size deter-\nmined by the number of contained enzymes. In Fig. 1B\nthe evolvability is shown in dependence of the enzyme\ntime for different values of \u03b3. For all values of \u03b3, the\ntemporal change of the evolvability can be divided into\nthree phases. Until enzyme time 1500\u20132000, it increases\nrapidly before it reaches a plateau which is more pro-\nnounced for higher values of \u03b3. In the final phase after\nenzyme time 5000 the limitation of the enzyme pool re-\nsults in a rather constant decrease. The off-set on the\ny-axis for enzyme time 0 in Fig. 1B results from a pe-\nculiarity of reaction R00086, ATP + H2O \u21d0\u21d2 ADP +\nPi. This reaction can be catalyzed by enzymes of 66 EC\nnumbers and is associated with 355 different sequences.\nConsidering that ATP is treated as a cofactor, for which\nwe do not explicitly require that it can be produced by\nthe present network, this reaction can be added even to\nthe initial seed network at enzyme time 0. Addition of\nthis reaction does not expand the chemical functions of\nthe network, but increases the variety of sequences from\nwhich potentially new sequences may evolve. Measur-\ning the evolvability in numbers of new executable reac-\ntions results in qualitatively similar curves, with the main\ndifferences that the offset is not observed and that the\ncurves exhibit a negative skewness instead the positive\none, see [44].\nFor both measures, it is remarkable that the evolvabil-\nity is systematically larger for scenarios with lower \u03b3 in\nwhich new sequences are added more randomly. This ob-\nservation suggests that in this case consecutively added\nenzymes are rather unrelated in their chemical function,\nleading to a high metabolic diversification. In contrast,\nin the scenarios in which sequence information is impor-\ntant, the preferential discovery of enzymes similar to ex-\nisting ones leads to an evolutionary exploration of local\nneighborhoods and thus to denser and more functional\nnetworks.\nTo support this hypothesis, we investigate the appear-\nance of metabolites which only occur in a single reaction\nof the KEGG database and which can thus be seen as\nthe border of the currently known metabolism. Overall,\nin the KEGG subnetwork that is reached by our sim-\nulated evolutionary processes, 29.5% of the metabolites\n(661 of 2237, see [44]) belong to this class. In Fig. 1C,\nthe appearance of these border metabolites is depicted\nover enzyme time. Evidently, the influence of sequence\ninformation leads to a quicker exploration of the border.\nThis supports the notion that, as a tendency, for large \u03b3\npathways are completed in a consecutive order, whereas\nfor small \u03b3 pathways tend to be explored in parallel.\nIn Fig. 1D we depict how the actual minimal sequence\ndistance for the selected enzymes changes with enzyme\ntime. For large values of \u03b3, in which a strong preference\nfor sequences with a low minimal distance to existing\nenzymes prevails, the curve exhibits a characteristic U-\nshape. The initial drop is explained by the low number of\nenzymes within the evolving network and the restricted\nchoice of new functional enzymes; the increase late in the\nprocess results from the fact that only those sequences\nremain unattached which have no noticeable sequence\nsimilarity to any other sequence. For smaller \u03b3 enzymes\nare picked at random and the pure increase in network\nsize results in a lower average minimal distance.\nDynamic bursting in evolution\nThe invention of new classes of enzymes often goes\nalong with a completely new sequence structure and may\nopen a new branch in the evolutionary process. Such a\nnovel enzyme can have deep impact on the evolution-\nary dynamics, since once a new reaction is found, simi-\nlar reactions may evolve in close temporal neighborhood.\nHence, a strong sequence dependency is expected to lead\nto a bursting like behavior of enzyme attachment. This\nwould reflect the principle of punctuated equilibrium on\na molecular level [23\u201325]. In the framework of punctu-\nated equilibrium, new species do not appear gradually at\nequally spaced time points but in rapid successions fol-\nlowed by silent intervals. We exploit the capability of the\ncurrent model to investigate the evolutionary dynamics\nto test if the sequence dependency of the network expan-\nsion may substantiate this hypothesis.\nFirst, we determine the appearance times for a new\n6 0\n 0.1\n 0.2\n 0.3\n 0  2000  4000  6000  8000\nFr\nac\ntio\nn \nof\n b\nor\nde\nr m\net\nab\nol\nite\ns\nEnzyme Time\n\u03b3=0\n\u03b3=2\n\u03b3=10\n\u03b3=20\n\u03b3=100\n 0.5\n 0.6\n 0.7\n 0.8\n 0.9\n 1\n 0  2000  4000  6000  8000\nM\nea\nn \nse\nqu\nen\nce\n d\nist\nan\nce\nEnzyme Time\n 0\n 2000\n 4000\n 6000\n 8000\n 0  0.2  0.4  0.6  0.8  1\nN\num\nbe\nr o\nf e\nnz\nym\nes\nNormalized Time\n 0\n 2000\n 4000\n 6000\n 8000\n 1e-05  0.1  100\nAbsolute Time\n 0\n 500\n 1000\n 1500\n 2000\n 2500\n 3000\n 3500\n 0  2000  4000  6000  8000\nPo\nss\nib\nle\n e\nnz\nym\ne \nse\nqu\nen\nce\ns\nEnzyme Time\nC D\nA B\nFIG. 1: Comparison of the expansion process for different strengths of the sequence-information parameter \u03b3. Means of 200\nsimulations are shown and for all panels the color code given in panel C holds. A: The network size measured by the number\nof enzymes attached to the network is shown over time. The expansion velocity increases with \u03b3 in both normalized time and\nin absolute time (inlet) obtained from the Gillespie algorithm. B: The number of attachable enzymes at every step in the\nexpansion process can be understood as the evolvability of the network. Using sequential information leads to a less evolvable\nbut thus denser network. C: How quickly do we expand to the border of existing knowledge. At every step in enzyme time\nwe plot the number of detected metabolites which only participate in one reaction in KEGG. Higher \u03b3 approach the border\nfaster supporting the assumption of a smarter expansion. D: Mean sequence distances between every new enzyme and its\nduplication partner. The \u03b3 = 0 curve decreases since by chance for any new enzyme on average a similar sequence can be found\nif more enzymes are present in the current network. For higher \u03b3 isolated sequences without any similarity to all others are\npreferentially found at the end resulting in an increase.\nenzyme in dependence on \u03b3 as shown in Fig. 2A. Here\nthe invention of 500 enzymes (enzyme time 1500\u20132000)\nis plotted for 3 different values of \u03b3 by a vertical black\nline. Again it is obvious that the sequence dependence\nleads to an acceleration of evolution as can be seen by\ncomparing the normalized time of each panel. A closer\nview reveals a more homogeneous structure for smaller\n\u03b3. For \u03b3 = 0, the 500 events are rather homogeneously\ndistributed over time with only few gaps. For \u03b3 = 20,\nthe number and size of visible silent intervals increases\nbecause the 500 enzymes are invented more clustered.\nIn case of very strong sequence dependence with \u03b3 =\n100, the dynamics exhibit an even stronger clustering of\nevents. The bursting dynamics leads to relatively large\ninter-cluster distances and subsequently to short intervals\nwithin an enzyme-class cluster because the number of\nenzymes is constant for all three scenarios, see [46].\nThese observations are subsumed in Fig. 2B where the\nlogarithm of the frequency of inter-enzyme intervals (IEI)\nin normalized time are plotted. First of all, larger \u03b3 lead\nto shorter IEI in normalized time corresponding to faster\nevolutionary dynamics. The bursting like behavior leads\nto multiple peaks in the distribution for larger \u03b3 and a flat\nplateau for \u03b3 = 100 which has similarly been observed in\nearlier models [47, 48]. Summarizing, the clustered ap-\npearance of new sequences hints at a molecular principle\nof punctuated equilibrium. Interestingly, these distribu-\ntions deviate from previous studies about self-organized\ncriticality [49, 50]. The differences are probably caused\nby the different generating processes. While in the former\ninvestigations the number of possible events was unlim-\nited, our model has a finite number of events since it is\nrestricted to existing enzymes. This may be seen as a\ndisadvantage of the model but at the same time it may\n7 1\n 10\n 0  2000  4000  6000\nCo\nef\nfic\nien\nt o\nf v\nar\niat\nion\n(w\nind\now\n si\nze\n 10\n0)\nEnzyme Time\n 1\n 10\n 100\n 1000\n\u221260 \u221250 \u221240 \u221230 \u221220 \u221210  0\n \nlog(\u2206t)\n\u03b3 = 0\n 1\n 10\n 100\n 1000\n  \nNu\nm\nbe\nr o\nf i\nnt\ner\nva\nls \n\u2206t\n \n\u03b3 = 20\n 1\n 10\n 100\n 1000\n  \n \n \n\u03b3 = 100\n 10\n 100\n 1000\n 10000\n 0.001  0.01  0.1\nFa\nno\n fa\nct\nor\n F\n(T)\nT\n\u03b3=100\nFa\nno\n fa\nct\nor\n F\n(T)\n\u03b3=20\nFa\nno\n fa\nct\nor\n F\n(T)\n\u03b3=10Fa\nno\n fa\nct\nor\n F\n(T)\n\u03b3=2\nFa\nno\n fa\nct\nor\n F\n(T)\n\u03b3=0\n 0\n 0.1\n 0.2\n 0.3\n 0.4\n0 0.5 1 1.5 2\nAu\nto\nco\nrre\nla\ntio\nn \nC x\nx \n(\u03c4)\nLag \u03c4\/10-3\n 0.01\n 0.1\n 1\n10-2 10-1 102\n 0.054  0.056  0.058  0.06  0.062  0.064  0.066  0.068\n\u03b3=\n0\nNormalized Time\n 0.038  0.039  0.04  0.042  0.044Ne\nw \nen\nzy\nm\ne\n\u03b3=\n20\n \n 0.0034  0.0035  0.0036  0.0037\n\u03b3=\n10\n0\n \n 1500  2000Enzyme Time\nB C\nD E\nA\nFIG. 2: The acquisition of new enzymes happens in bursts of increasing strength for larger sequence sensitivity. Here we show\none example run in A\u2013C and means of 200 runs in D and E. A: Spike train with one bar at every incident of a new enzyme.\nThe panel shows a window of 500 new enzymes for each \u03b3 on its particular normalized time. While for \u03b3 = 0 the enzymes\nappear almost equidistantly, larger \u03b3 leads to enzyme bursts. B: Distribution of time intervals between any two new enzymes\n(IEI). For higher \u03b3 the distributions are shifted to smaller distances and exhibit multiple peaks. C: The coefficient of variation,\nCv = \u03c3\/\u00b5, measured in sliding frames of 100 enzymes indicates multiple characteristic time scales. The peaks point to times\nof evolutionary explosions. D: The autocorrelation Cxx(\u03c4) of IEIs supports the bursting behavior further. For large \u03b3 IEI are\nstrongly correlated on a short time scale whereas small \u03b3 lead to no significant correlation. E: The fit of the data to the Fano\nfactor of biased Brownian motion enables to estimate the correlation time \u03c4corr. (For all color panels the legend of panel E\nholds.)\n8\u03b3 Cv D\/10\n5 \u03c4corr D \u00b7 \u03c4corr\/10\n3\n0 1.14 \u00b1 0.03 0.57 \u00b1 0.05 0.20 \u00b1 0.03 11.4 \u00b1 2.0\n2 1.2 \u00b1 0.04 0.46 \u00b1 0.04 0.29 \u00b1 0.06 13.3 \u00b1 3.0\n10 1.4 \u00b1 0.07 0.66 \u00b1 0.06 0.16 \u00b1 0.03 10.6 \u00b1 2.2\n20 1.9 \u00b1 0.1 1.1 \u00b1 0.08 0.081 \u00b1 0.009 8.9 \u00b1 1.2\n100 4.8 \u00b1 0.8 25.6 \u00b1 2.3 0.0028 \u00b1 0.0003 7.2 \u00b1 1.0\nTABLE I: Coefficients of variation and parameters of Fano\nfactor fits averaged over 200 runs. The coefficient of variation\nis measured in the domain of the first 6000 enzymes. The data\nis fitted to the Fano factor Eq. (4) via parameters diffusion\ncoefficient D and correlation time \u03c4corr.\nreflect biological constraints such as a limited number of\nfunctional protein sequences.\nFor a further analysis of the evolutionary dynamics, we\ncharacterize the process in terms of the IEI by the Co-\nefficient of variation Cv [51]. We use the resulting spike\ntrains shown in Fig. 2A to determine the average IEI \u00b5\nand the corresponding standard deviation \u03c3 and calculate\nthe Coefficient of variation Cv = \u03c3\/\u00b5. For an unbiased\nevolution (\u03b3 = 0), we expect the characteristics of a Pois-\nson process as a generating process since the time step\ndetermined by the Gillespie algorithm is independent of\nthe history and purely random. A Poisson process leads\nto an exponential distribution of the waiting times [52]\nimplying Cv = 1 [53].\nSince we are interested in the temporal characteristics\nof the expansion, we use a sliding window of 100 enzymes\nto calculate Cv in dependence on the evolutionary steps.\nIndeed, the Cv for \u03b3 = 0 (black line) fluctuates around 1\nas shown in Fig. 2C. Increasing the influence of sequence\ninformation by increasing \u03b3, leads to systematically in-\ncreased Cv > 1. This is a strong indicator for multiple\ncharacteristic time scales [51, 53]. These are given here\non the one hand by the typical time to explore a new\n\u2019class\u2019 of enzymes, a slow process in which a novel se-\nquence, unrelated to existing ones, evolves, and on the\nother hand by the characteristic time to invent an en-\nzyme with a sequence similar to an already present one.\nFor the shown window size of 100, the Cv for \u03b3 = 100\n(blue) exhibits several peaks and reaches values up to\n10 indicating strong bursting. The peaks may hint at\nimportant points of evolutionary explosion.\nThis analysis is further confirmed by the comparison of\nCvs determined with different sliding window sizes (com-\npare Fig. 2C and [54]). The comparison clearly demon-\nstrates that the peaks of Cv are not an effect of the lim-\nited window size since even for larger window sizes the\nCv reaches comparable values [54] and exhibits peaks. In\nTable I the systematic increase of the asymptotic Cv with\nincreasing \u03b3 is given for all IEIs up to an Enzyme Time\nof 6000. This demonstrates the different characteristic\ntime scales of the evolutionary process.\nTo substantiate this analysis we also calculated the au-\ntocorrelation function Cxx(\u03c4) of the normalized IEIs for\neach \u03b3 as shown in Fig. 2D. For \u03b3 = 100 we observe strong\ncorrelations for small time lags \u03c4 indicating bursting. For\nunbiased evolution (\u03b3 = 0), no significant correlation on\nany time scale \u03c4 is observed which is in accordance with\nour assumed reason for bursting, the sequence informa-\ntion. In the inset of Fig. 2D, Cxx(\u03c4) is plotted on a\nlog-log scale. In this representation, the autocorrelation\ndecreases linearly at the beginning as it is observed in\nother models of self-organized criticality [50]. But due\nto the limited enzyme pool size there is a strong cross\nover to the pure random behavior for large \u03c4 . Thus,\nour enzyme based model can quantitatively support the\nbursting dynamics of punctuated equilibrium.\nWhile the Coefficient of variation allows for the anal-\nysis of dynamical variations on the scale of the average\nIEI \u00b5, the Fano factor [55] characterizes variability in IEI\non all accessible time scales T [56]. Therefore, the nor-\nmalized time is divided in M non-overlapping windows\nand in each window the number of invention events N is\ndetermined. The Fano factor is defined as\nF (T ) =\n\u2329\nN2\n\u232a\n\u2212 \u3008N\u3009\n2\n\u3008N\u3009\n, (3)\nwhere the time scale T = Ttot\/M is given by the ratio\nbetween total time Ttot and the number of windows M .\nFor lim M \u2192 \u221e, i.e. T \u2192 0, F equals 1. The de-\npendence of F (T ) is shown in Fig. 2E and exhibits an\nincreasing and saturating behavior. The increase is an\nindicator of long-range correlations. Because an increase\nis observed for all values of \u03b3, these correlations are most\nlikely a result of biochemical constraints given by the un-\nderlying metabolic network structure.\nSince the analysis of the Cv has already shown the\nstochastic character of the expansion process, we hypoth-\nesize that the evolutionary process basically represents a\ndiffusion process on the network. The evidence for long-\nrange correlation suggests an Ornstein-Uhlenbeck pro-\ncess [52, 57] as approximative dynamics. For such a pro-\ncess the Fano factor can be expressed as [56]\nF (T ) = D \u00b7 \u03c4corr\n(\n1\u2212\n\u03c4corr\nT\n[\n1\u2212 exp\n(\n\u2212\nT\n\u03c4corr\n)])\n, (4)\nwhere D denotes a scaled diffusion coefficient and \u03c4corr\nis the correlation time. In order to characterize the dy-\nnamics on the network, we fit Eq. (4) to the Fano factor\ndetermined by Eq. (3) from simulations. We find a very\ngood agreement for all \u03b3 values as shown in Fig. 2E. From\nthe fitting procedure, we can estimate the diffusion co-\nefficients D and correlation times \u03c4corr for each \u03b3. The\nacceleration due to the sequence information leads to an\nincrease of D accompanied by larger Cvs. The correlation\ntime decreases in the units of relative time. This is caused\nby the faster expansion for larger \u03b3. In this case, the in-\nvention of a novel sequence, representing a new class of\nenzymes, triggers the discovery of related sequences in\nshort evolutionary time and thus the correlation time is\nshorter. For smaller \u03b3, new classes are invented before all\nenzymes with a similar sequence structure are included\n9and thus correlation ranges over enzyme classes leading\nto larger \u03c4corr. From Eq. (4) we expect that the prod-\nuct D\u03c4corr should stay rather constant what is verified in\nTable I.\nAppearance: order of enzymes, compounds and\norganisms\nFrom the observation of enzyme bursts and of the cor-\nrelation time for large \u03b3 we expect that similar organisms\nappear at similar times, what would be a further confir-\nmation of punctuated equilibrium in organismic evolu-\ntion. Following our previous results indicating bursting\nevolutionary behavior in the time series of new enzymes,\nwe will now conclude on the biological and biochemical\noutcomes of the appearance and order of metabolic com-\npounds, enzymes, and even entire organisms.\nNot all evolutionary paths are possible. Rather, the or-\nder of enzyme appearance is constrained by two factors.\nFirst, the selection criteria that only useful reactions are\npositively selected implies a chemical constraint. Some\nenzymes require other enzymes to be present since oth-\nerwise their required substrates could not be provided.\nThe second constraint results from sequence similarity.\nIt is conceivable that the sequence structure favors a cer-\ntain order of enzyme evolution to avoid large jumps in\nsequence space.\nOur model allows to distinguish the biochemical\nand evolutionary constraints which have shaped the\nmetabolic map. To achieve this, we determine for \u03b3 = 10\nand \u03b3 = 0 all pairs of enzymes which appear in the same\ntemporal order in all 200 runs, excluding the seed en-\nzymes which appear by definition before all others. Or-\ndered pairs found for \u03b3 = 0 can only result from bio-\nchemical constraints since in this case sequence informa-\ntion is ignored. To identify those ordered pairs which\nresult as a consequence of sequence similarities, we re-\nmove the pairs found for \u03b3 = 0 from the pairs deter-\nmined for \u03b3 = 10. The remaining ordered pairs define a\ntree with 7117 nodes and 1348709 edges. Since visualiza-\ntion of such a large tree is impractical, we concentrate on\nall paths of length three or higher from root to leaf node\n(see Fig. 3A and [58] for a larger fraction of the tree).\nMost of the enzymes on the first hierarchy level be-\nlong to essential pathways of central carbon metabolism.\nEnzymes in lower levels tend to belong to biosynthesis\npathways of more specialized compounds. The tree gives\ninsight into an enzyme\u2019s role in an evolutionary context.\nFor example, enzymes 2.1.1.128 (a methyltransferase) or\n1.2.1.38 (an oxidoreductase) appear only after a consid-\nerable number of precursors (5 and 32 respectively) have\nevolved. Apparently their sequences could have only\nevolved after many sequences for enzymes of central car-\nbon metabolism had arisen. Interestingly, the opposite\nobservation can be made for another methyltransferase,\nenzyme 2.1.1.116. The discovery of five enzymes directly\ndependent on the evolution of this particular sequence\nmakes it plausible that this enzyme has presented an evo-\nlutionary bottleneck.\nHighly important for the origin of life is the synthesis\nof amino acids as building blocks of proteins, and nu-\ncleotides for DNA and RNA. The amino-acids appear\nin good correlation (rank correlation 0.7) with previous\nresults investigating the robustness of E. coli\u2019s network\nagainst reaction removal [33] (see Fig. 3B). This is not\nsurprising and can be explained by stoichiometric effects.\nIf more metabolic paths allow for the synthesis of a par-\nticular amino acid, it is likely to be discovered earlier. At\nthe same time, one would expect that its production will\nbe more robust against removal of reactions. The order\nof appearance of amino acids also reflects the commonly\nknown biochemical synthesis pathways. Glutamate as\na precursor of proline and arginine is synthesized first.\nIn bacteria aspartate is the common precursor for ly-\nsine, threonine, and methionine. For all used \u03b3 values\nexcept \u03b3 = 100 this order is reproduced in the evolution-\nary scenarios. However, for \u03b3 = 100 threonine appears\nslightly before aspartate. The pyruvate family of leucine,\nisoleucine, and valine is detected in close proximity. Fur-\nthermore, the aromatic amino acids, phenylalanine, tryp-\ntophan, and tyrosine, labeled by asterisks appear rather\nlate (position 16, 17, and 19 for \u03b3 = 100) as a result of\ntheir more complex chemical structure.\nAdditionally, we investigate the relation between the\nsimplicity of synthesis and the actual usage of amino\nacids. For this, we compare the time of appearance to\nthe frequency of the amino acids in the enzyme sequences\nof our consensus set and find a significant correlation for\n\u03b3 = 100 (Spearman 0.51, p-value 0.02, see [59]). As-\nsuming that metabolites detected earlier in evolution are\ncheaper to synthesize, supports the hypothesis that cost\nminimization is an important factor for amino acid usage\nin protein synthesis.\nOrganisms own a specific metabolism depending on\nresources and living environment. Studying when the\nmetabolic networks of various species have evolved al-\nlows speculations about the evolutionary tree of life.\nClearly, the discovery of a complete set of an organ-\nism\u2019s reactions does not necessarily reflect its appear-\nance during evolution. However, it presents a prereq-\nuisite for the respective metabolism to have evolved.\nFig. 3C presents the discovery of the metabolic enzymes\nof 1097 organism specific networks retrieved from the\nKEGG database. The size of the respective networks\nare plotted versus the average enzyme time when 80%\nof an organism\u2019s enzymes were found (\u03b3 = 10). For\nhigher organisms the enzyme time of appearance corre-\nlates well with the network size (Pearson correlation: an-\nimals=0.88, plants=0.95, fungi=0.75, protists=0.77, ar-\nchaea=0.055, bacteria=0.25). Also, similar organisms\ntend to appear closely together, see [60]. For example,\neight species of Drosophila occur from enzyme time 3571\nto 3639, six Plasmodium species from enzyme time 3179\nto 3317, or seven Mycoplasma from enzyme time 2956 to\n3171.\n10\nadenine\nguanine\nuracil\ncytosine\nthymine\nserine\nalanine\nglycine\nthreonine\naspartate\nasparagine\nglutamate\nglutamine\nproline\nhistidine\nvaline\narginine\nisoleucine\nleucine\ncysteine\ntyrosine*\nphenylalanine*\nmethionine\ntryptophan*\nlysine\n 0  1000  2000  3000  4000  5000  6000\nEnzyme Time\n\u03b3=0\n\u03b3=2\n\u03b3=10\n\u03b3=20\n\u03b3=100\n 0\n 100\n 200\n 300\n 400\n 500\n 600\n 2000  2500  3000  3500  4000  4500\nTo\nta\nl n\num\nbe\nr o\nf e\nnz\nym\nes\n \nin\n o\nrg\nan\nism\nEnzyme Time\nbacteria\narchaea\nplants\nfungi\nanimals\nprotists\nTi\nm\ne\nC\nB\nA\nFIG. 3: Time order of appearance of enzymes, amino acids\nand nucleotides, and entire organisms. A: Time-ordered rank-\ning of enzyme appearance for \u03b3 = 10. From the graph of all\ntime-ordered pairs of enzymes with \u03b3 = 10 pairs also appear-\ning in the \u03b3 = 0-case are removed and only the paths of length\n3 of higher are shown (order-precision 100%). Time runs from\ntop to bottom; the seed enzymes as root nodes are omitted for\nsimplicity. Every enzyme is linked to its entry in KEGG. B:\nAppearance of amino acids (top part) and nucleotides (bot-\ntom part) sorted by the \u03b3 = 100 appearance and averaged\nover 200 runs. The order is very similar (rank correlation\n0.7) to the order of robustness observed in the E. coli net-\nwork [33]. Further, aromatic amino acids (labeled by *) are\nsynthesized late. The \u03b3-curves look similar indicating that\nthe order strongly originates from stoichiometry rather than\nfrom sequence relations. C: Every enzyme defined by its EC\nnumber is mapped to its genes and thus to the corresponding\norganisms. An organism is assumed to have evolved if 80% of\nits annotated enzymes are discovered. The x-axis depicts the\nmean enzyme time of birth of a new organism while the y-axis\nshows the size of the organisms given by the enzyme reper-\ntoire. For higher organisms, the appearance time correlates\nwell with the size of the organisms but this is not the case for\nbacteria and archaea. See [60] for a list of all organisms and\nthe appearance time.\nConclusion\nWe developed a model that allows for an analysis of\nmetabolic evolution by using a Systems Biology approach\nthat combines experimental data, bioinformatic tools,\nmodeling techniques, and time series analysis. Starting\nfrom an initial seed of prebiotic metabolites and sim-\nple enzyme sequences exhibiting a large amount of con-\nserved proteome fragments, the metabolic network is ex-\ntended by iterative invention of novel enzymes that cat-\nalyze putative new reactions and thus increase the num-\nber of present metabolites. Thereby, we focused on the\nrole of sequence information as a source of evolutionary\nmemory. The assumption that new enzymes with a sim-\nilar sequence to already explored enzymes have a higher\nprobability to appear was implemented by the use of the\ninverse BLAST-based enzyme distance, Eq. (1), deter-\nmining the corresponding propensities of the Gillespie\nalgorithm. For a quantitative analysis, the propensities\nwere scaled by the power of the weighting factor \u03b3, where\n\u03b3 = 0 corresponds to a pure random invention process\nand large \u03b3 to a highly sequence similarity dependent\nprocess, respectively. Previous models have explicitly in-\nvestigated the effect of gene duplications and identified\nthese events as important components of evolutionary\ninnovation [29, 30]. Including gene duplications in our\nmodel is difficult because we mimic the evolution of the\nentirety of all enzymes, not those of a single species. We\nassume that the probability to evolve one gene from an-\nother is determined by sequence similarity. This depen-\ndence holds regardless whether one assumes gene duplica-\ntions as an underlying mechanism or not. In this respect,\ndifferent assumptions about the frequency of gene dupli-\ncation events could be reflected in our model by applying\ndifferent functional dependencies of the propensities on\nthe sequence similarities.\nThe model generates temporal network dynamics,\nwhere the sequence-similarity driven expansion process\nleads to an acceleration of evolution. The implemented\nprocess of mutation and selection may be seen as a con-\ncrete realization of the network-based reconciliation [61].\nIn this framework, neutral evolution with mutations\nwhich do not lead to new phenotypes are combined with\npositive selection. From this conceptual model, we ex-\npect that evolutionary changes often occur in cycles of\nneutral diversity expansion and selective diversity con-\ntraction leading to a boom and bust behavior which was\nshown in simulations of RNA evolution [62] and experi-\nmentally by the analysis of the evolution of the human\ninfluenza virus antigen hemagglutinin [63, 64]. A phylo-\ngenetic analysis of hemagglutinin has revealed multiple\nshort evolutionary branches corresponding to accumula-\ntion of neutral diversity.\nThis kind of behavior can be observed in our model\nfor metabolic evolution as well. Here, neutral muta-\ntions occur whenever a new sequence is added that codes\nfor an enzyme which is already present in the network.\nSequence information leads to a bursting like behavior,\n11\nwhere enzymes of one class are invented within short in-\ntervals whereas discovery of a new enzyme class needs\nmore and larger mutations and thus occurs only rarely,\nconfirming a boom and bust behavior. Therefore our\nmodel gives a first molecular description of punctuated\nequilibrium in metabolic evolution. This is quantified by\nthe coefficient of variation Cv which increases with in-\ncreasing sequence information dependency of the expan-\nsion process. Using a sliding window for the calculation\nof Cv indicates events of evolutionary explosion. A high\nautocorrelation function of the IEIs for small time lags\nin the case of large \u03b3 provides further evidence for the\nbursting behavior. Moreover, the good agreement of the\nFano factor with the analytical result of biased Brown-\nian motion points to the diffusive character of network\nevolution and allows for an estimation of typical corre-\nlation times of the evolutionary process. High sequence\ndependence leads to shorter correlation times, since once\na functional sequence is found, all directly related en-\nzymes are invented as well.\nFrom our simulations, we could extract typical time\norders of enzyme appearances which start with carbon\nmetabolism that is needed for all subsequent processes.\nAlthough the model is rather elementary and neglects\nputative transient enzyme sequences or metabolites, the\nobtained order of amino acid appearance fits nicely with\ntheir robustness. This illustrates that many evolution-\nary paths lead to the development of simple but essen-\ntial building blocks, whereas complex structures which\ndepend on the previous discovery of simpler ones occur\nlater. Interestingly, mapping enzymes to organisms by\nthe EC number leads to results that match the intuition,\ndespite the simplifying assumptions made. Bacteria ap-\npear as first species and plants and animals rather late in\nthe artificial evolution. Moreover, occurrence time and\ncomplexity are strongly correlated for animals and plants.\nSince the aim of our model is not to explain the early\norigins of metabolism, we assume that catalysts have al-\nready evolved and neglect mechanisms for the produc-\ntion of the enzymes themselves. As a consequence, we\ndo not expect the model to produce realistic evolutionary\npaths for these early stages. Only after a core metabolism\nwas assembled and the protein synthesis machinery has\nevolved, a closely intertwined coevolution of metabolites\nand enzymes can be seen as plausible. Moreover, the\nagreement of our mathematical model with phenomeno-\nlogical observations transforms the qualitative descrip-\ntion of evolution into a quantitative level. This might be\nused in future work for deeper insights into enzymatic\nfunctions and their role in interactions of organisms.\nAcknowledgments\nWe acknowledge financial support, in particular for a\nfive-months research visit at Boston University, from the\nInternational Research Training Group Genomics and\nSystems Biology of Molecular Networks IRTG 1360 (MS),\nthe German Federal Ministry of Education and Research,\nSystems Biology Research Initiative GoFORSYS (AS),\nthe Scottish Universities Life Science Alliance SULSA\n(OE), the NASA Astrobiology Institute, and the US De-\npartment of Energy (DS). We would like to thank Nils\nChristian, Zoran Nikoloski, and Thomas Handorf for use-\nful discussions.\n[1] S. L. Miller, Science 117, 528 (1953).\n[2] W. Martin, M. J. Russell, Philos Trans R Soc Lond B\nBiol Sci 362, 1887 (2007).\n[3] S. D. Copley, E. Smith, H. J. Morowitz, Bioorg Chem\n35, 430 (2007).\n[4] P. A. Bachmann, P. L. Luisi, J. Lang, Nature 357, 57\n(1992).\n[5] P. Walde, R. Wick, M. Fresta, A. Mangone, P. L. Luisi,\nJournal of the American Chemical Society 116, 11649\n(1994).\n[6] D. Segre`, D. Ben-Eli, D. W. Deamer, D. Lancet, Orig\nLife Evol Biosph 31, 119 (2001).\n[7] S. A. Kauffman, The origins of order: self-organization\nand selection in evolution (Oxford University Press,\n1993).\n[8] H. J. Morowitz, Beginnings of Cellular Life (Yale Uni-\nversity Press, 2004).\n[9] F. Dyson, Origins of Life (Cambridge University Press,\n1999).\n[10] S. Granick, Ann N Y Acad Sci 69, 292 (1957).\n[11] N. H. Horowitz, Proc Natl Acad Sci U S A 31, 153 (1945).\n[12] M. Ycas, J Theor Biol 44, 145 (1974).\n[13] R. A. Jensen, Annu Rev Microbiol 30, 409 (1976).\n[14] O. Ebenho\u00a8h, T. Handorf, R. Heinrich, Genome Inform\n15, 35 (2004).\n[15] T. Handorf, O. Ebenho\u00a8h, R. Heinrich, J Mol Evol 61,\n498 (2005).\n[16] O. Ebenho\u00a8h, T. Handorf, R. Heinrich, Genome Inform\n16, 203 (2005).\n[17] O. Ebenho\u00a8h, T. Handorf, D. Kahn, Syst Biol (Stevenage)\n153, 354 (2006).\n[18] F. Mattha\u00a8us, C. Salazar, O. Ebenho\u00a8h, PLoS Comput Biol\n4, e1000049 (2008).\n[19] J. Raymond, D. Segre`, Science 311, 1764 (2006).\n[20] S. Maslov, S. Krishna, T. Y. Pang, K. Sneppen, Proc\nNatl Acad Sci U S A 106, 9743 (2009).\n[21] A. Mithani, G. M. Preston, J. Hein, Bioinformatics 25,\n1528 (2009).\n[22] M. Schu\u00a8tte, N. Klitgord, D. Segre`, O. Ebenho\u00a8h, Genome\nInform 22, 156 (2010).\n[23] P. Bak, K. Sneppen, Phys Rev Lett 71, 4083 (1993).\n[24] N. Eldredge, J. G. Gould, Models in Paleobiology\n(T.Schopf, 1972), chap. Punctuated equilibria: an alter-\nnative to phyletic gradualism, pp. 82\u2013115.\n[25] S. F. Elena, V. S. Cooper, R. E. Lenski, Science 272,\n1802 (1996).\n12\n[26] M. Kanehisa, S. Goto, Nucleic Acids Res 28, 27 (2000).\n[27] M. Kanehisa, S. Goto, M. Furumichi, M. Tanabe, M. Hi-\nrakawa, Nucleic Acids Res 38, D355 (2010).\n[28] H. Kacser, R. Beeby, J Mol Evol 20, 38 (1984).\n[29] T. Pfeiffer, O. S. Soyer, S. Bonhoeffer, PLoS Biol 3, e228\n(2005).\n[30] A. Hintze, C. Adami, PLoS Comput Biol 4, e23 (2008).\n[31] D. Gillepsie, J. Phys. Chem. 8, 2340 (1977).\n[32] T. Handorf, N. Christian, O. Ebenho\u00a8h, D. Kahn, J Theor\nBiol 252, 530 (2008).\n[33] N. Christian, P. May, S. Kempa, T. Handorf,\nO. Ebenho\u00a8h, Mol Biosyst 5, 1889 (2009).\n[34] R. L. Tatusov, E. V. Koonin, D. J. Lipman, Science 278,\n631 (1997).\n[35] R. L. Tatusov, M. Y. Galperin, D. A. Natale, E. V.\nKoonin, Nucleic Acids Res 28, 33 (2000).\n[36] R. L. Tatusov, et al., Nucleic Acids Res 29, 22 (2001).\n[37] R. L. Tatusov, et al., BMC Bioinformatics 4, 41 (2003).\n[38] E. Wilkinson, J. Willemsen, J Phys A 16, 3365 (1983).\n[39] T. Handorf, O. Ebenho\u00a8h, Nucleic Acids Res 35, W613\n(2007).\n[40] Q. W. Chen, C. L. Chen, Current Organic Chemistry 9,\n989 (2005).\n[41] Y. Sobolevsky, E. N. Trifonov, J Mol Evol 61, 591 (2005).\n[42] Y. Sobolevsky, E. N. Trifonov, J Mol Evol 63, 622 (2006).\n[43] Y. Sobolevsky, Z. M. Frenkel, E. N. Trifonov, J Mol Evol\n65, 640 (2007).\n[44] Supplementary, See supplementary material at [URL will\nbe inserted by AIP] for additional figures illustrating the\nexpansion process .\n[45] A. Wagner, Proc Biol Sci 275, 91 (2008).\n[46] Supplementary, See supplementary material at [URL will\nbe inserted by AIP] for heatmaps that show the appear-\nance of enzyme classes .\n[47] H. F. Chau, Phys Rev E Stat Phys Plasmas Fluids Relat\nInterdiscip Topics 49, 4691 (1994).\n[48] S. Paczuski, M.and S. Maslov, P. Bak, Phys Rev E 53,\n414 (1995).\n[49] C. Adami, Phys Let A 203, 29 (1995).\n[50] M. Usher, M. Stemmler, Z. Olami, Phys. Rev. Lett. 74,\n326 (1995).\n[51] D. Cox, L. Lewis, The Statistical Analysis of Series and\nEvents (Wiley, New York, 1966).\n[52] C. Gardiner, Handbook of stochastic methods (Springer,\nBerlin, 1985).\n[53] D. Cox, V. Isham, Point Processes (Chapman and Hall,\nLondon, 1980).\n[54] Supplementary, See supplementary material at [URL will\nbe inserted by AIP] for Cv using sliding windows of dif-\nferent sizes .\n[55] Fano, Phys. Rev. 72, 26 (1947).\n[56] J. W. Middleton, M. J. Chacron, B. Lindner, A. Longtin,\nPhys Rev E Stat Nonlin Soft Matter Phys 68, 021920\n(2003).\n[57] N. van Kampen, Stochastic processes in physics and\nchemistry (North-Holland, Amsterdam, 2001).\n[58] Supplementary, See supplementary material at [URL will\nbe inserted by AIP] for a larger fraction of the enzyme-\nranking network .\n[59] Supplementary, See supplementary material at [URL will\nbe inserted by AIP] for a table of the amino acid abun-\ndance in the consensus set .\n[60] Supplementary, See supplementary material at [URL will\nbe inserted by AIP] for a table of all organisms listed with\nnames as they appear in enzyme time .\n[61] A. Wagner, Nat Rev Genet 9, 965 (2008).\n[62] W. Fontana, P. Schuster, Science 280, 1451 (1998).\n[63] K. Koelle, S. Cobey, B. Grenfell, M. Pascual, Science\n314, 1898 (2006).\n[64] D. J. Smith, et al., Science 305, 371 (2004).\n"}