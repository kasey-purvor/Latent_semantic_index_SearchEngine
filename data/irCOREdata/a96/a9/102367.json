{"doi":"10.1109\/ICICIC.2006.488","coreId":"102367","oai":"oai:epubs.surrey.ac.uk:1826","identifiers":["oai:epubs.surrey.ac.uk:1826","10.1109\/ICICIC.2006.488"],"title":"On Watermarking\/Fingerprinting for Copyright Protection","authors":["Schaathun, Hans Georg"],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2006-01-01","abstract":"<p>Digital fingerprinting has been suggested for copyright protection. Using a watermarking scheme, a fingerprint identifying the buyer is embedded in every copy sold If an illegal copy appears, it can be traced back to the guilty user By using collusion-secure codes, the fingerprinting system is made secure against cut-and-paste attacks.<\/p","downloadUrl":"","fullTextIdentifier":null,"pdfHashValue":null,"publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:epubs.surrey.ac.uk:1826<\/identifier><datestamp>\n      2017-10-31T14:03:17Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><setSpec>\n      6469766973696F6E733D656E67616E64706879736963616C736369656E636573:436F6D707574696E67<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/epubs.surrey.ac.uk\/1826\/<\/dc:relation><dc:title>\n        On Watermarking\/Fingerprinting for Copyright Protection<\/dc:title><dc:creator>\n        Schaathun, Hans Georg<\/dc:creator><dc:description>\n        <p>Digital fingerprinting has been suggested for copyright protection. Using a watermarking scheme, a fingerprint identifying the buyer is embedded in every copy sold If an illegal copy appears, it can be traced back to the guilty user By using collusion-secure codes, the fingerprinting system is made secure against cut-and-paste attacks.<\/p><\/dc:description><dc:date>\n        2006-01-01<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/epubs.surrey.ac.uk\/1826\/1\/fulltext.pdf<\/dc:identifier><dc:identifier>\n          Schaathun, Hans Georg  (2006) On Watermarking\/Fingerprinting for Copyright Protection   Proceedings of the First International Conference on Innovative Computing, Information and Control (ICICIC '06).  pp. 50-53.      <\/dc:identifier><dc:relation>\n        10.1109\/ICICIC.2006.488<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/epubs.surrey.ac.uk\/1826\/","10.1109\/ICICIC.2006.488"],"year":2006,"topics":[],"subject":["Article","PeerReviewed"],"fullText":"On Watermarking\/Fingerprinting for Copyright Protection\nHans Georg Schaathun\nDept. of Computing, SEPS\nUniversity of Surrey\nGuildford, GU2 7XH\nEngland\ngeorg@ii.uib.no\nAbstract\nDigital fingerprinting has been suggested for copyright\nprotection. Using a watermarking scheme, a fingerprint\nidentifying the buyer is embedded in every copy sold. If an\nillegal copy appears, it can be traced back to the guilty user.\nBy using collusion-secure codes, the fingerprinting system\nis made secure against cut-and-paste attacks.\nIn this paper we study the interface between the\ncollusion-secure fingerprinting codes and the underlying\nwatermarking scheme, and we construct several codes\nwhich are both error-correcting and collusion-secure.\nError-correction makes the system robust against successful\nattacks on the watermarking layer.\nKeywords\ncollusion-secure fingerprinting, copyright protection,\nerror-correcting codes, watermarking, soft-decision de-\ncoding\n1. Introduction\nProtecting copyright is one of the hottest topics in information\nand media technology at the moment. Digital technology enables\nperfect copying on amateur equipment, and artists and companies\nworry about lost sales. Digital fingerprinting is one of many pro-\nposed countermeasures. This was first proposed in [6] and has\nreceived increasing interest following [1].\nThe basic idea in fingerprinting is to make every sold copy\nunique, by embedding a fingerprint identifying the buyer. Thereby\nany emerging illegitimate copy can be traced back to the guilty\nparty. For instance the Beazley Archive in Oxford uses finger-\nprinting technology from IBM and DataMark on images on their\nweb site.\nA major challenge is to make this system secure against coali-\ntions of pirates. By comparing their different copies, colluding\npirates can identify, and consequently remove or damage, part of\nthe fingerprint. A typical attack would be the cut-and-paste attack,\nwhere a collusion of pirates cut segments from their individual\ncopies and paste them together to form a hybrid copy with a hy-\nbrid fingerprint.\nFingerprinting (FP) is often divided into two modules. A\ncollusion-secure code is used in order to select fingerprints which\nare resistant against collusive attacks. An underlying watermark-\ning (WM) scheme (see e.g. [2]) is used to embed the fingerprint in\nthe digital file.\nMost of the literature studies the two modules separately. The\nfingerprinting literature has defined its requirements for the WM\nscheme as a Marking Assumption. Unfortunately, most of the re-\nsearch has been based on very unrealistically strong Marking As-\nsumptions, for instance that of [1]. In this paper, following Guth\nand Pfitzmann [3], we use a weaker Marking Assumption, which\nallows for some successful attacks in the watermarking layer as\nwell as the cut-and-paste attack. The solution is codes that are\nboth collusion-secure and error-correcting.\n2. The layered FP\/WM model\nFigure 1 shows the layered structure of a fingeprinting system\nwith an FP and a WM module. The buyer\u2019s identity is input to an\nencoder to produce a fingerprint consisting of n symbols. The file\nis divided into n segments, and each symbol is embedded inde-\npendently embedded in one segment by the WM embedder.\nWatermarking, briefly defined, is a technique to embed a mes-\nsage in a digital file in such a way that an adversary is unable\nto remove or change the message. Neither the existence nor the\ncontents of the message is assumed to be secret, contrary to the\nscenario in steganography.\nThe purpose of the FP layer is to make the system resistant\nagainst coalitions of pirates. If several users collude and compare\ntheir copies, they will observe some differences which must be\npart of the watermark\/fingerprint. This allows them to damage the\nfingerprint.\nThe independent study of the FP and WM layers raises one key\nissue: Is there an agreed interface between the layers? We shall\naddress this interface shortly.\nThe pirates can essentially mount attacks on each layer. A\nwatermarking attack would operate on the individual segments,\nwhereas a fingerprinting attack works on the sequence as a whole.\nProceedings of the First International Conference on Innovative Computing, Information and Control (ICICIC'06)\n0-7695-2616-0\/06 $20.00  \u00a9 2006\nAuthorized licensed use limited to: University of Surrey. Downloaded on April 13,2010 at 15:21:09 UTC from IEEE Xplore.  Restrictions apply. \nlegal\nmetalayer\nFP layer\nWM layer\nBuyer\nEncoder\nEmbedder\n\u00b7 \u00b7 \u00b7\nn symbols\nAccusation\nDecoder\nExtractor\n\u00b7 \u00b7 \u00b7\nn symbols\nATTACK\nCopyrighted \ufb01le\n\u00b7 \u00b7 \u00b7n segments\nFigure 1. Watermarking\/Fingerprinting model.\nThe archetypical fingerprinting attack is cut-and-paste; a col-\nlusion of pirates cut segments from their various copies and paste\nthem together. The result is a hybrid copy where every segment\ncontains a symbol matching some pirate, but where the full string\nof symbols is no fingerprint of the pirates\u2019.\nMany traditional works on fingerprinting considered only the\ncut-and-paste fingerprint attack, and assumed that the WM extrac-\ntor was infallible. In other words, xi from the watermarking layer\nwould always match the i-th symbol of at least one of the pirates.\nThe classic phrasing of this assumption is as follows [1].\nDefinition 1 (Boneh-Shaw)\nLet P \u2286 C be the set of \ufb01ngerprints held by a coalition of pirates.\nThe pirates can produce a copy with a false \ufb01ngerprint \u0002x for any\n\u0002x \u2208 F (P ), where\nF (P ) = {(c1, . . . , cn) : \u2200i,\u2203(x1, . . . , xn) \u2208 P, xi = ci}.\nWe call F (P ) the feasible set of P with respect to C.\nA code C is said to be (t, \u0003)-secure under the Marking As-\nsumption, if, when there are at most t pirates, the output L of the\nfingerprinting decoder is a non-empty subsets of the pirates with\nprobability at least 1 \u2212 \u0003. The most well-known such code is due\nto Boneh and Shaw [1].\nA real watermarking scheme cannot be expected to be infalli-\nble. We say that the extraction algorithm fail in position i if the\noutput xi does not match the i-th symbol of any of the pirate fin-\ngerprints. Such failure can be either accidental or due to pirate\nattacks.\nThe pirates can attack the watermarking layer by modifying the\nsegment(s). Possible attacks depend on the WM scheme in use, but\ntypically they include random noise and geometrical distortion. If\nthe attack is too strong, the file would be rendered useless, but we\nexpect that the extractor will fail with a certain probability pe. This\nleads to a weaker Marking Assumption [3] as follows.\nDefinition 2 (Guth-Pfitzmann)\nLet P \u2286 C be the set of \ufb01ngerprints held by a coalition of pirates,\nand let xi be the output xi from the watermarking layer in position\ni. The probability that for all (c1 . . . cn) \u2208 P , ci \u0006= xi, is at most\npe, independently of the output xj for all other columns j \u0006= i.\nNote that when pe = 0, this co\u00efncides with the Boneh-Shaw\nMarking Assumption. Guth and Pfitzman [3] presented an adapted\nversion of the Boneh-Shaw scheme for this new Marking Assump-\ntion. Our solution in this paper will be more efficient than that, by\nincorporating the latest improvements on Boneh-Shaw [4, 5].\nThe assumption of independent segments is crucial in order to\nuse simple statistical models and formul\u00e6. In real applications it\nmay not be true. It is likely that some segments are independent\nwhereas others are more or less correlated. Now it is important\nto remember that the pirates do not know to which code column a\ngiven segment corresponds. Thus, they will have no means to pre-\ndict the correlation between two code columns, and it seems rea-\nsonable to assume independence as a fair approximation, though\nwe have to assert it for potential watermarking schemes.\n3. The Boneh-Shaw code\nWe present a novel, error-correcting version of Boneh-Shaw; it\nis simpler and more efficient than the one from [3]. We view the\nBoneh-Shaw FP system as a three-layer system, where we split\nthe FP layer into a collusion-secure (CS) and an error-correcting\n(EC) layer. Even though this layering was not explicit in [1], the\noriginal scheme fits well.\nWe introduce a couple of defintions from coding theory. An\n(n,M)q code is a set of M words of length n over an alphabet of\nq symbols. If q is suppressed, it is generally assumed to be 2. The\nminimum (Hamming) distance between two distinct codewords is\ndenoted by d. An (n,M, d)q code is an (n,M)q code with mini-\nmum distance d.\nThe inner code in [1], fitting in the CS layer, was a q-secure, bi-\nnary (r(q\u2212 1), q) code called \u0393. In the EC layer, an outer random\ncode was used.\nProceedings of the First International Conference on Innovative Computing, Information and Control (ICICIC'06)\n0-7695-2616-0\/06 $20.00  \u00a9 2006\nAuthorized licensed use limited to: University of Surrey. Downloaded on April 13,2010 at 15:21:09 UTC from IEEE Xplore.  Restrictions apply. \nEach buyer is represented in the EC layer by a q-ary word of\nlength nO drawn uniformly at random. By concatenation of codes,\nthis is converted in the CS layer to a binary word by mapping each\nq-ary symbol to a codeword of \u0393. The bits arising from the same\nsymbol in the outer code constitute a block.\nThe vendor applies a random, secret permutation of the code\nbits between the CS and WM layer. This ensures that the corre-\nspondence between file segments and codeword bits is known only\nto the vendor.\nThe outer code is inherently error-correcting, even though this\nfact was not originally exploited. Once this was realised, it was\nevident that that we could improve the rate by using a weaker FP\ncode and let the EC code compensate for that [4].\nThe key to the present work is to recognise that the error-\ncorrecting capability can also be used to correct errors from any\nunderlying layer, in particular the WM layer.\nThe original scheme used hard decision decoding, such that the\ndecoder in the FP layer would output for each block, one symbol\nfrom the q-ary alphabet. Following [5], we use soft decision de-\ncoding, which means that the decoder output a heuristic for each\npossible symbol reflecting its likelihood. Since this gives more\nfine-grained information, it allows the EC decoder to make a more\nreliable accusation.\nIt was found in [5] that a replication factor r = 1 was optimal,\nsuch that \u0393 is an upper triangular 0-1 matrix, i.e. with ones on and\nabove the main diagonal.\nLet (X1, . . . , Xq\u22121) be a block of a hybrid fingerprint. Let\nX0 = 0 and Xq = 1 by convention. Note that unless user i is seen\nby a pirate, the pirates cannot distinguish between the (i \u2212 1)-th\nand the i-th column. Hence the probability of outputting a 1 is\nequal for the two columns, i.e. Xi \u223c Xi\u22121.\nThe original scheme used hard decision decoding, which\nmeans that the CS decoder commits to a certain symbol for each\nblock. In [5] improvements where made by using soft decision de-\ncoding instead; i.e. a heuristic is output for every possible symbol\nin each block, where a high heuristic indicates a symbol which is\nlikely to be correct. It was suggested that the CS decoder output\nthe vector (Vj : j \u2208 \u0393) where Vj = Xj \u2212 Xj\u22121. Observe that\nall the Vj sum to 1 and Vj \u2208 [\u22121, 1] for all j. Furthermore, if the\npirates cannot see symbol j and j \u0006\u2208 {1, q}, then E(Vj) = 0.\nWe now turn to the decoder for the EC layer. As input, it will\nreceive, for each of the nO blocks, a vector (Vj ; j \u2208 \u0393).\nAfter inner decoding of each block, we form the q \u00d7 n re-\nliability matrix R = [ri,j ] where the j-th column is the vector\n(V1, . . . , Vq) from inner decoding of the j-th block. The output of\nthe soft decision list decoder is a list L \u2286 C of codewords\nL = {\u0002c : W (\u0002c) \u2265 \u0394n}, (1)\nW ((c1, . . . , cn)) =\nnX\ni=1\nri,ci . (2)\nFor random codes, the list decoding has to be implemented as an\nexhaustive search with complexity O(M). It is possible to use\nalgebraic codes with more efficient decoding, and we expect to\npresent this in a more comprehensive version of this paper.\nWe employ the common assumption that the pirates make inde-\npendent decisions in each column (segment), such that all the Xi\nare independent and distributed as B(1, pi) for some probability\npi. This assumption is reasonable by the laws of large numbers,\nif there is at least a moderately large number of columns indistin-\nguishable for the pirates. Most importantly, this assumption im-\nplies that the ri,ci for different i are stochastically independent,\nallowing us to use the well-known Chernoff bound, defined as fol-\nlows.\nTheorem 1 (Chernoff)\nLet X1, . . . , Xt be bounded, independent, and identically dis-\ntributed stochastic variables in the range [0, 1]. Let x be their\n(common) expected value. Then for any \u03b4 \u2208 [0, 1], we have\nP\n \ntX\ni=1\nXi \u2264 t\u03b4\n!\n\u2264 2\u2212tD(\u03b4||x), when \u03b4 < x,\nP\n \ntX\ni=1\nXi \u2265 t\u03b4\n!\n\u2264 2\u2212tD(\u03b4||x), when \u03b4 > x,\nwhere\nD(\u03c3||p) = \u03c3 log \u03c3\np\n+ (1\u2212 \u03c3) log 1\u2212 \u03c3\n1\u2212 p .\nWe distinguish between two types of errors: Type I is the case\nwhere the output list L contains no guilty pirate, and Type II the\ncase where L contains innocent users. Let \u0003I and \u0003II be the prob-\nabilities of Type I and Type II errors. The following bounds are\nproved in the full version of this paper. The total length of the\nscheme is the total number of segments used, and it is given as\nn = (q \u2212 1)nO.\nTheorem 2 (Error probabilities)\nSuppose there are at most t pirates, and that they have probability\nat most pe < 1\/2 of causing an error in an undetectable posi-\ntion. Using the concatenated code with a BS inner code and a\nrandom code with soft input list decoding, with threshold \u0394 such\nthat 1\/q < \u0394 < (1\u2212 2pe)\/t, the error probabilites are as follows\n\u0003I \u2264 exp\u2212nOD\n\u201e\n1 + \u0394\n2\n\u02db\u02db\u02db\u02db t + 1\n2t\n\u2212 pe\nt\n\u00ab\n,\n\u0003II \u2264 exp\n\u201e\nRO log q \u2212D\n\u201e\n1 + \u0394\n2\n\u02db\u02db\u02db\u02dbq + 1\n2q\n\u00ab\u00ab\nnO\nThe bound on \u0003I is independent of the choice of outer code,\nwhereas the bound on \u0003II must be derived specifically for each\nchoice of outer code. We observe that for pe = 0, the above\ntheorem reduces to the original result of [5].\nExample 3.1 Suppose we require a Boneh-Shaw scheme with t =\n20, M = 220, pe = 2%, \u0003II = 10\n\u22123\n, and \u0003I = 10\u22126. We use\nq = 3t. Setting equality in Theorem 2, we get\n3 log 10 = D\n\u201e\n1 + \u0394\n2\n||21\n40\n\u2212 pe\n20\n\u00ab\nnO,\n6 log 10 = D\n\u201e\n1 + \u0394\n2\n|| 61\n120\n\u00ab\nnO \u2212 20.\nWe solve the equations to get \u0394 \u2248 0.0376, nO \u2248 126 660, and\nconsequently n = 7472 940.\nProceedings of the First International Conference on Innovative Computing, Information and Control (ICICIC'06)\n0-7695-2616-0\/06 $20.00  \u00a9 2006\nAuthorized licensed use limited to: University of Surrey. Downloaded on April 13,2010 at 15:21:09 UTC from IEEE Xplore.  Restrictions apply. \nFigure 2. Code rates for concatenated codes\nwith BS inner codes and random codes for\nvarying underlying error rates and varying q\nfor t = 2, 4, 8, 12.\nRemark 3.1\nSimilar calculations to the example for fewer pirates give length\n5 655 for t = 2, 21 744 for t = 3, 109 074 for t = 5, and 915 385\nfor t = 10, still assuming a million users and 2% WM errors.\nThe code rate is defined as R = (log2 M)\/n. To get a general\nimpression of the efficiency, it is useful to study the asymptotic\nrate, i.e. limM\u2192\u221eR. The following theorem gives the result, and\nFigure 2 compares some sample figures.\nTheorem 3\nThere is an asymptotic class of (t, \u0003)-secure codes with \u0003 \u2192 \u221e\nand rate given by\nRt \u2248\nD\n\u201c\nt+1\u22122pe\n2t\n|| q+1\n2q\n\u201d\nq \u2212 1 , for any q >\nt\n1\u2212 2pe .\nThe theorem obviously demands q = \u03a9(t), but we cannot see\nany nice expression for the optimal value of q.\n4. Conclusion and future research\nThe layered WM\/FP models illustrate how fingerprinting and\nwatermarking can be studied separately and combined as black\nboxes, if we have a clear and common understanding of the inter-\nface. Past works on fingerprinting for the Boneh-Shaw model have\noften suggested to use an underlying WM scheme, without com-\nparing the assumptions about the interface. Similarly, watermark-\ning works have referred to the Boneh-Shaw FP scheme without\ndiscussing the interface.\nIn this work, we adapt the Boneh-Shaw fingerprinting scheme\nto allow for random errors from the watermarking layer. Even al-\nlowing for errors, our codewords are shorter than those of Boneh-\nShaw for no errors. This makes also makes it more efficient than\nthat of [3], which had to increase the code length over Boneh-Shaw\nin order to allow for errors. The modular description also points\nout various ways to get further improvements, and versions using\nalgebraic outer codes have been constructed. Their rate is inferior,\nbut the decoding complexity is superior.\nAcknowledgements\nThe author is grateful for many useful discussions with dr. Ste-\nfan Katzenbeisser of Munich, dr. Marcel Fernandez of Barcelona,\nand prof. G\u00e9rard Cohen of Paris.\nReferences\n[1] D. Boneh and J. Shaw. Collusion-secure fingerprinting for\ndigital data. IEEE Trans. Inform. Theory, 44(5):1897\u20131905,\n1998. Presented in part at CRYPTO\u201995.\n[2] J. Cox, M. Miller, and J. Bloom. Digital Watermarking. Mor-\ngan Kaufmann, 2002.\n[3] H.-J. Guth and B. Pfitzmann. Error- and collusion-secure fin-\ngerprinting for digital data. In Information Hiding \u201999, Pro-\nceedings, volume 1768 of Springer Lecture Notes in Com-\nputer Science, pages 134\u2013145. Springer-Verlag, 2000.\n[4] H. G. Schaathun. The boneh-shaw fingerprinting scheme is\nbetter than we thought. IEEE Transaction on Information\nForensics and Security, June 2006.\n[5] H. G. Schaathun and M. Fernandez-Mu\u00f1oz. Boneh-Shaw fin-\ngerprinting and soft decision decoding. In Information Theory\nWorkshop, 2005. Rotorua, NZ.\n[6] N. R. Wagner. Fingerprinting. In Proceedings of the 1983\nSymposium on Security and Privacy, 1983.\nProceedings of the First International Conference on Innovative Computing, Information and Control (ICICIC'06)\n0-7695-2616-0\/06 $20.00  \u00a9 2006\nAuthorized licensed use limited to: University of Surrey. Downloaded on April 13,2010 at 15:21:09 UTC from IEEE Xplore.  Restrictions apply. \n"}