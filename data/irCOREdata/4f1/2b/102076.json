{"doi":"10.1098\/rspa.2007.1862","coreId":"102076","oai":"oai:epubs.surrey.ac.uk:1523","identifiers":["oai:epubs.surrey.ac.uk:1523","10.1098\/rspa.2007.1862"],"title":"Multisymplectic formulation of fluid dynamics using the inverse map","authors":["Cotter, C. J.","Holm, D. D.","Hydon, P. E."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2007-10-08","abstract":"<p>An asymptotic Green's function in homogeneous anisotropic viscoelastic media is derived. The Green's function in viscoelastic media is formally similar to that in elastic media, but its computation is more involved. The stationary slowness vector is, in general, complex valued and inhomogeneous. Its computation involves finding two independent real-valued unit vectors which specify the directions of its real and imaginary parts and can be done either by iterations or by solving a system of coupled polynomial equations. When the stationary slowness direction is found, all quantities standing in the Green's function such as the slowness vector, polarization vector, phase and energy velocities and principal curvatures of the slowness surface can readily be calculated.<\/p>\n<p>The formulae for the exact and asymptotic Green's functions are numerically checked against closed-form solutions for isotropic and simple anisotropic, elastic and viscoelastic models. The calculations confirm that the formulae and developed numerical codes are correct. The computation of the P-wave Green's function in two realistic materials with a rather strong anisotropy and absorption indicates that the asymptotic Green's function is accurate at distances greater than several wavelengths from the source. The error in the modulus reaches at most 4% at distances greater than 15 wavelengths from the source.<\/p","downloadUrl":"","fullTextIdentifier":null,"pdfHashValue":null,"publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:epubs.surrey.ac.uk:1523<\/identifier><datestamp>\n      2017-10-31T14:02:13Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><setSpec>\n      6469766973696F6E733D656E67616E64706879736963616C736369656E636573:6D617468737075626C<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/epubs.surrey.ac.uk\/1523\/<\/dc:relation><dc:title>\n        Multisymplectic formulation of fluid dynamics using the inverse map<\/dc:title><dc:creator>\n        Cotter, C. J.<\/dc:creator><dc:creator>\n        Holm, D. D.<\/dc:creator><dc:creator>\n        Hydon, P. E.<\/dc:creator><dc:description>\n        <p>An asymptotic Green's function in homogeneous anisotropic viscoelastic media is derived. The Green's function in viscoelastic media is formally similar to that in elastic media, but its computation is more involved. The stationary slowness vector is, in general, complex valued and inhomogeneous. Its computation involves finding two independent real-valued unit vectors which specify the directions of its real and imaginary parts and can be done either by iterations or by solving a system of coupled polynomial equations. When the stationary slowness direction is found, all quantities standing in the Green's function such as the slowness vector, polarization vector, phase and energy velocities and principal curvatures of the slowness surface can readily be calculated.<\/p>\n<p>The formulae for the exact and asymptotic Green's functions are numerically checked against closed-form solutions for isotropic and simple anisotropic, elastic and viscoelastic models. The calculations confirm that the formulae and developed numerical codes are correct. The computation of the P-wave Green's function in two realistic materials with a rather strong anisotropy and absorption indicates that the asymptotic Green's function is accurate at distances greater than several wavelengths from the source. The error in the modulus reaches at most 4% at distances greater than 15 wavelengths from the source.<\/p><\/dc:description><dc:date>\n        2007-10-08<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/epubs.surrey.ac.uk\/1523\/1\/fulltext.pdf<\/dc:identifier><dc:identifier>\n          Cotter, C. J., Holm, D. D. and Hydon, P. E.  (2007) Multisymplectic formulation of fluid dynamics using the inverse map   Proceedings of the Royal Society A: Mathematical, Physical and Engineering Sciences, 463 (2086).  pp. 2671-2687.      <\/dc:identifier><dc:relation>\n        10.1098\/rspa.2007.1862<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/epubs.surrey.ac.uk\/1523\/","10.1098\/rspa.2007.1862"],"year":2007,"topics":[],"subject":["Article","PeerReviewed"],"fullText":"Multisymplectic formulation of fluid\ndynamics using the inverse map\nBy C. J. Cotter, D. D. Holm and P. E. Hydon\nDepartment of Aeronautics, Imperial College London, London, UK;Department of\nMathematics, Imperial College London, London, UK; Department of Mathematics,\nUniversity of Surrey, Guildford, UK\nWe construct multisymplectic formulations of fluid dynamics using the inverse of\nthe Lagrangian path map. This inverse map \u2013 the \u201cback-to-labels\u201d map \u2013 gives the\ninitial Lagrangian label of the fluid particle that currently occupies each Eulerian\nposition. Explicitly enforcing the condition that the fluid particles carry their labels\nwith the flow in Hamilton\u2019s principle leads to our multisymplectic formulation. We\nuse the multisymplectic one-form to obtain conservation laws for energy, momentum\nand an infinite set of conservation laws arising from the particle-relabelling symme-\ntry and leading to Kelvin\u2019s circulation theorem. We discuss how multisymplectic\nnumerical integrators naturally arise in this approach.\nKeywords: Multisymplectic systems, partial differential equations, fluid\ndynamics, conservation laws, potential vorticity\n1. Introduction\nDefinition 1.1. A system of partial differential equations (PDEs) is said to be\nmultisymplectic if it is of the form\nK\u03b1ij(z)z\nj\n,\u03b1 =\n\u2202H\n\u2202zi\n,\nwhere each of the two-forms\n\u03ba\u03b1 =\n1\n2\nK\u03b1ij(z) dz\ni \u2227 dzj\nis closed. Here z is an ordered set of dependent variables, total differentiation with\nrespect to each independent variable q\u03b1 is denoted by the subscript \u03b1 after a comma,\nand the Einstein summation convention is used.\nThe closed two-form \u03ba\u03b1 is associated with the independent variable q\u03b1; it is anal-\nogous to the symplectic two-form for a Hamiltonian ordinary differential equation.\nHence there is a symplectic structure associated with each independent variable. In\nthe first of a series of papers, Bridges (1997) pioneered the development of multi-\nsymplectic systems, showing that the rich geometric structure that is endowed by\nthe symplectic two-forms can be used to understand the interaction and stability\nof nonlinear waves. For many important PDEs, the multisymplectic formulation\nhas revealed hidden features that are important in stability analysis. In order to\npreserve at least some of these features in numerical simulations, Bridges & Re-\nich (2001) introduced multisymplectic integrators, which generalise the symplectic\nArticle submitted to Royal Society TEX Paper\n2 C. J. Cotter, D. D. Holm and P. E. Hydon\nmethods that have been widely used in numerical Hamiltonian dynamics. Hydon\n(2005) showed that multisymplectic systems of PDEs may be derived from Hamil-\nton\u2019s principle whenever the Lagrangian is affine in the first-order derivatives and\ncontains no higher-order derivatives. This can usually be achieved by introducing\nauxiliary variables to eliminate the derivatives.\nThe aim of this paper is to provide a unified approach to producing multisym-\nplectic formulations of fluid dynamics, based on the inverse map. Our approach\ncovers all fluid dynamical equations that are written in Euler-Poincare\u00b4 form (Holm\net al., 1998), i.e. all equations which arise due to the advection of fluid material.\nFirst we use the inverse map to form a canonical Euler-Lagrange equation (follow-\ning the Clebsch representation given in Holm & Kupershmidt, 1983, which supports\nall possible initial conditions for vorticity, in particular flows in three dimensions\nwith non-zero helicity). This approach is different to that of Marsden et al., 2001,\nwhere the forward map is used. Then the Lagrangian is made affine in the space and\ntime derivatives by using constraints that introduce additional variables. Following\nHydon (2005), we obtain a one-form quasi-conservation law which, when it is pulled\nback to the space and time coordinates, gives conservation laws for momentum and\nenergy. We also obtain a two-form conservation law that represents conservation\nof symplecticity; when this is pulled back to the spatial coordinates, it leads to a\nconservation law for vorticity. The multisymplectic version of Noether\u2019s Theorem\nyields an infinite space of conservation laws from the particle-relabelling symme-\ntry for fluid dynamics; these conservation laws imply Kelvin\u2019s circulation theorem.\nThe conserved momentum that is canonically conjugate to the back-to-labels map\nplays a key role in the derivation of the conservation laws. The corresponding ve-\nlocity is the convective velocity, whose geometric properties are discussed in Holm\net al. (1986). The connection between particle-relabelling symmetry and circula-\ntion preservation was first addressed in a multisymplectic context in Bridges et al.\n(2005).\nIn this paper we show how the above constructions are made in general, illus-\ntrating this with examples. We also discuss how multisymplectic integrators can\nbe constructed using these methods. Sections 2 and 3 review the relations among\nmultisymplectic structures, the Clebsch representation and the momentum map\nassociated with particle relabelling. Section 4 shows how to construct a multisym-\nplectic formulation of the Euler-Poincare\u00b4 equation for the diffeomorphism group\n(EPDiff), and derives the corresponding conservation laws, including the infinite\nset of conservation laws that yield Kelvin\u2019s circulation theorem. The section then\nextends this formulation to the Euler-Poincare\u00b4 equation with advected quantities.\nThis is illustrated by the incompressible Euler equation, showing how the circula-\ntion theorem arises in the multisymplectic formulation. Section 5 sketches numerical\nissues in the multisymplectic framework. Finally, Section 6 summarises and outlines\ndirections for future research.\n2. Review of multisymplectic structures\nThis section reviews the formulation of multisymplectic systems and their conser-\nvation laws, following Hydon (2005).\nA system of partial differential equation (PDEs) is multisymplectic provided\nthat it can be represented as a variational problem with a Lagrangian that is affine\nArticle submitted to Royal Society\nMultisymplectic formulation of fluid dynamics using the inverse map 3\nin the first derivatives of the dependent variables:\nL = L\u03b1j (z)z\nj\n,\u03b1 \u2212H(z). (2.1)\nRemark 2.1. For convenience we retrict attention to autonomous systems where\nH depends on the dependent variables only; this can always be accomplished by\nintroducing new dependent variables as in the Hamiltonian case.\nThe Euler-Lagrange equations are then\nK\u03b1ij(z)z\nj\n,\u03b1 =\n\u2202H\n\u2202zi\n, (2.2)\nwhere the functions\nK\u03b1ij(z) =\n\u2202L\u03b1j\n\u2202zi\n\u2212 \u2202L\n\u03b1\ni\n\u2202zj\n(2.3)\nare coefficients of the multisymplectic structure matrix. We define the (closed)\nsymplectic two-forms\n\u03ba\u03b1 =\n1\n2\nK\u03b1ij(z) dz\ni \u2227 dzj , (2.4)\nand obtain the structural conservation law (Bridges, 1997) given by\n\u03ba\u03b1,\u03b1 = 0. (2.5)\nHydon (2005) showed that the Poincare\u00b4 Lemma leads to a one-form quasi-conservation\nlaw\n(L\u03b1j dz\nj),\u03b1 = d(L\u03b1j z\nj\n,\u03b1 \u2212H(z)) = dL, (2.6)\nwhose exterior derivative is (2.5).\nEvery one-parameter Lie group of point symmetries of the multisymplectic sys-\ntem (2.2) is generated by a differential operator of the form\nX = Qi(q,z)\n\u2202\n\u2202zi\n+ (Qi(q,z)),\u03b1\n\u2202\n\u2202zi,\u03b1\n. (2.7)\nNoether\u2019s Theorem implies that if X generates variational symmetries, that is, if\nXL = B\u03b1,\u03b1 for some functions B\n\u03b1, then the interior product of X with the one-form\nquasi-conservation law yields the conservation law\n(L\u03b1j Q\nj \u2212B\u03b1),\u03b1 = 0. (2.8)\nThis is the multisymplectic form of Noether\u2019s theorem.\nEvery multisymplectic system (2.1) is invariant under translations in the in-\ndependent variables q. For each of these symmetries, Noether\u2019s theorem yields a\nconservation law\n(L\u03b1j z\nj\n,\u03b2 \u2212 L\u03b4\u03b1\u03b2 ),\u03b1 = 0.\nSuch conservation laws can equally well be obtained by pulling back the quasi-\nconservation law (2.6) to the base space of independent variables. Commonly, the\nindependent variables are spatial position x and time t. Pulling back (2.6) to these\nbase coordinates yields the energy conservation law from the dt component, and\nthe momentum conservation law from the remaining components. We shall see the\nform of these conservation laws for fluid dynamics in later sections.\nArticle submitted to Royal Society\n4 C. J. Cotter, D. D. Holm and P. E. Hydon\n3. The inverse map and Clebsch representation\n(a) Lagrangian fluid dynamics and the inverse map\nLagrangian fluid dynamics provides evolution equations for particles moving\nwith a fluid flow. This is typically done by writing down a flow map \u03a6 from some\nreference configuration to the fluid domain \u2126 at each instance in time. As the fluid\nparticles cannot cavitate, superimpose or jump, this map must be a diffeomorphism.\nFor an n-dimensional fluid flow, the flow map \u03a6 : Rn \u00d7 R 7\u2192 Rn given by\nx = \u03a6(l, t) specifies the spatial position at time t of the fluid particle that has label\nl. The inverse map \u03a6\u22121 gives the label of the particle that occupies position x at\ntime t as the function l = \u03a6\u22121(x, t). The Eulerian velocity field u(x, t) gives the\nvelocity of the fluid particle that occupies position x at time t as follows:\nx\u02d9(l, t) = u(x(l, t), t).\nEach label component lk(x, t) satisfies the advection law\nlk,t + uilk,i = 0. (3.1)\nHere ,t and ,i denote differentiation with respect to t and xi respectively. We use\nCartesian coordinates and the Euclidean inner product\u2020, so we shall not generally\ndistinguish between \u2018up\u2019 and \u2018down\u2019 indices; summation from 1 to n is implied\nwhenever an index is repeated.\n(b) Clebsch representation using the inverse map\nA canonical variational principle for fluid dynamics may be formulated by fol-\nlowing the standard Clebsch procedure using the inverse map (Seliger & Whitham\n(1968), Holm & Kupershmidt, 1983). The Clebsch procedure begins with a func-\ntional `[u] of the Eulerian fluid velocity u, which is known as the reduced Lagrangian\nin the context of Euler-Poincare\u00b4 reduction (Holm et al., 1998). One then enforces\nstationarity of the action S =\n\u222b\n`[u]dt under the constraint that equation (3.1) is\nsatisfied by using a vector of n Lagrange multipliers, which is denoted as pi. These\nLagrange multipliers are the conjugate momenta to l in the course of the Legendre\ntransformation to the Hamiltonian formulation. One may choose `[u] to be solely\nthe kinetic energy, which depends only on u. More generally, ` will also depend\non thermodynamic Eulerian variables such as density, whose evolution may also be\naccommodated by introducing constraints. These constraints are often called the\n\u201cLin constraints\u201d (Serrin, 1959). This idea was also used in reformulating London\u2019s\nvariational principle for superfluids (Lin, 1963).\nDefinition 3.1 (Clebsch variational principle using inverse map). The Clebsch\nvariational principle using the inverse map is\n\u03b4\n\u222b t1\nt0\n`[u] +\n\u222b\n\u2126\npi \u00b7 (l,t + u \u00b7 \u2207l)dV (x)dt = 0,\nwhere pi(x, t) are Lagrange multipliers which enforce the constraint that particle\nlabels l(x, t) are advected by the flow. In bounded domains the boundary conditions\n\u2020 This is only done for clarity and the equations are easily extended to the case when the\ndomain \u2126 is a curved manifold.\nArticle submitted to Royal Society\nMultisymplectic formulation of fluid dynamics using the inverse map 5\nare u \u00b7 n = 0 together with any boundary conditions associated with the definition\nof the functional l[u].\nTaking the indicated variations leads to the following equations:\n\u03b4u :\n\u03b4`\n\u03b4u\n+ (\u2207l)T \u00b7 pi = 0, (3.2)\n\u03b4pi : l,t + (u \u00b7 \u2207)l = 0, (3.3)\n\u03b4l : pi,t +\u2207 \u00b7 (upi) = 0, (3.4)\nwhere (\n(\u2207l)T \u00b7 pi)\ni\n:= piklk,i, (\u2207 \u00b7 (upi))k := (ujpik),j , (3.5)\nand the variational derivative \u03b4`\/\u03b4u is defined by\n`[u+ \u000fu\u2032] = `[u] + \u000f\n\u222b\n\u2126\n\u03b4`\n\u03b4u\n\u00b7 u\u2032 dV (x) +O(\u000f2) .\nRemark 3.2 (Clebsch representation). In the language of fluid mechanics, the\nexpression (3.2) for the spatial momentum m = \u03b4`\/\u03b4u in terms of canonically con-\njugate variables (l,pi) is an example of a \u201cClebsch representation,\u201d which expresses\nthe solution of the EPDiff equations (see below) in terms of canonical variables that\nevolve by standard canonical Hamilton equations. This has been known in the case\nof fluid mechanics for more than 100 years. For modern discussions of the Clebsch\nrepresentation for ideal fluids, see, for example, Holm & Kupershmidt (1983) and\nMarsden & Weinstein (1983). In the language of geometric mechanics, the Clebsch\nrepresentation is a momentum map.\nRemark 3.3 (Vorticity structure). In general, one may obtain equivalent equations\nby enforcing the advection of any physical quantity, such as circulation density\n(Nazarenko, 1997), for example. However, the number of constraint equations must\nequal the number of spatial dimensions in order to support all possible momentum\ndistributions (and hence vorticity distributions). For example, if one only enforced\nthe advection of one component of the fluid labels then the momentum would take\nthe form pi1\u2207l1 which does not cover all possible initial conditions. For more details\nsee Holm & Kupershmidt (1983).\nRemark 3.4 (Local and global existence). The standard Clebsch representation\nof fluid mechanics (which only has one scalar constraint) is not globally-defined\nin certain circumstances, for instance if the helicity is non-zero. Indeed, it is not\nlocally defined at points where the vorticity vanishes (see Graham & Henvey (2000)).\nHowever, by using sufficiently many constraints, these problems can be overcome.\nThis is the approach that we take.\n(c) Particle relabelling\nAs the physics of fluids should be independent of the labelling of particles, one\nmay relabel the particles (by a diffeomorphism of the flow domain) without changing\nthe dynamics. This is called the particle relabelling symmetry ; Noether\u2019s theorem\napplied to this symmetry leads to the Kelvin circulation theorem. See Holm et al.\n(1998) for a modern description.\nArticle submitted to Royal Society\n6 C. J. Cotter, D. D. Holm and P. E. Hydon\n(d) Clebsch momentum map\nDefinition 3.5. A momentum map is a map J : T \u2217Q\u2192 g\u2217 from the cotangent\nbundle T \u2217Q of the configuration manifold Q to the dual g\u2217 of the Lie algebra g of\na Lie group G that acts on Q. The momentum map is defined by the formula,\nJ(\u03bdq) \u00b7 \u03be = \u3008\u03bdq, \u03beQ(q)\u3009 , (3.6)\nwhere \u03bdq \u2208 T \u2217qQ and \u03be \u2208 g. In this formula \u03beQ is the infinitesimal generator of the\naction of G on Q associated with the Lie algebra element \u03be, and \u3008\u03bdq, \u03beQ(q)\u3009 is the\nnatural pairing of an element of T \u2217qQ with an element of TqQ.\nFor the case of equations (3.2-3.4), elements of Q are given the labels l whilst\nelements of T \u2217Q are given by conjugate pairs (l,pi) of labels with their conjugate\nmomenta.\nTheorem 3.6. The Clebsch relation (3.2) defines a momentum map for the right\naction Diff(\u2126) of the diffeomorphisms of the domain \u2126 on the back-to-labels map\nl.\u2020\nProof. The spatial momentum in equation (3.2) may be rewritten as a map J\u2126 :\nT \u2217Q 7\u2192 X\u2217(\u2126) from the cotangent bundle T \u2217Q to the dual X\u2217(\u2126) of the vector\nfields X(\u2126) given by J\u2126 : m \u00b7 dx = \u2212((\u2207l)T \u00b7 pi) \u00b7 dx = \u2212pi \u00b7 dl =: \u2212pikdlk . That\nis, J\u2126 maps the space of labels and their conjugate momenta (l,pi) \u2208 T \u2217Q to the\nspace of one-form densities m \u2208 X\u2217(\u2126) on \u2126. The map may be associated with\nthe right action l \u00b7 \u03b7 of smooth invertible maps (diffeomorphisms) \u03b7 of the back-to-\nlabels maps l by composition of functions, Diff(\u2126) : l \u00b7 \u03b7 = l \u25e6 \u03b7. The infinitesimal\ngenerator of this right action is obtained from its definition, as\nX\u2126(l) :=\nd\nds\n\u2223\u2223\u2223\ns=0\n(\nl \u25e6 \u03b7(s)\n)\n= T l \u25e6X , (3.7)\nin which the vector field X \u2208 X(\u2126) is tangent to the curve of diffeomorphisms \u03b7s\nat the identity s = 0. Thus, pairing the map J\u2126 with the vector field X \u2208 X(\u2126)\nyields\n\u3008J\u2126(l,pi), X\u3009 = \u2212\u3008pi \u00b7 dl , X \u3009 = \u2212\n\u222b\nS\npiklk,jXj(x) dV (x)\n= \u2212 \u3008(l,pi), T l \u00b7X\u3009 = \u2212 \u3008(l,pi), X\u2126(l)\u3009 ,\nwhere \u3008 \u00b7 , \u00b7 \u3009 : T \u2217l Q\u00d7 TlQ 7\u2192 R is the L2 pairing of an element of T \u2217l Q (a one-form\ndensity) with an element of TlQ (a vector field). This is the defining relation for\n(3.6) to be a momentum map.\nRemark 3.7. Being the cotangent lift of the action of Diff(\u2126), the momentum\nmap J\u2126 is equivariant and Poisson. That is, substituting the canonical Poisson\nbracket into the momentum map definition yields the Lie-Poisson bracket on the\nspace of m\u2019s. See, for example, Holm & Kupershmidt (1983) and Marsden & We-\ninstein (1983) for more explanation, discussion and applications. The momentum\n\u2020 As we discuss later, this right action contrasts with fluid particle relabelling, which arises by\nthe left action of the diffeomorphisms on the inverse map.\nArticle submitted to Royal Society\nMultisymplectic formulation of fluid dynamics using the inverse map 7\nmap property of the Clebsch representation guarantees that the canonically con-\njugate variables (l,pi) may be eliminated in favour of the spatial momentum m.\nBefore its momentum map property was understood, the use of the Clebsch repre-\nsentation to eliminate the canonical variables in favour of Eulerian fluid variables\nwas a tantalising mystery (Seliger & Whitham, 1968).\nNote that the right action of Diff(\u2126) on the inverse map is not a symmetry. In\nfact, as we shall see, the right action of Diff(\u2126) on the inverse map generates the\nfluid motion itself.\n(e) Advected quantities\nTo construct more general fluid equations we shall include advected quantities\na whose flow-rules are defined by\na,t + Lua = 0, (3.8)\nwhere Lu is the Lie derivative. Such advected variables typically arise in the po-\ntential energy or the thermodynamic internal energy of an ideal fluid. For example,\nadvected scalars s (salinity, for example) satisfy\n\u2202\n\u2202t\ns+ Lus = 0, i.e. s,t + (u \u00b7 \u2207)s = 0, (3.9)\nand advected densities \u03c1dV satisfy\n\u2202\n\u2202t\n(\u03c1dV ) + Lu(\u03c1dV ) = 0, i.e. \u03c1,t +\u2207 \u00b7 (\u03c1u) = 0. . (3.10)\nA more extensive list of different types of advected quantity is given in Holm et al.\n(1998).\nWe write the reduced Lagrangian ` as a functional of the Eulerian fluid variables\nu and a, and add further constraints to the action S to account for their advection\nrelations,\nS =\n\u222b\n`[u, a] dt+\n\u222b\ndt\n\u222b\n\u2126\npi \u00b7 (l,t + (u \u00b7 \u2207)l) + \u03c6(a,t + Lua) dV (x). (3.11)\nThe Euler-Lagrange equations, which follow from the stationarity condition \u03b4S = 0,\nare\n\u03b4u :\n\u03b4`\n\u03b4u\n+ (\u2207l)T \u00b7 pi + \u03c6 \u0005 a = 0, (3.12)\n\u03b4pi : l,t + (u \u00b7 \u2207)l = 0,\n\u03b4l : \u2212pi,t \u2212\u2207 \u00b7 (upi) = 0, (3.13)\n\u03b4\u03c6 : a,t + Lua = 0,\n\u03b4a : \u2212\u03c6,t \u2212 Lu\u03c6+ \u03b4`\n\u03b4a\n= 0, (3.14)\nwhere the diamond operator (\u0005) is defined as the dual of the Lie derivative operation\nLu with respect to the L2 pairing. Explicitly, under integration by parts,\u222b\n\u2126\n(\u03c6 \u0005 a) \u00b7 udV (x) = \u2212\n\u222b\n\u2126\n(\u03c6Lua) dV (x). (3.15)\nArticle submitted to Royal Society\n8 C. J. Cotter, D. D. Holm and P. E. Hydon\nRemark 3.8. The map to the spatial momentum in equation (3.12)\n\u03b4`\n\u03b4u\n=:m = \u2212piA\u2207lA \u2212 \u03c6 \u0005 a , (3.16)\nis again a momentum map, this time for the semidirect-product action of the dif-\nfeomorphisms on \u2126\u00d7 V \u2217. Again the momentum map property allows the canonical\nvariables to be eliminated in favour of the Eulerian quantities. As a result, elimi-\nnating the variables l, pi and \u03c6 leads to the Euler-Poincare\u00b4 equation with advected\nquantities a.\n(f ) Elimination theorem\nEliminating the canonically conjugate variables (l,pi) and \u03c6 produces an equa-\ntion of motion for m = \u03b4`\/\u03b4u, which is constructed in the proof of the following\ntheorem:\nTheorem 3.9 (Elimination theorem with advected quantities). The labels (l), their\nconjugate momenta (pi) and the conjugate momentum (\u03c6) to the advected quantities\n(a) may be eliminated from equations (3.12-3.14) to obtain the weak form of the\nEuler-Poincare\u00b4 equation with advected quantities:\n\u2202\n\u2202t\n\u03b4`\n\u03b4u\n+ ad\u2217u\n\u03b4`\n\u03b4u\n= a \u0005 \u03b4`\n\u03b4a\n, a,t + Lua = 0.\nProof. Take the time-derivative of the inner product of \u03b4`\/\u03b4u with a test function\nw:\nd\ndt\n\u2329\n\u03b4`\n\u03b4u\n,w\n\u232a\n=\nd\ndt\n\u2329\n\u2212 (\u2207l)T \u00b7 pi \u2212 \u03c6 \u0005 a,w\n\u232a\n=\nd\ndt\n\u2329\n\u2212 pi, (w \u00b7 \u2207)l\n\u232a\n+\nd\ndt\n\u2329\n\u03c6,Lwa\n\u232a\n+\n\u2329\n\u03c6,LuLwa\u2212 LwLua\n\u232a\n,\n=\n\u2329\npi,\u2212 (aduw \u00b7 \u2207) l\n\u232a\n+\n\u2329\n\u03c6,Laduwa\n\u232a\n+\n\u2329\n\u03b4`\n\u03b4a\n\u0005 a,w\n\u232a\n,\n=\n\u2329\n\u2212 (\u2207l)T \u00b7 pi \u2212 \u03c6 \u0005 a, aduw\n\u232a\n+\n\u2329\n\u03b4`\n\u03b4a\n\u0005 a,w\n\u232a\n,\n=\n\u2329\n\u03b4`\n\u03b4u\n, aduw\n\u232a\n+\n\u2329\n\u03b4`\n\u03b4a\n\u0005 a,w\n\u232a\n=\n\u2329\n\u2212 ad\u2217u\n\u03b4`\n\u03b4u\n+\n\u03b4`\n\u03b4a\n\u0005 a,w\n\u232a\n.\nRemark 3.10. These Euler-Poincare\u00b4 equations with advected quantities cover all\nconservative fluid equations which describe the advection of material. For a large\ncollection of examples, see Holm et al. (1998).\nArticle submitted to Royal Society\nMultisymplectic formulation of fluid dynamics using the inverse map 9\n(g) Example: EPDiff(H1)\nTo give a concrete example, consider EPDiff with `[u] being the H1\u03bb-norm for u.\nThis is the n-dimensional Camassa-Holm (CH) equation (Camassa & Holm, 1993;\nHolm et al., 1998; Holm & Marsden, 2004), which has applications in computational\nanatomy (Holm et al., 2004; Miller et al., 2002). This system has the reduced\nLagrangian\n`[u] =\n\u222b\n\u2126\n1\n2\n(|u|2 + \u03bb2|\u2207u|2) dV (x) = \u222b\n\u2126\n1\n2\n(\nuiui + \u03bb2ui,jui,j\n)\ndV (x) \u2261 1\n2\n\u2016u\u20162H1\u03bb ,\nwhich defines the H1\u03bb-norm for \u03bb > 0. The EPDiff equation amounts to\n\u2202m\n\u2202t\n+ (u \u00b7 \u2207)m+ (\u2207u)T \u00b7m+m\u2207 \u00b7 u = 0, m = (1\u2212 \u03bb2\u22072)u .\nWhen n = 1, these reduce to the Camassa-Holm (CH) equation,\nm,t + um,x + 2mu,x = 0, m = u\u2212 \u03bb2u,xx .\n(h) Example: Incompressible Euler equations\nAs an example, consider the reduced Lagrangian for the incompressible Euler\nequations\n`[u, \u03c1, p] =\n\u222b\n\u2126\n\u03c1|u|2\n2\n+ p(1\u2212 \u03c1) dV (x) .\nHere \u03c1(x, t) is the ratio of the local fluid density to the average density over \u2126; this is\ngoverned by the continuity equation (3.10). The pressure p is a Lagrange multiplier\nthat fixes the incompressibility constraint \u03c1 = 1. The variational derivatives in this\ncase are\n\u03b4`\n\u03b4u\n= \u03c1u,\n\u03b4`\n\u03b4\u03c1\n=\n|u|2\n2\n\u2212 p, \u03b4`\n\u03b4p\n= 1\u2212 \u03c1 .\nConsequently, the Euler-Poincare\u00b4 equations become\n(\u03c1u),t + (u \u00b7 \u2207)(\u03c1u) + \u03c1u(\u2207 \u00b7 u) + \u03c1(\u2207u)T \u00b7 u = \u03c1\u2207\n( |u|2\n2\n\u2212 p\n)\n,\n\u03c1,t +\u2207 \u00b7 (\u03c1u) = 0,\n\u03c1 = 1,\nand rearrangement gives the Euler fluid equations,\nu,t + (u \u00b7 \u2207)u = \u2212\u2207p, \u2207 \u00b7 u = 0.\n4. Inverse map multisymplectic formulation for the\nEuler-Poincare\u00b4 equations of fluid dynamics\nAs we now have a canonical variational principle for fluid dynamics via the inverse\nmap, one may obtain its multisymplectic formulation by extending the phase space\nso that the Lagrangian is affine in the space and time derivatives. In this section\nwe show how to do this for EPDiff(H1) as discussed in the previous section, and\nthen show how to generalise this to equations with advected quantities, using the\nincompressible Euler equations as an example.\nArticle submitted to Royal Society\n10 C. J. Cotter, D. D. Holm and P. E. Hydon\n(a) Affine Lagrangian for EPDiff(H1)\nAfter introducing the inverse map constraint, the Lagrangian becomes\nL =\n1\n2\nuiui +\n\u03bb2\n2\nui,jui,j + pik (lk,t + uj lk,j) .\nAny high-order derivatives and nonlinear functions of first-order derivatives must\nnow be removed from the Lagrangian to make it affine. We introduce a tensor\nvariable\nWij = ui,j ;\nthis relationship may be enforced by using Lagrange multipliers. However, it turns\nout that the multipliers can be eliminated and the Lagrangian becomes\nL =\n1\n2\nuiui \u2212 \u03bb\n2\n2\nWijWij + \u03bb2Wijui,j + pik (lk,t + uj lk,j) , (4.1)\nwhich is now affine in the space and time derivatives of u, W , l and pi.\n(b) Multisymplectic structure\nThe Euler-Lagrange equations for the affine Lagrangian (4.1) are\n\u03b4ui : ui \u2212 \u03bb2Wij,j + piklk,i = 0,\n\u03b4lk : \u2212pik,t \u2212 (pikuj),j = 0.\n\u03b4pik : lk,t + uj lk,j = 0,\n\u03b4Wij : \u2212\u03bb2Wij + \u03bb2ui,j = 0.\nThese equations possess the following multisymplectic structure as in equation (2.2):\uf8eb\uf8ec\uf8ec\uf8ed\n0 pik\u2202i \u2212\u03bb2\u2202j\n\u2212pik\u2202i 0 \u2212\u2202t \u2212 uj\u2202j 0\n0 \u2202t + uj\u2202j 0 0\n\u03bb2\u2202j 0 0 0\n\uf8f6\uf8f7\uf8f7\uf8f8\n\uf8eb\uf8ec\uf8ec\uf8ed\nui\nlk\npik\nWij\n\uf8f6\uf8f7\uf8f7\uf8f8 = \u2207H,\nwhere \u2202t = \u2202\/\u2202t, \u2202i = \u2202\/\u2202xi, and\nH = \u2212\n(\n1\n2\nuiui \u2212 \u03bb\n2\n2\nWijWij\n)\n= \u2212\n(\n1\n2\n|u|2 \u2212 \u03bb\n2\n2\n|W |2\n)\n.\n(c) One-form quasi-conservation law\nFor our multisymplectic formulation of EPDiff(H1), the independent variables\nare\nqj = xj , j = 1, . . . n, qn+1 = t,\nand the dependent variables are\nzi = ui, zn+k = lk, z2n+k = pik, z(i+2)n+j =Wij , (4.2)\nArticle submitted to Royal Society\nMultisymplectic formulation of fluid dynamics using the inverse map 11\nwhere i, j and k range from 1 to n. Comparing (4.1) with (2.1) gives the following\nnon-zero components L\u03b1j :\nLji = \u03bb\n2Wij , L\nj\nn+k = pikuj , L\nn+1\nn+k = pik, i, j, k = 1, . . . , n.\nTherefore the one-form quasi-conservation law amounts to\n(pikdlk),t +\n(\n\u03bb2Wijdui + pikujdlk\n)\n,j\n= dL. (4.3)\nThe exterior derivative of this expression yields the structural conservation law\n(dpik \u2227 dlk),t +\n(\n\u03bb2dWij \u2227 dui + ujdpik \u2227 dlk + pikduj \u2227 dlk\n)\n,j\n= 0. (4.4)\n(d) Conservation of energy\nFor EPDiff(H1), the dt-component of the pullback of the one-form conservation\nlaw (4.3) gives\n(piklk,t \u2212 L),t +\n(\n\u03bb2Wijui,t + pikuj lk,t\n)\n,j\n= 0.\nIn terms of u and its derivatives, this amounts to(\nuimi \u2212 12uiui \u2212\n\u03bb2\n2\nui,jui,j\n)\n,t\n+\n(\n\u03bb2ui,jui,t + uiujmi\n)\n,j\n= 0,\nwhere\nmi = ui \u2212 \u03bb2ui,kk.\nThis is the energy conservation law for EPDiff(H1).\n(e) Conservation of momentum\nSimilarly, the conservation law that is associated with translations in the xi-\ndirection is\n(piklk,i),t +\n(\n\u03bb2Wkjuk,i + pikuj lk,i \u2212 \u03b4ijL\n)\n,j\n= 0,\nwhich amounts to the momentum conservation law\nmi,t +\n(\n\u03bb2uk,iuk,j \u2212 ujmi \u2212 \u03b4ij\n(\n1\n2\nukuk +\n\u03bb2\n2\nuk,luk,l\n))\n,j\n= 0.\n(f ) Conservation of vorticity\nNext, consider the coefficient of each dxr\u2227dxs in the pull-back of the structural\n(two-form) conservation law (4.4). This is\n(pik,rlk,s \u2212 pik,slk,r),t +\n(\n\u03bb2 (Wij,rui,s \u2212Wij,sui,r) +\nuj (pik,rlk,s \u2212 pik,slk,r) + pik (uj,rlk,s \u2212 uj,slk,r)\n)\n,j\n= 0,\nwhich amounts to\n(mr,s \u2212ms,r),t +\n(\n\u03bb2 (ui,sui,jr \u2212 ui,rui,js) + (ujmr),s \u2212 (ujms),r\n)\n,j\n= 0.\nOne can regard this as a vorticity conservation law for EPDiff(H1); it is a differential\nconsequence of the momentum conservation law.\nArticle submitted to Royal Society\n12 C. J. Cotter, D. D. Holm and P. E. Hydon\n(g) Particle relabelling symmetry\nAs we discussed in Section 3, fluid equations in general, and EPDiff in partic-\nular, are invariant under relabelling of particles. In the context of the inverse map\nvariables, relabelling is accomplished by the action of the diffeomorphism group\nDiff(\u2126) defined by\nl 7\u2192 \u03b7 \u25e6 l \u2261 \u03b7(l), \u03b7 \u2208 Diff(\u2126).\nThe corresponding infinitesimal action of the vector fields X(\u2126) is then\nl 7\u2192 \u03be \u25e6 l \u2261 \u03be(l), \u03be \u2208 X(\u2126),\nand the cotangent lift of this action is\n(pi, l) 7\u2192 (\u2212(\u2207\u03be(l))T \u00b7 pi, \u03be(l)) .\nTo obtain the symmetry generator (2.7), we extend the above action to first deriva-\ntives as follows:\nX = \u03bek(l)\n\u2202\n\u2202lk\n+ (\u03bek(l)),t\n\u2202\n\u2202lk,t\n+ (\u03bek(l)),i\n\u2202\n\u2202lk,i\n\u2212pik \u2202\u03bek(l)\n\u2202lj\n\u2202\n\u2202pij\n\u2212\n(\npik\n\u2202\u03bek(l)\n\u2202lj\n)\n,t\n\u2202\n\u2202pij,t\n\u2212\n(\npik\n\u2202\u03bek(l)\n\u2202lj\n)\n,i\n\u2202\n\u2202pij,i\n.\nThe relabelling symmetries are variational, because\nXL = pik(\u03bek(l)),t + pikui(\u03bek(l)),i \u2212 pik \u2202\u03bek(l)\n\u2202lj\n(lj,t + uilj,i) = 0.\nNoether\u2019s theorem then gives the conservation law\n(pik\u03bek(l)),t + (pikuj\u03bek(l)),j = 0.\nA conservation law exists for each element \u03be of X(\u2126), so particle relabelling gener-\nates an infinite space of conservation laws.\n(h) Circulation theorem\nTo see how the particle relabelling conservation laws relate to conservation of\ncirculation, note that if \u03c1 is any density that satisfies\n\u03c1,t + (\u03c1uj),j = 0,\nthen (\npik\u03bek(l)\n\u03c1\n)\n,t\n+ uj\n(\npik\u03bek(l)\n\u03c1\n)\n,j\n= 0.\nIf we pick a loop C(t) which is advected with the flow, then\nd\ndt\n\u222e\nC(t)\npik\u03bek(l)\n\u03c1\ndx = 0.\nArticle submitted to Royal Society\nMultisymplectic formulation of fluid dynamics using the inverse map 13\nFor a vector field \u03be which is tangent to the loop at time 0, and satisfies |\u03be| = 1 on\nthe loop, then\n\u03bedx = (\u2207l) \u00b7 dx\nfor all times t, and one finds\nd\ndt\n\u222e\nC(t)\npi \u00b7 (\u2207l)\n\u03c1\n\u00b7 dx = 0, (4.5)\nThe momentum formula (3.2) gives\nd\ndt\n\u222e\nC(t)\n(1\u2212 \u03bb2\u22072)u\n\u03c1\n\u00b7 dx = d\ndt\n\u222e\nC(t)\nm\n\u03c1\n\u00b7 dx = 0,\nwhich is the circulation theorem for EPDiff.\n(i) Advected quantities\nTo extend this method to more general equations with advected quantities is\nvery simple: take the Lagrangian obtained from equation (3) and add variables to\nrepresent higher-order derivatives. For the sake of brevity we shall compute one\nexample, the incompressible Euler equations, and briefly discuss the implications\nfor the circulation theorem.\n(j ) Multisymplectic form of incompressible Euler equations\nWe start with the reduced Lagrangian\n`[u, p, \u03c1] =\n\u222b\n\u2126\n1\n2\n\u03c1uiui + p(1\u2212 \u03c1)dV (x),\nwhere p is the pressure and \u03c1 is the relative density, and add dynamical constraints\nto form the Lagrangian:\nL =\n1\n2\n\u03c1uiui + p(1\u2212 \u03c1) + pik (lk,t + uilk,i) + \u03c6 (\u03c1,t + (\u03c1ui),i) .\nThis Lagrangian is already affine in the first-order derivatives, so the Euler-Lagrange\nequations are automatically multisymplectic in these variables:\uf8eb\uf8ec\uf8ec\uf8ec\uf8ec\uf8ec\uf8ec\uf8ed\n0 0 pik\u2202i 0 \u2212\u03c1\u2202i 0\n0 0 0 0 \u2212\u2202t \u2212 ui\u2202i 0\n\u2212pik\u2202i 0 0 \u2212\u2202t \u2212 ui\u2202i 0 0\n0 0 \u2202t + ui\u2202i 0 0 0\n\u03c1\u2202i \u2202t + ui\u2202i 0 0 0 0\n0 0 0 0 0 0\n\uf8f6\uf8f7\uf8f7\uf8f7\uf8f7\uf8f7\uf8f7\uf8f8\n\uf8eb\uf8ec\uf8ec\uf8ec\uf8ec\uf8ec\uf8ec\uf8ed\nui\n\u03c1\nlk\npik\n\u03c6\np\n\uf8f6\uf8f7\uf8f7\uf8f7\uf8f7\uf8f7\uf8f7\uf8f8 = \u2207H,\nwhere the quantity\nH = \u2212\n(\n1\n2\n\u03c1uiui + p(1\u2212 \u03c1)\n)\nis negative of the Hamiltonian density.\nArticle submitted to Royal Society\n14 C. J. Cotter, D. D. Holm and P. E. Hydon\n(k) Circulation theorem for advected quantities\nThe conservation law for particle-relabelling follows exactly as in Section 4,\nand we obtain equation (4.5) as before. The difference is that now the momentum\nformula (momentum map) is\nm =\n\u2202`\n\u2202u\n= \u2212pik\u2207lk \u2212 \u03c6 \u0005 a\nand so one obtains\nd\ndt\n\u222e\nC(t)\nm\n\u03c1\n\u00b7 dx =\n\u222e\nC(t)\n1\n\u03c1\n\u2202`\n\u2202a\n\u0005 a \u00b7 dx.\nFor the incompressible Euler equations, a is the relative density \u03c1, so\n\u2202`\n\u2202a\n\u0005 a = \u03c1\u2207 \u2202`\n\u2202\u03c1\n,\nwhich leads to the circulation theorem\nd\ndt\n\u222e\nC(t)\nm\n\u03c1\n\u00b7 dx =\n\u222e\nC(t)\n\u2207 \u2202`\n\u2202\u03c1\n\u00b7 dx = 0.\nRemark 4.1 (\u2018Hidden\u2019 conservation law). Yakhot & Zakharov (1997) discuss a\n\u2018hidden\u2019 conservation law, which amounts to the preservation of the integral of\n|pi|2 over label space. Similarly the label-space integral of any differentiable func-\ntion F (|pi|) over label space is preserved. This corresponds to the local conservation\nlaw (\nF (|pi|))\n,t\n+\n(\nujF (|pi|)\n)\n,j\n= 0,\nwhich is a consequence of (3.13) and the incompressibility condition.\n5. A note on multisymplectic integrators\nIn this section we discuss briefly how to produce multisymplectic numerical inte-\ngrators, using the inverse map formulation given in this paper. We note in par-\nticular that the multisymplectic method may have discrete forms of some of the\nparticle-relabelling symmetries and hence we will obtain a method that has discrete\nconservation laws.\n(a) Variational integrators\nA multisymplectic integrator for a PDE is a numerical method which preserves\na discrete conservation law for the two-form \u03ba given in equation (2.4) (Bridges &\nReich, 2001). As described in (Hydon, 2005), a discrete variational principle with\na Lagrangian that is affine in first-order differences automatically leads to a set of\ndifference equations which conserve the multisymplectic two-form. This now makes\nit very simple to construct multisymplectic integrators for fluid dynamics using the\ninverse map formulation: one simply replaces the spatial and time integrals in the\naction with numerical quadratures, replaces the first-order derivatives by differ-\nences, and takes variations following the standard variational integrator approach\n(Lew et al., 2003). Whilst the method will preserve the discrete conservation law\nfor the two-form \u03ba, the one-form quasi-conservation law will not be preserved in\ngeneral, and hence the other conservation laws will not be exactly preserved.\nArticle submitted to Royal Society\nMultisymplectic formulation of fluid dynamics using the inverse map 15\n(b) Discrete relabelling symmetry\nAs pi and l are still continuous in the discretised equations, the multisymplectic\nintegrator will have discrete particle-relabelling symmetries analogous to those given\nin Section 4, provided that discretisation maintains the symmetry. For example,\ntake the following centred differencing scheme for the advection constraint L\u02c6 of the\nLagrangian L (choosing one space dimension for simplicity):\nL\u02c6 = pin+1\/2i+1\/2\n(\nln+1i+1\/2 \u2212 lni+1\/2\n\u2206t\n\u2212 un+1\/2i+1\/2\nl\nn+1\/2\ni+1 \u2212 ln+1\/2i\n\u2206x\n)\n,\nwhere (pini , l\nn\ni ) are the approximations to (pi(i\u2206x, n\u2206t), l(i\u2206x, n\u2206t)) and where n+\n1\/2 and i+1\/2 indices indicate averaging over time-levels n and n+1, and averaging\nover space-levels i and i+1, respectively. If we choose the relabelling generated by\n\u03be(l) = al + b, then the corresponding cotangent-lifted symmetry is\nX = (al + b)\n\u2202\n\u2202l\n\u2212 pia \u2202\n\u2202pi\nand\nXL\u02c6 = pin+1\/2i+1\/2\n(\na\nln+1i+1\/2 \u2212 lni+1\/2\n\u2206t\n\u2212 un+1\/2i+1\/2 a\nl\nn+1\/2\ni+1 \u2212 ln+1\/2i\n\u2206x\n)\n\u2212apin+1\/2i+1\/2\n(\nln+1i+1\/2 \u2212 lni+1\/2\n\u2206t\n\u2212 un+1\/2i+1\/2\nl\nn+1\/2\ni+1 \u2212 ln+1\/2i\n\u2206x\n)\n= 0.\nFollowing the variational integrator programme described in Lew et al. (2003) the\ndiscrete form of Noether\u2019s theorem will give rise to discrete conservation laws for\nthe multisymplectic method. It is an open question as to whether it is possible to\nobtain differencing schemes which are invariant under more general transformations\nof the label variables.\n6. Summary and Outlook\n(a) Summary\nThis paper describes a multisymplectic formulation of Euler-Poincare\u00b4 equations\n(which are, in essence, fluid dynamical equations with a particle-relabelling sym-\nmetry). We have used the inverse map to obtain a canonical variational principle,\nfollowing Holm & Kupershmidt (1983). As noted in Hydon (2005), a multisymplec-\ntic formulation can be obtained by choosing variables such that the Lagrangian\nat most linear in the first-order derivatives, and contains no higher-order deriva-\ntives. We have shown how to construct the multisymplectic formulation for the\nEuler-Poincare\u00b4 equations for diffeomorphisms, using the example of the EPDiff(H1)\nequations, and how to extend the method to the Euler-Poincare\u00b4 equations with ad-\nvected quantities. These equations encompass many fluid systems, including incom-\npressible Euler, shallow-water, Euler-alpha, Green-Naghdi, perfect complex fluids,\ninviscid magnetohydrodynamics, etc.\nThe techniques of Hydon (2005) have led to conservation laws for these systems,\nincluding the usual multisymplectic conservation laws for energy and momentum\nArticle submitted to Royal Society\n16 C. J. Cotter, D. D. Holm and P. E. Hydon\nplus an infinite set of conservation laws which arise from the particle-relabelling\nsymmetries of fluid dynamics. We have highlighted the connection between these\nlatter conservation laws and Kelvin\u2019s circulation theorem, and showed that mul-\ntisymplectic integrators based on this formulation may have discrete conservation\nlaws associated with some these symmetries.\n(b) Outlook\nIn the last section of this paper we have discussed the possibility of develop-\ning multisymplectic integrators for fluids using this framework. These ideas may\naid the future development of integrators that have conservation laws for vortic-\nity and circulation, which are desirable for numerical weather prediction and other\napplications. It is undoubtedly simple to construct such integrators, but the issue\nof accuracy with time arises whenever the flow is strongly mixing and numerical\nerrors make the label field l very noisy. At present this restricts the applicability\nof these methods to problems such as nonlinear internal wave propagation which\ndo not entangle fluid labels. One potential solution would be to try to construct an\nintegrator where the conjugate variables (pi, l) can be eliminated; this would only\nbe possible if there were a finite-dimensional Lie algebra which could be used to\napproximate the space of vector fields.\nIn a different direction, we believe that multisymplectic integrators would be\nespecially apt for applications of EPDiff to template-matching in computational\nanatomy (Holm et al., 2004). The matching problem is an initial-final value problem.\nIn such problems, space and time may be treated on an equal footing, just as in\nthe multisymplectic formulation.\n(c) Acknowledgements\nThe work of DDH was partially supported by the Royal Society of London\nWolfson Award and the US Department of Energy Office of Science ASCR. The\nauthors would like to thank the referees for their suggested improvements to the\npaper.\nReferences\nBridges, T. J. Multi-symplectic structures and wave propagation. Math. Proc. Camb. Phi-\nlos. Soc., 121:147\u2013190, 1997.\nBridges, T. J., Hydon, P. E., & Reich, S. Multi-symplectic integrators: numerical schemes\nfor Hamiltonian PDEs that preserve symplecticity. J. Phys. A, 38:1403\u20131418, 2005.\nBridges, T. J. & Reich, S. Multi-symplectic integrators: numerical schemes for Hamiltonian\nPDEs that preserve symplecticity. Phys. Lett., 284A:184\u2013193, 2001.\nCamassa, R. & Holm, D. D. An integrable shallow-water equation with peaked solitons.\nPhysical Review Letters, 71:1661\u20131664, 1993.\nGraham, C. R. & Henyey, F. S. Physics of Fluids, 12:744\u2013746, 2000.\nHolm, D. D. & Kupershmidt, B. Poisson brackets and Clebsch representations for magne-\ntohydrodynamics, multifluid plasmas, and elasticity. Physica D, 6:347\u2013363, 1983.\nHolm, D. D. & Marsden, J. E. Momentum maps and measure valued solutions (peakons,\nfilaments, and sheets) of the Euler-Poincare\u00b4 equations for the diffeomorphism group.\nArticle submitted to Royal Society\nMultisymplectic formulation of fluid dynamics using the inverse map 17\nIn J. E. Marsden & T. S. Ratiu, editors, The Breadth of Symplectic and Poisson Ge-\nometry: A Festshrift for Alan Weinstein, Birkha\u00a8user, Boston, MA., 2004, pp. 203\u2013235.\nhttp:\/\/arxiv.org\/abs\/nlin.CD\/0312048.\nHolm, D. D., Marsden, J. E. & Ratiu, T. S., The Hamiltonian Structure of Continuum\nMechanics in Material, Inverse Material, Spatial and Convective Representations. In\nHamiltonian Structure and Lyapunov Stability for Ideal Continuum Dynamics, Univ.\nMontreal Press, 1986, pp. 1\u2013124.\nHolm, D. D., Marsden, J. E., & Ratiu, T. S. The Euler\u2013Poincare\u00b4 equations and semidi-\nrect products with applications to continuum theories. Adv. in Math., 137:1\u201381, 1998.\nhttp:\/\/arxiv.org\/abs\/chao-dyn\/9801015.\nHolm, D. D., Rananather, J. T., Trouve\u00b4, A., & Younes, L. Soliton dynamics in computa-\ntional anatomy. NeuroImage, 23:170\u2013178, 2004. http:\/\/arxiv.org\/abs\/nlin.SI\/0411014.\nHydon, P. E. Multisymplectic conservation laws for differential and differential-difference\nequations. Proc. Roy. Soc. LOnd. A, 461:1627\u20131637, 2005.\nLew, A., Marsden, J. E., Ortiz, M. & West, M. An overview of variational integrators. In\nL. P. Franca, T. E. Tezduyar & A. Masud, editors, Finite Element Methods: 1970s and\nBeyond. CIMNE, Barcelona, Spain, 2004, pp. 98\u2013115.\nLin, C. C. Liquid Helium. In Proceedings of the Enrico Fermi International School of\nPhysics, Course XXI, G. Careri, editor, Academic Press, New York, 1963, pp. 93\u2013146.\nMarsden, J., Pekarsky, S., Shkoller, S., and West, M. Variational methods, multisymplectic\ngeometry and continuum mechanics. J. Geom. Phys. 38:253\u2013284, 2001.\nMarsden, J. E. & Weinstein, A. Coadjoint orbits, vortices, and Clebsch variables for in-\ncompressible fluids. Physica D, 7:305\u2013323, 1983.\nMiller, M. I., Trouve\u00b4, A. & Younes, L. On the metrics and Euler-Lagrange equations of\ncomputational anatomy. Ann. Rev. Biomed. Engrg., 4:375\u2013405, 2002.\nNazarenko, S.V. The circulation density and its role in 3D turbulence, Physica D 102:343\u2013\n348, 1997.\nSeliger, R. L. & Whitham, G. B. Variational principles in continuum mechanics. Proc.\nRoy. Soc. Lond. A 305: 1\u201325, 1968.\nSerrin, J. Mathematical principles of classical fluid mechanics. In S. Flu\u00a8gge & C. Truesdell,\neditors, Handbuch der Physik VIII\/I. Springer-Verlag, Berlin, 1959, pp. 125\u2013263.\nYakhot, V. & Zakharov, V. Hidden conservation laws in hydrodynamics, energy and dis-\nsipation rate fluctuation spectra in strong turbulence. Physica D 64 379\u2013394, 1997.\nArticle submitted to Royal Society\n"}