{"doi":"10.1109\/ICICS.2003.1292640","coreId":"102469","oai":"oai:epubs.surrey.ac.uk:1931","identifiers":["oai:epubs.surrey.ac.uk:1931","10.1109\/ICICS.2003.1292640"],"title":"A print-and-scan resilient digital watermark for card authentication","authors":["Ho, Anthony T. S.","Shu, Feng"],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2003-12-15","abstract":"<p>In this paper, a secure card authentication system based on digital watermarking is presented. A sequence of identification characters, e.g. owner's ID number is inserted into the photograph, thus a linkage between the photograph and its owner can be established. The print-and-scan process is successfully overcome by our transform coefficient polarity based watermarking algorithm. The retrieval algorithm is capable of verifying whether the inspected card is authorized. We apply our algorithm for 105 photographs and the success rate achieved is better than 96%.<\/p","downloadUrl":"","fullTextIdentifier":null,"pdfHashValue":null,"publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:epubs.surrey.ac.uk:1931<\/identifier><datestamp>\n      2017-10-31T14:03:41Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      74797065733D636F6E666572656E63655F6974656D<\/setSpec><setSpec>\n      6469766973696F6E733D656E67616E64706879736963616C736369656E636573:436F6D707574696E67<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/epubs.surrey.ac.uk\/1931\/<\/dc:relation><dc:title>\n        A print-and-scan resilient digital watermark for card authentication<\/dc:title><dc:creator>\n        Ho, Anthony T. S.<\/dc:creator><dc:creator>\n        Shu, Feng<\/dc:creator><dc:description>\n        <p>In this paper, a secure card authentication system based on digital watermarking is presented. A sequence of identification characters, e.g. owner's ID number is inserted into the photograph, thus a linkage between the photograph and its owner can be established. The print-and-scan process is successfully overcome by our transform coefficient polarity based watermarking algorithm. The retrieval algorithm is capable of verifying whether the inspected card is authorized. We apply our algorithm for 105 photographs and the success rate achieved is better than 96%.<\/p><\/dc:description><dc:date>\n        2003-12-15<\/dc:date><dc:type>\n        Conference or Workshop Item<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/epubs.surrey.ac.uk\/1931\/1\/fulltext.pdf<\/dc:identifier><dc:identifier>\n          Ho, Anthony T. S. and Shu, Feng  (2003) A print-and-scan resilient digital watermark for card authentication  In: Fourth International Conference on Information, Communications and Signal Processing, 2003 and the Fourth Pacific Rim Conference on Multimedia. Proceedings of the 2003 Joint.     <\/dc:identifier><dc:relation>\n        10.1109\/ICICS.2003.1292640<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/epubs.surrey.ac.uk\/1931\/","10.1109\/ICICS.2003.1292640"],"year":2003,"topics":[],"subject":["Conference or Workshop Item","PeerReviewed"],"fullText":"2c2.1 \nA Print-and-scan Resilient Digital Watermark for \nCard Authentication \nAnthony T. S. Ho and Feng Shu \nSchool of Electrical and Electronic Engineering \nNanyang Technological University \nNanyang Avenue, Singapore 639798 \nE-mail: etsho@ntu.edu.sg \nAbsbaef-In this paper, a secnm card authentication system \nbased on digital watermarking is pmented. A sequence of \nidentification characters e.g. owner\u2019s ID number is inserted \ninto the photograph, thus a linkage between the photograph \nand its owner c m  he established. The print-and-scan process is \nsuccessfdy uvemme by our transform d a e n t  polarity based \nwatermarking algorithm. The retrieval algorithm is capable of \nverifying whether the inspected card is authorized. We apply onr \nalgorithm for 105 photographs and the success rate achieved is \nbetter than 96%. \nI. INTRODUCTION \nIn recent years, the rapid development of digital watermark- \ning has led to a significant number of watermarking algorithm \nhave been proposed in the literature. Apart from copyright \nprotection, which has attracted much research attention, the \nother application in digital watermarking which has also \nreceived a considerable interest is image authentication. \nIn a watermarking authentication system, a sequence of \nidentification or a visual pattern, that is, the watermark, is \nimperceptibly embedded into the host media. The watermarked \nmedia data generally goes thmugh some distortion chan- \nnel. The recovered watermark from inspected data is used \nfor authentication in different ways, such as localizing the \ndistortions([ 11, [2]), determining the type of attacks performed \n[3] or verifying the genuineness of the data. \nIn this paper, we devise a watermarking system to authen- \nticate cards with the owner\u2019s photograph. These cards include \nstudent cards, identity cards, passports and driving licenses. \nNowadays, with some sophisticated editing tools (for example, \nPhotoshop), and printing and scanning facilities, it is extremely \neasy to modify or replace the original photograph, and to make \nfake security documents or cards [6]. It is reported that two- \nthirds of passport frauds are due to photograph substitution \nTo prevent such photograph substitution frauds, in the \nproposed watermarking system, we directly establish a linkage \nbetween the owner\u2019s photo and hisher personal information \nby imperceptibly superimposing the personal identification \ninformation, considered as the watermark, into the original \nphotograph. The main challenge in the proposed system is to \novercome the print-and-scan (PS) process, which is regarded \nas a combination of different attacks [8]. \n~71. \nThe host data in our watermarking system are face pho- \ntographs. The size of the standard photos on the security \ncards, such as student cards, are around 1x1 inch (we use \n180x130 pixels photos), which is much smaller than the host \nimages used in most image watermarking algorithms proposed \nin the literature. Face photos are typically very smooth, which \nare much easier to introduce degradation during watermark \nembedding. Fnrthermore, a multi-hit watermark is hidden into \nthe smooth face photos of small size, while the photo integrity \nmust be maintained at the same time. \nOur paper is organized as as follows. In section II, we \nintroduce the framework of our proposed card authentica- \ntion system, the print-and-scan process and the Hadamard \ntransfom-based watermarking embedding and retrieval algo- \nrithms. Experimental results are presented in section lll, and \nconclusions in section N. \n11. OUR PROPOSED CARD AUTHENTICATION SYSTEM \nA. Framework of card authentication system \nIn this section, the framework of ow proposed authentica- \ntion system is introduced. The watermark embedding process \nis illustrated in Fig. 1. \nThe Owner\u2019s photo is first scanned into the computer. The \nscanned photo will be the host image for the embedding algo- \nrithm. The watermark is a sequence of personal information (a \nsequence consisting of combination of characten and numbers \nis used here). The embedding algorithm is based on the \npolarity of Hadamad transform coefficients, that determines \nthe insertion of the watermark sequence into the host image. \nThe Watermarked image and a secret key, are then generated. \nThe watermarked photo is printed on the owner\u2019s security \ndocument or card. The retrieval and verification process, as \ndepicted in Fig. 2, is performed on the scanned photo of an \ninspected card for authentication. \nB. Print-and-scan process \nThere is currently very limited research has being performed \non the print-and-scan process. After a digital image is printed- \nand-scanned, various distortions are introduced. Distortion \ncould occur in both the pixel values and the geometric bound- \nary of the rescanned image [8]. \n0-7803-8185-8\/03\/$17.00 2003 IEEE 1149 \nScanner Original Image \nWatermark: \n990669603 \nFig. 1. Embedding process. \n... \nExtracted \nWatermark: \n990669G03 \n&&&& \n+ \nScanner \nFig. 2. Retrieval and verification process. \n~..~.. .. . Printer Scanner \nDigital Print-scan Dipitat \nprocess Image \nFig. 3. Print-and-scan pccess. \nTypical distortions of pixel values could be caused by the lu- \nminance, contrast, gamma correction, chrominance variations \nand the blurring of adjacent pixels. Distortion of the geometric \nboundary in a DAD (digital-analogue-digital) process is caused \nby rotation, scaling and cropping. The print-and-scan process \nis shown in Fig.3. \nThe PS process could he modeled and explained by dividing \ninto two scenarios. For the first scenario, rotation and cropping \nare included in the PS process. Scenario 1 PS is usually \nperformed by an adversary, thus such PS is considered as a \nmalicious combined attack. While in Scenario 2, rotation and \ncropping are not taken into account. To overcome Scenario \nI PS, techniques capable of conquering rotation, scaling \nand wanslation (RST) must be simultaneously included. The \nRST attacks, however, still remain an unsolved problem in \nwatermarking, although some techniques were proposed in the \nliterature [4]. In OUT system, the PS is considered as an inherent \nsystem distortion rather than a malicious attack, thus Scenario \n2 PS process is involved. \nC. Spread spectrum based watermark embedding and re- \ntrieval \nIn this section, the proposed watermark embedding and \nretrieval algorithm is presented. \nI )  Watermark embedding algorithm: The spread spectrum \nbased watermark embedding algorithm is depicted in Fig.4. \nFirst, the watermark bit, either 1 or 0, is expanded \ninto a binary sequence in the following manner: if the \nwatermark bit is 1, then it is represented by data w , ~ :  \n11, -1,1,  -1,l, -1,1, -1, ...} and the length of this sequence \nis m; if the watermark bit is 0, then it is represented by \ndata wm0: {-1,1, -1,1, -1,1, -1, ...} and the length of this \nsequence is also m. \nThen we transform the original image. A Hadamard trans- \nform is used in our algorithm, due to its simplicity and ease \nfor hardware implementation [5]. For one bit of watermark, \nthat has been expanded into a sequence with length of rn , we \nneed to use the same amount of coefficients for insertion. The \nembedding process can he divided into two passes: \n(1)Polarity modulation; \n(2)Amplitude modulation. \n11.50 \nWatermark \nexpansion \nInverse Pass 1 : \nPolarity image modulation modulation \nWatermark \n(binaiy) \nTransformed \nhost image exiraction \nFig. 4. Block diagram of watermark embedding algorithm. \nDecision Retrieved \nextraction watermark \nTransformed \nhost image \nwl and w0 \nFig. 5 .  Block diagram of watermark extraction algorithm \nConsider that we embed one watermark bit. At first, we \nobtain the polarity sequence of the selected transform coeffi- \ncients, as follows: \n1, if c[i] 2 0 \n0, if c[i]  < 0 \nwhere c[i] (1 5 i 5 m) denotes selected coefficients. \nFor the first pass, we modulate the coefficients\u2019 polarities \nin order to make the correlation value between s, and w, \nor wm0 satisfying the following equation: \n5 \n~ \nm T = {  v = I\u201drnD, \nwhere T1 denotes certain threshold for the correlation. In our \nexperiments, we set T1 as 0.3. If the original polarity sequence \ndoes not satisfy Equation (2), some of the coefficients\u2019 polar- \nities would be changed until the modified polarity sequence \nsatisfies the condition. However, if we change the polarities \nof the coefficients having large amplitude, the image quality \nis easily degraded. Thus, the polarities of those transform \ncoefficients having smaller amplitude should be changed with \nhigher priority. \nIn the amplitude modulation pass, we increase the amplitude \nof all the selected coefficients up to the prescribed threshold \nTz, with the polarity of coefficients maintained. After a wa- \ntermarked image has gone through some distortion channels, \nthe transform coefficients would be altered. Such alteration, \nhowever, is generally within a certain range [9]. Therefore, if \nthe amplitude of a coefficient is increased to be greater than the \nrange, it has a higher probability to maintain its polarity under \ncertain attacks such as JPEG compression, median filtering, \nalthough its amplitude would still be altered. The equation for \namplitude modulation is defined as follows. \nwhere n is defined as a certain step size, 1 is the ceil func- \ntion, and c and c\u2018 denote original Coefficients and modulated \ncoefficents, respectively . We define the sign(c) as follows: \nBy using Equation (4), the coefficients\u2019 amplitudes are \nincreased to the range [Tz,Tz + %I. \n2) Watermark retrieval algorirhm: To extract the water- \nmark, we again perform a Hadamard transform to the scanned \nphotograph, and the pseudorandom generator seed is obtained \nfrom the secret key to find the locations of the coefficients \ncontaining the watermark. We define these coefficients as e:, \n. We extract the polarities of c: and denote polarity sequence \nas s:, . The extraction is performed by the correlation between \ns:, and w , ~  or W,O , \n(6) \nWT; and WT; measure the possibility that the embedded bit \nis 1 and 0, respectively. The decision rule of the watermark \nbit is given as follows. k denotes the extracted watermark bit. \nW T ;  = S r n G l  \nJ(s&s2)(wmowLo) \n1, if W T T ~  2 WT; \nk =  { 0, if m ~ ;  > CGTT; (7) \nFor detection, the detector does not require both the original \nimage and the watermark. Such watermarking schemes are \ncalled public watermarking schemes or blind watermarking \nschemes [lo]. \n1151 \nOriginal \nphoto \n(180x130) \nAAAAA1111 \nPrinted- \nscanned Watermarked Watermark photo photo \n(180x130) (215xlM)) \n888882222 \nccccc3333 \nVerification \nCleSlNo) \nYes \nYes \nYes \nFig. 6. Samples of experimental results.(The characters used here are not real identiry numbers.) \n111. EXPERIMENTAL RESULTS \nIn our experiments, we used a common laser printer (HP \nLaserJet 4MV) and scanner (CanoScan N1220U). with resolu- \ntions set to 170 dpi (dots per inch) and 200 dpi, respectively. \nFor subblocking the image, an 8x8 Hadamard transform was \nused. The watermark expansion length was set to 8, and \nTi in polarity modulation and Tz in amplitude modulation \nwere set to 0.3 and 1.5, respectively. A tradeoff between the \nrobusmess and image quality was determined in selecting TI  \nand Ts. These empirical values were obtained based on both \nthe acceptable image quality and robusmess against the PS \nprocess. We tested our authentication system for 105 different \nface photographs and the success rate was better than 96%. \nThe failures were mainly due to manual misalignment, because \nour algorithm was not so resistant to rotation and translation \nattacks. Some examples of the experimental results are listed \nin Fig. 6. \nIV. CONCLUSION \nWe proposed a card authentication system based on digital \nwatermarking. A linkage between the bearer's photograph and \nhisiher personal information is established through superim- \nposing the personal information directly into the photograph \nas a watermark. As such, photograph substitution frauds could \nbe prevented using this approach. The watermarking algorithm \nwas based on the polarity of Hadamard transform coefficients, \nthat could invisibly insert a 9-character watermark into smooth \nphotographs of size 180x130 pixels. This algorithm success- \nfully survived with a success rate achieved better than 96% for \n105 different face photographs. the print-and-scan process. The \nproposed system can be used to authenticate student cards, \npassports, driving licenses and other security documents or \ncards. \nREFERENCES \n[I] R. B. Wolfgang and E. I. Delp, \"Fragile watermarking using the VWZd \nwatermark\", Pmceeding of the SPlUISdrT Intemtioml Conference on \nSecurity and Wotemrking of Multimedia Contents, vol. 3657. pp. 204- \n213. Ian. 1999. \n[Z] 1. Hu, I. Huang, D. Huang and Y. Q. Shi. \"Image kagile watermarking \nbased an fusion of multi-resolution tamper detection,\" IJ?E Electronic \nLeuers,vol. 38, no. 24, pp 1512-1513, Nov. 2002. \n[3] D. Kundur and D. Hauinakas, \"Digital watermarking far telltale tamper- \nprwhng and authentication:' Pmceedings of the IEEE Special Isme on \nIdentificntion old Pmtection of Multimedin Infomtion, vol. 87, no. 7. \npp. li67-1180, July 1999. \n[4l C:Y. Lin. M. Wu. 1. A. Blwm, 1. I. Con, M. L. Miller, and Y M. Lui, \n\"Rotation, scale. and translation resilient watermarking for images,\" IEEE \nTms. I m g e  Pmcesring, vol. 10, no. 5. May 2001, pp. 767 -782. \n151 A. T. S. Ho, J. Shen, and S. H. Tan. \"Robust digital image-in-image \nwatermarkine alearithm usine the fast Hadamard transform:' SPIES 471h \nA n n u l  Mee&\"on Optical ?cience ond Technology, July 2002, Seattle, \nUSA. \n161 A. T. S. Ho, I. Shen, H. P. Tan, and 1. Wwn. \"Security-pnnting \nauthentication using digital watermarking,'' Electmnic Imoging. vol. 13, \n\"0.1, Jan. 2003. \n171 I. Mercer, Authenlicotion News, 5 (9\/10), 2001. \n181 C.-Y. Lin and S.-F. Chang, \"Distortion modeling and invariant extraction \nfor digital image print-and-scan process,\" Intl. Symp. on Multimedia \nlnfomrion Pmcessing, Taipei, Taiwan, Dee. 1999. \n[Y] F. Shu, A. T. S .  Ho and I. Shen, \"Digital Watermarking Techniques Using \nPolarity of Transform Coefficients:' Accepted by IASTED International \nConference on Signol and l m g e  Pmcessing,Aug. 2003. Honolulu, USA. \n[IO] S. Katzenbeisser and A. P. F. Petitcolas, Infomtion Hiding Techniques \nfor Sreganogrophy ond Digital Wotemrking, Artech HOUSC, 2wO. \n1152 \n"}