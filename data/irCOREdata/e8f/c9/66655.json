{"doi":"10.1007\/s00026-004-0229-z","coreId":"66655","oai":"oai:dro.dur.ac.uk.OAI2:613","identifiers":["oai:dro.dur.ac.uk.OAI2:613","10.1007\/s00026-004-0229-z"],"title":"On the computational complexity of the rooted subtree prune and regraft distance.","authors":["Bordewich,  M.","Semple,  C."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2005-01","abstract":"The graph-theoretic operation of rooted subtree prune and regraft is increasingly being used as a tool for understanding and modelling reticulation events in evolutionary biology. In this paper, we show that computing the rooted subtree prune and regraft distance between two rooted binary phylogenetic trees on the same label set is NP-hard. This resolves a longstanding open problem. Furthermore, we show that this distance is xed parameter tractable when parameterised by the distance between the two trees","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/66655.pdf","fullTextIdentifier":"http:\/\/dro.dur.ac.uk\/613\/1\/613.pdf","pdfHashValue":"410011f0453154e0defeb68f700d1c20f331a5d0","publisher":"Birkh\u00e4user Basel","rawRecordXml":"<record><header><identifier>\n  \n    \n      oai:dro.dur.ac.uk.OAI2:613<\/identifier><datestamp>\n      2011-06-15T15:51:03Z<\/datestamp><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        On the computational complexity of the rooted subtree prune and regraft distance.<\/dc:title><dc:creator>\n        Bordewich,  M.<\/dc:creator><dc:creator>\n        Semple,  C.<\/dc:creator><dc:description>\n        The graph-theoretic operation of rooted subtree prune and regraft is increasingly being used as a tool for understanding and modelling reticulation events in evolutionary biology. In this paper, we show that computing the rooted subtree prune and regraft distance between two rooted binary phylogenetic trees on the same label set is NP-hard. This resolves a longstanding open problem. Furthermore, we show that this distance is xed parameter tractable when parameterised by the distance between the two trees.<\/dc:description><dc:subject>\n        Rooted phylogenetic tree<\/dc:subject><dc:subject>\n         Rooted subtree prune<\/dc:subject><dc:subject>\n         Regraft.<\/dc:subject><dc:publisher>\n        Birkh\u00e4user Basel<\/dc:publisher><dc:source>\n        Annals of combinatorics, 2005, Vol.8(4), pp.409-423 [Peer Reviewed Journal]<\/dc:source><dc:date>\n        2005-01<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:identifier>\n        dro:613<\/dc:identifier><dc:identifier>\n        issn:0218-0006<\/dc:identifier><dc:identifier>\n        issn: 0219-3094<\/dc:identifier><dc:identifier>\n        doi:10.1007\/s00026-004-0229-z<\/dc:identifier><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/613\/<\/dc:identifier><dc:identifier>\n        http:\/\/dx.doi.org\/10.1007\/s00026-004-0229-z<\/dc:identifier><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/613\/1\/613.pdf<\/dc:identifier><dc:rights>\n        The original publication is available at www.springerlink.com\\ud\n<\/dc:rights><dc:accessRights>\n        info:en-repo\/semantics\/openAccess<\/dc:accessRights><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["issn: 0219-3094","0218-0006"," 0219-3094","issn:0218-0006"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2005,"topics":["Rooted phylogenetic tree","Rooted subtree prune","Regraft."],"subject":["Article","PeerReviewed"],"fullText":"Durham Research Online\nDeposited in DRO:\n13 October 2008\nVersion of attached file:\nAccepted Version\nPeer-review status of attached file:\nPeer-reviewed\nCitation for published item:\nBordewich, M. and Semple, C. (2005) \u2019On the computational complexity of the rooted subtree prune and\nregraft distance.\u2019, Annals of combinatorics., 8 (4). pp. 409-423.\nFurther information on publisher\u2019s website:\nhttp:\/\/dx.doi.org\/10.1007\/s00026-004-0229-z\nPublisher\u2019s copyright statement:\nThe original publication is available at www.springerlink.com\nAdditional information:\nUse policy\nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without prior permission or charge, for\npersonal research or study, educational, or not-for-profit purposes provided that:\n\u2022 a full bibliographic reference is made to the original source\n\u2022 a link is made to the metadata record in DRO\n\u2022 the full-text is not changed in any way\nThe full-text must not be sold in any format or medium without the formal permission of the copyright holders.\nPlease consult the full DRO policy for further details.\nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom\nTel : +44 (0)191 334 3042 \u2014 Fax : +44 (0)191 334 2971\nhttp:\/\/dro.dur.ac.uk\nON THE COMPUTATIONAL COMPLEXITY OF THE ROOTED\nSUBTREE PRUNE AND REGRAFT DISTANCE\nMAGNUS BORDEWICH AND CHARLES SEMPLE\nAbstract. The graph-theoretic operation of rooted subtree prune and regraft\nis increasingly being used as a tool for understanding and modelling reticu-\nlation events in evolutionary biology. In this paper, we show that computing\nthe rooted subtree prune and regraft distance between two rooted binary phy-\nlogenetic trees on the same label set is NP-hard. This resolves a longstanding\nopen problem. Furthermore, we show that this distance is fixed parameter\ntractable when parameterised by the distance between the two trees.\n1. Introduction\nIn evolutionary biology, it is becoming increasingly apparent that evolution is\nnot necessarily tree-like because of reticulation events such as hybridisations and\nhorizontal gene transfers. Consequently, the so-called \u201ctree of life\u201d is better repre-\nsented as an acyclic digraph in which there is exactly one vertex that has in-degree\nzero and where the vertices of out-degree zero represent the present-day species.\nOne of the main tools used to understand and model reticulation events is a\ngraph-theoretic operation called \u201crooted subtree prune and regraft\u201d. Loosely speak-\ning, this operation prunes a subtree of a rooted tree and then reattaches this subtree\nto another part of the tree. The use of this tool in evolutionary biology dates back\nto at least 1990 [7] and has been regularly recognised since as an appropriate way to\nunderstand and represent reticulate evolution (for example, see [2, 10, 12, 15]). The\nreason for this is that two evolutionary (phylogenetic) trees describing the ancestral\nhistory of different genes for the same set of species may be inconsistent. However,\nfor example, if this inconsistency can be resolved with a single hybridisation event,\nthen one tree can be obtained from the other by a single rooted subtree prune and\nregraft operation.\nAlthough reticulation events do occur in biology, they are still relatively rare\nand so a common problem is to find a representation of the available data which\nminimises the number of such events. This leads to the problem of computing\nthe minimum number of rooted subtree prune and regraft operations required to\nDate: 16 March 2004.\n1991 Mathematics Subject Classification. 05C05; 92D15.\nKey words and phrases. Rooted phylogenetic tree, Rooted subtree prune and regraft.\nThe first author was supported by the New Zealand Institute of Mathematics and its Appli-\ncations funded programme Phylogenetic Genomics and the second author was supported by the\nNew Zealand Marsden Fund (UOC310).\n1\n2 MAGNUS BORDEWICH AND CHARLES SEMPLE\n1 2 3 4 1 4 2 3\nT1 T2\nFigure 1. Two rooted binary phylogenetic trees.\ntransform one evolutionary tree into another. In the context of these operations,\nthis number is the \u201cdistance\u201d between the two trees. It appears that this problem\nwas first described in [7] and determining the complexity of computing this distance\nis stated as an open problem in several recent papers including [1, 12]. One of the\ntwo main results of this paper is to show that computing this distance is NP-hard.\nHowever, the other main result says that computing this distance is fixed parameter\ntractable when parameterised by the distance between the two trees. We describe\nthese two results formally next.\nA rooted binary phylogenetic X-tree is a rooted tree whose root has degree two\nand all other interior vertices have degree three, and whose leaf set is X . Let T be\na rooted binary phylogenetic X-tree and let e = {u, v} be an edge of T where u is\nthe vertex that is in the path from the root of T to v. Let T \u2032 be the rooted binary\nphylogenetic tree obtained from T by deleting e and then adjoining a new edge f\nbetween v and the component Cu that contains u in one of the following two ways:\n(i) Creating a new vertex u\u2032 which subdivides an edge in Cu, and adjoining f\nbetween u\u2032 and v. Then, either suppressing the degree-two vertex u or, if u\nis the root of T , deleting u and the edge incident with u, making the other\nend-vertex of this edge the new root.\n(ii) Creating a new root vertex u\u2032 and a new edge between u\u2032 and the original\nroot. Then adjoining f between u\u2032 and v and suppressing the degree-two\nvertex u.\nWe say that T \u2032 has been obtained from T by a single rooted subtree prune and\nregraft (rSPR) operation. We define the rSPR distance between two arbitrary rooted\nbinary phylogenetic X-trees T1 and T2, denoted drSPR(T1, T2), to be the minimum\nnumber of rooted subtree prune and regraft operations that is required to transform\nT1 into T2. It is well known that, for any such pair of trees, one can always obtain\none from the other by a sequence of single rSPR operations. Thus this distance is\nwell defined.\nIn the literature, it is sometimes unclear whether (ii) is allowed in the definition\nof an rSPR operation. However, if this is not part of the definition, then the rSPR\ndistance on the collection of all rooted binary phylogenetic X-trees is not a metric.\nTo see this, consider the two rooted binary phylogenetic trees shown in Fig. 1. It is\neasily checked that if we were to omit (ii) in the definition, then the rSPR distance\nto get from T1 to T2 is one, but the rSPR distance to get from T2 to T1 is two.\nROOTED SUBTREE PRUNE AND REGRAFT DISTANCE 3\nTheorem 1.1 is the first main result of this paper.\nTheorem 1.1. Computing the rSPR distance between an arbitrary pair of rooted\nbinary phylogenetic X-trees is NP-hard.\nTheorem 1.1 has an interesting past. It was first thought to be proved by Hein et\nal. [8]. However, Allen and Steel [1] showed that a crucial lemma (Lemma 6) in their\npaper is incorrect. Nevertheless, their result and, in particular, this lemma could\nbe recovered for a related tree operation called \u201ctree bisection and reconnection\u201d.\nThe crux in proving Theorem 1.1 is to show that the approach in [8] can still be\nused for the rSPR operation after modification of their main definition and re-proof\nof this particular lemma.\nThe second main result of this paper shows that despite Theorem 1.1 the problem\nof computing the rSPR distance between two rooted binary phylogenetic X-trees\nis fixed parameter tractable. In particular, we have the following theorem.\nTheorem 1.2. Computing the rSPR distance between an arbitrary pair of rooted bi-\nnary phylogenetic X-trees is fixed parameter tractable when parameterised by drSPR.\nThe proof of Theorem 1.2 closely follows the approach of Allen and Steel [1].\nThe paper is organised is as follows. The remainder of this section contains some\npreliminaries and some informative remarks. Section 2 contains the proof of The-\norem 1.1 and Section 3 contains the proof of Theorem 1.2. In Section 4 we present\nan application of our approach. The rooted subtree prune and regraft operation\nis one of several tree rearrangement operations that are used in phylogenetics, we\ndiscuss its connection with these operations in the last section. Unless otherwise\nstated, the notation and terminology in this paper follows [14].\nLet T be a rooted binary phylogenetic X-tree with root \u03c1. The set X is called\nthe label set of T and is denoted by L(T ). Now let V be a subset of the vertex\nset of T . We denote by T (V ) the minimal rooted subtree of T that connects the\nelements in V . Furthermore, the restriction of T to V is the rooted phylogenetic\ntree that is obtained from T (V ) by suppressing all non-root vertices of degree two.\nThis restriction is denoted by T |V .\nRooted subtree prune and regraft is one of several important tree rearrangement\noperations in phylogenetics that induce metrics on the space of rooted or unrooted\nbinary phylogeneticX-trees. In addition to the unrooted analogue of rooted subtree\nprune and regraft, two other types that have been extensively studied are nearest\nneighbour interchange (introduced independently in [11] and [13]) and tree bisection\nand reconnection. We describe these next.\nA binary phylogenetic X-tree is an unrooted tree whose interior vertices all have\ndegree three and whose leaf set is X . Let T be a binary phylogenetic X-tree and\nlet e = {u, v} be an edge of T . Let T \u2032 be the binary phylogenetic X-tree that is\nobtained from T by deleting e, and then attaching the component Cv that contains\nv to the component Cu that contains u by adjoining a new edge f from Cv to\n4 MAGNUS BORDEWICH AND CHARLES SEMPLE\nCu so that, once degree-two vertices are suppressed, the resulting tree is a binary\nphylogenetic X-tree. The tree rearrangement operations that we now describe are\nrestricted by how this new edge is adjoined. We begin with the least restrictive\noperation.\n(i) We say that T \u2032 has been obtained from T by a tree bisection and reconnec-\ntion (TBR) if there is no restriction on f .\n(ii) We say that T \u2032 has been obtained from T by an (unrooted) subtree prune\nand regraft (uSPR) if one end-vertex of f is v.\n(iii) We say that T \u2032 has been obtained from T by a nearest neighbour interchange\n(NNI) if one end-vertex of f is v and the other end-vertex subdivides an\nedge of Cu that is adjacent to an interior edge of T that is incident with v.\nAnalogous to rSPR, each \u0398 \u2208 {NNI, uSPR,TBR} induces a metric on the space of\nbinary phylogeneticX-trees. In particular, let T1 and T2 be two binary phylogenetic\nX-trees. The \u0398 distance between T1 and T2, denoted d\u0398(T1, T2), is the minimum\nnumber of \u0398 operations that is required to transform T1 into T2. Again, it is well\nknown that, for each \u0398, one can always get from T1 to T2 by such a sequence of\noperations.\nIt is known that computing the NNI and TBR distances between two binary\nphylogenetic X-trees is NP-hard ([4] and [1], respectively). In this paper, we show\nthat computing the rSPR distance between two rooted binary phylogenetic X-trees\nis also NP-hard. However, it remains an open problem to determine the complexity\nof computing the uSPR distance between two binary phylogenetic X-trees. Given\nthe result in this paper and the previous results, it seems very likely that this is\nalso NP-hard. Further discussion of these tree operations and their relationship to\nrSPR appears in the last section.\n2. NP-Completeness\nIn this section, we prove Theorem 1.1. We begin by revising the definition of\nmaximum-agreement forest of [8]. Let T and T \u2032 be two rooted binary phylogenetic\nX-trees. For the purposes of the definition, we regard the root of both T and T \u2032 as\na vertex \u03c1 at the end of a pendant edge adjoined to the original root. Furthermore,\nwe also regard \u03c1 as part of the label set of T and T \u2032 (see Fig. 2). An agreement\nforest for T and T \u2032 is a collection {T\u03c1, T1, T2, . . . , Tk}, where T\u03c1 is a rooted tree and\nT1, T2, . . . , Tk are rooted binary phylogenetic trees with label sets L\u03c1,L1,L2, . . . ,Lk\nsuch that the following properties are satisfied:\n(i) The label sets L\u03c1,L1, . . . ,Lk partition X \u222a {\u03c1} and, in particular, \u03c1 \u2208 L\u03c1.\n(ii) For all i \u2208 {\u03c1, 1, 2, . . . , k}, Ti \u223c= T |Li \u223c= T \u2032|Li.\n(iii) The trees in {T (Li) : i \u2208 {\u03c1, 1, 2, . . . , k}} and {T\n\u2032(Li) : i \u2208 {\u03c1, 1, 2, . . . , k}}\nare vertex-disjoint rooted subtrees of T and T \u2032, respectively.\nAmaximum-agreement forest for T and T \u2032 is an agreement forest {T\u03c1, T1, T2, . . . , Tk}\nin which k (the number of components minus one) is minimised. The minimum pos-\nsible value for k is denoted by m(T , T \u2032).\nROOTED SUBTREE PRUNE AND REGRAFT DISTANCE 5\n2 3 41 4321\n4321 4321\nT \u2032T\n\u03c1 \u03c1\nT \u2032T\nFigure 2. Two rooted binary phylogenetic trees T and T \u2032, pic-\ntured without (above) and with (below) their roots labelled.\n1 2 3 4 4321 4321\nF3F2\n\u03c1 \u03c1\nF1\nFigure 3. A maximum-agreement forest F1 for T and T \u2032 of Fig. 2\nunder the definition in [8], and two maximum-agreement forests F2\nand F3 for T and T \u2032 under our definition.\nWe remark here that the definition of maximum-agreement forest given in [8]\ndiffers by the fact that \u03c1 is not treated as part of the label set. Therefore, using\nthe original definition, a maximum-agreement forest for the two rooted binary phy-\nlogenetic trees T and T \u2032 shown in Fig. 2 consists of two components (for example,\nF1 in Fig. 3). However, for the definition given in this paper such a forest consists\nof three components (for example, F2 and F3 in Fig. 3). The crucial result in\nestablishing Theorem 1.1 is Theorem 2.1.\nTheorem 2.1. Let T and T \u2032 be two rooted binary phylogenetic X-trees. Then\ndrSPR(T , T \u2032) = m(T , T \u2032).\nProof. We first show that m(T , T \u2032) \u2264 drSPR(T , T \u2032). The proof of this inequality\nis by induction on drSPR(T , T\n\u2032). Assume that drSPR(T , T\n\u2032) = 1. Let {A \u222a {\u03c1}, B}\nbe the partition of X \u222a {\u03c1} induced by the \u201cpruning\u201d in an rSPR operation that\ntransforms T into T \u2032. Then it is easily seen that an agreement forest for T and T \u2032 is\n{T |(A\u222a{\u03c1}), T |B}. Therefore, in this case, m(T , T \u2032) \u2264 drSPR(T , T \u2032). Now assume\nthat the inequality holds for all rooted binary phylogenetic X-trees whose rSPR\ndistance is at most k. Suppose that drSPR(T , T \u2032) = k+1. Then there exists a rooted\nbinary phylogenetic X-tree T \u2032\u2032 such that drSPR(T , T \u2032\u2032) = k and drSPR(T \u2032\u2032, T \u2032) =\n1. By the inductive hypothesis, there is an agreement forest {T\u03c1, T1, T2, . . . , Tk}\nfor T and T \u2032\u2032, and an agreement forest {T \u2032\u03c1 , T\n\u2032\n1} for T\n\u2032\u2032 and T \u2032. The partition\n6 MAGNUS BORDEWICH AND CHARLES SEMPLE\n{L(T \u2032\u03c1),L(T\n\u2032\n1 )} identifies a unique edge in T\n\u2032\u2032. Hence there can be at most one\ni \u2208 {\u03c1, 1, 2, . . . , k} such that L(Ti)\u2229L(T \u2032\u03c1 ) 6= \u2205 and L(Ti)\u2229L(T\n\u2032\n1 ) 6= \u2205 (for otherwise,\nthe induced subtrees in T \u2032\u2032 would not be disjoint, and {T\u03c1, T1, T2, . . . , Tk} would\nnot be an agreement forest for T and T \u2032\u2032). If there is no such i \u2208 {\u03c1, 1, 2, . . . , k},\nthen {T\u03c1, T1, T2, . . . , Tk} is an agreement forest for T and T \u2032. On the other hand,\nif there exists an i \u2208 {\u03c1, 1, 2, . . . , k} such that L(Ti) \u2229 L(T \u2032\u03c1 ) = Li,\u03c1 6= \u2205 and\nL(Ti)\u2229L(T\n\u2032\n1 ) = Li,1 6= \u2205, then {Tj : j \u2208 {\u03c1, 1, . . . , k}\u2212{i}}\u222a{Ti|Li,\u03c1, Ti|Li,1} is an\nagreement forest for T and T \u2032. In either case, we have m(T , T \u2032) \u2264 drSPR(T , T \u2032).\nWe complete the proof by showing that drSPR(T , T \u2032) \u2264 m(T , T \u2032). We do this\nusing induction on m(T , T \u2032). First assume that m(T , T \u2032) = 1. Let {T\u03c1, T1} be an\nagreement forest for T and T \u2032. Then the rSPR operation which prunes the subtree\nT |L(T1) from T , and regrafts this subtree in the correct place for T \u2032 demonstrates\nthat drSPR(T , T \u2032) \u2264 m(T , T \u2032). Thus the inequality holds for m(T , T \u2032) = 1. Now\nassume the inequality holds for all pairs of rooted binary phylogenetic X-trees\nfor which there is an agreement forest of at most k + 1 components. Suppose\nthat m(T , T \u2032) = k + 1. Let {T\u03c1, T1, T2, . . . , Tk+1} be an agreement forest for T\nand T \u2032. Then there exists some i \u2208 {1, 2, . . . , k + 1} such that Ti can be pruned\nfrom the rest of T by deleting a single edge. Consider the path in T \u2032 from the\nroot of Ti to \u03c1. Let v be the first vertex on this path such that v \u2208 Tj for some\nj \u2208 {\u03c1, 1, 2, . . . , k+1}\u2212{i}. Because of (iii) in the definition of an agreement forest,\nv identifies a unique such Tj . Let Li,j = L(Ti)\u222aL(Tj). Let T \u2032\u2032 be the tree obtained\nfrom T by pruning Ti, and regrafting this subtree so that T \u2032\u2032|Li,j \u223c= T \u2032|Li,j . Now\n{Tl : l \u2208 {\u03c1, 1, . . . , k+1}\u2212{i, j}}\u222a{T \u2032\u2032|Li,j} is an agreement forest for T \u2032\u2032 and T \u2032.\nHence, by the inductive hypothesis, drSPR(T \u2032\u2032, T \u2032) \u2264 k and, since drSPR(T , T \u2032\u2032) = 1,\nwe have drSPR(T , T \u2032) \u2264 k + 1 = m(T , T \u2032). \u0003\nWith the revised definition of agreement forest and Theorem 2.1, the reduction\nof Theorem 8 in [8] can be applied to show that determining the rSPR distance\nbetween two rooted binary phylogenetic X-trees is NP-hard. To be precise, we\ndefine the decision problem rSPR as follows.\nProblem: rSPR\nInstance: Two rooted binary phylogenetic X-trees T and T \u2032, and an integer k.\nQuestion: Is drSPR(T , T\n\u2032) \u2264 k?\nTheorem 1.1 is an immediate consequence of Corollary 2.2.\nCorollary 2.2. The decision problem rSPR is NP-complete.\nProof. The reduction used in the proof of Theorem 8 in [8] can be applied using\nthe revised definition of maximum-agreement forest given above. This reduction\nis from \u201cExact Cover by 3-Sets (X3C)\u201d, see [6]. We note here that the proof of\nTheorem 8 in [8] can be more easily established if each pair of labels of the type xi\nand xi+1, or yj and yj+1 is replaced by a \u2018string\u2019 of 7n labels. \u0003\nROOTED SUBTREE PRUNE AND REGRAFT DISTANCE 7\n3. Fixed Parameter Tractability\nIn the previous section, we showed that computing the rSPR distance between\ntwo rooted binary phylogenetic X-trees is NP-hard. In spite of this, we now show\nthat this problem is fixed parameter tractable, where we consider the rSPR distance\nitself to be the parameter. The idea behind fixed parameter complexity is that while\nthe general case of computing rSPR distance is NP-hard, the cases in which one is\ngenerally interested, namely those in which the rSPR distance is small, may not be\ncomputationally infeasible. For example, we may be interested in comparing two\nevolutionary trees on a large number of species (> 1000) to determine how many\nhybridisation events must have occurred in order for the two trees to be consistent.\nSince hybridisation events are relatively rare, we would expect this number and,\nin particular, the rSPR distance between the two trees to be low (< 20). We\nshow in this section that compared to the naive approach to computing the rSPR\ndistance which takes time O((2n)2k), the parameterised rSPR distance between two\nrooted binary phylogenetic X-trees may be computed in time O(f(k)p(n)), where\nn = |X |, k is the rSPR distance, f is some computable function, and p is a fixed\npolynomial. The importance of this result is in the separation of the variables n\nand k; it shows that, for a reasonable range of k, it may be possible to efficiently\ncompute the rSPR distance even for trees with a very large leaf set. For further\ndetails on fixed parameter tractability, we refer the reader to [5]. It should be noted\nthat while we have made the important theoretical step of establishing that rSPR is\nfixed parameter tractable, we have made no particular attempt to find the smallest\nfunction f(k) possible.\nWe remark here that the authors of [4] and [1] have previously shown that\ncomputing the NNI and TBR distances between a pair of binary phylogenetic X-\ntrees are fixed parameter tractable in their associated distances. It appears that\nthe analogous result for uSPR is still open. The approach we take to establish the\nresult for rSPR follows [1].\nIt is shown in [1] that two tree reduction rules could be used to reduce the size\nof the label set of a pair of (unrooted) binary phylogenetic X-trees while preserving\nthe TBR distance between them. This process was shown to reduce any such pair\nof trees of TBR distance at most k apart to a new pair the same distance apart but\non a label set of size linear in k. The tree reduction rules proposed were as follows.\nRule 1: Replace any pendant subtree that occurs identically in both trees by\na single leaf with a new label.\nRule 2: Replace any chain of pendant subtrees that occurs identically in both\ntrees by three new leaves with new labels correctly orientated to preserve\nthe direction of the chain.\nIt is stated in [1] that Rule 1 preserves uSPR distance, and conjectured that\nRule 2 also preserves uSPR distance. While this conjecture remains open, it is\neasily seen that rSPR distance is not preserved by the rooted analogue of Rule 2.\nTo see this, let T1 and T2 be the two rooted binary phylogenetic trees shown in\n8 MAGNUS BORDEWICH AND CHARLES SEMPLE\nr\n\u03c1\n3\n2\n1\nnT2 n\u2212 1\nn\u2212 1\n3\nT11\nn\n2\n\u03c1\nr\nFigure 4. Two rooted binary phylogenetic trees.\nFig. 4, and let T \u20321 and T\n\u2032\n2 be the binary phylogenetic trees obtained from T1 and\nT2, respectively, by adjoining a new leaf r to the root and viewing the resulting\ntree as unrooted (see Fig. 4, dotted lines). Although we can obtain T \u20322 from T\n\u2032\n1 in a\nsingle uSPR operation by pruning r and regrafting it to the edge adjacent to 1, in\nthe rooted setting this is not possible. By considering agreement forests, it is easy\nto see that, for n even, at least n\/2 rSPR operations are needed to transform T1\ninto T2. This minimum n\/2 can be achieved by taking each adjacent pair 2i\u2212 1, 2i\n(i = 1 . . . n\/2) and the root to be the label sets of the n\/2 + 1 components of the\nagreement forest.\nAlthough Rule 2 does not preserve rSPR distance in the rooted setting, we will\nsoon see that, together with Rule 1, the following modified version of Rule 2 does\npreserve rSPR distance.\nRule 2*: Replace any chain of pendant subtrees that occurs identically and\nwith the same orientation relative to the root in both trees by three new\nleaves with new labels correctly orientated to preserve the direction of the\nchain.\nRules 1 and 2* are illustrated in Figs. 5 and 6, respectively.\nA rooted abc-tree is a rooted binary phylogenetic tree T whose label set includes\nthe leaves a, b, c and has the following property. If va, vb, vc are the vertices adjacent\nto the leaves a, b, c, respectively, then {vb, c} are the two descendant neighbours of\nvc and {va, b} are the two descendant neighbours of vb in T . For example, T \u20321 and\nT \u20322 in Fig. 6 are rooted abc-trees.\nThe next lemma shows that if T and T \u2032 are both abc-trees on the same label\nset, then there is a maximum-agreement forest in which a, b, and c are in the same\ncomponent. Intuitively, this means there is a sequence of rSPR operations from T\nto T \u2032 which does not break up the common section containing a, b, and c. Once this\nlemma is established, it will then follow by a result analogous to Theorem 3.4 of [1]\nthat an arbitrarily large number of additional pendant subtrees could be added to\nthe path between va and vc in both T and T \u2032 without changing the rSPR distance\nbetween them.\nROOTED SUBTREE PRUNE AND REGRAFT DISTANCE 9\nA\na a\nT \u20321 T\n\u2032\n2\n\u03c1 \u03c1\n\u03c1\u03c1\nT1 T2\nA\nFigure 5. Two rooted binary phylogenetic trees reduced under Rule 1.\nAn\nA1\nA2\nA3\nA1\nA2\nA3\nAn\n\u03c1 \u03c1\nc\nb\na\nT \u20322\nc\nb\na\nT \u20321\n\u03c1 \u03c1\nT2T1\nFigure 6. Two rooted binary phylogenetic trees reduced under\nRule 2*.\nLemma 3.1. If T and T \u2032 are two rooted abc-trees on the same label set, then\nthere is a maximum-agreement forest {T\u03c1, T1, T2, . . . , Tk} for T and T \u2032 such that\na, b, c \u2208 L(Ti), for some i \u2208 {\u03c1, 1, 2, . . . , k}.\nProof. Let {T\u03c1, T1, T2, . . . , Tk} be a maximum-agreement forest for T and T \u2032. If\nthere is some i \u2208 {\u03c1, 1, 2, . . . , k} such that a, b, c \u2208 L(Ti), then we are done. Oth-\nerwise, let La be the set of descendant leaves of va in T , not including a. Let Lc\nbe the set of leaves that are not descendants of vc in T . Similarly, let L\u2032a be the\nset of descendant leaves of va in T \u2032, not including a, and let L\u2032c be the set of leaves\nthat are not descendants of vc in T\n\u2032. If there is such an i, let i \u2208 {\u03c1, 1, 2, . . . , k}\n10 MAGNUS BORDEWICH AND CHARLES SEMPLE\nbe such that both L(Ti) \u2229 La = Li,a 6= \u2205 and L(Ti) \u2229 Lc = Li,c 6= \u2205. Lastly, if\nthere is such a j, let j \u2208 {\u03c1, 1, 2, . . . , k} such that both L(Tj) \u2229 L\u2032a = L\n\u2032\nj,a 6= \u2205 and\nL(Tj) \u2229 L\u2032c = L\n\u2032\nj,c 6= \u2205. There are six cases to consider:\n(i) no such i and no such j exist,\n(ii) \u2203 i and no such j exists,\n(iii) \u2203 j and no such i exists,\n(iv) \u2203 i, j and i 6= j,\n(v) \u2203 i, j such that i = j and Li,a \u2229 L\u2032i,a = \u2205, and\n(vi) \u2203 i, j such that i = j and Li,a \u2229 L\u2032i,a 6= \u2205.\nIn each of these cases, we show that there is an agreement forest in which a, b, and\nc are in the same component, and this forest uses at most k + 1 components.\nIn case (i), either one of the leaves x \u2208 {a, b, c} is isolated in the agreement\nforest, or there is some r and some s \u2208 {\u03c1, 1, 2, . . . , k} such that a \u2208 L(Tr) and\nc \u2208 L(Ts) (and b is either in L(Tr) or L(Ts)). In the case that x is isolated, we\nmay form an agreement forest of the same size (or smaller if more than one of a, b, c\nis isolated) by removing a, b and c from their respective trees and creating a new\ntree T |{a, b, c}. In the case that there is no isolated leaf, we may form a smaller\nagreement forest by replacing Tr and Ts by T |(L(Tr) \u222a L(Ts)).\nIn cases (ii)-(vi), a, b and cmust appear as isolated vertices in {T\u03c1, T1, T2, . . . , Tk}.\nOtherwise, if x \u2208 {a, b, c} is in L(Ti) say, then we may form an agreement forest\nof smaller size by replacing Ti and a, b, and c by T |(L(Ti) \u222a {a, b, c}). It is in-\ncorrectly claimed in [1] that, in their setting, if i exists and a, b, and c appear\nas isolated vertices, it is always possible to construct a smaller agreement forest\nthereby contradicting the maximality of {T\u03c1, T1, T2, . . . , Tk}. However, this is not\nalways possible. Nevertheless, for each of the cases (ii)-(vi), there is an agreement\nforest of at most the same size in which a, b, and c are in the same component. In\nparticular, such an agreement forest can be achieved by the following replacements:\n(ii) Replace Ti and a, b, and c by Ti|Li,a, Ti|Li,c, and T |{a, b, c}.\n(iii) Replace Tj and a, b, and c by Tj |L\u2032j,a, Tj |L\n\u2032\nj,c, and T |{a, b, c}.\n(iv) Replace Ti, Tj , and a, b, and c by Ti|Li,a, Ti|Li,c, Tj |L\u2032j,a, Tj |L\n\u2032\nj,c, and\nT |{a, b, c}.\n(v) Replace Ti and a, b, and c by Ti|Li,a, Ti|L\u2032i,a, Ti|(Li,c\u2229L\n\u2032\ni,c), and T |{a, b, c}.\n(vi) Replace Ti and a, b, and c by Ti|(Li,a\u2229L\u2032i,a), Ti|((Li,a\u222aL\n\u2032\ni,a))\u2212(Li,a\u2229L\n\u2032\ni,a)),\nTi|(Li,c \u2229 L\u2032i,c), and T |{a, b, c}.\nIt is easily checked that these are indeed agreement forests for T and T \u2032, and hence\nthere exists a maximum-agreement forest in which a, b and c appear in the same\ncomponent. \u0003\nProposition 3.2. Let T1 and T2 be two rooted binary phylogenetic X-trees. Let T\n\u2032\n1\nand T \u20322 be rooted binary phylogenetic X\n\u2032-trees obtained from T1 and T2, respectively,\nby applying either Rule 1 or Rule 2*. Then drSPR(T1, T2) = drSPR(T \u20321 , T\n\u2032\n2 ).\nROOTED SUBTREE PRUNE AND REGRAFT DISTANCE 11\nProof. The statement of this proposition is analogous to Theorem 3.4 in [1] which\napplies to Rule 1, Rule 2, and the TBR distance in the unrooted setting. The proof\nof the latter can be applied to the proof of this proposition using the definitions\nof rooted maximum-agreement forest and rSPR operation given in this paper, and\nLemma 3.1. \u0003\nWe need one further lemma before we can tackle the main result of this section.\nProposition 3.2 says that the tree reduction Rules 1 and 2* preserve rSPR distance;\nwe now show that they can be repeatedly applied until the label set of the resulting\nrooted binary phylogenetic trees has size linear in the rSPR distance between them.\nLemma 3.3. Let T1 and T2 be two rooted binary phylogenetic X-trees. Let T \u20321 and\nT \u20322 be rooted binary phylogenetic X\n\u2032-trees obtained from T1 and T2, respectively,\nby applying Rules 1 and 2* repeatedly until no further reduction is possible. Then\n|X \u2032| \u2264 28drSPR(T1, T2).\nProof. By Theorem 2.1, T \u20321 and T\n\u2032\n2 have a maximum-agreement forest S\u03c1,S1, . . . ,Sk\nwhere k = drSPR(T \u20321 , T\n\u2032\n2 ). For j = 1, 2 and i = \u03c1, 1, 2, . . . , k, let nj(i) denote the\nnumber of edges in T \u2032j which are incident with the subtree T\n\u2032\nj (L(Si)) if i 6= \u03c1\nand let nj(i) denote one more than the number of edges incident with T \u2032j (L(S\u03c1))\nif i = \u03c1. Then it follows from Lemma 3.7 of [1] that |L(Si)| \u2264 7(n1(i) + n2(i))\nby simply substituting the rooted definition of maximum-agreement forest into its\nproof. By Lemma 3.6 of [1] we have \u03a3i\u2208{\u03c1,1,...,k}(n1(i)+n2(i)) \u2264 4k, and so |X\n\u2032| =\n\u03a3i\u2208{\u03c1,1,...,k}|L(Si)| \u2264 28k. By Proposition 3.2, drSPR(T\n\u2032\n1 , T\n\u2032\n2 ) = drSPR(T1, T2), and\nthe result follows. \u0003\nWe are now in a position to show that determining rSPR distance is fixed pa-\nrameter tractable. Again, we formally deal with the decision problem.\nTheorem 3.4. The decision problem rSPR, parameterised by drSPR, is fixed pa-\nrameter tractable.\nProof. Let T1 and T2 be two rooted binary phylogenetic X-trees, and let k be\nan integer. Let drSPR(T1, T2) = d. It follows by Lemma 3.1 of [1] that a pair\nof rooted binary phylogenetic X \u2032-trees T \u20321 and T\n\u2032\n2 , obtained by applying Rules 1\nand 2* repeatedly until no further reduction is possible, can be found in time\npolynomial in |X | (p(|X |) say). By Lemma 3.3, |X \u2032| \u2264 28d. If |X \u2032| \u2265 28k, we\ndeclare drSPR(T1, T2) > k.\nFor a given rooted binary phylogenetic X-tree, there are 2|X |\u22122 edges that may\nbe cut and at most 2|X | \u2212 5 to which a subtree may be regrafted to obtain a new\nrooted binary phylogenetic X-tree. Hence, for any such tree, there is at most 4|X |2\npossible single rSPR operations. Therefore we can examine all possible paths from\nT \u20321 of length k in time O((4|X\n\u2032|2)k) = O((56k)2k). If one of these paths contains\nT \u20322 , we declare drSPR(T1, T2) \u2264 k, otherwise we declare drSPR(T1, T2) > k. Hence\nwe can answer the rSPR decision problem for T1 and T2 in time O(f(k)p(|X |)),\nwhere f(k) is the computable function (56k)2k and p(|X |) is the polynomial bound\n12 MAGNUS BORDEWICH AND CHARLES SEMPLE\nfor reducing the trees using Rules 1 and 2*. This satisfies the conditions for the\ndecision problem rSPR to be fixed parameter tractable. \u0003\nTheorem 1.2 follows immediately from Theorem 3.4.\n4. An Application of Maximum-Agreement Forests\nIn this section we highlight a useful application of Theorem 2.1. The main\nresult of this section, Theorem 4.1, is motivated by a question posed by Baroni and\nSteel [3].\nA cluster C of a rooted binary phylogenetic X-tree T is a subset of X such that\nC is the set of label descendants of some vertex of T . Confronted with finding\nthe rSPR distance between two rooted binary phylogenetic X-trees, Theorem 4.1\nsays that one can \u201calmost\u201d break the problem into parts by considering common\nclusters between the two trees. Unfortunately, the theorem does not give an equality\nin doing this, but if one is only interested in a fast method that provides a good\napproximation, then this appears to be a reasonable approach.\nTheorem 4.1. Let T and T \u2032 be two rooted binary phylogenetic X-trees, and sup-\npose that there is a cluster C common to T and T \u2032. Let C = X \u2212 C. Then\ndrSPR(T , T\n\u2032)\u2212 1 \u2264 drSPR(T |C, T\n\u2032|C) + drSPR(T |C, T\n\u2032|C) \u2264 drSPR(T , T\n\u2032)\nProof. For the first inequality, let FC = {TC,\u03c1, TC,1, . . . , TC,k} be a maximum-\nagreement forest for T |C and T \u2032|C, and FC be a maximum-agreement forest for\nT |C and T \u2032|C. Then FT = {TC,\u03c1|C, TC,1, . . . , TC,k} \u222a FC is an agreement forest of\nT and T \u2032. Taking into consideration that TC,\u03c1 may just contain \u03c1, we get\ndrSPR(T |C, T\n\u2032|C) + drSPR(T |C, T\n\u2032|C) = |FC | \u2212 1 + |FC | \u2212 1\n\u2265 |FT | \u2212 1\u2212 1\n\u2265 drSPR(T , T\n\u2032)\u2212 1.\nFor the second inequality, consider a maximum-agreement forest FT for T and\nT \u2032. There are two cases to consider:\n(i) there exists Ti \u2208 FT such that L(Ti)\u2229C 6= \u2205 and L(Ti)\u2229 (C \u222a {\u03c1}) 6= \u2205, or\n(ii) for all Ti \u2208 FT , either L(Ti) \u2286 C or L(Ti) \u2286 (C \u222a {\u03c1}).\nIn case (i), let Ti,C be the tree obtained from Ti|(C \u222ax) by relabelling x as \u03c1, where\nx \u2208 L(Ti)\u2229(C\u222a{\u03c1}). Then FC = {Tj \u2208 FT : L(Tj) \u2286 C)}\u222a{Ti,C} is an agreement\nforest for T |C and T \u2032|C. Also FC = {Tj \u2208 FT : L(Tj) \u2286 C \u222a {\u03c1}}\u222a {Ti|(C \u222a {\u03c1})}\nROOTED SUBTREE PRUNE AND REGRAFT DISTANCE 13\nis an agreement forest for T |C and T \u2032|C. Hence\ndrSPR(T , T\n\u2032) = |FT | \u2212 1\n= |FC |+ |FC | \u2212 1\u2212 1\n\u2265 drSPR(T |C, T\n\u2032|C) + drSPR(T |C, T\n\u2032|C).\nIn case (ii), FC = {Ti \u2208 FT : L(Ti) \u2286 C} \u222a {\u03c1} is an agreement forest for TC . Also\nFC = {Ti \u2208 FT : L(Ti) \u2286 C \u222a {\u03c1}} is an agreement forest for TC . Again\ndrSPR(T , T\n\u2032) = |FT | \u2212 1\n= |FC |+ |FC | \u2212 1\u2212 1\n\u2265 drSPR(T |C, T\n\u2032|C) + drSPR(T |C, T\n\u2032|C),\nand hence the second inequality holds. This completes the proof of the theorem. \u0003\nWe remark here that, for the NNI operation, it is shown in [9] that an analogous\nresult to Theorem 4.1 is not possible: for any constant c, rooted binary phylogenetic\nX-trees T and T \u2032 can be constructed such that for some C \u2286 X we have\ndNNI(T , T\n\u2032) \u2264 dNNI(T |C, T\n\u2032|C) + dNNI(T |C, T\n\u2032|C)\u2212 c.\nAlso note that either of the inequalities in Theorem 4.1 can be tight: if T = T \u2032,\nthen for any cluster the second inequality is tight; if T \u2032 can be obtained from T\nby a single rSPR operation, then if C is the set of leaves in the pruned subtree the\nfirst inequality is tight.\n5. Relating Distance Metrics on Phylogenetic Trees\nIn the last part of the introduction, we described three tree rearrangement oper-\nations associated with unrooted trees, namely, NNI, uSPR, and TBR. In addition\nto these operations for unrooted trees, each of NNI, uSPR, and TBR have rooted\nanalogues. In the case of uSPR, we have already closely looked at its analogue. The\nrooted analogues of NNI and TBR applied to a rooted binary phylogenetic tree T\nare defined in the obvious way noting that the root of T can never be part of the\npruned subtree.\nFor these tree rearrangement operations, it has been common practice to regard\nthe unrooted and rooted cases as the same. However, while this is reasonable for\nNNI and TBR, it is not valid for SPR. The intuitive reason for this is that any single\nNNI operation performed in the unrooted (resp. rooted) setting can be performed\nwith a single NNI operation in the rooted (resp. unrooted) setting. This also holds\nfor TBR. As we have seen, this is not the case for SPR; a single operation in the\nunrooted setting in which the \u201croot\u201d itself is part of the pruned subtree cannot be\nperformed by a single operation valid in the rooted setting. More precisely, we have\nthe following proposition which compares the six operations.\nProposition 5.1. Let T1 and T2 be two rooted binary phylogenetic X-trees. Let T \u20321\nand T \u20322 be the (unrooted) binary phylogenetic (X\u222a{r})-trees obtained by attaching a\npendant leaf r to the root of T1 and T2, respectively, and then regarding the resulting\ntrees as unrooted. Then\n14 MAGNUS BORDEWICH AND CHARLES SEMPLE\n1 3\n2\n1 2\n3\n4\nT1\n5\n6\n7 8\n5 4\nfe\n86\n7\nT2\n\u03c1 \u03c1\nr r\nFigure 7. The distances between T1 and T2 differ for each metric.\n(i) dNNI(T1, T2) = dNNI(T \u20321 , T\n\u2032\n2 ).\n(ii) dTBR(T1, T2) = dTBR(T \u20321 , T\n\u2032\n2 ).\n(iii) dTBR(T \u20321 , T\n\u2032\n2 ) \u2264 duSPR(T\n\u2032\n1 , T\n\u2032\n2 ) \u2264 drSPR(T1, T2) \u2264 dNNI(T\n\u2032\n1 , T\n\u2032\n2 ).\nMoreover, each of the inequalities in (iii) can be strict.\nProof. Part (i) can be checked in the following way. First consider an arbitrary\nunrooted NNI operation applied to T \u20321 . If r is in the pruned subtree, there is\nanother single NNI operation which does not have r in the pruned subtree and has\nthe same result. Viewing the resulting tree as rooted, it is easily seen that this tree\ncan therefore be obtained from T1 by a single rooted NNI operation. Furthermore,\nthe analogous result for first applying an arbitrary rooted NNI operation to T1 also\nholds. Part (i) now follows.\nPart (ii) can be obtained in the same way as Part (i).\nBy parts (i) and (ii), and the definitions of TBR, uSPR, and NNI, to prove\n(iii) it suffices to show that duSPR(T \u20321 , T\n\u2032\n2 ) \u2264 drSPR(T1, T2). Consider a single rSPR\noperation applied to T1. It is easily checked that the resulting tree viewed as an\nunrooted tree can be obtained from T \u20321 by a single uSPR operation. Part (iii) now\nfollows.\nLastly, it is not difficult to construct examples that show that each of the in-\nequalities in (iii) can be strict (see Example 5.2). \u0003\nWe end this section with an informative example.\nExample 5.2. Consider Fig. 7. Viewing the two trees in this figure as their name-\nsakes in the statement of Proposition 5.1, we show here that the inequalities in (iii)\ncan all be strict simultaneously.\nUsing an exhaustive search, one can show dTBR(T \u20321 , T\n\u2032\n2 ) = 2, duSPR(T\n\u2032\n1 , T\n\u2032\n2 ) = 3,\ndrSPR(T1, T2) = 4, and dNNI(T \u20321 , T\n\u2032\n2 ) = 5. Furthermore, these values can be obtained\nas follows. For TBR, delete edges e and f , and reconnect the tree appropriately.\nFor uSPR, first prune the subtree with leaves 1, 2, and 3, and regraft to the edge\nadjacent to 7, and then prune the subtree with leaves 4, 5, and r, and regraft to the\nROOTED SUBTREE PRUNE AND REGRAFT DISTANCE 15\nedge adjacent to 2. Lastly, prune the subtree with leaves 6, 7, and 8, and regraft to\nthe edge adjacent to 4. For rSPR, we view the two trees as rooted and without the\npendant edge with end-vertex r. In this case, prune 2 and regraft it to e, prune 7\nand regraft it to f , and then prune 4 and 5 and swap their locations in two rSPR\noperations. Lastly, for NNI, follow the rSPR operations, but swapping 4 and 5 now\nrequires three NNI operations.\nReferences\n[1] B. L. Allen and M. Steel, Subtree transfer operations and their induced metrics on evolution-\nary trees, Ann. Comb. 5 (2001) 1-13.\n[2] M. Baroni, C. Semple, and M. Steel, A framework for representing reticulate evolution, Ann.\nComb., in press.\n[3] M. Baroni and M. Steel, Private communication.\n[4] B. DasGupta, X. He, T. Jiang, M. Li, J. Tromp, and L. Zhang, On distances between phyloge-\nnetic trees, in: Proceedings of the 8th Annual ACM-SIAM Symposium on Discrete Algorithms\n(SODA), 1997, pp. 427-436.\n[5] R. Downey, M. Fellows, Parameterized Complexity (Monographs in Computer Science),\nSpringer Verlag, 1998.\n[6] M. Garey, D. Johnson, Computers and Intractability: A Guide to the Theory of NP-\nCompleteness, Freeman, San Francisco, 1979.\n[7] J. Hein, Reconstructing evolution of sequences subject to recombination using parsimony,\nMath. Biosci. 98 (1990) 185-200.\n[8] J. Hein, T. Jing, L. Wang, K. Zhang, On the complexity of comparing evolutionary trees,\nDiscrete Appl. Math. 71 (1996) 153-169.\n[9] M. Li, J. Tromp, and L. Zhang, On the nearest neighbour interchange distance between\nevolutionary trees, J. Theor. Biol. 182 (1996) 463-467.\n[10] W. Maddison, Gene trees in species trees, Syst. Biol. 46 (1997) 523-536.\n[11] G. W. Moore, M. Goodman and J. Barnabas, An iterative approach from the standpoint of\nthe additive hypothesis to the dendrogram problem posted by molecular data sets, J. Theor.\nBiol. 38 (1973) 423-457.\n[12] L. Nakhleh, T. Warnow, and C. Randal Linder, Reconstructing reticulate evolution in species\n- theory and practice, in: Proceedings of the 8th Annual International Conference on Research\nin Computational Molecular Biology (RECOMB), 2004, pp. 337-346.\n[13] D. Robinson, Comparison of labelled trees with valency three, J. Combin. Theory 11 (1971)\n105-119.\n[14] C. Semple and M. Steel, Phylogenetics, Oxford University Press, 2003.\n[15] Y. Song and J. Hein, Parsimonious reconstruction of sequence evolution and haplotyde blocks:\nfinding the minimum number of recombination events, in: Algorithms in Bioinformatics\n(WABI), G. Benson and R. Page, Eds., Lecture Notes in Bioinformatics, vol. 2812, 2003,\npp. 287-302.\nBiomathematics Research Centre, Department of Mathematics and Statistics, Uni-\nversity of Canterbury, Christchurch, New Zealand\nE-mail address: m.bordewich@math.canterbury.ac.nz, c.semple@math.canterbury.ac.nz\n"}