{"doi":"10.1353\/ajm.2006.0032","coreId":"65778","oai":"oai:dro.dur.ac.uk.OAI2:4815","identifiers":["oai:dro.dur.ac.uk.OAI2:4815","10.1353\/ajm.2006.0032"],"title":"Cycles with local coefficients for orthogonal groups and vector-valued Siegel modular forms.","authors":["Funke,  J.","Millson,  J."],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2006-08-01","abstract":"The purpose of this paper is to generalize the relation between intersection numbers of cycles in locally symmetric spaces of orthogonal type and Fourier coefficients of Siegel modular forms to the case where the cycles have local coefficients. Now the correspondence will involve vector-valued Siegel modular forms","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/65778.pdf","fullTextIdentifier":"http:\/\/dro.dur.ac.uk\/4815\/1\/4815.pdf","pdfHashValue":"0a168bb2040fc74a1ad4c12369f1d271a711b04d","publisher":"Johns Hopkins University Press","rawRecordXml":"<record><header><identifier>\n  \n    \n      oai:dro.dur.ac.uk.OAI2:4815<\/identifier><datestamp>\n      2014-05-06T13:42:17Z<\/datestamp><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        Cycles with local coefficients for orthogonal groups and vector-valued Siegel modular forms.<\/dc:title><dc:creator>\n         Funke,  J.<\/dc:creator><dc:creator>\n        Millson,  J.<\/dc:creator><dc:description>\n        The purpose of this paper is to generalize the relation between intersection numbers of cycles in locally symmetric spaces of orthogonal type and Fourier coefficients of Siegel modular forms to the case where the cycles have local coefficients. Now the correspondence will involve vector-valued Siegel modular forms.<\/dc:description><dc:publisher>\n        Johns Hopkins University Press<\/dc:publisher><dc:source>\n        American journal of mathematics, 2006, Vol.128(4), pp.899-948 [Peer Reviewed Journal]<\/dc:source><dc:date>\n        2006-08-01<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:identifier>\n        dro:4815<\/dc:identifier><dc:identifier>\n        issn:0002-9327<\/dc:identifier><dc:identifier>\n        issn: 1080-6377<\/dc:identifier><dc:identifier>\n        doi:10.1353\/ajm.2006.0032<\/dc:identifier><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/4815\/<\/dc:identifier><dc:identifier>\n        http:\/\/dx.doi.org\/10.1353\/ajm.2006.0032<\/dc:identifier><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/dro.dur.ac.uk\/4815\/1\/4815.pdf<\/dc:identifier><dc:rights>\n        Copyright \u00a9 2006 The Johns Hopkins University Press. This article first appeared in American Journal of Mathematics, Volume 128, Number 4, August 2006, pp. 899-948.<\/dc:rights><dc:accessRights>\n        info:en-repo\/semantics\/openAccess<\/dc:accessRights><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["issn: 1080-6377","0002-9327"," 1080-6377","issn:0002-9327"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2006,"topics":[],"subject":["Article","PeerReviewed"],"fullText":"Durham Research Online\nDeposited in DRO:\n06 May 2014\nVersion of attached file:\nAccepted Version\nPeer-review status of attached file:\nPeer-reviewed\nCitation for published item:\nFunke, J. and Millson, J. (2006) 'Cycles with local coefficients for orthogonal groups and vector-valued Siegel\nmodular forms.', American journal of mathematics., 128 (4). pp. 899-948.\nFurther information on publisher's website:\nhttp:\/\/dx.doi.org\/10.1353\/ajm.2006.0032\nPublisher's copyright statement:\nCopyright c\u00a9 2006 The Johns Hopkins University Press. This article first appeared in American Journal of\nMathematics, Volume 128, Number 4, August 2006, pp. 899-948.\nAdditional information:\nUse policy\nThe full-text may be used and\/or reproduced, and given to third parties in any format or medium, without prior permission or charge, for\npersonal research or study, educational, or not-for-profit purposes provided that:\n\u2022 a full bibliographic reference is made to the original source\n\u2022 a link is made to the metadata record in DRO\n\u2022 the full-text is not changed in any way\nThe full-text must not be sold in any format or medium without the formal permission of the copyright holders.\nPlease consult the full DRO policy for further details.\nDurham University Library, Stockton Road, Durham DH1 3LY, United Kingdom\nTel : +44 (0)191 334 3042 | Fax : +44 (0)191 334 2971\nhttp:\/\/dro.dur.ac.uk\nCYCLES WITH LOCAL COEFFICIENTS FOR ORTHOGONAL\nGROUPS AND VECTOR-VALUED SIEGEL MODULAR FORMS\nJENS FUNKE* AND JOHN MILLSON**\nAbstract. The purpose of this paper is to generalize the relation [KM4] between\nintersection numbers of cycles in locally symmetric spaces of orthogonal type and\nFourier coefficients of Siegel modular forms to the case where the cycles have lo-\ncal coefficients. Now the correspondence will involve vector-valued Siegel modular\nforms.\n1. Introduction\nLet V be a non-degenerate quadratic space of dimension m and signature (p, q)\nover Q, for simplicity. The general case of a totally real number field is treated in\nthe main body of the paper. We write V = V (R) for the real points of V and let\nG = SO0(V ). Let G\n\u2032 denote the nontrivial 2-fold covering group of the symplectic\ngroup Sp(n,R) (the metaplectic group) and let K \u2032 be the 2-fold covering inherited\nby U(n). Let D = G\/K resp. D\u2032 = G\u2032\/K \u2032 be the symmetric space of G resp. G\u2032.\nNote that D\u2032 = Hn, the Siegel upper half space. In what follows we will choose\nappropriate (related) arithmetic subgroups \u0393 \u2282 G and \u0393\u2032 \u2282 G\u2032. We let M = \u0393\\D\nand M \u2032 = \u0393\u2032\\D\u2032 be the associated locally symmetric spaces.\nWe let En denote the holomorphic vector bundle over Hn associated to the standard\nrepresentation of U(n), i.e., En = Sp(n,R)\u00d7U(n) Cn. For each dominant weight \u03bb\u2032 of\nU(n), we have the corresponding irreducible representation space S\u03bb\u2032(Cn) of U(n) and\nthe associated holomorphic vector bundle S\u03bb\u2032(En) over M \u2032 (see \u00a73, for the meaning\nof the Schur functor S\u03bb\u2032(\u00b7)). For each half integer k\/2 we have a character detk\/2 of\nK \u2032. Let Lk\/2 be the associated G\u2032-homogeneous line bundle over the Siegel space. For\neach dominant weight \u03bb of G, we have the corresponding irreducible representation\nS[\u03bb](V ) of G with highest weight \u03bb and the flat vector bundle S[\u03bb](V) over M with\ntypical fiber S[\u03bb](V ) (see \u00a73, for the meaning of the harmonic Schur functor S[\u03bb](\u00b7)).\nLet \u03bb be a dominant weight for G. Let i(\u03bb) be the number of nonzero entries in\n\u03bb when \u03bb is expressed in the coordinates relative to the standard basis {\u000fi} of [Bou],\nPlanche II and IV. Hence we have i(\u03bb) \u2264 [m\/2]. We will assume (because of the choice\nof X below in the construction of our cycles CX , see Remark 4.7) that i(\u03bb) \u2264 p. Now\nwe choose n as in the paragraph above to be any integer satisfying i(\u03bb) \u2264 n \u2264 p and\nchoose for our highest weight of U(n) corresponding to \u03bb the unique dominant weight\n\u03bb\u2032 such that \u03bb\u2032 and \u03bb have the same nonzero entries, We note that both weights\n* Partially supported by NSF grant DMS-0305448 and NSF-grant DMS-0211133 at the Fields\nInstitute, Toronto.\n** Partially supported by NSF grant DMS-0104006.\n1\n2 JENS FUNKE AND JOHN MILLSON\ncorrespond to the same Young diagram and consequently the Schur functors S\u03bb\u2032(\u00b7)\nand S\u03bb(\u00b7) are the same, and we will not distinguish between them.\nThe main point of this paper is to use the theta correspondence for the dual pair\n(G,G\u2032) to construct for a pair of dominant weights \u03bb\u2032 and \u03bb as above an element\n\u03b8nq,[\u03bb](\u03c4, z) \u2208 C\u221e(M \u2032, S\u03bbE\u2217n \u2297 L\u2212m2 )\u2297\u0302Anq(M,S[\u03bb]V),\n(\u03c4 \u2208 Hn, z \u2208 D) which is closed as a differential form on M :\nd\u03b8nq,[\u03bb](\u03c4, z) = 0.\nHere Anq(M,S[\u03bb]V) denotes the space of S[\u03bb]V-valued differential nq-forms on M .\nNote that our notation is justified since n and \u03bb determine \u03bb\u2032. Hence we obtain\nan induced element [\u03b8nq,[\u03bb]] \u2208 C\u221e(M \u2032, S\u03bbE\u2217n \u2297 L\u2212m2 ) \u2297 Hnq(M,S[\u03bb]V). We will say\nthat elements of the above tensor product are sections of the holomorphic bundle\nS\u03bbE\u2217n \u2297 L\u2212m2 with coefficients in Hnq(M,S[\u03bb]V).\nNote that the highest weight of the isotropy representation of the homogeneous\nvector bundle for the symplectic group coincides (up to a shift) after the addition\nor suppression of zeroes with the highest weight of the coefficient system for the\northogonal group.\nOn the other hand, we can construct cycles in M as follows. Recall that we can\nrealize D as the set of negative q-planes in V :\nD = {z \u2282 V : dim z = q, ( , )|z < 0}.\nThen for x = (x1, . . . , xn) \u2208 V n with positive definite inner product matrix (x,x) =\n(xi, xj)i,j, we define a totally geodesic submanifold Dx by\nDx = {z \u2208 D : z \u22a5 span(x)}.\nThis gives rise to a cycle Cx in M of dimension (p \u2212 n)q, and by summing over all\nx in a system of representatives of \u0393-orbits in (a coset of) a lattice in V such that\n1\n2\n(x,x) = \u03b2 > 0, one obtains a composite cycle C\u03b2. For \u03b2 positive semidefinite of\nrank t \u2264 n, there is a similar construction to obtain cycles C\u03b2 of dimension (p\u2212 t)q.\nWe can then assign coefficients to these cycles (see \u00a74 for details) to obtain (relative)\nhomology classes\nC\u03b2,[\u03bb] \u2208 S\u03bb(Cn)\u2217 \u2297H(p\u2212t)q(M,\u2202M,S[\u03bb]V),\ni.e., for every vector w \u2208 S\u03bb(Cn), we obtain a class\nC\u03b2,[\u03bb](w) \u2208 H(p\u2212t)q(M,\u2202M,S[\u03bb]V).\nThen for a cohomology class \u03b7 \u2208 H(p\u2212n)qc (M,S[\u03bb]V), the natural pairing gives a vector\n\u3008\u03b7 \u222a en\u2212tq , C\u03b2,[\u03bb]\u3009 \u2208 S\u03bb(Cn)\u2217.\nHere, for q even, eq denotes a certain invariant q-form, the Euler form on D, and is\nzero if q is odd.\nIn the usual way, we can identify the space of holomorphic sections of the bun-\ndle S\u03bbE\u2217n \u2297 L\u2212m2 over (the compactification of) M \u2032 with Mod(\u0393\u2032, S\u03bb(Cn)\u2217 \u2297 det\u2212\nm\n2 ),\nthe space of holomorphic vector-valued Siegel modular forms for the representation\nCYCLES WITH COEFFICIENTS AND MODULAR FORMS 3\nS\u03bb(Cn)\u2217\u2297det\u2212\u2212m2 . Here Mod(\u0393\u2032, S\u03bb(Cn)\u2217\u2297det\u2212m2 ) is the space of holomorphic func-\ntions f(\u03c4) on Hn with values in S\u03bb(Cn)\u2217 \u2297 det\u2212m2 , holomorphic at the cusps of M \u2032,\nsuch that\nf(\u03b3\u03c4) = (\u03c1\u2217\u03bb \u2297 det \u2212m\/2)(tj(\u03b3, \u03c4)\u22121)f(\u03c4).\nHere \u03c1\u03bb is the action of GLn(C) on S\u03bb(Cn) and j(\u03b3, \u03c4) = c\u03c4 + d is the usual auto-\nmorphy factor for \u03b3 = ( a bc c ) \u2208 \u0393\u2032. Recall that for Siegel modular forms, the Fourier\nexpansion is indexed by positive semidefinite \u03b2 \u2208 Symn(Q), and note that the \u03b2-th\nFourier coefficient of such a form is now a vector in S\u03bb(Cn)\u2217.\nOur main result is\nTheorem 1.1. The cohomology class [\u03b8nq,[\u03bb]] is a holomorphic Siegel modular form\nfor the representation S\u03bb(Cn)\u2217\u2297det\u2212m2 with coefficients in Hnq(M,S[\u03bb]V). Moreover,\nthe Fourier expansion of [\u03b8nq,[\u03bb]](\u03c4) is given by\n[\u03b8nq,[\u03bb]](\u03c4) =\nn\u2211\nt=0\n\u2211\n\u03b2\u22650\nrank\u03b2=t\n(\nPD(C\u03b2,[\u03bb]) \u2229 en\u2212tq\n)\ne2piitr(\u03b2\u03c4),\nwhere PD(C\u03b2,[\u03bb]) denotes the Poincare\u00b4 dual class of PD(C\u03b2,[\u03bb]). Furthermore, if q is\nodd or if i(\u03bb) = n, then [\u03b8nq,[\u03bb]](\u03c4) is a cusp form.\nThis generalizes the main result of [KM4], where the generating series for the\nspecial cycles C\u03b2 with trivial coefficients was realized as a classical holomorphic Siegel\nmodular form of weight m\/2.\nPairing [\u03b8nq,[\u03bb]] with cohomology and homology defines two maps, which we denote\nboth by \u039bnq,[\u03bb], namely\n\u039bnq,[\u03bb] : H\n(p\u2212n)q\nc (M,S[\u03bb]V) \u2212\u2192Mod(\u0393\u2032, S\u2217\u03bb \u2297 det \u2212\nm\n2 );\n\u039bnq,[\u03bb] : Hnq(M,S[\u03bb]V) \u2212\u2192Mod(\u0393\u2032, S\u2217\u03bb \u2297 det \u2212\nm\n2 ).\nThese pairings give rise to the following two reformulations of Theorem 1.1:\nTheorem 1.2. For any cohomology class \u03b7 \u2208 H(p\u2212n)qc (M,S[\u03bb]V) and for any compact\ncycle C \u2208 Hnq(M,S[\u03bb]V), the generating series\nn\u2211\nt=0\n\u2211\n\u03b2\u22650\n\u3008(\u03b7 \u222a en\u2212tq ), C\u03b2,[\u03bb]\u3009e2pii tr(\u03b2\u03c4)\nand\nn\u2211\nt=0\n\u2211\n\u03b2\u22650\n\u3008C, (C\u03b2,[\u03bb] \u2229 en\u2212tq )\u3009e2pii tr(\u03b2\u03c4)\ndefine elements in Mod(\u0393\u2032, S\u03bb(Cn)\u2217 \u2297 det\u2212\nm\n2 ).\nTo illustrate our result, we consider the simplest example.\n4 JENS FUNKE AND JOHN MILLSON\nExample 1.3. Consider the weight \u03bb\u2032 = (`, `, \u00b7 \u00b7 \u00b7 , `) of U(n) (so the number or `\u2019s is\nn). Then S\u03bb(Cn) ' Sym`(\n\u2227n(Cn)) is one-dimensional, while S[\u03bb](V ) can be realized\nas a summand in the harmonic tensors in Sym`(\n\u2227n(V )) \u2282 V \u2297n`. For \u03b7 a closed\nrapidly decreasing S[\u03bb]V-valued smooth differential (p \u2212 n)q-form on M , the pairing\n\u3008[\u03b7], Cx,[\u03bb]\u3009 is given by the period\n\u3008[\u03b7], Cx,[\u03bb]\u3009 =\n\u222b\nCx\n(\u03b7, (x1 \u2227 \u00b7 \u00b7 \u00b7 \u2227 xn)`),\nwith the bilinear form ( , ) on V extended to V \u2297n`. Then the generating series of\nthese periods \u2211\nx\u2208Ln\n(x,x)>0\nmod \u0393\n(\u222b\nCx\n(\u03b7, (x1 \u2227 \u00b7 \u00b7 \u00b7 \u2227 xn)`)\n)\nepiitr((x,x)\u03c4)\nis a classical scalar-valued holomorphic Siegel cusp form of weight ` + m\/2. Here L\nis (a coset of) an integral lattice in V .\nFor n = 1, several (sporadic) cases for generating series for periods over cycles with\nnontrivial coefficients as elliptic modular forms were already known: For signature\n(2, 1) by Shintani [S], signature (2, 2) by Tong [T] and Zagier [Z], and for signature\n(2, q) by Oda [O] and Rallis and Schiffmann [RS]. For the unitary case of U(p, q), see\nalso [TW].\nWe have not tried to prove that the Siegel modular form associated to a cohomology\nclass \u03b7 or a cycle C is nonzero. However, for the case in which G = SO0(p, 1) the\nnonvanishing of the associated Siegel modular form (for a sufficiently deep congruence\nsubgroup depending on \u03b2 and \u03bb) follows from [KM1] together with [M]. Indeed, first\napply [KM1], Theorem 11.2, to reduce to the case where the cycle C\u03b2,[\u03bb] consists of a\nsingle component CX \u2297 x[f(\u03bb)], by passing to a congruence subgroup, see \u00a74.3. Then\napply (the proof of) Theorem 6.4 of [M] where it is shown that for a sufficiently deep\ncongruence subgroup the cycle CX \u2297 x[f(\u03bb)] is not a boundary.\nFor general orthogonal groups, the results of J. S. Li [L] suggest that again the\nSiegel modular form associated to a suitable \u03b7 is nonzero. Indeed, Li [L] has used the\ntheta correspondence (but not our special kernel \u03b8nq,[\u03bb]) to construct non-vanishing\ncohomology classes for O(p, q) for the above coefficient systems (with some restrictions\non \u03bb). However it is possible that all the above cycles C\u03b2,[\u03bb] are boundaries for some\np, q and \u03bb. This would be an unexpected development.\nFinally, we would like to mention our motivation for the present work. For M\nnot compact, we are interested in extending the lift \u039bnq,[\u03bb], say for \u03bb = 0, the trivial\ncoefficient case, to the full cohomology H(n\u2212p)q(M,C). This would extend the results\nof Hirzebruch\/Zagier [HZ], who, for Hilbert modular surfaces (essentially Q-rank 1 for\nO(2, 2)), lift the full cohomology H2(M,C) to obtain generating series for intersection\nnumbers of cycles. In this process, cohomology classes and cycles with nontrivial\ncoefficients naturally occur, as we now explain.\nCYCLES WITH COEFFICIENTS AND MODULAR FORMS 5\nWe let M denote the Borel-Serre compactification and let \u2202M denote the Borel-\nSerre boundary of M . We study the restriction of \u03b8nq,0 to \u2202(M), which is glued\ntogether out of faces e(P ), one for each \u0393-conjugacy class of proper parabolic Q-\nsubgroups P of G. In [FM1, FM2] we show that the theta kernel \u03b8nq,0 extends to\nM . In fact, the restriction to e(P ) is given by a sum of theta kernels \u03b8n(q\u2212r),\u03bb for\na nondegenerate subspace W \u2282 V associated to an orthogonal factor of the Levi\nsubgroup of P with values in S\u03bb(W ) for certain dominant weights \u03bb.\nThe paper is organized as follows. In \u00a72, we briefly review homology and coho-\nmology with nontrivial coefficients needed for our purposes, while in \u00a73, we review\nthe construction of the finite dimensional representations of GLn(C) and O(n) using\nthe Schur functors S\u03bb and S[\u03bb]. We introduce the special cycles with coefficients in\n\u00a74. In \u00a75, we give the explicit construction of the Schwartz forms \u03d5nq,[\u03bb] underlying\nthe theta series \u03b8nq,[\u03bb]. We give their fundamental properties and for the proofs, we\nreduce to the case of n = 1. \u00a76 is the technical heart of the paper, in which we prove\nthe fundamental properties of \u03d5nq,[\u03bb] for n = 1. Our main tool is the Fock model of\nthe Weil representation, which we review in the appendix to this paper. Finally, in\n\u00a77, we consider the global theta series \u03b8nq,[\u03bb] and give the proof of the main result.\nA major part of this work was done while the first named author was a fellow at the\nFields Institute in Toronto in the academic year 02\/03. He thanks the organizers of\nthe special program on Automorphic Forms and the staff of the institute for providing\nsuch a stimulating environment. We thank Steve Kudla for encouraging us to consider\nthe case of an arbitrary dominant weight in order to produce generating functions for\nintersection numbers and periods that are vector-valued Siegel modular forms.\n2. Homology and cohomology with local coefficients\nIn this section, we review the facts we need about homology and cohomology of\nmanifolds (possibly with boundary) with coefficients in a flat bundle (\u201clocal coeffi-\ncients\u201d) and \u201cdecomposable cycles\u201d. We refer the reader to [Ha], page 330 - 336 for\nmore details.\n2.1. The definition of the groups. We now define the homology and cohomology\ngroups of a manifold X with coefficients in E, a flat bundle over X. We will do this\nassuming that X is the underlying space of a connected simplicial complex K. We\nwill define the simplicial homology and cohomology groups with values in E. By the\nusual subdivision argument one can prove that the resulting groups are independent\nof the triangulation K.\nWe define a p-chain with values in E to be a formal sum \u03a3mi\u22121\u03c3i \u2297 si where \u03c3i is\nan oriented p-simplex and si is a flat section over \u03c3i. We denote the group of such\nchains by Cp(X,E). Before defining the boundary and coboundary operators we note\nthat if t is a flat section of E over a face \u03c4 of a simplex \u03c3 then it extends to a unique\nflat section e\u03c3,\u03c4 (t) over \u03c3. Similarly, if we have a flat section s over \u03c3 it restricts to\na flat section r\u03c4,\u03c3(s) over \u03c4 . Finally, if \u03c3 = (v0, \u00b7 \u00b7 \u00b7 , vp) we define the i-th face \u03c3i by\n\u03c3i = (v0, \u00b7 \u00b7 \u00b7 , v\u02c6i, \u00b7 \u00b7 \u00b7 , vp). Here v\u02c6i means the i-th vertex has been omitted.\n6 JENS FUNKE AND JOHN MILLSON\nWe define the boundary operator \u2202p : Cp(X,E) \u2212\u2192 Cp\u22121(X,E) for \u03c3 a p-simplex\nand s a flat section over X by\n\u2202p(\u03c3 \u2297 s) =\np\u2211\ni=0\n(\u22121)i\u03c3i \u2297 r\u03c3i,\u03c3(s)\nThen \u2202p\u22121\u25e6\u2202p = 0 and we define the homology groups H\u2022(X,E) of X with coefficients\nin E in the usual way. These groups depend only on the topological space X and the\nflat bundle E.\nIn a similar way simplicial cohomology groups of X with coefficients in E are\ndefined. A E-valued p-cochain on X with values in E is a function \u03b1 which assigns\nto each p-simplex \u03c3 a flat section of E over \u03c3. The coboundary \u03b4p\u03b1 of a p-cochain \u03b1\nis defined on a (p+ 1)-cochain \u03c3 by :\n\u03b4p\u03b1(\u03c3) =\np\u2211\ni=0\n(\u22121)ie\u03c3,\u03c3i(\u03b1(\u03c3i)).\nThen \u03b4p+1 \u25e6 \u03b4p = 0, and we define the cohomology groups H\u2022(X,E) of X with\ncoefficients in E in the usual way.\nIf A is a subspace of X, then the complex of simplicial chains with coefficients in\nE|A is a subcomplex, and we define the relative homology groups H\u2022(X,A,E) with\ncoefficients in E to be the homology groups of the quotient complex. Similarly, we\ndefine the subcomplex of relative (to A) simplicial cochains with coefficients in E to\nbe the complex of simplicial cochains that vanish on the simplices in A and define the\nrelative cohomology groups H\u2022(X,A,E) to be the cohomology groups of the relative\ncochain complex.\n2.2. Bilinear pairings. We first define the Kronecker pairing between homology and\ncohomology with local vector bundle coefficients. Let E, F and G be flat bundles\nover X. Assume that \u03bd : E \u2297F \u2212\u2192 G is a parallel section of Hom(E \u2297F,G). Let \u03b1\nbe a p-cochain with coefficients in E and \u03c3 \u2297 s be a p-simplex with coefficients in F .\nThen the Kronecker index < \u03b1, \u03c3 \u2297 s > is the element of H0(X,G) defined by:\n< \u03b1, \u03c3 \u2297 s >= \u03bd(\u03b1(\u03c3)\u2297 s).\nThe reader will verify that the Kronecker index descends to give a bilinear pairing\n< , >: Hp(X,E)\u2297Hp(X,F ) \u2212\u2192 H0(X,G).\nWe note that if G is trivial then H0(X,G) \u223c= Gx0 , here Gx0 denotes the fiber of G\nover x0. In particular, we get a pairing\n< , >: Hp(X,E\u2217)\u2297Hp(X,E) \u2212\u2192 R,\nwhich is easily seen to be perfect. The coefficient pairing E \u2297 F \u2192 G also induces\ncup products with local coefficients\n\u222a : Hp(X,E)\u2297Hq(X,F ) \u2212\u2192 Hp+q(X,G)\nand cap products with local coefficients (here we assume m \u2265 p)\n\u2229 : Hp(X,E)\u2297Hm(X,F ) \u2212\u2192 Hm\u2212p(X,G).\nCYCLES WITH COEFFICIENTS AND MODULAR FORMS 7\nThese are defined in the usual way using the \u201cfront-face\u201d and \u201cback-face\u201d of an\nordered simplex and pairing the local coefficients using \u03bd.\nRemark 2.1. We define the cap product \u03b1 \u2229 \u03c3 for \u03b1 a p-cochain and \u03c3 a simplex\nby making \u03b1 operate on the back p face of \u03c3. This agrees with [Br], pg. 334\u2013338 but\ndoes not agree with [Ha]. With this definition the adjoint formula\n(2.1) \u3008\u03b1 \u222a \u03b2, \u03c3\u3009 = \u3008\u03b1, \u03b2 \u2229 \u03c3\u3009\nholds (rather than \u3008\u03b1 \u222a \u03b2, \u03c3\u3009 = \u3008\u03b2, \u03b1 \u2229 \u03c3\u3009), see [Br], Proposition 5.1 (iii).\nThe above pairings relativize in a fashion identical to the case of trivial coefficients.\nSince the proof of Poincare\u00b4 (Lefschetz) duality is a patching argument of local\ndualities (see [Ha], p. 245-254), it goes through for local coefficients as well. Thus\nTheorem 2.2. Let X be a compact oriented manifold with (possibly empty) boundary\nand (relative) fundamental class [X, \u2202X]. Then we have an isomorphism\nD : Hp(X,E) \u2212\u2192 Hn\u2212p(X, \u2202X,E)\ngiven by\nD(\u03b1) = \u03b1 \u2229 [X, \u2202X].\nDefinition 2.3. Suppose [a] \u2208 Hp(X, \u2202X,E). We will define the Poincare\u00b4 dual of [a]\nto be denoted PD([a]) by\nPD([a]) = D\u22121([a]).\nWe can now define the intersection number of cycles with local coefficients, again\nfollowing the conventions of [Br], see page 367.\nDefinition 2.4. Let E,F,G and \u03bd be as above and [a] and [b] be homology classes\nwith coefficients in E and F respectively. Then we define the intersection class [a]\u00b7[b] \u2208\nH.(X,G) by the formula\n[a] \u00b7 [b] = D(PD([b]) \u222a PD([b])).\nIn order to help keep track of how the formula for intersection number depends on\nour convention in Remark 2.1 we note (proof left to the reader)\nLemma 2.5.\n[a] \u00b7 [b] = PD([b]) \u2229 [a].\nSo in the special case that [a] and [b] have complementary dimensions we have\n[a] \u00b7 [b] = \u3008PD([b]), [a]\u3009.\n2.3. Decomposable cycles. There is a particularly simple construction of cycles\nwith coefficients in E. Let Y be a compact oriented submanifold with (possibly\nempty) boundary \u2202Y \u2282 \u2202X of X of codimension p and let s be a parallel section of\nthe restriction of E to Y . Let [Y, \u2202Y ] denote the relative fundamental cycle of Y so\n[Y, \u2202Y ] = \u03a3i\u03c3i, a sum of oriented simplices.\n8 JENS FUNKE AND JOHN MILLSON\nDefinition 2.6. Y \u2297 s denotes the (n\u2212 p)-chain with values in E given by\nY = \u03a3i\u03c3i \u2297 si\nwhere si is the value of s on the first vertex of \u03c3i.\nLemma 2.7. Y\u2297s is a relative n\u2212p cycle with coefficients in E, called a decomposable\ncycle.\nFor motivation of the term decomposable cycle we refer the reader to [M],\u00a73.2.1.\n2.4. The de Rham theory of cohomology with local coefficients and the dual\nof a decomposable cycle. In this subsection we recall the de Rham representations\nof the cohomology groups H\u2022(X,E) and of the Poincare\u00b4 dual class PD(Y \u2297 s).\nFrom now on, X will always be smooth manifold.\nA differential p-form \u03c9 with values in a vector bundle E is a section of the bundle\u2227p T \u2217(X) \u2297 E over X. Thus \u03c9 assigns to a p-tuple of tangent vectors at x \u2208 X a\npoint in the fiber of E over x. Suppose now that E admits a flat connection \u2207. We\ncan then make the graded vector space of smooth E-differential forms A\u2217(X,E) into\na complex by defining\nd\u2207(\u03c9)(X1, X2, \u00b7 \u00b7 \u00b7 , Xp+1) =\np\u2211\ni=1\n(\u22121)i\u22121\u2207Xi(\u03c9(X1, \u00b7 \u00b7 \u00b7 , X\u0302i, \u00b7 \u00b7 \u00b7 , Xp+1))\n+\n\u2211\ni<j\n(\u22121)i+j\u03c9([Xi, Xj], X1, \u00b7 \u00b7 \u00b7 , X\u0302i, \u00b7 \u00b7 \u00b7 , X\u0302j, \u00b7 \u00b7 \u00b7 , Xp+1).\nHere Xi, 1 \u2264 i \u2264 p+ 1, is a smooth vector field on X.\nWe now construct a map \u03b9 from Ap(X,E) to the group of simplicial cochains\nCp(X,E) as follows. Let \u03c9 \u2208 Ap(X,E) and \u03c3 be a p-simplex of K. Then in a\nneighborhood U of \u03c3 we may write \u03c9 =\n\u2211\ni \u03c9i\u2297 si where the si\u2019s are parallel sections\nof E|U and the \u03c9i\u2019s are scalar forms. We then define\n< \u03b9(\u03c9), \u03c3 >=\n\u2211\ni\n(\n\u222b\n\u03c3\n\u03c9i)si(v0).\nThe standard double-complex proof of de Rham\u2019s theorem due to Weil, see [BT],\np. 138, yields\nTheorem 2.8. The integration map \u03b9 : H\u2022deRham(X,E) \u2212\u2192 H\u2022(X,E) is an isomor-\nphism.\nFinally, we will need that the cohomology class PD(Y \u2297 s) has the following rep-\nresentation in de Rham cohomology with coefficients in E.\nLet U be a tubular neighborhood of the oriented submanifold with boundary Y .\nWe assume (by choosing a Riemannian metric) that we have a disk bundle pi : U \u2192 Y .\nThen a Thom form for Y is a closed form \u03c9Y where \u03c9Y is compactly supported along\nthe fibers of pi and has integral one along one and hence all fibers of pi. It is standard\nthat the extension of \u03c9Y to X by making it zero outside of U represents the Poincare\u00b4\ndual of the class of [Y, \u2202Y ]. The parallel section s of E|Y extends to a parallel section\nCYCLES WITH COEFFICIENTS AND MODULAR FORMS 9\nof E|U again denoted s. We extend \u03c9Y \u2297 s to X by making it zero outside of U . We\ncontinue to use the notation \u03c9Y \u2297 s for this extended form. We will see below that\n\u03c9Y \u2297 s represents the Poincare\u00b4 dual of Y \u2297 s.\nIf [a] \u2208 Hp(X, \u2202X,E), then the de Rham cohomology class PD([a]) is the class of\n(n\u2212p)\u2013forms characterized by the property that if a is a simplicial cycle representing\n[a], then for any E\u2217 valued p-form \u03b7 vanishing on \u2202X we have\u222b\nX\n\u03b7 \u2227 PD([a]) =\n\u222b\na\n\u03b7.\nRemark 2.9. In abstract terms the above equation is\n\u3008[\u03b7] \u222a PD([a]), [X, \u2202X]\u3009 = \u3008[\u03b7], [a]\u3009.\nSince the expression on the right-hand side of this formula is equal to \u3008[\u03b7], PD([a])\u2229\n[X, \u2202X]\u3009 our definition of Poincare\u00b4 dual amounts to assuming the adjoint formula,\n(2.1), and hence amounts to assuming the \u201cback p face \u201d definition of the cap product.\nLemma 2.10. The de Rham cohomology class Poincare\u00b4 dual to the cycle with coef-\nficients Y \u2297 s is represented by the bundle-valued form \u03c9Y \u2297 s.\nProof. We need to prove that for any E\u2217-valued closed (n \u2212 p)-form \u03b7 vanishing on\n\u2202X we have \u222b\nX\n\u03b7 \u2227 \u03c9Y \u2297 s =\n\u222b\nY\u2297s\n\u03b7 =\n\u222b\nY\n\u3008\u03b7, s\u3009.\nBut \u222b\nX\n\u03b7 \u2227 \u03c9Y \u2297 s =\n\u222b\nX\n\u3008\u03b7, s\u3009 \u2227 \u03c9.\nBut since s is parallel on U the scalar form \u3008\u03b7, s\u3009 is closed, and the lemma follows\nbecause \u03c9Y is the Poincare\u00b4 dual to [Y, \u2202Y ]. \u0003\n3. Finite dimensional representations of GL(n) and O(n)\nIn this section, we will review the construction of the irreducible finite dimensional\n(polynomial) representations of GL(U) (resp. O(U)), where U is a complex vector\nspace of dimension n (resp. a finite dimensional complex vector space of dimension\nn equipped with a non-degenerate symmetric bilinear form ( , )).\n3.1. Representations of the general linear group.\n3.1.1. Schur functors. We recall that the symmetric group S` acts on the `\u2013fold tensor\nproduct T `(U) according to the rule that s \u2208 S` acts on a decomposable element\nv1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 v` by moving vi to the s(i)\u2013th position. Let \u03bb = (b1, b2, \u00b7 \u00b7 \u00b7 , bn) be a\npartition of `. We assume that the bi\u2019s are arranged in decreasing order. We will use\nD(\u03bb) to denote the Young diagram associated to \u03bb. We will identify the partition \u03bb\nwith the dominant weight \u03bb for GL(n) in the usual way.\nFor more details on what follows, see [FH], \u00a74.2 and \u00a76.1, [GW], \u00a79.3.1\u20139.3.4 and\n[Boe], Ch. V, \u00a75.\n10 JENS FUNKE AND JOHN MILLSON\nStandard fillings and the associated projections.\nDefinition 3.1. A standard filling t(\u03bb) of the Young diagram D(\u03bb) by the elements\nof the set [`] = {1, 2, \u00b7 \u00b7 \u00b7 , `} is an assignment of each of the numbers in [`] to a box\nof D(\u03bb) so that the entries in each row strictly increase when read from left to right\nand the entries in each column strictly increase when read from top to bottom. We\nwill denote the set of standard fillings of D(\u03bb) by S(\u03bb). A Young diagram equipped\nwith a standard filling will be called a standard tableau.\nWe let t0(\u03bb) be the standard filling that assigns 1, 2, \u00b7 \u00b7 \u00b7 , ` from left to right starting\nwith the first row then moving to the second row etc.\nWe now recall the projection in End(T `(U)) associated to a standard tableau T\nwith ` boxes corresponding to a standard filling t(\u03bb) of a Young diagram D(\u03bb). Let P\n(resp. Q) be the group preserving the rows (resp. columns) of T . Define elements of\nthe group ring of S` by rt(\u03bb) = c1\n\u2211\nP p and ct(\u03bb) = c2\n\u2211\nQ \u000f(q)q where c1 = 1\/|P | and\nc2 = 1\/|Q|, so rt(\u03bb) and ct(\u03bb) are idempotents. We let P (resp. Q) be the projections\noperating on T `(U) obtained by acting by rt(\u03bb) (resp. ct(\u03bb)). We put st(\u03bb) = c3ct(\u03bb) \u00b7rt(\u03bb)\n(product in the group ring) where c3 is chosen so that st(\u03bb) is an idempotent, see [FH],\nLemma 4.26.\nRemark 3.2. We have abused notation by not indicating the dependence of Q and P\non the standard filling t(\u03bb). We will correct both these abuses by letting pit(\u03bb) denote\nthe projector obtained by correctly normalizing the previous product.\nWe now have\nTheorem 3.3. We have a direct sum decomposition\nT `(U) =\n\u2295\n\u03bb\u2208P(`)\n\u2295\nt(\u03bb)\u2208S(\u03bb)\npit(\u03bb)\n(\nT `(U)\n)\n,\nwhere P(`) denotes the set of partitions of `.\nFurthermore we have, [GW], Theorem 9.3.9,\nTheorem 3.4. For every standard filling t(\u03bb), the GL(V )\u2013module pit(\u03bb)\n(\nT `(U)\n)\nis\nirreducible with highest weight \u03bb.\nRemark 3.5. If t\u2032(\u03bb) is another standard filling then the permutation relating the\ntwo fillings induces an isomorphism of pit(\u03bb)(T\n`(U)) and pit\u2032(\u03bb)(T\n`(U)).\nFor concreteness, we will define the Schur functor S\u03bb(\u00b7) by choosing t(\u03bb) = t0(\u03bb),\nwhence S\u03bb(U) = pit0(\u03bb)\n(\nT `(U)\n)\n. We obtain projections pi\u03bb\npi\u03bb : T\n`(U) \u2212\u2192 S\u03bb(U)\nand inclusions\n\u03b9\u03bb : S\u03bb(U) \u2212\u2192 T `(U).\nCYCLES WITH COEFFICIENTS AND MODULAR FORMS 11\nSemistandard fillings and the associated basis of S\u03bb(U).\nDefinition 3.6. A semistandard filling of D(\u03bb) by the set [n] = {1, 2, \u00b7 \u00b7 \u00b7 , n} is an\nassignment of the numbers in [n] to the boxes of D(\u03bb) such that the numbers in\neach row weakly increase and the numbers in each column strictly increase. We let\nSS(\u03bb, n) denote the set of semistandard fillings of D(\u03bb) by the elements of the set\n[n].\nSuppose x = (x1, \u00b7 \u00b7 \u00b7 , xn) \u2208 Un and f(\u03bb) \u2208 SS(\u03bb, n). Suppose aij is the j-th entry\nin the i-th column of the semistandard filling. Then xf(\u03bb), the word in x corresponding\nto f(\u03bb), is defined by\nxf(\u03bb) = xa11 \u2297 xa12 \u2297 \u00b7 \u00b7 \u00b7 \u2297 xakbk .\nWe have\nTheorem 3.7. Let u1, \u00b7 \u00b7 \u00b7 , un be a basis for U and let u = (u1, . . . , un). Then the set\nof vectors {pit(\u03bb)(uf(\u03bb)) : f \u2208 SS(\u03bb, n)} is a basis for pit(\u03bb)(T d(U)).\nFor a simple proof of this theorem see [Boe], Theorem 5.3. Boerner proves the the-\norem using the idempotent c3PQ on T `(U) (actually, he considers c3QP on T `(U\u2217)),\nbut his proof can be easily modified to give the theorem above.\n3.2. Representations of the orthogonal group.\n3.2.1. The harmonic Schur functors. We will follow [FH] in our description of the\nharmonic Schur functor U \u2192 S[\u03bb](U) on an n-dimensional non-degenerate quadratic\nspace (U, ( , )) corresponding to a partition \u03bb.\nThe harmonic projection. We extend the quadratic form ( , ) to T `(U) as the\n`-fold tensor product and note that the action of S` on T\n`(U) is by isometries. For\neach pair I = (i, j) of integers between 1 and ` we define the contraction operator\nCI : \u2297`U \u2192 \u2297`\u22122U by\nCI(v1 \u2297 \u00b7 \u00b7 \u00b7 v`) =\n\u2211\nk\n(vi, ek)(vj, ek)v1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 v\u0302i \u2297 \u00b7 \u00b7 \u00b7 \u2297 v\u0302j \u2297 \u00b7 \u00b7 \u00b7 \u2297 v`\nwhere {e1, \u00b7 \u00b7 \u00b7 , en} is an orthonormal basis for ( , ). We also define the expansion\noperator AI : \u2297`\u22122U \u2192 \u2297`U to be the adjoint of CI , that is the operator that inserts\nthe (dual of) the form ( , ) into the (i, j)-th spots. We define the harmonic `-tensors,\nto be denoted U [`], to be the kernel of all the contractions CI . Following [FH], p. 263,\nwe define the subspace U\n[`]\n`\u22122r of U\n\u2297` by\nU\n[`]\n`\u22122r =\n\u2211\nAI1 \u25e6 \u00b7 \u00b7 \u00b7AIrU [`\u22122r].\nCarrying over the proof of [FH], Lemma 17.15 (and the exercise that follows it)\nfrom the symplectic case to the orthogonal case we have\nLemma 3.8. We have a direct sum, orthogonal for ( , ),\nT `(U) = U [`] \u2295\u2295[\n`\n2\n]\nr=1U\n[`]\n`\u22122r.\n12 JENS FUNKE AND JOHN MILLSON\nWe define the harmonic projectionH : T `(U)\u2192 U [`] to be the orthogonal projection\nonto the harmonic `-tensors U [`]. The space of harmonic `-tensors U [`] is invariant\nunder the action of S`. Consequently we may apply the idempotents in the group\nalgebra of S` corresponding to partitions to further decompose U\n[`] as an O(U)\u2013\nmodule.\nThe harmonic Schur functors. We let \u03bb = (b1, b2, \u00b7 \u00b7 \u00b7 , bk) be a dominant weight\nof SO(U) where k = [n\n2\n]. Here our coordinates are relative to the standard basis {\u000fi}\nof [Bou], Planche II and IV. We will also use \u03bb to denote the corresponding partition\nof ` =\n\u2211\nbi. Again following [FH], p. 296, we then define the harmonic Schur functor\nS[\u03bb]U as follows.\nDefinition 3.9.\nS[\u03bb](U) = HQPT `(U) = HS\u03bb(U).\nWe then have see [FH], Theorem 19.22,\nTheorem 3.10. The O(U)-module S[\u03bb](U) is irreducible with highest weight \u03bb.\nDefinition 3.11. We write pi[\u03bb] = H\u25e6 pi\u03bb for the projection from T `(U) onto S[\u03bb](U).\nFor a semistandard filling f(\u03bb), we also set for x = (x1, . . . , xn),\nx[f(\u03bb)] = pi[\u03bb]xf(\u03bb) \u2208 S[\u03bb](U).\nIn what follows, we will need the following\nLemma 3.12. (i) H,P and Q are self-adjoint relative to ( , ).\n(ii) H commutes with P and Q.\nProof. It is clear that H is self-adjoint. The arguments for P and Q are the same. We\ngive the one for Q. We will use the symbol q to denote both the element q \u2208 Q and\nthe corresponding operator on T `(V ). Since q is an isometry we have q\u2217 = q\u22121. Hence\nwe have Q\u2217 = \u2211 \u000f(q)q\u2217 = \u2211 \u000f(q\u22121)q\u22121 = Q. To prove that H commutes with P and\nQ it suffices to prove that H commutes with every element g \u2208 S`. But S` acts by\nisometries and preserves U [`]. Consequently it commutes with orthogonal projection\non U [`]. \u0003\nThe restriction of S[\u03bb](U) to SO(U). The restriction of S[\u03bb](U) to SO(U) remains\nirreducible unless the dimension of U is even, so dim(U) = 2k, and i(\u03bb) = k, and in\nthis case the restriction is the sum of two irreducible representations. For a precise\nstatement the reader is referred to [FH], Theorem 19.22. Thus for these cases our\ncohomology classes will take values in the cohomology group of M with values in the\ncoefficient systems associated to the above direct sum (considered as representations\nof SO(p+q)). However in case M is compact the classes obtained by our constructions\nfor these exceptional cases will often be zero. We will deduce from [LS], Proposition\n2.14, that this is indeed the case provided that \u03bb is regular in the sense that the\nentries of \u03bb are strictly decreasing. The argument divides into two cases: The case in\nwhich both p and q are even and the case in which both p and q are odd.\nIn case p and q are both even and \u03bb regular it follows immediately from [LS],\nProposition 2.14, that all cohomology groups for a coefficient system as above are\nCYCLES WITH COEFFICIENTS AND MODULAR FORMS 13\nzero except in the degree equal to the middle dimension (pq)\/2 (note that l0(G) = 0\nin this case). But we claim that the codimensions of the cycles we construct with\nvalues in such coefficient systems are always larger than (pq)\/2. Indeed, by Remark\n4.7 in order to attach a nonzero local coefficient to the cycle Cx it is necessary that\ndim(X) \u2265 i(\u03bb). Hence\ncod(Cx) = dim(X) q \u2265 i(\u03bb) q.\nSince we are assuming that i(\u03bb) has its maximum value (p+ q)\/2 we obtain\ncod(Cx) \u2265 q(p+ q)\/2 > (pq)\/2.\nThus the cycles we construct in this case are always boundaries.\nNow suppose that p and q are both odd. It follows from [LS], Proposition 2.14, that\nall cohomology groups for a coefficient system as above are zero except in the degrees\nequal to the two middle dimensions (pq \u2212 1)\/2 and (pq + 1)\/2 (note that l0(G) = 1\nin this case). Once again we have i(\u03bb) = (p+ q)\/2 and cod(Cx) \u2265 q(p+ q)\/2. Hence\nthe cohomology classes we obtain as the Poincare` duals of our cycles with coefficients\noccur in degrees greater than those allowed by [LS] if\nq(p+ q)\/2 > (pq + 1)\/2.\nThis inequality holds if and only if q > 1. But for the case SO(p, 1) with p odd all\ncohomology groups vanish provided only i(\u03bb) = (p+ 1)\/2, see [M], Theorem 1.2.\nIf \u03bb is singular, it no longer follows from [VZ] that the cohomologies of the cor-\nresponding local coefficient systems are concentrated in the middle dimension(s).\nHowever it is still possible that all classes we construct in this case are boundaries.\n4. Special cycles with local coefficients\n4.1. Arithmetic quotients for orthogonal groups. Let K be a totally real num-\nber field with Archimedean places v1, . . . , vr and associated embeddings \u03bb1, . . . , \u03bbr\nand let be O its ring of algebraic integers. Let V be an oriented vector space over\nK of dimension m \u2265 3 with a non-degenerate bilinear form ( , ) and let V be the\ncompletion of V at v1. We assume that the associated quadratic form has signature\n(p, q) at the completion v1 and is positive definite at all other completions. Finally,\nwe let L be an integral lattice in V and L# \u2287 L its dual lattice.\nLet G be the algebraic group whose K-points is the group of orientation preserving\nisometries of determinant 1 of the form ( , ) and let G := G(R) its real points. We\nlet \u03a6 = G(O) be the subgroup of G(K) consisting of those elements that take L into\nitself. We let b be an ideal in O and let \u0393 = \u0393(b) be the congruence subgroup of \u03a6 of\nlevel b (that is, the elements of \u03a6 that are congruent to the identity modulo b). We\nfix a congruence condition h \u2208 Ln once and for all and note that \u0393 operates on the\ncoset h+ bLn.\nWe realize the symmetric space associated to V as the set of negative q- planes in\nV :\nD ' {z \u2282 V ; dim z = q and ( , )|z < 0}.\n14 JENS FUNKE AND JOHN MILLSON\nWe denote the base point of D by z0, and we have D ' G\/K, where K is the maximal\ncompact subgroup of G stabilizing z0. Also note dimRD = pq. For z \u2208 D, we write\n( , )z for the associated majorant. Finally, we write\nM = \u0393\\D\nfor the locally symmetric space.\n4.2. Special cycles with trivial coefficients. Let x = {x1, x2, \u00b7 \u00b7 \u00b7 , xn} \u2208 V n be\nan n-tuple of K\u2013rational vectors. We let X be the span of x and let X be the\ncompletion of X at \u03bb1. We write (x,x) for the n by n matrix with ij\u2013th entry\nequal to (xi, xj). We call x nondegenerate if rank(\u03bbix, \u03bbix) = dimX for all i and\nnonsingular if rank(\u03bbix, \u03bbix) = n.\nAssume x is nondegenerate with dimX = t \u2264 n such that ( , )|X is positive\ndefinite. Let rX be the isometric involution of V given by\nrX(v) =\n{\n\u2212v if v \u2208 X\nv if v \u2208 X\u22a5.\nWe define the totally geodesic subsymmetric space DX by\nDX = {z \u2208 D : (z, xi) = 0, 1 \u2264 i \u2264 n}.\nThen DX is the fixed-point set of rX acting on D and has codimension (n \u2212 t)q in\nD. We orient DX as in [KM4], p.130-131. We also define subgroups GX (resp. \u0393X)\nto be the stabilizer in G (resp. in \u0393) of the subspace X. We define G\u2032X \u2282 GX to be\nthe subgroup that acts trivially on X, and put \u0393\u2032X = \u0393 \u2229G\u2032X .\nTheorem 4.1. There exists a congruence subgroup \u0393 := \u0393(b) of \u03a6 such that\n(1) M = \u0393\\D is an orientable manifold of dimension pq with finite volume, and\n(2) for all X as above, the image CX of DX in M is the quotient \u0393X\\DX and\ndefines a properly embedded orientable submanifold of codimension (n\u2212 t)q.\nThe theorem will be a consequence of the existence of a \u201cneat\u201d congruence sub-\ngroup. We recall the definition of a neat subgroup of \u0393.\nDefinition 4.2 ([B],p. 117). An element g \u2208 G is neat if the subgroup of C\u2217 generated\nby the eigenvalues of g is torsion free. In particular, if a root of unity z is an eigenvalue\nof a neat element then z = 1. A subgroup \u0393 \u2282 G is neat if all the elements in \u0393 are\nneat.\nProposition 4.3 (Proposition 17.4, [B]). Let G be an algebraic group defined over\nQ and \u0393 an arithmetic subgroup. Then \u0393 admits a neat congruence subgroup.\nTheorem 4.1 is an immediate consequence of the following\nLemma 4.4. If \u0393 is a neat subgroup, then \u0393X acts trivially on X, i.e., \u0393\n\u2032\nX = \u0393X .\nProof. We have a projection map pX : \u0393X \u2192 O(X1)\u00d7O(X2)\u00d7 \u00b7 \u00b7 \u00b7 \u00d7O(Xr). Here by\nXi we mean the i-th completion of X. The i-th completion of ( , ) restricted to Xi is\npositive definite for 1 \u2264 i \u2264 r. Furthermore the splitting V = X\u2295X\u22a5 is defined over\nCYCLES WITH COEFFICIENTS AND MODULAR FORMS 15\nK. Thus the diagonal embedding of the intersection LX = L\u2229X is a lattice in \u2295ri=1Xi\nwhich is invariant under pX(\u0393X). Hence pX(\u0393X) is a discrete subgroup of a compact\ngroup hence a finite group. Hence if \u03b3 \u2208 pX(\u0393X), then all eigenvalues of \u03b3 are roots\nof unity. Since \u0393 is neat all eigenvalues must be 1 and the lemma follows. \u0003\nWe will later need\nDefinition 4.5. The Riemannian exponential map from the total space of the normal\nbundle of DX to D induces a fiber bundle piX : D \u2192 DX with totally geodesic fibers.\nThe map piX induces a quotient fibering piX : \u0393X\\D \u2192 \u0393X\\DX = CX , see [KM1]. A\nThom form \u03a6X for the cycle CX is a closed integrable (n \u2212 t)q-form on \u0393X\\D such\nthat the integral of \u03a6X over each fiber of piX is 1. In particular, \u03a6X is a Poincare\u00b4\ndual form for the cycle CX in the non-compact submanifold \u0393X\\D.\nOccasionally, we will also write Cx (Dx) for CX (DX).\nWe introduce composite cycles as follows. For \u03b2 \u2208 Symn(K), we set\n\u2126\u03b2 = {x \u2208 V n : 12(x,x) = \u03b2}\nand\n\u2126c\u03b2 = {x \u2208 \u2126\u03b2 : dim\u03bbiX = rank \u03b2 for all i}.\nWe put\nL\u03b2 = L\u03b2(h, b) = (h+ bLn) \u2229 \u2126\u03b2.\nThen \u0393 acts on Lc\u03b2 = L\u03b2\u2229\u2126c\u03b2 with finitely many orbits and for \u03b2 positive semidefinite\n(i.e., \u03bbi(\u03b2) \u2265 0 for all i), we define\nC\u03b2 =\n\u2211\nx\u2208\u0393\\Lc\u03b2\nCX .\n4.3. Special cycles with nontrivial coefficients. We now want to promote CX\nto a (decomposable) cycle with coefficients for appropriate coefficient systems W by\nfinding a nonzero parallel section of W|CX . Note that it is enough to find any \u0393X-\nfixed vector w \u2208 W since such a vector w gives rise to a parallel section sw of W|CX\nin the usual way. Namely, for z \u2208 CX , the section sw for the bundle CX\u00d7\u0393XW \u2192 CX\nis given by sw(z) = (z, w). Thus sw is constant, hence parallel. Furthermore, for such\na vector w, we write CX \u2297 w for CX \u2297 sw.\nThe key point for us in constructing parallel sections is Lemma 4.4. Namely, the\ncomponents x1, \u00b7 \u00b7 \u00b7 , xn of x are all fixed by \u0393X = \u0393\u2032X , hence any tensor word in these\ncomponents will be fixed by \u0393X .\nDefinition 4.6. For f(\u03bb) a semistandard filling for D(\u03bb), we define special cycles\nwith coefficients in S[\u03bb](V ) by setting\nCx,[f(\u03bb)] = CX \u2297 (\u03bb1x)[f(\u03bb)].\nWe also define composite cycles C\u03b2,[f(\u03bb)] analogously as before.\nTo lighten the notation, we will write xf(\u03bb) and x[f(\u03bb)] for (\u03bb1x)f(\u03bb) and (\u03bb1x)[f(\u03bb)].\nHowever, there is an obstruction to the construction of nonzero sections.\n16 JENS FUNKE AND JOHN MILLSON\nRemark 4.7 ([M], Proposition 4.3). Let \u03bb be the highest weight of W and let i(\u03bb)\nbe the number of nonzero entries in \u03bb (so i(\u03bb) is the number of rows in the associated\npartition). Then\ndim(X) \u2265 i(\u03bb)\nis a necessary condition for the existence of a G\u2032X\u2013invariant vector in W , i.e., to\nfinding a nonzero parallel section of the restriction of the flat vector bundleW to the\ncycle CX .\nOn the other hand, for dim(X) \u2265 i(\u03bb), we do have nonzero parallel sections along\nthe submanifold CX .\nTheorem 4.8 ( [M],Theorem 4.13). For a weight \u03bb = (b1, . . . , b[m\n2\n]), assume i(\u03bb) =\nk \u2264 n. Let f0(\u03bb) be the semistandard filling that puts 1\u2019s in the first row of D(\u00b5),\n2\u2019s in the second row etc.. Furthermore, assume that for x = (x1, . . . , xn), the first k\nvectors x1, . . . , xk are linearly independent and satisfy (xi, xj) = 0, i 6= j. Then\nx[f0(\u03bb)] = Hpi\u03bb(xf0(\u03bb)) = HQx\u2297b11 \u2297 \u00b7 \u00b7 \u00b7 \u2297 x\u2297bkk\nis a nonzero \u0393\u2032X\u2013invariant in S[\u03bb](V ).\nFor later use, we record (by an analog of Lemma 2.10)\nLemma 4.9. Let \u03b7 be a rapidly decreasing S[\u03bb](V)\u2013valued closed (p \u2212 n)q form on\nM . If \u03a6X denotes a Thom form for the cycle CX , then \u03a6X \u2297 x[f(\u03bb)] satisfies\u222b\nM\n\u03b7 \u2227 (\u03a6X \u2297 x[f(\u03bb)]) = \u222b\nCx,[f(\u03bb)]\n\u03b7 =\n\u222b\nCX\n(\u03b7,x[f(\u03bb)]).\n4.4. Cycle-valued homomorphisms on T `(Qn). We now construct composite cy-\ncles C\u03b2,[\u03bb], which are homomorphisms from S\u03bb(Qn) to H\u2022(M,S[\u03bb](V)).\nDefinition 4.10. We define elements CX,[\u03bb](\u00b7) of Hom(S\u03bb(Qn), H\u2022(M,S[\u03bb](V))) by\nCx,[\u03bb](\u000ff(\u03bb)) = CX \u2297 x[f(\u03bb)].\nHere \u000f = (\u000f1, \u00b7 \u00b7 \u00b7 , \u000fn) \u2208 Qn. (Note that we could have defined the map on T `(Qn)\ninstead and observed that it automatically factors through S\u03bb(Qn)). We then have\ncomposite cycles C\u03b2,[\u03bb](\u00b7) as before by summing over all x \u2208 \u0393\\L\u03b2.\nFinally note that, if \u03b7 is a rapidly decreasing S[\u03bb](V)\u2013valued closed (p \u2212 n)q form\non M , then the period\n\u222b\nCx,[\u03bb]\n\u03b7 is the linear functional on S\u03bb(Cn) given by\n(4.1)\n(\u222b\nCx,[\u03bb]\n\u03b7\n)\n(pi\u03bb\u000ff(\u03bb)) =\n\u222b\nCX\n(\u03b7,x[f(\u03bb)]).\n5. Special Schwartz forms\nIn this section, we will explicitly construct the Schwartz form \u03d5nq,[\u03bb] needed to\nconstruct the cohomology class [\u03b8nq,[\u03bb]](\u03c4, z) alluded to in the introduction. As in the\nintroduction we will choose a pair of highest weights \u03bb for G and \u03bb\u2032 for U(n) which\nhave the same nonzero entries. We let ` be the sum of the entries of \u03bb (which equals\nthe sum of the entries of \u03bb\u2032).\nCYCLES WITH COEFFICIENTS AND MODULAR FORMS 17\n5.1. A double complex for the Weil representation. In this section, V will\ndenote a real quadratic space of dimension m and signature (p, q). We write S(V n)\nfor the space of (complex-valued) Schwartz functions on V n. We denote by G\u2032 =\nMp(n,R) the metaplectic cover of the symplectic group Sp(n,R) and let K \u2032 be the\ninverse image of the standard maximal compact U(n) \u2282 Sp(n,R) under the covering\nmap Mp(n,R) \u2192 Sp(n,R). Note that K \u2032 admits a character det1\/2, i.e., its square\ndescends to the determinant character of U(n). The embedding of U(n) into Sp(n,R)\nis given by A + iB 7\u2192 ( A B\u2212B A ). We let \u03c9 = \u03c9V be the Schro\u00a8dinger model of the\n(restriction of the) Weil representation of G\u2032 \u00d7 O(V ) acting on S(V n) associated to\nthe additive character t 7\u2192 e2piit.\nLet Hn = {\u03c4 = u + iv \u2208 Symn(C) : v > 0} ' Sp(n,R)\/U(n) be the Siegel\nupper half space of genus n. We write g\u2032 and k\u2032 for the complexified Lie algebra of\nSp(n,R) and U(n) respectively. We write the Cartan decomposition as g\u2032 = k\u2032 \u2295 p\u2032,\nand write p\u2032 = p+ \u2295 p\u2212 for the decomposition of the tangent space of the base\npoint i1n into the holomorphic and anti-holomorphic tangent spaces. We let Z\u00afj,\n1 \u2264 j \u2264 n(n + 1)\/2 be a basis of p\u2212 and let \u03b7\u00afj be the dual basis. We let C(\u03c7m\/2)\nbe the 1-dimensional representation detm\/2 of K \u2032. We write W` = T `(Cn)\u2297 C(\u03c7m\/2)\nconsidered as a representation of K \u2032 and letW` be the G\u2032-homogeneous vector bundle\nover Hn associated to W`. We also define W\u03bb\u2032 andW\u03bb\u2032 in the same way using S\u03bb\u2032(Cn)\ninstead.\nWe pick an orthogonal basis {ei} of V such that (e\u03b1, e\u03b1) = 1 for \u03b1 = 1, . . . , p and\n(e\u00b5, e\u00b5) = \u22121 for \u00b5 = p+ 1, . . . , p+ q. We will use \u201cearly\u201d Greek letters (typically \u03b1\nand \u03b2) as subscripts to denote indices between 1 and p (for the \u201cpositive\u201d variables)\nand \u201clate\u201d ones (typically \u00b5 and \u03bd) to denote indices between p+ 1 and p+ q (for the\n\u201cnegatives\u201d ones).\nLet g be the Lie algebra of G and g = p + k its Cartan decomposition, where\nLie(K) = k. Then p ' g\/k is isomorphic to the tangent space at the base point of\nD ' G\/K. We denote by X\u03b1\u00b5 (1 \u2264 \u03b1 \u2264 p, p + 1 \u2264 \u00b5 \u2264 p + q) the elements of the\nstandard basis of p induced by the basis {ei} of V , i.e.,\nX\u03b1\u00b5(ei) =\n\uf8f1\uf8f4\uf8f2\uf8f4\uf8f3\ne\u00b5, if i = \u03b1\ne\u03b1, if i = \u00b5\n0, otherwise.\nWe let \u03c9\u03b1\u00b5 \u2208 p\u2217 be the elements of the associated dual basis. Finally, we let Ak(D)\nbe the space of (complex-valued) differential k forms on D.\nWe consider the graded associative algebra\nC =\n\u2295\ni,j,`\u22650\nCi,j` ,\nwhere\nCi,j` =\n[\nW \u2217` \u2297\n\u2227i\n(p\u2212)\u2217 \u2297 S(V n)\u2297\n\u2227j\np\u2217 \u2297 T `(V )\n]K\u2032\u00d7K\n,\n18 JENS FUNKE AND JOHN MILLSON\nwhere the multiplication \u00b7 in C is given componentwise. For each `, we have a double\ncomplex (C\u2022,\u2022` , \u2202\u00af, d) with commuting differentials\n\u2202\u00af =\nn(n+1)\/2\u2211\nj=1\n1\u2297 A(\u03b7\u00afj)\u2297 \u03c9(Z\u00afj)\u2297 1\u2297 1,\nd = dS + dV ,\nwhere\ndS =\n\u2211\n\u03b1,\u00b5\n1\u2297 1\u2297 \u03c9(X\u03b1\u00b5)\u2297 A(\u03c9\u03b1\u00b5)\u2297 1,\ndV =\n\u2211\n\u03b1,\u00b5\n1\u2297 1\u2297 1\u2297 A(\u03c9\u03b1\u00b5)\u2297 \u03c1(X\u03b1\u00b5).\nHere A(\u00b7) denotes the left multiplication, while \u03c1 is the derivation action of g on\nT `(V ). Furthermore, K \u2032 acts on the first three tensor factors of Ci,j` , while K acts on\nthe last three. The actions on S(V n) are given by the Weil representation, while the\nactions on the other tensor factors are the natural ones.\nWe also have an analogous complex C\u2022,\u2022[\u03bb] by replacing W\n\u2217\n` and T\n`(V ) with W \u2217\u03bb and\nS[\u03bb](V ) respectively.\nWe call a d-closed element \u03d5 \u2208 Ci,j holomorphic if the cohomology class [\u03d5] is\n\u2202\u00af-closed, i.e., there exists an element \u03c8 \u2208 Ci+1,j\u22121 such that\n\u2202\u00af\u03d5 = d\u03c8.\nNote that the maps \u2202\u00af and d correspond to the usual operators \u2202\u00af and d under the\nisomorphism\n[W \u2217` \u2297A0,i(Hn)\u2297 S(V n)\u2297Aj(D)\u2297 T `(V )]G\n\u2032\u00d7G \u2192 Ci,j` ,\ngiven by evaluation at the base points of Hn and D. We will frequently identify these\ntwo spaces, and we will use the same symbol for corresponding objects.\n5.2. Special Schwartz forms. We construct for n \u2264 p a family of Schwartz func-\ntions \u03d5nq,` on V\nn taking values in W \u2217` \u2297 Anq(D) \u2297 T `(V ), which we interpret as\nthe space of differential nq-forms on D which take values in W \u2217` \u2297 T `(V ). That is,\n\u03d5nq,` \u2208 C0,j` :\n\u03d5nq,` \u2208\n[\nW \u2217` \u2297 S(V n)\u2297Anq(D)\u2297 T `(V )\n]K\u2032\u00d7G\n'\n[\nW \u2217` \u2297 S(V n)\u2297\n\u2227nq\n(p\u2217)\u2297 T `(V )\n]K\u2032\u00d7K\n.\nThese Schwartz forms are the generalization of the \u2019scalar-valued\u2019 Schwartz forms\nconsidered by Kudla and Millson [KM2, KM3, KM4] to the coefficient case.\nStarting with the standard Gaussian,\n\u03d50(x) = e\n\u2212pitr(x,x)z0 \u2208 S(V n),\nwith x = (x1, \u00b7 \u00b7 \u00b7 , xn) \u2208 V n, the \u2018scalar-valued\u2019 form \u03d5nq,0 is given by applying the\noperator\nCYCLES WITH COEFFICIENTS AND MODULAR FORMS 19\nD : S(V n)\u2297\n\u2227\u2022\n(p\u2217) \u2212\u2192 S(V n)\u2297\n\u2227\u2022+nq\n(p\u2217),\nD = 1\n2nq\/2\nn\u220f\ni=1\np+q\u220f\n\u00b5=p+1\n[\np\u2211\n\u03b1=1\n(\nx\u03b1i \u2212 1\n2pi\n\u2202\n\u2202x\u03b1i\n)\n\u2297 A(\u03c9\u03b1\u00b5)\n]\n,\nto \u03d50 \u2297 1 \u2208 [S(V n)\u2297\n\u22270(p\u2217)]K :\n\u03d5nq,0 = D(\u03d50 \u2297 1).\nNote that this is 2nq\/2 times the corresponding quantity in [KM4]. We have\n\u03d5nq,0 \u2208 C0,nq0 =\n[\nC(\u03c7\u2212m\/2)\u2297 S(V n)\u2297\n\u2227nq\n(p\u2217)\n]K\u2032\u00d7K\nHere the K-invariance is immediate, while the K \u2032-invariance is Theorem 3.1 in [KM2].\nWe let\nA = EndC\n(\nS(V n)\u2297\n\u2227\u2022\n(p\u2217)\u2297 T (V )\n)\n,\nwhere T (V ) =\n\u2295\u221e\n`=0 T\n`(V ) denotes the (complexified) tensor algebra of V . Note that\nA is an associative C-algebra by composition. We now define for 1 \u2264 i \u2264 n another\ndifferential operator Di \u2208 A by\nDi = 1\n2\np\u2211\n\u03b1=1\n(\nx\u03b1i \u2212 1\n2pi\n\u2202\n\u2202x\u03b1i\n)\n\u2297 1\u2297 A(e\u03b1).\nHere A(e\u03b1) denotes the left multiplication by e\u03b1 in T (V ). Note that the operator Di\nis clearly K-invariant. We introduce a homomorphism T : Cn \u2192 A by\nT (\u000fi) = Di,\nwhere \u000f1, . . . , \u000fn denotes the standard basis of Cn. Let m` : T `A \u2192 A be the `-fold\nmultiplication. We now define\nT` : T `(Cn) \u2212\u2192 A\nby\nT` = m` \u25e6\n(\u2297\n`T\n)\n.\nWe identify\nHomC\n(\nW`,S(V n)\u2297\n\u2227nq\n(p\u2217)\u2297 T `(V )\n)\n' W \u2217` \u2297 S(V n)\u2297\n\u2227nq\n(p\u2217)\u2297 T `(V ),\nand use the same symbols for corresponding objects.\nDefinition 5.1. We define\n\u03d5qn,` \u2208 HomC\n(\nW`,S(V n)\u2297\n\u2227nq\n(p\u2217)\u2297 T `(V )\n)K\nby\n\u03d5nq,`(w) = T`(w)\u03d5nq,0\nfor w \u2208 T `(Cn). We put \u03d5nq,` = 0 for ` < 0.\n20 JENS FUNKE AND JOHN MILLSON\nNote that the symmetric group S` on ` letters is acting on T\n`(Cn) and T `(V ) in\nthe natural fashion. We will now show that \u03d5nq,` is an equivariant map with respect\nto S`. More precisely, we have\nProposition 5.2.\n\u03d5nq,` \u2208 HomC\n(\nW`,S(V n)\u2297\n\u2227nq\n(p\u2217)\u2297 T `(V )\n)S`\u00d7K\n,\nthat is, for any s \u2208 S`, we have\n\u03d5nq,` \u25e6 s = (1\u2297 1\u2297 s)\u03d5nq,`.\nProof. We first need\nLemma 5.3. Let s \u2208 S`. Then\nT` \u25e6 s = (1\u2297 1\u2297 s) \u25e6 T`.\nProof. Let i1, i2, . . . , i` \u2208 {1, . . . , n}. Then(\u2297\n`T\n)\n(s(\u000fi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000fi`)) = s (T (\u000fi1)\u2297 \u00b7 \u00b7 \u00b7 \u2297 T (\u000fi`)) ,\nwhere s on the right hand side permutes the factors of A\u2297 \u00b7 \u00b7 \u00b7 \u2297 A. Hence\nT` (s(\u000fi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000fi`)) = m` (s (T (\u000fi1)\u2297 \u00b7 \u00b7 \u00b7 \u2297 T (\u000fi`))) ,\nthus T` (s(\u000fi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000fi`)) takes the factors of\n(\u2297\n`T\n)\n(s(\u000fi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000fi`)), permutes\nthem according to s and then multiplies them in A. The product T`(\u000fi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000fi`) is\na sum of tensor products of products of certain differential operators in S(V n) with\nproducts of the e\u03b1\u2019s in T (V ). But the differential operators in S(V n) commute with\neach other so that the rearrangement of the Di\u2019s has no effect on this factor in the\ntensor product. Hence s only acts on the third factor of S(V n)\u2297\u2227nq(p\u2217)\u2297T `(V ). \u0003\nThe proposition now follows easily. For w \u2208 T `(Cn), we have\n\u03d5nq,`(sw) = T`(sw)\u03d5nq,0 = ((1\u2297 1\u2297 s)T`(w))\u03d5nq,0 = (1\u2297 1\u2297 s) (T`(w)\u03d5nq,0) .\n\u0003\nThis will now enable us to define the Schwartz forms \u03d5nq,[\u03bb]. We first note\nLemma 5.4. For any standard filling t(\u03bb) of D(\u03bb), the composition\n(1\u2297 1\u2297 pit(\u03bb)) \u25e6 \u03d5nq,` : T `Cn \u2212\u2192 S(V n)\u2297\n\u2227nq\n(p\u2217)\u2297 St(\u03bb)(V )\ndescends to a map\npit(\u03bb)T\n`(Cn) \u2212\u2192 S(V n)\u2297\n\u2227nq\n(p\u2217)\u2297 pit(\u03bb)T `(V ).\nProof. We have (1\u2297 1\u2297 sf(\u03bb))2 = 1\u2297 1\u2297 sf(\u03bb). Since \u03d5nq,` is equivariant with respect\nto S`, we have\n(1\u2297 1\u2297 pif(\u03bb)) \u25e6 \u03d5nq,`(w1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 w`) = (1\u2297 1\u2297 pif(\u03bb)) \u25e6 \u03d5nq,`(pif(\u03bb)(w1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 w`))\nfor all wi \u2208 Cn, 1 \u2264 i \u2264 `. \u0003\nCYCLES WITH COEFFICIENTS AND MODULAR FORMS 21\nWe use the lemma for the standard filling t0(\u03bb) to introduce \u03d5nq,[\u03bb].\nDefinition 5.5. We define\n\u03d5nq,[\u03bb] \u2208 HomC\n(\nS\u03bb(Cn),S(V n)\u2297\n\u2227nq\n(p\u2217)\u2297 S[\u03bb](V )\n)K\nby\n\u03d5nq,[\u03bb](w) = (1\u2297 1\u2297 pi[\u03bb])(\u03d5nq,`(\u03b9\u03bb(w)),\nthe projection onto S[\u03bb](V ), the harmonic tensors in S\u03bb(V ).\n5.3. Fundamental Properties of the Schwartz forms. We will now state the\nfour basic properties of our Schwartz forms. These are:\n\u2022 K \u2032-invariance; thus \u03d5nq,` \u2208 C0,nq`\n\u2022 d-closedness; thus \u03d5nq,` defines a cohomology class [\u03d5nq,`]\n\u2022 The holomorphicity of [\u03d5nq,[\u03bb]]\n\u2022 A recursion formula relating [\u03d5nq,`] to [\u03d5nq,`\u22121]\nThe first three properties are the generalizations of the properties of \u03d5nq,0 in [KM2,\nKM3, KM4], the trivial coefficient case. Except for the K \u2032-invariance, we will reduce\nthe statements to the case of n = 1. Our main tool in proving these properties will be\nthen the Fock model of the Weil representation. We will carry out the proofs for the\nK \u2032-invariance and for the other statements in the case of n = 1 in the next section.\nTheorem 5.6. The forms \u03d5nq,` and \u03d5nq,[\u03bb] are K\n\u2032-invariant, i.e.,\n\u03d5nq,` \u2208 C0,nq` = [W \u2217` \u2297 S(V n)\u2297\n\u2227nq\n(p\u2217)\u2297 T `(V )]K\u2032\u00d7K\nand\n\u03d5nq,[\u03bb] \u2208 C0,nq[\u03bb] = [W \u2217\u03bb\u2032 \u2297 S(V n)\u2297\n\u2227nq\n(p\u2217)\u2297 S[\u03bb](V )]K\u2032\u00d7K .\nIn particular, for n = 1, we have\n\u03d5q,` \u2208\n[\nC(\u03c7\u2212`\u2212m\/2)\u2297 S(V )\u2297\n\u2227q\n(p\u2217)\u2297 T `(V )\n]K\u2032\u00d7K\n.\nProof. We consider the first statement using the Fock model in the next section. The\nsecond statement follows from the first by projecting onto S[\u03bb](V ). \u0003\nThe K \u2032-invariance of the Schwartz forms will enable us in Section 7 to construct\ntheta series using the forms \u03d5nq,[\u03bb].\nTheorem 5.7. The forms \u03d5nq,` and \u03d5nq,[\u03bb] define closed differential forms on D, i.e.,\nd\u03d5nq,`(x) = 0\nfor all x \u2208 V n. In particular, \u03d5nq,[\u03bb](x) defines a (de Rham) cohomology class\n[\u03d5nq,[\u03bb](x)] \u2208 Hnq\n(\nD,HomC(S\u03bb(Cn), S[\u03bb](V ))\n)\n.\n22 JENS FUNKE AND JOHN MILLSON\nProof. We will prove the case n = 1 in the next section using the Fock model of the\nWeil representation. For general n, it is enough to show that \u03d5nq,`(\u000fi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000fi`) is\nclosed for any n-tuple (\u000fi1 , . . . , \u000fi`). By the S`-equivariance of \u03d5nq,` we can assume\nthat i1 \u2264 \u00b7 \u00b7 \u00b7 \u2264 i`, so that \u000fi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000fi` = \u000f\u2297`11 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000f\u2297`nn for some non-negative\nintegers `1, . . . , `n. But this implies that\n\u03d5nq,`(\u000f\n\u2297`1\n1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000f\u2297`nn )(x) = \u03d5q,`1(x1) \u2227 \u00b7 \u00b7 \u00b7 \u2227 \u03d5q,`n(xn).\nHere the wedge \u2227 means the usual wedge for A(D) and the tensor product in the\nother slots. This reduces the closedness of \u03d5nq,` to the case n = 1. \u0003\nTo state the last two properties of the forms \u03d5nq,[\u03bb], we first need to introduce some\nmore notation. We define a map\n\u03c3 : Cn \u2212\u2192 (V n)\u2217 \u2297\n\u2227\u2022\np\u2217 \u2297 V\nby\n\u03c3(\u000fi) =\nm\u2211\nj=1\nxij \u2297 1\u2297 ej.\nHere the xij, 1 \u2264 i \u2264 n, 1 \u2264 j \u2264 m are the standard coordinate functions on V n.\nThus under the identification of (V n)\u2217\u2297\u2227\u2022p\u2217\u2297V with Hom(V n,\u2227\u2022p\u2217\u2297V ) we have\n\u03c3(\u000fi)(x) =\nm\u2211\nj=1\nxij(1\u2297 ej) = 1\u2297\nm\u2211\nj=1\nxijej = 1\u2297 xi.\nNow the xij are numbers, the coordinates of the n-tuple of vectors x.\nWe let \u03c3` be the `-th outer tensor power of \u03c3, and for \u03bb a partition of [`], we put\n\u03c3\u03bb = \u03c3` \u25e6 \u03b9\u03bb : S\u03bbCn \u2212\u2192 (V n)\u2217 \u2297\n\u2227\u2022\np\u2217 \u2297 T (V ).\nNote that we do not need to distinguish between \u03bb\u2032 and \u03bb because only the nonzero\nparts of the partition matter here.\nLemma 5.8. (i) Let f be a semistandard filling of D(\u03bb). Then\n\u03c3\u03bb(\u000ff(\u03bb))(x) = 1\u2297 xf(\u03bb)\nfor any \u000f = \u000fi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000fi` \u2208 T `(Cn). In particular,\n\u03c3\u03bb : S\u03bbCn \u2212\u2192 (V n)\u2217 \u2297\n\u2227\u2022\np\u2217 \u2297 S\u03bb(V ).\n(ii) The map \u03c3\u03bb is GLn(C)-invariant, i.e., for a \u2208 GLn(C), we have\n\u03c3((a\u22121\u000f)f(\u03bb))(xa) = \u03c3(\u000ff(\u03bb))(x).\nProof. For (i), first note\n\u03c3`(\u000fi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000fi`)(x) = 1\u2297 (xi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 xi`).\nIndeed,\n\u03c3`(\u000fi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000fi`)(x) = \u03c3`(\u000fi1) \u25e6 \u00b7 \u00b7 \u00b7 \u25e6 \u03c3`(\u000fi`)(x) = (1\u2297 xi1) \u25e6 \u00b7 \u00b7 \u00b7 \u25e6 (1\u2297 xi`)\n= 1\u2297 (xi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 xi`).\nCYCLES WITH COEFFICIENTS AND MODULAR FORMS 23\nBut now for s \u2208 S` and wi \u2208 Cn, 1 \u2264 i \u2264 `, we have\n\u03c3` (s(w1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 w`)) = (1\u2297 s)\u03c3(w1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 w`),\nwhich gives immediately\n\u03c3`(\u000ff(\u03bb))(x) = 1\u2297 xf(\u03bb),\nas claimed. (ii) follows easily from \u03c3(a\u22121\u000f)(xa) = \u03c3(\u000f)(x). \u0003\nWe can therefore define \u03c3[\u03bb] by post-composing with the harmonic projection pi[\u03bb]\nonto S[\u03bb](V ), and we have\n\u03c3[\u03bb](pi\u03bb\u000ff(\u03bb))(x) = 1\u2297 x[f(\u03bb)].\nVia left multiplication we can interpret \u03c3 (and similarly \u03c3`, \u03c3\u03bb, \u03c3[\u03bb]) as a map\nfrom Cn to A (and we do not distinguish between these two interpretations). With\nthis identification and considering S(V n)\u2297\u2227\u2022p\u2217 \u2297 T (V ) as the \u2227\u2022p\u2217 \u2297 T (V )-valued\nSchwartz functions on V n, we have\n(\u03c3(\u000fi)\u03d5)(x) = (1\u2297 A(xi))\u03d5(x).\nFor v \u2208 V , we let Aj(v) : T `\u22121(V )\u2192 T `(V ) be the insertion of v into the j-th spot.\nWe let Ajk : T\n`\u22122(V )\u2192 T `\nAjk(f) =\np\u2211\n\u03b1=1\nAj(e\u03b1)Ak(e\u03b1)\u2212\np+q\u2211\n\u00b5=p+1\nAj(e\u00b5)Ak(e\u00b5)\nbe the insertion of the invariant metric into the (j, k)-th spot, and we put\nA(f) =\n1\n2\n\u2211`\nj=1\n`\u22121\u2211\nk=1\nAjk(f).\nOne of the fundamental properties of the scalar-valued Schwartz form \u03d5nq,0 is that\nfor (x,x) positive semidefinite, \u03d5nq,0(x) gives rise to a Thom form for the special cycle\nCX . In view of Lemma 4.9, we now relate \u03d5nq,[\u03bb](x) to (\u03c3[\u03bb]\u03d5nq,0)(x).\nTheorem 5.9. (i) Let n = 1 and let \u03c3j be the operator on S(V )\u2297\n\u2227\u2022\np\u2217 \u2297 T (V )\ndefined by \u03c3j(x) = 1 \u2297 1 \u2297 Aj(x). Then for each j = 1, . . . , `, we have in\ncohomology\n[\u03d5q,`] = [\u03c3j\u03d5q,`\u22121] +\n1\n4pi\n`\u22121\u2211\nk=1\n[Ajk(f)\u03d5q,`\u22122]\nfor all x \u2208 V . In particular,\n[\u03d5q,[`]] = [\u03c3[`]\u03d5q,0].\n(ii) For general n, we have in cohomology\n[\u03d5nq,[\u03bb]] = [\u03c3[\u03bb]\u03d5nq,0],\ni.e., for all semistandard fillings f ,\n[\u03d5nq,[\u03bb](\u000ff(\u03bb))(x)] =\n[\n(1\u2297 x[f(\u03bb)])\u03d5nq,0(x)\n]\n,\n24 JENS FUNKE AND JOHN MILLSON\nn where \u000f = \u000fi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000fi` \u2208 T `(Cn).\nProof. We prove (i) in the next section via the Fock model. For (ii), we first see by\n(i) that up to exact forms we have\n\u03d5nq,`(\u000f\n\u2297`1\n1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000f\u2297`nn )(x) =\n(\n\u03c3(x1)\u03d5q,`1\u22121(x1) +\n1\n4pi\n`1\u22121\u2211\nk=1\nAjk(f)\u03d5q,`1\u22121(x1)\n)\n\u2227 \u00b7 \u00b7 \u00b7\n\u2227\n(\n\u03c3(xn)\u03d5q,`n\u22121(xn) +\n1\n4pi\n`n\u22121\u2211\nk=1\nAjk(f)\u03d5q,`n\u22121(xn)\n)\n,\nand we get a similar statement for \u03d5nq,`(\u000fi1\u2297\u00b7 \u00b7 \u00b7\u2297 \u000fi`) by the S`-equivariance of \u03d5nq,`.\nIterating and using Lemma 5.8 then gives a statement for \u03d5nq,`(x) with coefficients in\nS\u03bb(V ) analogous to (ii) - up to terms coming from the metric. Projecting to S[\u03bb](V )\nnow gives the claim. \u0003\nOne of the main results of [KM4] is that the scalar-valued cohomology class [\u03d5nq,0]\nis holomorphic, i.e, [\u2202\u03d5nq,0] = 0. We will now show that the more general cohomology\nclasses [\u03d5nq,[\u03bb]] are holomorphic as well.\nFor n = 1, we have g\u2032 = sl2(C), and the anti-holomorphic tangent space p\u2212 is\nspanned by the element L = 1\n2\n(\n1 \u2212i\n\u2212i \u22121\n)\n.\nTheorem 5.10. (i) Let n = 1. Then in cohomology, we have\n[\u03c9(L)\u03d5q,`] =\n\u22121\n4pi\n[A(f)\u03d5q,`\u22122].\nIn particular,\n[\u2202\u03d5q,[`]] = 0.\n(ii) For general n, we have\n[\u2202\u03d5nq,[\u03bb]] = 0.\nProof. We will prove (i) in the next section. (ii) follows from (i) by generalizing the\nargument given for the scalar valued case in [KM4], Theorem 5.2. First note that we\nhave to show [\u2202ij\u03d5nq,[\u03bb]] = 0 for all n(n + 1)\/2 partial derivatives \u2202ij ( i \u2264 j) in p\u2212.\nBy (i), we see\n(1\u2297 1\u2297 pi[\u03bb])\u2202ii\u03d5nq,`(\u000f\u2297`11 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000f\u2297`nn ) = 0\nup to an exact form. By the S`-equivariance, we then see\n(1\u2297 1\u2297 pi[\u03bb])\u2202ii\u03d5nq,`(\u000fi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000fi`) = 0,\nagain, up to an exact form. This gives the desired vanishing for the anti- holomorphic\ntangent space p\u22120 of H\u00d7 \u00b7 \u00b7 \u00b7 \u00d7H, naturally embedded into Hn. By the K \u2032-invariance\nof \u03d5nq,` we now see that (1 \u2297 1 \u2297 c[\u03bb])\u03d5nq,` is annihilated by the AdK \u2032 orbit of p\u22120\ninside p\u2212, which is all of p\u2212. \u0003\nCYCLES WITH COEFFICIENTS AND MODULAR FORMS 25\n6. Proof of the fundamental properties of the Schwartz forms\nThe purpose of this section is to prove the K \u2032-invariance of \u03d5nq,` and for n = 1 the\nother fundamental properties of \u03d5q,` given in the previous section. Our main tool will\nbe the Fock model of the Weil representation, which we review in the appendix.\nBy abuse of notation we will frequently use in the following the same symbols for\ncorresponding objects and operators in the two models.\n6.1. The Schwartz forms in the Fock model and the K \u2032-invariance. For multi-\nindices \u03b1 = (\u03b11, \u00b7 \u00b7 \u00b7 , \u03b1q) and \u03b2 = (\u03b21, \u00b7 \u00b7 \u00b7 , \u03b2`), (usually suppressing their length), we\nwill write\n\u03c9\u03b1 = \u03c9\u03b11p+1 \u2227 \u00b7 \u00b7 \u00b7 \u2227 \u03c9\u03b1qp+q,\nz\u03b1j = z\u03b11j \u00b7 \u00b7 \u00b7 z\u03b1qj,\ne\u03b2 = e\u03b21 \u2297 \u00b7 \u00b7 \u00b7 \u2297 e\u03b2` .\nHere we have returned to our original notation, denoting the standard basis elements\nof V by e\u03b1 and e\u00b5. In the Fock model F , the \u201cscalar-valued\u201d Schwartz form \u03d5nq,0\nbecomes with this notation\n\u03d5nq,0 =\n1\n2nq\/2\n(\u2212i\n2pi\n)nq \u2211\n\u03b11,...,\u03b1n\nz\u03b111 \u00b7 \u00b7 \u00b7 z\u03b1nn\u2297\u03c9\u03b111\u2227\u00b7 \u00b7 \u00b7\u2227\u03c9\u03b1nn\u22971 \u2208 F\u2297\n\u2227nq\n(p\u2217)\u2297T 0(V )\nWe define\n\u03d50,` \u2208 HomC(T `(Cn),F \u2297\n\u22270\n(p\u2217)\u2297 T `(V ))\nby\n\u03d50,`(\u000fi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000fi`) =\n(\u2212i\n4pi\n)n`\u2211\n\u03b2\nz\u03b21i1 \u00b7 \u00b7 \u00b7 z\u03b2`i` \u2297 1\u2297 e\u03b2.\nWe then easily see\nLemma 6.1.\n\u03d5nq,` = \u03d5nq,0 \u00b7 \u03d50,`,\nwhere the multiplication is the natural one in HomC(T (Cn),F \u2297\n\u2227\u2022(p\u2217)\u2297 T (V )).\nWe should note that only in the Fock model we have such a \u201csplitting\u201d of \u03d5nq,`\ninto the product of two elements. We do not have an analogous statement in the\nSchroedinger model (only in terms of operators acting on the Gaussian \u03d50).\nTheorem 6.2 (Theorem 5.6). The form \u03d5nq,` is K\n\u2032-invariant.\nProof. We show this on the Lie algebra level. The element k\u2032 = 1\n2i\nw\u2032j \u25e6w\u2032\u2032k \u2208 k ' gln(C)\nis the endomorphism of Cn mapping \u000fj to \u000fk and annihilating the other basis elements.\nTo show \u03c9(k\u2032)\u03d5nq,` = 0, we need to show\n\u03c9(k\u2032) (\u03d5nq,`(\u000fi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000fi`)) = \u03d5nq,`(k\u2032(\u000fi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000fi`)).\n26 JENS FUNKE AND JOHN MILLSON\nFrom Lemma A.1 we see\n\u03c9(k\u2032) (\u03d5nq,`(\u000fi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000fi`)) = \u03c9(k\u2032)\u03d5nq,0 \u00b7 \u03d50,`(\u000fi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000fi`)\n+ \u03d5nq,0 \u00b7\np\u2211\n\u03b1=1\nz\u03b1k\n\u2202\n\u2202z\u03b1j\n(\u03d50,`(\u000fi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000fi`)) .\nWe have \u03c9(k\u2032)\u03d5nq,0 = 0, since \u03d5nq,0 \u2208\n[\nC(\u03c7\u2212m\/2)\u2297F \u2297\n\u2227nq(p\u2217)]K\u2032 by [KM2], Theo-\nrem 5.1. On the other hand, one easily sees\np\u2211\n\u03b1=1\nz\u03b1k\n\u2202\n\u2202z\u03b1j\n(\u03d50,`(\u000fi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000fi`)) = \u03d50,`(k\u2032(\u000fi1 \u2297 \u00b7 \u00b7 \u00b7 \u2297 \u000fi`)).\nThe assertion follows. \u0003\n6.2. The Schwartz forms for n = 1. For n = 1, we consider the forms \u03d5q,`, \u03d5q,0,\nand \u03d50,` to be in F \u2297\n\u2227\u2022(p\u2217)\u2297 T (V ), and we have\n\u03d5q,` = cq,`\n\u2211\n\u03b1,\u03b2\nz\u03b1z\u03b2 \u2297 \u03c9\u03b1 \u2297 e\u03b2.\nHere cq,` = 2\nq\/2(\u2212i\/4pi)q+`. Also\n\u03d5q,0 = 2\nq\/2(\u2212i\/4pi)q\n\u2211\n\u03b1\nz\u03b1 \u2297 \u03c9\u03b1 \u2297 1 and \u03d50,` = (\u2212i\/4pi)`\n\u2211\n\u03b2\nz\u03b2 \u2297 1\u2297 e\u03b2.\nFor later use, we note that Theorem 6.2 for n = 1 boils down to\n(6.1)\np\u2211\n\u03b1=1\n(\nz\u03b1\n\u2202\n\u2202z\u03b1\n\u2297 1\u2297 1\n)\n\u03d5q,` = (q + `)\u03d5q,`,\nwhich follows directly from\n(6.2)\np\u2211\n\u03b1=1\nz\u03b1\n\u2202\n\u2202z\u03b1\n\u03d5q,0 = q \u03d5q,0 and\np\u2211\n\u03b1=1\nz\u03b1\n\u2202\n\u2202z\u03b1\n\u03d50,` = ` \u03d50,`.\n6.3. Closedness. Similarly to the Schroedinger model, the differentiation d in the\nLie algebra complex F \u2297\u2227 \u2217(p\u2217)\u2297 S`(V ) is given by d = dF + dV with\ndF =\n\u2211\n\u03b1,\u00b5\n\u03c9(X\u03b1\u00b5)\u2297 A(\u03c9\u03b1\u00b5)\u2297 1 and dV =\n\u2211\n\u03b1,\u00b5\n1\u2297 A(\u03c9\u03b1\u00b5)\u2297 \u03c1(X\u03b1\u00b5).(6.3)\nFurthermore, we write dF = d\u2032F + d\n\u2032\u2032\nF with\nd\u2032F = \u22124pi\n\u2211\n\u03b1,\u00b5\n\u22022\n\u2202z\u03b1\u2202z\u00b5\n\u2297 A(\u03c9\u03b1\u00b5)\u2297 1,(6.4)\nd\u2032\u2032F =\n1\n4pi\n\u2211\n\u03b1,\u00b5\nz\u03b1z\u00b5 \u2297 A(\u03c9\u03b1\u00b5)\u2297 1.\nCYCLES WITH COEFFICIENTS AND MODULAR FORMS 27\nTheorem 6.3 (Theorem 5.7). The form \u03d5q,` is closed. More precisely,\nd\u2032F\u03d5q,` = d\n\u2032\u2032\nF\u03d5q,` = 0\nand\ndV \u03d5q,` = 0.\nProof. First note that d\u2032F\u03d5q,` = 0 is obvious from (6.4). From the \u2018scalar-valued\u2019 case,\nsee [KM2], we have dF\u03d5q,0 = d\u2032\u2032F\u03d5q,0 = 0. In fact, this can be seen directly by (6.4),\nsince one easily checks\n(6.5)\n\u2211\n\u03b1\n(z\u03b1 \u2297 A(\u03c9\u03b1\u00b5)\u2297 1)\u03d5q,0 = 0\nfor any \u00b5. We then easily see\nd\u2032F\u03d5q,` = (d\n\u2032\nF\u03d5q,0) \u00b7 \u03d50,` = 0.\nFor the action of dV , we first note\n(6.6) (1\u2297 1\u2297 \u03c1(X\u03b1\u00b5))\u03d50,` = \u2212i\n4pi\n\u2211`\nk=1\n(z\u03b1 \u2297 1\u2297 Ak(e\u00b5))\u03d50,`\u22121.\n(6.3) then implies\ndV \u03d5q,` =\n\u2212i\n4pi\n\u2211\n\u03b1,\u00b5\n\u2211`\nk=1\n(z\u03b1 \u2297 A(\u03c9\u03b1\u00b5)\u2297 1)\u03d5q,0 \u00b7 (1\u2297 1\u2297 Ak(e\u00b5))\u03d50,`\u22121 = 0\nby (6.5). \u0003\n6.4. Recursion. We will now show Theorem 5.9(i), the recursive formula for the\ncohomology class [\u03d5q,`].\nFor j \u2265 1, we define operators Aj(\u03c3) by\nAj(\u03c3) = i\n\u2211\n\u03b1\n(\n\u2202\n\u2202z\u03b1\n\u2212 1\n4pi\nz\u03b1\n)\n\u2297 1\u2297 Aj(e\u03b1) \u2212 i\n\u2211\n\u00b5\n(\n\u2202\n\u2202z\u00b5\n\u2212 1\n4pi\nz\u00b5\n)\n\u2297 1\u2297 Aj(e\u00b5).\nWe write A(\u03c3) = A1(\u03c3), and by (A.3) we note that this is the image in the Fock\nmodel of the operator A(\u03c3) in the Schroedinger model.\nFor j \u2265 1, we introduce operators h\u2032j by\nh\u2032j =\n\u2211\n\u03b1,\u00b5\n\u2202\n\u2202z\u03b1\n\u2297 A\u2217(\u03c9\u03b1\u00b5)\u2297 Aj(e\u00b5).\nWe write h\u2032 = h\u20321. Here A\n\u2217(\u03c9\u03b1\u00b5) denotes the (interior) multiplication with X\u03b1\u00b5, i.e.,\nA\u2217(\u03c9\u03b1\u00b5)(\u03c9\u03b1\u2032\u00b5\u2032) = \u03b4\u03b1\u03b1\u2032\u03b4\u00b5\u00b5\u2032 . We define a (q \u2212 1)-form \u039b(j)q,` by\n\u039b\n(j)\nq,` =\n\u2212i\np+ q + `\u2212 1h\n\u2032\nj\u03d5q,`.\nWe write \u039bq,` = \u039b\n(1)\nq,` .\n28 JENS FUNKE AND JOHN MILLSON\nTheorem 6.4 (Theorem 5.9). For any 1 \u2264 j \u2264 `, we have\n\u03d5q,` = Aj(\u03c3)\u03d5q,`\u22121 + d\u039b\n(j)\nq,`\u22121 +\n1\n4pi\n`\u22121\u2211\nk=1\nAjk(f)\u03d5q,`\u22122.\nFor the proof of Theorem 6.4, we first compute Aj(\u03c3)\u03d5q,`\u22121:\nLemma 6.5. For any 1 \u2264 j \u2264 `, we have\nAj(\u03c3)\u03d5q,`\u22121 = \u03d5q,` + Aj + Bj + C+j .\nHere\nAj =\ni\n4pi\n(\np+q\u2211\n\u00b5=p+1\nz\u00b5 \u2297 1\u2297 Aj(e\u00b5)\n)\n\u03d5q,`\u22121,\nBj = i\np\u2211\n\u03b1=1\n(\n\u2202\n\u2202z\u03b1\n\u2297 1\u2297 1)\u03d5q,0 \u00b7 (1\u2297 1\u2297 Aj(e\u03b1))\u03d50,`\u22121,\nC+j =\n1\n4pi\n`\u22121\u2211\nk=1\nAjk(f+)\u03d5q,`\u22122,\nwhere Ajk(f+) is the insertion\n\u2211p\n\u03b1=1 Aj(e\u03b1)Ak(e\u03b1) in the j-th and k-th position in\nT (V ).\nProof. We write Aj(\u03c3) = A\n\u2032\nj(\u03c3) + A\n\u2032\u2032\nj (\u03c3) with A\n\u2032\nj(\u03c3) =\n\u2212i\n4pi\n\u2211\n\u03b1 z\u03b1 \u2297 1 \u2297 Aj(e\u03b1) +\ni\n4pi\n\u2211\n\u00b5 z\u00b5 \u2297 1\u2297 Aj(e\u00b5). We immediately see\nA\u2032j(\u03c3)\u03d5q,`\u22121 = \u03d5q,` + Aj.\nOn the other hand, we have\nA\u2032\u2032j (\u03c3)\u03d5q,`\u22121 = i\np\u2211\n\u03b1=1\n(\n\u2202\n\u2202z\u03b1\n\u2297 1\u2297 Aj(e\u03b1))(\u03d5q,0 \u00b7 \u03d50,`\u22121)\n= Bj + i\u03d5q,0 \u00b7\n(\np\u2211\n\u03b1=1\n(\n\u2202\n\u2202z\u03b1\n\u2297 1\u2297 Aj(e\u03b1))\n)\n\u03d50,`\u22121.\nBut the last term is equal to C+j . Indeed, a little calculation gives\n(6.7) (\n\u2202\n\u2202z\u03b1\n\u2297 1\u2297 1)\u03d50,`\u22121 = \u2212i\n4pi\n`\u22121\u2211\nk=1\n(1\u2297 1\u2297 Ak(e\u03b1))\u03d50,`\u22122,\nfrom which the claim follows. \u0003\nTherefore Theorem 6.4 will follow from\nProposition 6.6. For any 1 \u2264 j \u2264 `, we have\nd\u039b\n(j)\nq,`\u22121 = \u2212(Aj +Bj + C\u2212j ),\nCYCLES WITH COEFFICIENTS AND MODULAR FORMS 29\nwhere\nC\u2212 =\n1\n4pi\n`\u22121\u2211\nk=1\nAjk(f\u2212)\u03d5q,`\u22122\nwith Ajk(f\u2212) =\n\u2211p\n\u00b5=1 Aj(e\u00b5)Ak(e\u00b5).\nProof. Since \u03d5q,`\u22121 is closed, we have\n(p+ q + `\u2212 2)d\u039bq,`\u22121 = dh\u2032j\u03d5q,`\u22121 = {d, h\u2032j}\u03d5q,`\u22121,\nwhere {A,B} denotes the anticommutator AB +BA. It is easy to see that\n{d\u2032F , h\u2032j}\u03d5q,`\u22121 = 0,\nso that we only need to compute {d\u2032\u2032F , h\u2032j} and {dV , h\u2032j}.\nLemma 6.7. As operators on F \u2297\u2227 \u2022(p\u2217)\u2297 T (V ),\n(i) 4pii{d\u2032\u2032F , h\u2032j} =\n\u2211\n\u03b1,\u00b5\nz\u00b5\n\u2202\n\u2202z\u03b1\nz\u03b1 \u2297 1\u2297 Aj(e\u00b5) \u2212\n\u2211\n\u00b5,\u03bd\nz\u00b5 \u2297D\u00b5\u03bd \u2297 Aj(e\u03bd).\n(ii) i{dV , h\u2032j} =\n\u2211\n\u03b1,\u00b5\n\u2202\n\u2202z\u03b1\n\u2297 1\u2297 Aj(e\u00b5)\u03c1(X\u03b1\u00b5) +\n\u2211\n\u03b1,\u03b2\n\u2202\n\u2202z\u03b2\n\u2297D\u03b1\u03b2 \u2297 Aj(e\u03b1).\nHere the operators D\u03b1\u03b2 and D\u00b5\u03bd are the derivations of\n\u2227 \u2022(p\u2217) determined by\nD\u03b1\u03b2\u03c9\u03b3\u00b5 = \u03b4\u03b2\u03b3\u03c9\u03b1\u00b5 and D\u00b5\u03bd\u03c9\u03b1\u03bb = \u03b4\u03bb\u03bd\u03c9\u03b1\u00b5.\nProof. For (i), using the definitions of the operators and \u2202\n\u2202z\u03b2\nz\u03b1 = z\u03b1\n\u2202\n\u2202z\u03b2\n+ \u03b4\u03b1\u03b2, we\neasily see\n4pii{d\u2032\u2032F , h\u2032j} =\n\u2211\n\u03b1,\u00b5\n\u03b2,\u03bd\nz\u00b5z\u03b1\n\u2202\n\u2202z\u03b2\n\u2297 {A\u03b1\u00b5, A\u2217\u03b2\u03bd} \u2297 Aj(e\u03bd) + \u03b4\u03b1\u03b2z\u00b5 \u2297 A\u2217\u03b2\u03bdA\u03b1\u00b5 \u2297 Aj(ev).\nHere and in the following we write A\u03b1,\u00b5 for A(\u03c9\u03b1,\u00b5). The Clifford identities imply\n{A\u03b1\u00b5, A\u2217\u03b2\u03bd} = \u03b4\u03b1\u03b2\u03b4\u00b5\u03bd\nand\nA\u2217\u03b1\u03bdA\u03b1\u00b5 =\n{\nI \u2212 A\u03b1\u00b5A\u2217\u03b1\u03bd , if \u00b5 = \u03bd\n\u2212A\u03b1\u00b5A\u2217\u03b1\u03bd , if \u00b5 6= \u03bd.\nNote\n(6.8)\n\u2211\n\u03b1\nA\u03b1\u00b5A\n\u2217\n\u03b1\u03bd = D\u00b5\u03bd and\n\u2211\n\u00b5\nA\u03b1\u00b5A\n\u2217\n\u03b2\u00b5 = D\u03b1\u03b2.\nWe therefore obtain\u2211\n\u03b1,\u00b5\nz\u00b5\n(\nz\u03b1\n\u2202\n\u2202z\u03b1\n+ 1\n)\n\u2297 1\u2297 Aj(e\u00b5) \u2212\n\u2211\n\u03b1,\u00b5,\u03bd\nz\u00b5 \u2297 A\u03b1\u00b5A\u2217\u03b1\u03bd \u2297 Aj(e\u03bd),\nand the assertion follows from (6.8).\n30 JENS FUNKE AND JOHN MILLSON\nFor (ii), first note \u03c1(X\u03b1\u00b5)Aj(e\u03bd) = \u03b4\u00b5\u03bdAj(e\u03b1) + Aj(ev)\u03c1(X\u03b1\u00b5). One then obtains\n{dV , h\u2032j} =\n\u2211\n\u03b1,\u00b5\n\u03b2,\u03bd\n\u2202\n\u2202z\u03b2\n\u2297 {A\u03b1\u00b5, A\u2217\u03b2\u03bd} \u2297 Aj(ev)\u03c1(X\u03b1\u00b5) +\n\u2202\n\u2202z\u03b2\n\u2297 A\u03b1\u00b5A\u2217\u03b2\u03bd \u2297 \u03b4\u00b5\u03bdAj(e\u03b1)\n=\n\u2211\n\u03b1,\u00b5\n\u2202\n\u2202z\u03b1\n\u2297 1\u2297 Aj(e\u00b5)\u03c1(X\u03b1\u00b5) +\n\u2211\n\u03b1,\u03b2\n\u2202\n\u2202z\u03b2\n\u2297D\u03b1\u03b2 \u2297 Aj(e\u03b1),\nby (6.8). \u0003\nProposition 6.6 now follows from\nLemma 6.8.\n(i) {d\u2032\u2032F , h\u2032j}\u03d5q,`\u22121 = \u2212(p+ q + `\u2212 2)Aj.\n(ii) {dV , h\u2032j}\u03d5q,`\u22121 = \u2212(p+ q + `\u2212 2)(Bj + C\u2212j ).\nProof. We use Lemma 6.7. For (i), we first have\u2211\n\u03b1,\u00b5\n(\nz\u00b5\n\u2202\n\u2202z\u03b1\nz\u03b1 \u2297 1\u2297 Aj(e\u00b5)\n)\n\u03d5q,`\u22121 = (p+ q + `\u2212 1)\n(\u2211\n\u00b5\nz\u00b5 \u2297 1\u2297 Aj(e\u00b5)\n)\n\u03d5q,`\u22121\n= \u22124pii(p+ q + `\u2212 1)Aj,\nwhich follows immediately from\n(6.9)\u2211\n\u03b1\n(\n\u2202\n\u2202z\u03b1\nz\u03b1 \u2297 1\u2297 1\n)\n\u03d5q,`\u22121 =\n\u2211\n\u03b1\n(\n(z\u03b1\n\u2202\n\u2202z\u03b1\n+ 1)\u2297 1\u2297 1\n)\n\u03d5q,`\u22121 = (p+q+`\u22121)\u03d5q,`\u22121\nby (6.1). Furthermore, by [KM4], Lemma 8.2 we have\n(1\u2297D\u00b5\u03bd \u2297 1)\u03d5q,0 = \u03b4\u00b5\u03bd\u03d5q,0,\nand therefore\u2211\n\u00b5,\u03bd\n(z\u00b5 \u2297D\u00b5\u03bd \u2297 Aj(e\u03bd))\u03d5q,`\u22121 =\n\u2211\n\u00b5,\u03bd\n(1\u2297D\u00b5\u03bd \u2297 1)\u03d5q,0 \u00b7 (z\u00b5 \u2297 1\u2297 Aj(e\u03bd))\u03d50,`\n=\n(\u2211\n\u00b5\nz\u00b5 \u2297 1\u2297 Aj(e\u00b5)\n)\n\u03d5q,`\u22121 = \u22124piiAj.\nLemma 6.7 now gives (i). For (ii), by (6.6) we first note\n(6.10) (1\u2297 1\u2297 \u03c1(X\u03b1\u00b5)\u03d5q,`\u22121 = \u2212i\n4pi\n`\u22121\u2211\nk=1\n(z\u03b1 \u2297 1\u2297 Ak(e\u00b5))\u03d5q,`\u22122.\nThus, using (6.9), we see\u2211\n\u03b1,\u00b5\n(\n\u2202\n\u2202z\u03b1\n\u2297 1\u2297 Aj(e\u00b5)\u03c1(X\u03b1\u00b5)\n)\n\u03d5q,`\u22121 =\n\u2212i\n4pi\n(\n`\u22121\u2211\nk=1\nAjk(f\u2212)\n)\n(p+ q + `\u2212 2)\u03d5q,`\u22122\n= \u2212i(p+ q + `\u2212 2)C\u2212j .\nCYCLES WITH COEFFICIENTS AND MODULAR FORMS 31\nFinally, by [KM4], Lemma 8.2, we have\n(1\u2297D\u03b1\u03b2 \u2297 1)\u03d5q,0 = (z\u03b2 \u2202\n\u2202z\u03b1\n\u2297 1\u2297 1)\u03d5q,0.\nHence \u2211\n\u03b1,\u03b2\n(\n\u2202\n\u2202z\u03b2\n\u2297D\u03b1\u03b2 \u2297 Aj(e\u03b1)\n)\n\u03d5q,`\u22121(6.11)\n=\n\u2211\n\u03b1,\u03b2\n(\n\u2202\n\u2202z\u03b2\nz\u03b2 \u2297 1\u2297 Aj(e\u03b1)\n)\n((\n\u2202\n\u2202z\u03b1\n\u2297 1\u2297 1)\u03d5q,0) \u00b7 \u03d50,`\u22121\n=\n\u2211\n\u03b1,\u03b2\n((\n\u2202\n\u2202z\u03b2\nz\u03b2\n\u2202\n\u2202z\u03b1\n\u2297 1\u2297 1\n)\n\u03d5q,0\n)\n\u00b7 (1\u2297 1\u2297 Aj(e\u03b1))\u03d50,`\u22121\n+\n\u2211\n\u03b1,\u03b2\n((\n\u2202\n\u2202z\u03b1\n\u2297 1\u2297 1)\u03d5q,0) \u00b7\n(\n\u2202\n\u2202z\u03b2\nz\u03b2 \u2297 1\u2297 Aj(e\u03b1)\n)\n\u03d50,`\u22121,\nThe second term, using (6.9), is equal to \u2212i(`\u2212 1)B, while for the first we have\u2211\n\u03b1,\u03b2\n((\n\u2202\n\u2202z\u03b2\n(\n\u2202\n\u2202z\u03b1\nz\u03b2 \u2212 \u03b4\u03b1\u03b2)\u2297 1\u2297 1\n)\n\u03d5q,0\n)\n\u00b7 (1\u2297 1\u2297 Aj(e\u03b1))\u03d50,`\u22121,\nand this, using (6.9) again, equals to \u2212i(p+q\u22121)B. This finishes the proof of (ii). \u0003\nThis concludes the proof of Proposition 6.6 and hence the proof of Theorem 6.4! \u0003\n6.5. Holomorphicity. We will now show Theorem 5.10(i), i.e., that the cohomology\nclass [\u03d5q,[`]] is holomorphic.\nFollowing [KM4], we define another operator h on F \u2297\u2227\u2022(p\u2217)\u2297 S\u2022(V ) by\nh =\n\u2211\n\u03b1,\u00b5\nz\u00b5\n\u2202\n\u2202z\u03b1\n\u2297 A\u2217(\u03c9\u03b1\u00b5)\u2297 1.\nDefinition 6.9. We introduce a (q \u2212 1)-form \u03c8q,` by\n\u03c8q,` :=\n\u22121\n2(p+ q \u2212 1) (h\u03d5q,0) \u00b7 \u03d50,`.\nIt will be convenient to note that we could have also defined \u03c8q,` by letting h act\non \u03d5q,`:\nLemma 6.10.\n\u03c8q,` =\n\u22121\n2(p+ q + `\u2212 1)h\u03d5q,`.\n32 JENS FUNKE AND JOHN MILLSON\nProof. We have\nh\u03d5q,` = (h\u03d5q,0) \u00b7 \u03d50,` +\n\u2211\n\u03b1,\u00b5\n(z\u00b5 \u2297 A\u2217(\u03c9\u03b1\u00b5)\u2297 1)\u03d5q,0 \u00b7 ( \u2202\n\u2202z\u03b1\n\u2297 1\u2297 1)\u03d50,`(6.12)\n= (h\u03d5q,0) \u00b7 \u03d50,` \u2212 i\n4pi\n\u2211`\nj=1\nh\u2032\u2032j\u03d5q,`\u22121,(6.13)\nwith h\u2032\u2032j =\n\u2211\n\u03b1,\u00b5 z\u00b5 \u2297 A\u2217(\u03c9\u03b1\u00b5)\u2297 Aj(e\u03b1). But now one easily checks that\n\u22121\n4pi\nh\u2032\u2032j\u03d5q,`\u22121 = \u03d5\n\u2032\nq,0 \u00b7 \u03d50,`\nwith\n\u03d5\u2032q,0 =\n\u2211\n\u00b5,\u03b11,...,\u03b1q\u22121\n(\u22121)\u00b5\u2212p\u22121z\u00b5z\u03b1 \u2297 \u03c9\u03b11p+1 \u2227 \u00b7 \u00b7 \u00b7 \u2227 \u03c9\u0302\u03b1\u00b5\u2212p\u00b5 \u2227 \u00b7 \u00b7 \u00b7\u03c9\u03b1q\u22121p+q \u2297 1.\nOn the other hand, we also compute\nh\u03d5q,0 = (p+ q \u2212 1)\u03d5\u2032q,0.\nFrom this the lemma follows. \u0003\nTheorem 6.11 (Theorem 5.10). The action of the lowering operator L on \u03d5q,` is\ngiven by\n\u03c9(L)\u03d5q,` = d\n(\n\u03c8q,` +\n1\n2\n\u2211`\nj=1\n\u039b\n(j)\nq,`\u22121\n)\n\u2212 1\n4pi\nA(f)\u03d5q,`\u22122.\nRemark 6.12. This theorem is the generalization of one of the main points in [KM4]\nfor ` = 0, the trivial coefficient case. Namely, [KM4], Lemma 8.3 states\n(6.14) \u03c9(L)\u03d5q,0 = d\u03c8q,0.\nProof of Theorem 6.11. We first compute the left hand side:\nLemma 6.13.\n\u03c9(L)\u03d5q,` = (\u03c9(L)\u03d5q,0) \u00b7 \u03d50,` \u2212\n\u2211`\nj=1\nBj \u2212 1\n4pi\nA(f+)\u03d5q,`\u22122,\nwith Bj as in Lemma 6.5.\nCYCLES WITH COEFFICIENTS AND MODULAR FORMS 33\nProof. By Lemma A.1 we have\n\u03c9(L)\u03d5q,` =\n\u22121\n8pi\n\u2211\n\u00b5\n(\nz2\u00b5 \u2297 1\u2297 1\n)\n\u03d5q,`(6.15)\n+ 2picq,`\n\u2211\n\u03b3\n\u03b1,\u03b2\n(\n\u22022\n\u2202z2\u03b3\nz\u03b1\n)\nz\u03b2 \u2297 \u03c9\u03b1 \u2297 e\u03b2(6.16)\n+ 4picq,`\n\u2211\n\u03b3\n\u03b1,\u03b2\n(\n\u2202\n\u2202z\u03b3\nz\u03b1\n)(\n\u2202\n\u2202z\u03b3\nz\u03b2\n)\n\u2297 \u03c9\u03b1 \u2297 e\u03b2(6.17)\n+ 2picq,`\n\u2211\n\u03b3\n\u03b1,\u03b2\nz\u03b1\n(\n\u22022\n\u2202z2\u03b3\nz\u03b2\n)\n\u2297 \u03c9\u03b1 \u2297 e\u03b2.(6.18)\nThe first two terms ((6.15) and (6.16) give (\u03c9(L)\u03d5q,0) \u00b7 \u03d50,`. By (6.7), the third term\n(6.17) is equal to\n\u2212i\n\u2211\n\u03b3\n(\n\u2202\n\u2202z\u03b3\n\u2297 1\u2297 1\n)\n\u03d5q,0 \u00b7\n\u2211`\nj=1\n(1\u2297 1\u2297 Aj(e\u03b3))\u03d50,`\u22121 = \u2212\n\u2211`\nj=1\nBj.\nFor the fourth term (6.18) in the sum above, we apply (6.7) twice and obtain\n\u2212i\n2\n\u03d5q,0 \u00b7\n\u2211`\nj=1\n\u2211\n\u03b3\n(\n\u2202\n\u2202z\u03b3\n\u2297 1\u2297 Aj(e\u03b3)\n)\n\u03d50,`\u22121\n=\n\u22121\n8pi\n\u03d5q,0 \u00b7\n\u2211`\nj=1\n`\u22121\u2211\nk=1\n\u2211\n\u03b3\n(1\u2297 1\u2297 Aj(e\u03b3)Ak(e\u03b3))\u03d50,`\u22122 = \u22121\n4pi\nA(f+)\u03d50,`\u22122.\n\u0003\nWe now compute d\u03c8q,`:\nLemma 6.14.\n(i) dF\u03c8q,` = (dF\u03c8q,0) \u00b7 \u03d50,` \u2212 1\n2\n\u2211`\nj=1\nBj.\n(ii) dV \u03c8q,` =\n1\n2\n\u2211`\nj=1\nAj.\nwith Aj and Bj as in Lemma 6.5.\nProof. For (i), we first observe\n(6.19) d\u2032\u2032F ((h\u03d5q,0) \u00b7 \u03d50,`) = (d\u2032\u2032Fh\u03d5q,0) \u00b7 \u03d50,`.\n34 JENS FUNKE AND JOHN MILLSON\nFor d\u2032F we get\nd\u2032F ((h\u03d5q,0) \u00b7 \u03d50,`) = \u22124pi\n\u2211\n\u03b1,\u00b5\n(\n\u2202\n\u2202z\u03b1\n\u2297 1\u2297 1\n)[((\n\u2202\n\u2202z\u00b5\n\u2297 A\u03b1\u00b5 \u2297 1\n)\nh\u03d5q,0\n)\n\u00b7 \u03d50,`\n]\n= (d\u2032Fh\u03d5q,0) \u00b7 \u03d50,`(6.20)\n\u2212 4pi\n\u2211\n\u03b1,\u00b5\n((\n\u2202\n\u2202z\u00b5\n\u2297 A\u03b1\u00b5 \u2297 1\n)\nh\u03d5q,0\n)\n\u00b7\n((\n\u2202\n\u2202z\u03b1\n\u2297 1\u2297 1\n)\n\u03d50,`\n)\n.(6.21)\nFor the first term in (6.21) we see\u2211\n\u00b5\n(\n\u2202\n\u2202z\u00b5\n\u2297 A\u03b1\u00b5 \u2297 1\n)\n(h\u03d5q,0) =\n\u2211\n\u00b5,\u03bd\n\u03b2\n(\n\u2202\n\u2202z\u03b2\n\u2202\n\u2202z\u00b5\nz\u03bd \u2297 A\u03b1\u00b5A\u2217\u03b2\u00b5 \u2297 1\n)\n\u03d5q,0\n=\n\u2211\n\u03b2,\u00b5\n(\n\u2202\n\u2202z\u03b2\n\u2297 A\u03b1\u00b5A\u2217\u03b2\u03bd \u2297 1\n)\n\u03d5q,0\n=\n\u2211\n\u03b2\n(\n\u2202\n\u2202z\u03b2\n\u2297D\u03b1\u03b2 \u2297 1\n)\n\u03d5q,0.\nCombining this with (6.7) we obtain for (6.21)\ni\n\u2211`\nj=1\n\u2211\n\u03b1,\u03b2\n((\n\u2202\n\u2202z\u03b2\n\u2297D\u03b1\u03b2 \u2297 Aj(e\u03b1)\n)\n\u03d5q,0\n)\n\u00b7 \u03d50,`\u22121.\nBut this is exactly (up to a constant) the term (6.11), i.e., (6.21) is equal to (p+ q\u2212\n1)\n\u2211`\nj=1Bj. This together with (6.19),(6.20) and collecting the constants implies (i).\nFor (ii), we will use Lemma 6.10. We easily see\n{dV , h} =\n\u2211\n\u03b1,\u00b5\nz\u00b5\n\u2202\n\u2202z\u03b1\n\u2297 1\u2297 \u03c1(X\u03b1\u00b5).\nBy (6.6) and (6.1), we get\ndV h\u03d5q,` = {dV , h}\u03d5q,`\n=\n\u2212i\n4pi\n\u2211`\nj=1\n\u2211\n\u03b1,\u00b5\n(\nz\u00b5\n\u2202\n\u2202z\u03b1\nz\u03b1 \u2297 1\u2297 Aj(e\u00b5)\n)\n\u03d5q,`\u22121\n= \u2212\n\u2211`\nj=1\n(p+ q + `\u2212 1)Aj.\nThis implies (ii). \u0003\nCYCLES WITH COEFFICIENTS AND MODULAR FORMS 35\nWe are now in the position to finish the proof of Theorem 6.11: Combining\nLemma 6.13, Lemma 6.14 and Proposition 6.6, we get\n\u03c9(L)\u03d5q,` \u2212 d\n(\n\u03c8q,` +\n1\n2\nq\u2211\nj=1\n\u039b\n(j)\nq,`\u22121\n)\n= (\u03c9(L)\u03d5q,0) \u00b7 \u03d50,` \u2212\n\u2211`\nj=1\nBj \u2212 1\n4pi\nA(f+)\u03d5q,`\u22122\n\u2212 (dF\u03c8q,0) \u00b7 \u03d50,` + 1\n2\n\u2211`\nj=1\nBj \u2212 1\n2\n\u2211`\nj=1\nAj\n+\n1\n2\n\u2211`\nj=1\n(Aj +Bj + C\n\u2212\nj )\n= \u2212 1\n4pi\nA(f)\u03d5q,`\u22122,\nvia (6.14) and A(f\u2212)\u03d5q,`\u22121 = 12\n\u2211`\nj=1 C\n\u2212\nj , since A(f) = A(f+)\u2212 A(f\u2212). \u0003\n7. Main Result\nIn this section, we first construct the cohomology class [\u03b8nq,[\u03bb]] and use the funda-\nmental properties of \u03d5nq,[\u03bb] to derive our main result.\nFirst note that over R, the Weil representation action of the standard Siegel para-\nbolic in Sp(n,R) on \u03d5 \u2208 S(V n) is given by\n\u03c9\n((\na 0\n0 ta\u22121\n))\n\u03d5(x) = (det a)m\/2\u03d5(xa)\nfor a \u2208 GL+n (R), and\n\u03c9 (( 1 b0 1 ))\u03d5(x) = e\npiitr(b(x,x))\u03d5(x)\nfor b \u2208 Symn(R). Here x = (x1, \u00b7 \u00b7 \u00b7 , xn) \u2208 V n, as before.\nGlobally, we let A = AK be the ring of adeles of K. Let G\u2032(A) be the two-fold cover\nSp(n,A), which acts on S(V n(A)) via the (global) Weil representation \u03c9 = \u03c9V .\nFor g\u2032 \u2208 G\u2032(A), we define the standard theta kernel associated to a Schwartz\nfunction \u03d5 = \u03d5f \u2297 \u03d5\u221e \u2208 S(V nA ) by\n\u03b8(g\u2032, \u03d5) :=\n\u2211\nx\u2208V n\n\u03c9(g\u2032)\u03d5(x).\nBy abuse of notation, we let \u03d5nq,[\u03bb] = \u2297ri=1\u03d5vi = \u03d5\u221e, where \u03d5vi is the Schwartz form\n\u03d5nq,[\u03bb] at the first infinite place and the standard Gaussian \u03d50 at the other infinite\nplaces, and we define \u03d5nq,` in the same way. For the finite places, we let \u03d5f correspond\nto the characteristic function of h+ bLn.\nGiven \u03c4 = (\u03c41, . . . , \u03c4r) \u2208 Hrn we let g\u2032\u03c4 \u2208 Sp(n,K\u221e) be a standard element which\nmoves the base point (i, . . . , i) \u2208 Hrn to \u03c4 , i.e.,\ng\u2032\u03c4 =\n(\n1 u\n0 1\n)(\na 0\n0 ta\u22121\n)\n,\nwith v = a(ta\u22121). We consider g\u2032\u03c4 \u2208 G\u2032(A) in the natural way.\nWe write \u03c1\u03bb for the representation action of GLn(C) on S\u03bb(Cn).\n36 JENS FUNKE AND JOHN MILLSON\nFor \u03c4 \u2208 Hrn, we then define\n\u03b8nq,[\u03bb](\u03c4, z) = N\nK\nQ (det(a)\n\u2212m)\u03c1\u2217\u03bb(a)\u03b8(g\n\u2032\n\u03c4 , \u03d5f \u2297 \u03d5nq,[\u03bb])\n=\n\u2211\nx\u2208h+bLn\n\u03c1\u2217\u03bb(a)\u03d5nq,[\u03bb](xa)e\u2217((x,x)u\/2),\nand similarly, \u03b8nq,`(\u03c4, z). Here\ne\u2217(A) = exp\n(\n2pii\nr\u2211\nj=1\ntr(\u03bbi(A))\n)\n,\nfor A \u2208Mn,n(K).\nWe denote by A(\u0393\u2032, S\u03bb(Cn)\u2217\u2297 det\u2212m\/2) the space of vector-valued (not necessarily\nholomorphic) Hilbert-Siegel modular forms of degree n for a congruence subgroup \u0393\u2032\nand for the representation (\u03c1\u2217\u03bb \u2297 det\u2212m\/2, det\u2212m\/2, \u00b7 \u00b7 \u00b7 , det\u2212m\/2).\nThen Theorem 5.6 and the standard theta machinery give us\nProposition 7.1.\n\u03b8nq,[\u03bb](\u03c4, z) \u2208 A(\u0393\u2032, S\u03bb(Cn)\u2217 \u2297 det \u2212m\/2)\u2297 Anq(M,S[\u03bb]V),\ni.e, \u03b8nq,[\u03bb](\u03c4, z) is a vector-valued non-holomorphic Hilbert-Siegel modular form for the\nrepresentation (\u03c1\u2217\u03bb \u2297 det\u2212m\/2, det\u2212m\/2, . . . , det\u2212m\/2) with values in the S[\u03bb](V)-valued\nclosed differential nq-forms of the manifold M .\nThe Fourier expansion of \u03b8nq,[\u03bb](\u03c4) is given by\n\u03b8nq,[\u03bb](\u03c4) =\n\u2211\n\u03b2\u2208Symn(K)\n\u03b8\u03b2,nq,[\u03bb](v)e\u2217(\u03b2\u03c4),\nwith\n\u03b8\u03b2,nq,[\u03bb](v) =\n\u2211\nx\u2208L\u03b2\n\u03c1\u2217\u03bb(a)\u03d5nq,[\u03bb](xa)e\u2217((x,x)v\/2).\nDefinition 7.2. If \u03b7 is a rapidly decreasing S[\u03bb](V)-valued closed (p \u2212 n)q form on\nM representing a class [\u03b7] \u2208 H(p\u2212n)qc (M,S[\u03bb]V), we define\n\u039bnq,[\u03bb](\u03c4, \u03b7) =\n\u222b\nM\n\u03b7 \u2227 \u03b8nq,[\u03bb](\u03c4) \u2208 A(\u0393\u2032, S\u03bb(Cn)\u2217 \u2297 det \u2212m\/2).\nWe define \u039bnq,`(\u03c4, \u03b7) in the same fashion for \u03b7 taking values in T\n`(V). If \u03b7 is S[\u03bb](V)-\nvalued, then we have\n\u039bnq,`(\u03c4, \u03b7) = \u039bnq,[\u03bb](\u03c4, \u03b7).\nBefore we can state our main result, we need a bit more notation. For q = 2k even,\nwe let eq be the Euler form of the symmetric space D (which is the Euler class of the\ntautological vector bundle over D, i.e., the fiber over a point z \u2208 D is given by the\nCYCLES WITH COEFFICIENTS AND MODULAR FORMS 37\nnegative q-plane z) and zero for q odd. Here eq is normalized such that it is given in\u2227q(p\u2217) by\neq =\n(\n\u2212 1\n4pi\n)k\n1\nk!\n\u2211\n\u03c3\u2208Sq\nsgn(\u03c3)\u2126p+\u03c3(1),p+\u03c3(2) . . .\u2126p+\u03c3(2k\u22121),p+\u03c3(2k),\nwith\n\u2126\u00b5\u03bd =\np\u2211\n\u03b1=1\n\u03c9\u03b1\u00b5 \u2227 \u03c9\u03b1\u03bd .\nRemark 7.3. The main result of [KM4] is that in the scalar valued case, the gener-\nating series\nn\u2211\nt=0\n\u2211\n\u03b2\u22650\nrank\u03b2=t\n(\nPD(C\u03b2) \u2227 en\u2212tq\n)\ne\u2217(\u03b2\u03c4),\nis a classical Hilbert-Siegel modular form of weight m\/2. The key point is that for\nnondegenerate x such that (x,x) positive semidefinite of rank t, \u03d5nq,0(x) is (essen-\ntially) a Thom form for the cycle CX \u2229 en\u2212tq . One has\u222b\n\u0393X\\D\n\u03b7 \u2227 \u03d5nq,0(xa) =\n(\u222b\nCX\n\u03b7 \u2227 en\u2212tq\n)\ne\u2217(\u2212(x,x)v\/2).\nRemark 7.4. Actually, in [KM4] the non-compact hyperbolic case of signature (p, 1)\nwith n = p\u2212 1 is excluded (when the cycles are infinite geodesics). In the following,\nwe will also exclude this case. Note however that for signature (2, 1) and n = 1 this\nrestriction was removed in [FM1], and our result will also hold in that particular case.\nThe following two theorems are the generalization of the main result of [KM4].\nTheorem 7.5. The cohomology class [\u03b8nq,[\u03bb]] is holomorphic; i.e., it defines a holo-\nmorphic Siegel modular form of genus n with values in S\u03bb(Cn)\u2217\u2297 \u03c7(\u2212m\/2) and with\ncoefficients in Hnq(M,S[\u03bb]V).\nProof. This follows immediately from Theorem 5.10: We have [\u2202\u03d5nq,[\u03bb]] = 0, thus\n[\u2202\u03b8nq,[\u03bb]](\u03c4) = 0. \u0003\nTheorem 7.6. The Fourier expansion of [\u03b8nq,[\u03bb]](\u03c4) is given by\n[\u03b8nq,\u03bb](\u03c4) =\nn\u2211\nt=0\n\u2211\n\u03b2\u22650\nrank\u03b2=t\n(\nPD(C\u03b2,[\u03bb]) \u2227 en\u2212tq\n)\ne\u2217(\u03b2\u03c4),\nwhere PD(C\u03b2,[\u03bb]) denotes the Poincare\u00b4 dual class of PD(C\u03b2,[\u03bb]). Furthermore, if q is\nodd or i(\u03bb) = n, then [\u03b8nq,\u03bb](\u03c4) is a cusp form.\nThis is equivalent to\n38 JENS FUNKE AND JOHN MILLSON\nTheorem 7.7. For \u03b7 a rapidly decreasing closed q(n\u2212 p) form on M with values in\nS[\u03bb](V), the generating series\n\u039bnq,[\u03bb](\u03c4, \u03b7) =\nn\u2211\nt=0\n\u2211\n\u03b2\u22650\nrank\u03b2=t\n\u222b\nC\u03b2,[\u03bb]\n(\n\u03b7 \u2227 etq\n)\ne\u2217(\u03b2\u03c4)\nis a holomorphic Siegel modular form of type (det\u2212m\/2\u2297\u03c1\u2217\u03bb, det\u2212m\/2, \u00b7 \u00b7 \u00b7 , det\u2212m\/2).\nNote that by Theorem 3.7 a basis of S\u03bb(Cn) is given by pi\u03bb\u000ff(\u03bb), where f(\u03bb) runs\nthrough the semistandard fillings SS(\u03bb, n). With respect to this basis, we define the\npi\u03bbf(\u03bb) component (\u039b[\u03bb](\u03c4, \u03b7))pi\u03bbf(\u03bb) by\n(\u039bnq,[\u03bb](\u03c4, \u03b7))pi\u03bbf(\u03bb) =\n(\u222b\nM\n\u03b7 \u2227 \u03b8nq,[\u03bb](\u03c4)\n)(\n\u000ff(\u03bb)\n)\n.\nNote here that the value of \u039b at \u000ff(\u03bb) and pi\u03bbf(\u03bb) is the same. We then have\n(\u039bnq,[\u03bb](\u03c4, \u03b7))pi\u03bbf(\u03bb) =\nn\u2211\nt=0\n\u2211\n\u03b2\u22650\nrank\u03b2=t\n\u222b\nC\u03b2,[f(\u03bb)]\n(\n\u03b7 \u2227 etq\n)\ne\u2217(\u03b2\u03c4)\n=\nn\u2211\nt=0\n\u2211\nx\u2208Lct\n(x,x)\u22650\nmod \u0393\n\u222b\nCx\n(\n(\u03b7,xf(\u03bb)) \u2227 etq\n)\ne\u2217((x,x)\u03c4\/2),\nwhere\nLct = {x \u2208 h+ bLn : rank(x,x) = t; x nondegenerate}\nProof. We denote the \u03b2 Fourier coefficient of (\u039bnq,[\u03bb](\u03c4, \u03b7))f(\u03bb) by\na\u03b2 =\n\uf8eb\uf8ed\u222b\nM\n\u03b7 \u2227\n\u2211\nx\u2208L\u03b2\n\u03c1\u2217\u03bb(a)\u03d5nq,[\u03bb](xa)\n\uf8f6\uf8f8 ((a\u22121\u000f)f(\u03bb))e\u2217(\u03b2v).\nWe first note\nLemma 7.8. Assume that \u03b2 not positive semidefinite. Then\na\u03b2 = 0.\nProof. For n > 1, this follows from the Koecher principle, since \u039b[\u03bb](\u03c4, \u03b7) is holo-\nmorphic. For n = 1, so that \u03b2 < 0, the vanishing follows from the vanishing in the\ntrivial coefficient case by an argument similar to the positive definite coefficient, see\nLemma 7.9 below. \u0003\nFor \u03b2 positive semidefinite, we write\nac\u03b2 =\n\uf8eb\uf8ed\u222b\nM\n\u03b7 \u2227\n\u2211\nx\u2208Lc\u03b2\n\u03c1\u2217\u03bb(a)\u03d5nq,[\u03bb](xa)\n\uf8f6\uf8f8 ((a\u22121\u000f)f(\u03bb))e\u2217(\u03b2v)\nfor the contribution of the closed orbits and ad\u03b2 = a\u03b2 \u2212 ac\u03b2 for the degenerate part.\nCYCLES WITH COEFFICIENTS AND MODULAR FORMS 39\nLemma 7.9. Assume \u03b2 is positive semidefinite of rank t. Then\nac\u03b2 =\n\u222b\nC\u03b2,[f(\u03bb)]\n(\n\u03b7 \u2227 en\u2212tq\n)\n.\nProof. By the usual unfolding argument, we obtain\nac\u03b2e\u2217(\u2212\u03b2v) =\n\uf8eb\uf8ed\u222b\n\u0393\\D\n\u03b7 \u2227\n\u2211\nx\u2208Lc\u03b2\n\u03d5nq,[\u03bb](xa)\n\uf8f6\uf8f8 ((a\u22121\u000f)f(\u03bb))\n=\n\uf8eb\uf8ed\u222b\n\u0393\\D\n\u03b7 \u2227\n\u2211\nx\u2208\u0393\\Lc\u03b2\n\u2211\n\u03b3\u2208\u0393X\\\u0393\n\u03b3\u2217\u03d5nq,[\u03bb](xa)\n\uf8f6\uf8f8 ((a\u22121\u000f)f(\u03bb))\n=\n\u2211\nx\u2208\u0393\\Lc\u03b2\n(\u222b\n\u0393x\\D\n\u03b7 \u2227 \u03d5nq,[\u03bb](xa)\n)\n((a\u22121\u000f)f(\u03bb)).\nBut now by Theorem 5.9 and Lemma 5.8, we have\n[\u03d5nq,[\u03bb](xa)((a\n\u22121\u000f)f(\u03bb))] =\n[\n(1\u2297 1\u2297 x[f(\u03bb)])\u03d5nq,0(xa)\n]\n.\nThus(\u222b\n\u0393x\\D\n\u03b7 \u2227 \u03c1\u2217\u03bb(a)\u03d5nq,[\u03bb](xa)\n)\n(\u000ff(\u03bb)) =\n\u222b\n\u0393x\\D\n\u03b7 \u2227 (1\u2297 1\u2297 x[f(\u03bb)])\u03d5nq,0(xa)\n=\n\u222b\n\u0393x\\D\n(\u03b7,x[f(\u03bb)]) \u2227 \u03d5nq,0(xa)\n=\n(\u222b\nCX\n(\u03b7,x[f(\u03bb)]) \u2227 etq\n)\ne\u2217(\u2212(x,x)v\/2),\nby Remark 7.3. This implies ac\u03b2 =\n\u222b\nC\u03b2,[f(\u03bb)]\n\u03b7 \u2227 etq, as claimed. \u0003\nIt remains to show\nLemma 7.10. Assume \u03b2 is positive semidefinite. Then\nad\u03b2 = 0.\nProof. The recursion formula reduces this to the analogous statement for the singular\ncoefficients in the scalar-valued case in the same way as in Lemma 7.9. The Lemma\nthen follows from the vanishing of those coefficients in the scalar-valued case, see\n[KM4], \u00a74. We leave the details to the reader. \u0003\nThis concludes the proof of the theorem. \u0003\nAppendix A. The Fock model\nWe briefly review the construction of the Fock model of the (infinitesimal) Weil\nrepresentation of the symplectic Lie algebra sp(W \u2297 C), where (W, \u3008 , \u3009) denotes a\nnon-degenerate real symplectic space of dimension 2N . We follow [Ad2, KM4]. We\nlet J0 be a positive definite complex structure on W , i.e., the bilinear form given\n40 JENS FUNKE AND JOHN MILLSON\nby \u3008w1, J0w2\u3009 is positive definite. Let e1, . . . , eN ; f1, . . . , fN be a standard symplectic\nbasis of W so that J0ej = fj and J0fj = \u2212ej. We decompose\nW \u2297 C = W \u2032 \u2295W \u2032\u2032\ninto the +i and \u2212i eigenspaces under J0. Then w\u2032j = ej \u2212 ifj and w\u2032\u2032j = ej + ifj,\nj = 1, . . . , N form a basis for W \u2032 and W \u2032\u2032 respectively. We identify Sym2(W ) with\nsp(W ) via\n(x \u25e6 y)(z) = \u3008x, z\u3009y + \u3008y, z\u3009x.\nGiven \u03bb \u2208 C, we define the quantum algebra (see [Ho]) W\u03bb to be the tensor\nalgebra T (W \u2297C) modulo the two sided ideal generated by the elements of the form\nx\u2297y\u2212y\u2297x\u2212\u03bb\u3008x, y\u30091. We let p : T (W\u2297C)\u2192W\u03bb be the quotient map. Since T (W\u2297\nC) is graded, we have a filtration F \u2022 on W\u03bb, and we easily that [F kW\u03bb, F k\u2032W\u03bb] \u2282\nF k+k\n\u2032\u22122W\u03bb. Hence F 2W\u03bb is a Lie algebra. Furthermore, we have a split extension of\nLie algebras\n0 \u2212\u2192 F 1W\u03bb \u2212\u2192 F 2W\u03bb \u2212\u2192 sp(W \u2297 C) \u2212\u2192 0.\nHere the second map is p(x\u2297 y) 7\u2192 \u03bb(x \u25e6 y) \u2208 Sym2(W \u2297C) ' sp(W \u2297C), while the\nsplitting map j : Sym2(W \u2297 C)\u2192 F 2W\u03bb is given by\nj(x \u25e6 y) = 1\n2\u03bb\n(p(x)p(y) + p(y)p(x)) .\n(Note the sign error in [KM4], p. 151).\nWe let J be the left ideal in W\u03bb generated by W \u2032. The projection p induces\nan isomorphism of the symmetric algebra Sym\u2022(W \u2032\u2032) with W\u03bb\/J . We denote by\n\u03c1\u03bb the action of W\u03bb on W\u03bb\/J ' Sym\u2022(W \u2032\u2032) given by left multiplication. We now\nidentify Sym\u2022(W \u2032\u2032) with the polynomial functions P(CN) = C[z1, . . . , zN ] on W \u2032 via\nzj(w\n\u2032\u2032\nk) = \u3008w\u2032j, w\u2032\u2032k\u3009 = 2i\u03b4jk and observe that then the action of W \u2282 W\u03bb on P(CN) is\ngiven by\n\u03c1\u03bb(w\n\u2032\u2032\nj ) = zj and \u03c1\u03bb(w\n\u2032\nj) = 2i\u03bb\n\u2202\n\u2202zj\n.\nThis gives the action of W\u03bb, and we obtain an action \u03c9\u03bb = \u03c1\u03bb \u25e6 j of sp(W \u2297 C) on\nP(CN). This is the Fock model of the Weil representation with central character \u03bb.\nWe now let V be a real quadratic space of signature (p, q) (for the moment, we\nchange notation and denote the standard basis elements by v\u03b1 and v\u00b5), and let W\nbe a real symplectic space over R of dimension 2n (with standard symplectic basis ej\nand fj, j = 1, . . . , n). We consider the symplectic space W = V \u2297W of dimension\n2n(p + q), and note that J = \u03b8 \u2297 J defines a positive definite complex structure on\nW. Here \u03b8 is the Cartan involution with respect to the above basis of V , while J is\nthe positive define complex structure with respect to the above symplectic basis of\nW . Then the +i-eigenspace W\u2032 of J is spanned by the v\u03b1\u2297w\u2032j and v\u00b5\u2297w\u2032\u2032j , while the\n\u2212i eigenspace W\u2032\u2032 is spanned by the v\u03b1 \u2297 w\u2032\u2032j and v\u00b5 \u2297 w\u2032j.\nWe naturally have o(V ) \u00d7 sp(W ) \u2282 sp(V \u2297 W ), and one easily checks that the\ninclusions j1 : o(V ) '\n\u22272(V ) \u2192 sp(V \u2297 W ) ' Sym2(V \u2297 W ) and j2 : sp(W ) \u2192\nsp(V \u2297W ) ' Sym2(V \u2297W ) are given by\nCYCLES WITH COEFFICIENTS AND MODULAR FORMS 41\nj1 (v1 \u2227 v2) = 1\n2i\n[\nn\u2211\nj=1\n(v1 \u2297 w\u2032j) \u25e6 (v2 \u2297 w\u2032\u2032j )\u2212\nn\u2211\nj=1\n(v1 \u2297 w\u2032\u2032j ) \u25e6 (v2 \u2297 w\u2032j)\n]\nj2 (w1 \u25e6 w2) =\np\u2211\n\u03b1=1\n(v\u03b1 \u2297 w1) \u25e6 (v\u03b1 \u2297 w2)\u2212\np+q\u2211\n\u00b5=p+1\n(v\u00b5 \u2297 w1) \u25e6 (v\u00b5 \u2297 w2)\nwith v1, v2 \u2208 V and w1, w2 \u2208 W , see [KM4], Lemma 7.3.\nWe write F = P(Cn(p+q)) for the Fock model F of the (infinitesimal) Weil repre-\nsentation of sp(V \u2297W ). We denote the variables in P(Cn(p+q)) by z\u03b1j corresponding\nto v\u03b1\u2297w\u2032\u2032j and z\u00b5j corresponding to v\u00b5\u2297w\u2032j. For n = 1 we drop the subscript j(= 1).\nWe have\n\u03c1\u03bb(v\u03b1 \u2297 w\u2032j) = 2i\u03bb\n\u2202\n\u2202z\u03b1j\n, \u03c1\u03bb(v\u03b1 \u2297 w\u2032\u2032j ) = z\u03b1j,\n\u03c1\u03bb(v\u00b5 \u2297 w\u2032\u2032j ) = 2i\u03bb\n\u2202\n\u2202z\u00b5j\n, \u03c1\u03bb(v\u00b5 \u2297 w\u2032j) = z\u00b5j.\nWe easily obtain the following formulas for the action of o(V )\u00d7 sp(W ) in F : (the\nformulas differ from the ones given in [KM4] by a sign due to the sign error mentioned\nabove).\nLemma A.1. For the symplectic group, we note that in the decomposition sp(W \u2297\nC) = k\u2032 \u2295 p+ \u2295 p\u2212, k\u2032 ' glnC is spanned by the elements of the form w\u2032j \u25e6 w\u2032\u2032k, p+ is\nspanned by w\u2032\u2032j \u25e6 w\u2032\u2032k and p\u2212 is spanned by w\u2032j \u25e6 w\u2032k (1 \u2264 j, k \u2264 n). Then\n\u03c9(w\u2032j \u25e6 w\u2032\u2032k) = 2i\n[\np\u2211\n\u03b1=1\nz\u03b1k\n\u2202\n\u2202z\u03b1j\n\u2212\np+q\u2211\n\u00b5=p+1\nz\u00b5j\n\u2202\n\u2202z\u00b5k\n]\n+ i(p\u2212 q)\u03b4jk,\n\u03c9(w\u2032\u2032j \u25e6 w\u2032\u2032k) =\n1\n\u03bb\np\u2211\n\u03b1=1\nz\u03b1jz\u03b1k + 4\u03bb\np+q\u2211\n\u00b5=p+1\n\u22022\n\u2202z\u00b5j\u2202z\u00b5k\n,\n\u03c9(w\u2032j \u25e6 w\u2032k) = \u22124\u03bb\np\u2211\n\u03b1=1\n\u22022\n\u2202z\u03b1j\u2202z\u03b1k\n\u2212 1\n\u03bb\np+q\u2211\n\u00b5=p+1\nz\u00b5jz\u00b5k.\nNote that for n = 1, we have sp(W \u2297 C) ' sl2(C), and (for \u03bb = 2pii) the action of\nL := 1\n2\n(\n1 \u2212i\n\u2212i \u22121\n)\n= \u2212i\n4\nw\u20321 \u25e6w\u20321 and R := 12 ( 1 ii \u22121 ) = i4w\u2032\u20321 \u25e6w\u2032\u20321 correspond to the classical\nMaass lowering and raising operators on the upper half plane.\nLemma A.2. For the orthogonal group o(V ) = k \u2295 p, we write Xrs = vr \u2227 vs \u2208\u22272(V ) ' o(V ). So k is spanned by X\u03b1\u03b2 and X\u00b5\u03bd, while p is spanned by the X\u03b1\u00b5.\n42 JENS FUNKE AND JOHN MILLSON\nThen\n\u03c9(X\u03b1\u03b2) = \u2212\nn\u2211\nj=1\nz\u03b1j\n\u2202\n\u2202z\u03b2j\n\u2212 z\u03b2j \u2202\n\u2202z\u03b1j\n,\n\u03c9(X\u00b5\u03bd) =\nn\u2211\nj=1\nz\u00b5j\n\u2202\n\u2202z\u03bdj\n\u2212 z\u03bdj \u2202\n\u2202z\u00b5j\n,\n\u03c9(X\u03b1\u00b5) = 2i\u03bb\nn\u2211\nj=1\n\u22022\n\u2202z\u03b1j\u2202z\u00b5j\n\u2212 1\n2i\u03bb\nn\u2211\nj=1\nz\u03b1jz\u00b5j.\nWe now give the intertwiner of the Schro\u00a8dinger model with the Fock model for\n\u03bb = 2pii. The K \u2032-finite vectors of the Schro\u00a8dinger model form the polynomial Fock\nspace S(V n) \u2282 S(V n) which consists of those Schwartz functions on V n of the form\np(x)\u03d50(x), where p(x) is a polynomial function on V\nn and \u03d50(x) is the standard\nGaussian on V n. On the other hand, we define an action of the quantum algebra W\u03bb\non S(V n) by\n\u03c9(v\u03b1 \u2297 ej) = 2piix\u03b1j, \u03c9(v\u03b1 \u2297 fj) = \u2212 \u2202\n\u2202x\u03b1j\n,\n\u03c9(v\u00b5 \u2297 ej) = \u22122piix\u00b5j, \u03c9(v\u00b5 \u2297 fj) = \u2212 \u2202\n\u2202x\u00b5j\n,\nwhich has central character \u03bb = 2pii. As before, we obtain an action of sp(V \u2297W ), and\nthis is the infinitesimal action of the Schroedinger model of the Weil representation in-\ntroduced in the previous section. For \u03bb = 2pii, we then have a uniqueW\u03bb-intertwining\noperator \u03b9 : S(V n)\u2192 P(Cn(p+q)) satisfying \u03b9(\u03d50) = 1 (W\u2032 annihilates 1 \u2208 P(Cn(p+q))\nand \u03d50 \u2208 S(V n)).\nLemma A.3. The intertwining operator between the Schro\u00a8dinger and the Fock model\nsatisfies\n\u03b9\n(\nx\u03b1j \u2212 1\n2pi\n\u2202\n\u2202x\u03b1j\n)\n\u03b9\u22121 = \u2212i 1\n2pi\nz\u03b1j, \u03b9\n(\nx\u03b1j +\n1\n2pi\n\u2202\n\u2202x\u03b1j\n)\n\u03b9\u22121 = 2i\n\u2202\n\u2202z\u03b1j\n,\n\u03b9\n(\nx\u00b5j \u2212 1\n2pi\n\u2202\n\u2202x\u00b5j\n)\n\u03b9\u22121 = i\n1\n2pi\nz\u00b5j, \u03b9\n(\nx\u00b5j +\n1\n2pi\n\u2202\n\u2202x\u00b5j\n)\n\u03b9\u22121 = \u22122i \u2202\n\u2202z\u00b5j\n.\nReferences\n[Ad1] J Adams, Discrete spectrum of the reductive dual pair (O(p, q), Sp(2m)), Invent. Math. 74\n(1983), 449-475.\n[Ad2] J. Adams, The theta correspondence over R, Lecture notes, Workshop on the Theta corre-\nspondence and automorphic forms, University of Maryland, May 1994.\n[Boe] H. Boerner, Representations of Groups, Elsevier, 1970.\n[B] A. Borel, Introduction aux Groupes Arithmetiques, Hermann, 1969.\n[BT] R. Bott and L. W. Tu, Differential Forms in Algebraic Topology, Graduate Texts in Math-\nematics 82, Springer, 1982.\n[Bou] N. Bourbaki, Groupes et Alge`bres de Lie, Chapters 4,5,6, Hermann, 1981.\n[Br] G. E. Bredon, Topology and Geometry, Graduate Texts in Mathematics 139, Springer,1993.\nCYCLES WITH COEFFICIENTS AND MODULAR FORMS 43\n[FH] W. Fulton and J. Harris, Representation Theory, A First Course, Graduate Texts in Math-\nematics 129, Springer, 1991.\n[FM1] J. Funke and J. J. Millson, Cycles in hyperbolic manifolds of non-compact type and Fourier\ncoefficients of Siegel modular forms, Manuscripta Math. 107, 409-444.\n[FM2] J. Funke and J. J. Millson, Boundary behavior of special cohomology classes arising from\nthe Weil representation, in preparation.\n[GW] R. Goodman and N. R. Wallach, Representations and Invariants of the Classical Groups,\nEncyclopedia of Mathematics and its Applications 68, Cambridge University Press, 1998.\n[Ha] A. Hatcher Algebraic Topology, Cambridge University Press, 2002.\n[HZ] F. Hirzebruch and D. Zagier, Intersection numbers of curves on Hilbert modular surfaces\nand modular forms of Nebentypus, Invent. Math. 36 (1976), 57-113.\n[Ho] R. Howe, Remarks on classical invariant theory, Trans. AMS 313 (1989), 539-570.\n[KM1] S. S. Kudla and J. J. Millson, Geodesic Cycles and the Weil representation I: Quotients of\nhyperbolic space and Siegel modular forms, Compositio Math. 45 (1982), 207-271.\n[KM2] S. S. Kudla and J. J. Millson, The theta correspondence and harmonic forms I , Math. Ann.\n274, (1986), 353- 378.\n[KM3] S. S. Kudla and J. J. Millson, The theta correspondence and harmonic forms II , Math.\nAnn. 277, (1987), 267-314.\n[KM4] S. S. Kudla and J. J. Millson, Intersection numbers of cycles on locally symmetric spaces\nand Fourier coefficients of holomorphic modular forms in several complex variables, Publ.\nMath. I.H.E.S 71 (1990,) 121-172.\n[L] J.-S. Li, Nonvanishing theorems for the cohomology of certain arithmetic quotients, J. Reine\nAngew. Math. 428 (1992), 177-217.\n[LS] J.-S. Li and J. Schwermer, Automorphic representations and cohomology of arithmetic\ngroups, Challenges for the 21\u2013st century, Proceedings of the International Conference on\nFundamental Sciences, Singapore, 2001, pg. 102-137.\n[M] J. J. Millson, The cohomology with local coefficients of compact hyperbolic manifolds, Pro-\nceedings of the International Conference on Algebraic Groups and Arithmetic Subgroups,\nMumbai (2001) (Papers dedicated to M.S.Raghunathan) Published for the Tata Inst. Fund.\nRes. by Narosa Publishing House, international distribution by the A.M.S.\n[O] T. Oda, On modular forms associated with indefinite quadratic forms of signature (2, n\u22122),\nMath. Ann. 231 (1977), 97-144.\n[RS] S. Rallis and G. Schiffmann, On a relation between S\u02dcL2 cusp forms and cusp forms on\ntube domains associated to orthogonal groups, Trans. Amer. Math. Soc. 263 (1981), 1-58.\n[S] T. Shintani, On construction of holomorphic cusp forms of half integral weight, Nagoya\nMath. J. 58 (1975), 83-126.\n[T] Y. Tong, Weighted intersection numbers on Hilbert modular surfaces, Compositio Math.\n38 (1979), 299-310.\n[TW] Y. Tong and S. P. Wang, Construction of cohomology of discrete groups, Trans. Amer. Math.\nSoc. 306 (1988), 735-763.\n[VZ] D. A. Vogan and G. J. Zuckerman, Unitary representations with non-zero cohomology, Com-\npositio Math. 53 (1984), 51\u201390.\n[Z] D. Zagier, Modular forms associated to real quadratic fields, Invent. Math. 30 (1975), 1-46.\nDepartment of Mathematical Sciences, New Mexico State University, P.O. Box\n30001, 3MB, Las Cruces, NM 88001, USA\nE-mail address: jfunke@nmsu.edu\nDepartment of Mathematics, University of Maryland, College Park, MD 20742,\nUSA\nE-mail address: jjm@math.umd.edu\n"}