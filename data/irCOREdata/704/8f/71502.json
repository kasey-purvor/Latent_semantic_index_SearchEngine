{"doi":"10.1109\/CDC.2004.1430359","coreId":"71502","oai":"oai:eprints.lancs.ac.uk:826","identifiers":["oai:eprints.lancs.ac.uk:826","10.1109\/CDC.2004.1430359"],"title":"A particle filter for freeway traffic estimation","authors":["Mihaylova, L.","Boel, R."],"enrichments":{"references":[{"id":16341163,"title":"A Novel Approach to Nonlinear \/ Non-Gaussian Bayesian State Estimation,","authors":[],"date":"1993","doi":"10.1049\/ip-f-2.1993.0015","raw":"N. Gordon, D. Salmond, and A. Smith, A Novel Approach to Nonlinear \/ Non-Gaussian Bayesian State Estimation, IEE Proc. on Radar, and Signal Proc., Vol. 40, pp. 107-113, 1993.","cites":null},{"id":16341125,"title":"A Tutorial on Particle Filters for Online Nonlinear\/Non-Gaussian Bayesian Tracking,","authors":[],"date":"2002","doi":"10.1109\/78.978374","raw":"M. Arulampalam, S. Maskell, N. Gordon, T. Clapp, A Tutorial on Particle Filters for Online Nonlinear\/Non-Gaussian Bayesian Tracking, IEEE Trans. on Signal Proc., 2002, Vol. 50, No. 2, pp. 174-188.","cites":null},{"id":16341221,"title":"Condensation \u2013 Conditional Density Propagation for Visual Tracking,","authors":[],"date":"1998","doi":"10.1007\/bfb0015549","raw":"M. Isard, and A. Blake, Condensation \u2013 Conditional Density Propagation for Visual Tracking, International Journal of Computer Vision, Vol. 28, No. 1, 1998, pp. 5-28.","cites":null},{"id":16341168,"title":"Contour Tracking by Stochastic Propagation of Conditional Density,","authors":[],"date":"1996","doi":"10.1007\/bfb0015549","raw":"M. Isard, and A. Blake, Contour Tracking by Stochastic Propagation of Conditional Density, Proc. of the European Conf. on Comp. Vis., Cambridge, UK, 1996, pp. 343-356.","cites":null},{"id":16341242,"title":"Control of Freeway Traf\ufb01c Flow,","authors":[],"date":"1989","doi":"10.1038\/sj.jors.2600492","raw":"S. Smulders, Control of Freeway Traf\ufb01c Flow, Ph.D. thesis, Universiteit Twente, 1989, Netherlands.","cites":null},{"id":16341158,"title":"Eds., Sequential Monte Carlo Methods in Practice,","authors":[],"date":"2001","doi":"10.1007\/978-1-4757-3437-9","raw":"A. Doucet, N. Freitas, and N. Gordon, Eds., Sequential Monte Carlo Methods in Practice, New York: Springer-Verlag, 2001.","cites":null},{"id":16341244,"title":"Highway Traf\ufb01c State Estimation Using Improved Mixture Kalman Filters for Effective Ramp Metering Control,","authors":[],"date":"2003","doi":"10.1109\/cdc.2003.1272322","raw":"X. Sun, L. Mu\u02dc noz, R. Horowitz, Highway Traf\ufb01c State Estimation Using Improved Mixture Kalman Filters for Effective Ramp Metering Control, Proc. of 42th IEEE Conference on Decision and Control, pp. 6333\u20136338, 2003.","cites":null},{"id":16341161,"title":"Kalman Filtering Estimation of Traf\ufb01c Counts for Two Network Links in Tandem,","authors":[],"date":"2003","doi":"10.1016\/s0191-2615(02)00059-0","raw":"D. Gazis, and C. Liu, Kalman Filtering Estimation of Traf\ufb01c Counts for Two Network Links in Tandem, Transportation Research B, Vol. 37, No. 8, 2003, pp. 737-745.","cites":null},{"id":16341240,"title":"Macroscopic Modelling of Traf\ufb01c Flow on the Boulevard P\u00b4 eriph\u00b4 erique in Paris,","authors":[],"date":"1989","doi":"10.1016\/0191-2615(89)90021-0","raw":"M. Papageorgiou, J.-M. Blosseville, Macroscopic Modelling of Traf\ufb01c Flow on the Boulevard P\u00b4 eriph\u00b4 erique in Paris, Transportation Research B, Vol. 23, No. 1, pp. 29-47, 1989.","cites":null},{"id":16341153,"title":"Mixture Kalman \ufb01lters,","authors":[],"date":"2000","doi":"10.1111\/1467-9868.00246","raw":"R. Chen and J. Liu, Mixture Kalman \ufb01lters, Journal of Royal Statistical Society B, Vol. 62, pp. 493-508, 2000.","cites":null},{"id":16341150,"title":"Modelling Freeway Networks by Hybrid Stochastic Models,","authors":[],"date":"2004","doi":"10.1109\/ivs.2004.1336378","raw":"R. Boel and L. Mihaylova, Modelling Freeway Networks by Hybrid Stochastic Models, Proc. of the IEEE Intelligent Vehicle Symposium, Parma, Italy, pp.182-187, 2004.","cites":null},{"id":16341231,"title":"Monte Carlo Strategies in Scienti\ufb01c Computing,","authors":[],"date":"2001","doi":"10.1007\/978-0-387-76371-2","raw":"J. Liu, Monte Carlo Strategies in Scienti\ufb01c Computing, Springer-Verlag, 2001.","cites":null},{"id":16341283,"title":"Motorway Traf\ufb01c State Estimation Based on Extended Kalman Filter,","authors":[],"date":"2003","doi":"10.1287\/trsc.1070.0194","raw":"Y. Wang, M. Papageorgiou, and A. Messmer, Motorway Traf\ufb01c State Estimation Based on Extended Kalman Filter, Proc. of the European Control Conf., 1-3 Sept., 2003, UK.","cites":null},{"id":16341224,"title":"Online Traf\ufb01c Flow Model Applying Dynamic FlowDensity Relations,","authors":[],"date":"2002","doi":null,"raw":"Y. Kim, Online Traf\ufb01c Flow Model Applying Dynamic FlowDensity Relations, Ph.D. thesis, Techn. Univ. M\u00a8 unchen, 2002.","cites":null},{"id":16341254,"title":"Particle Filters in Robotics,","authors":[],"date":"2002","doi":"10.1109\/robot.2002.1013439","raw":"S. Thrun, Particle Filters in Robotics, Proc. of the the 17th Annual Conf. on Uncertainty in AI (UAI), 2002.","cites":null},{"id":16341148,"title":"Recursive Bayesian Estimation. Navigation and Tracking Applications,","authors":[],"date":"1999","doi":null,"raw":"N. Bergman, Recursive Bayesian Estimation. Navigation and Tracking Applications, Ph.D. thesis, Dept. of Electrical Engineering, Link\u00a8 oping, Sweden, 1999.","cites":null},{"id":16341235,"title":"Sequential Monte Carlo Methods for Dynamical Systems,","authors":[],"date":"1998","doi":"10.2307\/2669847","raw":"J. Liu and R. Chen, Sequential Monte Carlo Methods for Dynamical Systems, Journal of the American Statistical Association, Vol. 93, pp. 1032-1044, 1998.","cites":null},{"id":16341233,"title":"Special Issue on Monte Carlo Methods for Statistical Signal Processing,","authors":[],"date":"2002","doi":"10.1109\/tsp.2002.978373","raw":"Special Issue on Monte Carlo Methods for Statistical Signal Processing, IEEE Trans. on Signal Proc., Vol. 50, No. 2, 2002.","cites":null},{"id":16341156,"title":"The Cell Transmission Model: A Dynamic Representation of Highway Traf\ufb01c Consistent with the Hydrodynamic Theory,","authors":[],"date":"1994","doi":"10.1016\/0191-2615(94)90002-7","raw":"Daganzo, C., The Cell Transmission Model: A Dynamic Representation of Highway Traf\ufb01c Consistent with the Hydrodynamic Theory, Transportation Research B, Vol. 28B, No. 4, pp. 269-287, 1994.","cites":null},{"id":16341272,"title":"The Unscented Kalman Filter,i nKalman Filtering and","authors":[],"date":"2001","doi":"10.1002\/0471221546.ch7","raw":"E. Wan, and R. van der Merwe, The Unscented Kalman Filter,i nKalman Filtering and Neural Networks, S. Haykin, Ed., Chapter 7, pp. 221\u2013280, Wiley Publ., 2001.","cites":null},{"id":16341256,"title":"The Unscented Particel Filter,","authors":[],"date":"2001","doi":"10.1002\/0471221546.ch7","raw":"R. Van der Merwe, De Freitas, N., Doucet, A., Wan, E., The Unscented Particel Filter, Advances in Neural Information Processing Systems 13, 2001.","cites":null},{"id":16341166,"title":"Traf\ufb01c and Related Self-Driven Many-Particle Systems,","authors":[],"date":"2001","doi":"10.1103\/revmodphys.73.1067","raw":"D. Helbing, Traf\ufb01c and Related Self-Driven Many-Particle Systems, Rev. of Modern Phys., Vol. 73, pp. 1067-1141, 2001.","cites":null},{"id":16341237,"title":"Traf\ufb01c Flow Fundamentals, Prentice-Hall,","authors":[],"date":"1990","doi":null,"raw":"A. D. May, Traf\ufb01c Flow Fundamentals, Prentice-Hall, Englewood Cliffs, New Jersey, 1990.","cites":null},{"id":16341227,"title":"Traf\ufb01c Flow Modeling of Large-Scale Motorway Using the Macroscopic Modeling Tool METANET,","authors":[],"date":"2002","doi":"10.1109\/tits.2002.806804","raw":"A. Kotsialos, M. Papageorgiou, C. Diakaki, Y. Pavis and F. Middelham, Traf\ufb01c Flow Modeling of Large-Scale Motorway Using the Macroscopic Modeling Tool METANET, IEEE Trans. on Int. Transp. Syst., Vol. 3, No. 4, pp. 282-292, 2002","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2004-12","abstract":"This paper considers the traffic flow estimation problem for the purposes of on-line traffic prediction, mode detection and ramp-metering control. The solution to the estimation problem is given within the Bayesian recursive framework. A particle filter (PF) is developed based on a freeway traffic model with aggregated states and an observation model with aggregated variables. The freeway is considered as a network of components, each component representing a different section of the traffic network. The freeway traffic is modelled as a stochastic hybrid system, i.e. each traffic section possesses continuous and discrete states, interacting with states of neighbor sections. The state update step in the recursive Bayesian estimator is performed through sending and receiving functions describing propagation of perturbations from upstream to downstream, and from downstream to upstream sections. Measurements are received only on boundaries between some sections and averaged within regular or irregular time intervals. A particle filter is developed with measurement updates each time when a new measurement becomes available, and with possibly many state updates in between consecutive measurement updates. It provides an approximate but scalable solution to the difficult state estimation and prediction problem with limited, noisy observations. The filter performance is validated and evaluated by Monte Carlo simulation","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/71502.pdf","fullTextIdentifier":"http:\/\/eprints.lancs.ac.uk\/826\/1\/CDC_2004.pdf","pdfHashValue":"ee7ca92d58fd0bb30cd2329090938edb20d5e34d","publisher":"IEEE","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:eprints.lancs.ac.uk:826<\/identifier><datestamp>\n      2018-01-24T06:00:04Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D51:5141:51413735<\/setSpec><setSpec>\n      74797065733D626F6F6B5F73656374696F6E<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>\n    \n      \n        A particle filter for freeway traffic estimation<\/dc:title><dc:creator>\n        Mihaylova, L.<\/dc:creator><dc:creator>\n        Boel, R.<\/dc:creator><dc:subject>\n        QA75 Electronic computers. Computer science<\/dc:subject><dc:description>\n        This paper considers the traffic flow estimation problem for the purposes of on-line traffic prediction, mode detection and ramp-metering control. The solution to the estimation problem is given within the Bayesian recursive framework. A particle filter (PF) is developed based on a freeway traffic model with aggregated states and an observation model with aggregated variables. The freeway is considered as a network of components, each component representing a different section of the traffic network. The freeway traffic is modelled as a stochastic hybrid system, i.e. each traffic section possesses continuous and discrete states, interacting with states of neighbor sections. The state update step in the recursive Bayesian estimator is performed through sending and receiving functions describing propagation of perturbations from upstream to downstream, and from downstream to upstream sections. Measurements are received only on boundaries between some sections and averaged within regular or irregular time intervals. A particle filter is developed with measurement updates each time when a new measurement becomes available, and with possibly many state updates in between consecutive measurement updates. It provides an approximate but scalable solution to the difficult state estimation and prediction problem with limited, noisy observations. The filter performance is validated and evaluated by Monte Carlo simulation.<\/dc:description><dc:publisher>\n        IEEE<\/dc:publisher><dc:date>\n        2004-12<\/dc:date><dc:type>\n        Contribution in Book\/Report\/Proceedings<\/dc:type><dc:type>\n        NonPeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:identifier>\n        http:\/\/eprints.lancs.ac.uk\/826\/1\/CDC_2004.pdf<\/dc:identifier><dc:relation>\n        http:\/\/dx.doi.org\/10.1109\/CDC.2004.1430359<\/dc:relation><dc:identifier>\n        Mihaylova, L. and Boel, R. (2004) A particle filter for freeway traffic estimation. In: Decision and Control, 2004. CDC. 43rd IEEE Conference on (Volume:2 ). IEEE, pp. 2106-2111. ISBN 0780386825<\/dc:identifier><dc:relation>\n        http:\/\/eprints.lancs.ac.uk\/826\/<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/dx.doi.org\/10.1109\/CDC.2004.1430359","http:\/\/eprints.lancs.ac.uk\/826\/"],"year":2004,"topics":["QA75 Electronic computers. Computer science"],"subject":["Contribution in Book\/Report\/Proceedings","NonPeerReviewed"],"fullText":"A Particle Filter for Freeway Traffic Estimation\nLyudmila Mihaylova Rene\u00b4 Boel\nDepartment of Electrical and Electronic SYSTeMS, Universiteit Gent\nEngineering, University of Bristol, Merchant Technologiepark - Zwijnaarde 914\nVenturers Building, Woodland Road, UK B-9052 Gent, Belgium\nmila.mihaylova@bristol.ac.uk rene.boel@ugent.be\nAbstract\u2014This paper considers the traffic flow estimation\nproblem for the purposes of on-line traffic prediction, mode\ndetection and ramp-metering control. The solution to the\nestimation problem is given within the Bayesian recursive\nframework. A particle filter (PF) is developed based on a free-\nway traffic model with aggregated states and an observation\nmodel with aggregated variables. The freeway is considered\nas a network of components, each component representing a\ndifferent section of the traffic network. The freeway traffic\nis modelled as a stochastic hybrid system, i.e. each traffic\nsection possesses continuous and discrete states, interacting\nwith states of neighbor sections. The state update step in the\nrecursive Bayesian estimator is performed through sending\nand receiving functions describing propagation of perturba-\ntions from upstream to downstream, and from downstream\nto upstream sections. Measurements are received only on\nboundaries between some sections and averaged within regular\nor irregular time intervals. A particle filter is developed with\nmeasurement updates each time when a new measurement\nbecomes available, and with possibly many state updates in\nbetween consecutive measurement updates. It provides an ap-\nproximate but scalable solution to the difficult state estimation\nand prediction problem with limited, noisy observations. The\nfilter performance is validated and evaluated by Monte Carlo\nsimulation.\nKeywords \u2013 Monte Carlo methods, Bayesian estimation, particle\nfilters, macroscopic traffic models, stochastic hybrid systems\nI. MOTIVATION\nTraffic state estimation is an important part of an on-line road\ntraffic management system. The highly nonlinear behavior of the\ntraffic [10], with many complex interactions between vehicles,\nand the computational complexity due to the large size of the\nstate space makes this problem challenging. The macroscopic\nmodels [10] representing the average traffic behavior in terms of\naggregated variables (flow, density and speed at different locations)\nare the most suitable models for on-line implementations. Many\nof the proposed solutions for estimation of aggregated traffic\nvariables are based on Extended Kalman filtering applied to such\nmacroscopic models [26], [8], [20]. In [26] an Extended Kalman\nfilter (EKF) is proposed (and validated by simulation) to estimate\nthe unknown parameters and states of a stochastic version of\nMETANET, a well-known macroscopic model [19]. In [8] an\nEKF is designed for estimating the number of vehicles for two\nroadway sections in tandem. These estimators, [26], [8], and [20]\nhave all the advantages and disadvantages of the EKF technique:\ncomputationally cheap, but relying on a linearization of the state\nand measurement models which can cause filter divergence.\nA framework allowing to cope with non-linear models with\nuncertainties of different kinds, suitable to the traffic estimation, is\nthe recursive Bayesian framework [22]. According to the Bayesian\ntheory all information about the states of interest can be obtained\nfrom the posterior state distribution. The Bayesian estimation prob-\nlem is not analytically solvable in general, except for some special\ncases. Different approximate approaches have been proposed, such\nas Extended Kalman Filters [22], Interactive Multiple Model Fil-\nters [2]. Most of them assume Gaussian distribution of the noises\nand are based on linearization of the state and observation models.\nA powerful and scalable approximate approach has recently been\ndeveloped. It computes the posterior density function of the state\nby an empirical histogram obtained from samples generated by\na Monte Carlo simulation. It is known under different names:\nparticle filters [7], bootstrap method [9] or condensation algo-\nrithm [11]. Several implementations have been investigated [1],\n[7], [9], [15], [24], [25]. The Monte Carlo simulation technique\nhas been applied in areas such as robotics navigation [23], target\ntracking [1], [7], [3], [16], computer vision [11], [12].\nIn the present paper we develop a particle filter for freeway\ntraffic flow estimation. Particle filters (PFs) are appropriate for\ntraffic state estimation because they can cope with large, and highly\nnonlinear models as well as non-Gaussian signals. The structure of\nthe particle filter corresponds closely to compositional modelling,\nand it allows a parallelization for different sections of the road,\nthus allowing a reduction in the computational time.\nIn [21] a solution to highway traffic estimation is proposed\nusing a sequential Monte Carlo algorithm, based on first-order\ntraffic models (only dynamics of the traffic density is modelled),\ndistinguishing between the free-flow mode and the congestion\nmode. The traffic mode is estimated via a Monte Carlo technique,\nthe so called mixture Kalman filter [5] which is applied for\nrecursively estimating the traffic density. In contrast to [21], the\ntraffic in the present paper is described by a second-order model,\nand we develop a filter that estimates both traffic density and\nspeed.\nThe particle filter presented in Section IV uses aggregated\ntraffic and observation models. The state model is a recently\ndeveloped compositional model [4] for freeway traffic. Sending\nand receiving functions describe respectively the downstream and\nupstream propagation of perturbations. The freeway is considered\nas a network of components (Fig. 1), each component representing\na different section of the traffic network. Several sections form\na link. Sensors are available only at some boundaries between\nsections. Measurements are averaged over regular or irregular time\nintervals before being transmitted to the estimation agent. Within\nthe estimation agent an update of the conditional distribution of\nthe traffic density and speed estimate is performed using Monte\nCarlo simulation (for all sections concurrently and possibly via\nparallel processing). Whenever a new measurement is received a\nBayesian update of this conditional distribution is evaluated via\nthe PF. The PF can easily be extended to models where for the\nvery important sections a detailed model is used, while for other\nsections a more aggregate, coarse model is employed.\n43rd IEEE Conference on Decision and Control\nDecember 14-17, 2004\nAtlantis, Paradise Island, Bahamas\n0-7803-8682-5\/04\/$20.00 \u00a92004 IEEE\nWeB08.4\n2106\nb\nkmz ,bkm\nz ,1\u2212\n1\u2212i\nQ\nSection i \niQ\n11\n, -\u2212 ii vN ii vN , 11 , ++ ii vN\nSensor measurements \n1 i - 1... i i + 1 ... Nm \nLink m - 1 Link m Link m + 1\nFig. 1. Freeway links, sections and measurement points. Qi is\nthe average number of vehicles at the boundary between sections\ni and i + 1, Ni and vi are respectively the average number of\nvehicles and speed within section i.\nThe outline of the paper is as follows. Section II contains\nthe problem formulation. Section III presents the traffic and\nobservation models. The models we are using are stochastic and\nmacroscopic. A particle filter for traffic state estimation is designed\nin Section IV and its performance evaluation is presented in\nSection V. Finally, conclusions and ongoing research issues are\nhighlighted in the last section.\nII. PROBLEM FORMULATION\nThe aim of Bayesian estimation is to evaluate the posterior\nprobability density function (PDF) p(xk|Zk) of the state vector xk\nat time tk given a set Zk of sensor measurements available at time\ntk. The conditional PDF of the state vector is represented in a PF\nimplementation by the histogram corresponding to a collection of\nrandom samples, obtained by Monte Carlo simulation, executed\naccording to the assumed model. In this paper we propose an\nalgorithm for estimation of the traffic state vector xk, at discrete\ntime instants t1, t2, . . . , tkb , . . . , using all the past information that\nwas transmitted from sensors to the estimation agent prior to time\ntk. The same method can be used for prediction of a future state,\ni.e. E(xk+1|Zk). E(.) denotes the expectation operator, E(. | .)\ndenotes the conditional expectation operator, and (.)T the matrix\ntranspose, respectively.\nThe traffic flow is modelled as a stochastic hybrid system, with\ncontinuous and discrete (modal) states, interacting with states from\nneighboring sections. The global state of link m at time tk is\ndescribed by the vector xk = (xT1,k, xT2,k, . . . , xTnm,k)\nT\n, xk \u2208\nRnx , containing local state vectors xi,k = (Ni,k, vi,k)T of nm\nsections forming this link. Ni,k is the number of vehicles counted\nin section i, and vi,k is their average speed. The state vector xk is\nsampled at possibly asynchronous points in time t1 < t2 < . . . <\ntk < . . . . The evolution from one sample time to the next sample\ntime is described by the update equation\nxk+1 = f(xk,Pk, Qink , vink , Qoutk , voutk , \u03b7k). (1)\nPk denotes the vector of all time-varying parameters, such as\nroad conditions, or number of available lanes; Qink counts the\nnumber of vehicles entering section 1 during the k-th time interval\n[tk, tk+1) while vink is the average speed of these vehicles. Qoutk\nspecifies the possible outflow, at speed voutk from section nm. \u03b7k\nis a disturbance vector, reflecting random fluctuations in the traffic\nstates, and modelling errors. The traffic mode in section i in this\ninterval can make sudden transitions between different modes with\nrates which depend on the state vectors xi\u22121,k, xi,k, xi+1,k. Note\nthat the variables in eq. (1) are related to variables which are not\nindicated on Fig. 1 (input and output flows at section boundaries\n0 and Nm and time-varying parameters).\nSensors (magnetic loops or video cameras) are located at some\nboundaries between some sections j \u2208 J \u2282 {1, . . . , nm} in\nlink m. Noisy measurements of the average number of vehicles\nQi,kb , cars and trucks crossing the boundary between section j\nand section j + 1 during the time interval [tkb , tkb+1) together\nwith noisy measurements of mean speed of these vehicles are\ncollected and used by the filter. The intervals [tkb , tkb+1) can be\nnon-equidistant points in time and are typically longer than the\nintervals [tk, tk+1) between successive state update steps. Within\nthe intervals [tkb , tkb+1) several state update steps are required.\nGiven the observation equation\nzkb+1 = h[xs, s \u2208 [tkb , tkb+1), \u03bekb+1 ], (2)\nas well as the distribution p(x0) of the initial state vector x0, and\nof the noises \u03b7k, \u03bekb , the traffic estimation problem can be solved\nby a particle filter having the structure presented in Section IV.\nThe time indices in equation (2) outline that the data are coming\nin some intervals [tkb , tkb+1), at regular or irregular instants.\nThe model can deal with missing data due to sensor failures\nor due to other reasons, by defining a function h that takes the\nvalue \u201cno data\u201d with some probability. Refined models using data\nclassified per category (cars and trucks) and per lane can also be\naccommodated in our PF filter.\nIII. TRAFFIC AND OBSERVATION MODELS\nA. Traffic model\nThe traffic dynamics is modelled in this paper using sending\nand receiving functions to reflect the complex traffic behavior\nwhich incorporates forward and backward propagation of traffic\nperturbations. Sending and receiving functions were first proposed\nby Daganzo in [6] where piecewise affine representations of\nthese sending and receiving functions are used. In [4] a model\nis introduced that also represents the evolution of the average\nspeed in each section, that comprises speed dependent sending and\nreceiving functions. We briefly describe this model below since it\ntakes part in the state update step of the particle filter developed\nin Section IV.\nThe number of vehicles, Ni,k, [veh], present in a freeway\nsection i (with length Li, [km], and with \u0003i,k lanes) at sample\ntime tk is related to the density \u03c1i,k (number of vehicles per length\nunit, [veh\/km\/lane]) via\nNi,k = \u03c1i,kLi\u0003i,k, i = 1, 2, . . . nm. (3)\nThe evolution of Ni,k is governed by the conservation of vehicles:\nNi,k+1 = Ni,k + Qi\u22121,k \u2212Qi,k, (4)\nwhere Qi,k is the number of vehicles, [veh], crossing the boundary\ni (Fig. 1), leaving section i and entering section i+ 1, during the\ninterval [tk, tk+1). Qi,k is the minimum\nQi,k = min(Si,k, Ri,k+1), (5)\namong the values computed from a sending function\nSi,k = max{Ni,k vi,k\u2206tk\nLi\n+ \u03b7Si,k, Ni,k\nvout,min\u2206tk\nLi\n} (6)\n2107\nand a receiving function\nRi,k+1 = N\nmax\ni+1,k + Qi+1,k \u2212Ni+1,k, (7)\nwhere\nNmaxi+1,k = (Li+1\u0003i+1,k)\/(A\u0001 + vi+1,ktd). (8)\nThe sending function Si,k is a random variable expressing how\nmany among the Ni,k vehicles in section i at tk are at a distance\nless than vi,k\u2206tk from the boundary between sections i and i+1,\nwhere \u2206tk = tk+1 \u2212 tk is the sampling interval. When the\ndensity is low (corresponding to free-flow mode of traffic, i.e.\nwhen Ni,k \u2264 \u03c1critLi,k\u0003i,k; \u03c1crit denotes the critical density)\nthe interaction between vehicles will be negligible and their\nlocation will be uniformly distributed over Li. Si,k is then a\nbinomial random variable with Ni,k drawings, with probability\nof success (vi,k\u2206tk)\/Li. If the traffic is congested, vehicles will\nbe approximately equidistantly spaced and the noise is small\n(relative to Si,k) and approximately Gaussian (by the central limit\ntheorem). This formula for Si,k does not take into account what\nhappens when a severe traffic jam causes stopped traffic at time\ntk in section i. The speed then drops to 0 and no vehicle would\never leave section i after time tk, even if the downstream section\nwas empty. Hence, we have to impose a minimum outflow speed\nvout,min with which vehicles attempt to leave section i. This\nminimal outflow speed can only be realized if the downstream\nsection is not too congested, which effect is taken into account\nby the receiving function. This outflow speed vout,min is chosen\nso that \u03c1jamvout,min\u0003i,k equals the empirically observed outflow\nfrom a traffic jam into an empty downstream section, a value that\nis typically significantly smaller than the maximum flow.\nEach vehicle must be detected at least once in each section,\nduring the time interval [tk, tk+1) so that this definition of the\nsending function to make sense. This can be expressed mathe-\nmatically as vi,max\u2206tk < Li, which is similar to the stability\ncondition in classical numerical solutions of partial differential\nequation models of traffic.\nThe receiving function (7) expresses the maximum number of\nvehicles that are allowed to enter section i + 1 at the next time\ninstant k + 1. In this formula Nmaxi+1,k characterizes the maximum\nnumber of vehicles that can simultaneously be present in section\ni + 1 at sample time tk. It is given by the available space\nLi+1\u0003i+1,k in section i, divided by the speed-dependent \u201cvirtual\nlength\u201d of vehicles. This virtual length of vehicles is the average\nspace needed by a vehicle: its average length A\u0001 plus the distance\ntravelled during a minimum time distance td between two vehicles\n(necessary to allow safe driving). vi,k is the average speed of\nvehicles inside section i at time tk. In order to prevent possible\nnegative values of Ri,k+1 (7) when abrupt changes happen in the\ncapacity of a section (e.g. provoked by changes in the number of\nlanes due to an incident), the model imposes\nNi+1,k = N\nmax\ni+1,k, if N\nmax\ni+1,k < Ni+1,k. (9)\nThe sending function causes downstream propagation of pertur-\nbations in the traffic density. It can be recursively calculated from\nleft to right. The receiving function on the other hand corresponds\nto upstream propagation of traffic density perturbations, and it\nmust be recursively calculated from right to the left. Evidently,\nupdating the number of vehicles in the nm different sections from\nits value at time tk to its value at time tk+1 requires the solution\nof a system with nm nonlinear algebraic equations (4)-(8). In our\nalgorithm we iteratively solve this set of equations as follows. The\nsending function is calculated at first by forward recursion, and\nwe substitute Qi,k = Si,k in (4). With this \u201cfirst guess\u201d of the\nnumber of vehicles in section i at time tk+1 a first guess of the\ndensity and the speed at time tk+1 are calculated. After that a\nfirst guess of the receiving function can be computed, recursively\nfrom section Nm down to section 1. This means that the number\nof vehicles leaving section i must be smaller than or equal to the\nnumber of vehicles that the neighbor section can receive. In the\nalgorithm the number of vehicles passing boundary i is calculated\nby the rule [4]:\nif Ri,k+1 < Si,k, then Qi,k = Ri,k+1,\n\u2206i,k = Si,k \u2212Ri,k+1, Ni,k+1 = Ni,k+1 \u2212\u2206i,k . (10)\nThis iteration is repeated until no further changes in the flows Qi,k\nare made. In a finite number of iterations this leads to the correct\nnumber Qi,k of vehicles which actually are succeeding to cross\nthe boundary, whereas \u2206i,k = Si,k \u2212 Ri,k+1 is the number of\nvehicles which are forced to remain in section i by slowing down.\nThe speed vi,k+1 is updated according to the rule:\nvintermi,k+1 =\n\u23a7\u23aa\u23aa\u23aa\u23a8\n\u23aa\u23aa\u23aa\u23a9\n[vi\u22121,kQi\u22121,k + vi,k(Ni,k \u2212Qi,k)]\/Ni,k+1,\nfor Ni,k+1 \u0004= 0,\nvfree, otherwise,\n(11)\n\u03c1antici,k+1 = \u03b1\u03c1i,k+1 + (1\u2212 \u03b1)\u03c1i+1,k+1, (12)\nvi,k+1 = \u03b2v\ninterm\ni,k+1 + (1\u2212 \u03b2)ve(\u03c1antici,k+1) + \u03b7vi,k, (13)\nwhere vintermi,k+1 is the intermediate speed taking convection into\naccount. It expresses the speed update if all vehicles would\nmaintain their speed forever: drivers can not change their speed\ninstantaneously due to inertia. \u03c1antici,k+1 is the anticipated traffic\ndensity which drivers see at some distance in front of their\nvehicles, and \u03c1i,k+1 is computed from (3) after Ni,k+1, i =\n1, . . . , nm has been evaluated. The coefficient \u03b1 \u2208 (0, 1] weighs\nhow far ahead the drivers are looking in their anticipation (largest\nlookahead for \u03b1 close to 1). The function ve(\u03c1) expresses the\naverage speed corresponding to density \u03c1. This equilibrium speed\ncan be computed according to the empirical equation given in\n[14], [19] but for our model we find that simpler expressions\nare sufficient. When the density is below the critical density\n\u03c1crit we assume that the desired speed is equal to the free flow\nspeed vfree. In congested regime the average speed drops affinely\nfrom vfree at \u03c1crit to 0 at \u03c1jam. The coefficient \u03b2 \u2208 (0, 1]\ntunes the model by weighing how aggressively drivers adjust their\nspeed to changing traffic conditions. The noise \u03b7vi,k reflects the\nunpredictable behavior of the drivers and also modelling errors. It\nis assumed in our simulations to have a Gaussian distribution.\nGiven the initial vector x0 = (N1,0, v1,0, . . . , Nnm,0, vnm,0)T ,\nand the boundary variables (the sending functions S0,k at the\nupstream boundary of section 1, and the receiving functions\nRnm+1,k at the downstream boundary of section nm) one can\nnow evaluate the random evolution of the state xk of the freeway,\nusing (4) and (13) as state update equations (1).\nB. Observation equations\nThe following observation equations are derived in agreement\nwith (2)\nzj,kb+1(1) = Q\u00afj,kb+1 + \u03beQj ,kb+1 , (14)\nzj,kb+1(2) = v\u00afj,kb+1 + \u03bevj ,kb+1 . (15)\nzj,kb+1(1) is the measured averaged number of vehicles crossing\nthe boundary between sections j and j+1 during the time interval\n\u2206tb = [tkb , tkb+1), namely Q\u00afj,kb+1 =\n1\n\u2206tb\n\u2211k=tb+1\nk=tb\nQj,k,\nj \u2208 J \u2282 {1, . . . , nm}; zj,kb+1(2) is the average speed over the\nsame interval of these Qj,k vehicles. This speed is a weighted\naverage of the speed in section j and section j + 1. Note\n2108\nthat this average speed weighs the faster vehicles more heavily\nthan the slower vehicles, since faster vehicles cross boundaries\nmore frequently. The noise term \u03beQj can have a complicated\nprobability distribution (e.g. Poisson type, when errors due to\nmissed vehicles and false counted vehicles are accounted for).\nIV. PARTICLE FILTER FOR FREEWAY TRAFFIC\nWithin the Bayesian framework, the conditional density\np(xk|Zk\u22121) is recursively updated according to\np(xk+1|Zk) =\n\u222b\nRnx\np(xk+1|xk)p(xk|Zk)dxk, (16)\np(xk|Zk) = p(zk|xk)p(xk|Z\nk\u22121)\np(zk|Zk\u22121) , (17)\nwhere p(zk|Zk\u22121) is a normalizing constant. The recursive update\nof p(xk|Zk) is proportional to\np(xk|Zk) \u221d p(zk|xk)p(xk|Zk\u22121). (18)\nUsually, there is no simple analytical expression for propagating\np(xk|Zk) through (18).\nThe particle filter technique [7] provides an approximate so-\nlution to this discrete-time recursive updating of the posterior\nprobability density function p(xk|Zk) of the state given mea-\nsurements zj,kb+1(1), zj,kb+1(2) for j \u2208 J \u2282 {1, . . . , nm}. The\nstate update and the measurement update steps use respectively\nthe conditional density functions p(xk+1|xk) and p(Zk|xk) that\nare defined uniquely by the model described in section III. The\nparticle filter approximates p(xk|Zk) by the empirical histogram\ncorresponding to a collection of M particles (samples) {x(l)k }Ml=1.\nEach particle has an assigned relative weight, w(l)k , such that\nthe sum of all weights is unity. The weight and the value of\neach particle characterize (an approximation to) the conditional\ndensity function of the state xk. After the arrival of a new\nobservation zkb , the particle filter updates the value of the particles\nlocation and their weights according to Bayes\u2019 rule. The cloud of\nparticles evolves with time and depending on the observations,\nso that the particles represent with sufficient accuracy the true\nconditional density of the state. Note that we treat a problem that is\nslightly more complicated than in the previously developed particle\nfilters [7]. The sensor information updates the state distribution\nusually assuming that the observation at time tk is a noisy\nfunction of the state at time tk, while in the traffic problem the\nobservation at time tk depends on the values of the state at all\nthe times {tkb\u22121, . . . , tkb\u22121, tkb} through an averaging operation.\nThis extension can easily be incorporated in the PF algorithm.\nDuring the interval [tkb , tkb+1), between two consecutive mea-\nsurement updates, traffic state prediction is performed through\nthe traffic models (4), (5), (6) and (7) for the nm sections. The\nlikelihood function p(zk|xk) is calculated from (14)-(15) by the\npredicted states at each of the time instants tk \u2208 [tkb , tkb+1),\nand the known measurement noise density p\u03bei,k(\u03bei). The cloud of\nweighted particles, drawn from the posterior conditional probabil-\nity distribution, is used to map integrals to discrete sums (since\nthe histogram is piecewise constant): p(xk|Zk) is approximated\nby\np\u02c6(xk|Zk) \u2248\nM\u2211\nl=1\nw\u02dc\n(l)\nk \u03b4(xk \u2212 x(l)k ), (19)\nwhere \u03b4 is the delta-Dirac function and w\u02dc(l)k are the normalized\nimportance weights of the posterior conditional probability\ndensity function (PDF). New weights are calculated putting\nmore weight on particles that are important according to\nthe posterior probability density function (19). The random\nsamples {x(l)k , l = 1, 2, . . . ,M} are drawn from p(xk|Zk). It is\noften impossible to sample from the posterior density function\np(xk|Zk). However, this difficulty is circumvented by making use\nof the importance sampling from a known proposal distribution\n\u03c0(xk|Zk). In implementing particle filters, the choice of the\nproposal distribution is of crucial importance. The transition\nprior is the most popular choice of the proposal distribution [25]:\n\u03c0(xk|Zk) = p(xk|xk\u22121), which in the traffic problem is given\nby the traffic state model.\nThe implementation of the particle filter is described below:\n1) Initialization: k = 0\n* For l = 1, . . . ,M , generate samples {x(l)0 } from the\ninitial distribution p(x0).\n2) For k = 1, 2, . . . , km, . . . ,\n* Prediction step :\nFor l = 1, . . . ,M , sample x(l)k \u223c p(xk|x(l)k\u22121, Zk)\naccording to (3)-(13) for sections situated between two\nsubsequent boundaries where measurements arrive.\n* Evaluate importance weights (measurement processing\nstep), only for k = kb, on the boundaries between the\nsections where measurements are available. On the receipt\nof a new measurement, compute the weights\nw\n(l)\nk = w\n(l)\nk\u22121p(zk|x(l)k )\nand normalize, i.e. w\u02c6(l)k = w\n(l)\nk \/\n\u2211M\nl=1 w\n(l)\nk . The\nobservation equations (14), (15) describe the likelihood\np(zk|x(l)k ) of the observations. Note that the form of\nequations (14) and (15) reduces the computational costs,\nbecause the predicted observations will actually coincide\nwith the predicted number of vehicles on the boundaries\nand predicted speeds, obtained from the prediction step.\n* Selection step (resampling) only for k = kb:\nMultiply\/ Suppress samples x(l)k with high\/ low importance\nweights w\u02c6(l)k , in order to obtain M random samples\napproximately distributed according to p(xk|Zk). The\nresidual resampling algorithm described in [17], [25]\nis applied. This is a two step process making use of\nsampling-importance-resampling scheme.\n* For i = 1, . . . ,M , set w(l)k = w\u02c6\n(l)\nk = 1\/M .\n3) Output: The output of the algorithm is a collection of sam-\nples, from which the approximate posterior distribution is\ncomputed according to (19). The posterior mean E[xk|Zk]\nand the associated covariance V [xk|Zk] are approximately\ncomputed using the collection of samples (particles), namely\nx\u02c6k = E[xk|Zk] = 1M\n\u2211M\nl=1 x\n(l)\nk ,\nV [xk|Zk] = 1M\u22121\n\u2211M\nl=1(x\n(l)\nk \u2212 x\u02c6k)(x(l)k \u2212 x\u02c6k)T .\n4) Increase k and return to step 2.\nUsing a rather straightforward MATLAB implementation we\nhave succeeded in implementing this algorithm sufficiently fast\nto obtain on-line predictions of the traffic state for a link with 4\nsections. With more sophisticated programming tools this method\ncan undoubtedly be applied to on-line estimation for a large\n2109\nfreeway network for the purposes of on-line traffic management.\nV. FILTER PERFORMANCE EVALUATION\nThe particle filter performance is evaluated by Monte Carlo\nsimulation over independent Monte Carlo runs with different\ncollections of data, different initial state conditions and different\nboundary conditions. The data are generated by using a stochastic\nversion of METANET model [14], [19], after adding Gaussian\nnoises to the speed and density equations. The measurements are\nsupplied to the filter every minute, similarly to a possible update\nwith real data, whereas the state prediction is performed also in\nthe intermediate time instants. We are estimating the states of\nall sections between two sensor locations as one augmented state\nvector, composed by mutually connected components. Root-Mean\nSquared Errors (RMSEs) [2] \t(x\u02c6i) = [ 1r\n\u2211r\ni=1(\u03b5i,k)\nT (\u03b5i,k)]\n1\/2\n,\nfor relative state errors, \u03b5i,k = (xi,k \u2212 x\u02c6i,k)\/xi,k, e.g., w.r.t.\ndensity, speed and flow (the same state variables such as in\nMETANET) are used to evaluate the filter performance.\nInvestigations with simulated data\nThe link considered consists of four sections, with mea-\nsurements received only at the boundaries of the first and\nfourth section. Hence, the augmented state vector is xk =\n(xT1,k, x\nT\n2,k, x\nT\n3,k, x\nT\n4,k)\nT\n, i.e. i = 1, 2, 3, 4, and the measurement\nvector zkb = (z\nT\n1,kb\n, zT4,kb)\nT\n. The boundary conditions (inflow\nand speed at entrance boundary and density and speed in section\nnm+1) are assumed known, not estimated. In order to see the\noften used in practice flow-density and speed-flow diagrams from\nthe states, the plots are given in terms of flows, densities, speeds.\nThe initial section states are randomly generated from the true\nstates using Gaussian distribution, i.e. x0 \u223c N [x0, P0], where\nx0 contains the exact initial state vector and P0 is the initial\nstate covariance matrix. The size of the sample set is M = 500\nparticles.\n1 2 3 4\n0\n0.1\n0.2\nR\nM\nSE\n : \n\u03c1 1\nRELATIVE RMSEs\n1 2 3 4\n0\n0.05\n0.1\nR\nM\nSE\n : \nv 1\n1 2 3 4\n0\n0.02\n0.04\nR\nM\nSE\n : \nq 1\n1 2 3 4\n0\n0.1\n0.2\nR\nM\nSE\n : \n\u03c1 2\n1 2 3 4\n0\n0.05\n0.1\nR\nM\nSE\n : \nv 2\n1 2 3 4\n0\n0.02\n0.04\nR\nM\nSE\n : \nq 2\n1 2 3 4\n0\n0.1\n0.2\nR\nM\nSE\n : \n\u03c1 3\n1 2 3 4\n0\n0.05\n0.1\nR\nM\nSE\n : \nv 3\n1 2 3 4\n0\n0.02\n0.04\nR\nM\nSE\n : \nq 3\n1 2 3 4\n0\n0.1\n0.2\nR\nM\nSE\n : \n\u03c1 4\n1 2 3 4\n0\n0.05\n0.1\nR\nM\nSE\n : \nv 4\n1 2 3 4\n0\n0.02\n0.04\nR\nM\nSE\n : \nq 4\nTime, [h]\nFig. 2. Relative root-mean square errors of the density (for all lanes),\nspeed and flow of the four sections\nThe parameters of the state model are chosen as follows:\n\u03c1i,crit = 32.5 [veh\/km\/lane], \u2206t = 10 [sec], Li = 0.5 [km],\ni = 1, 2, 3, 4, \u03b1 = 0.9, \u03b2 = 0.6, A\u0001 = 0.010 [km], am = 1.867.\n1 2 3 4\n\u22122\n\u22121\n0\nM\nE \n: \u03c1\n1\nRELATIVE MEs\n1 2 3 4\n\u22121\n\u22120.5\n0\n0.5\nM\nE \n: v\n1\n1 2 3 4\n\u22120.2\n0\n0.2\n0.4\nM\nE \n: q\n1\n1 2 3 4\n\u22122\n\u22121\n0\nM\nE \n: \u03c1\n2\n1 2 3 4\n\u22121\n\u22120.5\n0\n0.5\nM\nE \n: v\n2\n1 2 3 4\n\u22120.2\n0\n0.2\n0.4\nM\nE \n: q\n2\n1 2 3 4\n\u22122\n\u22121\n0\nM\nE \n: \u03c1\n3\n1 2 3 4\n\u22121\n\u22120.5\n0\n0.5\nM\nE \n: v\n3\n1 2 3 4\n\u22120.2\n0\n0.2\n0.4\nM\nE \n: q\n3\n1 2 3 4\n\u22122\n\u22121\n0\nM\nE \n: \u03c1\n4\n1 2 3 4\n\u22121\n\u22120.5\n0\n0.5\nM\nE \n: v\n4\n1 2 3 4\n\u22120.2\n0\n0.2\n0.4\nM\nE \n: q\n4\nTime, [h]\nFig. 3. Relative MEs of the density (for all lanes), speed and flow of the\nfour sections\n0 100 200 300\n0\n2000\n4000\n6000\n8000\n10000\nFlow(density) diagram\nDensity, [veh\/km]\nFl\now\n, [\nve\nh\/\nh]\n0 2000 4000 6000 8000 10000\n0\n20\n40\n60\n80\n100\n120\n140\nFlow, [veh\/h]\nSp\nee\nd,\n [k\nm\n\/h\n]\nFlow(speed) diagram\n1 2 3 4\n0\n2000\n4000\n6000\n8000\nFl\now\n, v\neh\n\/h\n]\nTime, [h]\n1 2 3 4\n0\n50\n100\n150\nSp\nee\nd,\n [k\nm\n\/h\n]\nTime, [h]\n1\n2\n3 4\n4\n3\n2\n1\nFig. 4. Flow-density, flow-speed diagrams, evolution of the flow and of\nthe speed in time plotted from the estimated states\nWe assume that the free flow speed vfree is 130 [km\/h], the\nminimum outflow speed is vout,min = 3 [km\/h].\nIn the initial investigation we assumed that the number of lanes\nis known (but this could be estimated recursively). The simulations\nassume \u0003i,k = 3 always except for a reduction to \u0003i,k = 1 in\nlanes i = 2, 3 for tk between 2 [h] and 3 [h]. The model error\nand the measurement noise are assumed to be Gaussian, where\ncov(\u03b7vi) = 0.5\n2 [km\/h]2, the covariance of the sending function\nis non-stationary: cov(\u03b7Si,k ) = (0.025Ni,kvi,k\u2206tk\/Li)\n2 [veh]2,\nand V\u03bei = diag{202 [veh\/h]2, 22 [km\/h]2.\nThe filter performance is evaluated for r = 100 independent\nMonte Carlo runs. Relative Root-mean square errors (RMSEs)\nof each component of the state vector are presented in Fig. 2\n2110\nand relative mean errors (MEs) in Fig. 3. Fig. 4 contains the\nflow-density, speed-flow diagrams, and shows the evolution of the\naverage traffic flow and of the average speed in time. All figures\nare plotted from the estimated states. According to these results the\nparticle filter can accurately estimate the traffic states except for\na very brief increase in error during the fast transients. The flow-\ndensity diagram, based on the estimates has a bell-shaped form in\ngood agreement with the well known fundamental diagram [18].\nThe evolution of the estimated speed in time shows that the traffic\nin section 1 is characterized with a decreased speed during the\nperiod with reduced number of lanes in sections 2 and 3 (between\n2 [h] and 3 [h]. So far experiments have been performed with one\nlink consisting of four sections. The application of the particle\nfilter to many links of the freeway is straightforward.\nProbabilistic traffic mode detection is currently investigated\nbased on multiple modelling of different traffic modes, also\nthe formulation of criteria for on-line modes detection and the\ntransitions between them. Typical traffic modes can be represented\nby few models which together with the observations can provide\nlikelihood ratios. Likelihoods are then bringing information about\nthe correct model\/ mode. One of the difficulties is the appropriate\nclassification of the traffic modes. Multiple-model particle filters\ncan be used for change and mode detection as well. To each mode\na separate model is assigned and based on the measurements the\nwrong models will have high innovation processes, respectively\nsmall likelihoods which means that they will be less probable and\nhence rejected.\nVI. CONCLUSIONS\nThe freeway traffic flow estimation is formulated within a\nBayesian recursive framework. A particle filter is developed using\ntraffic and observation models with aggregated variables. The\ntraffic state is modelled as a hybrid stochastic system, i.e. the\ntraffic section possesses continuous and discrete states, interacting\nwith states from neighbor sections. The filter performance is\ninvestigated and validated by simulated data. The designed particle\nfilter gave very encouraging performance. Currently investigations\nare conducted with real traffic data from a Belgian freeway. The\nestimation approach presented is straightforward, general, and\napplicable to both freeways and urban networks, with different\ntopologies, with any number of sensors, regularly or irregularly\nreceived data in space and in time. It is suitable for distributed\nrealization and for parallel computations. The presented approach\nfor traffic state estimation is modular. Different traffic models\ncan be used in different sections of the traffic network. This\nrecursive Bayesian estimator is aimed at on-line applications for\nmode detection, and in different control strategies of road traffic,\nfor instance it fits well in the model predictive control framework.\nREFERENCES\n[1] M. Arulampalam, S. Maskell, N. Gordon, T. Clapp, A Tu-\ntorial on Particle Filters for Online Nonlinear\/Non-Gaussian\nBayesian Tracking, IEEE Trans. on Signal Proc., 2002, Vol.\n50, No. 2, pp. 174-188.\n[2] Y. Bar-Shalom, X. R. Li, Estimation and Tracking: Principles,\nTechniques, and Software, Boston MA, Artech House, 1993.\n[3] N. Bergman, Recursive Bayesian Estimation. Navigation and\nTracking Applications, Ph.D. thesis, Dept. of Electrical Engi-\nneering, Linko\u00a8ping, Sweden, 1999.\n[4] R. Boel and L. Mihaylova, Modelling Freeway Networks\nby Hybrid Stochastic Models, Proc. of the IEEE Intelligent\nVehicle Symposium, Parma, Italy, pp.182-187, 2004.\n[5] R. Chen and J. Liu, Mixture Kalman filters, Journal of Royal\nStatistical Society B, Vol. 62, pp. 493-508, 2000.\n[6] Daganzo, C., The Cell Transmission Model: A Dynamic\nRepresentation of Highway Traffic Consistent with the Hydro-\ndynamic Theory, Transportation Research B, Vol. 28B, No. 4,\npp. 269-287, 1994.\n[7] A. Doucet, N. Freitas, and N. Gordon, Eds., Sequential Monte\nCarlo Methods in Practice, New York: Springer-Verlag, 2001.\n[8] D. Gazis, and C. Liu, Kalman Filtering Estimation of Traffic\nCounts for Two Network Links in Tandem, Transportation\nResearch B, Vol. 37, No. 8, 2003, pp. 737-745.\n[9] N. Gordon, D. Salmond, and A. Smith, A Novel Approach\nto Nonlinear \/ Non-Gaussian Bayesian State Estimation, IEE\nProc. on Radar, and Signal Proc., Vol. 40, pp. 107-113, 1993.\n[10] D. Helbing, Traffic and Related Self-Driven Many-Particle\nSystems, Rev. of Modern Phys., Vol. 73, pp. 1067-1141, 2001.\n[11] M. Isard, and A. Blake, Contour Tracking by Stochastic\nPropagation of Conditional Density, Proc. of the European\nConf. on Comp. Vis., Cambridge, UK, 1996, pp. 343-356.\n[12] M. Isard, and A. Blake, Condensation \u2013 Conditional Density\nPropagation for Visual Tracking, International Journal of\nComputer Vision, Vol. 28, No. 1, 1998, pp. 5-28.\n[13] Y. Kim, Online Traffic Flow Model Applying Dynamic Flow-\nDensity Relations, Ph.D. thesis, Techn. Univ. Mu\u00a8nchen, 2002.\n[14] A. Kotsialos, M. Papageorgiou, C. Diakaki, Y. Pavis and F.\nMiddelham, Traffic Flow Modeling of Large-Scale Motorway\nUsing the Macroscopic Modeling Tool METANET, IEEE\nTrans. on Int. Transp. Syst., Vol. 3, No. 4, pp. 282-292, 2002\n[15] J. Liu, Monte Carlo Strategies in Scientific Computing,\nSpringer-Verlag, 2001.\n[16] Special Issue on Monte Carlo Methods for Statistical Signal\nProcessing, IEEE Trans. on Signal Proc., Vol. 50, No. 2, 2002.\n[17] J. Liu and R. Chen, Sequential Monte Carlo Methods for\nDynamical Systems, Journal of the American Statistical Asso-\nciation, Vol. 93, pp. 1032-1044, 1998.\n[18] A. D. May, Traffic Flow Fundamentals, Prentice-Hall, En-\nglewood Cliffs, New Jersey, 1990.\n[19] M. Papageorgiou, J.-M. Blosseville, Macroscopic Modelling\nof Traffic Flow on the Boulevard Pe\u00b4riphe\u00b4rique in Paris, Trans-\nportation Research B, Vol. 23, No. 1, pp. 29-47, 1989.\n[20] S. Smulders, Control of Freeway Traffic Flow, Ph.D. thesis,\nUniversiteit Twente, 1989, Netherlands.\n[21] X. Sun, L. Mun\u02dcoz, R. Horowitz, Highway Traffic State Esti-\nmation Using Improved Mixture Kalman Filters for Effective\nRamp Metering Control, Proc. of 42th IEEE Conference on\nDecision and Control, pp. 6333\u20136338, 2003.\n[22] A. Sage, and J. Melsa, Estimation Theory with Applications\nto Communications and Control, McGraw-Hill Inc., 1971.\n[23] S. Thrun, Particle Filters in Robotics, Proc. of the the 17th\nAnnual Conf. on Uncertainty in AI (UAI), 2002.\n[24] R. Van der Merwe, De Freitas, N., Doucet, A., Wan, E.,\nThe Unscented Particel Filter, Advances in Neural Information\nProcessing Systems 13, 2001.\n[25] E. Wan, and R. van der Merwe, The Unscented Kalman\nFilter, in Kalman Filtering and Neural Networks, S. Haykin,\nEd., Chapter 7, pp. 221\u2013280, Wiley Publ., 2001.\n[26] Y. Wang, M. Papageorgiou, and A. Messmer, Motorway\nTraffic State Estimation Based on Extended Kalman Filter,\nProc. of the European Control Conf., 1-3 Sept., 2003, UK.\nAcknowledgments. Financial support by the project DWTC-\nCP\/40 \u201cSustainability effects of traffic management\u201d, Belgium is\ngratefully acknowledged, as well as by the Belgian Programme on\nInter-University Poles of Attraction initiated by the Belgian State,\nPrime Minister\u2019s Office for Science, Technology and Culture, and\nin part by projects I-1202\/02 and I-1205\/02 with the Bulgar-\nian Science Fund. We also thank the \u201cVlaams Verkeerscentrum\nAntwerpen\u201d, Antwerp, Belgium, for providing the data used in\nthis study.\n2111\n"}