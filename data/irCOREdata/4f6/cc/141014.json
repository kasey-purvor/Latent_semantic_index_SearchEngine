{"doi":"10.1080\/0020717042000208296","coreId":"141014","oai":"oai:dspace.lib.cranfield.ac.uk:1826\/1237","identifiers":["oai:dspace.lib.cranfield.ac.uk:1826\/1237","10.1080\/0020717042000208296"],"title":"Optimal realizations of floating-point implemented digital controllers with\nfinite word length considerations.","authors":["Wu, J.","Chen, S.","Whidborne, James F.","Chu, J."],"enrichments":{"references":[{"id":37923716,"title":"American Control Conf.","authors":[],"date":"1999","doi":null,"raw":"American Control Conf. (San Diego, USA), June 2-4, 1999, 4326\u20134327.","cites":null},{"id":37923756,"title":"An improved closed-loop stability related measure for \ufb01nite-precision digital controller realizations.","authors":[],"date":"2001","doi":"10.1109\/9.935076","raw":"Wu, J., Chen, S., Li, G., Istepanian, R.S.H., & Chu, J. (2001). An improved closed-loop stability related measure for \ufb01nite-precision digital controller realizations. IEEE Trans. Automatic Control 46(7), 1162\u20131166. Realization X 2.6644e-9 30 8.5182e-8 23 3.1971e+1 5 26 20 5 X 4.7588e-6 19 8.7907e-5 13 1.8473e+1 5 15 9 5 X 9.5931e-6 18 1.5229e-4 12 1.5875e+1 4 13 8 4","cites":null},{"id":37923699,"title":"Comparative study on optimizing closed-loop stability bounds of \ufb01nite-precision controller structures with shift and delta operators.","authors":[],"date":"2000","doi":"10.1016\/s0167-6911(00)00016-5","raw":"Chen, S., Istepanian, R.S.H., Wu, J., & Chu, J. (2000). Comparative study on optimizing closed-loop stability bounds of \ufb01nite-precision controller structures with shift and delta operators. Systems and Control Letters 40(3), 153\u2013163.","cites":null},{"id":37923751,"title":"Finite word length stability issues in an framework.","authors":[],"date":"2000","doi":"10.1080\/002071700219876","raw":"Whidborne, J.F., Wu, J., & Istepanian, R.S.H. (2000). Finite word length stability issues in an framework. Int. J. Control 73(2), 166\u2013176.","cites":null},{"id":37923739,"title":"Fragility and robustness puzzles.","authors":[],"date":"1999","doi":"10.1109\/acc.1999.786607","raw":"M\u00a8 akil\u00a8 a, P.M. (1999). Fragility and robustness puzzles. In Proc. 1999 American Control Conf. (San Diego, USA), pp.2914\u20132919.","cites":null},{"id":37923714,"title":"On stability and performance of sampled-data systems subject to wordlength constraint.","authors":[],"date":"1994","doi":"10.1109\/cdc.1993.325141","raw":"Fialho, I.J., & Georgiou, T.T. (1994). On stability and performance of sampled-data systems subject to wordlength constraint. IEEE Trans. Automatic Control 39(12), 2476\u20132481.","cites":null},{"id":37923734,"title":"On the structure of digital controllers with \ufb01nite word length consideration.","authors":[],"date":"1998","doi":"10.1109\/9.668838","raw":"Li, G. (1998). On the structure of digital controllers with \ufb01nite word length consideration. IEEE Trans. Automatic Control 43(5), 689\u2013693.","cites":null},{"id":37923737,"title":"Optimal controllers for \ufb01nite wordlength implementation.","authors":[],"date":"1992","doi":"10.1109\/9.159567","raw":"Liu, K., Skelton, R., & Grigoriadis, K. (1992). Optimal controllers for \ufb01nite wordlength implementation. IEEE Trans. Automatic Control 37(9), 1294\u20131304.","cites":null},{"id":37923735,"title":"Optimal \ufb01nite precision implementation of a state-estimate feedback controller.","authors":[],"date":"1990","doi":"10.1109\/31.101269","raw":"16Li, G., & Gevers, M. (1990). Optimal \ufb01nite precision implementation of a state-estimate feedback controller. IEEE Trans. Circuits and Systems CAS-38(12), 1487\u20131499.","cites":null},{"id":37923715,"title":"Optimal \ufb01nite wordlength digital controller realization.","authors":[],"date":"1999","doi":"10.1109\/acc.1999.786383","raw":"Fialho, I.J., & Georgiou, T.T. (1999). Optimal \ufb01nite wordlength digital controller realization. In Proc.","cites":null},{"id":37923752,"title":"Optimal \ufb01nite wordlength linear quadratic regulation.","authors":[],"date":"1989","doi":"10.1109\/9.40767","raw":"Williamson, D., & Kadiman, K. (1989). Optimal \ufb01nite wordlength linear quadratic regulation. IEEE Trans. Automatic Control 34(12), 1218\u20131228.","cites":null},{"id":37923749,"title":"Optimal \ufb01nite-precision controller and \ufb01lter realizations using \ufb02oating-point arithmetic.","authors":[],"date":"2001","doi":"10.1080\/00207720500148378","raw":"Whidborne, J.F., & Gu, D. (2001). Optimal \ufb01nite-precision controller and \ufb01lter realizations using \ufb02oating-point arithmetic. Research Report EM2001\/07, Department of Mechanical Engineering, King\u2019s College London.","cites":null},{"id":37923713,"title":"Optimizing stability bounds of \ufb01nite-precision PID controller structures.","authors":[],"date":"1999","doi":"10.1109\/9.802934","raw":"Chen, S., Wu, J., Istepanian, R.S.H., & Chu, J. (1999). Optimizing stability bounds of \ufb01nite-precision PID controller structures. IEEE Trans. Automatic Control 44(11), 2149\u20132153.","cites":null},{"id":37923738,"title":"Optimum realizations of sampled-data controllers for FWL sensitivity minimization.","authors":[],"date":"1995","doi":"10.1016\/0005-1098(94)00112-v","raw":"Madievski, A.G., Anderson, B.D.O., & Gevers, M. (1995). Optimum realizations of sampled-data controllers for FWL sensitivity minimization. Automatica 31(3), 367\u2013379.","cites":null},{"id":37923736,"title":"Optimum structures of digital controllers in sampled-data systems: a roundoff noise analysis. Submitted to IEE Proc. Control Theory and Applications.","authors":[],"date":"2000","doi":"10.1049\/ip-cta:20020397","raw":"Li, G., Wu, J., Chen, S., & Zhao, K.Y. (2000). Optimum structures of digital controllers in sampled-data systems: a roundoff noise analysis. Submitted to IEE Proc. Control Theory and Applications.","cites":null},{"id":37923717,"title":"Parameterizations in Control, Estimation and Filtering Problems: Accuracy Aspects.","authors":[],"date":"1993","doi":"10.1007\/978-1-4471-2039-1","raw":"Gevers, M., & Li, G. (1993). Parameterizations in Control, Estimation and Filtering Problems: Accuracy Aspects. London: Springer Verlag.","cites":null},{"id":37923748,"title":"Performance of state regulator systems with \ufb02oating point computation.","authors":[],"date":"1979","doi":"10.1109\/tac.1979.1102044","raw":"Rink, R.E., & Chong, H.Y. (1979). Performance of state regulator systems with \ufb02oating point computation. IEEE Trans. Automatic Control 24, 411\u2013421.","cites":null},{"id":37923746,"title":"Realization of block \ufb02oating-point digital \ufb01lters and application to block implementations.","authors":[],"date":"1999","doi":"10.1109\/78.752605","raw":"Ralev, K.R., & Bauer, P.H. (1999). Realization of block \ufb02oating-point digital \ufb01lters and application to block implementations. IEEE Trans. Signal Processing 47(4), 1076\u20131086.","cites":null},{"id":37923750,"title":"Reduction of controller fragility by pole sensitivity minimization.","authors":[],"date":"2001","doi":"10.1109\/9.905702","raw":"Whidborne, J.F., Istepanian, R.S.H., & Wu, J. (2001). Reduction of controller fragility by pole sensitivity minimization. IEEE Trans. Automatic Control 46(2), 320\u2013325.","cites":null},{"id":37923740,"title":"Robust stability of digital feedback control systems with \ufb02oating point arithmetic.","authors":[],"date":"1995","doi":"10.1109\/cdc.1995.478907","raw":"Molchanov, A.P., & Bauer, P.H. (1995). Robust stability of digital feedback control systems with \ufb02oating point arithmetic. In Proc. 34th IEEE Int. Conf. Decision and Control (New Orleans, USA), pp.4251\u20134258.","cites":null},{"id":37923733,"title":"Robust, fragile, or optimal?","authors":[],"date":"1997","doi":null,"raw":"Keel, L.H., & Bhattacharryya, S.P. (1997). Robust, fragile, or optimal? IEEE Trans. Automatic Control 42(8), 1098\u20131105.","cites":null},{"id":37923719,"title":"Roundoff errors in block-\ufb02oating-point systems.","authors":[],"date":"1996","doi":"10.1109\/78.492531","raw":"Kallioj\u00a8 arvi, K., & Astola, J. (1996). Roundoff errors in block-\ufb02oating-point systems. IEEE Trans. Signal Processing 44(4), 783\u2013790.","cites":null},{"id":37923747,"title":"Roundoff noise in \ufb02oating point digital \ufb01lters.","authors":[],"date":"1996","doi":"10.1016\/s0090-5267(96)80039-9","raw":"Rao, B.D. (1996). Roundoff noise in \ufb02oating point digital \ufb01lters. Control and Dynamic Systems 75, 79\u2013103.","cites":null},{"id":37923754,"title":"Shift and delta operator realizations for digital controllers with \ufb01nite-word-length considerations.","authors":[],"date":"2000","doi":"10.1049\/ip-cta:20000750","raw":"Wu, J., Chen, S., Li, G., Istepanian, R.S.H., & Chu, J. (2000). Shift and delta operator realizations for digital controllers with \ufb01nite-word-length considerations. IEE Proc. Control Theory and Applications 147(6), 664\u2013672.","cites":null},{"id":37923718,"title":"Stability analysis of block \ufb02oating point digital controllers.","authors":[],"date":"2000","doi":null,"raw":"Istepanian, R.S.H.,Whidborne, J.F., & Bauer, P. (2000). Stability analysis of block \ufb02oating point digital controllers. In Proc. UKACC Int. Conf. Control 2000 (Cambridge, UK), CD-ROM, 6 pages.","cites":null},{"id":37923741,"title":"The digital implementation of control compensators: the coef\ufb01cient wordlength issue.","authors":[],"date":"1980","doi":"10.1109\/tac.1980.1102397","raw":"Moroney, P., Willsky, A.S., & Houpt, P.K. (1980). The digital implementation of control compensators: the coef\ufb01cient wordlength issue. IEEE Trans. Automatic Control AC-25(4), 621\u2013630.","cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2004-03-20T00:00:00Z","abstract":"The closed-loop stability issue of finite word length (FWL) realizations is\ninvestigated for digital controllers implemented in floating-point arithmetic.\nUnlike the existing methods which only address the effect of the mantissa bits\nin floating-point implementation to the sensitivity of closed-loop stability,\nthe sensitivity of closed-loop stability is analysed with respect to both the\nmantissa and exponent bits of floating-point implementation. A computationally\ntractable FWL closed-loop stability measure is then defined, and the method of\ncomputing the value of this measure is given. The optimal controller realization\nproblem is posed as searching for a floating-point realization that maximizes\nthe proposed FWL closed-loop stability measure, and a numerical optimization\ntechnique is adopted to solve for the resulting optimization problem. Simulation\nresults show that the proposed design procedure yields computationally efficient\ncontroller realizations with enhanced FWL closed-loop stability performance","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/141014.pdf","fullTextIdentifier":"http:\/\/dx.doi.org\/10.1080\/0020717042000208296","pdfHashValue":"948f5f01fd3be207837f7279ef6473b5a8f0ac52","publisher":"Taylor & Francis","rawRecordXml":"<record><header><identifier>\noai:dspace.lib.cranfield.ac.uk:1826\/1237<\/identifier><datestamp>2011-12-16T12:13:28Z<\/datestamp><setSpec>hdl_1826_19<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:title>Optimal realizations of floating-point implemented digital controllers with\nfinite word length considerations.<\/dc:title><dc:creator>Wu, J.<\/dc:creator><dc:creator>Chen, S.<\/dc:creator><dc:creator>Whidborne, James F.<\/dc:creator><dc:creator>Chu, J.<\/dc:creator><dc:description>The closed-loop stability issue of finite word length (FWL) realizations is\ninvestigated for digital controllers implemented in floating-point arithmetic.\nUnlike the existing methods which only address the effect of the mantissa bits\nin floating-point implementation to the sensitivity of closed-loop stability,\nthe sensitivity of closed-loop stability is analysed with respect to both the\nmantissa and exponent bits of floating-point implementation. A computationally\ntractable FWL closed-loop stability measure is then defined, and the method of\ncomputing the value of this measure is given. The optimal controller realization\nproblem is posed as searching for a floating-point realization that maximizes\nthe proposed FWL closed-loop stability measure, and a numerical optimization\ntechnique is adopted to solve for the resulting optimization problem. Simulation\nresults show that the proposed design procedure yields computationally efficient\ncontroller realizations with enhanced FWL closed-loop stability performance.<\/dc:description><dc:publisher>Taylor & Francis<\/dc:publisher><dc:date>2011-11-16T23:01:57Z<\/dc:date><dc:date>2011-11-16T23:01:57Z<\/dc:date><dc:date>2004-03-20T00:00:00Z<\/dc:date><dc:type>Article<\/dc:type><dc:identifier>Jun Wu, Sheng Chen, James F. Whidborne, Jian Chu, Optimal realizations of\nfloating-point implemented digital controllers with finite word length\nconsiderations, International Journal of Control, Volume 77, Issue 5, Mar 2004,\nPages 427 - 440<\/dc:identifier><dc:identifier>0020-7179<\/dc:identifier><dc:identifier>http:\/\/dx.doi.org\/10.1080\/0020717042000208296<\/dc:identifier><dc:identifier>http:\/\/dspace.lib.cranfield.ac.uk\/handle\/1826\/1237<\/dc:identifier><dc:language>en_UK<\/dc:language><\/oai_dc:dc><\/metadata><\/record>","journals":[{"title":null,"identifiers":["0020-7179","issn:0020-7179"]}],"language":{"code":"en","id":9,"name":"English"},"relations":[],"year":2004,"topics":[],"subject":["Article"],"fullText":"Optimal Realizations of Floating-Point Implemented Digital\nControllers with Finite Word Length Considerations\nJun Wu y, Sheng Chen z 0, James F. Whidborne x and Jian Chu y\ny National Key Laboratory of Industrial Control Technology\nInstitute of Advanced Process Control\nZhejiang University, Hangzhou, 310027, P. R. China\nz Department of Electronics and Computer Science\nUniversity of Southampton, Highfield\nSouthampton SO17 1BJ, U.K.\nx Department of Mechanical Engineering\nKing\u2019s College London\nStrand, London WC2R 2LS, U.K.\nAbstract\nThe closed-loop stability issue of finite-precision realizations is investigated for digital controllers im-\nplemented in floating-point arithmetic. Unlike the existing methods which only address the effect of the\nmantissa bits in floating-point implementation to the sensitivity of closed-loop stability, the sensitivity\nof closed-loop stability is analyzed with respect to both the mantissa and exponent bits of floating-point\nimplementation. A computationally tractable FWL closed-loop stability measure is then defined, and the\nmethod of computing the value of this measure is given. The optimal controller realization problem is\nposed as searching for a floating-point realization that maximizes the proposed FWL closed-loop stabil-\nity measure, and a numerical optimization technique is adopted to solve for the resulting optimization\nproblem. Simulation results show that the proposed design procedure yields computationally efficient\ncontroller realizations with enhanced FWL closed-loop stability performance.\nIndex Terms \u2014 digital controller, finite word length, floating-point, closed-loop stability, optimization.\n1 Introduction\nThe classical digital controller design methodology often assumes that the controller is implemented ex-\nactly, even though in reality a control law can only be realized in finite precision. It may seem that the\nuncertainty resulting from finite-precision computing of the digital controller is so small, compared to\n0Contact author. Tel\/Fax: +44 (0)23 8059 6660\/4508; Email: sqc@ecs.soton.ac.uk\n1\nthe uncertainty within the plant, such that this controller \u201cuncertainty\u201d can simply be ignored. Increas-\ningly, however, researchers have realized that this is not necessarily the case. Due to the FWL effect, a\ncasual controller implementation may degrade the designed closed-loop performance or even destabilize\nthe designed stable closed-loop system, if the controller implementation structure is not carefully cho-\nsen. The effects of finite-precision computation have become more critical with the growing popularity\nof robust controller design methods which focus only on dealing with large plant uncertainty (Keel &\nBhattacharryya, 1997; Ma\u00a8kila\u00a8, 1999). It is well known that a control law can be implemented with dif-\nferent realizations, and these different realizations are all equivalent if they are implemented in infinite\nprecision. However, different controller realizations possess different degrees of \u201crobustness\u201d to FWL\nerrors. This property can be utilized to select \u201coptimal\u201d realizations that optimize some given criteria,\nand several works (Williamson, 1991; Gevers & Li, 1993; Istepanian & Whidborne, 2001) have studied\nmany aspects of finite-precision digital controller design.\nGenerally speaking, there are two types of FWL errors in the digital controller. The first one is\nperturbation of controller parameters implemented with FWL and the second one is the rounding errors\nthat occur in arithmetic operations of signals (Li, Wu, Chen & Zhao, 2000). Typically, effects of these\ntwo types of errors are investigated separately for the reason of mathematical tractability. The first type\nof FWL errors directly concerns with the critical issue of closed-loop stability, and many studies have\ninvestigated some closed-loop stability robustness measures, especially for fixed-point implementation\n(Fialho & Georgiou, 1994, 1999; Madievski, Anderson & Gevers, 1995; Li, 1998; Chen, Wu, Istepanian\n& Chu, 1999; Whidborne, Wu & Istepanian, 2000; Whidborne, Istepanian & Wu, 2001; Wu, Chen,\nLi, Istepanian & Chu, 2001). The second type of FWL errors is usually measured with the so-called\nroundoff noise gain (Moroney, Willsky & Houpt, 1980; Williamson & Kadiman, 1989; Li & Gevers,\n1990; Liu, Skelton & Grigoriadis, 1992; Li et al., 2000), assuming an FWL implementation of controller\ncoefficients. This paper addresses the closed-loop stability with respect to FWL implementation and in\nthe remaining of the paper, without further pointing out, the FWL effect is taken to mean the first type of\nFWL errors.\nIn real-time applications where computational efficiency is critical, a digital controller implemented\nwith fixed-point arithmetic has some advantages over floating-point implementation. However, the detri-\nmental FWL effects are markedly increased in fixed-point implementation due to a reduced precision.\nIt is therefore not surprising that previous works have focused on finding optimal controller realizations\nusing fixed-point arithmetic by maximizing some closed-loop stability measures (Li, 1998; Fialho &\nGeorgiou, 1999; Chen et al., 1999; Chen, Istepanian, Wu & Chu, 2000; Whidborne et al., 2000, 2001;\n2\nWu, Chen, Li, Istepanian & Chu, 2000; Wu et al., 2001). In all the previous works using fixed-point\narithmetic, various FWL closed-loop stability measures, which can be shown to directly link to the bits\nrequired to implement the fractional part of fixed-point representation (Li, 1998; Chen et al., 1999), are\nmaximized to produce optimal realizations. However, the dynamic range of fixed-point representation is\ndetermined by its integer part. Overflow occurs when there are not enough bits for the integer part. Max-\nimizing these measures, while minimizing the bits required for the fractional part, may actually increase\nthe bits required for the integer part (Chen et al., 2000; Wu et al., 2000). Arguably, a better approach\nwould be to consider some measure which has a direct link to the total bit length required.\nWith decreasing in price and increasing in availability, the use of floating-point processors in con-\ntroller implementations has increased dramatically. Floating-point representation has quite different\ncharacteristics from fixed-point representation. The dynamic range of floating-point representation is\ndetermined by its exponent part. Overflow or underflow occurs when the bits for the exponent part are\nnot sufficient. The effects of finite-precision floating-point implementation have been well studied in\ndigital filter designs (Rao, 1996; Kallioja\u00a8rvi & Astola, 1996; Ralev & Bauer, 1999). However, there has\nbeen relatively little work studying explicitly floating point digital controller implementations. Some\nexceptions include Rink & Chong (1979), Molchanov & Bauer (1995), Istepanian, Whidborne & Bauer\n(2000), Whidborne & Gu (2001). In the work by Istepanian et al. (2000), a block floating-point arith-\nmetic was used, in which control coefficients were forced to have a common exponent and the problem\nwas converted into a fixed-point one. The work by Whidborne & Gu (2001) represents a case of true\nfloating-point implementation. In this work, a weighted closed-loop eigenvalue sensitivity index was de-\nfined for floating-point digital controller realizations. This index, however, only considers the mantissa\npart of floating-point arithmetic, under an assumption that the exponent bits are unlimited.\nThe generic contribution of this paper is to derive a new FWL closed-loop stability measure that\nexplicitly considers both the mantissa and exponent parts of floating-point arithmetic. The remainder of\nthis paper is organized as follows. Section 2 briefly summarizes the floating-point representation and\nhighlights the multiplicative nature of perturbations resulting from FWL floating-point arithmetic. Sec-\ntion 3 analyses the FWL effect of floating-point arithmetic on closed-loop stability and addresses how\nto measure such an effect on floating-point implemented digital controllers. Section 4 defines a com-\nputationally tractable FWL closed-loop stability measure for floating-point controller realizations and\nprovides the method of computing its value. In section 5, the optimal floating-point controller realization\nproblem is formulated, and a numerical optimization technique is adopted to solve for the resulting opti-\nmization problem. Two examples are given in section 6 to demonstrate the effectiveness of the proposed\n3\ndesign method, and the paper concludes at section 7.\n2 Floating-Point Representation\nIt is well known that any real number x 2 R can be represented uniquely by\nx = (\u00001)\ns\n\u0002 w \u0002 2\ne\n; (1)\nwhere s 2 f0; 1g is for the sign of x, w 2 [0:5; 1) is the mantissa of x, e 2 Z is the exponent of x, and\nZ denotes the set of integers. When x is stored in a digital computer of finite \f bits in a floating-point\nformat, the bits consist of three parts: one bit for s, \f\nw\nbits for w and \f\ne\nbits for e. Obviously,\n\f = 1 + \f\nw\n+ \f\ne\n: (2)\nSince \f\nw\nand \f\ne\nare finite, the set of numbers that is represented by a particular floating-point scheme is\nnot dense on the real line. Thus the set of possible floating-point numbers, F , is given by\nF\n4\n=\n8\n<\n:\n(\u00001)\ns\n0\n\b\n0:5 +\n\f\nw\nX\ni=1\nb\ni\n2\n\u0000(i+1)\n1\nA\n\u0002 2\ne\n: s 2 f0; 1g; b\ni\n2 f0; 1g; e 2 Z; e \u0014 e \u0014 e\n9\n=\n;\n[ f0g ; (3)\nwhere e and e represent the lower and upper limits of the exponent, respectively, and e \u0000 e = 2\fe \u0000 1.\nNote that unlike fixed-point representation, underflow can occur in floating-point arithmetic.\nDenote the set of integers e \u0014 e \u0014 e as Z\n[e; e\u2104\n. When no underflow or overflow occurs, that is, the\nexponent of x is within Z\n[e; e\u2104\n, the floating-point quantization operator Q : R! F can be defined as\nQ(x)\n4\n=\n8\n<\n:\nsgn(x)2\n(e\u0000\f\nw\n\u00001)\nb2\n(\f\nw\n\u0000e+1)\njxj+ 0:5\r; for x 6= 0\n0; for x = 0\n(4)\nwhere the exponent e = blog\n2\njxj\r+ 1 and the floor function bx\r denotes the largest integer less than or\nequal to x. The quantization error, \", is defined as\n\"\n4\n= jx\u0000Q(x)j : (5)\nIt can easily be shown that the quantization error is bounded by\n\" < jxj2\n\u0000(\f\nw\n+1)\n: (6)\nThus, when x is implemented in floating-point format of \f\nw\nmantissa bits, assuming no underflow or\noverflow, it is perturbed to\nQ(x) = x(1 + \u00c6); j\u00c6j < 2\n\u0000(\f\nw\n+1)\n: (7)\nIt can be seen that the perturbation resulting from finite-precision floating-point arithmetic is multiplica-\ntive, unlike the perturbation resulting from finite-precision fixed-point arithmetic, which is additive.\n4\n3 Problem Statement\nConsider the discrete-time closed-loop control system, consisting of a linear time invariant plant P (z)\nand a digital controller C(z). The plant model P (z) is assumed to be strictly proper with a state-space de-\nscription (A\nP\n;B\nP\n;C\nP\n), whereA\nP\n2 R\nm\u0002m\n,B\nP\n2 R\nm\u0002l andC\nP\n2 R\nq\u0002m\n. Let (A\nC\n;B\nC\n;C\nC\n;D\nC\n)\nbe a state-space description of the controller C(z), with A\nC\n2 R\nn\u0002n\n, B\nC\n2 R\nn\u0002q\n, C\nC\n2 R\nl\u0002n and\nD\nC\n2 R\nl\u0002q\n. A linear system with a given transfer function matrix has an infinite number of state-\nspace descriptions. In fact, if (A0\nC\n;B\n0\nC\n;C\n0\nC\n;D\n0\nC\n) is a state-space description of C(z), all the state-space\ndescriptions of C(z) form a realization set\nS\nC\n4\n=\nn\n(A\nC\n;B\nC\n;C\nC\n;D\nC\n)jA\nC\n= T\n\u00001\nA\n0\nC\nT;B\nC\n= T\n\u00001\nB\n0\nC\n;C\nC\n= C\n0\nC\nT;D\nC\n= D\n0\nC\no\n(8)\nwhere the transformation matrix T 2 Rn\u0002n is an arbitrary non-singular matrix. Denote\nX = [x\nj;k\n\u2104\n4\n=\n\"\nD\nC\nC\nC\nB\nC\nA\nC\n#\n: (9)\nThe stability of the closed-loop control system depends on the eigenvalues of the closed-loop transition\nmatrix\nA(X) =\n\"\nA\nP\n+B\nP\nD\nC\nC\nP\nB\nP\nC\nC\nB\nC\nC\nP\nA\nC\n#\n=\n\"\nA\nP\n0\n0 0\n#\n+\n\"\nB\nP\n0\n0 I\nn\n#\nX\n\"\nC\nP\n0\n0 I\nn\n#\n4\n=M\n0\n+M\n1\nXM\n2\n(10)\nwhere 0 denotes the zero matrix of appropriate dimension and I\nn\nthe n \u0002 n identity matrix. All the\ndifferent realizations X in S\nC\nhave exactly the same set of closed-loop poles if they are implemented\nwith infinite precision. Since the closed-loop system has been designed to be stable, all the eigenvalues\n\u0015\ni\n(A(X)), 1 \u0014 i \u0014 m+ n, are within the unit disk. Define\nkXk\nmax\n4\n= max\nj;k\njx\nj;k\nj (11)\nand\ng(X)\n4\n= min\nj;k\nfjx\nj;k\nj : x\nj;k\n6= 0g : (12)\nThe controller X is implemented with a floating-point processor of \f\ne\nexponent bits, \f\nw\nmantissa bits\nand one sign bit.\nFirstly, in order to avoid underflow and\/or overflow, both the exponent of kXk\nmax\nand the exponent\nof g(X) should be within Z\n[e; e\u2104\nsupported by the \f\ne\nexponent bits. We define an exponent measure for\nthe floating-point controller realization X as\n\r(X)\n4\n= log\n2\n\u0012\n4kXk\nmax\ng(X)\n\u0013\n: (13)\n5\nThe rationale of this exponent measure becomes clear in the following (obvious) proposition.\nProposition 1 X can be represented in the floating-point format of \f\ne\nexponent bits without underflow\nor overflow, if 2\fe \u0015 log\n2\n\u0010\nkXk\nmax\ng(X)\n\u0011\n+ 2.\nLet \fmin\ne\nbe the smallest exponent bit length that, when used to implement X, can avoid underflow\nand overflow. It can be computed as\n\f\nmin\ne\n= \u0000b\u0000 log\n2\n(blog\n2\nkXk\nmax\n\r \u0000 blog\n2\ng(X)\r + 1)\r : (14)\nThe measure \r(X) provides an estimate of \fmin\ne\nas\n^\n\f\nmin\ne\n4\n= \u0000b\u0000 log\n2\n\r(X)\r : (15)\nIt is clear that ^\fmin\ne\n\u0015 \f\nmin\ne\n.\nSecondly, when there is no underflow or overflow, according to the results of section 2,X is perturbed\ntoX+X \u00c6\u0001 due to the effect of finite \f\nw\nwhere\nX \u00c6\u0001\n4\n= [x\nj;k\n\u00c6\nj;k\n\u2104 (16)\nrepresents the Hadamard product of X and \u0001 = [\u00c6\nj;k\n\u2104. Each element of \u0001 is bounded by \u00062\u0000(\fw+1),\nthat is,\nk\u0001k\nmax\n< 2\n\u0000(\f\nw\n+1)\n: (17)\nWith the perturbation \u0001, \u0015\ni\n(A(X)) is moved to \u0015\ni\n(A(X+X\u00c6\u0001)). If an eigenvalue ofA(X+X\u00c6\u0001)\nis outside the open unit disk, the closed-loop system, designed to be stable, becomes unstable with the\nfinite-precision floating-point implemented X.\nIt is therefore critical to know when the FWL error will cause closed-loop instability. This means that\nwe would like to know the largest open \u201ccube\u201d in the perturbation space, within which the closed-loop\nsystem remains stable. Based on this consideration, a mantissa measure for the floating-point realization\nX can be defined as\n\u0016\n0\n(X)\n4\n= inffk\u0001k\nmax\n: A(X+X \u00c6\u0001) is unstableg : (18)\nFrom the above definition, the following proposition is obvious.\nProposition 2 A(X+X \u00c6\u0001) is stable if k\u0001k\nmax\n< \u0016\n0\n(X).\n6\nLet \fmin\nw\nbe the mantissa bit length such that 8\f\nw\n\u0015 \f\nmin\nw\n,A(X+X \u00c6\u0001) is stable for the floating-\npoint implemented X with \f\nw\nmantissa bits andA(X+X \u00c6\u0001) is unstable for the floating-point imple-\nmentedX with \fmin\nw\n\u00001 mantissa bits. Except through simulation, \fmin\nw\nis generally unknown. It should\nbe pointed out that due to the complex nonlinear relationship between \f\nw\nand closed-loop stability, there\nmay exist some odd cases of smaller mantissa bit length \f\nw\n< \f\nmin\nw\n\u0000 1 which regain closed-loop sta-\nbility. For example, consider the following hypothetical system. When \f\nw\n\u0015 9, the closed-loop system\nis stable, but the closed-loop system becomes unstable with \f\nw\n= 8. However, with \f\nw\n= 7, the closed-\nloop regains stability. The system becomes unstable again for \f\nw\n\u0014 6. For this system, \fmin\nw\nis 9 rather\nthan 7. The mantissa measure \u0016\n0\n(X) provides an estimate of \fmin\nw\nas\n^\n\f\nmin\nw0\n4\n= \u0000blog\n2\n\u0016\n0\n(X)\r \u0000 1 : (19)\nIt can be seen that ^\fmin\nw0\n\u0015 \f\nmin\nw\n.\nDefine the minimum total bit length required in floating point implementation as\n\f\nmin\n4\n= \f\nmin\ne\n+ \f\nmin\nw\n+ 1 : (20)\nClearly, a floating-point implemented X with a bit length \f \u0015 \fmin can guarantee no underflow, no\noverflow and closed-loop stability. Combining the measures \r(X) and \u0016\n0\n(X) results in the following\ntrue FWL closed-loop stability measure for the floating-point realization X\n\u001a\n0\n(X)\n4\n= \u0016\n0\n(X)=\r(X) : (21)\nAn estimate of \fmin is given by \u001a\n0\n(X) as\n^\n\f\nmin\n0\n4\n= \u0000blog\n2\n\u001a\n0\n(X)\r + 1 : (22)\nIt is clear that ^\fmin\n0\n\u0015 \f\nmin\n. The following proposition summarizes the usefulness of \u001a\n0\n(X) as a\nmeasure for the FWL characteristics ofX.\nProposition 3 A floating-point implementedX with a bit length \f can guarantee no underflow, no over-\nflow and closed-loop stability, if\n2\n\f\u00001\n\u0015 \u001a\n0\n(X) : (23)\nSince the closed-loop stability measure \u001a\n0\n(X) is a function of the controller realization X and ^\fmin\n0\ndecreases with the increase of \u001a\n0\n(X), an optimal realization can in theory be found by maximizing\n\u001a\n0\n(X), leading to the following optimal controller realization problem\n\u001d\ntrue\n4\n= max\nX2S\nC\n\u001a\n0\n(X) : (24)\n7\nHowever, the difficulty with this approach is that computing the value of \u0016\n0\n(X) is an unsolved open\nproblem. Thus, the true FWL closed-loop stability measure \u001a\n0\n(X) and the optimal realization problem\n(24) have limited practical significance. In the next section, we will seek an alternative measure that not\nonly can quantify FWL characteristics of X but also is computationally tractable.\n4 A Tractable FWL Closed-Loop Stability Measure\nWhen the FWL error \u0001 is small, from a first-order approximation, 8i 2 f1; \u0001 \u0001 \u0001 ;m+ ng\nj\u0015\ni\n(A(X+X \u00c6\u0001))j \u0000 j\u0015\ni\n(A(X))j \u0019\nl+n\nX\nj=1\nq+n\nX\nk=1\n\bj\u0015\ni\nj\n\b\u00c6\nj;k\n\f\n\f\n\f\n\f\n\f\n\u0001=0\n\u00c6\nj;k\n: (25)\nFor the derivative matrix \bj\u0015ij\n\b\u0001\n=\nh\n\bj\u0015\ni\nj\n\b\u00c6\nj;k\ni\n, define\n\r\n\r\n\r\n\r\n\bj\u0015\ni\nj\n\b\u0001\n\r\n\r\n\r\n\r\nsum\n4\n=\nX\nj;k\n\f\n\f\n\f\n\f\n\f\n\bj\u0015\ni\nj\n\b\u00c6\nj;k\n\f\n\f\n\f\n\f\n\f\n: (26)\nThen\nj\u0015\ni\n(A(X+X \u00c6\u0001))j \u0000 j\u0015\ni\n(A(X))j \u0014 k\u0001k\nmax\n\r\n\r\n\r\n\r\n\bj\u0015\ni\nj\n\b\u0001\n\f\n\f\n\f\n\f\n\u0001=0\n\r\n\r\n\r\n\r\nsum\n: (27)\nThis leads to the following mantissa measure for the floating-point realization X\n\u0016\n1\n(X)\n4\n= min\ni2f1;\u0001\u0001\u0001;m+ng\n1\u0000 j\u0015\ni\n(A(X))j\n\r\n\r\n\r\n\bj\u0015\ni\nj\n\b\u0001\n\f\n\f\n\f\n\u0001=0\n\r\n\r\n\r\nsum\n: (28)\nObviously, if k\u0001k\nmax\n< \u0016\n1\n(X), then j\u0015\ni\n(A(X + X \u00c6 \u0001))j < 1 which means that the closed-loop\nremains stable under the FWL error \u0001. In other words, for a given X, the closed-loop can tolerate\nthose FWL perturbations \u0001 whose norms k\u0001k\nmax\nare less than \u0016\n1\n(X). The larger \u0016\n1\n(X) is, the larger\nFWL errors the closed-loop system can tolerate. Similar to (19), from the mantissa measure \u0016\n1\n(X), an\nestimate of \fmin\nw\nis given as\n^\n\f\nmin\nw1\n4\n= \u0000blog\n2\n\u0016\n1\n(X)\r \u0000 1 : (29)\nThe assumption of small \u0001 is usually valid in floating-point implementation. Generally speaking,\nthere is no rigorous relationship between \u0016\n0\n(X) and \u0016\n1\n(X), but \u0016\n1\n(X) is connected with a lower bound\nof \u0016\n0\n(X) in some manners: there are \u201cstable perturbation cubes\u201d larger than f\u0001 : k\u0001k\nmax\n< \u0016\n1\n(X)g\nwhile there is no \u201cstable perturbation cube\u201d larger than f\u0001 : k\u0001k\nmax\n< \u0016\n0\n(X)g (Wu et al., 2000,\n2001). Hence, in most cases, it is reasonable to take that \u0016\n1\n(X) \u0014 \u0016\n0\n(X) and ^\fmin\nw1\n\u0015\n^\n\f\nmin\nw0\n. More\nimportantly, unlike the measure \u0016\n0\n(X), the value of \u0016\n1\n(X) can be computed explicitly. It is easy to see\nthat\n\bj\u0015\ni\nj\n\b\u0001\n\f\n\f\n\f\n\f\n\u0001=0\n=\n\bj\u0015\ni\nj\n\bX\n\u00c6X : (30)\n8\nLet p\ni\nbe a right eigenvector ofA(X) corresponding to the eigenvalue \u0015\ni\n. Define\nM\np\n4\n= [p\n1\np\n2\n\u0001 \u0001 \u0001 p\nm+n\n\u2104 (31)\nand\nM\ny\n4\n= [y\n1\ny\n2\n\u0001 \u0001 \u0001 y\nm+n\n\u2104 =M\n\u0000H\np\n(32)\nwhere the superscript H denotes the conjugate transpose operator and y\ni\nis called the reciprocal left\neigenvector related to p\ni\n. The following lemma is due to Li (1998).\nLemma 1 LetA(X) =M\n0\n+M\n1\nXM\n2\ngiven in (10) be diagonalizable. Then\n\b\u0015\ni\n\bX\n=M\nT\n1\ny\n\u0003\ni\np\nT\ni\nM\nT\n2\n(33)\nwhere the superscript \u0003 denotes the conjugate operation and T the transpose operator.\nComments: The necessary and sufficient condition for A(X) being diagonalizable is that it has m + n\nlinearly independent eigenvectors. This includes two cases. Firstly,A(X) has m+n distinct eigenvalues.\nIn this case, we can differentiate eigenvalues simply by their values. Secondly, the eigenvalues of A(X)\nare not all distinct but there are m+n linearly independent eigenvectors. In this case, we can differentiate\neigenvalues by their corresponding eigenvectors.\nThe following proposition shows that, given aX, the value of \u0016\n1\n(X) can easily be calculated.\nProposition 4 LetA(X) be diagonalizable. Then\n\u0016\n1\n(X) = min\ni2f1;\u0001\u0001\u0001;m+ng\nj\u0015\ni\nj(1 \u0000 j\u0015\ni\nj)\n\r\n\r\n\u0000\nM\nT\n1\nRe[\u0015\n\u0003\ni\ny\n\u0003\ni\np\nT\ni\n\u2104M\nT\n2\n\u0001\n\u00c6X\n\r\n\r\nsum\n: (34)\nProof: Noting j\u0015\ni\nj =\np\n\u0015\n\u0003\ni\n\u0015\ni\nleads to\n\bj\u0015\ni\nj\n\bX\n=\n1\n2\np\n\u0015\n\u0003\ni\n\u0015\ni\n\u0012\n\b\u0015\n\u0003\ni\n\bX\n\u0015\ni\n+ \u0015\n\u0003\ni\n\b\u0015\ni\n\bX\n\u0013\n=\n1\n2j\u0015\ni\nj\n\u0012\u0012\n\b\u0015\ni\n\bX\n\u0013\n\u0003\n\u0015\ni\n+ \u0015\n\u0003\ni\n\b\u0015\ni\n\bX\n\u0013\n=\n1\nj\u0015\ni\nj\nRe\n\u0014\n\u0015\n\u0003\ni\n\b\u0015\ni\n\bX\n\u0015\n: (35)\nCombining (28), (30), (35) and Lemma 1 results in this proposition.\nReplacing \u0016\n0\n(X) with \u0016\n1\n(X) in (21) leads to a computationally tractable FWL closed-loop stability\nmeasure\n\u001a\n1\n(X)\n4\n= \u0016\n1\n(X)=\r(X) : (36)\nFrom the above measure, an estimate of \fmin is given as\n^\n\f\nmin\n1\n4\n= \u0000blog\n2\n\u001a\n1\n(X)\r + 1 : (37)\n9\nIt is useful to compare the proposed measure with the previous results, especially the most recent one\ngiven by Whidborne & Gu (2001). For a complex-valued matrixY = [y\nj;k\n\u2104, define the Frobenius norm\nkYk\nF\n4\n=\n0\n\b\nX\nj;k\ny\n\u0003\nj;k\ny\nj;k\n1\nA\n1=2\n: (38)\nUnder an assumption that the exponent bits are unlimited, the computationally tractable weighted closed-\nloop eigenvalue sensitivity index addressed in (Whidborne & Gu, 2001) is given by\n\u0007(X)\n4\n=\nm+n\nX\ni=1\n\u000b\ni\n\u0007\ni\n(X) (39)\nwhere \u000b\ni\nare non-negative weighting scalars and \u0007\ni\n(X) are single-eigenvalue sensitivities defined by\n\u0007\ni\n(X)\n4\n= kXk\n2\nF\n\r\n\r\n\r\n\r\n\b\u0015\ni\n\bX\n\r\n\r\n\r\n\r\n2\nF\n: (40)\nThe thinking behind the above definition is as follows. From a first-order approximation, it can easily be\nshown that\nj\u0015\ni\n(A(X+X \u00c6\u0001))\u0000 \u0015\ni\n(A(X))j \u0014 k\u0001k\nmax\nkXk\nF\n\r\n\r\n\r\n\r\n\b\u0015\ni\n\bX\n\r\n\r\n\r\n\r\nF\n: (41)\nTherefore, for those multiplicative perturbations bounded by k\u0001k\nmax\n, a small \u0007\ni\n(X) will limit the\nresulting change of the corresponding eigenvalue within a small range.\nThe first obvious observation is that \u001a\n1\n(X) considers both the mantissa and exponent of floating-\npoint arithmetic and is therefore able to handle all the aspects of underflow, overflow and closed-loop\nstability, while \u0007(X) only considers the mantissa part of floating-point arithmetic and is thus \u201cincom-\nplete\u201d. Secondly, it can be seen that \u0007(X) deals with the sensitivity of \u0015\ni\nwhile \u001a\n1\n(X) (\u0016\n1\n(X)) consid-\ners the the sensitivity of j\u0015\ni\nj. It is well-known that the stability of a discrete-time linear time-invariant\nsystem depends only on the module of its eigenvalues. As \u0007(X) includes the unnecessary eigenvalue\narguments in consideration, it is generally conservative in comparison with \u001a\n1\n(X). Thirdly, \u001a\n1\n(X) uses\n\r\n\r\n\r\n\bj\u0015\ni\nj\n\bX\n\u00c6X\n\r\n\r\n\r\nsum\nwhile \u0007(X) uses kXk\nF\n\r\n\r\n\r\n\b\u0015\ni\n\bX\n\r\n\r\n\r\nF\nin checking the change of an eigenvalue. It is easy to see\nthat\nj\u0015\ni\n(A(X+X \u00c6\u0001))j \u0000 j\u0015\ni\n(A(X))j \u0014 k\u0001k\nmax\n\r\n\r\n\r\n\r\n\bj\u0015\ni\nj\n\bX\n\u00c6X\n\r\n\r\n\r\n\r\nsum\n\u0014 k\u0001k\nmax\nkXk\nF\n\r\n\r\n\r\n\r\n\b\u0015\ni\n\bX\n\r\n\r\n\r\n\r\nF\n: (42)\nObviously,\n\r\n\r\n\r\n\bj\u0015\ni\nj\n\bX\n\u00c6X\n\r\n\r\n\r\nsum\ngives a more accurate limit than kXk\nF\n\r\n\r\n\r\n\b\u0015\ni\n\bX\n\r\n\r\n\r\nF\ndoes on the change of the\ncorresponding eigenvalue module due to the multiplicative perturbations. This again implies that \u001a\n1\n(X)\nis less conservative than \u0007(X) in estimating the robustness of closed-loop stability with respect to con-\ntroller perturbations. The fourth observation is that \u001a\n1\n(X) provides an estimate of \fmin, ^\fmin\n1\nin (37),\nwhile \u0007(X) cannot provide information on bit length to the designer. One reason is that the measure\n10\n\u001a1\n(X) consists of two components, with \u0016\n1\n(X) addressing the stability margin and eigenvalue sensi-\ntivity linked to the mantissa bits, and \r(X) considering the exponent bits, while \u0007(X) only focuses\non the eigenvalue sensitivity partially linked to the mantissa part. The other reason is that, over all the\nclosed-loop eigenvalues, \u0016\n1\n(X) considers the \u201cworst\u201d one while \u0007(X) considers a \u201cweighted average\u201d.\n5 Optimization Procedure\nAs different realizations X have different values of the FWL closed-loop stability measure \u001a\n1\n(X), it is\nof practical importance to find an \u201coptimal\u201d realization X\nopt\nthat maximizes \u001a\n1\n(X). The controller im-\nplemented with this optimal realization X\nopt\nneeds a minimum bit length and has a maximum tolerance\nto the FWL error. This optimal controller realization problem is formally defined as\n\u001d\n4\n= max\nX2S\nC\n\u001a\n1\n(X) : (43)\nAssume that a controller has been designed using some standard controller design method. This con-\ntroller, denoted as\nX\n0\n4\n=\n\u0014\nD\n0\nC\nC\n0\nC\nB\n0\nC\nA\n0\nC\n\u0015\n; (44)\nis used as the initial controller realization in the above optimal controller realization problem. Let p\n0i\nbe a\nright eigenvector ofA(X\n0\n) corresponding to the eigenvalue \u0015\ni\n, and y\n0i\nbe the reciprocal left eigenvector\nrelated to p\n0i\n. The definition of S\nC\nin (8) means that\nX\n4\n= X(T) =\n\u0014\nI\nl\n0\n0 T\n\u00001\n\u0015\nX\n0\n\u0014\nI\nq\n0\n0 T\n\u0015\n(45)\nwhere det(T) 6= 0. It can then be shown that\nA(X) =\n\u0014\nI\nm\n0\n0 T\n\u00001\n\u0015\nA(X\n0\n)\n\u0014\nI\nm\n0\n0 T\n\u0015\n(46)\nwhich implies that\np\ni\n=\n\u0014\nI\nm\n0\n0 T\n\u00001\n\u0015\np\n0i\n; y\ni\n=\n\u0014\nI\nm\n0\n0 T\nT\n\u0015\ny\n0i\n: (47)\nHence\nM\nT\n1\nRe[\u0015\n\u0003\ni\ny\n\u0003\ni\np\nT\ni\n\u2104M\nT\n2\n=\n\u0014\nI\nl\n0\n0 T\nT\n\u0015\nM\nT\n1\nRe[\u0015\n\u0003\ni\ny\n\u0003\n0i\np\nT\n0i\n\u2104M\nT\n2\n\u0014\nI\nq\n0\n0 T\n\u0000T\n\u0015\n4\n=\n\u0014\nI\nl\n0\n0 T\nT\n\u0015\n\b\ni\n\u0014\nI\nq\n0\n0 T\n\u0000T\n\u0015\n(48)\nwith\b\ni\n=M\nT\n1\nRe[\u0015\n\u0003\ni\ny\n\u0003\n0i\np\nT\n0i\n\u2104M\nT\n2\n. Define the following cost function:\nf(T)\n4\n= min\ni2f1;\u0001\u0001\u0001;m+ng\n0\nB\nB\n\b\n\r\n\r\n\r\n\r\n\u0012\u0014\nI\nl\n0\n0 T\nT\n\u0015\n\b\ni\n\u0014\nI\nq\n0\n0 T\n\u0000T\n\u0015\u0013\n\u00c6X(T)\n\r\n\r\n\r\n\r\nsum\nj\u0015\ni\nj(1\u0000 j\u0015\ni\nj)\nlog\n2\n4kX(T)k\nmax\ng(X(T))\n1\nC\nC\nA\n\u00001\n: (49)\n11\nThen the optimal controller realization problem (43) can be posed as the following optimization problem:\n\u001d = max\nT2R\nn\u0002n\ndetT6=0\nf(T) : (50)\nEfficient numerical optimization methods exist for solving for this optimization problem to provide an\noptimal transformation matrix T\nopt\n. With T\nopt\n, the optimal realization X\nopt\ncan readily be computed.\n6 Numerical Examples\nTwo examples are used to illustrate the proposed design procedure for obtaining optimal FWL floating-\npoint controller realizations and to compare it with the method given in (Whidborne & Gu, 2001).\nExample 1. This example, taken from (Gevers & Li, 1993), has been studied by Whidborne & Gu\n(2001). The discrete-time plant is given by\nA\nP\n=\n2\n6\n6\n4\n3:7156e + 0 \u00005:4143e + 0 3:6525e + 0 \u00009:6420e \u0000 1\n1 0 0 0\n0 1 0 0\n0 0 1 0\n3\n7\n7\n5\n;\nB\nP\n= [ 1 0 0 0 \u2104\nT\n;\nC\nP\n= [ 1:1160e \u0000 6 4:3000e \u0000 8 1:0880e \u0000 6 1:4000e \u0000 8 \u2104 :\nThe initial realization of the digital controller is given by\nA\n0\nC\n=\n2\n6\n6\n6\n4\n2:6743e + 0 \u00005:7446e + 0 2:5101e + 0 \u00009:1782e \u0000 1\n2:8769e \u0000 1 \u00002:7446e \u0000 2 \u00006:9444e \u0000 1 \u00008:9358e \u0000 3\n\u00003:3773e \u0000 1 9:8699e \u0000 1 \u00003:2925e \u0000 1 \u00004:2367e \u0000 3\n\u00008:3021e \u0000 2 \u00003:1988e \u0000 3 9:1906e \u0000 1 \u00001:0415e \u0000 3\n3\n7\n7\n7\n5\n;\nB\n0\nC\n= [ 1:0959e + 6 6:3827e + 5 3:0262e + 5 7:4392e + 4 \u2104\nT\n;\nC\n0\nC\n= [ 1:8180e \u0000 1 \u00002:8313e \u0000 1 5:0006e \u0000 2 6:1722e \u0000 2 \u2104 ; D\n0\nC\n= 0 :\nBased on the proposed FWL closed-loop stability measure, the optimization problem (50) was formed\nand solved for using the MATLAB routine fminsearch.m to obtain an optimal transformation matrix\nT\nopt\n=\n2\n6\n6\n6\n4\n7:7275e + 3 \u00001:0904e + 2 \u00002:1292e + 2 9:8042e + 1\n6:9729e + 3 2:1370e + 3 4:4988e + 1 2:1812e + 2\n6:2844e + 3 3:9092e + 3 2:9303e + 2 2:9240e + 2\n5:5879e + 3 5:2862e + 3 5:5027e + 2 3:4367e + 2\n3\n7\n7\n7\n5\nand the corresponding optimal realization of the digital controller X\nopt\ngiven by\nA\nopt\nC\n=\n2\n6\n6\n6\n4\n\u00001:4441e + 0 \u00001:0500e + 0 \u00006:0800e \u0000 2 \u00001:0102e \u0000 1\n3:8412e + 0 2:4034e + 0 6:7143e \u0000 2 1:7402e \u0000 1\n\u00001:3159e + 1 \u00004:5856e + 0 5:3403e \u0000 1 \u00006:8843e \u0000 1\n3:2330e \u0000 1 \u00002:1078e + 0 \u00006:6254e \u0000 2 8:2322e \u0000 1\n3\n7\n7\n7\n5\n;\n12\nBopt\nC\n= [ 1:6342e + 2 \u00002:5378e + 2 9:1370e + 2 \u00006:1106e \u0000 2 \u2104\nT\n;\nC\nopt\nC\n= [ 8:9770e + 1 \u00001:0310e + 2 \u00002:8290e + 0 \u00008:0995e + 0 \u2104 ; D\nopt\nC\n= 0 :\nAn \u201coptimal\u201d controller realization problem was given in (Whidborne & Gu, 2001) based on the\nweighted closed-loop eigenvalue sensitivity index (39). We will use the index \u201cs\u201d, rather then \u201copt\u201d, to\ndenote the solution of this \u201coptimal\u201d controller realization problem. For this example, the transformation\nmatrix solution obtained using the MATLAB routine fminsearch.m given in (Whidborne & Gu, 2001) is\nT\ns\n=\n2\n6\n6\n4\n8:1477e + 3 0 0 0\n7:0104e + 3 2:2671e + 3 0 0\n6:1991e + 3 3:9989e + 3 1:1558e + 2 0\n5:6761e + 3 5:2680e + 3 3:5814e + 2 1:5299e + 1\n3\n7\n7\n5\nwith the corresponding controller realization X\ns\ngiven by\nA\ns\nC\n=\n2\n6\n6\n6\n4\n\u00009:9795e \u0000 1 \u00009:5988e \u0000 1 \u00004:7357e \u0000 3 \u00001:7234e \u0000 3\n2:1137e + 0 1:6951e + 0 \u00002:2171e \u0000 2 5:2689e \u0000 3\n\u00001:4177e + 0 6:1144e \u0000 1 6:7870e \u0000 1 \u00009:0420e \u0000 2\n1:9428e + 0 \u00002:4577e + 0 4:2234e \u0000 1 9:4079e \u0000 1\n3\n7\n7\n7\n5\n;\nB\ns\nC\n= [ 1:3451e + 2 \u00001:3439e + 2 5:3833e + 1 \u00002:5633e + 1 \u2104\nT\n;\nC\ns\nC\n= [ 1:5673e + 2 \u00001:1677e + 2 2:7885e + 1 9:4430e \u0000 1 \u2104 ; D\ns\nC\n= 0 :\nIt is obvious that the true minimum exponent bit length \fmin\ne\nfor a realization X can directly be\nobtained by examining the elements of X. The true minimum mantissa bit length \fmin\nw\nhowever can\nonly be obtained through simulation. That is, starting from a very large \f\nw\n, reduce \f\nw\nby one bit and\ncheck the closed-loop stability. The process is repeated until there appears closed-loop instability at\n\f\nw\n= \f\nwu\n. Then \fmin\nw\n= \f\nwu\n+ 1. Table 1 summarizes the various measures, the corresponding\nestimated minimum bit lengths and the true minimum bit lengths for the three controller realizationsX\n0\n,\nX\ns\nand X\nopt\n, respectively. It can be seen that the floating-point implementation of X\n0\nneeds at least 26\nbits (20 mantissa bits and 5 exponent bits) while the implementation of X\nopt\nneeds at least 13 bits (8\nmantissa bits and 4 exponent bits). The reduction in the bit length required is 13 (12-bit reduction for the\nmantissa part and 1-bit reduction for the exponent part). Comparing X\nopt\nwith X\ns\n, it can be seen that\nX\nopt\nneeds one bit less in the exponent part and one bit less in the mantissa part.\nNotice that any realization X 2 S\nC\nimplemented in infinite precision will achieve the exact per-\nformance of the infinite-precision implemented X\n0\n, which is the designed controller performance. For\nthis reason, the infinite-precision implementedX\n0\nis referred to as the ideal controller realization X\nideal\n.\nFigure 1 compares the unit impulse response of the plant output y(k) for the ideal controller X\nideal\nwith\nthose of the 8-mantissa-bit plus 5-exponent-bit implemented X\ns\nand 8-mantissa-bit plus 4-exponent-bit\n13\nimplemented X\nopt\n. The 8-mantissa-bit implemented X\n0\nquickly becomes unstable and is not shown\nhere. From Figure 1, it can be seen that the closed-loop system with the 13-bit implemented X\nopt\nis\nstable while the system with the 14-bit implemented X\ns\nis unstable. Figure 2 compares the unit impulse\nresponse of y(k) for X\nideal\nwith those of the 9-mantissa-bit plus 5-exponent-bit implemented X\ns\nand\nthe 9-mantissa-bit plus 4-exponent-bit implemented X\nopt\n. Again the 9-mantissa-bit implemented X\n0\nis\nunstable and is not shown. It can be seen that the response with the 14-bit implemented X\nopt\nis clearly\ncloser to the ideal performance than that of the 15-bit implemented X\ns\n.\nExample 2. This example is taken from a continuous-time H\n1\nrobust control example studied in (Keel\n& Bhattacharryya, 1997; Whidborne et al., 2001). The continuous-time plant model and H\n1\ncontroller\nare sampled with a sampling period of 4 ms to obtain the discrete-time plant\nA\nP\n=\n\u0014\n1:9980e + 0 \u00009:9800e \u0000 1\n1 0\n\u0015\n;\nB\nP\n= [ 1 0 \u2104\nT\n; C\nP\n= [ 3:9880e \u0000 3 \u00004:0040e \u0000 3 \u2104 ;\nand the initial realization of the digital controller\nA\n0\nC\n=\n2\n4\n2:3985e + 0 \u00001:8017e + 0 4:0317e \u0000 1\n1 0 0\n0 1 0\n3\n5\n;\nB\n0\nC\n= [ 1 0 0 \u2104\nT\n;\nC\n0\nC\n= [\u00007:3591e + 1 1:4661e + 2 \u00007:3018e + 1 \u2104 ; D\n0\nC\n= 1:2450e + 2 :\nThe MATLAB routine fminsearch.m was used to solve for the optimization problem based on the FWL\nclosed-loop stability measure presented in this paper to obtain an optimal transformation matrix\nT\nopt\n=\n2\n6\n4\n1:8515e + 2 7:2829e \u0000 1 9:7266e + 0\n1:8540e + 2 1:6951e + 1 \u00002:3477e + 0\n1:8566e + 2 3:3300e + 1 \u00001:4508e + 1\n3\n7\n5\nand the corresponding optimal realization of the digital controller X\nopt\nwith\nA\nopt\nC\n=\n2\n6\n4\n1:0006e + 0 \u00008:8718e \u0000 2 9:9092e \u0000 2\n\u00002:7168e \u0000 2 1:0178e + 0 \u00004:5738e \u0000 1\n\u00003:6546e \u0000 2 3:2513e \u0000 2 3:8007e \u0000 1\n3\n7\n5\n;\nB\nopt\nC\n= [\u00006:8999e + 0 9:2711e + 1 1:2450e + 2 \u2104\nT\n;\nC\nopt\nC\n= [\u00003:6469e \u0000 2 2:7168e \u0000 2 \u00006:1334e \u0000 1 \u2104 ; D\nopt\nC\n= 1:2450e + 2 :\nBased on the method of the weighted closed-loop eigenvalue sensitivity index (Whidborne & Gu, 2001),\nthe MATLAB routine fminsearch.m found a transformation matrix solution\nT\ns\n=\n2\n4\n1:8446e + 2 0 0\n1:8500e + 2 2:9433e + 0 0\n1:8553e + 2 5:9061e + 0 8:3753e \u0000 3\n3\n5\n14\nwith the corresponding controller realization X\ns\ngiven by\nA\ns\nC\n=\n2\n6\n4\n9:9711e \u0000 1 \u00001:5840e \u0000 2 1:8305e \u0000 5\n3:2077e \u0000 5 9:9558e \u0000 1 \u00001:1505e \u0000 3\n\u00002:8762e \u0000 2 2:5216e \u0000 1 4:0584e \u0000 1\n3\n7\n5\n;\nB\ns\nC\n= [ 5:4211e \u0000 3 \u00003:4074e \u0000 1 1:2019e + 2 \u2104\nT\n;\nC\ns\nC\n= [\u00002:9785e \u0000 2 2:6087e \u0000 1 \u00006:1154e \u0000 1 \u2104 ; D\ns\nC\n= 1:2450e + 02 :\nTable 2 summarizes the various measures, the corresponding estimated minimum bit lengths and the\ntrue minimum bit lengths for X\n0\n, X\ns\nand X\nopt\n. Obviously, the implementation of X\n0\nneeds at least 30\nbits (25 mantissa bits and 4 exponent bits) while the implementation of X\nopt\nrequires at least 12 bits (7\nmantissa bits and 4 exponent bits). It can be seen that the optimization results in a reduction of 18 bits for\nthe mantissa part. It is interesting to note that the realization X\ns\n, while reducing 16 bits in the required\n\f\nmin\nw\n, actually increases the required \fmin\ne\nby one bit, compared withX\n0\n. This is not surprising, since the\nmeasure \u0007(X) completely neglects the exponent part. Figure 3 compares the unit impulse response of\nthe plant output y(k) for the ideal controller X\nideal\nwith those of the 14-bit implemented X\ns\n(8 mantissa\nbits and 5 exponent bits) and the 14-bit implemented X\nopt\n(9 mantissa bits and 4 exponent bits). It can\nbe seen that the closed-loop system with the 14-bit implementedX\nopt\nis stable while the system with the\n14-bit implemented X\ns\nis unstable. Figure 4 compares the unit impulse response of y(k) forX\nideal\nwith\nthose of the 15-bit implemented X\ns\n(9 mantissa bits and 5 exponent bits) and the 15-bit implemented\nX\nopt\n(10 mantissa bits and 4 exponent bits). The performance of the 15-bit implementedX\nopt\nis clearly\ncloser to the ideal performance than that of the 15-bit implemented X\ns\n.\n7 Conclusions\nThe closed-loop stability issue of finite-precision realizations has been investigated for digital controller\nimplemented in floating-point arithmetic. A new computationally tractable FWL closed-loop stability\nmeasure has been derived for floating-point controller realizations. Unlike the existing methods, which\nonly consider the mantissa part of floating-point scheme, the proposed measure takes into account both\nthe exponent and mantissa parts of floating-point format. It has been shown that this new measure yields\na more accurate estimate for the FWL closed-loop stability. Based on this FWL closed-loop stability\nmeasure, the optimal controller realization problem has been formulated, which can easily be solved\nfor using standard numerical optimization algorithms. Two numerical examples have demonstrated that\nthe proposed design procedure yields computationally efficient controller realizations suitable for FWL\nfloat-point implementation in real-time applications.\n15\nAcknowledgements\nJ. Wu and S. Chen wish to thank the support of the UK Royal Society under a KC Wong fellowship\n(RL\/ART\/CN\/XFI\/KCW\/11949). J. Wu and J. Chu wish to thank the support of the National Natural\nScience Foundation of China under Grant 60174026.\nReferences\nChen, S., Istepanian, R.S.H., Wu, J., & Chu, J. (2000). Comparative study on optimizing closed-loop\nstability bounds of finite-precision controller structures with shift and delta operators. Systems and\nControl Letters 40(3), 153\u2013163.\nChen, S., Wu, J., Istepanian, R.S.H., & Chu, J. (1999). Optimizing stability bounds of finite-precision\nPID controller structures. IEEE Trans. Automatic Control 44(11), 2149\u20132153.\nFialho, I.J., & Georgiou, T.T. (1994). On stability and performance of sampled-data systems subject to\nwordlength constraint. IEEE Trans. Automatic Control 39(12), 2476\u20132481.\nFialho, I.J., & Georgiou, T.T. (1999). Optimal finite wordlength digital controller realization. In Proc.\nAmerican Control Conf. (San Diego, USA), June 2-4, 1999, 4326\u20134327.\nGevers, M., & Li, G. (1993). Parameterizations in Control, Estimation and Filtering Problems: Accu-\nracy Aspects. London: Springer Verlag.\nIstepanian, R.S.H., & Whidborne, J.F., eds. (2001). Digital Controller Implementation and Fragility:\nA Modern Perspective. Godalming, UK: Springer Verlag.\nIstepanian, R.S.H., Whidborne, J.F., & Bauer, P. (2000). Stability analysis of block floating point digital\ncontrollers. In Proc. UKACC Int. Conf. Control 2000 (Cambridge, UK), CD-ROM, 6 pages.\nKallioja\u00a8rvi, K., & Astola, J. (1996). Roundoff errors in block-floating-point systems. IEEE Trans.\nSignal Processing 44(4), 783\u2013790.\nKeel, L.H., & Bhattacharryya, S.P. (1997). Robust, fragile, or optimal? IEEE Trans. Automatic Control\n42(8), 1098\u20131105.\nLi, G. (1998). On the structure of digital controllers with finite word length consideration. IEEE Trans.\nAutomatic Control 43(5), 689\u2013693.\n16\nLi, G., & Gevers, M. (1990). Optimal finite precision implementation of a state-estimate feedback\ncontroller. IEEE Trans. Circuits and Systems CAS-38(12), 1487\u20131499.\nLi, G., Wu, J., Chen, S., & Zhao, K.Y. (2000). Optimum structures of digital controllers in sampled-data\nsystems: a roundoff noise analysis. Submitted to IEE Proc. Control Theory and Applications.\nLiu, K., Skelton, R., & Grigoriadis, K. (1992). Optimal controllers for finite wordlength implementa-\ntion. IEEE Trans. Automatic Control 37(9), 1294\u20131304.\nMadievski, A.G., Anderson, B.D.O., & Gevers, M. (1995). Optimum realizations of sampled-data\ncontrollers for FWL sensitivity minimization. Automatica 31(3), 367\u2013379.\nMa\u00a8kila\u00a8, P.M. (1999). Fragility and robustness puzzles. In Proc. 1999 American Control Conf. (San\nDiego, USA), pp.2914\u20132919.\nMolchanov, A.P., & Bauer, P.H. (1995). Robust stability of digital feedback control systems with\nfloating point arithmetic. In Proc. 34th IEEE Int. Conf. Decision and Control (New Orleans,\nUSA), pp.4251\u20134258.\nMoroney, P., Willsky, A.S., & Houpt, P.K. (1980). The digital implementation of control compensators:\nthe coefficient wordlength issue. IEEE Trans. Automatic Control AC-25(4), 621\u2013630.\nRalev, K.R., & Bauer, P.H. (1999). Realization of block floating-point digital filters and application to\nblock implementations. IEEE Trans. Signal Processing 47(4), 1076\u20131086.\nRao, B.D. (1996). Roundoff noise in floating point digital filters. Control and Dynamic Systems 75,\n79\u2013103.\nRink, R.E., & Chong, H.Y. (1979). Performance of state regulator systems with floating point compu-\ntation. IEEE Trans. Automatic Control 24, 411\u2013421.\nWhidborne, J.F., & Gu, D. (2001). Optimal finite-precision controller and filter realizations using\nfloating-point arithmetic. Research Report EM2001\/07, Department of Mechanical Engineering,\nKing\u2019s College London.\nWhidborne, J.F., Istepanian, R.S.H., & Wu, J. (2001). Reduction of controller fragility by pole sensi-\ntivity minimization. IEEE Trans. Automatic Control 46(2), 320\u2013325.\nWhidborne, J.F., Wu, J., & Istepanian, R.S.H. (2000). Finite word length stability issues in an l\n1\nframework. Int. J. Control 73(2), 166\u2013176.\n17\nWilliamson, D. (1991). Digital Control and Implementation. Englewood-Cliffs, NJ: Prentice-Hall.\nWilliamson, D., & Kadiman, K. (1989). Optimal finite wordlength linear quadratic regulation. IEEE\nTrans. Automatic Control 34(12), 1218\u20131228.\nWu, J., Chen, S., Li, G., Istepanian, R.S.H., & Chu, J. (2000). Shift and delta operator realizations for\ndigital controllers with finite-word-length considerations. IEE Proc. Control Theory and Applica-\ntions 147(6), 664\u2013672.\nWu, J., Chen, S., Li, G., Istepanian, R.S.H., & Chu, J. (2001). An improved closed-loop stability related\nmeasure for finite-precision digital controller realizations. IEEE Trans. Automatic Control 46(7),\n1162\u20131166.\nRealization \u001a\n1\n^\n\f\nmin\n1\n\u0016\n1\n^\n\f\nmin\nw1\n\r\n^\n\f\nmin\ne\n\f\nmin\n\f\nmin\nw\n\f\nmin\ne\nX\n0\n2.6644e-9 30 8.5182e-8 23 3.1971e+1 5 26 20 5\nX\ns\n4.7588e-6 19 8.7907e-5 13 1.8473e+1 5 15 9 5\nX\nopt\n9.5931e-6 18 1.5229e-4 12 1.5875e+1 4 13 8 4\nTable 1: Various measures, corresponding estimated minimum bit lengths and true minimum bit lengths\nfor three controller realizations X\n0\n,X\ns\nandX\nopt\nof Example 1.\nRealization \u001a\n1\n^\n\f\nmin\n1\n\u0016\n1\n^\n\f\nmin\nw1\n\r\n^\n\f\nmin\ne\n\f\nmin\n\f\nmin\nw\n\f\nmin\ne\nX\n0\n2.6767e-11 37 2.8122e-10 31 1.0506e+1 4 30 25 4\nX\ns\n3.1047e-6 20 7.6679e-5 13 2.4697e+1 5 15 9 5\nX\nopt\n5.8446e-6 19 8.2771e-5 13 1.4162e+1 4 12 7 4\nTable 2: Various measures, corresponding estimated minimum bit lengths and true minimum bit lengths\nfor three controller realizations X\n0\n,X\ns\nandX\nopt\nof Example 2.\n18\n0 500 1000 1500\n\u22124\n\u22122\n0\n2\n4\n6\n8\n10 x 10\n\u22123\n k\n \ny( \nk)\n Xideal\n X\ns\n      \n X\nopt  \nFigure 1: Unit impulse response y(k) forX\nideal\n, 14-bit implementedX\ns\n(8 mantissa bits and 5 exponent\nbits) and 13-bit implemented X\nopt\n(8 mantissa bits and 4 exponent bits) of Example 1.\n19\n0 500 1000 1500\n\u22126\n\u22124\n\u22122\n0\n2\n4\n6\n8\n10 x 10\n\u22123\n k\n \ny( \nk)\n Xideal\n X\ns\n      \n X\nopt  \nFigure 2: Unit impulse response y(k) forX\nideal\n, 15-bit implementedX\ns\n(9 mantissa bits and 5 exponent\nbits) and 14-bit implemented X\nopt\n(9 mantissa bits and 4 exponent bits) of Example 1.\n20\n0 5000 10000 15000\n\u22120.015\n\u22120.01\n\u22120.005\n0\n0.005\n0.01\n0.015\n k\n \ny( \nk)\n Xideal\n X\ns\n      \n X\nopt  \nFigure 3: Unit impulse response y(k) forX\nideal\n, 14-bit implementedX\ns\n(8 mantissa bits and 5 exponent\nbits) and 14-bit implemented X\nopt\n(9 mantissa bits and 4 exponent bits) of Example 2.\n21\n0 5000 10000 15000\n\u22125\n0\n5\n10\n15\nx 10\u22123\n k\n \ny( \nk)\n Xideal\n X\ns\n      \n X\nopt  \nFigure 4: Unit impulse response y(k) forX\nideal\n, 15-bit implementedX\ns\n(9 mantissa bits and 5 exponent\nbits) and 15-bit implemented X\nopt\n(10 mantissa bits and 4 exponent bits) of Example 2.\n22\n"}