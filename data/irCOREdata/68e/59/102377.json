{"doi":"10.1109\/TCE.2008.4637642","coreId":"102377","oai":"oai:epubs.surrey.ac.uk:1836","identifiers":["oai:epubs.surrey.ac.uk:1836","10.1109\/TCE.2008.4637642"],"title":"A rate control technique for off line H.264\/AVC video coding using subjective quality of video","authors":["Yasakethu, SLP","Fernando, WAC","Adedoyin, S","Kondoz, A"],"enrichments":{"references":[],"documentType":{"type":1}},"contributors":[],"datePublished":"2008-08","abstract":null,"downloadUrl":"","fullTextIdentifier":null,"pdfHashValue":null,"publisher":"IEEE-INST ELECTRICAL ELECTRONICS ENGINEERS INC","rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:epubs.surrey.ac.uk:1836<\/identifier><datestamp>\n      2017-10-31T14:03:19Z<\/datestamp><setSpec>\n      74797065733D61727469636C65<\/setSpec><setSpec>\n      6469766973696F6E733D656E67616E64706879736963616C736369656E636573:656C656374726F6E6963656E67696E656572696E67:63637372<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/epubs.surrey.ac.uk\/1836\/<\/dc:relation><dc:title>\n        A rate control technique for off line H.264\/AVC video coding using subjective quality of video<\/dc:title><dc:creator>\n        Yasakethu, SLP<\/dc:creator><dc:creator>\n        Fernando, WAC<\/dc:creator><dc:creator>\n        Adedoyin, S<\/dc:creator><dc:creator>\n        Kondoz, A<\/dc:creator><dc:publisher>\n        IEEE-INST ELECTRICAL ELECTRONICS ENGINEERS INC<\/dc:publisher><dc:date>\n        2008-08<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        text<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/epubs.surrey.ac.uk\/1836\/1\/fulltext.pdf<\/dc:identifier><dc:identifier>\n          Yasakethu, SLP, Fernando, WAC, Adedoyin, S and Kondoz, A  (2008) A rate control technique for off line H.264\/AVC video coding using subjective quality of video   IEEE T CONSUM ELECTR, 54 (3).  pp. 1465-1472.      <\/dc:identifier><dc:relation>\n        10.1109\/TCE.2008.4637642<\/dc:relation><dc:language>\n        EN<\/dc:language><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/epubs.surrey.ac.uk\/1836\/","10.1109\/TCE.2008.4637642"],"year":2008,"topics":[],"subject":["Article","PeerReviewed"],"fullText":"S. L. P. Yasakethu et al.: A Rate Control Technique for Off Line H.264\/AVC Video Coding Using Subjective Quality of Video \nContributed Paper \nManuscript received July 15, 2008                                              0098 3063\/08\/$20.00 \u00a9 2008 IEEE \n1465\nA Rate Control Technique for Off Line H.264\/AVC Video Coding \nUsing Subjective Quality of Video  \nS. L. P. Yasakethu, W. A. C. Fernando, Senior Member IEEE, S. Adedoyin and A. Kondoz, Member IEEE \n  \n \nAbstract \u2014 In this paper, we propose a rate control technique \nfor H.264\/AVC using subjective quality of video for off line video \ncoding. We propose to use Video Quality Metric (VQM) with an \nevolution strategy algorithm, which is capable of identifying the best \npossible quantization parameters for each frame to encode the video \nsequence such that it would maximize the subjective quality of the \nentire video sequence subjected to the target bit rate. Simulation \nresults suggest that the proposed technique can improve the RD \nperformance of the H.264\/AVC codec significantly. With the \nproposed technique, up to 35% bit rate reduction can be achieved at \nthe same video quality. Furthermore, results show that the proposed \ntechnique can improve the subjective quality of the encoded video \nsignificantly for video sequences especially with high motion.1 \nIndex Terms \u2014 Video coding, H.264\/AVC, subjective quality  \nI. INTRODUCTION \nUnprecedented growth of consumer apatite for multimedia \ncontents has become the major driving force governing \ntoday\u2019s dynamics of the consumer electronic market. Due to \nthe ever falling cost, multimedia enabled consumer electronic \ndevices are within the reach of the most of the global \npopulation and therefore, they are no longer considered as \nluxury devices. Consequent sheer demand for consumer \nelectronic devices, in return, paves the way to new \ntechnological innovations and advancements within the \nconsumer electronic domain that reduces the cost even further \nwhile including more demanding functionalities to existing \ndevices. While this tremendous technological innovations and \ngrowth of consumer demand touches every corner of the \nconsumer electronic domain, multi-functional portable devices \nhas won unimaginable attention. The best example is fordable \nconsumer video devices such as DVD players. Inline with \nthese market dynamics, the demand for more cost effective \nmultimedia enabling technologies with efficient usage of \nsystem resources such as bandwidth and memory space, are \ngoing to be very important in the future. \n \nVideo coding technologies have evolved significantly \nduring the past decade, dominated by the work on ISO\/IEC \nMPEG and ITU-T H.26x standards based techniques. These \napproaches were characterized by a highly complex video \nencoder structure and a significantly lower complex decoder \nstructure as demanded by many popular applications \ninvolving one-to-many topologies. Video capturing and \n \n1 This work was supported in part by the European Commission IST FP6  \nprogram, under VISNET II project, a European Network of Excellence. \n  Authors are with the Centre for Communication System Research, \nUniversity of Surrey, Guildford, GU2 7XH, UK (e-mail: \n{S.Yasakethu, W.Fernando, S.Adedoyin,  A.Kondoz}@surrey.ac.uk). \nencoding was conventionally limited compared to the largely \nspread listeners. In all these work, all encoders used objective \nbased quality metrics to evaluate the video quality. They are \nsimple to calculate and are mathematically easy to deal for \noptimization purposes. However, it is well-known that these \nmetrics are not suitable to describe the subjective degradation \nperceived by a viewer. Even though these metrics provide a \nsimple way to evaluate the video quality, they are not well \nadapted for assessing the quality of the image as perceived by \nthe human visual system. Another drawback of these metrics \nis that they evaluate the original image with its counterpart \nencoded\/decoded image. They are not adapted to evaluate the \ntemporal relation existing in a video sequence. Therefore, we \nbelieve that video coding based on subjective quality \nassessment produces better optimized results since they are \nbased on actual human perception.  \n \nThe objective of this paper is to present a novel rate-\ncontrolling algorithm based on Evolution Strategy (ES) for \noff-line H.264\/AVC video encoding by considering subjective \nquality of the encoded video. The rest of the paper is \norganized as follows, in section II, an overview of the related \nworks in literature is presented. In section III, we present the \nproposed solution. Results from our experiments and potential \napplications of the proposed technique are presented in \nsections IV and V respectively. Finally, section VI presents \nthe conclusion and future works.  \nII. RELATED WORK \nH.264\/AVC video compression scheme utilizes motion \ncompensation, differential pulse code modulation and \ntransform coding to perform compression with the help of \nquantization and variable length coding (VLC) [1]. The trivial \nproblem of video encoders based on these is that their output \nbit rate fluctuates over the video sequence. This is due to the \nvariation of statistical properties in the encoded video \nsequence and the different picture types with different \ncompression ratios. Even though variable bit rate (VBR) \napplications can accommodate for such data rate deviations, \nfor constant bit rate (CBR) applications such as in video \nstorage, bursty data rates cannot be tolerated.  A First-In-First-\nOut (FIFO) buffer with a feed back mechanism at the encoder \noutput is used to solve this problem. The buffer accepts the \nbursty encoded data stream and then produces a smooth data \nstream as its output. The encoder monitors the state of the \nbuffer continuously through a feedback mechanism, according \nto which, the encoder adjusts the output data rate by \ncontrolling the quantization step size to prevent the buffer \nover flow or under flow errors. A number of authors have \nAuthorized licensed use limited to: University of Surrey. Downloaded on December 3, 2009 at 12:20 from IEEE Xplore.  Restrictions apply. \nIEEE Transactions on Consumer Electronics, Vol. 54, No. 3, AUGUST 2008 1466 \nproposed improved algorithms to optimize the performance of \nthe encoding phenomenon based on several rate distortion \nconcepts [2][3][4]. These algorithms have concentrated on \nusing objective statistical quality measurements for rate \ndistortion optimizations. But it is a well known fact that \nsimple statistical measurements such as mean average \ndifference (MAD) and mean square error (MSE) do not \nnecessarily accurately model perceptual quality due to their \nlack of correlations with the human visual system (HVS) \ncharacteristics [5]. Ultimately, when it comes to the quality of \nexperience of the end-user, the visual quality of the encoded \nvideo sequence becomes the most significant feature. \nHowever, manipulating the quantization step size to control \nthe data rate directly affects the perceived picture quality. For \nexample higher quantization step size will lead to a poor \nvisual quality and vice versa. Therefore deciding on the best \nquantization parameters to maximize the perceived video \nquality subjected to a targeted bit rate is a challenging \nproblem.  \nRate control algorithms proposed by different authors can \nbe categorized into two major categories based on whether \nthey are predictive or pre-analytical.  Predictive algorithms \ndetermine the quantization settings for each macroblock based \non the current macroblock and previously encoded \nmacroblocks. In contrast, in delayed-decision pre-analysis \nalgorithms quantization settings may be based on future \nmacroblocks or future frames. Delayed decision scheme can \nbe further divided into two classes; single or multiple frames \ndelayed. \n \nA. Predictive rate control schemes \nIn this scheme, the value of the quantization parameter, \nmquant[6] is determined based on the buffer occupancy level. \nThis method is known as direct buffer-state feedback scheme. \nThis control strategy is applied in macroblock level. Thus, it is \ncalled a local control scheme. This strategy results in a quality \nvariation within the frame. Global control scheme can \nalternatively be used to eliminate this problem. Such schemes \nassign a single control parameter for each frame. The value of \nmquant can be kept constant or change adaptively but \nindependent of the rate control in order to improve the visual \nquality. One good example of a predictive rate control scheme \nis MPEG Test Model 5 (TM5)[7], in which bit rate is \ncontrolled by the value of mquent assigned to each \nmacroblock. mquent is an integer valued variable which lies \nbetween 1 and 31. This algorithm has no particular \nmechanism to prevent buffer overflowing and under flowing. \nThree different buffer types are used each picture type instead \nof single buffer. Hence the control may fail, especially when \nthe buffer size is small. Another drawback in TM5 scheme is \nthat the algorithm does not guarantee Video Buffer Verifier \n(VBV) [6] compliance. Therefore resulting bit stream may \nhave VBV overflows as well as underflows. These limitations \njustify the need of further research to formulate a better rate \ncontrol algorithm. Number of authors has proposed improved \nalgorithms to optimize the performance of the TM5 algorithm \nbased on rate distortion concepts [2][4][8].  \nB. Delayed-decision bit rate control \nThe quantization parameters are determined after analyzing \none or more frames of the video sequence. Hence, a better \nquality can be achieved. Most of the researches on rate control \nbelong to this category and most of them pre-analyze a single \nframe or a Group of Pictures (GOP). For the single frame \ndelay case, measuring the frame block activities from the \ncurrent frame before it is encoded, rather than depending on \nthe value calculated for the previous picture can directly \nimprove the TM5 algorithm. Another TM5 based method uses \na constant q to quantize and encode all the macroblocks in the \nframe to get a bit-usage profile, and then uses the profile \nduring the real encoding phase to get better prediction and \ncontrol on the rate. Another method measures the entropy and \nuses it to predict the bits at macroblock level to get better \ncontrol on the rate. \n \nA common problem of these algorithms is that, the quality, or \nthe distortion, is not measured and controlled explicitly. To cope \nwith this problem, another class of rate control methods has \nbeen proposed which take the distortion into account. The goal \nof these methods is to determine the best achievable quality for \na given channel rate and buffer size, if the entire video sequence \nor part of its, future frames are known in advance. \n \nThe objective of the bit rate optimization in the context of \nvideo coding is to encode the video sequence with the \nmaximum possible decoded video quality under the given bit \nbudget. This problem can clearly be reduced to a constraint \noptimization problem. Various techniques have been proposed \nto solve this problem. In [4][9] Lagrange and minimax \ntechniques are proposed to get the optimum picture quality. \nHowever, the major disadvantage of these techniques is the \nsub-optimality in the bit rate-picture quality trade off. Even \nthrough the true global optimal performances can be obtained \nwith the trellis-based algorithm proposed by [8] its use is \nextremely limited due to the heavy coding complexity of the \nalgorithm since it traverses all the quantization steps.  \n \nC. Rate controlling in H.264\/AVC \nOne of the latest standards in video coding is called H.264 \n(also called MPEG-4 AVC, Advanced Video Coding defined \nin MPEG-4 Part 10)[10]. Compared with previous standards, \nH.264 achieves up to 50% improvement in bit rate efficiency. \nIt has been adopted by many application standards such as HD \nDVD, DVB-H, HD-DTV, etc. Therefore, its implementation \nis a very popular research topic to date.  \n \nThe rate control algorithm used in H.264\/AVC dynamically \nadjusts encoder parameters to achieve a target bit rate. It allocates \nbit budget for each group of pictures, individual picture and sub-\npicture in a video sequence. Rate control is not a part of the \nH.264 standard, but the standards group has issued non-\nnormative guidance to aid in implementation. Block based hybrid \nvideo coding schemes such as H.264 and MPEG-4 are \nconsidered to be lossy processes. They try to achieve \ncompression not only by removing the redundant temporal and \nspatial information from the video sequence but also attempt to \nAuthorized licensed use limited to: University of Surrey. Downloaded on December 3, 2009 at 12:20 from IEEE Xplore.  Restrictions apply. \nS. L. P. Yasakethu et al.: A Rate Control Technique for Off Line H.264\/AVC Video Coding Using Subjective Quality of Video 1467\nmake quality compromises in ways that would have minimum \neffects on perceived quality. In particular the quantization \nparameter\/step size (QP) regulates the amount of spatial detail \nretained. For example when QP is small, much of the information \nis saved and when QP is large much of the information is \ndiscarded to reduce the bit rate at the price of increase in \ndistortion. Therefore the decision on which the trade-off between \nthe visual quality of the encoded video sequence and its encoded \nbit rate plays a significant role when comes to video applications. \n \nOpen loop, variable bit rate encoding mechanism is illustrated \nin Figure 1. The uncompressed video and the QP value is \nsupplied by the user. As the source video is encoded a fairly \nconstant quality video sequence is obtained, but the bit rate may \nvary dramatically. This is due to the complexity of the picture \nbeen continually changed in a real video sequence. But in reality \nconstrains such as network bandwidth, decoder buffer size and \nstorage capacity forces the video to be encoded at a more nearly \nconstant bit rate. Close loop rate control mechanism used for \nsuch constant bit rate applications is shown in Figure 2. To \nachieve a more or less a constant bit rate, QP values must be \ndynamically varied based upon estimates of the source \ncomplexity such that each picture gets an appropriate amount of \nbits to work with. Therefore rather than specifying a QP value at \nthe input, the user specifies the target bit rate of the application. \n \n \nFig.  1. Open loop encoding mechanism \n \n \nFig.   2. Close loop rate control mechanism \nThe heart of the rate-controlling algorithm is the evaluation \nof the relationship between QP, bit rate and the encoding \ncomplexity. Since the QP can only influence the information \ncarried in the residual, the bits and the complexity terms are \nonly associated with the residuals. To evaluate the above \nrelation mean average difference (MAD) of the prediction \nerror is used for the encoding complexity. The mean average \ndifference is defined as shown in equation (1), where i and  j \nrefers to the pixel locations of the image. \n| | | |ij ij ij\nij ij\nMAD residual source prediction= = \u2212\u2211 \u2211    (1) \nThe rate control algorithm uses the MAD value and evaluates \nthe residual bits as shown by equation (2).  \n1 2\n2\nC MAD C MADResidualBits\nQP QP\n\u23a1 \u23a4 \u23a1 \u23a4\u00d7 \u00d7= +\u23a2 \u23a5 \u23a2 \u23a5\u23a3 \u23a6 \u23a3 \u23a6\n        (2) \nThe coefficients C1 and C2 are estimated empirically, by \nproviding hooks in the encoder for extracting the residual \ncoefficients. Having established the model shown in equation \n(2), the QP value needed for encoding could be determined, \nwhen the target amount Residual Bits is determined. \n \nD. Evolutionary Strategies \nEvolutionary computation (EC) theories were developed \noriginally from observing natural evolution of life form. \nBecause of this, the terminology surrounding the field of EC \nis full of analogies with natural evolutionary process. It was \nparticularly from Darwin\u2019s theories [19] that the best \ntechniques regarding the optimization, modeling and the \ncontrol of unknown processes were developed. EC has long \nbeen exploited in the video-coding field. A very well known \nform of EC called Genetic Algorithm (GA) was used to \nperform image registration as part of a larger Digital \nSubtraction Angiography (DAS) system [20]. Subsequently, \nGA search algorithm has been applied for motion estimation \n[21][22]. Hardware implementation of Four-Step genetic \nsearch algorithm was proposed in [21].  \nSimilarly Evolutionary Strategies (ES) were developed to \nsolve complex optimizations problem by Rechenberg and \nSchwefel in the 1960\u2019s [17]. It employs simple algorithmatic \nmethods based on adding random noise to each solution.  Due \nto Schewel research a commonly based method was created \nthat used a mutation mechanism that employs adding a \nnumber from a Gaussian distributed curve with expectation of \nzero mean and a given variance. Rechenberg further \ndeveloped the algorithm introducing the (1+\u03bb) [18], which \nlater transitioned to the (\u03bc+\u03bb). This notation characterizes the \nselection mechanism. The best individuals out of the union of \nparents and offspring survive. \n III. PROPOSED SOLUTION  \nMost pictures, still or moving, are meant to be viewed by \npeople ultimately. Accordingly, image processing, \ntransmission, or synthesis systems should be tailored   to    the \nproperties of human visual perception. When comes to quality \nof experience (QoE) of video applications, viewers do not \nbother about how the application is prepared, they are more \nconcerned about the level of visual quality that they \nexperience. Therefore the decision on which the trade-off \nbetween the visual quality of the encoded video sequence and \nits encoded bit rate plays a significant role when comes to \nCBR video applications. But currently used rate controlling \ntechniques do not take in to account the HVS parameters \nwhen they evaluate suitable QP values for encoding. Since \nthey use statistical measurements similar to the one presented \nin equation (1) where it only examines the difference in pixel \nvalues, the properties of the HVS is not considered. \nAuthorized licensed use limited to: University of Surrey. Downloaded on December 3, 2009 at 12:20 from IEEE Xplore.  Restrictions apply. \nIEEE Transactions on Consumer Electronics, Vol. 54, No. 3, AUGUST 2008 1468 \nFurthermore these techniques are based on pre \nframe\/macroblock basis and QPs per each frame\/macroblock is \nassigned accordingly. But ultimately user visual quality \nevaluation is based on the entire visual quality of the video \nrather than a frame\/macrablock basis. If quality estimation is \ncarried out frame\/macroblock basis it could easily mislead the \ntrue visual experience of the user. Therefore the human \njudgment on visual quality would be more accurate if the \nsubjective quality of the entire video sequence could be \nevaluated at the encoder, for particular levels of quantization per \nframe\/macroblock, subjected to a target bit rate defined by the \napplication. In this paper, we focus on off-line video coding \napplications such as storages, VCDs, DVDs where the more \nemphasis is given to maximizing subjective quality, subject to \ncertain application limitations (e.g. storage capacity).  \nNumbers of subjective quality metrics have been proposed by \ndifferent authors in the literature such as Video Quality Mertic \n(VQM)[11], Perceptual Video Quality Measure (PVQM)[12], \nand Moving Picture Quality Metric (MPQM)[13]. We propose \nto use Video Quality Metric (VQM) developed by the Institute \nof Telecommunication Sciences (ITS) to be used in our \ntechnique to subjectively assess the video quality and to \nevaluate its correlations with the encoding parameters. VQM is \na standardized method of measuring video quality that closely \npredicts the subjective quality ratings that would be obtained \nfrom a panel of human. Due to its excellent performance in the \nInternational Video Quality Expert\u2019s Group (VQEG) Phase II \nvalidation tests [14], the NTIA\/ITS VQM methods were \nadopted by the ANSI as a U.S. national standard and as \ninternational ITU Recommendations in 2004 [15]. VQM \nmeasures the perceptual effects of video impairments including \nblurring, jerky\/unnatural motion, global noise, block distortion \nand colour distortion, and combines them in to a single metric. \nThe technology is covered by four U.S. patents owned by \nNTIA\/ITS [15]. \nThe proposed methodology for modifying the rate control \nmechanism for off-line video encoding, incorporating HVS \nparameters to optimize the encoding mechanism is discussed \nin this section. Figure 3 illustrates the proposed technique. \nRate control problem has been defined using the subjective \nquality of the output video (VQM) and the target and actual \nencoded bit rates. We propose a novel Evolution Strategy \nbased algorithm to evaluate the optimum solution to maximize \nthe encoded subjective quality subjected to the bit rate \nconstrained defined by the application. \nA. Proposed Evolutionary Strategy (ES) \nSearch points in ES represent an N-dimensional object \nparameter of vectors. With each search point representing \nQuantization Parameters for each frame of the video sequence. \nES typically uses deterministic selection in which the worst \nsolutions are purged from the population based directly on \ntheir fitness function value. The (\u00b5+\u03bb)-Evolutionary Strategy \ndemonstrated in Figure 4 is used in this work with an \nincreasing level of imitation of biological evolution[23], \nwhere \u00b5 means the total number of parents in previous \npopulation, and \u03bb stands for the number of offspring generated \nfrom mutated parents.  \nB. Chromosome Representation \nN-dimensional object vectors represent a chromosome. This is \ndetermined by the video sequences length. Each object vector \nrepresents a quantization value within the range of [1 - 51]. \nEach object vector has two parameters associated to it as \nshown in equation (3). Equation (4) shows a real valued \nrepresentation of the chromosome and each element \nassociated strategy parameter. The object parameter x  \nrepresents the actual value of the quantization parameter and \nthe strategy parameter \u03c3 represents the mutation step size. \nLarger values of the strategy parameter force a large change in \nthe quantization size for a given frame while small changes \ncauses more localized search. The strategy parameter takes the \nvalue from n\u22121  and is user defined. The importance of a \nchromosome in a population is defined by the fitness function.  \n32143421\n\u03c3\n\u03c3\u03c3 n\nx\nnxx ......, 11                 (3) \n \n32143421\n\u03c3\n3,1,2,115,20,45,03\nx\n               (4) \n \n   \n \nFig.  3.  Proposed technique embedded to the H.264\/AVC Codec \n \n \nFig.  4.  (\u00b5+\u03bb)-Evolutionary Strategy-based algorithm \n \n \n    C. Population Generation \n    Members of the population are made up of randomly \ngenerated chromosomes.  The initial population size is set to 3 \nand the number of offspring produced in each generation is \nfixed to 6 individuals (1:2 mutation ratios). These along with \nparents are used to select the parents for the next generation \nIndividuals deemed unfit are purged from the population \nbefore any new offspring\u2019s are produced. \nAuthorized licensed use limited to: University of Surrey. Downloaded on December 3, 2009 at 12:20 from IEEE Xplore.  Restrictions apply. \nS. L. P. Yasakethu et al.: A Rate Control Technique for Off Line H.264\/AVC Video Coding Using Subjective Quality of Video 1469\n    D. Fitness Function \nThe fitness function divides the strong from the weak and is the \ndriving force of the selection mechanism. The chromosomes with \nthe strongest fitness values are selected to reproduce offspring.  \nThe fitness function is based on,  \n[ ] 1\n \nencoded bitrate\nFitness VQM\ntraget bitrate\n\u03bb= \u2212 \u2212\u23a1 \u23a4\u239b \u239e\u23a2 \u239c \u239f\u23a5\u239d \u23a0\u23a3 \u23a6\n    (5) \nIn equation (5), target bit rate is specified by the off-line video \ncoding application, where as encoded bit rate and the VQM \nvalue relates to the properties of the random individuals \naccording to their encoded parameters. \u03bb , defines the weight-\nage or else the significance between the encoded bit rate and the \nVQM score with respect to the application. The value of \u03bb  is \nexperimentally decided, allowing for fast convergence of the \nalgorithm to its termination criteria discussed below. A VQM \nscore of 0 implies the best visual quality and 1 implies the worst \nwith respect to the original video. For quality evaluation VQM \ntakes the entire encoded sequence where by more, accurate user \nexperience could be estimated at the encoder. \n    E. Mutation \nThe mutation stage is the decisive part in generating new \noffspring. It is based on Gaussian distribution with mean \n\u03b5  and standard deviation \u03c3 . The mean is always set to zero \nand the distribution is symmetric to this, thus allowing the \npossibility of drawing a random number with a given \nmagnitude to be a rapidly decreasing function of the standard \ndeviation \u03c3 . Thus the value of \u03c3 value is a parameter of the \nalgorithm that determines the extent to which given values \nof ix  are perturbed by the mutation operator. The mutation \nstep size also undergoes mutation and this mechanism is \nspecified by the following formula.  WhereT is the learning  \n)1,0(' NTe \u00d7\u00d7=\u03c3\u03c3                (6) \nrate and \u039d(0,1) represents a number drawn  from a Gaussian \ndistribution with mean 0 and  standard deviation 1. The \nmutated '\u03c3  is then multiplied by )1,0(iN . This value is then \nadded to object parameter to produce a new offspring 'ix  \ndefined by equation (7).  \n)1,0('' iii Nxx \u00d7+= \u03c3              (7) \nWhere iN  is a new draw from the Gaussian distribution. To \nstop the algorithm producing standard deviations close to zero \nthe following rule is enforced.  \n00 '' \u03b5\u03c3\u03b5\u03c3 =\u21d2=<   Where 10 =\u03b5              (8) \nAllowing \u03c3 to be controlled by the algorithm coevolves both \nthe strategy parameter and the solution.  This allows each \nindividual frame to have its own mutation operator. Thus, if a \nframe already has a suitable QP value the strategy parameter \nwill evolve to small number to refine the QP value. \nF. Termination \nThe algorithm was terminated when an individual meets the \nflowing criteria. \n  \n \n& threshold\nencoded bitrate traget bitrate\nif\nVQM VQM\n\u2264\n\u2264\n\u23a1 \u23a4\u23a2 \u23a5\u23a3 \u23a6         (9) \nA numerical value for thresholdVQM is determined by \nobserving the each video sequence for different encoded \nlevels.  If the algorithm fails to find an individual to meet the \nabove criteria the algorithm is terminated after 15 generations \nto avoid additional delay.  \n \nIV. SIMULATION RESULTS \nSimulations of the proposed ES rate control mechanism is \ncarried out for three test video sequences, Soccer (high \nmotion), Foreman (medium to low motion) and Claire (low \nmotion), to validate the proposed technique for different \nmotion levels. The simulation test conditions are first \nexplained and then the results are analyzed with the state of \nthe art in conventional video coding.  \nThe test sequences are in YUV 4:2:0 sub-sampling format, \nwith QCIF resolution (176 \u00d7 144) and a frame rate of 30 fps \nwithin a GOP structure of IPPP. Results are compared with \nthe H.264\/AVC codec [16], which is simulated in IPPP GOP \nstructure (JM10.1\/Baseline profile). The value of \u03bb in the \nfitness function was experimentally decided and set to 4 for all \nsimulations. Target output bit rate was varied according to the \nvideo sequence and it was fixed for both H.264\/AVC and for \nthe proposed technique. \n \nA. RD Performance \nFigure 5-10 represent the simulation results for the \nproposed solution and for the H.264\/AVC under similar test \nconditions. H.264\/AVC encoded video sequence has been \nused to generate its VQM output together with the original \nvideo sequence to present its RD performances. Both \nsubjective (VQM) and objective (PSNR) results are presented \nto analyze the performance of the algorithm. Results clearly \nsuggest that the proposed rate control technique produces \nsignificant improvements compared to the H.264\/AVC. Up to \n35% bit rate reduction is possible with the proposed technique \nfor similar subjective quality against the H.264\/AVC codec. \nResults further suggest that the proposed technique can \nimprove the subjective quality of the video output \nsignificantly for video sequences with high motion compared \nto the H.264\/AVC. This is due to the selection of the \nquantization parameters based on the subjective video quality, \nwhich will play a main role for such sequences.  \nIn Figures 11 and 12 visual images for 4 consecutive frames \nfor Foreman test sequence are presented at the same visual \nquality for both the rate controlling algorithms considered. \nRespective encoded bit rate values shows that the proposed \nalgorithm can significantly reduce the bit rate while keeping \nthe same visual quality. \nAuthorized licensed use limited to: University of Surrey. Downloaded on December 3, 2009 at 12:20 from IEEE Xplore.  Restrictions apply. \nIEEE Transactions on Consumer Electronics, Vol. 54, No. 3, AUGUST 2008 1470 \n0.1\n0.2\n0.3\n0.4\n0.5\n0.6\n0.7\n60 70 80 90 100 110 120 130\nEncoded bit rate (Kbps)\nSu\nbj\nec\ntiv\ne \nqu\nal\nity\n (V\nQ\nM\n)\nH.264\/AVC\nProposed algorithum\n \nFig.  5. Subjective quality and encoded bit rate comparison for the Soccer \nsequence \n27\n28\n29\n30\n31\n32\n33\n60 70 80 90 100 110 120 130\nEncoded bit rate (Kbps)\nO\nbj\nec\ntiv\ne \nqu\nal\nity\n(P\nS\nNR\n-d\nB)\n   \n \nH.264\/AVC\nProposed algorithum\n \nFig.  6. Objective quality and encoded bit rate comparison for the Soccer \nsequence \n0.1\n0.2\n0.3\n0.4\n0.5\n0.6\n30 40 50 60 70 80 90 100\nEncoded bit rate (Kbps)\nSu\nbj\nec\ntiv\ne \nqu\nal\nity\n (V\nQ\nM\n)\nH.264\/AVC\nProposed algorithum\n \nFig.  7. Subjective quality and encoded bit rate comparison for the \nForeman sequence \n25\n27\n29\n31\n33\n35\n37\n30 40 50 60 70 80 90 100\nEncoded bit rate (Kbps)\nO\nbj\nec\ntiv\ne \nqu\nal\nity\n(P\nSN\nR-\ndB\n)\nH.264\/AVC\nProposed algorithum\n \nFig.  8. Objective quality and encoded bit rate comparison for the \nForeman sequence \n0\n0.05\n0.1\n0.15\n0.2\n0.25\n0.3\n20 40 60 80 100\nEncoded bit rate (Kbps)\nS\nub\nje\nct\niv\ne \nqu\nal\nity\n \n(V\nQ\nM\n)\nH.264\/AVC\nProposed algorithum\n \nFig.  9. Subjective quality and encoded bit rate comparison for the Claire \nsequence \n35\n37\n39\n41\n43\n45\n47\n49\n20 40 60 80 100\nEncoded bit rate (Kbps)\nO\nbj\nec\ntiv\ne \nqu\nal\nity\n (P\nSN\nR-\ndB\n)\nH.264\/AVC\nProposed algorithum\n \nFig.  10. Objective quality and encoded bit rate comparison for the Claire \nsequence \nB. Target bitrates and encoded bit rates \nTable 1 presents the target and encoded bit rates for the \nSoccer sequence using both schemes. It clearly shows that the \nproposed technique provides a bit rate, which is closer to the \ntarget bit rate as in H.264\/AVC. However, this is achieved at a \nvery high subjective quality. Therefore, the proposed \ntechnique can maintain the target bit rate at a higher visual \nquality than H.264\/AVC. \nTABLE 1 \nCOMPARISON BETWEEN THE ENCODED BIT RATE AND THE TARGET BIT \nRATE (FOR THE SOCCER SEQUENCE) \nTechnique \nTarget bit \nrate \n(kbps) \nEncoded \nbit rate \n(kbps) \nVQM \nH.264\/AVC 65 65.3 0.58 \n 80 80.3 0.52 \n 95 95.8 0.47 \n 110 110.9 0.42 \n 125 125.1 0.41 \nProposed 65 65.42 0.51 \n 80 79.4 0.44 \n 95 94.7 0.37 \n 110 109.6 0.34 \n 125 124.3 0.31 \nC. Complexity \nThe proposed technique needs some additional computational \npower compared to the H.264\/AVC. This additional power is \nmainly due to the VQM calculations since VQM has not yet \nbeen fully optimized. Other than that the proposed ES algorithm \nis not computationally expensive since the operations within ES \nare quite simple. Furthermore, the proposed technique \nintroduces some delay compared to the H.264\/AVC. This is \nagain mainly due to the VQM calculations since it needs to \nbuffer few frames. This additional computational power and the \ndelay can be justified since this will be done only once and \nwhen it is optimized, we can reduce the bit rate (or memory for \nstorage) significantly, if the proposed technique is used. Thus \nthe proposed technique is suitable for any off-line video coding \napplications such as storages, VCDs, DVDs and off-line video \nencoding for streaming, Video on demand applications, \nbroadcasting, where the more emphasis is given to maximizing \nsubjective quality, subject to certain application limitations (e.g. \nstorage capacity, bit rate).  \nAuthorized licensed use limited to: University of Surrey. Downloaded on December 3, 2009 at 12:20 from IEEE Xplore.  Restrictions apply. \nS. L. P. Yasakethu et al.: A Rate Control Technique for Off Line H.264\/AVC Video Coding Using Subjective Quality of Video 1471\nIt should be noted that the proposed technique do not \nchange the complexity of the H.264\/AVC decoder. Therefore, \nthe proposed technique is compatible with the existing video \ndecoders such as H.264\/AVC based DVD players, digital \nvideo receivers, etc.  \nV.  APPLICATIONS OF THE PROPOSED TECHNIQUE \nIn this section, we describe the applications of the proposed \ntechnique in the consumer electronics applications.  \nA. Video On demand (VOD) \nVideo on Demand service represents a new opportunity to \nmonetize existing infrastructure, currently used for voice, data \nor broadcast services. Delivery of television, movies, media, \nadvertising or other popular content to a set-top box through a \nbroadband, wireless or satellite network connection also helps \nservice providers round out their \"triple-play\" service offering, \nand to remain competitive in a rapidly evolving marketplace. \nWith the continued global growth of broadband access, Video \non Demand services quickly follows. This revolutionary service \ntransforms the viewer's experience by allowing not only \"time \nshifting\" - choosing when to watch, but can also eliminate many \nof the regional, national or global limits of the traditional \nbroadcast cable or satellite architecture. Video on Demand \nallows service providers to offer an endless array of specialty \ncontent to consumers who are willing to pay to watch what they \nwant, when they want it. For these applications storage capacity \nand the transmission bandwidth play a very important role to \nmaximize the revenue and provide a good quality of service. \nThe proposed algorithm is well suited for these applications \nsince it reduces both the storage capacity and the transmission \nbandwidth for a given video stream at the same video quality.  \nB. DVD\/VCD  \nDVD\/VCD players are very common in the consumer \nelectronics market nowadays. In fact portable DVD players \nand DVD tablets are very popular among the young \ngeneration. The proposed algorithm can also play a very \nimportant role in off line video encoding for DVD\/VCDs to \nmaximize the storage capacity of the discs.  \n \nC. Other Applications \nThe proposed technique can be used for any other off line \nvideo coding applications such as off line video programs for \nbroadcasting, advertisements and personal video storage \ndevices.   \nVI. CONCLUSIONS \nIn this paper, we proposed a rate control algorithm based on \nsubjective quality of the video for H.264\/AVC in off line \nvideo encoding. Simulation results are presented for three \ndifferent motion video sequences and they clearly suggest that \nthe proposed technique can outperform the RD performance \nof the state of the art H.264\/AVC by a significant margin. Up \nto 35% bit rate saving can be achieved with the proposed \ntechnique at the same video quality. Unlike rate controlling \nalgorithms, which are based on objective quality of video, the \nproposed technique can guarantee the subjective quality of the      \nvideo output at a much lower bit rate. Even though the \nproposed technique needs some additional computational \npower, this can be easily justified since the encoding is only \ndone once and the RD performance gain achieved by the \nproposed technique. In future, we plan to extend this work for \non line video encoding. \n \n \n \n \nFrame number: 10 \n \nFrame number: 11 \n \nFrame number: 12 \n \nFrame number: 13 \nFig. 11 Foreman seq. encoded with proposed algorithm for a bit rate of 60.5 Kbps, VQM=0.3 \n \nFrame number: 10 \n \nFrame number: 11 \n \nFrame number: 12 \n \nFrame number: 13 \nFig. 12 Foreman seq. encoded with H.264\/AVC for a bit rate of 91.9 Kbps, VQM=0.3 \nAuthorized licensed use limited to: University of Surrey. Downloaded on December 3, 2009 at 12:20 from IEEE Xplore.  Restrictions apply. \nIEEE Transactions on Consumer Electronics, Vol. 54, No. 3, AUGUST 2008 \n \n1472 \nREFERENCES \n[1] Mohammed Ghanbari, Video coding: an Introduction to standard \ncodecs, The Institution of Electrical Engineers, London UK, 1999. \n[2] H. Kodikara Arachchi, W.A.C. Fernando, \u201cPOS based bit rate \noptimization for MPEG-1\/2 video coding\u201d, IEEE International \nConference on, Image Processing, 2005. ICIP 2005, Genova 14 Sept. \n2005. \n[3]  H. Kodikara Arachchi, W.A.C. Fernando, \u201cAn intelligent rate control \nalgprithm to improve the video quality at scene transitions for off-line \nMPEG-1\/2 encoders\u201d, IEEE Transactions on Consumer Electronics, \nVolume: 49, Issue: 1, pp 210-219, Feb.2003. \n[4] L.-J Lin, A. Ortega, and C.-C.J Kuo, \u201cGradient-based buffer control \ntechnique for MPEG\u201d, in Proc. of SPIE Visual Communications and \nImage Processing \u201995, Taipei, Taiwan, 1995. \n[5] Girod, B., \"What's wrong with Mean-Squared Error\", Digital Images \nand Human Vision, A. B. Watson Ed., Chapter 15, pp. 207-220, MIT \npress, 1993. \n[6]  International  Organisation  for  Standardisation  (ISO\/IEC  JTC1  \nSC29 WG11), International Standard ISO\/IEC 13818, 1996. \n[7]  ISO\/IEC\/JTC1\/SC29\/WGII, \u201cTest Model 5\u201d, Draft, April 1993. \n[8] A.  Ortaga,  K.  Ramchandran,  and  M.  Vetterli,  \u201cOptimal  trellis-\nbased buffered compression and fast approximation\u201d, IEEE Trans. \nImage Proc., Vol. 3, pp. 26-40, Jan. 1994. \n[9] L.-J Lin, A. Ortega, and C.-C.J Kuo, \u201cRate control using spline-\ninterpolated  R-D  characteristics\u201d,  in Proc.  of  SPIE Visual \nCommunications and Image Processing \u201996, (Orlando, FL), pp. 111-\n122,  Mar. 1996.  \n[10] \u201cDraft ITU-T recommendation and final draft international standard of \njoint video specification (ITU-T Rec. H>264 | ISO\/IEC 14496-10 \nAVC), \u201cJVT G050, 2003. \n[11] M. Pinson and S. Wolf, \u201cA new standardized method for objectively \nmeasuring video quality,\u201d IEEE Transactions on Broadcasting, v. 50, \nn. 3, pp. 312-322, Sept. 2004.  \n[12] A. P. Hekstra et al.: \u201cPVQM- a perceptual video quality measure\u201d \nSignal Processing: Image Communication 17 (10): 781-798, 2002. \n[13]  C. J. Branden Lambrecht and O.Verscheure. \u201cPerceptual Quality \nMeasure using a Spatio-Temporal Model of the Human Visual \nSystem,\u201d Proc. SPIE vol. 2668, p.450-461, March, 1996.   \n[14] Video Quality Experts Group (VQEG), \u201cFinal report from the Video \nQuality Experts Group on the validation of objective models of video \nquality assessment, phase II,\u201d 2003 VQEG. Available at: \nwww.vqeg.org \n[15] ITS Video quality research. Available at: \nwww.its.bldrdoc.gov\/n3\/video\/VQM_software.php \n[16]  Joint Video Team of ISO\/IEC MPEG and ITU-T VCEG, \nH.264\/AVC, Reference Software JM10.1 (online), \nhttp:\/\/iphome.hhi.de\/suehring\/tml\/download\/old_jm\/jm10.1.zip \n[17] H. J. LichtFuss. Evolution eines Rohrkr\u0171mmers. Diplomarbeit, \nTechnische Universit\u00e4t Berlin, 1965  \n[18] H.-P Schwefel. Kybernetische Evolution aks Strategie der \nexperimentellen Forschung in der Str\u00f6mungstechnik. Diplomarbeit \nTechnische Universit\u00e4t Berlin, 1965 \n[19]  Charles Darwin, The Origin of Species: By Means ofNatural \nSelection or the Preservation of Favoured Races in theStruggle for \nLife (Bantam Classic), Bantam Classics,Reprint. 1999. \n[20] Fitzpatrick, J.M., Grefenstette, J.J. and Van-Gucht, D.\u201cImage \nregistration by genetic search,\u201d Proceedings of Southeastcon 84, \nLouisville, KY, 460-464, Apr 1984. \n[21] Man F. So & Angus Wu, \u201cHardware Implementation of Four-Step \nGenetic Search Algorithm\u201d, IEEE Signal Processing Society 1999 \nWorkshop on Multimedia Signal Processing, Copenhagen, Denmark, \nSeptember 1999. \n[22]  Xu Yuelei, Bi Duyan and Mao Baixin, \u201c A Genetic Search Algorithm \nFor Motion Estimation\u201d, Proceedings of 5th International Conference \non Signal Processing Proceedings, Beijing, China, 2000. \n[23]  Ingo Rechenberg, Evolutionsstrategie '94. Stuttgart: Frommann-\nHolzboog 1994. \nS. L. P. Yasakethu received the BSc Engineering \ndegree (First Class Hons.) in Electrical and \nElectronic Engineering from the University of \nPeradeniya  Sri Lanka in 2007. He has been awarded \na prize for best performance in Electronic \nCommunication Engineering, by the University of \nPeradeniya. Currently he is a research student \ncompleting his PhD in the Centre for Communication Systems Research \n(CCSR) in the University of Surrey, UK. His research interests are  in  \nDistributed  Video Coding and Quality of Experience in Multimedia \nCommunications. \n \n W. A. C. Fernando received the B.Sc. Engineering \ndegree (First class) in Electronic and \nTelecommunications Engineering from the \nUniversity of Moratuwa, Sri Lanka in 1995 and the \nMEng degree (Distinction) in Telecommunications \nfrom Asian Institute of Technology (AIT), Bangkok, \nThailand in 1997. He completed his PhD at the \nDepartment of Electrical and Electronic \nEngineering, University of Bristol, UK in February 2001. Currently, he is \na senior lecture in signal processing at the University of Surrey, UK. Prior \nto that, he was a senior lecturer in Brunel University, UK and an assistant \nprofessor in AIT. His current research interests include Distribute Video \nCoding (DVC), 3D video coding, intelligent video encoding for wireless \ncommunications, OFDM and CDMA for wireless channels, channel \ncoding and modulation schemes for wireless channels. He has published \nmore than 160 international papers on these areas. He is a senior member \nof IEEE and a fellow of the HEA, UK. He is also a member of the \nEPSRC College. \n \nSteven Adedoyin holds a BEng (Hons) in \nMicroelectronics Engineering that was obtained \nfrom Brunel University. Currently he is a research \nstudent completing his PhD in the Centre for \nCommunication Systems Research (CCSR) in the \nUniversity of Surrey, UK. His current research \ninterest lies in 3D integral imaging, 3D video \ncoding, H.264 and Evolutionary Computing. \n \nAhmet M. Kondoz received the B.Sc. (Hons.) \ndegree in engineering, the M.Sc. degree in \ntelematics, and the Ph.D. in communication in 1983, \n1984, and 1986, respectively. He became a Lecturer \nin 1988, a Reader in 1995, and then in 1996, a \nProfessor in Multimedia Communication Systems \nand deputy director of Centre for Communication \nSystems Research (CCSR), University of Surrey, Guildford, U.K. He has \nover 250 publications, including a book on low bit-rate speech coding \nand several book chapters. He has graduated more than 40 Ph.D. students \nin the areas of speech\/image and signal processing and wireless \nmultimedia communications, and has been a consultant for major wireless \nmedia terminal developers and manufacturers. Prof Kondoz has been \nawarded several prizes, the most significant of which are The Royal \nTelevision Societies\u2019 Communications Innovation Award and The IEE \nBenefactors Premium Award. He has been on the Refereeing College for \nEPSRC and on the Canadian Research Councils. He is a member of the \nIEEE and the IET. \n \n \n \nAuthorized licensed use limited to: University of Surrey. Downloaded on December 3, 2009 at 12:20 from IEEE Xplore.  Restrictions apply. \n"}