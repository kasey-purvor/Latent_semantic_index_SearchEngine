{"doi":"10.1088\/1478-3975","coreId":"97006","oai":"oai:generic.eprints.org:592\/core69","identifiers":["oai:generic.eprints.org:592\/core69","10.1088\/1478-3975"],"title":"Reactive boundary conditions for stochastic simulations of reaction-diffusion processes","authors":["Erban, Radek","Chapman, S. J."],"enrichments":{"references":[{"id":827955,"title":"A stochastic model related to the telegrapher\u2019s equation Rocky Mt.","authors":[],"date":"1974","doi":null,"raw":null,"cites":null},{"id":826154,"title":"Dynamics of polydisperse irreversible adsorption: a pharmacological example Math. Models Methods Appl. Sci. at press (Preprint org\/physics\/0602001)","authors":[],"date":"2007","doi":null,"raw":null,"cites":null},{"id":826688,"title":"Exact stochastic simulation of coupled chemical","authors":[],"date":"1977","doi":null,"raw":null,"cites":null},{"id":828971,"title":"Faciliated transport of a Dpp\/Scw heterodimer by Sog\/Tsg leads to robust patterning of the Drosophila blastoderm embryo","authors":[],"date":"2005","doi":null,"raw":null,"cites":null},{"id":826205,"title":"From individual to collective behaviour in bacterial chemotaxis","authors":[],"date":"2004","doi":null,"raw":null,"cites":null},{"id":827680,"title":"Incorporating diffusion in complex geometries into stochastic chemical kinetics simulations","authors":[],"date":"2006","doi":null,"raw":null,"cites":null},{"id":827159,"title":"Introduction to Perturbation Methods","authors":[],"date":"1995","doi":null,"raw":null,"cites":null},{"id":825581,"title":"On chemisorption of polymers to solid surfaces","authors":[],"date":"2007","doi":null,"raw":null,"cites":null},{"id":826420,"title":"Random and cooperative sequential adsorption Rev.","authors":[],"date":"1993","doi":null,"raw":null,"cites":null},{"id":825027,"title":"Random Walks in Biology (Princeton:","authors":[],"date":"1983","doi":null,"raw":null,"cites":null},{"id":828250,"title":"Reduction of the Fokker\u2013Planck equation with an adsorbing or reflecting boundary to the diffusion equation and the radiation boundary condition Phys.","authors":[],"date":"1982","doi":null,"raw":null,"cites":null},{"id":828696,"title":"Simple chemical reaction systems with limit cycle behaviour","authors":[],"date":"1979","doi":null,"raw":null,"cites":null},{"id":828412,"title":"Spatially distributed stochastic systems: equation-free and equation-assisted preconditioned computation","authors":[],"date":"2006","doi":null,"raw":null,"cites":null},{"id":825308,"title":"Stochastic problems in physics and astronomy Rev.","authors":[],"date":"1943","doi":null,"raw":null,"cites":null},{"id":826890,"title":"Stochastic reaction\u2013 diffusion simulation with","authors":[],"date":"2005","doi":null,"raw":null,"cites":null},{"id":824726,"title":"Stochastic simulation of chemical reactions with spatial resolution and single molecule detail Phys.","authors":[],"date":"2004","doi":null,"raw":null,"cites":null},{"id":829187,"title":"Stochastic simulation of coupled reaction\u2013diffusion processes","authors":[],"date":"1996","doi":null,"raw":null,"cites":null},{"id":828654,"title":"The Fokker\u2013Planck Equation, Methods of Solution and Applications","authors":[],"date":"1989","doi":null,"raw":null,"cites":null},{"id":825472,"title":"The Mathematics of Diffusion (Oxford:","authors":[],"date":"1975","doi":null,"raw":null,"cites":null},{"id":825872,"title":"Time scale of random sequential adsorption Phys.","authors":[],"date":"2007","doi":null,"raw":null,"cites":null}],"documentType":{"type":1}},"contributors":[],"datePublished":"2007-02-15","abstract":"Many cellular and subcellular biological processes can be described in terms of diffusing and chemically reacting species (e.g. enzymes). Such reaction\u2013diffusion processes can be mathematically modelled using either deterministic partial-differential equations or stochastic simulation algorithms. The latter provide a more detailed and precise picture, and several stochastic simulation algorithms have been proposed in recent years. Such models typically give the same description of the reaction\u2013diffusion processes far from the boundary of the simulated domain, but the behaviour close to a reactive boundary (e.g. a membrane with receptors) is unfortunately model-dependent. In this paper, we study four different approaches to stochastic modelling of reaction\u2013diffusion problems and show the correct choice of the boundary condition for each model. The reactive boundary is treated as partially reflective, which means that some molecules hitting the boundary are adsorbed (e.g. bound to the receptor) and some molecules are reflected. The probability that the molecule is adsorbed rather than reflected depends on the reactivity of the boundary (e.g. on the rate constant of the adsorbing chemical reaction and on the number of available receptors), and on the stochastic model used. This dependence is derived for each model","downloadUrl":"https:\/\/core.ac.uk\/download\/pdf\/97006.pdf","fullTextIdentifier":"http:\/\/eprints.maths.ox.ac.uk\/592\/1\/ph7_1_003.pdf","pdfHashValue":"f38335ad89deeb3f98fc78a76495bb6d17bd2190","publisher":null,"rawRecordXml":"<record><header><identifier>\n    \n    \n      oai:generic.eprints.org:592<\/identifier><datestamp>\n      2015-05-29T18:25:02Z<\/datestamp><setSpec>\n      7374617475733D707562<\/setSpec><setSpec>\n      7375626A656374733D4143:4D3932<\/setSpec><setSpec>\n      7375626A656374733D4F5A:4D3630<\/setSpec><setSpec>\n      74797065733D61727469636C65<\/setSpec><\/header><metadata><oai_dc:dc xmlns:oai_dc=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/\" xmlns:dc=\"http:\/\/purl.org\/dc\/elements\/1.1\/\" xmlns:xsi=\"http:\/\/www.w3.org\/2001\/XMLSchema-instance\" xsi:schemaLocation=\"http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc\/ http:\/\/www.openarchives.org\/OAI\/2.0\/oai_dc.xsd\" ><dc:relation>\n    \n      \n        http:\/\/eprints.maths.ox.ac.uk\/592\/<\/dc:relation><dc:title>\n        Reactive boundary conditions for stochastic simulations of reaction-diffusion processes<\/dc:title><dc:creator>\n        Erban, Radek<\/dc:creator><dc:creator>\n        Chapman, S. J.<\/dc:creator><dc:subject>\n        Biology and other natural sciences<\/dc:subject><dc:subject>\n        Probability theory and stochastic processes<\/dc:subject><dc:description>\n        Many cellular and subcellular biological processes can be described in terms of diffusing and chemically reacting species (e.g. enzymes). Such reaction\u2013diffusion processes can be mathematically modelled using either deterministic partial-differential equations or stochastic simulation algorithms. The latter provide a more detailed and precise picture, and several stochastic simulation algorithms have been proposed in recent years. Such models typically give the same description of the reaction\u2013diffusion processes far from the boundary of the simulated domain, but the behaviour close to a reactive boundary (e.g. a membrane with receptors) is unfortunately model-dependent. In this paper, we study four different approaches to stochastic modelling of reaction\u2013diffusion problems and show the correct choice of the boundary condition for each model. The reactive boundary is treated as partially reflective, which means that some molecules hitting the boundary are adsorbed (e.g. bound to the receptor) and some molecules are reflected. The probability that the molecule is adsorbed rather than reflected depends on the reactivity of the boundary (e.g. on the rate constant of the adsorbing chemical reaction and on the number of available receptors), and on the stochastic model used. This dependence is derived for each model.<\/dc:description><dc:date>\n        2007-02-15<\/dc:date><dc:type>\n        Article<\/dc:type><dc:type>\n        PeerReviewed<\/dc:type><dc:format>\n        application\/pdf<\/dc:format><dc:language>\n        en<\/dc:language><dc:identifier>\n        http:\/\/eprints.maths.ox.ac.uk\/592\/1\/ph7_1_003.pdf<\/dc:identifier><dc:identifier>\n          Erban, Radek and Chapman, S. J.  (2007) Reactive boundary conditions for stochastic simulations of reaction-diffusion processes.  Physical Biology, 4  (1).   pp. 16-28.  ISSN 1478-3975     <\/dc:identifier><dc:relation>\n        http:\/\/www.iop.org\/EJ\/abstract\/1478-3975\/4\/1\/003<\/dc:relation><dc:relation>\n        10.1088\/1478-3975\/4\/1\/003<\/dc:relation><\/oai_dc:dc><\/metadata><\/record>","journals":null,"language":{"code":"en","id":9,"name":"English"},"relations":["http:\/\/eprints.maths.ox.ac.uk\/592\/","http:\/\/www.iop.org\/EJ\/abstract\/1478-3975\/4\/1\/003","10.1088\/1478-3975\/4\/1\/003"],"year":2007,"topics":["Biology and other natural sciences","Probability theory and stochastic processes"],"subject":["Article","PeerReviewed"],"fullText":"IOP PUBLISHING PHYSICAL BIOLOGY\nPhys. Biol. 4 (2007) 16\u201328 doi:10.1088\/1478-3975\/4\/1\/003\nReactive boundary conditions for\nstochastic simulations of\nreaction\u2013diffusion processes\nRadek Erban and S Jonathan Chapman\nUniversity of Oxford, Mathematical Institute, 24-29 St Giles\u2019, Oxford, OX1 3LB, UK\nE-mail: erban@maths.ox.ac.uk and chapman@maths.ox.ac.uk\nReceived 5 December 2006\nAccepted for publication 24 January 2007\nPublished 15 February 2007\nOnline at stacks.iop.org\/PhysBio\/4\/16\nAbstract\nMany cellular and subcellular biological processes can be described in terms of diffusing and\nchemically reacting species (e.g. enzymes). Such reaction\u2013diffusion processes can be\nmathematically modelled using either deterministic partial-differential equations or stochastic\nsimulation algorithms. The latter provide a more detailed and precise picture, and several\nstochastic simulation algorithms have been proposed in recent years. Such models typically\ngive the same description of the reaction\u2013diffusion processes far from the boundary of the\nsimulated domain, but the behaviour close to a reactive boundary (e.g. a membrane with\nreceptors) is unfortunately model-dependent. In this paper, we study four different approaches\nto stochastic modelling of reaction\u2013diffusion problems and show the correct choice of the\nboundary condition for each model. The reactive boundary is treated as partially reflective,\nwhich means that some molecules hitting the boundary are adsorbed (e.g. bound to the\nreceptor) and some molecules are reflected. The probability that the molecule is adsorbed\nrather than reflected depends on the reactivity of the boundary (e.g. on the rate constant of the\nadsorbing chemical reaction and on the number of available receptors), and on the stochastic\nmodel used. This dependence is derived for each model.\n1. Introduction\nDiffusion and chemical reactions are two fundamental\nprocesses in molecular biology. Molecules of proteins in an\naqueous solution of a living cell are in everlasting motion\n(because of the thermal energy). They cannot travel too far\nbefore they bump into water molecules or other molecules\nin their neighbourhood [3]. As a result of these collisions,\nthe trajectory of a molecule is not straight but it executes\na random walk and molecules slowly spread\u2014they diffuse.\nSome collisions of appropriate molecules may also lead to\nchemical reactions. The frequency of such reactive collisions\nis characterized by the rate constant of the corresponding\nchemical reaction. Let us consider a system of k chemicals\ndiffusing and reacting in a domain \u0001 \u2282 R3. The domain\n\u0001 may be a cell which is bounded by its membrane, or part\nof an extracellular space. Let nj (x, t), j = 1, . . . , k, be the\ndensity of molecules of the j th chemical species at the point\nx \u2208 \u0001. Assuming that there are a lot of molecules present\nin the system, the time evolution of density nj (x, t) can be\ncomputed by solving the system of reaction\u2013diffusion partial-\ndifferential equations\n\u2202nj\n\u2202t\n= Dj\u22072nj + Rj(n1, n2, . . . , nk), j = 1, . . . , k, (1)\nwhere Dj is the diffusion constant of the j th chemical\nspecies, \u22072 is the Laplace operator and the reaction term\nRj(n1, n2, . . . , nk) takes into account the chemical reactions\nwhich modify the concentration of the j th chemical species.\nTo describe uniquely the time evolution of the system, we\nhave to introduce suitable boundary conditions for the system\nof equations (1). The simplest boundary conditions can\nbe formulated in terms of vanishing density nj (x, t) on the\nboundary of \u0001 or vanishing flux through the boundary of \u0001.\nCoupling the system of equations (1) with such a boundary\ncondition, we can compute the densities nj (x, t) at any time t\nfrom the initial densities nj (x, 0), j = 1, . . . , k.\n1478-3975\/07\/010016+13$30.00 \u00a9 2007 IOP Publishing Ltd Printed in the UK 16\nBoundary conditions for stochastic simulations\nReaction\u2013diffusion processes in biology often involve\nlow molecular abundancies of some chemical species. In\nsuch a case, the continuum deterministic description (1) is\nno longer valid and suitable stochastic models must be used\ninstead. Various stochastic simulation algorithms have been\nproposed in the literature [1, 12, 14, 24]. In general, the\nstochastic treatment of diffusion and first-order reactions (such\nas degradation or conversion) is well understood. There\nis less understanding (and stochastic models differ) when\nsecond-order chemical reactions are taken into account, e.g.\nreactions in which two molecules collide for the reaction to\ntake place. Another important problem is the implementation\nof the correct boundary conditions for the stochastic simulation\nalgorithms. On the one hand, the simple boundary conditions\nmentioned above are easy to reformulate in the stochastic\ncase\u2014the vanishing density on the boundary of \u0001 simply\nmeans that a diffusing molecule is removed from the system\nwhenever it hits the boundary; and the vanishing flux through\nthe boundary means that a diffusing molecule is reflected\nwhenever it hits the boundary. On the other hand, more\nrealistic boundary conditions have to be handled with care.\nThey can be formulated in terms of the partially adsorbing\nboundary, which means that some molecules hitting the\nboundary are reflected and some are adsorbed. The partially\nadsorbing boundary corresponds to the so-called Robin\nboundary condition (or radiation boundary condition [5]) of\nthe macroscopic partial-differential equation (1). However,\nthis correspondence is model-dependent.\nWe will see later, in section 5, that the derivation of\nthe correct boundary condition depends on the stochastic\nmodel of the diffusion but not on the stochastic model of\nthe chemical reactions in the solution. Consequently, we start\nthis paper by studying stochastic models of diffusion only. In\nsection 2, we introduce four different stochastic approaches\nto model molecular diffusion and we state the appropriate\nboundary conditions. In section 3, we present illustrative\nsimulations of all four models, validating the boundary\nconditions presented. Moreover, we also clearly illustrate\nthat the boundary conditions are indeed model-dependent.\nIn section 4, we present the mathematical derivation of\nthe boundary conditions for each model, i.e. we provide a\ntheoretical justification of results from section 2. Moreover,\nwe show that all four models are suitable for modelling\ndiffusion far from the reactive boundary. Section 4 is intended\nfor a more theoretical audience and can be skipped by a reader\nwho is not interested in the mathematical justification of the\nboundary conditions and stochastic models. In section 5, we\nshow that reaction\u2013diffusion models can be treated using the\nsame boundary conditions which were previously derived for\nthe corresponding models of the diffusion only. We conclude\nwith summary and outlook in section 6.\n2. Boundary conditions for stochastic models of\ndiffusion\nThe boundary condition of any stochastic simulation algorithm\ncan be formulated as follows: whenever a molecule hits the\nboundary, it is adsorbed with some probability, and reflected\notherwise. The special cases of this boundary condition are:\n(a) the molecule is always reflected (such a boundary is called\nthe reflecting boundary in what follows); and (b) the molecule\nis always adsorbed (in this case the boundary is called fully\nadsorbing). The reflecting boundary condition is often used\nwhen no adsorption of the diffusing molecules on the boundary\ntakes place. On the other hand, if the molecule can chemically\nor physically attach to the boundary, then one has to assume\nthat the boundary is (at least) partially adsorbing.\nThe important question is, what is the probability that the\nparticle is adsorbed rather than reflected, and how does this\nrelate to the reactive properties of the boundary for a given\nstochastic model? To answer this question, let us follow the\nx-coordinate of the diffusing molecule (the other coordinates\ncan be treated similarly), so that we study the diffusion of\nmolecules in the one-dimensional interval [0, L] where L is the\nlength of the computational domain. Assuming that we have a\nlot of molecules in the system, we can describe the system in\nterms of density n(x, t) of molecules at point x \u2208 [0, L] and\ntime t, so that n(x, t)\u03b4x gives the number of molecules in the\nsmall interval [x, x + \u03b4x] at time t. The evolution of n(x, t) is\ngoverned by the diffusion equation\n\u2202n\n\u2202t\n= D\u2202\n2n\n\u2202x2\n, for x \u2208 [0, L], t \u0001 0, (2)\nwhere D is the diffusion constant. The general first-order\nreactive boundary condition at x = 0 is the so-called Robin\nboundary condition\nD\n\u2202n\n\u2202x\n(0, t) = Kn(0, t) (3)\nwhere the nonnegative constant K describes the reactivity of\nthe boundary (see the appendix for the relation between K and\nthe chemical properties of the boundary) and may in general\ndepend on time. A reflective boundary corresponds to K = 0\nand a fully adsorbing boundary corresponds to K = \u221e. The\nboundary condition at the right boundary x = L can be treated\nsimilarly.\nIn the following four subsections we introduce four\nstochastic models of diffusion. The first model, introduced in\nsection 2.1, is a position jump process on a lattice. This model\nis discrete in both time and space, and is used in a stochastic\nsimulation algorithm which is based on the reaction\u2013diffusion\nmaster equation [12, 14]. The second model, introduced in\nsection 2.2, is again discrete in time and discontinuous in\nspace but the positions of molecules are not confined to a\nregular lattice. It is essentially the Euler scheme for the\nSmoluchowski stochastic differential equation, which is the\ncore of the stochastic approach of Andrews and Bray [1].\nThe third scheme, introduced in section 2.3, is a discrete\nvelocity jump process which is a discrete in time, continuous\nin space random walk with discretized velocities, where the\nvelocities evolve on a finite lattice. The last stochastic model\nof diffusion, introduced in section 2.4, is the Euler scheme for\nthe solution of the stochastic Langevin equation. It is a velocity\njump process (i.e. a random walk discrete in time, continuous\nin space and discontinuous in velocities) where the Brownian\nparticle can move with any real value of the velocity. In all\nfour cases, we study the connections between the boundary\n17\nR Erban and S J Chapman\nconditions of the stochastic simulation and Robin boundary\ncondition (3) of the macroscopic diffusion equation (2). We\nprovide the relation between K in (3) and the parameters of\neach model. The mathematical derivation of these relations is\nincluded later, in section 4.\n2.1. Position jump process I\nLet us discretize the domain of interest [0, L] into M lattice\npoints a distance h = L\/M apart, namely we consider the\nlattice {\nh\n2\n,\n3h\n2\n,\n5h\n2\n,\n7h\n2\n,\n9h\n2\n\u00b7 \u00b7 \u00b7 (2M \u2212 1)h\n2\n}\n. (4)\nLet us choose time step \u0004t such that 2D\u0004t \u0005 h2.We simulate\na system of N molecules whose positions are assumed to be\nat one of the discrete positions (4). Let xi(t) be the position\nof the ith molecule, i = 1, 2, . . . , N , at time t. The position\nxi(t + \u0004t) is computed from the position xi(t) as follows:\nxi(t + \u0004t) =\n\uf8f1\uf8f2\uf8f3\nxi(t) with probability 1 \u2212 2D\u0004t\/h2,\nxi(t) \u2212 h with probability D\u0004t\/h2,\nxi(t) + h with probability D\u0004t\/h2.\n(5)\nAt x = 0, we implement the following boundary condition:\nwhenever a molecule hits the boundary, it is adsorbed with\nprobability P1h, and reflected otherwise. Here, P1 is a given\nnonnegative constant. The implementation of this boundary\ncondition at x = 0 is performed as follows. If the ith molecule\nis at position xi(t) = h\/2 and attempts to jump to the left, then\nxi(t + \u0004t) = h\/2 with probability 1 \u2212 P1h. (6)\nOtherwise, we remove the molecule from the system. We\nshow in section 4.1 that the random walk (5) with boundary\ncondition (6) leads to the diffusion equation (2) with Robin\nboundary condition (3), where\nK = P1D, which is equivalent to P1 = K\nD\n. (7)\n2.2. Position jump process II\nLet us choose a time step \u0004t . Let xi(t), i = 1, 2, . . . , N ,\nbe the position of the ith molecule at time t. The position\nxi(t + \u0004t) is computed from the position xi(t) as follows:\nxi(t + \u0004t) = xi(t) +\n\u221a\n2D\u0004t\u03b6i, i = 1, . . . , N, (8)\nwhere \u03b6i is a normally distributed random variable with zero\nmean and unit variance. This random walk is essentially\nthe Euler scheme for the Smoluchowski stochastic differential\nequation (21) as discussed later, in section 4.2. We implement\nthe following partially adsorbing boundary condition at x = 0:\nwhenever a molecule hits the boundary, it is adsorbed with\nprobability P2\n\u221a\n\u0004t , and reflected otherwise. Obviously, if\nxi(t + \u0004t) computed by (8) is negative, a molecule has hit the\nboundary. However, Andrews and Bray [1] argue that there\nis a chance that a molecule hit the boundary during the finite\ntime step even if xi(t + \u0004t) computed by (8) is positive; that\nis, during the time interval [t, t +\u0004t] the molecule might have\ncrossed to xi negative and then crossed back to xi positive\nagain. They found that the probability that the molecule hit\nthe boundary x = 0 at least once during the time step \u0004t is\nexp[\u2212xi(t)xi(t + \u0004t)\/(D\u0004t)] for xi(t) \u0001 0, xi(t + \u0004t) \u0001 0.\nConsequently, the partially reflective boundary condition is\nimplemented as follows.\n(a) If xi(t + \u0004t) computed by (8) is negative then xi(t +\n\u0004t) = \u2212xi(t) \u2212\n\u221a\n2D\u0004t\u03b6i with probability 1 \u2212 P2\n\u221a\n\u0004t ,\notherwise we remove the molecule from the system.\n(b) If xi(t + \u0004t) computed by (8) is positive then we\nremove the molecule from the system with probability\nexp[\u2212xi(t)xi(t + \u0004t)\/(D\u0004t)]P2\n\u221a\n\u0004t .\nThe partially adsorbing boundary condition (a)\u2013(b) leads to\nthe Robin boundary condition (3) with\nK = 2P2\n\u221a\nD\u221a\n\u03c0\n, which is equivalent to P2 = K\n\u221a\n\u03c0\n2\n\u221a\nD\n. (9)\nLet us note that some authors use the case (a) only as the\nimplementation of the partially reflective boundary condition\n[23], i.e. they do not take the Andrews and Bray correction\n(b) into account. Considering the random walk (8) with\nthe boundary condition (a) only, the parameter K of Robin\nboundary condition (3) can be computed as\nK = P2\n\u221a\nD\u221a\n\u03c0\n, which is equivalent to P2 = K\n\u221a\n\u03c0\u221a\nD\n. (10)\nComparing (9) and (10), we see that we lose a factor of 2 if\nwe do not consider the Andrews and Bray correction (b). The\nmathematical justification of formulae (9) and (10) is presented\nin section 4.2.\n2.3. Velocity jump process I\nWe consider that each molecule moves along the x-axis at a\nconstant (large) speed s, but that at random instants of time it\nreverses its direction according to a Poisson process with the\nturning frequency\n\u03bb = s\n2\n2D\n. (11)\nTherefore, the ith molecule is described by two variables: its\nposition xi(t) and its velocity vi(t) = \u00b1s. We use a small time\nstep \u0004t such that \u03bb\u0004t \u0005 1. During each time step a molecule\nmoves with speed s in the chosen direction. At the end of each\ntime step, a uniformly distributed random number ri \u2208 [0, 1]\nis generated. If ri < \u03bb\u03b4t , then the ith molecule changes its\ndirection, so that it will move during the next time step in the\nopposite direction.\nWe implement the following partially adsorbing boundary\ncondition at x = 0: whenever a molecule hits the boundary, it\nis adsorbed with probability P3\/s, and reflected otherwise.\nHere, P3 is a given nonnegative number. The partially\nadsorbing boundary condition at x = 0 is implemented\nas follows. If the position of the ith molecule satisfies\nxi(t + \u0004t) < 0 at the end of the time step, then\nxi(t + \u0004t) = \u2212xi(t) \u2212 vi(t)\u0004t\nvi(t + \u0004t) = \u2212vi(t)\n}\nwith probability 1 \u2212 P3\ns\n,\n(12)\n18\nBoundary conditions for stochastic simulations\notherwise, the ith molecule is removed from the system.\nIt can be shown that this velocity jump process leads to\ndiffusion equation (2) provided that s is sufficiently large (see\nsection 4.3 for details). Boundary condition (12) can be related\nto Robin boundary condition (3), with\nK = P3\n2\n, which is equivalent to P3 = 2K. (13)\n2.4. Velocity jump process II\nLet us choose time step \u0004t . The ith molecule is described by\ntwo variables: its position xi(t) and its velocity vi(t). We\ncompute position xi(t + \u0004t) and velocity vi(t + \u0004t) from\nposition xi(t) and velocity vi(t) by formulae\nxi(t + \u0004t) = xi(t) + vi(t)\u0004t, (14)\nvi(t + \u0004t) = vi(t) \u2212 \u03b2vi(t)\u0004t + \u03b2\n\u221a\n2D\u0004t\u03b6i, (15)\nwhere \u03b2 is the (large) friction coefficient and \u03b6i is a normally\ndistributed random variable with zero mean and unit variance.\nThis random walk is essentially the Euler scheme for the\nstochastic Langevin equation [4]. The partially reflective\nboundary condition at x = 0 can be stated as follows:\nwhenever a molecule hits the boundary, it is adsorbed with\nprobability P4\/\n\u221a\n\u03b2, and reflected otherwise. Here, P4 is\na given nonnegative number. The implementation of this\nboundary condition is straightforward. If xi(t +\u0004t) computed\nby (14) is negative then\nxi(t + \u0004t) = \u2212xi(t) \u2212 vi(t)\u0004t\nvi(t + \u0004t) = \u2212vi(t) + \u03b2vi(t)\u0004t \u2212 \u03b2\n\u221a\n2D\u0004t\u03b6i\n}\nwith probability 1 \u2212 P4\u221a\n\u03b2\n; (16)\notherwise, we remove the ith molecule from the system.\nIt can be shown that this velocity jump process leads to\ndiffusion equation (2) provided that \u03b2 is sufficiently large (see\nsection 4.4 for details). The parameter K of Robin boundary\ncondition (3) is\nK = P4\n\u221a\nD\u221a\n2\u03c0\n, which is equivalent to P4 = K\n\u221a\n2\u03c0\u221a\nD\n. (17)\n3. Comparison of stochastic models of diffusion\nIn this section, we present the results of two illustrative\nnumerical simulations. First, we choose the macroscopic\nvalue of K in (3), and we show the results of stochastic\nsimulations with the correct choice of the probabilities of the\nadsorption on the reactive boundary for each model. We\ndemonstrate numerically the validity of relations between\nthese probabilities and K, which were stated in section 2\n(the mathematical justification of these formulae is provided\nlater, in section 4). In the second numerical example, we\nchoose the apparently same microscopic boundary condition\nfor each model. The goal is to demonstrate that the realistic\nboundary condition has to be chosen for each model with care,\nby applying formulae (7), (9), (13) or (17).\n3.1. Stochastic simulation of models of diffusion\nLet us consider the computational domain [0, 5], i.e. L = 5\nin this section. We choose diffusion constant D = 1, and\nreactivity of the boundary x = 0 as K = 2. We consider\nthat the right boundary x = L is reflecting. Given an initial\ndensity profile n(x, 0), we can compute the density n(x, t) at\ntime t \u0001 0 by solving diffusion equation (2) accompanied with\nRobin boundary condition (3) at x = 0 and no-flux boundary\ncondition at x = L. In this section, we show that comparable\nresults can be obtained by all four stochastic models provided\nthat we choose the boundary conditions accordingly.\nThe key formulae were provided in the previous section.\nGiven values of K and D, we can compute the adsorbing\nprobabilities on the reactive boundary x = 0 by formula\n(7) for position jump process I, formula (9) for position\njump process II, formula (13) for velocity jump process I\nand formula (17) for velocity jump process II. We obtain\nappropriate values of constants P1, P2, P3 and P4 which are\nused in the corresponding stochastic model. In our case K = 2\nand D = 1, so that formulae (7), (9), (13) and (17) imply\nP1 = 2, P2 =\n\u221a\n\u03c0\n.= 1.772,\nP3 = 4, P4 = 2\n\u221a\n2\u03c0 .= 5.013.\n(18)\nThe results of stochastic simulations are presented in figure 1.\nThe initial condition was chosen as follows: we start with\n100 000 molecules in domain [0, 5]. We put 75 000 molecules\nto position x = 1 and 25 000 to position x = 2 at time t = 0.\nWe plot the density profile at time t = 1 in figure 1. To\ndo that, we divide the interval [0, 5] into 50 bins of length\n0.1 and we plot the number of molecules in each bin at time\nt = 1 (histograms). We also plot the solution of diffusion\nequation (2) accompanied by Robin boundary condition (3)\nat x = 0 and no-flux boundary condition at x = L. We\nsee that all four models of diffusion give the same results\nprovided that we choose the partially adsorbing probability\naccordingly.\nTo compute the simulation results from figure 1, we also\nhad to specify the additional parameters of the stochastic\nmodels. We used space step h = 0.1 and time step \u0004t = 10\u22124\nin position jump process I. We used time step \u0004t = 10\u22124 in\nposition jump process II. We used speed s = 40 and time step\n\u0004t = 10\u22125 in velocity jump process I and we used friction\ncoefficient \u03b2 = 200 and time step \u0004t = 10\u22126 in velocity jump\nprocess II.\n3.2. Consequences of the same probability of adsorption\nLet us now consider the following boundary condition:\nwhenever a molecule hits the boundary, it is adsorbed with\nprobability R, and reflected otherwise. We can easily modify\nthe computer codes which were used to compute stochastic\nsimulation results from figure 1 to incorporate this boundary\ncondition: whenever the ith molecule hits the boundary, we\ngenerate a random number ri uniformly distributed in [0, 1]. If\nri < R, we remove the ith molecule from the system. It means\nthat the adsorbing condition which was stated in terms of\nP1, P2, P3 and P4 is replaced by the same condition expressed\n19\nR Erban and S J Chapman\n0 1 2 3 4 50\n500\n1000\n1500\n2000\n2500\n3000\nposition\nn\nu\nm\nbe\nr o\nf m\nol\nec\nul\nes\nPosition Jump Process I\nK=2\nP1=2\n0 1 2 3 4 50\n500\n1000\n1500\n2000\n2500\n3000\nposition\nn\nu\nm\nbe\nr o\nf m\nol\nec\nul\nes\nPosition Jump Process II\nK=2\nP2=1.772..\n0 1 2 3 4 50\n500\n1000\n1500\n2000\n2500\n3000\nposition\nn\nu\nm\nbe\nr o\nf m\nol\nec\nul\nes\nVelocity Jump Process I\nK=2\nP3=4\n0 1 2 3 4 50\n500\n1000\n1500\n2000\n2500\n3000\nposition\nn\nu\nm\nbe\nr o\nf m\nol\nec\nul\nes\nVelocity Jump Process II\nK=2\nP4=5.013..\nFigure 1. Stochastic simulations of four different diffusion models for K = 2 and D = 1. Probabilities of adsorption at partially adsorbing\nboundary x = 0 were computed for each model according to formulae (7), (9), (13) and (17).\nin terms of R. Choosing R = 0.05 and the same parameters\nand initial condition as in section 3.1, the stochastic simulation\nresults at time t = 1 are shown in figure 2 (histograms\nobtained by dividing domain [0, 5] into 50 bins and plotting\nthe number of molecules in each bin). We clearly see that the\nresults quantitatively differ. The reason is that the probability\nof adsorption scales with other parameters of simulations:\nnamely with space step h for position jump process I, with time\nstep \u0004t for position jump process II, with speed s for velocity\njump process I and with friction coefficient \u03b2 for velocity\njump process II. The values of these scaling parameters were\nchosen as in section 3.1. Namely, we used space step h = 0.1\nin position jump process I, time step \u0004t = 10\u22124 in position\njump process II, speed s = 40 in velocity jump process I\nand friction coefficient \u03b2 = 200 in velocity jump process II.\nUsing these values, we can compute P1, P2, P3 and P4 which\ncorrespond to R = 0.05. Moreover, we can use formulae\n(7), (9), (13) and (17) to compute the corresponding value\nof K in Robin boundary condition (3). We obtain K = 0.5\nfor position jump process I, K .= 5.64 for position jump\nprocess II, K = 1 for velocity jump process I and K .= 0.28\nfor velocity jump process II. The solutions of diffusion\nequation (2) accompanied by no-flux boundary condition at\nx = 5 and Robin boundary condition (3) at x = 0 with the\nappropriate choice of K are plotted in figure 2 for comparison\nas solid curves. We see that the Robin boundary condition\n(3) at x = 0 with the appropriate choice of K gives the\ncorrect results when compared with stochastic simulations.\nMoreover, we also confirm that the same value of R leads\nto the different values of K. Hence the boundary condition\ncannot be formulated in terms of one probability R. It has to\nbe appropriately scaled as shown in section 2.\nTo enable a direct comparison between models, we can\nslightly reformulate position jump process I. The formulation\nfrom section 2.1 was chosen in a way which is used in the\nstochastic reaction\u2013diffusion approaches which are based on\nthe reaction\u2013diffusion master equation [12, 14]. In particular,\nno relation between h and \u0004t was given and the probability\nof partial adsorption had to be scaled with h. One can also\nformulate the position jump process on lattice as follows: we\nchoose time step \u0004t and space step h = \u221a2D\u0004t . At each\ntime step, the molecule jumps to the left with probability\n1\/2 and to the right otherwise. This random walk can be\naccompanied with partially adsorbing boundary condition:\nwhenever a molecule hits the boundary, it is adsorbed with\nprobability P\u02dc1\n\u221a\n\u0004t , and reflected otherwise. This boundary\ncondition leads to Robin boundary condition (3) with K given\nby\nK = P\u02dc1\n\u221a\nD\u221a\n2\n.\nComparing this formula with (9) or (13), we see that the Robin\nboundary condition is different for position jump process I\nand position jump process II even if we scale the adsorption\nprobability with the same factor\n\u221a\n\u0004t .\nThe velocity jump processes can also be further compared.\nTo do this, let us note that the speed s of a molecule can be\nestimated as\n\u221a\nkT \/m where k is the Boltzmann\u2019s constant, T\n20\nBoundary conditions for stochastic simulations\n0 1 2 3 4 50\n1000\n2000\n3000\n4000\nposition\nn\nu\nm\nbe\nr o\nf m\nol\nec\nul\nes\nPosition Jump Process I\n0 1 2 3 4 50\n1000\n2000\n3000\n4000\nposition\nn\nu\nm\nbe\nr o\nf m\nol\nec\nul\nes\nPosition Jump Process II\n0 1 2 3 4 50\n1000\n2000\n3000\n4000\nposition\nn\nu\nm\nbe\nr o\nf m\nol\nec\nul\nes\nVelocity Jump Process I\n0 1 2 3 4 50\n1000\n2000\n3000\n4000\nposition\nn\nu\nm\nbe\nr o\nf m\nol\nec\nul\nes\nVelocity Jump Process II\nFigure 2. Stochastic simulations of four different diffusion models for R = 0.05 and D = 1 (histograms). Solid curves show the solution of\nthe diffusion equation (2) accompanied by no-flux boundary condition at x = 5 and Robin boundary condition (3) at x = 0 where the values\nof K are computed according to formulae (7), (9), (13) and (17).\nis the absolute temperature and m is the mass of a molecule.\nIn particular, we get the relation s = \u221aD\u03b2 which can be used\nto scale the boundary condition of velocity jump process I in\nterms of\n\u221a\n\u03b2 instead of s. Consequently, we can relate P3 to\nP4 by P3 = P4\n\u221a\nD. However, using this relation in (13), we\nobtain a different Robin boundary condition (3) than by using\nformula (17).\nTo summarize this section, it is possible to reformulate\nposition jump process I to have the adsorption probability of\nboth position jump processes scaled as P\u221a\u0004t . It is possible to\nrelate s to \u03b2 in velocity jump process I to have the adsorption\nprobability of both velocity jump processes scaled as P\/\u221a\u03b2.\nThen all four cases lead to Robin boundary condition (3) of\nthe form\nK = \u03b1P\n\u221a\nD (19)\nwhere \u03b1 is model-dependent. Consequently, the boundary\ncondition has to be chosen differently for each model to get\nthe same value of K in Robin boundary condition (3). One\nhas to use formulae (7), (9), (13) and (17) as we showed in\nsection 3.1.\n4. Mathematical analysis of stochastic models of\ndiffusion\nThe goal of this section is to provide the justification of the\nresults from section 2. For each stochastic model, we show\nthat the model leads to the diffusion equation (2) away from the\nboundary. Moreover, we derive the Robin boundary condition\nfor each model.\n4.1. Position jump process I\nLet pk(t) be the probability of finding a molecule at mesh point\nxk = (2k \u2212 1)h\/2 where k = 1, 2, . . . ,M . If k \u0007= 1, k \u0007= M ,\nthen pk satisfies\npk(t + \u0004t) =\n(\n1 \u2212 2D\u0004t\nh2\n)\npk(t) +\nD\u0004t\nh2\n(pk+1(t) + pk\u22121(t))\nwhich can be rewritten as\npk(t + \u0004t) \u2212 pk(t)\n\u0004t\n= Dpk+1(t) + pk\u22121(t) \u2212 2pk(t)\nh2\n.\nPassing to the limit \u0004t \u2192 0, h \u2192 0, we obtain the diffusion\nequation (2). The boundary condition at x = 0 can be\nincorporated into the equation for p1(t) as\np1(t + \u0004t) =\n(\n1 \u2212 2D\u0004t\nh2\n)\np1(t)\n+\nD\u0004t\nh2\n(p2(t) + (1 \u2212 P1h)p1(t)) (20)\nwhich can be rewritten as\u221a\n\u0004t\np1(t + \u0004t) \u2212 p1(t)\n\u0004t\n= D\n\u221a\n\u0004t\nh\n(\np2(t) \u2212 p1(t)\nh\n\u2212 P1p1(t)\n)\n.\nPassing to the limit \u0004t \u2192 0, h \u2192 0 such that \u221a\u0004t\/h is kept\nconstant, we obtain (7).\n21\nR Erban and S J Chapman\n4.2. Position jump process II\nPosition jump process (8) is a discretized version (Euler\nscheme) of the stochastic differential equation\nX(t + dt) = X(t) +\n\u221a\n2D dW(dt) (21)\nwhere dW(dt) is the normal random variable with mean 0 and\nvariance dt (i.e. the propagator of the special Wiener process)\nand D is the macroscopic diffusion constant. The diffusion\nequation (2) is the Fokker\u2013Planck equation corresponding to\nthe stochastic differential equation (21) and its derivation can\nbe found in any standard textbook [20]. The derivation of\nRobin boundary condition (9) is more delicate and requires the\napplication of asymptotic methods [2]. To do that, we consider\nthe position jump process II on the semiinfinite interval [0,\u221e)\nsubject to the boundary condition (a)\u2013(b) from section 2.2.\nLet p\u0004t \u2261 p\u0004t(x, t) : [0,\u221e) \u00d7 \u0004tN0 \u2192 [0,\u221e) be the\nprobability density function of the discretized process (8) with\nthe boundary condition (a)\u2013(b), so that p\u0004t(x, i\u0004t) dx is the\nprobability of finding a molecule in the interval [x, x + dx] at\ntime t = i\u0004t. We have\np\u0004t(x, t + \u0004t) =\n\u222b \u221e\n0\np(x, t + \u0004t |y, t)p\u0004t (y, t) dy, (22)\nwhere p(x, t + \u0004t |y, t) is the conditional probability\ndistribution function of finding a molecule at point x at time\nt + \u0004t given that it is at point y at time t. There are two\npossible options to reach point x at time t + \u0004t : either we\nuse (8) only, i.e. x = y + \u221a2D\u0004t\u03b6i ; or we use the boundary\ncondition x = \u2212y \u2212 \u221a2D\u0004t\u03b6i with probability 1 \u2212 P2\n\u221a\n\u0004t .\nIf the former is true, we have to take into account that some\nmolecules are lost because of the Andrews and Bray boundary\ncorrection (b). Consequently, we have\np(x, t + \u0004t |y, t) = 1\u221a\n4\u03c0D\u0004t\n({\n1 \u2212 exp\n[\n\u2212 xy\nD\u0004t\n]\nP2\n\u221a\n\u0004t\n}\n\u00d7 exp\n[\n\u2212 (x \u2212 y)\n2\n4D\u0004t\n]\n+ (1 \u2212 P2\n\u221a\n\u0004t) exp\n[\n\u2212 (x + y)\n2\n4D\u0004t\n])\n= 1\u221a\n4\u03c0D\u0004t\n(\nexp\n[\n\u2212 (x \u2212 y)\n2\n4D\u0004t\n]\n+ (1 \u2212 2P2\n\u221a\n\u0004t) exp\n[\n\u2212 (x + y)\n2\n4D\u0004t\n])\n.\nThus (22) reads as follows\np\u0004t(x, t + \u0004t) =\n\u222b \u221e\n0\np\u0004t(y, t)\u221a\n4\u03c0D\u0004t\n(\nexp\n[\n\u2212 (x \u2212 y)\n2\n4D\u0004t\n]\n+ (1 \u2212 2P2\n\u221a\n\u0004t) exp\n[\n\u2212 (x + y)\n2\n4D\u0004t\n])\ndy. (23)\nAway from the boundary, a steepest descent approximation to\nthe integral as \u0004t \u2192 0 leads to the diffusion equation (2).\nHowever, as observed in [23], in the vicinity of the boundary,\nsuch a calculation needs to be modified: there is a boundary\nlayer of width\n\u221a\n\u0004t , and it is the solution in the boundary layer\nwhich determines the boundary condition of the diffusion\nequation. We use the method of matched asymptotic\nexpansions [13]. In the boundary layer, we change variables\nfrom x to \u03b7 by setting x = \u221a\u0004t\u03b7 and define the inner solution\npinner(\u03b7, t) = p\u0004t(\n\u221a\n\u0004t\u03b7, t).\nExpanding pinner in the powers of\n\u221a\n\u0004t , we obtain\npinner(\u03b7, t) \u223c pi,0(\u03b7, t) +\n\u221a\n\u0004tpi,1(\u03b7, t) + \u0004tpi,2(\u03b7, t) + \u00b7 \u00b7 \u00b7 .\nUsing this expansion in the integral equation (23) and\ncomparing the terms of the same order, we obtain at O(1)\nthat pi,0 is independent of \u03b7. At O(\n\u221a\n\u0004t) we find that\npi,1(\u03b7) = \u22122P2\n\u222b \u221e\n0\npi,0\u221a\n4\u03c0D\nexp\n[\n\u2212 (\u03be + \u03b7)\n2\n4D\n]\nd\u03be\n+\n\u222b \u221e\n0\npi,1(\u03be)\u221a\n4\u03c0D\n(\nexp\n[\n\u2212 (\u03be \u2212 \u03b7)\n2\n4D\n]\n+ exp\n[\n\u2212 (\u03be + \u03b7)\n2\n4D\n])\nd\u03be. (24)\nNow by matching the inner boundary layer expansion with the\nouter expansion p\u0004t(x, t) \u223c n(x, t) + \u00b7 \u00b7 \u00b7, we find pi,0(t) =\nn(0, t) and\nlim\n\u03b7\u2192\u221e\n\u2202pi,1\n\u2202\u03b7\n(\u03b7, t) = \u2202n\n\u2202x\n(0, t). (25)\nThus to determine the boundary condition on n at x = 0\nwe need to determine the behaviour of \u2202pi,1\/\u2202\u03b7 as \u03b7 \u2192 \u221e.\nDifferentiating (24) with respect to \u03b7, we obtain\n\u2202pi,1\n\u2202\u03b7\n(\u03b7) = P2pi,0\u221a\n\u03c0D\nexp\n[\n\u2212 \u03b7\n2\n4D\n]\n+\n\u222b \u221e\n0\npi,1(\u03be)\u221a\n4\u03c0D\n(\n\u03be \u2212 \u03b7\n2D\nexp\n[\n\u2212 (\u03be \u2212 \u03b7)\n2\n4D\n]\n\u2212 \u03be + \u03b7\n2D\nexp\n[\n\u2212 (\u03be + \u03b7)\n2\n4D\n])\nd\u03be.\nUsing integration by parts, we obtain the integral equation\n\u2202pi,1\n\u2202\u03b7\n(\u03b7) = P2pi,0\u221a\n\u03c0D\nexp\n[\n\u2212 \u03b7\n2\n4D\n]\n+\n1\u221a\n4\u03c0D\n\u222b \u221e\n0\n\u2202pi,1\n\u2202\u03b7\n(\u03be)\n\u00d7\n(\nexp\n[\n\u2212 (\u03be \u2212 \u03b7)\n2\n4D\n]\n\u2212 exp\n[\n\u2212 (\u03be + \u03b7)\n2\n4D\n])\nd\u03be. (26)\nLet us define the function g(\u03b7) by\ng(\u03b7) = \u2212P2pi,0\u221a\n\u03c0D\nexp\n[\n\u2212 \u03b7\n2\n4D\n]\n+\n\u2202pi,1\n\u2202\u03b7\n(\u03b7). (27)\nThen (26) can be rewritten as\ng(\u03b7) = \u03c6(\u03b7) + 1\u221a\n4\u03c0D\n\u222b \u221e\n0\ng(\u03be)\n\u00d7\n(\nexp\n[\n\u2212 (\u03be \u2212 \u03b7)\n2\n4D\n]\n\u2212 exp\n[\n\u2212 (\u03be + \u03b7)\n2\n4D\n])\nd\u03be (28)\nwhere\n\u03c6(\u03b7)= P2pi,0\u221a\n8\u03c0D\nexp\n[\n\u2212 \u03b7\n2\n8D\n](\nerf\n[\n\u03b7\u221a\n8D\n]\n\u2212 erf\n[\n\u2212 \u03b7\u221a\n8D\n])\n(29)\nand the error function is defined by\nerf(\u03be) = 2\u221a\n\u03c0\n\u222b \u03be\n0\nexp[\u2212\u03c3 2] d\u03c3.\n22\nBoundary conditions for stochastic simulations\nThe function g(\u03b7) is defined for \u03b7 \u0001 0. Since \u03c6(\u03b7) is an odd\nfunction, we can define g(\u03b7) for the negative values as an odd\nfunction too by setting g(\u03b7) = \u2212g(\u2212\u03b7) for \u03b7 < 0. Then\nequation (28) can be simplified to\ng(\u03b7) = \u03c6(\u03b7) + 1\u221a\n4\u03c0D\n\u222b \u221e\n\u2212\u221e\ng(\u03be) exp\n[\n\u2212 (\u03be \u2212 \u03b7)\n2\n4D\n]\nd\u03be. (30)\nThe natural way to solve such an equation is to apply a Fourier\ntransform, but we have to be slightly careful since the Fourier\ntransform of g does not exist in the classical sense (g tends to\na constant at infinity, so is not integrable). Defining\ng+(\u03b7) = g(\u03b7)\u03c7[0,\u221e)(\u03b7) g\u2212(\u03b7) = g(\u03b7)\u03c7(\u2212\u221e,0](\u03b7),\nwhere \u03c7[a,b] is the characteristic function of the interval [a, b]\n(that is, \u03c7[a,b](\u03b7) = 1 if a \u0002 \u03b7 \u0002 b and zero otherwise), and\napplying the Fourier transform\nh\u0302(k) =\n\u222b \u221e\n\u2212\u221e\nh(\u03b7) exp[ik\u03b7] d\u03b7\nto equation (30), we obtain\ng\u0302+(k) + g\u0302\u2212(k) = \u03c6\u0302(k) + (g\u0302+(k) + g\u0302\u2212(k)) exp[\u2212Dk2].\nThus\ng\u0302+(k) + g\u0302\u2212(k) = \u03c6\u0302(k)1 \u2212 exp[\u2212Dk2] . (31)\nThis seems like one equation for the two unknowns g\u0302+(k) and\ng\u0302\u2212(k), but in fact we know from their definitions that g\u0302+(k)\nis analytic for the imaginary part of k positive, while g\u0302\u2212(k) is\nanalytic for the imaginary part of k negative, and this tells us\nhow to divide all the poles of the right-hand side between g\u0302+(k)\nand g\u0302\u2212(k), except for the pole at the origin, which may appear\nin either g\u0302+(k) or g\u0302\u2212(k). To divide this pole contribution up\nwe note that since g is odd, g\u0302+(k) = \u2212g\u0302\u2212(\u2212k), which implies\nthat the coefficients of the odd powers of k near zero are equal\nin g\u0302+(k) and g\u0302\u2212(k), and that the coefficients of the even powers\nare zero.\nUsing (27) we have\nlim\n\u03b7\u2192\u221e\n\u2202pi,1\n\u2202\u03b7\n(\u03b7) = lim\n\u03b7\u2192\u221e g(\u03b7)\n= lim\n\u03b7\u2192\u221e\n1\n2\u03c0\n\u222b \u221e\n\u2212\u221e\ng\u0302+(k) exp[\u2212ik\u03b7] dk,\nwhere the inversion contour lies in the upper half-plane.\nDeforming the contour to \u2212i\u221e we pick up residue\ncontributions from each of the poles of (31) in the lower half\nplane. The only finite contribution as \u03b7 \u2192 \u221e arises from the\npole at the origin. Since\n\u03c6\u0302(k) \u223c 4i\n\u221a\nDP2pi,0k\u221a\n\u03c0\nas k \u2192 0,\nwe have\ng\u0302+(k) \u223c 2iP2pi,0\u221a\n\u03c0Dk\nas k \u2192 0,\nso that\nD lim\n\u03b7\u2192\u221e\n\u2202pi,1\n\u2202\u03b7\n(\u03b7) = 2P2\n\u221a\nD\u221a\n\u03c0\npi,0.\nUsing the matching condition (25) we therefore derive the\nRobin boundary condition (9) for the stochastic boundary\ncondition (a)\u2013(b). If we consider the boundary condition\n(a) only, equation (22) leads to the modified formula (23)\nwhere 2P2 is replaced by P2. Thus the boundary layer\nmethod presented above gives in that case the Robin boundary\ncondition (10), which differs from (9) by the factor of 2.\n4.3. Velocity jump process I\nUsing standard methods [9, 15], one can show that the density\nof molecules n(x, t) satisfies the damped wave (telegrapher\u2019s)\nequation\n1\n2\u03bb\n\u22022n\n\u2202t2\n+\n\u2202n\n\u2202t\n= s\n2\n2\u03bb\n\u22022n\n\u2202x2\n. (32)\nThe long time behaviour of (32) is described by the\ncorresponding parabolic limit [25]. Using (11), we obtain\nthat n(x, t) satisfies (2) for times t \u000b \u03bb\u22121.\nNext, we derive the Robin boundary condition\ncorresponding to (12). Letp+(x, t) be the density of molecules\nthat are at (x, t) and are moving to the right, and let p\u2212(x, t)\nbe the density of molecules that are at (x, t) and are moving\nto the left. Then the density of molecules at (x, t) is given\nby the sum n(x, t) = p+(x, t) + p\u2212(x, t), and the flux is\nj (x, t) = s(p+(x, t) \u2212 p\u2212(x, t)). The stochastic boundary\ncondition (12) implies\np+(0, t) =\n(\n1 \u2212 P3\ns\n)\np\u2212(0, t).\nThis boundary condition can be written in terms of n and j as\n1\n2\n(\nn(0, t) +\nj (0, t)\ns\n)\n=\n(\n1 \u2212 P3\ns\n)\n1\n2\n(\nn(0, t) \u2212 j (0, t)\ns\n)\nwhich implies\nP3n(0, t) =\n(\nP3\ns\n\u2212 2\n)\nj (0, t).\nSince\nj (0, t) \u2248 \u2212D\u2202n\n\u2202x\n(0, t), (33)\nwe derive (13) in the limit s \u2192 \u221e.\n4.4. Velocity jump process II\nThe random walk (14) and (15) is a discretized version of\nLangevin\u2019s equation [4]. To derive the Robin boundary\ncondition, we consider the behaviour of molecules in the\nsemiinfinite interval [0,\u221e). The ith molecule is described\nby two variables: its position xi(t) and its velocity vi(t). We\ncompute the position xi(t + \u0004t) and velocity vi(t + \u0004t) from\nthe position xi(t) and velocity vi(t) by (14) and (15) together\nwith boundary condition (16) at x = 0. Let f (x, v, t) be the\ndensity of molecules which are at position x with velocity v\nat time t, so that f (x, v, t)\u03b4x\u03b4v is the number of molecules\nin interval [x, x + \u03b4x] with velocities between v and v + \u03b4v at\ntime t. Assuming that the change in velocity of the ith molecule\nduring the time step is \u0004v (i.e. \u0004v = vi(t +\u0004t)\u2212vi(t)), there\nare two possible options for the molecule to reach a point\nx \u0001 0 with velocity v at time t +\u0004t : either the molecule was at\n23\nR Erban and S J Chapman\nposition xi(t) = x\u2212(v\u2212\u0004v)\u0004t with velocity vi(t) = v\u2212\u0004v\nat time t; or at position xi(t) = \u2212x + (v + \u0004v)\u0004t with\nvelocity vi(t) = \u2212v \u2212 \u0004v and was reflected according to\n(16). Both cases make sense only if xi(t) \u0001 0. Consequently,\nf (x, v, t +\u0004t) can be computed from f (\u00b7, \u00b7, t) by the integral\nequation\nf (x, v, t + \u0004t) =\n\u222b \u221e\nv\u2212x\/\u0004t\nf (x \u2212 (v \u2212 \u0004v)\u0004t, v \u2212 \u0004v, t)\n\u00d7\u03c8(v \u2212 \u0004v;\u0004v) d\u0004v\n+\n(\n1 \u2212 P4\u221a\n\u03b2\n)\u222b \u221e\n\u2212v+x\/\u0004t\nf (\u2212x + (v + \u0004v)\u0004t,\u2212v \u2212 \u0004v, t)\n\u00d7\u03c8(\u2212v \u2212 \u0004v;\u0004v) d\u0004v (34)\nwhere \u03c8(w;\u0004v) is a distribution function of the conditional\nprobability that the change in velocity during the time step is\n\u0004v provided that vi(t) = w. Using (15), we obtain\n\u03c8(w;\u0004v) = 1\n\u03b2\n\u221a\n4\u03c0D\u0004t\nexp\n[\n\u2212 (\u0004v + \u03b2w\u0004t)\n2\n4\u03b22D\u0004t\n]\n. (35)\nPassing to the limit \u0004t \u2192 0, we obtain that f (x, v, t) satisfies\nthe Fokker\u2013Planck equation [4]\n\u2202f\n\u2202t\n+ v\n\u2202f\n\u2202x\n= \u03b2 \u2202\n\u2202v\n(\nvf + \u03b2D\n\u2202f\n\u2202v\n)\n(36)\ntogether with the boundary condition\nf (0, v, t) =\n(\n1 \u2212 P4\u221a\n\u03b2\n)\nf (0,\u2212v, t). (37)\nThe density of molecules at the point x and time t is defined\nby\nn(x, t) =\n\u222b\nR\nf (x, v, t) dv. (38)\nTo derive the diffusion equation for n and the corresponding\nRobin boundary condition we consider the limit in which\n\u03b2 \u2192 \u221e and rescale the velocity variable by setting\nv = \u03b7\n\u221a\n\u03b2, f (x, \u03b7, t) = f (x, v, t),\nto give\n1\n\u03b2\n\u2202f\n\u2202t\n+\n1\u221a\n\u03b2\n\u03b7\n\u2202f\n\u2202x\n= \u2202\n\u2202\u03b7\n(\n\u03b7f + D\n\u2202f\n\u2202\u03b7\n)\n. (39)\nWe expand f in powers of 1\/\n\u221a\n\u03b2 as\nf (x, \u03b7, t)= f0(x, \u03b7, t)+ 1\u221a\n\u03b2\nf1(x, \u03b7, t)+\n1\n\u03b2\nf2(x, \u03b7, t)+ \u00b7 \u00b7 \u00b7 .\n(40)\nSubstituting (40) into (39) and equating coefficients of powers\nof \u03b2 we obtain\n\u2202\n\u2202\u03b7\n(\n\u03b7f0 + D\n\u2202f0\n\u2202\u03b7\n)\n= 0, (41)\n\u2202\n\u2202\u03b7\n(\n\u03b7f1 + D\n\u2202f1\n\u2202\u03b7\n)\n= \u03b7\u2202f0\n\u2202x\n, (42)\n\u2202\n\u2202\u03b7\n(\n\u03b7f2 + D\n\u2202f2\n\u2202\u03b7\n)\n= \u03b7\u2202f1\n\u2202x\n+\n\u2202f0\n\u2202t\n. (43)\nSolving equations (41) and (42), we obtain\nf0(x, \u03b7, t) = \u0010(x, t) exp\n[\n\u2212 \u03b7\n2\n2D\n]\n, (44)\nf1(x, \u03b7, t) = \u2212\u2202\u0010\n\u2202x\n(x, t)\u03b7 exp\n[\n\u2212 \u03b7\n2\n2D\n]\n(45)\nwhere the function \u0010(x, t) is independent of \u03b7. Substituting\n(44) and (45) into (43) gives\n\u2202\n\u2202\u03b7\n(\n\u03b7f2 +D\n\u2202f2\n\u2202\u03b7\n)\n= \u2212 \u2202\n2\u0010\n\u2202x2\n\u03b72 exp\n[\n\u2212 \u03b7\n2\n2D\n]\n+\n\u2202\u0010\n\u2202t\nexp\n[\n\u2212 \u03b7\n2\n2D\n]\n.\nIntegrating over \u03b7 gives the solvability condition\n\u2202\u0010\n\u2202t\n= D\u2202\n2\u0010\n\u2202x2\n.\nUsing (38), we see that \u0010(x, t) is proportional to density of\nindividuals n(x, t) for large \u03b2. Consequently, n(x, t) satisfies\nthe diffusion equation (2) for large \u03b2. Multiplying (37) by v\nand integrating over v, we obtain\nj (0, t) = \u2212 P4\u221a\n\u03b2\n\u222b \u221e\n0\nvf (0,\u2212v, t) dv (46)\nwhere flux is defined by j (0, t) = \u222b\nR\nvf (0, v, t) dv.\nSubstituting (44) and (45) into (46), we derive the Robin\nboundary condition (17).\n5. Boundary conditions for stochastic models of\nreaction\u2013diffusion processes\nIn this section, we show that reactions in the solution do\nnot change the boundary conditions from section 2, i.e. the\nboundary conditions of stochastic models of the reaction\u2013\ndiffusion processes are determined by the corresponding\ndiffusion model. First, we illustrate this fact numerically in\nsections 5.1 and 5.2. In section 5.1, we use the stochastic\napproach based on the reaction\u2013diffusion master equation\n[12, 14], so that the corresponding diffusion model is the\nposition jump process I. In section 5.2, we use the stochastic\napproach of Andrews and Bray [1], so that the corresponding\ndiffusion model is the position jump process II. Then, in\nsection 5.3, we provide mathematical justification of the fact\nthat the presence of reactions in the solution does not influence\nthe choice of the boundary condition.\n5.1. Nonlinear reaction kinetics\nWe consider two chemicals A and B which diffuse in the\ndomain of interest [0, 1] with diffusion constants DA and\nDB , respectively, and which react according to Schnakenberg\nreaction kinetics [21]. The chemical A is produced with a\nconstant rate (from a suitable reactant which is supposed to\nbe in excess) and degraded. The chemical B is also produced\nwith a constant rate. Moreover, A and B react according to the\ncubic reaction\n2A + B kc\u2212\u2192 3A (47)\n24\nBoundary conditions for stochastic simulations\n0 0.2 0.4 0.6 0.8 10\n500\n1000\n1500\n2000\n2500\n3000\nposition\nn\nu\nm\nbe\nr o\nf m\nol\nec\nul\nes\n o\nf c\nhe\nm\nica\nl A\n0 0.2 0.4 0.6 0.8 10\n500\n1000\n1500\nposition\nn\nu\nm\nbe\nr o\nf m\nol\nec\nul\nes\n o\nf c\nhe\nm\nica\nl B\nFigure 3. Stochastic simulations of the reaction\u2013diffusion model of the Schnakenberg kinetics with the partially adsorbing boundary at\nx = 0 (histograms). The panel on the left shows chemical A and the panel on the right chemical B. Solution of (48) and (49) with the Robin\nboundary condition (50) at x = 0 and no-flux boundary condition at x = 1 is plotted as the solid line.\nwhere kc is reaction constant. We use a partially adsorbing\nboundary condition at x = 0 and a reflective boundary\ncondition at x = 1.\nThe stochastic simulation algorithm is based on the\nreaction\u2013diffusion master equation [12, 14]. We divide\nthe domain of interest into M compartments of the length\nh = 1\/M which are assumed to be well mixed. In\nparticular, one can use the classical Gillespie\u2019s algorithm [11]\nto simulate stochastically the reactions in each compartment.\nThe system is then described by two M-dimensional vectors\n[A1, A2, . . . , AM ] and [B1, B2, . . . , BM ] where Ai (resp. Bi)\ndenotes the number of molecules of chemical A (resp. B) in\nthe ith compartment. The diffusion of chemicals is added\nto the system as another set of reactions\u2013jumps between\nthe neighbouring compartments with the rate DA\/h2 (resp.\nDB\/h\n2) [18]. In particular, the model of diffusion is equivalent\nto the position jump process I.\nWe choose M = 50 in what follows, i.e. h = 0.02.\nInitially, we have \u03c9 = 1000 molecules of A and B in each\ncompartment, i.e. Ai = Bi = \u03c9, i = 1, 2, . . . ,M , at time\nt = 0. The rate of production of A is 2\u03c9 molecules per\ncompartment per unit of time. The rate of production of B is 8\u03c9\nmolecules per compartment per unit of time. The degradation\nrate of A in the ith compartment is proportional to 6Ai and kc\nis chosen to be 3\u03c9\u22122. Diffusion constants are DA = 1 and\nDB = 0.1. We implement the following boundary condition at\nx = 0: whenever a molecule of chemical A (resp. B) hits the\nboundary, it is adsorbed with probability PA1 h (resp. PB1 h),\nand reflected otherwise. We choose PA1 = PB1 = 10. We\nconsider the reflective boundary condition for both chemicals\nat right boundary x = 1. The number of molecules in each\ncompartment at time t = 1 is plotted in figure 3 (histograms).\nSince \u03c9 is chosen sufficiently large, we can compare the\nresults of stochastic simulation with A = \u03c9a and B = \u03c9b\nwhere a, b are the solution of the system of reaction\u2013diffusion\nequations\n\u2202a\n\u2202t\n= DA \u2202\n2a\n\u2202x2\n+ 2 \u2212 6a + 3a2b (48)\n\u2202b\n\u2202t\n= DB \u2202\n2b\n\u2202x2\n+ 8 \u2212 3a2b (49)\nwith Robin boundary conditions at x = 0 given by (7), namely\n\u2202a\n\u2202x\n(0, t) = PA1 a(0, t),\n\u2202b\n\u2202x\n(0, t) = PB1 b(0, t), (50)\nand with no-flux boundary conditions at right boundary x = 1.\nThe curves A = \u03c9a and B = \u03c9b at time t = 1 are plotted\nin figure 3 as solid lines for comparison. We see that the\nRobin boundary (7) which was derived for the corresponding\ndiffusion model gives good results for the full reaction\u2013\ndiffusion simulation as well.\nWe note that the system (48) and (49) possesses a so-\ncalled Turing instability [16] if the values of the diffusion\nconstants DA and DB are chosen to be sufficiently different.\nOur choice DA = 1 and DB = 0.1 falls in the regime in\nwhich the homogeneous solution a = 10\/6 and b = 48\/50\nof (48) and (49) with zero-flux boundary conditions is stable.\nOn increasing the ratioDA\/DB Turing patterns would develop,\nand we would observe solutions with multiple peaks (provided\nthat the domain size is sufficiently large); see e.g. [18].\n5.2. Spatially localized reactions\nIn some morphogenesis applications [19, 22], one assumes\nthat some prepatterning in the domain exists and one wants\nto validate the reaction\u2013diffusion mechanism of the next stage\nof the patterning of the embryo. In this section, we present\nan example motivated by this approach. We consider one-\ndimensional domain [0, 3] and we use the molecular based\napproach of Andrews and Bray [1], i.e. the diffusion model\nis given by position jump process II. We choose a small\nsimulation time step \u0004t . At each time step, a molecule\nis released at random points in the subinterval [1, 2] with\nprobability kp\u0004t \u0005 1. Moreover, we assume that any\nmolecule is degraded with probability kd\u0004t \u0005 1 during the\nsimulation time step. Here, kp and kd are given constants.\nWe implement the following boundary condition at x = 0:\nwhenever a molecule hits the boundary, it is adsorbed with\nprobability P2\n\u221a\n\u0004t , and reflected otherwise. We consider the\nreflective boundary condition at right boundary x = 3.\nWe start with no molecules in computational domain [0, 3]\nat time t = 0. We choose diffusion constant D = 1, time step\n25\nR Erban and S J Chapman\n0 0.5 1 1.5 2 2.5 30\n500\n1000\n1500\n2000\n2500\n3000\n3500\nposition\nn\nu\nm\nbe\nr o\nf m\nol\nec\nul\nes\nFigure 4. Stochastic simulations of the reaction\u2013diffusion model\nwith spatially localized reaction with the partially adsorbing\nboundary at x = 0 (histogram). Solution of (51) with Robin\nboundary condition (3), with K .= 5.642, and with no-flux boundary\ncondition at x = 3, is plotted as the solid line.\n\u0004t = 10\u22127, production rate kp = 105, degradation rate kd = 1\nand adsorption probability constant P2 = 5. To visualize the\nresults, we divide the interval [0, 3] into 30 bins of length\n0.1 and we plot the number of molecules in each bin at time\nt = 1 in figure 4 (histogram). The results of the stochastic\nsimulation can be compared with the solution of reaction\u2013\ndiffusion equation\n\u2202n\n\u2202t\n= D\u2202\n2n\n\u2202x2\n+ 0.1kp\u03c7[1,2] \u2212 kdn, (51)\nwhere \u03c7[1,2] is characteristic function of the interval [1, 2].\nEquation (51) is solved in the interval [0, 3] together with\nRobin boundary condition (3), with K given by (9), and with\nno-flux boundary condition at x = 3. Using P2 = 5, formula\n(9) implies that K .= 5.642. The density profile n(x, 1) at time\nt = 1 is plotted in figure 4 as a solid line for comparison. We\nsee that the Robin boundary condition (9), which was derived\nfor the corresponding diffusion model, gives good results for\nthe full reaction\u2013diffusion simulation algorithm too.\n5.3. Mathematical justification\nLet us consider a system of k chemicals diffusing and reacting\nin domain [0, L]. Let us suppose that the diffusion model is\nthe position jump process I, i.e. we use the stochastic approach\nbased on the reaction\u2013diffusion master equation [12, 14] as in\nsection 5.1. Letpj1(t) (resp.pj2(t)) be the number of molecules\nof the j th chemical, j = 1, 2, . . . , k, at the boundary mesh\npoint x1 = h\/2 (resp. at x2 = 3h\/2). If there are no reactions\ngoing on, then pj1(t) and p\nj\n2(t) are related according to (20).\nIntroducing reactions at mesh point x = h\/2, the boundary\nequation (20) is modified as follows\np\nj\n1(t + \u0004t) =\n(\n1 \u2212 2D\u0004t\nh2\n)\np\nj\n1(t)\n+\nD\u0004t\nh2\n(\np\nj\n2(t)+ (1 \u2212P1h)pj1(t)\n)\n+\u0004tf\n(\np11(t), . . . , p\nk\n1(t)\n)\nwhere f\n(\np11(t), . . . , p\nk\n1(t)\n)\nis the sum of the rates of all\nreactions which modifies the j th chemical. Following the\nsame procedure as in section 4.1, we find out that the additional\nterm does not influence the boundary condition (it is O(\u0004t)\nand only O(\n\u221a\n\u0004t) terms have nonzero contribution to the\nRobin boundary condition). In particular, we conclude that the\nRobin boundary condition of the stochastic reaction\u2013diffusion\nmodel is given by (7).\nNext, let us consider the stochastic reaction\u2013diffusion\nmodel of Andrews and Bray [1] which was used in section 5.2.\nLetpj\u0004t \u2261 pj\u0004t (x, t) : [0,\u221e)\u00d7\u0004tN0 \u2192 [0,\u221e) be the density\nfunction of the j th chemical species, so that pj\u0004t (x, i\u0004t) dx\nis the number of j th molecules in interval [x, x + dx] at time\nt = i\u0004t. If there are no reactions going on, then pj\u0004t satisfies\nthe formula (22). Introducing the reactions to the system,\nformula (22) is modified as follows:\np\u0004t(x, t + \u0004t)\n=\n\u222b \u221e\n0\n[1 + O(\u0004t)]p(x, t + \u0004t |y, t)p\u0004t (y, t) dy (52)\nwhere the additional O(\u0004t) term corresponds to the reactions\nin the solution. As before, this term is of lower order\n(compared to O(\u221a\u0004t) terms) and does not influence the\nRobin boundary condition. Consequently, the Robin boundary\ncondition (3) is obtained with K given by (9).\nIn this paper, we did not use the velocity jump\nprocesses to simulate stochastically the reaction\u2013diffusion\nprocess. Velocity jump processes are generally more\ncomputationally intensive. However, they might be of use\nif one considers that only sufficiently fast molecules can\nactually react. Alternatively, one can use the approach\nbased on binding\/unbinding radii, as in the Andrews and\nBray method [1], to incorporate higher order reactions to the\nvelocity jump models of molecular diffusion. In any case, the\nreactions are adding again O(\u0004t) terms and do not influence\nthe boundary conditions, i.e. the boundary conditions of\nthe stochastic reaction\u2013diffusion models can be chosen as\nin the corresponding model of the diffusion only.\n6. Conclusions and outlook\nWe have derived the correct boundary conditions for a\nnumber of stochastic models of reaction\u2013diffusion processes.\nFor each model, we related the (microscopic) probability\nof adsorption on the boundary to the (macroscopic) Robin\n(reactive) boundary condition (3). First, we studied several\nstochastic models of diffusion. We showed that each model is\nsuitable for the description of the molecular diffusion far from\nthe boundary. Moreover, we derived formulae (7), (9), (13) and\n(17) relating reactivity K of the boundary with the parameters\nof the stochastic simulation algorithms. Then, we showed\nthat the boundary conditions of stochastic models of reaction\u2013\ndiffusion processes are the same as for the corresponding\nmodel of diffusion only. We studied the stochastic approaches\nbased on the reaction\u2013diffusion master equation [12, 14] and\non the Smoluchowski equation [1]. The main conclusion of\nthis work is that a modeller can use any of the stochastic models\nof the diffusion from section 2, provided that the adsorption\nprobability on the reactive boundary is chosen according to\n26\nBoundary conditions for stochastic simulations\nthe corresponding formula, i.e. (7), (9), (13) or (17), which is\nmodel dependent.\nWe also presented the mathematical derivation of key\nformulae (7), (9), (13) and (17). We devoted the most space\nto the derivation of formula (9) which is (to our knowledge)\na new mathematical result. Derivation of formulae (7) and\n(13) is simple and we included the mathematical arguments\nfor completeness. The last formula (17) has already appeared\nin the literature [17], though our derivation is more systematic.\nFinally, we note that a similar analysis carries over to the case\nwhere equation (2) also contains a convection or drift term,\nwith the partial derivative D\u2202n\/\u2202x on the left-hand side of (3)\nreplaced by the corresponding flux [23].\nIt is interesting to note that in some applications, the\nreactivity of the boundary depends also on the geometrical\nconstraints on the boundary. The binding sites on the surface\n(e.g. reactive groups or receptors) become full as the adsorption\nprogresses. Moreover, attaching large molecules to a binding\nsite can sterically shield the neighbouring binding sites on the\nsurface. For example, in [6, 8] we studied the chemisorption\nof polymers where the attachment of a long polymer molecule\nto the surface prevents attachment of other reactive polymers\nnext to it. This steric shielding was modelled using random\nsequential adsorption [10]. In these models, an adsorption of\none molecule to the surface is attempted per unit of time.\nTo relate the time scale of random sequential adsorption\nalgorithms to physical time, one should couple the theory\nof reactive boundaries presented here with algorithms which\ntake the additional geometrical constraints on the boundary\ninto account. This is an area of ongoing research [7].\nAcknowledgments\nThis work was supported by the Biotechnology and Biological\nSciences Research Council (grant ref. BB\/C508618\/1).\nAppendix. Robin boundary condition and chemistry\nIn this appendix, we show the relation between the Robin\nboundary condition (3) and the experimentally measurable\nchemical properties of the boundary. Let us consider a\nchemical diffusing in the domain [0, L] which is adsorbed\nby boundary x = 0 with some rate K . This problem can be\ndescribed by the reaction\u2013diffusion equation\n\u2202n\n\u2202t\n= D\u2202\n2n\n\u2202x2\n\u2212 Kn\u03b4(x), for x \u2208 [0, L], t \u0001 0, (A.1)\ntogether with no-flux boundary conditions, where D is the\ndiffusion constant and \u03b4(x) a Dirac delta function. The\nterm Kn\u03b4(x) is a standard description of reaction kinetics,\nlocalized on the boundary. In the paper, we used an alternative\ndescription of the chemically adsorbing boundary, given by\nthe diffusion equation (2) accompanied by the Robin boundary\ncondition (3). It is interesting to note that the constant K in\n(3) is actually equal to the experimentally measurable constant\nK . To see this, we discretize (A.1) with space step h and we\ndenote n0(t) = n(h\/2, t) and n1(t) = n(3h\/2, t). Using a\nno-flux boundary condition (i.e. n(\u2212h\/2, t) \u2261 n(h\/2, t)), the\ndiscretization of (A.1) gives\n\u2202n0\n\u2202t\n= Dn1 \u2212 n0\nh2\n\u2212 Kn0 1\nh\n(A.2)\nwhich is equivalent to\n\u2202n0\n\u2202t\n= Dn1 \u2212 n0 + hKn0\nh2\n. (A.3)\nThe same equation can be obtained by the discretization of\nthe diffusion equation (2) together with the Robin boundary\ncondition (3). Hence we showed that K = K , i.e. the Robin\nboundary condition (3) is indeed the correct macroscopic\ndescription of the chemically reacting boundary.\nGlossary\nBoundary layer. A small region close to the boundary of the\ncomputational domain where the system dynamics differ\nsignificantly from their behaviour inside the computational\ndomain.\nEuler scheme. A basic method for numerical computation\nof trajectories of particles which are governed by differential\nequations. In the context of stochastic differential equations,\nit is sometimes called the Euler\u2013Maruyama method.\nDeterministic modelling. Giving the initial condition, one\ncan uniquely predict the behaviour of the system at later\ntimes, typically by solving (ordinary or partially) differential\nequations with suitable boundary conditions.\nGillespie algorithm. A stochastic simulation algorithm for\nspatially homogeneous chemical systems. It is equivalent to\nsolving the chemical master equation.\nLaplace operator. The mathematical operator describing\nthe effects of diffusive spreading on the density of molecules.\nIt is defined by \u22072 \u2261 \u2202\n\u2202x2\n+ \u2202\n\u2202y2\n+ \u2202\n\u2202z2\nin three dimensions.\nMorphogenesis. The formation of tissues and organs during\nembryonic development.\nPosition jump process. Stochastic model of the movement\nof a particle which jumps to different places at given instants\nof time. As a result, the trajectory of the particle is not\ncontinuous.\nRandom sequential adsorption. Sequential addition of\nobjects (e.g. molecules) to random positions on a surface.\nObjects cannot overlap and cannot leave the structure after\ninserting.\nRobin boundary condition. The boundary condition of a\npartial differential equation specifying flux through the\nboundary in terms of the absolute value of the concentration\n(density). The Robin boundary condition is sometimes called\nthe radiation boundary condition.\n27\nR Erban and S J Chapman\nSchnakenberg reaction kinetics. A simple theoretical model\nof a chemical system. It consists of two chemical species and\nhas nontrivial dynamical properties, making it a useful\ncaricature of more complex real chemical systems.\nVelocity jump process. Stochastic model of the movement\nof a particle which changes its velocity by finite increments at\ngiven instants of time. The trajectory of the particle is\ncontinuous but its velocity is a discontinuous function of time.\nReferences\n[1] Andrews S and Bray D 2004 Stochastic simulation of\nchemical reactions with spatial resolution and single\nmolecule detail Phys. Biol. 1 137\u201351\n[2] Bender C and Orszag S 1978 Advanced Mathematical Methods\nfor Scientists and Engineers (New York: McGraw-Hill)\n[3] Berg H 1983 Random Walks in Biology (Princeton: Princeton\nUniversity Press)\n[4] Chandrasekhar S 1943 Stochastic problems in physics and\nastronomy Rev. Mod. Phys. 15 2\u201389\n[5] Crank J 1975 The Mathematics of Diffusion (Oxford: Oxford\nUniversity Press)\n[6] Erban R and Chapman S J 2007 On chemisorption of polymers\nto solid surfaces J. Stat. Phys. at press (Preprint\narsiv.org\/physics\/0609029)\n[7] Erban R and Chapman S J 2007 Time scale of random\nsequential adsorption Phys. Rev. E submitted (Preprint\norg\/physics\/0611252)\n[8] Erban R, Chapman S J, Fisher K, Kevrekidis I and Seymour L\n2007 Dynamics of polydisperse irreversible adsorption: a\npharmacological example Math. Models Methods Appl. Sci.\nat press (Preprint org\/physics\/0602001)\n[9] Erban R and Othmer H 2004 From individual to collective\nbehaviour in bacterial chemotaxis SIAM J. Appl. Math.\n65 361\u201391\n[10] Evans J 1993 Random and cooperative sequential adsorption\nRev. Mod. Phys. 65 1281\u2013329\n[11] Gillespie D 1977 Exact stochastic simulation of\ncoupled chemical reactions J. Phys. Chem.\n81 2340\u201361\n[12] Hattne J, Fagne D and Elf J 2005 Stochastic reaction\u2013\ndiffusion simulation with MesoRD Bioinformatics\n21 2923\u20134\n[13] Holmes M 1995 Introduction to Perturbation Methods\n(New York: Springer)\n[14] Isaacson S and Peskin C 2006 Incorporating diffusion in\ncomplex geometries into stochastic chemical kinetics\nsimulations SIAM J. Sci. Comput. 28 47\u201374\n[15] Kac M 1974 A stochastic model related to the telegrapher\u2019s\nequation Rocky Mt. J. Math. 4 497\u2013509\n[16] Murray J 2002 Mathematical Biology (Berlin: Springer)\n[17] Naqvi K, Mork K and Waldenstrom S 1982 Reduction of the\nFokker\u2013Planck equation with an adsorbing or reflecting\nboundary to the diffusion equation and the radiation\nboundary condition Phys. Rev. Lett. 49 304\u20137\n[18] Qiao L, Erban R, Kelley C and Kevrekidis I 2006 Spatially\ndistributed stochastic systems: equation-free and\nequation-assisted preconditioned computation J. Chem.\nPhys. 125 204108\n[19] Reeves G, Kalifa R, Klein D, Lemmon M and Shvartsmann S\n2005 Computational analysis of EGFR inhibition by Argos\nDev. Biol. 284 523\u201335\n[20] Risken H 1989 The Fokker\u2013Planck Equation, Methods of\nSolution and Applications (Berlin: Springer)\n[21] Schnakenberg J 1979 Simple chemical reaction systems with\nlimit cycle behaviour J. Theor. Biol. 81 389\u2013400\n[22] Shimmi O, Umulis D, Othmer H and Connor M 2005\nFaciliated transport of a Dpp\/Scw heterodimer by Sog\/Tsg\nleads to robust patterning of the Drosophila blastoderm\nembryo Cell 120 873\u201386\n[23] Singer A, Schuss Z and Holcman D 2006 Partially\nreflected diffusionPreprint org\/math-ph\/0606043\n[24] Stundzia A and Lumsden C 1996 Stochastic simulation of\ncoupled reaction\u2013diffusion processes J. Comput.\nPhys. 127 196\u2013207\n[25] Zauderer E 1983 Partial Differential Equations of Applied\nMathematics (New York: Wiley)\n28\n"}